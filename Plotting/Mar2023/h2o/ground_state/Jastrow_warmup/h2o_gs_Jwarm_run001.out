Rank =    0  Free Memory = 86431 MB
Rank =    1  Free Memory = 86430 MB
Rank =    2  Free Memory = 86430 MB
Rank =    3  Free Memory = 86430 MB
Rank =    4  Free Memory = 86430 MB
Rank =    5  Free Memory = 86430 MB
Rank =    6  Free Memory = 86430 MB
Rank =    7  Free Memory = 86430 MB
Rank =    8  Free Memory = 86430 MB
Rank =    9  Free Memory = 86430 MB
Rank =   10  Free Memory = 86429 MB
Rank =   11  Free Memory = 86428 MB
Rank =   12  Free Memory = 86428 MB
Rank =   13  Free Memory = 86428 MB
Rank =   14  Free Memory = 86428 MB
Rank =   15  Free Memory = 86418 MB
Rank =   16  Free Memory = 86414 MB
Rank =   17  Free Memory = 86413 MB
Rank =   18  Free Memory = 86413 MB
Rank =   19  Free Memory = 86413 MB
Rank =   20  Free Memory = 86413 MB
Rank =   21  Free Memory = 86413 MB
Rank =   22  Free Memory = 86413 MB
Rank =   23  Free Memory = 86413 MB
Rank =   24  Free Memory = 86413 MB
Rank =   25  Free Memory = 86413 MB
Rank =   26  Free Memory = 86413 MB
Rank =   27  Free Memory = 86413 MB
Rank =   28  Free Memory = 86413 MB
Rank =   29  Free Memory = 86413 MB
Rank =   30  Free Memory = 86413 MB
Rank =   31  Free Memory = 86413 MB
Rank =   32  Free Memory = 86984 MB
Rank =   33  Free Memory = 86984 MB
Rank =   34  Free Memory = 86984 MB
Rank =   35  Free Memory = 86984 MB
Rank =   36  Free Memory = 86984 MB
Rank =   37  Free Memory = 86984 MB
Rank =   38  Free Memory = 86984 MB
Rank =   39  Free Memory = 86984 MB
Rank =   40  Free Memory = 86984 MB
Rank =   41  Free Memory = 86984 MB
Rank =   42  Free Memory = 86984 MB
Rank =   43  Free Memory = 86984 MB
Rank =   44  Free Memory = 86984 MB
Rank =   45  Free Memory = 86984 MB
Rank =   46  Free Memory = 86984 MB
Rank =   47  Free Memory = 86984 MB
Rank =   48  Free Memory = 86984 MB
Rank =   49  Free Memory = 86984 MB
Rank =   50  Free Memory = 86983 MB
Rank =   51  Free Memory = 86983 MB
Rank =   52  Free Memory = 86983 MB
Rank =   53  Free Memory = 86983 MB
Rank =   54  Free Memory = 86983 MB
Rank =   55  Free Memory = 86983 MB
Rank =   56  Free Memory = 86983 MB
Rank =   57  Free Memory = 86983 MB
Rank =   58  Free Memory = 86983 MB
Rank =   59  Free Memory = 86983 MB
Rank =   60  Free Memory = 86983 MB
Rank =   61  Free Memory = 86983 MB
Rank =   62  Free Memory = 86983 MB
Rank =   63  Free Memory = 86983 MB
Rank =   64  Free Memory = 81523 MB
Rank =   65  Free Memory = 81522 MB
Rank =   66  Free Memory = 81522 MB
Rank =   67  Free Memory = 81522 MB
Rank =   68  Free Memory = 81522 MB
Rank =   69  Free Memory = 81522 MB
Rank =   70  Free Memory = 81522 MB
Rank =   71  Free Memory = 81522 MB
Rank =   72  Free Memory = 81522 MB
Rank =   73  Free Memory = 81522 MB
Rank =   74  Free Memory = 81522 MB
Rank =   75  Free Memory = 81522 MB
Rank =   76  Free Memory = 81522 MB
Rank =   77  Free Memory = 81522 MB
Rank =   78  Free Memory = 81522 MB
Rank =   79  Free Memory = 81522 MB
Rank =   80  Free Memory = 81522 MB
Rank =   81  Free Memory = 81522 MB
Rank =   82  Free Memory = 81522 MB
Rank =   83  Free Memory = 81522 MB
Rank =   84  Free Memory = 81522 MB
Rank =   85  Free Memory = 81522 MB
Rank =   86  Free Memory = 81522 MB
Rank =   87  Free Memory = 81522 MB
Rank =   88  Free Memory = 81522 MB
Rank =   89  Free Memory = 81522 MB
Rank =   90  Free Memory = 81522 MB
Rank =   91  Free Memory = 81522 MB
Rank =   92  Free Memory = 81522 MB
Rank =   93  Free Memory = 81522 MB
Rank =   94  Free Memory = 81522 MB
Rank =   95  Free Memory = 81522 MB
Rank =   96  Free Memory = 64040 MB
Rank =   97  Free Memory = 64040 MB
Rank =   98  Free Memory = 64040 MB
Rank =   99  Free Memory = 64040 MB
Rank =  100  Free Memory = 64040 MB
Rank =  101  Free Memory = 64040 MB
Rank =  102  Free Memory = 64040 MB
Rank =  103  Free Memory = 64040 MB
Rank =  104  Free Memory = 64040 MB
Rank =  105  Free Memory = 64040 MB
Rank =  106  Free Memory = 64040 MB
Rank =  107  Free Memory = 64040 MB
Rank =  108  Free Memory = 64040 MB
Rank =  109  Free Memory = 64040 MB
Rank =  110  Free Memory = 64040 MB
Rank =  111  Free Memory = 64040 MB
Rank =  112  Free Memory = 64040 MB
Rank =  113  Free Memory = 64040 MB
Rank =  114  Free Memory = 64040 MB
Rank =  115  Free Memory = 64040 MB
Rank =  116  Free Memory = 64040 MB
Rank =  117  Free Memory = 64040 MB
Rank =  118  Free Memory = 64040 MB
Rank =  119  Free Memory = 64040 MB
Rank =  120  Free Memory = 64040 MB
Rank =  121  Free Memory = 64040 MB
Rank =  122  Free Memory = 64040 MB
Rank =  123  Free Memory = 64040 MB
Rank =  124  Free Memory = 64040 MB
Rank =  125  Free Memory = 64040 MB
Rank =  126  Free Memory = 64040 MB
Rank =  127  Free Memory = 64040 MB
  Input file(s): opt_h2o_gs_Jwarm_run001.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_Jwarm_run001.xml

  Project = H2O
  date    = 2023-03-01 19:29:21 PST
  host    = n0064.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 17

  Range of prime numbers to use as seeds over processors and threads = 67-853


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 0.000000e+00    1         1  ON     0
     uu_1                 0.000000e+00    1         1  ON     1
     uu_2                 0.000000e+00    1         1  ON     2
     uu_3                 0.000000e+00    1         1  ON     3
     uu_4                 0.000000e+00    1         1  ON     4
     uu_5                 0.000000e+00    1         1  ON     5
     uu_6                 0.000000e+00    1         1  ON     6
     uu_7                 0.000000e+00    1         1  ON     7
     uu_8                 0.000000e+00    1         1  ON     8
     uu_9                 0.000000e+00    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 0.000000e+00    1         1  ON     0
     ud_1                 0.000000e+00    1         1  ON     1
     ud_2                 0.000000e+00    1         1  ON     2
     ud_3                 0.000000e+00    1         1  ON     3
     ud_4                 0.000000e+00    1         1  ON     4
     ud_5                 0.000000e+00    1         1  ON     5
     ud_6                 0.000000e+00    1         1  ON     6
     ud_7                 0.000000e+00    1         1  ON     7
     ud_8                 0.000000e+00    1         1  ON     8
     ud_9                 0.000000e+00    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                 0.000000e+00    1         1  ON     0
     eO_1                 0.000000e+00    1         1  ON     1
     eO_2                 0.000000e+00    1         1  ON     2
     eO_3                 0.000000e+00    1         1  ON     3
     eO_4                 0.000000e+00    1         1  ON     4
     eO_5                 0.000000e+00    1         1  ON     5
     eO_6                 0.000000e+00    1         1  ON     6
     eO_7                 0.000000e+00    1         1  ON     7
     eO_8                 0.000000e+00    1         1  ON     8
     eO_9                 0.000000e+00    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                 0.000000e+00    1         1  ON     0
     eH1_1                 0.000000e+00    1         1  ON     1
     eH1_2                 0.000000e+00    1         1  ON     2
     eH1_3                 0.000000e+00    1         1  ON     3
     eH1_4                 0.000000e+00    1         1  ON     4
     eH1_5                 0.000000e+00    1         1  ON     5
     eH1_6                 0.000000e+00    1         1  ON     6
     eH1_7                 0.000000e+00    1         1  ON     7
     eH1_8                 0.000000e+00    1         1  ON     8
     eH1_9                 0.000000e+00    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                 0.000000e+00    1         1  ON     0
     eH2_1                 0.000000e+00    1         1  ON     1
     eH2_2                 0.000000e+00    1         1  ON     2
     eH2_3                 0.000000e+00    1         1  ON     3
     eH2_4                 0.000000e+00    1         1  ON     4
     eH2_5                 0.000000e+00    1         1  ON     5
     eH2_6                 0.000000e+00    1         1  ON     6
     eH2_7                 0.000000e+00    1         1  ON     7
     eH2_8                 0.000000e+00    1         1  ON     8
     eH2_9                 0.000000e+00    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.955546e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.8461e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 20
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1796
    reference variance = 0.693435
====================================================
  Execution time = 2.0993e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7088e+01
  VMC Evar = 1.2388e+00
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5115e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.238754776359
                                         uncertainty =       0.008351341769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.238754776359
                                         uncertainty =       0.008351341769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000787008230
  error estimate for blocks of size 2^( 2) =       0.000829883224
  error estimate for blocks of size 2^( 3) =       0.000865475154
  error estimate for blocks of size 2^( 4) =       0.000889618406
  error estimate for blocks of size 2^( 5) =       0.000905804110
  error estimate for blocks of size 2^( 6) =       0.000910110803
  error estimate for blocks of size 2^( 7) =       0.000913020365

      target function =                  N/A
              le_mean =     -17.087819374130
             les_mean =     293.232334252117
             stat err =       0.000904638421
             autocorr =       1.321269803123
              std dev =       1.112997712753
             le_variance =       1.238763908592


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.708781937413e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.087819374130       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.106840381745       residual = 7.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.121738545889       residual = 9.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.128449628437       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.134498479490       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.137135709824       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.138383502105       residual = 7.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.138869551092       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.138957652024       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.139019404031       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.139057815069       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.139067281874       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.139070302344       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.139071052405       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.139071531668       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.139071120448       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.221115e-01

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.087819374130       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.097034408812       residual = 8.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.104441484731       residual = 9.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.106676287024       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.109854433054       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.110627624438       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.110828564928       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.110931187464       residual = 7.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.110938808325       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.110942732344       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.110945792960       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.110946121479       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.110946237151       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.110946275769       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 7.561025e-02

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.087819374130       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.090826749338       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.093371416406       residual = 9.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.093963794983       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.094994510265       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.095219372613       residual = 8.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.095256175680       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.095274924708       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.095276555955       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.095276882324       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.095277166490       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.095277248132       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.095277252441       residual = 2.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 2.188441e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.062250 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6573e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.339616e-02                 1 1 ON  0
uu_1  4.745639e-03                 1 1 ON  1
uu_2  -1.461985e-02                1 1 ON  2
uu_3  -9.604782e-03                1 1 ON  3
uu_4  -9.593050e-03                1 1 ON  4
uu_5  -3.836727e-03                1 1 ON  5
uu_6  -1.199564e-03                1 1 ON  6
uu_7  1.090577e-04                 1 1 ON  7
uu_8  3.024494e-04                 1 1 ON  8
uu_9  1.781078e-04                 1 1 ON  9
ud_0  7.561025e-02                 1 1 ON  10
ud_1  -9.647735e-03                1 1 ON  11
ud_2  -2.140386e-02                1 1 ON  12
ud_3  -1.189271e-02                1 1 ON  13
ud_4  -1.522904e-02                1 1 ON  14
ud_5  -1.158457e-02                1 1 ON  15
ud_6  -5.433402e-03                1 1 ON  16
ud_7  -7.791035e-04                1 1 ON  17
ud_8  1.525806e-04                 1 1 ON  18
ud_9  1.428688e-04                 1 1 ON  19
eO_0  -4.393605e-02                1 1 ON  20
eO_1  -7.087292e-03                1 1 ON  21
eO_2  3.555343e-02                 1 1 ON  22
eO_3  1.688820e-02                 1 1 ON  23
eO_4  1.332897e-03                 1 1 ON  24
eO_5  -1.874087e-03                1 1 ON  25
eO_6  -8.226656e-04                1 1 ON  26
eO_7  -8.593711e-05                1 1 ON  27
eO_8  2.910525e-05                 1 1 ON  28
eO_9  6.404951e-06                 1 1 ON  29
eH1_0 -1.029594e-02                1 1 ON  30
eH1_1 -6.912036e-04                1 1 ON  31
eH1_2 -1.382530e-03                1 1 ON  32
eH1_3 3.339457e-03                 1 1 ON  33
eH1_4 8.378621e-03                 1 1 ON  34
eH1_5 1.337869e-03                 1 1 ON  35
eH1_6 -4.158551e-04                1 1 ON  36
eH1_7 -2.527079e-04                1 1 ON  37
eH1_8 -1.576400e-05                1 1 ON  38
eH1_9 9.973801e-06                 1 1 ON  39
eH2_0 -1.002479e-02                1 1 ON  40
eH2_1 -7.482212e-04                1 1 ON  41
eH2_2 -1.311882e-03                1 1 ON  42
eH2_3 3.342124e-03                 1 1 ON  43
eH2_4 8.193251e-03                 1 1 ON  44
eH2_5 1.243400e-03                 1 1 ON  45
eH2_6 -3.611968e-04                1 1 ON  46
eH2_7 -3.266632e-04                1 1 ON  47
eH2_8 -2.698153e-05                1 1 ON  48
eH2_9 1.513821e-05                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.111
    reference variance = 0.562019
====================================================
  Execution time = 2.0607e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7133e+01
  VMC Evar = 7.9112e-01
  Total weights = 2.0000e+06
  Execution time = 1.8176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.169500761387
                                         uncertainty =       0.006290297806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.169500761387
                                         uncertainty =       0.006290297806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000764666605
  error estimate for blocks of size 2^( 2) =       0.000805412705
  error estimate for blocks of size 2^( 3) =       0.000838130701
  error estimate for blocks of size 2^( 4) =       0.000859454101
  error estimate for blocks of size 2^( 5) =       0.000870514805
  error estimate for blocks of size 2^( 6) =       0.000881280767
  error estimate for blocks of size 2^( 7) =       0.000881754924

      target function =                  N/A
              le_mean =     -17.141953797418
             les_mean =     295.016009440301
             stat err =       0.000873251149
             autocorr =       1.304169635457
              std dev =       1.081401882831
             le_variance =       1.169430032190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531487433686
                                         uncertainty =       0.006872852967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531487433686
                                         uncertainty =       0.006872852967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515511248
  error estimate for blocks of size 2^( 2) =       0.000541372331
  error estimate for blocks of size 2^( 3) =       0.000565461804
  error estimate for blocks of size 2^( 4) =       0.000583194790
  error estimate for blocks of size 2^( 5) =       0.000593665682
  error estimate for blocks of size 2^( 6) =       0.000603087780
  error estimate for blocks of size 2^( 7) =       0.000606251237

      target function =                  N/A
              le_mean =     -17.163650567836
             les_mean =     295.122404243346
             stat err =       0.000596549872
             autocorr =       1.339112988197
              std dev =       0.729042998940
             le_variance =       0.531503694304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.600665395013
                                         uncertainty =       0.006581068888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.600665395013
                                         uncertainty =       0.006581068888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000548019723
  error estimate for blocks of size 2^( 2) =       0.000581829316
  error estimate for blocks of size 2^( 3) =       0.000611617307
  error estimate for blocks of size 2^( 4) =       0.000632646840
  error estimate for blocks of size 2^( 5) =       0.000644599189
  error estimate for blocks of size 2^( 6) =       0.000654915074
  error estimate for blocks of size 2^( 7) =       0.000657026353

      target function =                  N/A
              le_mean =     -17.141938136510
             les_mean =     294.446694009621
             stat err =       0.000647296864
             autocorr =       1.395129840727
              std dev =       0.775016924990
             le_variance =       0.600651234022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.041554037181
                                         uncertainty =       0.006287206744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.041554037181
                                         uncertainty =       0.006287206744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000721625832
  error estimate for blocks of size 2^( 2) =       0.000761690146
  error estimate for blocks of size 2^( 3) =       0.000794236542
  error estimate for blocks of size 2^( 4) =       0.000815688898
  error estimate for blocks of size 2^( 5) =       0.000826958833
  error estimate for blocks of size 2^( 6) =       0.000837696670
  error estimate for blocks of size 2^( 7) =       0.000838354362

      target function =                  N/A
              le_mean =     -17.137605503731
             les_mean =     294.739009562658
             stat err =       0.000829674691
             autocorr =       1.321878510124
              std dev =       1.020533038117
             le_variance =       1.041487681889


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.141953797418        initial
     2.5000e-01     2.5000e+00             2.2211e-01       -17.163650567836  <--
     1.0000e+00     1.0000e+01             7.5610e-02       -17.141938136510
     4.0000e+00     4.0000e+01             2.1884e-02       -17.137605503731

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.3094e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.157181e-01 1 1  ON 0
 uu_1                 1.143708e-02 1 1  ON 1
 uu_2                -4.290632e-02 1 1  ON 2
 uu_3                -4.266788e-02 1 1  ON 3
 uu_4                -3.830269e-02 1 1  ON 4
 uu_5                -1.605487e-02 1 1  ON 5
 uu_6                 1.325785e-04 1 1  ON 6
 uu_7                 5.383754e-03 1 1  ON 7
 uu_8                 4.071329e-03 1 1  ON 8
 uu_9                 1.965654e-03 1 1  ON 9
 ud_0                 2.221115e-01 1 1  ON 10
 ud_1                -1.183294e-02 1 1  ON 11
 ud_2                -5.595081e-02 1 1  ON 12
 ud_3                -4.617541e-02 1 1  ON 13
 ud_4                -5.205698e-02 1 1  ON 14
 ud_5                -4.466212e-02 1 1  ON 15
 ud_6                -1.932319e-02 1 1  ON 16
 ud_7                 1.211309e-03 1 1  ON 17
 ud_8                 3.798116e-03 1 1  ON 18
 ud_9                 1.970827e-03 1 1  ON 19
 eO_0                -1.842757e-01 1 1  ON 20
 eO_1                -3.935212e-02 1 1  ON 21
 eO_2                 1.157928e-01 1 1  ON 22
 eO_3                 9.099828e-02 1 1  ON 23
 eO_4                 2.102927e-02 1 1  ON 24
 eO_5                -3.852359e-03 1 1  ON 25
 eO_6                -2.002645e-03 1 1  ON 26
 eO_7                 7.247610e-04 1 1  ON 27
 eO_8                 6.789671e-04 1 1  ON 28
 eO_9                 2.141443e-04 1 1  ON 29
eH1_0                -4.715101e-02 1 1  ON 30
eH1_1                -9.785831e-03 1 1  ON 31
eH1_2                -4.470693e-03 1 1  ON 32
eH1_3                 1.061290e-02 1 1  ON 33
eH1_4                 3.372287e-02 1 1  ON 34
eH1_5                 1.356131e-02 1 1  ON 35
eH1_6                 2.211518e-03 1 1  ON 36
eH1_7                 3.086075e-04 1 1  ON 37
eH1_8                 6.004909e-04 1 1  ON 38
eH1_9                 3.345484e-04 1 1  ON 39
eH2_0                -4.610750e-02 1 1  ON 40
eH2_1                -9.898740e-03 1 1  ON 41
eH2_2                -4.370739e-03 1 1  ON 42
eH2_3                 1.065533e-02 1 1  ON 43
eH2_4                 3.319900e-02 1 1  ON 44
eH2_5                 1.324783e-02 1 1  ON 45
eH2_6                 2.355750e-03 1 1  ON 46
eH2_7                -1.073276e-04 1 1  ON 47
eH2_8                 5.396583e-04 1 1  ON 48
eH2_9                 3.470234e-04 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9673e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7145e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1909
    reference variance = 0.434005
====================================================
  Execution time = 2.0764e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7179e+01
  VMC Evar = 5.4075e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5298e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.540907772595
                                         uncertainty =       0.050607939947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.540907772595
                                         uncertainty =       0.050607939947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000519976601
  error estimate for blocks of size 2^( 2) =       0.000542462921
  error estimate for blocks of size 2^( 3) =       0.000563255247
  error estimate for blocks of size 2^( 4) =       0.000577942658
  error estimate for blocks of size 2^( 5) =       0.000586386235
  error estimate for blocks of size 2^( 6) =       0.000589626776
  error estimate for blocks of size 2^( 7) =       0.000591062915

      target function =                  N/A
              le_mean =     -17.179116555135
             les_mean =     295.662796674924
             stat err =       0.000586254646
             autocorr =       1.271173978377
              std dev =       0.735357960713
             le_variance =       0.540751330383


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.717911655514e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.179116555135       residual = 8.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.180089556747       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.181494608886       residual = 5.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.184282875067       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.186456020610       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.187488668039       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.187864462326       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.188212970445       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.188469081457       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.188594930030       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.188679939938       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.188711509254       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.188716920948       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.188722324018       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.188723230737       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.188724561225       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.188724492555       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.188725161169       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.188725026589       residual = 7.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.037682e-01

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.179116555135       residual = 8.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.179670148157       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.180634045504       residual = 4.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.181829232660       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.182882258885       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.183178750556       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.183295705842       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.183338077846       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.183366640751       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.183373790884       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.183379540413       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.183380073092       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.183379682463       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.183379746960       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 6.167525e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.179116555135       residual = 8.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.179319747271       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.179778812132       residual = 3.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.180112607111       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.180453439996       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.180508796251       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.180526872726       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.180529751476       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.180531283125       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.180530822052       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.180531268818       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.180531306561       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.180531262198       residual = 1.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.776485e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071293 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6307e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.369127e-01 1 1  ON 0
 uu_1                 1.190151e-02 1 1  ON 1
 uu_2                -4.508315e-02 1 1  ON 2
 uu_3                -5.677564e-02 1 1  ON 3
 uu_4                -5.139803e-02 1 1  ON 4
 uu_5                -2.476878e-02 1 1  ON 5
 uu_6                 2.853169e-03 1 1  ON 6
 uu_7                 1.186949e-02 1 1  ON 7
 uu_8                 8.337369e-03 1 1  ON 8
 uu_9                 3.908778e-03 1 1  ON 9
 ud_0                 2.302995e-01 1 1  ON 10
 ud_1                 4.275112e-03 1 1  ON 11
 ud_2                -5.006498e-02 1 1  ON 12
 ud_3                -5.725833e-02 1 1  ON 13
 ud_4                -6.279615e-02 1 1  ON 14
 ud_5                -5.804322e-02 1 1  ON 15
 ud_6                -2.551474e-02 1 1  ON 16
 ud_7                 5.047342e-03 1 1  ON 17
 ud_8                 8.132027e-03 1 1  ON 18
 ud_9                 3.911448e-03 1 1  ON 19
 eO_0                -2.459509e-01 1 1  ON 20
 eO_1                -6.319307e-02 1 1  ON 21
 eO_2                 1.257330e-01 1 1  ON 22
 eO_3                 1.356199e-01 1 1  ON 23
 eO_4                 4.577699e-02 1 1  ON 24
 eO_5                -4.656145e-04 1 1  ON 25
 eO_6                -1.494436e-03 1 1  ON 26
 eO_7                 1.975440e-03 1 1  ON 27
 eO_8                 1.395738e-03 1 1  ON 28
 eO_9                 4.531072e-04 1 1  ON 29
eH1_0                -6.695212e-02 1 1  ON 30
eH1_1                -1.906921e-02 1 1  ON 31
eH1_2                -5.059265e-03 1 1  ON 32
eH1_3                 1.168541e-02 1 1  ON 33
eH1_4                 4.225854e-02 1 1  ON 34
eH1_5                 2.583386e-02 1 1  ON 35
eH1_6                 7.454224e-03 1 1  ON 36
eH1_7                 1.512372e-03 1 1  ON 37
eH1_8                 1.317026e-03 1 1  ON 38
eH1_9                 7.102696e-04 1 1  ON 39
eH2_0                -6.562554e-02 1 1  ON 40
eH2_1                -1.893625e-02 1 1  ON 41
eH2_2                -4.826542e-03 1 1  ON 42
eH2_3                 1.148884e-02 1 1  ON 43
eH2_4                 4.165443e-02 1 1  ON 44
eH2_5                 2.497533e-02 1 1  ON 45
eH2_6                 7.587543e-03 1 1  ON 46
eH2_7                 1.283641e-03 1 1  ON 47
eH2_8                 1.425488e-03 1 1  ON 48
eH2_9                 7.073672e-04 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2268
    reference variance = 0.286282
====================================================
  Execution time = 1.9880e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7187e+01
  VMC Evar = 4.5365e-01
  Total weights = 2.0000e+06
  Execution time = 1.8221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489483949606
                                         uncertainty =       0.006726309500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489483949606
                                         uncertainty =       0.006726309500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494719620
  error estimate for blocks of size 2^( 2) =       0.000517344627
  error estimate for blocks of size 2^( 3) =       0.000538064845
  error estimate for blocks of size 2^( 4) =       0.000552283530
  error estimate for blocks of size 2^( 5) =       0.000560485984
  error estimate for blocks of size 2^( 6) =       0.000566560521
  error estimate for blocks of size 2^( 7) =       0.000568043046

      target function =                  N/A
              le_mean =     -17.188936704572
             les_mean =     295.949039793144
             stat err =       0.000561843270
             autocorr =       1.289769486692
              std dev =       0.699639195665
             le_variance =       0.489495004111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435943668075
                                         uncertainty =       0.006973950937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435943668075
                                         uncertainty =       0.006973950937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466872907
  error estimate for blocks of size 2^( 2) =       0.000481851186
  error estimate for blocks of size 2^( 3) =       0.000495802618
  error estimate for blocks of size 2^( 4) =       0.000504920712
  error estimate for blocks of size 2^( 5) =       0.000511205945
  error estimate for blocks of size 2^( 6) =       0.000516181001
  error estimate for blocks of size 2^( 7) =       0.000517409937

      target function =                  N/A
              le_mean =     -17.191841112599
             les_mean =     295.995341244560
             stat err =       0.000512429399
             autocorr =       1.204677314784
              std dev =       0.660257996306
             le_variance =       0.435940621685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437515700211
                                         uncertainty =       0.006801021570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437515700211
                                         uncertainty =       0.006801021570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467715739
  error estimate for blocks of size 2^( 2) =       0.000485249122
  error estimate for blocks of size 2^( 3) =       0.000501629774
  error estimate for blocks of size 2^( 4) =       0.000512639751
  error estimate for blocks of size 2^( 5) =       0.000519954725
  error estimate for blocks of size 2^( 6) =       0.000525392561
  error estimate for blocks of size 2^( 7) =       0.000526937714

      target function =                  N/A
              le_mean =     -17.188898260537
             les_mean =     295.895739218109
             stat err =       0.000521231188
             autocorr =       1.241929140443
              std dev =       0.661449942014
             le_variance =       0.437516025790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473702779431
                                         uncertainty =       0.006712261653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473702779431
                                         uncertainty =       0.006712261653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486678502
  error estimate for blocks of size 2^( 2) =       0.000508486495
  error estimate for blocks of size 2^( 3) =       0.000528541868
  error estimate for blocks of size 2^( 4) =       0.000542298015
  error estimate for blocks of size 2^( 5) =       0.000550409594
  error estimate for blocks of size 2^( 6) =       0.000556389259
  error estimate for blocks of size 2^( 7) =       0.000557882589

      target function =                  N/A
              le_mean =     -17.188099289153
             les_mean =     295.904468865054
             stat err =       0.000551744864
             autocorr =       1.285263795307
              std dev =       0.688267337690
             le_variance =       0.473711928131


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.188936704572        initial
     6.2500e-02     6.2500e-01             2.0377e-01       -17.191841112599  <--
     2.5000e-01     2.5000e+00             6.1675e-02       -17.188898260537
     1.0000e+00     1.0000e+01             1.7765e-02       -17.188099289153

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9117e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.750781e-01 1 1  ON 0
 uu_1                 2.134636e-02 1 1  ON 1
 uu_2                -4.691891e-02 1 1  ON 2
 uu_3                -7.959968e-02 1 1  ON 3
 uu_4                -8.378649e-02 1 1  ON 4
 uu_5                -5.649658e-02 1 1  ON 5
 uu_6                -2.817472e-03 1 1  ON 6
 uu_7                 3.045910e-02 1 1  ON 7
 uu_8                 2.448283e-02 1 1  ON 8
 uu_9                 1.178744e-02 1 1  ON 9
 ud_0                 2.622481e-01 1 1  ON 10
 ud_1                 3.491500e-02 1 1  ON 11
 ud_2                -3.786173e-02 1 1  ON 12
 ud_3                -7.129454e-02 1 1  ON 13
 ud_4                -9.088423e-02 1 1  ON 14
 ud_5                -9.496421e-02 1 1  ON 15
 ud_6                -5.422756e-02 1 1  ON 16
 ud_7                 1.073956e-02 1 1  ON 17
 ud_8                 2.313930e-02 1 1  ON 18
 ud_9                 1.165428e-02 1 1  ON 19
 eO_0                -3.880438e-01 1 1  ON 20
 eO_1                -1.387983e-01 1 1  ON 21
 eO_2                 1.269722e-01 1 1  ON 22
 eO_3                 2.236461e-01 1 1  ON 23
 eO_4                 1.365182e-01 1 1  ON 24
 eO_5                 2.630628e-02 1 1  ON 25
 eO_6                 1.088705e-03 1 1  ON 26
 eO_7                 6.147546e-03 1 1  ON 27
 eO_8                 4.097336e-03 1 1  ON 28
 eO_9                 1.464776e-03 1 1  ON 29
eH1_0                -1.131558e-01 1 1  ON 30
eH1_1                -4.225502e-02 1 1  ON 31
eH1_2                -1.193274e-02 1 1  ON 32
eH1_3                 1.110950e-02 1 1  ON 33
eH1_4                 5.275066e-02 1 1  ON 34
eH1_5                 5.600948e-02 1 1  ON 35
eH1_6                 3.226735e-02 1 1  ON 36
eH1_7                 7.780734e-03 1 1  ON 37
eH1_8                 3.954345e-03 1 1  ON 38
eH1_9                 2.114747e-03 1 1  ON 39
eH2_0                -1.111267e-01 1 1  ON 40
eH2_1                -4.176860e-02 1 1  ON 41
eH2_2                -1.163952e-02 1 1  ON 42
eH2_3                 1.067875e-02 1 1  ON 43
eH2_4                 5.184785e-02 1 1  ON 44
eH2_5                 5.379889e-02 1 1  ON 45
eH2_6                 3.223345e-02 1 1  ON 46
eH2_7                 8.233148e-03 1 1  ON 47
eH2_8                 4.862334e-03 1 1  ON 48
eH2_9                 2.082956e-03 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5430e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7177e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1847
    reference variance = 0.348537
====================================================
  Execution time = 2.0621e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7197e+01
  VMC Evar = 4.3799e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5072e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438076202203
                                         uncertainty =       0.011278116528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438076202203
                                         uncertainty =       0.011278116528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467970480
  error estimate for blocks of size 2^( 2) =       0.000482338108
  error estimate for blocks of size 2^( 3) =       0.000494319773
  error estimate for blocks of size 2^( 4) =       0.000504540770
  error estimate for blocks of size 2^( 5) =       0.000508982362
  error estimate for blocks of size 2^( 6) =       0.000511993303
  error estimate for blocks of size 2^( 7) =       0.000514811109

      target function =                  N/A
              le_mean =     -17.196584728692
             les_mean =     296.160518851587
             stat err =       0.000510081886
             autocorr =       1.188072343781
              std dev =       0.661810198991
             le_variance =       0.437992739489


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.719658472869e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.196584728692       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.196696497883       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.196823482513       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.197032889682       residual = 6.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.197508515134       residual = 5.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.197844584861       residual = 5.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.198221926083       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.198398275305       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.198511676079       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.198612930756       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.198708600561       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.198796485322       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.198822438195       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.198844004363       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.198850035303       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.198860080374       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.198866039418       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.198867401564       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.198867646847       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.198867642776       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.198869428404       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.198871331469       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.198870185089       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.198870174231       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 2.489695e-01

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.196584728692       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.196681842012       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.196787957095       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.196969099663       residual = 6.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.197238619605       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.197375692444       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.197510144605       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.197561562943       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.197589152720       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.197609295247       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.197620889500       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.197627668424       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.197628365464       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.197629347608       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.197630168212       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.197630436975       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.197630528488       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.197630476254       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 6.084841e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.196584728692       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.196648429968       residual = 5.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.196718304842       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.196866957248       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.196906299214       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.196925297203       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.196947220725       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.196953943352       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.196957098769       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.196958900870       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.196959101306       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.196959206793       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.196959251894       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.717416e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.084237 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6145e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.808119e-01 1 1  ON 0
 uu_1                 2.985730e-02 1 1  ON 1
 uu_2                -4.429223e-02 1 1  ON 2
 uu_3                -8.054850e-02 1 1  ON 3
 uu_4                -9.508467e-02 1 1  ON 4
 uu_5                -7.517321e-02 1 1  ON 5
 uu_6                -2.031855e-02 1 1  ON 6
 uu_7                 3.737176e-02 1 1  ON 7
 uu_8                 3.774996e-02 1 1  ON 8
 uu_9                 1.903071e-02 1 1  ON 9
 ud_0                 2.800761e-01 1 1  ON 10
 ud_1                 4.345797e-02 1 1  ON 11
 ud_2                -3.228004e-02 1 1  ON 12
 ud_3                -6.790802e-02 1 1  ON 13
 ud_4                -9.977080e-02 1 1  ON 14
 ud_5                -1.112838e-01 1 1  ON 15
 ud_6                -7.999215e-02 1 1  ON 16
 ud_7                 4.325173e-03 1 1  ON 17
 ud_8                 3.328506e-02 1 1  ON 18
 ud_9                 1.928329e-02 1 1  ON 19
 eO_0                -4.412831e-01 1 1  ON 20
 eO_1                -1.866998e-01 1 1  ON 21
 eO_2                 1.049671e-01 1 1  ON 22
 eO_3                 2.381667e-01 1 1  ON 23
 eO_4                 1.973666e-01 1 1  ON 24
 eO_5                 6.317132e-02 1 1  ON 25
 eO_6                 5.192525e-03 1 1  ON 26
 eO_7                 8.962398e-03 1 1  ON 27
 eO_8                 6.349916e-03 1 1  ON 28
 eO_9                 2.738426e-03 1 1  ON 29
eH1_0                -1.266382e-01 1 1  ON 30
eH1_1                -5.132743e-02 1 1  ON 31
eH1_2                -1.983885e-02 1 1  ON 32
eH1_3                 7.362409e-03 1 1  ON 33
eH1_4                 4.753476e-02 1 1  ON 34
eH1_5                 6.179943e-02 1 1  ON 35
eH1_6                 5.393705e-02 1 1  ON 36
eH1_7                 1.510906e-02 1 1  ON 37
eH1_8                 6.767741e-03 1 1  ON 38
eH1_9                 3.228033e-03 1 1  ON 39
eH2_0                -1.268496e-01 1 1  ON 40
eH2_1                -5.222046e-02 1 1  ON 41
eH2_2                -2.030160e-02 1 1  ON 42
eH2_3                 6.371749e-03 1 1  ON 43
eH2_4                 4.729408e-02 1 1  ON 44
eH2_5                 6.209649e-02 1 1  ON 45
eH2_6                 5.484602e-02 1 1  ON 46
eH2_7                 1.608655e-02 1 1  ON 47
eH2_8                 7.827958e-03 1 1  ON 48
eH2_9                 3.322377e-03 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2598
    reference variance = 0.372375
====================================================
  Execution time = 1.9908e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7197e+01
  VMC Evar = 4.2466e-01
  Total weights = 2.0000e+06
  Execution time = 1.8189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421487479629
                                         uncertainty =       0.005069896333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421487479629
                                         uncertainty =       0.005069896333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000458989269
  error estimate for blocks of size 2^( 2) =       0.000473558412
  error estimate for blocks of size 2^( 3) =       0.000487559361
  error estimate for blocks of size 2^( 4) =       0.000498907828
  error estimate for blocks of size 2^( 5) =       0.000504675196
  error estimate for blocks of size 2^( 6) =       0.000506648931
  error estimate for blocks of size 2^( 7) =       0.000511243301

      target function =                  N/A
              le_mean =     -17.197084008794
             les_mean =     296.161040493276
             stat err =       0.000505368814
             autocorr =       1.212304765364
              std dev =       0.649108849445
             le_variance =       0.421342298428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444961033345
                                         uncertainty =       0.005230063857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444961033345
                                         uncertainty =       0.005230063857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471592882
  error estimate for blocks of size 2^( 2) =       0.000483605048
  error estimate for blocks of size 2^( 3) =       0.000494669677
  error estimate for blocks of size 2^( 4) =       0.000503568336
  error estimate for blocks of size 2^( 5) =       0.000508094713
  error estimate for blocks of size 2^( 6) =       0.000509263186
  error estimate for blocks of size 2^( 7) =       0.000513343672

      target function =                  N/A
              le_mean =     -17.200280529189
             les_mean =     296.294449753502
             stat err =       0.000508567477
             autocorr =       1.162954393072
              std dev =       0.666933049939
             le_variance =       0.444799693101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433422971181
                                         uncertainty =       0.005161667710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433422971181
                                         uncertainty =       0.005161667710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465438765
  error estimate for blocks of size 2^( 2) =       0.000477986916
  error estimate for blocks of size 2^( 3) =       0.000489869352
  error estimate for blocks of size 2^( 4) =       0.000499582841
  error estimate for blocks of size 2^( 5) =       0.000504549452
  error estimate for blocks of size 2^( 6) =       0.000506056669
  error estimate for blocks of size 2^( 7) =       0.000510429350

      target function =                  N/A
              le_mean =     -17.197157927223
             les_mean =     296.175507045489
             stat err =       0.000505154578
             autocorr =       1.177940848958
              std dev =       0.658229814172
             le_variance =       0.433266488264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.423231620183
                                         uncertainty =       0.005088350082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.423231620183
                                         uncertainty =       0.005088350082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000459936706
  error estimate for blocks of size 2^( 2) =       0.000474069205
  error estimate for blocks of size 2^( 3) =       0.000487649891
  error estimate for blocks of size 2^( 4) =       0.000498676662
  error estimate for blocks of size 2^( 5) =       0.000504290648
  error estimate for blocks of size 2^( 6) =       0.000506154390
  error estimate for blocks of size 2^( 7) =       0.000510710416

      target function =                  N/A
              le_mean =     -17.196790499980
             les_mean =     296.152686834810
             stat err =       0.000504958029
             autocorr =       1.205353474075
              std dev =       0.650448726752
             le_variance =       0.423083546133


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.197084008794        initial
     1.5625e-02     1.5625e-01             2.4897e-01       -17.200280529189  <--
     6.2500e-02     6.2500e-01             6.0848e-02       -17.197157927223
     2.5000e-01     2.5000e+00             1.7174e-02       -17.196790499980

*****************************************************************************
Applying the update for shift_i =   1.5625e-02     and shift_s =   1.5625e-01
*****************************************************************************

  Execution time = 2.9124e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.020478e-01 1 1  ON 0
 uu_1                 4.981487e-02 1 1  ON 1
 uu_2                -3.730233e-02 1 1  ON 2
 uu_3                -8.729182e-02 1 1  ON 3
 uu_4                -1.279391e-01 1 1  ON 4
 uu_5                -1.342393e-01 1 1  ON 5
 uu_6                -9.229628e-02 1 1  ON 6
 uu_7                 3.720834e-02 1 1  ON 7
 uu_8                 9.713246e-02 1 1  ON 8
 uu_9                 5.808650e-02 1 1  ON 9
 ud_0                 3.254137e-01 1 1  ON 10
 ud_1                 7.594355e-02 1 1  ON 11
 ud_2                -9.762233e-03 1 1  ON 12
 ud_3                -5.858279e-02 1 1  ON 13
 ud_4                -1.199530e-01 1 1  ON 14
 ud_5                -1.608106e-01 1 1  ON 15
 ud_6                -1.621948e-01 1 1  ON 16
 ud_7                -4.925261e-02 1 1  ON 17
 ud_8                 6.641068e-02 1 1  ON 18
 ud_9                 5.703810e-02 1 1  ON 19
 eO_0                -6.370133e-01 1 1  ON 20
 eO_1                -3.565893e-01 1 1  ON 21
 eO_2                 7.630318e-03 1 1  ON 22
 eO_3                 2.533483e-01 1 1  ON 23
 eO_4                 3.668330e-01 1 1  ON 24
 eO_5                 2.581342e-01 1 1  ON 25
 eO_6                 5.306961e-02 1 1  ON 26
 eO_7                 2.473744e-02 1 1  ON 27
 eO_8                 1.633875e-02 1 1  ON 28
 eO_9                 9.520681e-03 1 1  ON 29
eH1_0                -1.699387e-01 1 1  ON 30
eH1_1                -8.635941e-02 1 1  ON 31
eH1_2                -4.998380e-02 1 1  ON 32
eH1_3                -1.263678e-02 1 1  ON 33
eH1_4                 2.996107e-02 1 1  ON 34
eH1_5                 5.972378e-02 1 1  ON 35
eH1_6                 1.282200e-01 1 1  ON 36
eH1_7                 6.127123e-02 1 1  ON 37
eH1_8                 2.501795e-02 1 1  ON 38
eH1_9                 8.756355e-03 1 1  ON 39
eH2_0                -1.751335e-01 1 1  ON 40
eH2_1                -9.060532e-02 1 1  ON 41
eH2_2                -5.287425e-02 1 1  ON 42
eH2_3                -1.573345e-02 1 1  ON 43
eH2_4                 2.990363e-02 1 1  ON 44
eH2_5                 6.407365e-02 1 1  ON 45
eH2_6                 1.324887e-01 1 1  ON 46
eH2_7                 6.583187e-02 1 1  ON 47
eH2_8                 2.706944e-02 1 1  ON 48
eH2_9                 9.430141e-03 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5274e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7192e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1696
    reference variance = 0.371873
====================================================
  Execution time = 2.0161e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.2255e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.422523646368
                                         uncertainty =       0.004177982804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.422523646368
                                         uncertainty =       0.004177982804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000459646666
  error estimate for blocks of size 2^( 2) =       0.000471317299
  error estimate for blocks of size 2^( 3) =       0.000481261383
  error estimate for blocks of size 2^( 4) =       0.000489122124
  error estimate for blocks of size 2^( 5) =       0.000493306967
  error estimate for blocks of size 2^( 6) =       0.000495775106
  error estimate for blocks of size 2^( 7) =       0.000495982500

      target function =                  N/A
              le_mean =     -17.199695636128
             les_mean =     296.252079878880
             stat err =       0.000493546674
             autocorr =       1.152944046379
              std dev =       0.650038548624
             le_variance =       0.422550114697


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.719969563613e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-03, overlap shift 3.9062e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.199695636129       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.199813884539       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.199896464503       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.199964928327       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200075961687       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200170013578       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200325669968       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200375354387       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200432539013       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200444394453       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.200463091781       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.200500206421       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.200522200772       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.200559060034       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.200576522708       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.200586698454       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.200592335709       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.200606105868       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.200624336346       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.200632923198       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.200639193738       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.200644934407       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.200641112533       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.200645911346       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.200649996192       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.200650131270       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.200650757131       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.200651231448       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-03 is 1.590360e-01

solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.199695636129       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.199809471319       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.199888389575       residual = 9.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.199956562001       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200053295648       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200133663617       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200260404015       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200290420520       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200327681945       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200330467929       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.200340111518       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.200361016340       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.200371685928       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.200384852884       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.200387592211       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.200388005227       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.200387335913       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.200389249872       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.200392350621       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.200392281671       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.200392698802       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.200393187206       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 5.952792e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.199695636129       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.199794684640       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.199862736998       residual = 7.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.199936347878       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.199991416764       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200037727636       residual = 7.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200101645067       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200105351888       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200115997447       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200112361986       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.200113932233       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.200118792516       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.200120172878       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.200121103091       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.200121153557       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.200120873003       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.200120629292       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.760089e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103149 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5713e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.975070e-01 1 1  ON 0
 uu_1                 4.084049e-02 1 1  ON 1
 uu_2                -4.095695e-02 1 1  ON 2
 uu_3                -8.909642e-02 1 1  ON 3
 uu_4                -1.206641e-01 1 1  ON 4
 uu_5                -1.250733e-01 1 1  ON 5
 uu_6                -9.130522e-02 1 1  ON 6
 uu_7                 1.637438e-02 1 1  ON 7
 uu_8                 1.019330e-01 1 1  ON 8
 uu_9                 6.840104e-02 1 1  ON 9
 ud_0                 3.121449e-01 1 1  ON 10
 ud_1                 7.289284e-02 1 1  ON 11
 ud_2                -1.069608e-02 1 1  ON 12
 ud_3                -5.937566e-02 1 1  ON 13
 ud_4                -1.096230e-01 1 1  ON 14
 ud_5                -1.492923e-01 1 1  ON 15
 ud_6                -1.472146e-01 1 1  ON 16
 ud_7                -7.001620e-02 1 1  ON 17
 ud_8                 5.548455e-02 1 1  ON 18
 ud_9                 6.316020e-02 1 1  ON 19
 eO_0                -6.247965e-01 1 1  ON 20
 eO_1                -3.457229e-01 1 1  ON 21
 eO_2                -3.887899e-03 1 1  ON 22
 eO_3                 2.170498e-01 1 1  ON 23
 eO_4                 3.073051e-01 1 1  ON 24
 eO_5                 2.872543e-01 1 1  ON 25
 eO_6                 9.668004e-02 1 1  ON 26
 eO_7                 3.356205e-02 1 1  ON 27
 eO_8                 1.720519e-02 1 1  ON 28
 eO_9                 1.069522e-02 1 1  ON 29
eH1_0                -1.647416e-01 1 1  ON 30
eH1_1                -8.726647e-02 1 1  ON 31
eH1_2                -5.040138e-02 1 1  ON 32
eH1_3                -1.684370e-02 1 1  ON 33
eH1_4                 3.059885e-02 1 1  ON 34
eH1_5                 4.575492e-02 1 1  ON 35
eH1_6                 1.108944e-01 1 1  ON 36
eH1_7                 7.986784e-02 1 1  ON 37
eH1_8                 3.582438e-02 1 1  ON 38
eH1_9                 9.814052e-03 1 1  ON 39
eH2_0                -1.659239e-01 1 1  ON 40
eH2_1                -8.813885e-02 1 1  ON 41
eH2_2                -5.177599e-02 1 1  ON 42
eH2_3                -1.851801e-02 1 1  ON 43
eH2_4                 2.865739e-02 1 1  ON 44
eH2_5                 4.445414e-02 1 1  ON 45
eH2_6                 1.132911e-01 1 1  ON 46
eH2_7                 8.130083e-02 1 1  ON 47
eH2_8                 3.851474e-02 1 1  ON 48
eH2_9                 1.147301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2648
    reference variance = 0.306849
====================================================
  Execution time = 1.9858e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.2268e-01
  Total weights = 2.0000e+06
  Execution time = 1.8222e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435949027562
                                         uncertainty =       0.005563675942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435949027562
                                         uncertainty =       0.005563675942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466804536
  error estimate for blocks of size 2^( 2) =       0.000478574661
  error estimate for blocks of size 2^( 3) =       0.000488943169
  error estimate for blocks of size 2^( 4) =       0.000496096259
  error estimate for blocks of size 2^( 5) =       0.000500405427
  error estimate for blocks of size 2^( 6) =       0.000503791927
  error estimate for blocks of size 2^( 7) =       0.000506219235

      target function =                  N/A
              le_mean =     -17.200987447327
             les_mean =     296.309781895756
             stat err =       0.000501628212
             autocorr =       1.154765423028
              std dev =       0.660161306471
             le_variance =       0.435812950561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418269827576
                                         uncertainty =       0.005439275955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418269827576
                                         uncertainty =       0.005439275955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000457239757
  error estimate for blocks of size 2^( 2) =       0.000468922524
  error estimate for blocks of size 2^( 3) =       0.000479083810
  error estimate for blocks of size 2^( 4) =       0.000486239947
  error estimate for blocks of size 2^( 5) =       0.000490304542
  error estimate for blocks of size 2^( 6) =       0.000493595264
  error estimate for blocks of size 2^( 7) =       0.000495778617

      target function =                  N/A
              le_mean =     -17.200733333837
             les_mean =     296.283363403447
             stat err =       0.000491479592
             autocorr =       1.155375112082
              std dev =       0.646634665604
             le_variance =       0.418136390761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416103738375
                                         uncertainty =       0.005402475480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416103738375
                                         uncertainty =       0.005402475480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456053997
  error estimate for blocks of size 2^( 2) =       0.000468014605
  error estimate for blocks of size 2^( 3) =       0.000478433612
  error estimate for blocks of size 2^( 4) =       0.000485810209
  error estimate for blocks of size 2^( 5) =       0.000489941270
  error estimate for blocks of size 2^( 6) =       0.000493304758
  error estimate for blocks of size 2^( 7) =       0.000495443659

      target function =                  N/A
              le_mean =     -17.201027712127
             les_mean =     296.291324642521
             stat err =       0.000491124974
             autocorr =       1.159715612757
              std dev =       0.644957748333
             le_variance =       0.415970497135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.426422912355
                                         uncertainty =       0.005508284664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.426422912355
                                         uncertainty =       0.005508284664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000461674970
  error estimate for blocks of size 2^( 2) =       0.000473387543
  error estimate for blocks of size 2^( 3) =       0.000483641649
  error estimate for blocks of size 2^( 4) =       0.000490737821
  error estimate for blocks of size 2^( 5) =       0.000494955612
  error estimate for blocks of size 2^( 6) =       0.000498308955
  error estimate for blocks of size 2^( 7) =       0.000500630283

      target function =                  N/A
              le_mean =     -17.200501594486
             les_mean =     296.283542444358
             stat err =       0.000496158168
             autocorr =       1.154961829503
              std dev =       0.652907003772
             le_variance =       0.426287555575


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.200987447327        initial
     3.9062e-03     3.9062e-02             1.5904e-01       -17.200733333837
     1.5625e-02     1.5625e-01             5.9528e-02       -17.201027712127  <--
     6.2500e-02     6.2500e-01             2.7601e-02       -17.200501594486

*****************************************************************************
Applying the update for shift_i =   1.5625e-02     and shift_s =   1.5625e-01
*****************************************************************************

  Execution time = 2.9083e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.975070e-01 1 1  ON 0
 uu_1                 4.084049e-02 1 1  ON 1
 uu_2                -4.095695e-02 1 1  ON 2
 uu_3                -8.909642e-02 1 1  ON 3
 uu_4                -1.206641e-01 1 1  ON 4
 uu_5                -1.250733e-01 1 1  ON 5
 uu_6                -9.130522e-02 1 1  ON 6
 uu_7                 1.637438e-02 1 1  ON 7
 uu_8                 1.019330e-01 1 1  ON 8
 uu_9                 6.840104e-02 1 1  ON 9
 ud_0                 3.121449e-01 1 1  ON 10
 ud_1                 7.289284e-02 1 1  ON 11
 ud_2                -1.069608e-02 1 1  ON 12
 ud_3                -5.937566e-02 1 1  ON 13
 ud_4                -1.096230e-01 1 1  ON 14
 ud_5                -1.492923e-01 1 1  ON 15
 ud_6                -1.472146e-01 1 1  ON 16
 ud_7                -7.001620e-02 1 1  ON 17
 ud_8                 5.548455e-02 1 1  ON 18
 ud_9                 6.316020e-02 1 1  ON 19
 eO_0                -6.247965e-01 1 1  ON 20
 eO_1                -3.457229e-01 1 1  ON 21
 eO_2                -3.887899e-03 1 1  ON 22
 eO_3                 2.170498e-01 1 1  ON 23
 eO_4                 3.073051e-01 1 1  ON 24
 eO_5                 2.872543e-01 1 1  ON 25
 eO_6                 9.668004e-02 1 1  ON 26
 eO_7                 3.356205e-02 1 1  ON 27
 eO_8                 1.720519e-02 1 1  ON 28
 eO_9                 1.069522e-02 1 1  ON 29
eH1_0                -1.647416e-01 1 1  ON 30
eH1_1                -8.726647e-02 1 1  ON 31
eH1_2                -5.040138e-02 1 1  ON 32
eH1_3                -1.684370e-02 1 1  ON 33
eH1_4                 3.059885e-02 1 1  ON 34
eH1_5                 4.575492e-02 1 1  ON 35
eH1_6                 1.108944e-01 1 1  ON 36
eH1_7                 7.986784e-02 1 1  ON 37
eH1_8                 3.582438e-02 1 1  ON 38
eH1_9                 9.814052e-03 1 1  ON 39
eH2_0                -1.659239e-01 1 1  ON 40
eH2_1                -8.813885e-02 1 1  ON 41
eH2_2                -5.177599e-02 1 1  ON 42
eH2_3                -1.851801e-02 1 1  ON 43
eH2_4                 2.865739e-02 1 1  ON 44
eH2_5                 4.445414e-02 1 1  ON 45
eH2_6                 1.132911e-01 1 1  ON 46
eH2_7                 8.130083e-02 1 1  ON 47
eH2_8                 3.851474e-02 1 1  ON 48
eH2_9                 1.147301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4801e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1897
    reference variance = 0.257106
====================================================
  Execution time = 2.0541e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.1524e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7600e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.415300294960
                                         uncertainty =       0.005869217380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.415300294960
                                         uncertainty =       0.005869217380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000455653265
  error estimate for blocks of size 2^( 2) =       0.000467296975
  error estimate for blocks of size 2^( 3) =       0.000477477405
  error estimate for blocks of size 2^( 4) =       0.000484959100
  error estimate for blocks of size 2^( 5) =       0.000488956016
  error estimate for blocks of size 2^( 6) =       0.000489816729
  error estimate for blocks of size 2^( 7) =       0.000491532039

      target function =                  N/A
              le_mean =     -17.200983251180
             les_mean =     296.289064396183
             stat err =       0.000488815971
             autocorr =       1.150858157829
              std dev =       0.644391027582
             le_variance =       0.415239796429


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720098325118e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-03, overlap shift 3.9062e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200983251180       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200985536850       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200983621975       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200994657562       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.201011886193       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.201032242450       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.201046384530       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.201054330444       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.201068678154       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.201069971292       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.201070262233       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.201081896093       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.201096261236       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.201105500096       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.201110813763       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.201116980579       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.201123815789       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.201131857813       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.201135448965       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.201133888589       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.201133181298       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.201134975069       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.201135625771       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.201134955341       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.201135804367       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.201136085409       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.201134443156       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.201135596804       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-03 is 1.354590e-01

solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200983251180       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200985425762       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200983494966       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200993433186       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.201007077387       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.201021457472       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.201030567292       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.201035282376       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.201043625640       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.201041421284       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.201039501572       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.201042209210       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.201045132099       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.201046768005       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.201047544602       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.201048056457       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.201049261479       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.201050439274       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.201050609770       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 3.488317e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200983251180       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200985071815       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200983235633       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200990446632       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200997249872       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.201003124115       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.201006392279       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.201007985411       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.201010368414       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.201008328052       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.201007215663       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.201007441409       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.201007522928       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.201007831763       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 9.050189e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119810 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6321e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.948756e-01 1 1  ON 0
 uu_1                 3.895181e-02 1 1  ON 1
 uu_2                -4.230259e-02 1 1  ON 2
 uu_3                -8.950874e-02 1 1  ON 3
 uu_4                -1.202796e-01 1 1  ON 4
 uu_5                -1.245867e-01 1 1  ON 5
 uu_6                -9.338452e-02 1 1  ON 6
 uu_7                 2.678155e-03 1 1  ON 7
 uu_8                 1.057719e-01 1 1  ON 8
 uu_9                 7.793292e-02 1 1  ON 9
 ud_0                 3.107451e-01 1 1  ON 10
 ud_1                 7.203803e-02 1 1  ON 11
 ud_2                -1.097227e-02 1 1  ON 12
 ud_3                -5.840818e-02 1 1  ON 13
 ud_4                -1.080064e-01 1 1  ON 14
 ud_5                -1.475733e-01 1 1  ON 15
 ud_6                -1.472897e-01 1 1  ON 16
 ud_7                -7.998689e-02 1 1  ON 17
 ud_8                 4.866603e-02 1 1  ON 18
 ud_9                 7.008793e-02 1 1  ON 19
 eO_0                -6.302662e-01 1 1  ON 20
 eO_1                -3.526365e-01 1 1  ON 21
 eO_2                -1.520930e-02 1 1  ON 22
 eO_3                 2.022914e-01 1 1  ON 23
 eO_4                 2.881882e-01 1 1  ON 24
 eO_5                 2.952883e-01 1 1  ON 25
 eO_6                 1.315632e-01 1 1  ON 26
 eO_7                 4.436899e-02 1 1  ON 27
 eO_8                 1.861874e-02 1 1  ON 28
 eO_9                 1.215787e-02 1 1  ON 29
eH1_0                -1.655751e-01 1 1  ON 30
eH1_1                -8.795864e-02 1 1  ON 31
eH1_2                -5.109173e-02 1 1  ON 32
eH1_3                -1.839646e-02 1 1  ON 33
eH1_4                 2.898721e-02 1 1  ON 34
eH1_5                 4.083739e-02 1 1  ON 35
eH1_6                 9.699523e-02 1 1  ON 36
eH1_7                 9.082183e-02 1 1  ON 37
eH1_8                 4.539655e-02 1 1  ON 38
eH1_9                 1.189534e-02 1 1  ON 39
eH2_0                -1.672052e-01 1 1  ON 40
eH2_1                -9.047253e-02 1 1  ON 41
eH2_2                -5.400721e-02 1 1  ON 42
eH2_3                -2.080063e-02 1 1  ON 43
eH2_4                 2.659169e-02 1 1  ON 44
eH2_5                 4.156788e-02 1 1  ON 45
eH2_6                 1.029330e-01 1 1  ON 46
eH2_7                 9.256523e-02 1 1  ON 47
eH2_8                 4.778400e-02 1 1  ON 48
eH2_9                 1.352466e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2524
    reference variance = 0.255169
====================================================
  Execution time = 1.9948e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.2128e-01
  Total weights = 2.0000e+06
  Execution time = 1.8261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.422753054698
                                         uncertainty =       0.007709723208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.422753054698
                                         uncertainty =       0.007709723208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000459737444
  error estimate for blocks of size 2^( 2) =       0.000471401488
  error estimate for blocks of size 2^( 3) =       0.000480759285
  error estimate for blocks of size 2^( 4) =       0.000487836376
  error estimate for blocks of size 2^( 5) =       0.000492349978
  error estimate for blocks of size 2^( 6) =       0.000495200122
  error estimate for blocks of size 2^( 7) =       0.000495258692

      target function =                  N/A
              le_mean =     -17.199563403382
             les_mean =     296.247698091185
             stat err =       0.000492661292
             autocorr =       1.148357544571
              std dev =       0.650166929004
             le_variance =       0.422717035570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.420679782014
                                         uncertainty =       0.007743264349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.420679782014
                                         uncertainty =       0.007743264349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000458609542
  error estimate for blocks of size 2^( 2) =       0.000470184165
  error estimate for blocks of size 2^( 3) =       0.000479420443
  error estimate for blocks of size 2^( 4) =       0.000486350158
  error estimate for blocks of size 2^( 5) =       0.000490763273
  error estimate for blocks of size 2^( 6) =       0.000493517543
  error estimate for blocks of size 2^( 7) =       0.000493538342

      target function =                  N/A
              le_mean =     -17.199623866928
             les_mean =     296.247706376900
             stat err =       0.000491042329
             autocorr =       1.146440947413
              std dev =       0.648571833677
             le_variance =       0.420645423439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.420084036105
                                         uncertainty =       0.007765490528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.420084036105
                                         uncertainty =       0.007765490528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000458284946
  error estimate for blocks of size 2^( 2) =       0.000469918202
  error estimate for blocks of size 2^( 3) =       0.000479230684
  error estimate for blocks of size 2^( 4) =       0.000486253196
  error estimate for blocks of size 2^( 5) =       0.000490726628
  error estimate for blocks of size 2^( 6) =       0.000493512832
  error estimate for blocks of size 2^( 7) =       0.000493561249

      target function =                  N/A
              le_mean =     -17.199584199774
             les_mean =     296.245746618462
             stat err =       0.000491013476
             autocorr =       1.147930621416
              std dev =       0.648112786002
             le_variance =       0.420050183379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421977248298
                                         uncertainty =       0.007726416952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421977248298
                                         uncertainty =       0.007726416952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000459315702
  error estimate for blocks of size 2^( 2) =       0.000470971371
  error estimate for blocks of size 2^( 3) =       0.000480319601
  error estimate for blocks of size 2^( 4) =       0.000487390428
  error estimate for blocks of size 2^( 5) =       0.000491899664
  error estimate for blocks of size 2^( 6) =       0.000494740412
  error estimate for blocks of size 2^( 7) =       0.000494797185

      target function =                  N/A
              le_mean =     -17.199548110426
             les_mean =     296.246396820150
             stat err =       0.000492206922
             autocorr =       1.148346231550
              std dev =       0.649570495232
             le_variance =       0.421941828276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.199563403382        initial
     3.9062e-03     3.9062e-02             1.3546e-01       -17.199623866928  <--
     1.5625e-02     1.5625e-01             3.4883e-02       -17.199584199774
     6.2500e-02     6.2500e-01             9.0502e-03       -17.199548110426

*****************************************************************************
Applying the update for shift_i =   3.9062e-03     and shift_s =   3.9062e-02
*****************************************************************************

  Execution time = 2.9167e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.912540e-01 1 1  ON 0
 uu_1                 3.556002e-02 1 1  ON 1
 uu_2                -4.550518e-02 1 1  ON 2
 uu_3                -9.255495e-02 1 1  ON 3
 uu_4                -1.233629e-01 1 1  ON 4
 uu_5                -1.293536e-01 1 1  ON 5
 uu_6                -1.048659e-01 1 1  ON 6
 uu_7                -3.048577e-02 1 1  ON 7
 uu_8                 1.051512e-01 1 1  ON 8
 uu_9                 1.109968e-01 1 1  ON 9
 ud_0                 3.124040e-01 1 1  ON 10
 ud_1                 7.393421e-02 1 1  ON 11
 ud_2                -8.886695e-03 1 1  ON 12
 ud_3                -5.603883e-02 1 1  ON 13
 ud_4                -1.058839e-01 1 1  ON 14
 ud_5                -1.474931e-01 1 1  ON 15
 ud_6                -1.544524e-01 1 1  ON 16
 ud_7                -1.053877e-01 1 1  ON 17
 ud_8                 1.730439e-02 1 1  ON 18
 ud_9                 9.022874e-02 1 1  ON 19
 eO_0                -6.670538e-01 1 1  ON 20
 eO_1                -3.899241e-01 1 1  ON 21
 eO_2                -5.317480e-02 1 1  ON 22
 eO_3                 1.657136e-01 1 1  ON 23
 eO_4                 2.592306e-01 1 1  ON 24
 eO_5                 3.055636e-01 1 1  ON 25
 eO_6                 2.321390e-01 1 1  ON 26
 eO_7                 9.496607e-02 1 1  ON 27
 eO_8                 2.528142e-02 1 1  ON 28
 eO_9                 1.744251e-02 1 1  ON 29
eH1_0                -1.736438e-01 1 1  ON 30
eH1_1                -9.556648e-02 1 1  ON 31
eH1_2                -5.883761e-02 1 1  ON 32
eH1_3                -2.614754e-02 1 1  ON 33
eH1_4                 2.094177e-02 1 1  ON 34
eH1_5                 3.196002e-02 1 1  ON 35
eH1_6                 7.366789e-02 1 1  ON 36
eH1_7                 1.104527e-01 1 1  ON 37
eH1_8                 8.094140e-02 1 1  ON 38
eH1_9                 2.165284e-02 1 1  ON 39
eH2_0                -1.753418e-01 1 1  ON 40
eH2_1                -9.925090e-02 1 1  ON 41
eH2_2                -6.274261e-02 1 1  ON 42
eH2_3                -2.920474e-02 1 1  ON 43
eH2_4                 1.821142e-02 1 1  ON 44
eH2_5                 3.349559e-02 1 1  ON 45
eH2_6                 8.401261e-02 1 1  ON 46
eH2_7                 1.139003e-01 1 1  ON 47
eH2_8                 8.252286e-02 1 1  ON 48
eH2_9                 2.323815e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5493e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2053
    reference variance = 0.378793
====================================================
  Execution time = 2.0198e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.6134e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461456748862
                                         uncertainty =       0.025119970248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461456748862
                                         uncertainty =       0.025119970248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480281282
  error estimate for blocks of size 2^( 2) =       0.000492168882
  error estimate for blocks of size 2^( 3) =       0.000501246453
  error estimate for blocks of size 2^( 4) =       0.000506826178
  error estimate for blocks of size 2^( 5) =       0.000509910238
  error estimate for blocks of size 2^( 6) =       0.000511033851
  error estimate for blocks of size 2^( 7) =       0.000513616418

      target function =                  N/A
              le_mean =     -17.200721076235
             les_mean =     296.326145531332
             stat err =       0.000510346671
             autocorr =       1.129117791718
              std dev =       0.679220302677
             le_variance =       0.461340219569


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720072107623e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-04, overlap shift 9.7656e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200721076235       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200727020185       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200723461363       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200724059499       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200731639069       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200732725064       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200736857221       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200735732799       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200739339899       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200741221640       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.200745531935       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.200753837395       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.200767295550       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.200784307001       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.200789096839       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.200786950434       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.200802216620       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.200802117867       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.200809485223       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.200812559527       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.200824013808       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.200820756468       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.200822692801       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.200822733967       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.200826129401       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.200829518649       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.200825381495       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.200828911570       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.200828363101       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.200825725868       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-04 is 3.287161e-01

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e-03, overlap shift 3.9062e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200721076235       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200726978796       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200723494007       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200724033585       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200731376600       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200732379443       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200736230229       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200735225374       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200738635073       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200740102346       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.200743614364       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.200750017592       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.200759666447       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.200767926523       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.200767813277       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.200764643910       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.200771283484       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.200770192326       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.200771793894       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.200772284230       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.200775500837       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.200774051244       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.200773875103       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.200773696259       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.200774396050       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.200774880675       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-03 is 4.580910e-02

solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200721076235       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200726818849       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200723607517       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200723928948       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200730447342       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200731188058       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200734136676       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200733699834       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200736510151       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200736797122       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.200738538562       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.200741245715       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.200745203328       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.200745946267       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.200744708877       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.200743366687       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.200744885211       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.200744548945       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.200744605386       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.200744541642       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.165148e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144861 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5743e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.874905e-01 1 1  ON 0
 uu_1                 3.154177e-02 1 1  ON 1
 uu_2                -5.006555e-02 1 1  ON 2
 uu_3                -9.851054e-02 1 1  ON 3
 uu_4                -1.307201e-01 1 1  ON 4
 uu_5                -1.382813e-01 1 1  ON 5
 uu_6                -1.149591e-01 1 1  ON 6
 uu_7                -4.471897e-02 1 1  ON 7
 uu_8                 9.723019e-02 1 1  ON 8
 uu_9                 1.397762e-01 1 1  ON 9
 ud_0                 3.157241e-01 1 1  ON 10
 ud_1                 7.624650e-02 1 1  ON 11
 ud_2                -7.323582e-03 1 1  ON 12
 ud_3                -5.669055e-02 1 1  ON 13
 ud_4                -1.080208e-01 1 1  ON 14
 ud_5                -1.522448e-01 1 1  ON 15
 ud_6                -1.627581e-01 1 1  ON 16
 ud_7                -1.164100e-01 1 1  ON 17
 ud_8                -9.940969e-03 1 1  ON 18
 ud_9                 1.029992e-01 1 1  ON 19
 eO_0                -7.006344e-01 1 1  ON 20
 eO_1                -4.217151e-01 1 1  ON 21
 eO_2                -7.735850e-02 1 1  ON 22
 eO_3                 1.480031e-01 1 1  ON 23
 eO_4                 2.559686e-01 1 1  ON 24
 eO_5                 3.066893e-01 1 1  ON 25
 eO_6                 2.779481e-01 1 1  ON 26
 eO_7                 1.391453e-01 1 1  ON 27
 eO_8                 3.348269e-02 1 1  ON 28
 eO_9                 2.353692e-02 1 1  ON 29
eH1_0                -1.797484e-01 1 1  ON 30
eH1_1                -1.046253e-01 1 1  ON 31
eH1_2                -6.765410e-02 1 1  ON 32
eH1_3                -3.314649e-02 1 1  ON 33
eH1_4                 1.411120e-02 1 1  ON 34
eH1_5                 3.442542e-02 1 1  ON 35
eH1_6                 7.573002e-02 1 1  ON 36
eH1_7                 1.123397e-01 1 1  ON 37
eH1_8                 1.044564e-01 1 1  ON 38
eH1_9                 2.792658e-02 1 1  ON 39
eH2_0                -1.850168e-01 1 1  ON 40
eH2_1                -1.068858e-01 1 1  ON 41
eH2_2                -6.987358e-02 1 1  ON 42
eH2_3                -3.669431e-02 1 1  ON 43
eH2_4                 1.140006e-02 1 1  ON 44
eH2_5                 2.933146e-02 1 1  ON 45
eH2_6                 7.618713e-02 1 1  ON 46
eH2_7                 1.139929e-01 1 1  ON 47
eH2_8                 1.141421e-01 1 1  ON 48
eH2_9                 3.472730e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1579
    reference variance = 0.151848
====================================================
  Execution time = 1.9820e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.2205e-01
  Total weights = 2.0000e+06
  Execution time = 1.8273e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.420541661557
                                         uncertainty =       0.005802608370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.420541661557
                                         uncertainty =       0.005802608370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000458497888
  error estimate for blocks of size 2^( 2) =       0.000469750026
  error estimate for blocks of size 2^( 3) =       0.000479647487
  error estimate for blocks of size 2^( 4) =       0.000486627789
  error estimate for blocks of size 2^( 5) =       0.000491568952
  error estimate for blocks of size 2^( 6) =       0.000494097202
  error estimate for blocks of size 2^( 7) =       0.000495320261

      target function =                  N/A
              le_mean =     -17.200614310192
             les_mean =     296.281573064609
             stat err =       0.000491903551
             autocorr =       1.151026270509
              std dev =       0.648413931719
             le_variance =       0.420440626847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.426215169717
                                         uncertainty =       0.005964133295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.426215169717
                                         uncertainty =       0.005964133295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000461579703
  error estimate for blocks of size 2^( 2) =       0.000472779517
  error estimate for blocks of size 2^( 3) =       0.000482508163
  error estimate for blocks of size 2^( 4) =       0.000489366907
  error estimate for blocks of size 2^( 5) =       0.000494271913
  error estimate for blocks of size 2^( 6) =       0.000496530739
  error estimate for blocks of size 2^( 7) =       0.000497379422

      target function =                  N/A
              le_mean =     -17.200863361818
             les_mean =     296.295811822971
             stat err =       0.000494387245
             autocorr =       1.147205205514
              std dev =       0.652772275831
             le_variance =       0.426111644094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.424060563804
                                         uncertainty =       0.005856152032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.424060563804
                                         uncertainty =       0.005856152032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000460411804
  error estimate for blocks of size 2^( 2) =       0.000471594648
  error estimate for blocks of size 2^( 3) =       0.000481366799
  error estimate for blocks of size 2^( 4) =       0.000488235578
  error estimate for blocks of size 2^( 5) =       0.000493120616
  error estimate for blocks of size 2^( 6) =       0.000495534187
  error estimate for blocks of size 2^( 7) =       0.000496482320

      target function =                  N/A
              le_mean =     -17.200606427214
             les_mean =     296.284819310876
             stat err =       0.000493343175
             autocorr =       1.148167765463
              std dev =       0.651120617814
             le_variance =       0.423958058943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421375703062
                                         uncertainty =       0.005802263662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421375703062
                                         uncertainty =       0.005802263662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000458952223
  error estimate for blocks of size 2^( 2) =       0.000470180624
  error estimate for blocks of size 2^( 3) =       0.000480044083
  error estimate for blocks of size 2^( 4) =       0.000486992930
  error estimate for blocks of size 2^( 5) =       0.000491916215
  error estimate for blocks of size 2^( 6) =       0.000494423623
  error estimate for blocks of size 2^( 7) =       0.000495569784

      target function =                  N/A
              le_mean =     -17.200583181475
             les_mean =     296.281335858834
             stat err =       0.000492225638
             autocorr =       1.150253344403
              std dev =       0.649056458734
             le_variance =       0.421274286625


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.200614310192        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
     3.9062e-03     3.9062e-02             4.5809e-02       -17.200606427214
     1.5625e-02     1.5625e-01             1.1651e-02       -17.200583181475

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0746
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.912540e-01 1 1  ON 0
 uu_1                 3.556002e-02 1 1  ON 1
 uu_2                -4.550518e-02 1 1  ON 2
 uu_3                -9.255495e-02 1 1  ON 3
 uu_4                -1.233629e-01 1 1  ON 4
 uu_5                -1.293536e-01 1 1  ON 5
 uu_6                -1.048659e-01 1 1  ON 6
 uu_7                -3.048577e-02 1 1  ON 7
 uu_8                 1.051512e-01 1 1  ON 8
 uu_9                 1.109968e-01 1 1  ON 9
 ud_0                 3.124040e-01 1 1  ON 10
 ud_1                 7.393421e-02 1 1  ON 11
 ud_2                -8.886695e-03 1 1  ON 12
 ud_3                -5.603883e-02 1 1  ON 13
 ud_4                -1.058839e-01 1 1  ON 14
 ud_5                -1.474931e-01 1 1  ON 15
 ud_6                -1.544524e-01 1 1  ON 16
 ud_7                -1.053877e-01 1 1  ON 17
 ud_8                 1.730439e-02 1 1  ON 18
 ud_9                 9.022874e-02 1 1  ON 19
 eO_0                -6.670538e-01 1 1  ON 20
 eO_1                -3.899241e-01 1 1  ON 21
 eO_2                -5.317480e-02 1 1  ON 22
 eO_3                 1.657136e-01 1 1  ON 23
 eO_4                 2.592306e-01 1 1  ON 24
 eO_5                 3.055636e-01 1 1  ON 25
 eO_6                 2.321390e-01 1 1  ON 26
 eO_7                 9.496607e-02 1 1  ON 27
 eO_8                 2.528142e-02 1 1  ON 28
 eO_9                 1.744251e-02 1 1  ON 29
eH1_0                -1.736438e-01 1 1  ON 30
eH1_1                -9.556648e-02 1 1  ON 31
eH1_2                -5.883761e-02 1 1  ON 32
eH1_3                -2.614754e-02 1 1  ON 33
eH1_4                 2.094177e-02 1 1  ON 34
eH1_5                 3.196002e-02 1 1  ON 35
eH1_6                 7.366789e-02 1 1  ON 36
eH1_7                 1.104527e-01 1 1  ON 37
eH1_8                 8.094140e-02 1 1  ON 38
eH1_9                 2.165284e-02 1 1  ON 39
eH2_0                -1.753418e-01 1 1  ON 40
eH2_1                -9.925090e-02 1 1  ON 41
eH2_2                -6.274261e-02 1 1  ON 42
eH2_3                -2.920474e-02 1 1  ON 43
eH2_4                 1.821142e-02 1 1  ON 44
eH2_5                 3.349559e-02 1 1  ON 45
eH2_6                 8.401261e-02 1 1  ON 46
eH2_7                 1.139003e-01 1 1  ON 47
eH2_8                 8.252286e-02 1 1  ON 48
eH2_9                 2.323815e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4824e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2384
    reference variance = 0.550288
====================================================
  Execution time = 2.0509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.2111e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421181742212
                                         uncertainty =       0.005039698986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421181742212
                                         uncertainty =       0.005039698986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000458863949
  error estimate for blocks of size 2^( 2) =       0.000470097738
  error estimate for blocks of size 2^( 3) =       0.000479678679
  error estimate for blocks of size 2^( 4) =       0.000486895210
  error estimate for blocks of size 2^( 5) =       0.000490428536
  error estimate for blocks of size 2^( 6) =       0.000491587715
  error estimate for blocks of size 2^( 7) =       0.000493939020

      target function =                  N/A
              le_mean =     -17.200911428145
             les_mean =     296.292465995774
             stat err =       0.000490712620
             autocorr =       1.143632735015
              std dev =       0.648931620017
             le_variance =       0.421112247458


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720091142814e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200911428145       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200915235046       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200916542873       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200921413265       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200924853849       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200929360426       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200931355143       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200935257097       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200940381886       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200940608062       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.200942188043       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.200941190077       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.200941087021       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.200941152678       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.200943326622       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.200942429781       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.200940816394       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.200939906947       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.200940445620       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.200941654388       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.200942717918       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 1.715374e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200911428145       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200914850648       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200916067927       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200918852839       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200921721234       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200925791959       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200926939625       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200929059179       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200931245933       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200930763436       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.200930579527       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.200929816546       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.200929447114       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.200929650052       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.200929733315       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.200929742859       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.826724e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200911428145       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200913866007       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200914834935       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200915550738       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200917519529       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200919571473       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200919818559       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200920359633       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200920738732       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200920457679       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.200920254893       residual = 9.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.573244e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154574 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6644e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.914602e-01 1 1  ON 0
 uu_1                 3.558760e-02 1 1  ON 1
 uu_2                -4.556236e-02 1 1  ON 2
 uu_3                -9.327280e-02 1 1  ON 3
 uu_4                -1.239652e-01 1 1  ON 4
 uu_5                -1.299512e-01 1 1  ON 5
 uu_6                -1.050844e-01 1 1  ON 6
 uu_7                -3.118080e-02 1 1  ON 7
 uu_8                 1.040798e-01 1 1  ON 8
 uu_9                 1.126661e-01 1 1  ON 9
 ud_0                 3.140978e-01 1 1  ON 10
 ud_1                 7.531819e-02 1 1  ON 11
 ud_2                -7.861202e-03 1 1  ON 12
 ud_3                -5.575411e-02 1 1  ON 13
 ud_4                -1.055943e-01 1 1  ON 14
 ud_5                -1.476325e-01 1 1  ON 15
 ud_6                -1.554261e-01 1 1  ON 16
 ud_7                -1.082238e-01 1 1  ON 17
 ud_8                 1.338835e-02 1 1  ON 18
 ud_9                 9.098538e-02 1 1  ON 19
 eO_0                -6.718806e-01 1 1  ON 20
 eO_1                -3.943331e-01 1 1  ON 21
 eO_2                -5.452768e-02 1 1  ON 22
 eO_3                 1.659804e-01 1 1  ON 23
 eO_4                 2.612322e-01 1 1  ON 24
 eO_5                 3.052656e-01 1 1  ON 25
 eO_6                 2.364279e-01 1 1  ON 26
 eO_7                 9.831644e-02 1 1  ON 27
 eO_8                 2.569922e-02 1 1  ON 28
 eO_9                 1.767613e-02 1 1  ON 29
eH1_0                -1.738957e-01 1 1  ON 30
eH1_1                -9.705624e-02 1 1  ON 31
eH1_2                -6.067580e-02 1 1  ON 32
eH1_3                -2.808969e-02 1 1  ON 33
eH1_4                 1.829760e-02 1 1  ON 34
eH1_5                 3.393610e-02 1 1  ON 35
eH1_6                 7.606716e-02 1 1  ON 36
eH1_7                 1.114599e-01 1 1  ON 37
eH1_8                 8.302213e-02 1 1  ON 38
eH1_9                 2.217752e-02 1 1  ON 39
eH2_0                -1.755058e-01 1 1  ON 40
eH2_1                -9.903987e-02 1 1  ON 41
eH2_2                -6.258564e-02 1 1  ON 42
eH2_3                -2.981768e-02 1 1  ON 43
eH2_4                 1.671667e-02 1 1  ON 44
eH2_5                 3.348698e-02 1 1  ON 45
eH2_6                 8.197154e-02 1 1  ON 46
eH2_7                 1.140450e-01 1 1  ON 47
eH2_8                 8.515914e-02 1 1  ON 48
eH2_9                 2.403415e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1976
    reference variance = 0.248844
====================================================
  Execution time = 1.9981e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.7394e-01
  Total weights = 2.0000e+06
  Execution time = 1.8218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473485660787
                                         uncertainty =       0.052601511187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473485660787
                                         uncertainty =       0.052601511187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486495428
  error estimate for blocks of size 2^( 2) =       0.000497514192
  error estimate for blocks of size 2^( 3) =       0.000506832178
  error estimate for blocks of size 2^( 4) =       0.000512648991
  error estimate for blocks of size 2^( 5) =       0.000516825816
  error estimate for blocks of size 2^( 6) =       0.000519731509
  error estimate for blocks of size 2^( 7) =       0.000521835162

      target function =                  N/A
              le_mean =     -17.200751384276
             les_mean =     296.339203550107
             stat err =       0.000517760370
             autocorr =       1.132661358652
              std dev =       0.688008432434
             le_variance =       0.473355603100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474462486405
                                         uncertainty =       0.052629073897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474462486405
                                         uncertainty =       0.052629073897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486996826
  error estimate for blocks of size 2^( 2) =       0.000497990920
  error estimate for blocks of size 2^( 3) =       0.000507270713
  error estimate for blocks of size 2^( 4) =       0.000513048706
  error estimate for blocks of size 2^( 5) =       0.000517219513
  error estimate for blocks of size 2^( 6) =       0.000520082393
  error estimate for blocks of size 2^( 7) =       0.000522202945

      target function =                  N/A
              le_mean =     -17.200745667784
             les_mean =     296.339983107265
             stat err =       0.000518138389
             autocorr =       1.131981372264
              std dev =       0.688717515860
             le_variance =       0.474331816653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474713382762
                                         uncertainty =       0.052635528906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474713382762
                                         uncertainty =       0.052635528906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487125511
  error estimate for blocks of size 2^( 2) =       0.000498127840
  error estimate for blocks of size 2^( 3) =       0.000507414360
  error estimate for blocks of size 2^( 4) =       0.000513203208
  error estimate for blocks of size 2^( 5) =       0.000517374532
  error estimate for blocks of size 2^( 6) =       0.000520242568
  error estimate for blocks of size 2^( 7) =       0.000522373233

      target function =                  N/A
              le_mean =     -17.200751313727
             les_mean =     296.340428046866
             stat err =       0.000518298385
             autocorr =       1.132082201175
              std dev =       0.688899504624
             le_variance =       0.474582527472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473786396072
                                         uncertainty =       0.052611170849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473786396072
                                         uncertainty =       0.052611170849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486649815
  error estimate for blocks of size 2^( 2) =       0.000497664242
  error estimate for blocks of size 2^( 3) =       0.000506973746
  error estimate for blocks of size 2^( 4) =       0.000512784150
  error estimate for blocks of size 2^( 5) =       0.000516957098
  error estimate for blocks of size 2^( 6) =       0.000519856537
  error estimate for blocks of size 2^( 7) =       0.000521972595

      target function =                  N/A
              le_mean =     -17.200747213504
             les_mean =     296.339360551603
             stat err =       0.000517892595
             autocorr =       1.132521034272
              std dev =       0.688226768998
             le_variance =       0.473656085566


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.200751384276        initial  <--
     9.7656e-03     9.7656e-02             1.7154e-02       -17.200745667784
     3.9062e-02     3.9062e-01             4.8267e-03       -17.200751313727
     1.5625e-01     1.5625e+00             1.5732e-03       -17.200747213504

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2041
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.912540e-01 1 1  ON 0
 uu_1                 3.556002e-02 1 1  ON 1
 uu_2                -4.550518e-02 1 1  ON 2
 uu_3                -9.255495e-02 1 1  ON 3
 uu_4                -1.233629e-01 1 1  ON 4
 uu_5                -1.293536e-01 1 1  ON 5
 uu_6                -1.048659e-01 1 1  ON 6
 uu_7                -3.048577e-02 1 1  ON 7
 uu_8                 1.051512e-01 1 1  ON 8
 uu_9                 1.109968e-01 1 1  ON 9
 ud_0                 3.124040e-01 1 1  ON 10
 ud_1                 7.393421e-02 1 1  ON 11
 ud_2                -8.886695e-03 1 1  ON 12
 ud_3                -5.603883e-02 1 1  ON 13
 ud_4                -1.058839e-01 1 1  ON 14
 ud_5                -1.474931e-01 1 1  ON 15
 ud_6                -1.544524e-01 1 1  ON 16
 ud_7                -1.053877e-01 1 1  ON 17
 ud_8                 1.730439e-02 1 1  ON 18
 ud_9                 9.022874e-02 1 1  ON 19
 eO_0                -6.670538e-01 1 1  ON 20
 eO_1                -3.899241e-01 1 1  ON 21
 eO_2                -5.317480e-02 1 1  ON 22
 eO_3                 1.657136e-01 1 1  ON 23
 eO_4                 2.592306e-01 1 1  ON 24
 eO_5                 3.055636e-01 1 1  ON 25
 eO_6                 2.321390e-01 1 1  ON 26
 eO_7                 9.496607e-02 1 1  ON 27
 eO_8                 2.528142e-02 1 1  ON 28
 eO_9                 1.744251e-02 1 1  ON 29
eH1_0                -1.736438e-01 1 1  ON 30
eH1_1                -9.556648e-02 1 1  ON 31
eH1_2                -5.883761e-02 1 1  ON 32
eH1_3                -2.614754e-02 1 1  ON 33
eH1_4                 2.094177e-02 1 1  ON 34
eH1_5                 3.196002e-02 1 1  ON 35
eH1_6                 7.366789e-02 1 1  ON 36
eH1_7                 1.104527e-01 1 1  ON 37
eH1_8                 8.094140e-02 1 1  ON 38
eH1_9                 2.165284e-02 1 1  ON 39
eH2_0                -1.753418e-01 1 1  ON 40
eH2_1                -9.925090e-02 1 1  ON 41
eH2_2                -6.274261e-02 1 1  ON 42
eH2_3                -2.920474e-02 1 1  ON 43
eH2_4                 1.821142e-02 1 1  ON 44
eH2_5                 3.349559e-02 1 1  ON 45
eH2_6                 8.401261e-02 1 1  ON 46
eH2_7                 1.139003e-01 1 1  ON 47
eH2_8                 8.252286e-02 1 1  ON 48
eH2_9                 2.323815e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5854e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2843
    reference variance = 0.873913
====================================================
  Execution time = 2.0278e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.2585e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5317e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.425764070011
                                         uncertainty =       0.005948499949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.425764070011
                                         uncertainty =       0.005948499949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000461439567
  error estimate for blocks of size 2^( 2) =       0.000473083472
  error estimate for blocks of size 2^( 3) =       0.000483183457
  error estimate for blocks of size 2^( 4) =       0.000489855608
  error estimate for blocks of size 2^( 5) =       0.000495654070
  error estimate for blocks of size 2^( 6) =       0.000498502271
  error estimate for blocks of size 2^( 7) =       0.000498679577

      target function =                  N/A
              le_mean =     -17.200982961907
             les_mean =     296.299667591388
             stat err =       0.000495672881
             autocorr =       1.153880023927
              std dev =       0.652574094250
             le_variance =       0.425852948487


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720098296191e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200982961907       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200980488036       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200984554440       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200987727772       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200990751932       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200991489918       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200990091386       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200990044227       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200989465497       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200990556263       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.200991336732       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.200991066395       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.841935e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200982961907       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200981629235       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200983387185       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200984686891       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200986196927       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200986090318       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200985733644       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200985634247       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200985582825       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200985724421       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 8.552783e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200982961907       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200982493515       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200983038477       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200983382481       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200983866785       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200983792752       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200983789584       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200983738108       residual = 7.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.315414e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158529 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5817e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.912948e-01 1 1  ON 0
 uu_1                 3.569078e-02 1 1  ON 1
 uu_2                -4.545533e-02 1 1  ON 2
 uu_3                -9.263873e-02 1 1  ON 3
 uu_4                -1.234282e-01 1 1  ON 4
 uu_5                -1.296943e-01 1 1  ON 5
 uu_6                -1.049631e-01 1 1  ON 6
 uu_7                -3.046194e-02 1 1  ON 7
 uu_8                 1.051247e-01 1 1  ON 8
 uu_9                 1.111831e-01 1 1  ON 9
 ud_0                 3.125773e-01 1 1  ON 10
 ud_1                 7.404914e-02 1 1  ON 11
 ud_2                -8.783693e-03 1 1  ON 12
 ud_3                -5.619703e-02 1 1  ON 13
 ud_4                -1.059211e-01 1 1  ON 14
 ud_5                -1.476072e-01 1 1  ON 15
 ud_6                -1.543711e-01 1 1  ON 16
 ud_7                -1.054630e-01 1 1  ON 17
 ud_8                 1.700996e-02 1 1  ON 18
 ud_9                 9.028298e-02 1 1  ON 19
 eO_0                -6.679091e-01 1 1  ON 20
 eO_1                -3.905820e-01 1 1  ON 21
 eO_2                -5.318987e-02 1 1  ON 22
 eO_3                 1.657668e-01 1 1  ON 23
 eO_4                 2.598154e-01 1 1  ON 24
 eO_5                 3.055109e-01 1 1  ON 25
 eO_6                 2.326667e-01 1 1  ON 26
 eO_7                 9.531221e-02 1 1  ON 27
 eO_8                 2.530941e-02 1 1  ON 28
 eO_9                 1.746619e-02 1 1  ON 29
eH1_0                -1.734484e-01 1 1  ON 30
eH1_1                -9.580557e-02 1 1  ON 31
eH1_2                -5.928940e-02 1 1  ON 32
eH1_3                -2.637282e-02 1 1  ON 33
eH1_4                 2.061590e-02 1 1  ON 34
eH1_5                 3.250560e-02 1 1  ON 35
eH1_6                 7.384706e-02 1 1  ON 36
eH1_7                 1.104845e-01 1 1  ON 37
eH1_8                 8.115725e-02 1 1  ON 38
eH1_9                 2.170371e-02 1 1  ON 39
eH2_0                -1.756887e-01 1 1  ON 40
eH2_1                -9.917325e-02 1 1  ON 41
eH2_2                -6.263507e-02 1 1  ON 42
eH2_3                -2.923117e-02 1 1  ON 43
eH2_4                 1.807583e-02 1 1  ON 44
eH2_5                 3.368187e-02 1 1  ON 45
eH2_6                 8.373968e-02 1 1  ON 46
eH2_7                 1.139835e-01 1 1  ON 47
eH2_8                 8.277503e-02 1 1  ON 48
eH2_9                 2.329743e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1706
    reference variance = 0.23418
====================================================
  Execution time = 1.9899e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.2179e-01
  Total weights = 2.0000e+06
  Execution time = 1.8430e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421478183815
                                         uncertainty =       0.005265391769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421478183815
                                         uncertainty =       0.005265391769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000459188056
  error estimate for blocks of size 2^( 2) =       0.000470622272
  error estimate for blocks of size 2^( 3) =       0.000480167977
  error estimate for blocks of size 2^( 4) =       0.000486607431
  error estimate for blocks of size 2^( 5) =       0.000490223415
  error estimate for blocks of size 2^( 6) =       0.000491864075
  error estimate for blocks of size 2^( 7) =       0.000492702417

      target function =                  N/A
              le_mean =     -17.200244621166
             les_mean =     296.270122158946
             stat err =       0.000490349334
             autocorr =       1.140328592507
              std dev =       0.649389976709
             le_variance =       0.421707341850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421798168990
                                         uncertainty =       0.005270922838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421798168990
                                         uncertainty =       0.005270922838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000459362251
  error estimate for blocks of size 2^( 2) =       0.000470788107
  error estimate for blocks of size 2^( 3) =       0.000480325438
  error estimate for blocks of size 2^( 4) =       0.000486754932
  error estimate for blocks of size 2^( 5) =       0.000490365493
  error estimate for blocks of size 2^( 6) =       0.000492010484
  error estimate for blocks of size 2^( 7) =       0.000492852498

      target function =                  N/A
              le_mean =     -17.200241161863
             les_mean =     296.270323169624
             stat err =       0.000490495852
             autocorr =       1.140144960783
              std dev =       0.649636324706
             le_variance =       0.422027354377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421653705337
                                         uncertainty =       0.005268575414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421653705337
                                         uncertainty =       0.005268575414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000459283641
  error estimate for blocks of size 2^( 2) =       0.000470713821
  error estimate for blocks of size 2^( 3) =       0.000480256719
  error estimate for blocks of size 2^( 4) =       0.000486690474
  error estimate for blocks of size 2^( 5) =       0.000490304155
  error estimate for blocks of size 2^( 6) =       0.000491949062
  error estimate for blocks of size 2^( 7) =       0.000492789919

      target function =                  N/A
              le_mean =     -17.200240509782
             les_mean =     296.270156308780
             stat err =       0.000490433402
             autocorr =       1.140244877306
              std dev =       0.649525153755
             le_variance =       0.421882925361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421495078057
                                         uncertainty =       0.005265695162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421495078057
                                         uncertainty =       0.005265695162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000459197263
  error estimate for blocks of size 2^( 2) =       0.000470631033
  error estimate for blocks of size 2^( 3) =       0.000480176761
  error estimate for blocks of size 2^( 4) =       0.000486615516
  error estimate for blocks of size 2^( 5) =       0.000490231343
  error estimate for blocks of size 2^( 6) =       0.000491872533
  error estimate for blocks of size 2^( 7) =       0.000492710923

      target function =                  N/A
              le_mean =     -17.200243588268
             les_mean =     296.270103538047
             stat err =       0.000490357579
             autocorr =       1.140321209361
              std dev =       0.649402997490
             le_variance =       0.421724253148


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.200244621166        initial  <--
     9.7656e-02     9.7656e-01             2.8419e-03       -17.200241161863
     3.9062e-01     3.9062e+00             8.5528e-04       -17.200240509782
     1.5625e+00     1.5625e+01             2.3154e-04       -17.200243588268

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1820
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.912540e-01 1 1  ON 0
 uu_1                 3.556002e-02 1 1  ON 1
 uu_2                -4.550518e-02 1 1  ON 2
 uu_3                -9.255495e-02 1 1  ON 3
 uu_4                -1.233629e-01 1 1  ON 4
 uu_5                -1.293536e-01 1 1  ON 5
 uu_6                -1.048659e-01 1 1  ON 6
 uu_7                -3.048577e-02 1 1  ON 7
 uu_8                 1.051512e-01 1 1  ON 8
 uu_9                 1.109968e-01 1 1  ON 9
 ud_0                 3.124040e-01 1 1  ON 10
 ud_1                 7.393421e-02 1 1  ON 11
 ud_2                -8.886695e-03 1 1  ON 12
 ud_3                -5.603883e-02 1 1  ON 13
 ud_4                -1.058839e-01 1 1  ON 14
 ud_5                -1.474931e-01 1 1  ON 15
 ud_6                -1.544524e-01 1 1  ON 16
 ud_7                -1.053877e-01 1 1  ON 17
 ud_8                 1.730439e-02 1 1  ON 18
 ud_9                 9.022874e-02 1 1  ON 19
 eO_0                -6.670538e-01 1 1  ON 20
 eO_1                -3.899241e-01 1 1  ON 21
 eO_2                -5.317480e-02 1 1  ON 22
 eO_3                 1.657136e-01 1 1  ON 23
 eO_4                 2.592306e-01 1 1  ON 24
 eO_5                 3.055636e-01 1 1  ON 25
 eO_6                 2.321390e-01 1 1  ON 26
 eO_7                 9.496607e-02 1 1  ON 27
 eO_8                 2.528142e-02 1 1  ON 28
 eO_9                 1.744251e-02 1 1  ON 29
eH1_0                -1.736438e-01 1 1  ON 30
eH1_1                -9.556648e-02 1 1  ON 31
eH1_2                -5.883761e-02 1 1  ON 32
eH1_3                -2.614754e-02 1 1  ON 33
eH1_4                 2.094177e-02 1 1  ON 34
eH1_5                 3.196002e-02 1 1  ON 35
eH1_6                 7.366789e-02 1 1  ON 36
eH1_7                 1.104527e-01 1 1  ON 37
eH1_8                 8.094140e-02 1 1  ON 38
eH1_9                 2.165284e-02 1 1  ON 39
eH2_0                -1.753418e-01 1 1  ON 40
eH2_1                -9.925090e-02 1 1  ON 41
eH2_2                -6.274261e-02 1 1  ON 42
eH2_3                -2.920474e-02 1 1  ON 43
eH2_4                 1.821142e-02 1 1  ON 44
eH2_5                 3.349559e-02 1 1  ON 45
eH2_6                 8.401261e-02 1 1  ON 46
eH2_7                 1.139003e-01 1 1  ON 47
eH2_8                 8.252286e-02 1 1  ON 48
eH2_9                 2.323815e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5004e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2373
    reference variance = 0.276431
====================================================
  Execution time = 2.0350e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.2828e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4572e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428264783332
                                         uncertainty =       0.012132802693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428264783332
                                         uncertainty =       0.012132802693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000462752268
  error estimate for blocks of size 2^( 2) =       0.000474583418
  error estimate for blocks of size 2^( 3) =       0.000484429857
  error estimate for blocks of size 2^( 4) =       0.000491822388
  error estimate for blocks of size 2^( 5) =       0.000495030998
  error estimate for blocks of size 2^( 6) =       0.000497173934
  error estimate for blocks of size 2^( 7) =       0.000495121606

      target function =                  N/A
              le_mean =     -17.200605743769
             les_mean =     296.289117061257
             stat err =       0.000494787232
             autocorr =       1.143246435452
              std dev =       0.654430533218
             le_variance =       0.428279322808


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720060574377e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200605743769       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200606523570       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200607701157       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200607328510       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200607675893       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200607863786       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200607960441       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200607897387       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.837265e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200605743769       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200605975845       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200606368670       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200606228115       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200606319140       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200606387861       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200606387204       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200606394825       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 8.056958e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200605743769       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200605804688       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200605911922       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200605873221       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200605896445       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200605913299       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200605913673       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200605915076       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.092914e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161299 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5813e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.912797e-01 1 1  ON 0
 uu_1                 3.556915e-02 1 1  ON 1
 uu_2                -4.551175e-02 1 1  ON 2
 uu_3                -9.256945e-02 1 1  ON 3
 uu_4                -1.233745e-01 1 1  ON 4
 uu_5                -1.293721e-01 1 1  ON 5
 uu_6                -1.048765e-01 1 1  ON 6
 uu_7                -3.048823e-02 1 1  ON 7
 uu_8                 1.051442e-01 1 1  ON 8
 uu_9                 1.110137e-01 1 1  ON 9
 ud_0                 3.124405e-01 1 1  ON 10
 ud_1                 7.394249e-02 1 1  ON 11
 ud_2                -8.860690e-03 1 1  ON 12
 ud_3                -5.607878e-02 1 1  ON 13
 ud_4                -1.058661e-01 1 1  ON 14
 ud_5                -1.474845e-01 1 1  ON 15
 ud_6                -1.544783e-01 1 1  ON 16
 ud_7                -1.054028e-01 1 1  ON 17
 ud_8                 1.726961e-02 1 1  ON 18
 ud_9                 9.022992e-02 1 1  ON 19
 eO_0                -6.671059e-01 1 1  ON 20
 eO_1                -3.900046e-01 1 1  ON 21
 eO_2                -5.314418e-02 1 1  ON 22
 eO_3                 1.657016e-01 1 1  ON 23
 eO_4                 2.592725e-01 1 1  ON 24
 eO_5                 3.055506e-01 1 1  ON 25
 eO_6                 2.321839e-01 1 1  ON 26
 eO_7                 9.499890e-02 1 1  ON 27
 eO_8                 2.528392e-02 1 1  ON 28
 eO_9                 1.744475e-02 1 1  ON 29
eH1_0                -1.736007e-01 1 1  ON 30
eH1_1                -9.560005e-02 1 1  ON 31
eH1_2                -5.888624e-02 1 1  ON 32
eH1_3                -2.614385e-02 1 1  ON 33
eH1_4                 2.089242e-02 1 1  ON 34
eH1_5                 3.201274e-02 1 1  ON 35
eH1_6                 7.366791e-02 1 1  ON 36
eH1_7                 1.104568e-01 1 1  ON 37
eH1_8                 8.096428e-02 1 1  ON 38
eH1_9                 2.165684e-02 1 1  ON 39
eH2_0                -1.753661e-01 1 1  ON 40
eH2_1                -9.925478e-02 1 1  ON 41
eH2_2                -6.273499e-02 1 1  ON 42
eH2_3                -2.920272e-02 1 1  ON 43
eH2_4                 1.821418e-02 1 1  ON 44
eH2_5                 3.350556e-02 1 1  ON 45
eH2_6                 8.398521e-02 1 1  ON 46
eH2_7                 1.139002e-01 1 1  ON 47
eH2_8                 8.254728e-02 1 1  ON 48
eH2_9                 2.324408e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.233
    reference variance = 0.518334
====================================================
  Execution time = 1.9950e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.1623e-01
  Total weights = 2.0000e+06
  Execution time = 1.8173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416304079451
                                         uncertainty =       0.004723575130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416304079451
                                         uncertainty =       0.004723575130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456186165
  error estimate for blocks of size 2^( 2) =       0.000467958183
  error estimate for blocks of size 2^( 3) =       0.000477522918
  error estimate for blocks of size 2^( 4) =       0.000484099383
  error estimate for blocks of size 2^( 5) =       0.000487925411
  error estimate for blocks of size 2^( 6) =       0.000490500958
  error estimate for blocks of size 2^( 7) =       0.000492123356

      target function =                  N/A
              le_mean =     -17.200607805030
             les_mean =     296.277120288224
             stat err =       0.000488662277
             autocorr =       1.147449045893
              std dev =       0.645144661197
             le_variance =       0.416211633871

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416377531213
                                         uncertainty =       0.004723932712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416377531213
                                         uncertainty =       0.004723932712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456226395
  error estimate for blocks of size 2^( 2) =       0.000467996513
  error estimate for blocks of size 2^( 3) =       0.000477559566
  error estimate for blocks of size 2^( 4) =       0.000484134382
  error estimate for blocks of size 2^( 5) =       0.000487960416
  error estimate for blocks of size 2^( 6) =       0.000490536085
  error estimate for blocks of size 2^( 7) =       0.000492158652

      target function =                  N/A
              le_mean =     -17.200609300919
             les_mean =     296.277245161162
             stat err =       0.000488697384
             autocorr =       1.147411539297
              std dev =       0.645201554910
             le_variance =       0.416285046458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416346256982
                                         uncertainty =       0.004723743926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416346256982
                                         uncertainty =       0.004723743926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456209264
  error estimate for blocks of size 2^( 2) =       0.000467980293
  error estimate for blocks of size 2^( 3) =       0.000477544098
  error estimate for blocks of size 2^( 4) =       0.000484119807
  error estimate for blocks of size 2^( 5) =       0.000487945865
  error estimate for blocks of size 2^( 6) =       0.000490521540
  error estimate for blocks of size 2^( 7) =       0.000492144133

      target function =                  N/A
              le_mean =     -17.200608741217
             les_mean =     296.277194646173
             stat err =       0.000488682836
             autocorr =       1.147429392026
              std dev =       0.645177329002
             le_variance =       0.416253785858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416309517904
                                         uncertainty =       0.004723595629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416309517904
                                         uncertainty =       0.004723595629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456189143
  error estimate for blocks of size 2^( 2) =       0.000467961037
  error estimate for blocks of size 2^( 3) =       0.000477525650
  error estimate for blocks of size 2^( 4) =       0.000484102026
  error estimate for blocks of size 2^( 5) =       0.000487928055
  error estimate for blocks of size 2^( 6) =       0.000490503621
  error estimate for blocks of size 2^( 7) =       0.000492126052

      target function =                  N/A
              le_mean =     -17.200607924503
             les_mean =     296.277129833233
             stat err =       0.000488664939
             autocorr =       1.147446562068
              std dev =       0.645148873413
             le_variance =       0.416217068866


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.200607805030        initial
     9.7656e-01     9.7656e+00             2.8373e-04       -17.200609300919  <--
     3.9062e+00     3.9062e+01             8.0570e-05       -17.200608741217
     1.5625e+01     1.5625e+02             2.0929e-05       -17.200607924503

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.9130e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.913450e-01 1 1  ON 0
 uu_1                 3.559124e-02 1 1  ON 1
 uu_2                -4.552808e-02 1 1  ON 2
 uu_3                -9.260280e-02 1 1  ON 3
 uu_4                -1.234077e-01 1 1  ON 4
 uu_5                -1.294261e-01 1 1  ON 5
 uu_6                -1.049075e-01 1 1  ON 6
 uu_7                -3.049547e-02 1 1  ON 7
 uu_8                 1.051235e-01 1 1  ON 8
 uu_9                 1.110637e-01 1 1  ON 9
 ud_0                 3.125289e-01 1 1  ON 10
 ud_1                 7.398419e-02 1 1  ON 11
 ud_2                -8.808970e-03 1 1  ON 12
 ud_3                -5.615001e-02 1 1  ON 13
 ud_4                -1.058410e-01 1 1  ON 14
 ud_5                -1.474576e-01 1 1  ON 15
 ud_6                -1.545490e-01 1 1  ON 16
 ud_7                -1.054469e-01 1 1  ON 17
 ud_8                 1.716668e-02 1 1  ON 18
 ud_9                 9.023338e-02 1 1  ON 19
 eO_0                -6.672693e-01 1 1  ON 20
 eO_1                -3.902078e-01 1 1  ON 21
 eO_2                -5.308728e-02 1 1  ON 22
 eO_3                 1.656753e-01 1 1  ON 23
 eO_4                 2.593920e-01 1 1  ON 24
 eO_5                 3.055148e-01 1 1  ON 25
 eO_6                 2.323169e-01 1 1  ON 26
 eO_7                 9.509603e-02 1 1  ON 27
 eO_8                 2.529132e-02 1 1  ON 28
 eO_9                 1.745138e-02 1 1  ON 29
eH1_0                -1.734913e-01 1 1  ON 30
eH1_1                -9.569545e-02 1 1  ON 31
eH1_2                -5.901472e-02 1 1  ON 32
eH1_3                -2.614804e-02 1 1  ON 33
eH1_4                 2.076308e-02 1 1  ON 34
eH1_5                 3.216438e-02 1 1  ON 35
eH1_6                 7.366883e-02 1 1  ON 36
eH1_7                 1.104697e-01 1 1  ON 37
eH1_8                 8.103201e-02 1 1  ON 38
eH1_9                 2.166867e-02 1 1  ON 39
eH2_0                -1.754374e-01 1 1  ON 40
eH2_1                -9.926082e-02 1 1  ON 41
eH2_2                -6.271683e-02 1 1  ON 42
eH2_3                -2.919653e-02 1 1  ON 43
eH2_4                 1.821931e-02 1 1  ON 44
eH2_5                 3.353564e-02 1 1  ON 45
eH2_6                 8.390461e-02 1 1  ON 46
eH2_7                 1.139002e-01 1 1  ON 47
eH2_8                 8.261949e-02 1 1  ON 48
eH2_9                 2.326162e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4948e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1916
    reference variance = 0.211263
====================================================
  Execution time = 2.0339e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7202e+01
  VMC Evar = 4.8731e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487453180002
                                         uncertainty =       0.073626736032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487453180002
                                         uncertainty =       0.073626736032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493611859
  error estimate for blocks of size 2^( 2) =       0.000504136584
  error estimate for blocks of size 2^( 3) =       0.000513622489
  error estimate for blocks of size 2^( 4) =       0.000520712836
  error estimate for blocks of size 2^( 5) =       0.000524884819
  error estimate for blocks of size 2^( 6) =       0.000525140171
  error estimate for blocks of size 2^( 7) =       0.000524028021

      target function =                  N/A
              le_mean =     -17.201702547709
             les_mean =     296.385875631357
             stat err =       0.000523691462
             autocorr =       1.125588937230
              std dev =       0.698072585864
             le_variance =       0.487305335135


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720170254771e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.201702547709       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.201702812083       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.201702316889       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.201701736953       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.201703859056       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.201704252127       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.201704180954       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.201704142583       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.201703962238       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.201704204046       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.003142e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.201702547709       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.201702642629       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.201702438352       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.201702219765       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.201703159096       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.201703086087       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.201703150189       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.201703024034       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.824901e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.201702547709       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.201702574343       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.201702512858       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.201702452190       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.201702746453       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.201702702722       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.201702717478       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.201702692279       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 7.342747e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164460 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5991e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.912817e-01 1 1  ON 0
 uu_1                 3.558488e-02 1 1  ON 1
 uu_2                -4.549642e-02 1 1  ON 2
 uu_3                -9.257552e-02 1 1  ON 3
 uu_4                -1.234424e-01 1 1  ON 4
 uu_5                -1.295543e-01 1 1  ON 5
 uu_6                -1.049071e-01 1 1  ON 6
 uu_7                -3.045625e-02 1 1  ON 7
 uu_8                 1.051210e-01 1 1  ON 8
 uu_9                 1.111346e-01 1 1  ON 9
 ud_0                 3.126683e-01 1 1  ON 10
 ud_1                 7.397980e-02 1 1  ON 11
 ud_2                -8.801526e-03 1 1  ON 12
 ud_3                -5.614990e-02 1 1  ON 13
 ud_4                -1.058153e-01 1 1  ON 14
 ud_5                -1.475567e-01 1 1  ON 15
 ud_6                -1.546093e-01 1 1  ON 16
 ud_7                -1.054419e-01 1 1  ON 17
 ud_8                 1.707096e-02 1 1  ON 18
 ud_9                 9.025751e-02 1 1  ON 19
 eO_0                -6.674945e-01 1 1  ON 20
 eO_1                -3.904096e-01 1 1  ON 21
 eO_2                -5.313845e-02 1 1  ON 22
 eO_3                 1.655697e-01 1 1  ON 23
 eO_4                 2.596745e-01 1 1  ON 24
 eO_5                 3.054393e-01 1 1  ON 25
 eO_6                 2.325024e-01 1 1  ON 26
 eO_7                 9.525305e-02 1 1  ON 27
 eO_8                 2.531167e-02 1 1  ON 28
 eO_9                 1.745850e-02 1 1  ON 29
eH1_0                -1.734078e-01 1 1  ON 30
eH1_1                -9.573886e-02 1 1  ON 31
eH1_2                -5.912064e-02 1 1  ON 32
eH1_3                -2.619032e-02 1 1  ON 33
eH1_4                 2.051913e-02 1 1  ON 34
eH1_5                 3.232458e-02 1 1  ON 35
eH1_6                 7.372920e-02 1 1  ON 36
eH1_7                 1.104792e-01 1 1  ON 37
eH1_8                 8.112681e-02 1 1  ON 38
eH1_9                 2.169182e-02 1 1  ON 39
eH2_0                -1.755046e-01 1 1  ON 40
eH2_1                -9.923048e-02 1 1  ON 41
eH2_2                -6.257204e-02 1 1  ON 42
eH2_3                -2.921699e-02 1 1  ON 43
eH2_4                 1.815017e-02 1 1  ON 44
eH2_5                 3.350702e-02 1 1  ON 45
eH2_6                 8.378091e-02 1 1  ON 46
eH2_7                 1.139299e-01 1 1  ON 47
eH2_8                 8.269909e-02 1 1  ON 48
eH2_9                 2.327843e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2825
    reference variance = 0.63948
====================================================
  Execution time = 1.9989e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.4489e-01
  Total weights = 2.0000e+06
  Execution time = 1.8326e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444961503626
                                         uncertainty =       0.020536811774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444961503626
                                         uncertainty =       0.020536811774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471605521
  error estimate for blocks of size 2^( 2) =       0.000481842290
  error estimate for blocks of size 2^( 3) =       0.000491013054
  error estimate for blocks of size 2^( 4) =       0.000497326443
  error estimate for blocks of size 2^( 5) =       0.000499644141
  error estimate for blocks of size 2^( 6) =       0.000501802140
  error estimate for blocks of size 2^( 7) =       0.000500992916

      target function =                  N/A
              le_mean =     -17.199868748576
             les_mean =     296.280308280734
             stat err =       0.000499941410
             autocorr =       1.123777829667
              std dev =       0.666950923898
             le_variance =       0.444823534888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445104313458
                                         uncertainty =       0.020556504435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445104313458
                                         uncertainty =       0.020556504435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471681129
  error estimate for blocks of size 2^( 2) =       0.000481912697
  error estimate for blocks of size 2^( 3) =       0.000491079842
  error estimate for blocks of size 2^( 4) =       0.000497392220
  error estimate for blocks of size 2^( 5) =       0.000499704566
  error estimate for blocks of size 2^( 6) =       0.000501857530
  error estimate for blocks of size 2^( 7) =       0.000501046711

      target function =                  N/A
              le_mean =     -17.199872476803
             les_mean =     296.280579171457
             stat err =       0.000500000257
             autocorr =       1.123682069635
              std dev =       0.667057850293
             le_variance =       0.444966175638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445097104383
                                         uncertainty =       0.020558248647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445097104383
                                         uncertainty =       0.020558248647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471677297
  error estimate for blocks of size 2^( 2) =       0.000481909431
  error estimate for blocks of size 2^( 3) =       0.000491077622
  error estimate for blocks of size 2^( 4) =       0.000497390516
  error estimate for blocks of size 2^( 5) =       0.000499704831
  error estimate for blocks of size 2^( 6) =       0.000501858624
  error estimate for blocks of size 2^( 7) =       0.000501048096

      target function =                  N/A
              le_mean =     -17.199871261559
             les_mean =     296.280530135902
             stat err =       0.000500000517
             autocorr =       1.123701500338
              std dev =       0.667052429862
             le_variance =       0.444958944185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444986283105
                                         uncertainty =       0.020540861675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444986283105
                                         uncertainty =       0.020540861675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471618638
  error estimate for blocks of size 2^( 2) =       0.000481854568
  error estimate for blocks of size 2^( 3) =       0.000491024898
  error estimate for blocks of size 2^( 4) =       0.000497338168
  error estimate for blocks of size 2^( 5) =       0.000499655412
  error estimate for blocks of size 2^( 6) =       0.000501812670
  error estimate for blocks of size 2^( 7) =       0.000501003222

      target function =                  N/A
              le_mean =     -17.199869039489
             les_mean =     296.280343032103
             stat err =       0.000499952368
             autocorr =       1.123764583686
              std dev =       0.666969473772
             le_variance =       0.444848278944


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.199868748576        initial
     2.4414e-01     2.4414e+00             1.0031e-03       -17.199872476803  <--
     9.7656e-01     9.7656e+00             2.8249e-04       -17.199871261559
     3.9062e+00     3.9062e+01             7.3427e-05       -17.199869039489

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.9238e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.911944e-01 1 1  ON 0
 uu_1                 3.559717e-02 1 1  ON 1
 uu_2                -4.546688e-02 1 1  ON 2
 uu_3                -9.256724e-02 1 1  ON 3
 uu_4                -1.235482e-01 1 1  ON 4
 uu_5                -1.298543e-01 1 1  ON 5
 uu_6                -1.049588e-01 1 1  ON 6
 uu_7                -3.036398e-02 1 1  ON 7
 uu_8                 1.051101e-01 1 1  ON 8
 uu_9                 1.113490e-01 1 1  ON 9
 ud_0                 3.128894e-01 1 1  ON 10
 ud_1                 7.405147e-02 1 1  ON 11
 ud_2                -8.737270e-03 1 1  ON 12
 ud_3                -5.610591e-02 1 1  ON 13
 ud_4                -1.057922e-01 1 1  ON 14
 ud_5                -1.477403e-01 1 1  ON 15
 ud_6                -1.547920e-01 1 1  ON 16
 ud_7                -1.054531e-01 1 1  ON 17
 ud_8                 1.677700e-02 1 1  ON 18
 ud_9                 9.032961e-02 1 1  ON 19
 eO_0                -6.681400e-01 1 1  ON 20
 eO_1                -3.909855e-01 1 1  ON 21
 eO_2                -5.338438e-02 1 1  ON 22
 eO_3                 1.653856e-01 1 1  ON 23
 eO_4                 2.603952e-01 1 1  ON 24
 eO_5                 3.052381e-01 1 1  ON 25
 eO_6                 2.330588e-01 1 1  ON 26
 eO_7                 9.572491e-02 1 1  ON 27
 eO_8                 2.537327e-02 1 1  ON 28
 eO_9                 1.748008e-02 1 1  ON 29
eH1_0                -1.733176e-01 1 1  ON 30
eH1_1                -9.589458e-02 1 1  ON 31
eH1_2                -5.933901e-02 1 1  ON 32
eH1_3                -2.631257e-02 1 1  ON 33
eH1_4                 2.004020e-02 1 1  ON 34
eH1_5                 3.264584e-02 1 1  ON 35
eH1_6                 7.389113e-02 1 1  ON 36
eH1_7                 1.105126e-01 1 1  ON 37
eH1_8                 8.141270e-02 1 1  ON 38
eH1_9                 2.176174e-02 1 1  ON 39
eH2_0                -1.756394e-01 1 1  ON 40
eH2_1                -9.913635e-02 1 1  ON 41
eH2_2                -6.233995e-02 1 1  ON 42
eH2_3                -2.920011e-02 1 1  ON 43
eH2_4                 1.801696e-02 1 1  ON 44
eH2_5                 3.340532e-02 1 1  ON 45
eH2_6                 8.340623e-02 1 1  ON 46
eH2_7                 1.140175e-01 1 1  ON 47
eH2_8                 8.293786e-02 1 1  ON 48
eH2_9                 2.332920e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5234e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2207
    reference variance = 0.630172
====================================================
  Execution time = 2.0384e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.3251e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432652343324
                                         uncertainty =       0.016174058166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432652343324
                                         uncertainty =       0.016174058166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465032933
  error estimate for blocks of size 2^( 2) =       0.000476592175
  error estimate for blocks of size 2^( 3) =       0.000485914152
  error estimate for blocks of size 2^( 4) =       0.000493117893
  error estimate for blocks of size 2^( 5) =       0.000496657336
  error estimate for blocks of size 2^( 6) =       0.000498475848
  error estimate for blocks of size 2^( 7) =       0.000500048899

      target function =                  N/A
              le_mean =     -17.200078823429
             les_mean =     296.275222574176
             stat err =       0.000497074994
             autocorr =       1.142553146498
              std dev =       0.657655881338
             le_variance =       0.432511258258


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720007882343e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200078823429       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200080688704       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200082171766       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200086084238       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200089493199       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200090622433       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200093119336       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200090571823       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200088837055       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200091128150       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.200091032384       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.200091555938       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.200092139254       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.200091999440       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 3.546969e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200078823429       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200079974185       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200080655333       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200082693584       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200084360501       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200084296844       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200084837027       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200083923230       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200083730355       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200084188948       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 9.926820e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200078823429       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200079277868       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200079515295       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200080203607       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200080943964       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200080708227       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200080680463       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200080597713       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200080593465       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.577550e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169229 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5918e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.913589e-01 1 1  ON 0
 uu_1                 3.583684e-02 1 1  ON 1
 uu_2                -4.533657e-02 1 1  ON 2
 uu_3                -9.269545e-02 1 1  ON 3
 uu_4                -1.237702e-01 1 1  ON 4
 uu_5                -1.303614e-01 1 1  ON 5
 uu_6                -1.052023e-01 1 1  ON 6
 uu_7                -3.030465e-02 1 1  ON 7
 uu_8                 1.050018e-01 1 1  ON 8
 uu_9                 1.116513e-01 1 1  ON 9
 ud_0                 3.129733e-01 1 1  ON 10
 ud_1                 7.405925e-02 1 1  ON 11
 ud_2                -8.785493e-03 1 1  ON 12
 ud_3                -5.626756e-02 1 1  ON 13
 ud_4                -1.058504e-01 1 1  ON 14
 ud_5                -1.479729e-01 1 1  ON 15
 ud_6                -1.549146e-01 1 1  ON 16
 ud_7                -1.050856e-01 1 1  ON 17
 ud_8                 1.658732e-02 1 1  ON 18
 ud_9                 9.043676e-02 1 1  ON 19
 eO_0                -6.691327e-01 1 1  ON 20
 eO_1                -3.918942e-01 1 1  ON 21
 eO_2                -5.379758e-02 1 1  ON 22
 eO_3                 1.652281e-01 1 1  ON 23
 eO_4                 2.613162e-01 1 1  ON 24
 eO_5                 3.051735e-01 1 1  ON 25
 eO_6                 2.338541e-01 1 1  ON 26
 eO_7                 9.639335e-02 1 1  ON 27
 eO_8                 2.547053e-02 1 1  ON 28
 eO_9                 1.751668e-02 1 1  ON 29
eH1_0                -1.733771e-01 1 1  ON 30
eH1_1                -9.630902e-02 1 1  ON 31
eH1_2                -5.974815e-02 1 1  ON 32
eH1_3                -2.686881e-02 1 1  ON 33
eH1_4                 1.961708e-02 1 1  ON 34
eH1_5                 3.328300e-02 1 1  ON 35
eH1_6                 7.439614e-02 1 1  ON 36
eH1_7                 1.107503e-01 1 1  ON 37
eH1_8                 8.179666e-02 1 1  ON 38
eH1_9                 2.184499e-02 1 1  ON 39
eH2_0                -1.762177e-01 1 1  ON 40
eH2_1                -9.900592e-02 1 1  ON 41
eH2_2                -6.226089e-02 1 1  ON 42
eH2_3                -2.915160e-02 1 1  ON 43
eH2_4                 1.811221e-02 1 1  ON 44
eH2_5                 3.323472e-02 1 1  ON 45
eH2_6                 8.303072e-02 1 1  ON 46
eH2_7                 1.141435e-01 1 1  ON 47
eH2_8                 8.342055e-02 1 1  ON 48
eH2_9                 2.345042e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2931
    reference variance = 0.41523
====================================================
  Execution time = 2.0117e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.1368e-01
  Total weights = 2.0000e+06
  Execution time = 1.8089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.413590910980
                                         uncertainty =       0.003640790665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.413590910980
                                         uncertainty =       0.003640790665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000454721607
  error estimate for blocks of size 2^( 2) =       0.000466007428
  error estimate for blocks of size 2^( 3) =       0.000475388656
  error estimate for blocks of size 2^( 4) =       0.000481458502
  error estimate for blocks of size 2^( 5) =       0.000484869159
  error estimate for blocks of size 2^( 6) =       0.000486584386
  error estimate for blocks of size 2^( 7) =       0.000489891396

      target function =                  N/A
              le_mean =     -17.200278265445
             les_mean =     296.263115681201
             stat err =       0.000485700861
             autocorr =       1.140897331827
              std dev =       0.643073463314
             le_variance =       0.413543479219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.413955410076
                                         uncertainty =       0.003645721958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.413955410076
                                         uncertainty =       0.003645721958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000454922004
  error estimate for blocks of size 2^( 2) =       0.000466198970
  error estimate for blocks of size 2^( 3) =       0.000475572937
  error estimate for blocks of size 2^( 4) =       0.000481632288
  error estimate for blocks of size 2^( 5) =       0.000485046765
  error estimate for blocks of size 2^( 6) =       0.000486742192
  error estimate for blocks of size 2^( 7) =       0.000490044827

      target function =                  N/A
              le_mean =     -17.200281587900
             les_mean =     296.263594555402
             stat err =       0.000485866518
             autocorr =       1.140670097455
              std dev =       0.643356867771
             le_variance =       0.413908059309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.413871866639
                                         uncertainty =       0.003644652146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.413871866639
                                         uncertainty =       0.003644652146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000454876082
  error estimate for blocks of size 2^( 2) =       0.000466155170
  error estimate for blocks of size 2^( 3) =       0.000475533678
  error estimate for blocks of size 2^( 4) =       0.000481597205
  error estimate for blocks of size 2^( 5) =       0.000485013922
  error estimate for blocks of size 2^( 6) =       0.000486715952
  error estimate for blocks of size 2^( 7) =       0.000490016583

      target function =                  N/A
              le_mean =     -17.200280057128
             les_mean =     296.263458336710
             stat err =       0.000485835915
             autocorr =       1.140756706034
              std dev =       0.643291924382
             le_variance =       0.413824499975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.413633094641
                                         uncertainty =       0.003641451571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.413633094641
                                         uncertainty =       0.003641451571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000454744807
  error estimate for blocks of size 2^( 2) =       0.000466029347
  error estimate for blocks of size 2^( 3) =       0.000475410336
  error estimate for blocks of size 2^( 4) =       0.000481479396
  error estimate for blocks of size 2^( 5) =       0.000484890972
  error estimate for blocks of size 2^( 6) =       0.000486604317
  error estimate for blocks of size 2^( 7) =       0.000489909928

      target function =                  N/A
              le_mean =     -17.200278228616
             les_mean =     296.263156613375
             stat err =       0.000485721153
             autocorr =       1.140876249030
              std dev =       0.643106272995
             le_variance =       0.413585678365


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.200278265445        initial
     6.1035e-02     6.1035e-01             3.5470e-03       -17.200281587900  <--
     2.4414e-01     2.4414e+00             9.9268e-04       -17.200280057128
     9.7656e-01     9.7656e+00             2.5776e-04       -17.200278228616

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 2.9319e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.917416e-01 1 1  ON 0
 uu_1                 3.617298e-02 1 1  ON 1
 uu_2                -4.519423e-02 1 1  ON 2
 uu_3                -9.281366e-02 1 1  ON 3
 uu_4                -1.242108e-01 1 1  ON 4
 uu_5                -1.312278e-01 1 1  ON 5
 uu_6                -1.060459e-01 1 1  ON 6
 uu_7                -3.042818e-02 1 1  ON 7
 uu_8                 1.046010e-01 1 1  ON 8
 uu_9                 1.125954e-01 1 1  ON 9
 ud_0                 3.131273e-01 1 1  ON 10
 ud_1                 7.416102e-02 1 1  ON 11
 ud_2                -8.794501e-03 1 1  ON 12
 ud_3                -5.639738e-02 1 1  ON 13
 ud_4                -1.061301e-01 1 1  ON 14
 ud_5                -1.483731e-01 1 1  ON 15
 ud_6                -1.554613e-01 1 1  ON 16
 ud_7                -1.044320e-01 1 1  ON 17
 ud_8                 1.593234e-02 1 1  ON 18
 ud_9                 9.076954e-02 1 1  ON 19
 eO_0                -6.716870e-01 1 1  ON 20
 eO_1                -3.941354e-01 1 1  ON 21
 eO_2                -5.519367e-02 1 1  ON 22
 eO_3                 1.646085e-01 1 1  ON 23
 eO_4                 2.629001e-01 1 1  ON 24
 eO_5                 3.053931e-01 1 1  ON 25
 eO_6                 2.363192e-01 1 1  ON 26
 eO_7                 9.845700e-02 1 1  ON 27
 eO_8                 2.577698e-02 1 1  ON 28
 eO_9                 1.763268e-02 1 1  ON 29
eH1_0                -1.740173e-01 1 1  ON 30
eH1_1                -9.726340e-02 1 1  ON 31
eH1_2                -6.064135e-02 1 1  ON 32
eH1_3                -2.778839e-02 1 1  ON 33
eH1_4                 1.883008e-02 1 1  ON 34
eH1_5                 3.377340e-02 1 1  ON 35
eH1_6                 7.578580e-02 1 1  ON 36
eH1_7                 1.115498e-01 1 1  ON 37
eH1_8                 8.300139e-02 1 1  ON 38
eH1_9                 2.210662e-02 1 1  ON 39
eH2_0                -1.769656e-01 1 1  ON 40
eH2_1                -9.902641e-02 1 1  ON 41
eH2_2                -6.236689e-02 1 1  ON 42
eH2_3                -2.915444e-02 1 1  ON 43
eH2_4                 1.806925e-02 1 1  ON 44
eH2_5                 3.282864e-02 1 1  ON 45
eH2_6                 8.198923e-02 1 1  ON 46
eH2_7                 1.145119e-01 1 1  ON 47
eH2_8                 8.490935e-02 1 1  ON 48
eH2_9                 2.382986e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5243e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.3304
    reference variance = 0.316734
====================================================
  Execution time = 2.0263e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.3200e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432064283485
                                         uncertainty =       0.008982543173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432064283485
                                         uncertainty =       0.008982543173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464758557
  error estimate for blocks of size 2^( 2) =       0.000476726271
  error estimate for blocks of size 2^( 3) =       0.000486859179
  error estimate for blocks of size 2^( 4) =       0.000493824284
  error estimate for blocks of size 2^( 5) =       0.000498939205
  error estimate for blocks of size 2^( 6) =       0.000501249728
  error estimate for blocks of size 2^( 7) =       0.000502009284

      target function =                  N/A
              le_mean =     -17.200709619730
             les_mean =     296.296412237997
             stat err =       0.000499005625
             autocorr =       1.152805645060
              std dev =       0.657267853866
             le_variance =       0.432001031726


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720070961973e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200709619730       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200710669653       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200709654358       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200712973644       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200713087517       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200714304009       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200714497893       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200719198382       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200719811668       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200717091062       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.200720129000       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.200719234168       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.200718205500       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.200720329168       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.200719410824       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.200720044236       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.200721049747       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 1.079045e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200709619730       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200710507059       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200709564860       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200712278342       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200712197199       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200712720104       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200712667355       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200714925435       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200714760258       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200713392621       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.200714070642       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.200713962748       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 2.674687e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200709619730       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200710167651       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200709506101       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200711094955       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200710854274       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200710819824       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200710834465       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200711545561       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200711362414       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200711083732       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 7.984861e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175740 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5837e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.924215e-01 1 1  ON 0
 uu_1                 3.638394e-02 1 1  ON 1
 uu_2                -4.518967e-02 1 1  ON 2
 uu_3                -9.309478e-02 1 1  ON 3
 uu_4                -1.244651e-01 1 1  ON 4
 uu_5                -1.315288e-01 1 1  ON 5
 uu_6                -1.079431e-01 1 1  ON 6
 uu_7                -3.094804e-02 1 1  ON 7
 uu_8                 1.044055e-01 1 1  ON 8
 uu_9                 1.140248e-01 1 1  ON 9
 ud_0                 3.134644e-01 1 1  ON 10
 ud_1                 7.459268e-02 1 1  ON 11
 ud_2                -8.451049e-03 1 1  ON 12
 ud_3                -5.632163e-02 1 1  ON 13
 ud_4                -1.062919e-01 1 1  ON 14
 ud_5                -1.485193e-01 1 1  ON 15
 ud_6                -1.556390e-01 1 1  ON 16
 ud_7                -1.051892e-01 1 1  ON 17
 ud_8                 1.456477e-02 1 1  ON 18
 ud_9                 9.116898e-02 1 1  ON 19
 eO_0                -6.743616e-01 1 1  ON 20
 eO_1                -3.966875e-01 1 1  ON 21
 eO_2                -5.650901e-02 1 1  ON 22
 eO_3                 1.642623e-01 1 1  ON 23
 eO_4                 2.643983e-01 1 1  ON 24
 eO_5                 3.054975e-01 1 1  ON 25
 eO_6                 2.389333e-01 1 1  ON 26
 eO_7                 1.005949e-01 1 1  ON 27
 eO_8                 2.611386e-02 1 1  ON 28
 eO_9                 1.774099e-02 1 1  ON 29
eH1_0                -1.747941e-01 1 1  ON 30
eH1_1                -9.731161e-02 1 1  ON 31
eH1_2                -6.078500e-02 1 1  ON 32
eH1_3                -2.781206e-02 1 1  ON 33
eH1_4                 1.824011e-02 1 1  ON 34
eH1_5                 3.292889e-02 1 1  ON 35
eH1_6                 7.673710e-02 1 1  ON 36
eH1_7                 1.114735e-01 1 1  ON 37
eH1_8                 8.418579e-02 1 1  ON 38
eH1_9                 2.241132e-02 1 1  ON 39
eH2_0                -1.769786e-01 1 1  ON 40
eH2_1                -9.928788e-02 1 1  ON 41
eH2_2                -6.287446e-02 1 1  ON 42
eH2_3                -2.924420e-02 1 1  ON 43
eH2_4                 1.775177e-02 1 1  ON 44
eH2_5                 3.231306e-02 1 1  ON 45
eH2_6                 8.147439e-02 1 1  ON 46
eH2_7                 1.146977e-01 1 1  ON 47
eH2_8                 8.643044e-02 1 1  ON 48
eH2_9                 2.423135e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2606
    reference variance = 0.256826
====================================================
  Execution time = 2.1557e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7199e+01
  VMC Evar = 4.1819e-01
  Total weights = 2.0000e+06
  Execution time = 2.0101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418025269290
                                         uncertainty =       0.006611228291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418025269290
                                         uncertainty =       0.006611228291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000457149752
  error estimate for blocks of size 2^( 2) =       0.000468701979
  error estimate for blocks of size 2^( 3) =       0.000478398760
  error estimate for blocks of size 2^( 4) =       0.000485432981
  error estimate for blocks of size 2^( 5) =       0.000489609885
  error estimate for blocks of size 2^( 6) =       0.000493765165
  error estimate for blocks of size 2^( 7) =       0.000495426570

      target function =                  N/A
              le_mean =     -17.199444442279
             les_mean =     296.238860706268
             stat err =       0.000491058650
             autocorr =       1.153851061322
              std dev =       0.646507379855
             le_variance =       0.417971792207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418476428589
                                         uncertainty =       0.006616581953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418476428589
                                         uncertainty =       0.006616581953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000457396567
  error estimate for blocks of size 2^( 2) =       0.000468930705
  error estimate for blocks of size 2^( 3) =       0.000478603986
  error estimate for blocks of size 2^( 4) =       0.000485617914
  error estimate for blocks of size 2^( 5) =       0.000489785571
  error estimate for blocks of size 2^( 6) =       0.000493938133
  error estimate for blocks of size 2^( 7) =       0.000495599826

      target function =                  N/A
              le_mean =     -17.199447917321
             les_mean =     296.239431690517
             stat err =       0.000491235361
             autocorr =       1.153435838305
              std dev =       0.646856428498
             le_variance =       0.418423239089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418467320217
                                         uncertainty =       0.006617101369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418467320217
                                         uncertainty =       0.006617101369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000457391603
  error estimate for blocks of size 2^( 2) =       0.000468929278
  error estimate for blocks of size 2^( 3) =       0.000478604969
  error estimate for blocks of size 2^( 4) =       0.000485622617
  error estimate for blocks of size 2^( 5) =       0.000489796247
  error estimate for blocks of size 2^( 6) =       0.000493951908
  error estimate for blocks of size 2^( 7) =       0.000495619381

      target function =                  N/A
              le_mean =     -17.199447174715
             les_mean =     296.239397062729
             stat err =       0.000491247538
             autocorr =       1.153518065100
              std dev =       0.646849407611
             le_variance =       0.418414156126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418063584342
                                         uncertainty =       0.006611789887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418063584342
                                         uncertainty =       0.006611789887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000457170743
  error estimate for blocks of size 2^( 2) =       0.000468721174
  error estimate for blocks of size 2^( 3) =       0.000478414314
  error estimate for blocks of size 2^( 4) =       0.000485445787
  error estimate for blocks of size 2^( 5) =       0.000489622480
  error estimate for blocks of size 2^( 6) =       0.000493778905
  error estimate for blocks of size 2^( 7) =       0.000495442607

      target function =                  N/A
              le_mean =     -17.199443846911
             les_mean =     296.238878610766
             stat err =       0.000491072445
             autocorr =       1.153809929336
              std dev =       0.646537065229
             le_variance =       0.418010176715


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.199444442279        initial
     1.5259e-02     1.5259e-01             1.0790e-02       -17.199447917321  <--
     6.1035e-02     6.1035e-01             2.6747e-03       -17.199447174715
     2.4414e-01     2.4414e+00             7.9849e-04       -17.199443846911

*****************************************************************************
Applying the update for shift_i =   1.5259e-02     and shift_s =   1.5259e-01
*****************************************************************************

  Execution time = 3.0967e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.923994e-01 1 1  ON 0
 uu_1                 3.621184e-02 1 1  ON 1
 uu_2                -4.550049e-02 1 1  ON 2
 uu_3                -9.362066e-02 1 1  ON 3
 uu_4                -1.252551e-01 1 1  ON 4
 uu_5                -1.325372e-01 1 1  ON 5
 uu_6                -1.100207e-01 1 1  ON 6
 uu_7                -3.301194e-02 1 1  ON 7
 uu_8                 1.034382e-01 1 1  ON 8
 uu_9                 1.184258e-01 1 1  ON 9
 ud_0                 3.144603e-01 1 1  ON 10
 ud_1                 7.552931e-02 1 1  ON 11
 ud_2                -7.671394e-03 1 1  ON 12
 ud_3                -5.579005e-02 1 1  ON 13
 ud_4                -1.061857e-01 1 1  ON 14
 ud_5                -1.486906e-01 1 1  ON 15
 ud_6                -1.569544e-01 1 1  ON 16
 ud_7                -1.072476e-01 1 1  ON 17
 ud_8                 1.039975e-02 1 1  ON 18
 ud_9                 9.232755e-02 1 1  ON 19
 eO_0                -6.802665e-01 1 1  ON 20
 eO_1                -4.022011e-01 1 1  ON 21
 eO_2                -6.094748e-02 1 1  ON 22
 eO_3                 1.616774e-01 1 1  ON 23
 eO_4                 2.646817e-01 1 1  ON 24
 eO_5                 3.071593e-01 1 1  ON 25
 eO_6                 2.471096e-01 1 1  ON 26
 eO_7                 1.072450e-01 1 1  ON 27
 eO_8                 2.716957e-02 1 1  ON 28
 eO_9                 1.807705e-02 1 1  ON 29
eH1_0                -1.760772e-01 1 1  ON 30
eH1_1                -9.819307e-02 1 1  ON 31
eH1_2                -6.167909e-02 1 1  ON 32
eH1_3                -2.860917e-02 1 1  ON 33
eH1_4                 1.744428e-02 1 1  ON 34
eH1_5                 3.124837e-02 1 1  ON 35
eH1_6                 7.841826e-02 1 1  ON 36
eH1_7                 1.112707e-01 1 1  ON 37
eH1_8                 8.788650e-02 1 1  ON 38
eH1_9                 2.336606e-02 1 1  ON 39
eH2_0                -1.777694e-01 1 1  ON 40
eH2_1                -1.002276e-01 1 1  ON 41
eH2_2                -6.384964e-02 1 1  ON 42
eH2_3                -3.003625e-02 1 1  ON 43
eH2_4                 1.684259e-02 1 1  ON 44
eH2_5                 3.101455e-02 1 1  ON 45
eH2_6                 8.027946e-02 1 1  ON 46
eH2_7                 1.152964e-01 1 1  ON 47
eH2_8                 9.112619e-02 1 1  ON 48
eH2_9                 2.548577e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6809e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.259
    reference variance = 0.323621
====================================================
  Execution time = 2.0248e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.1186e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.411804073285
                                         uncertainty =       0.005282113678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.411804073285
                                         uncertainty =       0.005282113678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000453794614
  error estimate for blocks of size 2^( 2) =       0.000465024899
  error estimate for blocks of size 2^( 3) =       0.000474896629
  error estimate for blocks of size 2^( 4) =       0.000481389939
  error estimate for blocks of size 2^( 5) =       0.000485821313
  error estimate for blocks of size 2^( 6) =       0.000488500296
  error estimate for blocks of size 2^( 7) =       0.000488151321

      target function =                  N/A
              le_mean =     -17.199925259324
             les_mean =     296.249287824510
             stat err =       0.000485965717
             autocorr =       1.146812957032
              std dev =       0.641762498211
             le_variance =       0.411859104110


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.719992525932e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.199925259324       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.199926005934       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.199929468859       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.199930060215       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.199928334860       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.199930193810       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.199931956659       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.199929956131       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.199933647028       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.199940862231       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.199945679861       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.199943000941       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.199944899820       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.199955314015       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.199956396616       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.199958920947       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.199959857036       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.199959849978       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.199959816190       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.199959999906       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.199959706375       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.199960655695       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.199959697546       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.199960194569       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.199960496095       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-03 is 3.935189e-02

solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.199925259324       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.199925963192       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.199929444534       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.199929838546       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.199928255177       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.199929997671       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.199931409621       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.199929712904       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.199932422471       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.199936402359       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.199938480742       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.199936271081       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.199936601390       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.199939547937       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.199939173727       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.199939428562       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.199939331303       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 1.047796e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.199925259324       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.199925832045       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.199929228022       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.199929026700       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.199928347625       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.199930178362       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.199929045550       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.199929201789       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.199930201135       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.199931110789       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.199931504262       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.199930880734       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.199930925073       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 2.720974e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188844 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5821e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.921012e-01 1 1  ON 0
 uu_1                 3.586468e-02 1 1  ON 1
 uu_2                -4.593175e-02 1 1  ON 2
 uu_3                -9.389822e-02 1 1  ON 3
 uu_4                -1.259547e-01 1 1  ON 4
 uu_5                -1.331115e-01 1 1  ON 5
 uu_6                -1.100980e-01 1 1  ON 6
 uu_7                -3.641093e-02 1 1  ON 7
 uu_8                 9.958682e-02 1 1  ON 8
 uu_9                 1.224274e-01 1 1  ON 9
 ud_0                 3.156005e-01 1 1  ON 10
 ud_1                 7.629790e-02 1 1  ON 11
 ud_2                -7.038344e-03 1 1  ON 12
 ud_3                -5.524370e-02 1 1  ON 13
 ud_4                -1.056024e-01 1 1  ON 14
 ud_5                -1.489220e-01 1 1  ON 15
 ud_6                -1.578446e-01 1 1  ON 16
 ud_7                -1.102180e-01 1 1  ON 17
 ud_8                 4.764600e-03 1 1  ON 18
 ud_9                 9.361815e-02 1 1  ON 19
 eO_0                -6.842454e-01 1 1  ON 20
 eO_1                -4.053426e-01 1 1  ON 21
 eO_2                -6.507547e-02 1 1  ON 22
 eO_3                 1.565964e-01 1 1  ON 23
 eO_4                 2.594524e-01 1 1  ON 24
 eO_5                 3.065422e-01 1 1  ON 25
 eO_6                 2.575876e-01 1 1  ON 26
 eO_7                 1.163077e-01 1 1  ON 27
 eO_8                 2.844990e-02 1 1  ON 28
 eO_9                 1.873593e-02 1 1  ON 29
eH1_0                -1.766543e-01 1 1  ON 30
eH1_1                -1.003905e-01 1 1  ON 31
eH1_2                -6.358011e-02 1 1  ON 32
eH1_3                -3.030217e-02 1 1  ON 33
eH1_4                 1.734141e-02 1 1  ON 34
eH1_5                 3.276902e-02 1 1  ON 35
eH1_6                 7.412344e-02 1 1  ON 36
eH1_7                 1.103787e-01 1 1  ON 37
eH1_8                 9.447315e-02 1 1  ON 38
eH1_9                 2.579270e-02 1 1  ON 39
eH2_0                -1.793005e-01 1 1  ON 40
eH2_1                -1.023551e-01 1 1  ON 41
eH2_2                -6.585569e-02 1 1  ON 42
eH2_3                -3.243027e-02 1 1  ON 43
eH2_4                 1.562615e-02 1 1  ON 44
eH2_5                 3.224521e-02 1 1  ON 45
eH2_6                 7.907280e-02 1 1  ON 46
eH2_7                 1.177421e-01 1 1  ON 47
eH2_8                 9.680109e-02 1 1  ON 48
eH2_9                 2.632265e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2126
    reference variance = 0.134083
====================================================
  Execution time = 1.9906e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.1116e-01
  Total weights = 2.0000e+06
  Execution time = 1.8065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.410882862683
                                         uncertainty =       0.003590493018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.410882862683
                                         uncertainty =       0.003590493018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000453160941
  error estimate for blocks of size 2^( 2) =       0.000464996581
  error estimate for blocks of size 2^( 3) =       0.000474430469
  error estimate for blocks of size 2^( 4) =       0.000481903041
  error estimate for blocks of size 2^( 5) =       0.000486031321
  error estimate for blocks of size 2^( 6) =       0.000487574937
  error estimate for blocks of size 2^( 7) =       0.000487749525

      target function =                  N/A
              le_mean =     -17.200575239986
             les_mean =     296.270498058629
             stat err =       0.000485814706
             autocorr =       1.149307851900
              std dev =       0.640866349235
             le_variance =       0.410709677581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.411628368840
                                         uncertainty =       0.003594388974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.411628368840
                                         uncertainty =       0.003594388974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000453571762
  error estimate for blocks of size 2^( 2) =       0.000465369994
  error estimate for blocks of size 2^( 3) =       0.000474753826
  error estimate for blocks of size 2^( 4) =       0.000482176831
  error estimate for blocks of size 2^( 5) =       0.000486259615
  error estimate for blocks of size 2^( 6) =       0.000487773486
  error estimate for blocks of size 2^( 7) =       0.000487950291

      target function =                  N/A
              le_mean =     -17.200574391805
             les_mean =     296.271213889690
             stat err =       0.000486040055
             autocorr =       1.148291380521
              std dev =       0.641447337975
             le_variance =       0.411454687396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.411818896855
                                         uncertainty =       0.003596149822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.411818896855
                                         uncertainty =       0.003596149822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000453676761
  error estimate for blocks of size 2^( 2) =       0.000465475765
  error estimate for blocks of size 2^( 3) =       0.000474862498
  error estimate for blocks of size 2^( 4) =       0.000482294323
  error estimate for blocks of size 2^( 5) =       0.000486380375
  error estimate for blocks of size 2^( 6) =       0.000487887990
  error estimate for blocks of size 2^( 7) =       0.000488072005

      target function =                  N/A
              le_mean =     -17.200574720731
             les_mean =     296.271415724710
             stat err =       0.000486158673
             autocorr =       1.148320211263
              std dev =       0.641595828451
             le_variance =       0.411645207086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.411317476457
                                         uncertainty =       0.003593402098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.411317476457
                                         uncertainty =       0.003593402098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000453400539
  error estimate for blocks of size 2^( 2) =       0.000465220817
  error estimate for blocks of size 2^( 3) =       0.000474636787
  error estimate for blocks of size 2^( 4) =       0.000482095753
  error estimate for blocks of size 2^( 5) =       0.000486209083
  error estimate for blocks of size 2^( 6) =       0.000487737878
  error estimate for blocks of size 2^( 7) =       0.000487914440

      target function =                  N/A
              le_mean =     -17.200571966472
             les_mean =     296.270819865508
             stat err =       0.000485989288
             autocorr =       1.148918785634
              std dev =       0.641205191246
             le_variance =       0.411144097281


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.200575239986        initial  <--
     3.8147e-03     3.8147e-02             3.9352e-02       -17.200574391805
     1.5259e-02     1.5259e-01             1.0478e-02       -17.200574720731
     6.1035e-02     6.1035e-01             2.7210e-03       -17.200571966472

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0529
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.923994e-01 1 1  ON 0
 uu_1                 3.621184e-02 1 1  ON 1
 uu_2                -4.550049e-02 1 1  ON 2
 uu_3                -9.362066e-02 1 1  ON 3
 uu_4                -1.252551e-01 1 1  ON 4
 uu_5                -1.325372e-01 1 1  ON 5
 uu_6                -1.100207e-01 1 1  ON 6
 uu_7                -3.301194e-02 1 1  ON 7
 uu_8                 1.034382e-01 1 1  ON 8
 uu_9                 1.184258e-01 1 1  ON 9
 ud_0                 3.144603e-01 1 1  ON 10
 ud_1                 7.552931e-02 1 1  ON 11
 ud_2                -7.671394e-03 1 1  ON 12
 ud_3                -5.579005e-02 1 1  ON 13
 ud_4                -1.061857e-01 1 1  ON 14
 ud_5                -1.486906e-01 1 1  ON 15
 ud_6                -1.569544e-01 1 1  ON 16
 ud_7                -1.072476e-01 1 1  ON 17
 ud_8                 1.039975e-02 1 1  ON 18
 ud_9                 9.232755e-02 1 1  ON 19
 eO_0                -6.802665e-01 1 1  ON 20
 eO_1                -4.022011e-01 1 1  ON 21
 eO_2                -6.094748e-02 1 1  ON 22
 eO_3                 1.616774e-01 1 1  ON 23
 eO_4                 2.646817e-01 1 1  ON 24
 eO_5                 3.071593e-01 1 1  ON 25
 eO_6                 2.471096e-01 1 1  ON 26
 eO_7                 1.072450e-01 1 1  ON 27
 eO_8                 2.716957e-02 1 1  ON 28
 eO_9                 1.807705e-02 1 1  ON 29
eH1_0                -1.760772e-01 1 1  ON 30
eH1_1                -9.819307e-02 1 1  ON 31
eH1_2                -6.167909e-02 1 1  ON 32
eH1_3                -2.860917e-02 1 1  ON 33
eH1_4                 1.744428e-02 1 1  ON 34
eH1_5                 3.124837e-02 1 1  ON 35
eH1_6                 7.841826e-02 1 1  ON 36
eH1_7                 1.112707e-01 1 1  ON 37
eH1_8                 8.788650e-02 1 1  ON 38
eH1_9                 2.336606e-02 1 1  ON 39
eH2_0                -1.777694e-01 1 1  ON 40
eH2_1                -1.002276e-01 1 1  ON 41
eH2_2                -6.384964e-02 1 1  ON 42
eH2_3                -3.003625e-02 1 1  ON 43
eH2_4                 1.684259e-02 1 1  ON 44
eH2_5                 3.101455e-02 1 1  ON 45
eH2_6                 8.027946e-02 1 1  ON 46
eH2_7                 1.152964e-01 1 1  ON 47
eH2_8                 9.112619e-02 1 1  ON 48
eH2_9                 2.548577e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4879e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.3113
    reference variance = 0.341902
====================================================
  Execution time = 2.0333e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.2419e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5484e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.424204387286
                                         uncertainty =       0.005765857903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.424204387286
                                         uncertainty =       0.005765857903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000460537286
  error estimate for blocks of size 2^( 2) =       0.000472308260
  error estimate for blocks of size 2^( 3) =       0.000482027407
  error estimate for blocks of size 2^( 4) =       0.000490035476
  error estimate for blocks of size 2^( 5) =       0.000495872251
  error estimate for blocks of size 2^( 6) =       0.000497763793
  error estimate for blocks of size 2^( 7) =       0.000499152384

      target function =                  N/A
              le_mean =     -17.201094235619
             les_mean =     296.301831873999
             stat err =       0.000495705976
             autocorr =       1.158560492407
              std dev =       0.651298075727
             le_variance =       0.424189183446


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720109423562e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.201094235619       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.201103072546       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.201106014325       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.201108147546       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.201109382598       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.201110697983       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.201113206580       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.201114109321       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.201113671363       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.201113203594       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.201115096363       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.201115095670       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.201114694368       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.201114547916       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 4.329539e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.201094235619       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.201100637630       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.201102485057       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.201103905774       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.201104355656       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.201105157891       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.201106143028       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.201106339083       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.201106045708       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.201105762028       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.201106018903       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.096354e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.201094235619       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.201097281069       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.201098106429       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.201098784505       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.201098825607       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.201099178960       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.201099366148       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.201099358148       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.201099276432       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.782124e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193784 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5890e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.920240e-01 1 1  ON 0
 uu_1                 3.590030e-02 1 1  ON 1
 uu_2                -4.558154e-02 1 1  ON 2
 uu_3                -9.369684e-02 1 1  ON 3
 uu_4                -1.254395e-01 1 1  ON 4
 uu_5                -1.327175e-01 1 1  ON 5
 uu_6                -1.091752e-01 1 1  ON 6
 uu_7                -3.320252e-02 1 1  ON 7
 uu_8                 1.031049e-01 1 1  ON 8
 uu_9                 1.188043e-01 1 1  ON 9
 ud_0                 3.150724e-01 1 1  ON 10
 ud_1                 7.588460e-02 1 1  ON 11
 ud_2                -7.349772e-03 1 1  ON 12
 ud_3                -5.544534e-02 1 1  ON 13
 ud_4                -1.064909e-01 1 1  ON 14
 ud_5                -1.490267e-01 1 1  ON 15
 ud_6                -1.574002e-01 1 1  ON 16
 ud_7                -1.077651e-01 1 1  ON 17
 ud_8                 9.784573e-03 1 1  ON 18
 ud_9                 9.249274e-02 1 1  ON 19
 eO_0                -6.811427e-01 1 1  ON 20
 eO_1                -4.031138e-01 1 1  ON 21
 eO_2                -6.148171e-02 1 1  ON 22
 eO_3                 1.622024e-01 1 1  ON 23
 eO_4                 2.643912e-01 1 1  ON 24
 eO_5                 3.070669e-01 1 1  ON 25
 eO_6                 2.482060e-01 1 1  ON 26
 eO_7                 1.081196e-01 1 1  ON 27
 eO_8                 2.727080e-02 1 1  ON 28
 eO_9                 1.812841e-02 1 1  ON 29
eH1_0                -1.758194e-01 1 1  ON 30
eH1_1                -9.846473e-02 1 1  ON 31
eH1_2                -6.212059e-02 1 1  ON 32
eH1_3                -2.888859e-02 1 1  ON 33
eH1_4                 1.765530e-02 1 1  ON 34
eH1_5                 3.105868e-02 1 1  ON 35
eH1_6                 7.793711e-02 1 1  ON 36
eH1_7                 1.115201e-01 1 1  ON 37
eH1_8                 8.852174e-02 1 1  ON 38
eH1_9                 2.358150e-02 1 1  ON 39
eH2_0                -1.775248e-01 1 1  ON 40
eH2_1                -1.001682e-01 1 1  ON 41
eH2_2                -6.426985e-02 1 1  ON 42
eH2_3                -3.035996e-02 1 1  ON 43
eH2_4                 1.621120e-02 1 1  ON 44
eH2_5                 3.146590e-02 1 1  ON 45
eH2_6                 8.032629e-02 1 1  ON 46
eH2_7                 1.152633e-01 1 1  ON 47
eH2_8                 9.157523e-02 1 1  ON 48
eH2_9                 2.561166e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1907
    reference variance = 0.639075
====================================================
  Execution time = 1.9816e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.3053e-01
  Total weights = 2.0000e+06
  Execution time = 1.8114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430494751437
                                         uncertainty =       0.011351080060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430494751437
                                         uncertainty =       0.011351080060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463876665
  error estimate for blocks of size 2^( 2) =       0.000475301032
  error estimate for blocks of size 2^( 3) =       0.000485932794
  error estimate for blocks of size 2^( 4) =       0.000493644302
  error estimate for blocks of size 2^( 5) =       0.000495143068
  error estimate for blocks of size 2^( 6) =       0.000498740850
  error estimate for blocks of size 2^( 7) =       0.000498767683

      target function =                  N/A
              le_mean =     -17.200431394626
             les_mean =     296.285203067417
             stat err =       0.000496573976
             autocorr =       1.145942582815
              std dev =       0.656020671446
             le_variance =       0.430363121365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430769411366
                                         uncertainty =       0.011325949208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430769411366
                                         uncertainty =       0.011325949208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464024608
  error estimate for blocks of size 2^( 2) =       0.000475444319
  error estimate for blocks of size 2^( 3) =       0.000486061728
  error estimate for blocks of size 2^( 4) =       0.000493759325
  error estimate for blocks of size 2^( 5) =       0.000495263474
  error estimate for blocks of size 2^( 6) =       0.000498857658
  error estimate for blocks of size 2^( 7) =       0.000498902287

      target function =                  N/A
              le_mean =     -17.200437296165
             les_mean =     296.285680638281
             stat err =       0.000496695686
             autocorr =       1.145773438598
              std dev =       0.656229894380
             le_variance =       0.430637674279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430850495734
                                         uncertainty =       0.011323222917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430850495734
                                         uncertainty =       0.011323222917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464068311
  error estimate for blocks of size 2^( 2) =       0.000475489801
  error estimate for blocks of size 2^( 3) =       0.000486107705
  error estimate for blocks of size 2^( 4) =       0.000493809113
  error estimate for blocks of size 2^( 5) =       0.000495317751
  error estimate for blocks of size 2^( 6) =       0.000498915085
  error estimate for blocks of size 2^( 7) =       0.000498966989

      target function =                  N/A
              le_mean =     -17.200440132799
             les_mean =     296.285859340368
             stat err =       0.000496752234
             autocorr =       1.145818506332
              std dev =       0.656291698666
             le_variance =       0.430718793738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430554499479
                                         uncertainty =       0.011344062835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430554499479
                                         uncertainty =       0.011344062835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463908859
  error estimate for blocks of size 2^( 2) =       0.000475332617
  error estimate for blocks of size 2^( 3) =       0.000485961371
  error estimate for blocks of size 2^( 4) =       0.000493671494
  error estimate for blocks of size 2^( 5) =       0.000495172743
  error estimate for blocks of size 2^( 6) =       0.000498771865
  error estimate for blocks of size 2^( 7) =       0.000498805121

      target function =                  N/A
              le_mean =     -17.200432283203
             les_mean =     296.285293372124
             stat err =       0.000496605306
             autocorr =       1.145928125671
              std dev =       0.656066199615
             le_variance =       0.430422858277


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.200431394626        initial
     3.8147e-02     3.8147e-01             4.3295e-03       -17.200437296165
     1.5259e-01     1.5259e+00             1.0964e-03       -17.200440132799  <--
     6.1035e-01     6.1035e+00             2.7821e-04       -17.200432283203

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.9014e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.920240e-01 1 1  ON 0
 uu_1                 3.590030e-02 1 1  ON 1
 uu_2                -4.558154e-02 1 1  ON 2
 uu_3                -9.369684e-02 1 1  ON 3
 uu_4                -1.254395e-01 1 1  ON 4
 uu_5                -1.327175e-01 1 1  ON 5
 uu_6                -1.091752e-01 1 1  ON 6
 uu_7                -3.320252e-02 1 1  ON 7
 uu_8                 1.031049e-01 1 1  ON 8
 uu_9                 1.188043e-01 1 1  ON 9
 ud_0                 3.150724e-01 1 1  ON 10
 ud_1                 7.588460e-02 1 1  ON 11
 ud_2                -7.349772e-03 1 1  ON 12
 ud_3                -5.544534e-02 1 1  ON 13
 ud_4                -1.064909e-01 1 1  ON 14
 ud_5                -1.490267e-01 1 1  ON 15
 ud_6                -1.574002e-01 1 1  ON 16
 ud_7                -1.077651e-01 1 1  ON 17
 ud_8                 9.784573e-03 1 1  ON 18
 ud_9                 9.249274e-02 1 1  ON 19
 eO_0                -6.811427e-01 1 1  ON 20
 eO_1                -4.031138e-01 1 1  ON 21
 eO_2                -6.148171e-02 1 1  ON 22
 eO_3                 1.622024e-01 1 1  ON 23
 eO_4                 2.643912e-01 1 1  ON 24
 eO_5                 3.070669e-01 1 1  ON 25
 eO_6                 2.482060e-01 1 1  ON 26
 eO_7                 1.081196e-01 1 1  ON 27
 eO_8                 2.727080e-02 1 1  ON 28
 eO_9                 1.812841e-02 1 1  ON 29
eH1_0                -1.758194e-01 1 1  ON 30
eH1_1                -9.846473e-02 1 1  ON 31
eH1_2                -6.212059e-02 1 1  ON 32
eH1_3                -2.888859e-02 1 1  ON 33
eH1_4                 1.765530e-02 1 1  ON 34
eH1_5                 3.105868e-02 1 1  ON 35
eH1_6                 7.793711e-02 1 1  ON 36
eH1_7                 1.115201e-01 1 1  ON 37
eH1_8                 8.852174e-02 1 1  ON 38
eH1_9                 2.358150e-02 1 1  ON 39
eH2_0                -1.775248e-01 1 1  ON 40
eH2_1                -1.001682e-01 1 1  ON 41
eH2_2                -6.426985e-02 1 1  ON 42
eH2_3                -3.035996e-02 1 1  ON 43
eH2_4                 1.621120e-02 1 1  ON 44
eH2_5                 3.146590e-02 1 1  ON 45
eH2_6                 8.032629e-02 1 1  ON 46
eH2_7                 1.152633e-01 1 1  ON 47
eH2_8                 9.157523e-02 1 1  ON 48
eH2_9                 2.561166e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4909e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2261
    reference variance = 0.173349
====================================================
  Execution time = 2.0786e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.1755e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6474e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.417653972801
                                         uncertainty =       0.006037286801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.417653972801
                                         uncertainty =       0.006037286801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456921872
  error estimate for blocks of size 2^( 2) =       0.000468024134
  error estimate for blocks of size 2^( 3) =       0.000476595223
  error estimate for blocks of size 2^( 4) =       0.000483349518
  error estimate for blocks of size 2^( 5) =       0.000486472720
  error estimate for blocks of size 2^( 6) =       0.000486491375
  error estimate for blocks of size 2^( 7) =       0.000487671052

      target function =                  N/A
              le_mean =     -17.200153393201
             les_mean =     296.262831735673
             stat err =       0.000485996166
             autocorr =       1.131310429758
              std dev =       0.646185108772
             le_variance =       0.417555194798


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720015339320e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200153393201       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200153639835       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200155579849       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200152940817       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200156239566       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200155065506       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200156175155       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200158421820       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200161069600       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200160303520       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.200159995877       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.200159890162       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.200159689305       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.200160180524       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.200159949937       residual = 2.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 3.435450e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200153393201       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200153580322       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200155014061       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200153023768       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200154335562       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200155010073       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200154250662       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200155424936       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200155884171       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200155585229       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.200155460878       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.078507e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200153393201       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200153488418       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200154210399       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200153391845       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200153536247       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200154020963       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200153660565       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200153908648       residual = 9.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.231760e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198764 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6442e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.919452e-01 1 1  ON 0
 uu_1                 3.600464e-02 1 1  ON 1
 uu_2                -4.581284e-02 1 1  ON 2
 uu_3                -9.366706e-02 1 1  ON 3
 uu_4                -1.253951e-01 1 1  ON 4
 uu_5                -1.328805e-01 1 1  ON 5
 uu_6                -1.091648e-01 1 1  ON 6
 uu_7                -3.356835e-02 1 1  ON 7
 uu_8                 1.028475e-01 1 1  ON 8
 uu_9                 1.192908e-01 1 1  ON 9
 ud_0                 3.150492e-01 1 1  ON 10
 ud_1                 7.618116e-02 1 1  ON 11
 ud_2                -6.944478e-03 1 1  ON 12
 ud_3                -5.506152e-02 1 1  ON 13
 ud_4                -1.059924e-01 1 1  ON 14
 ud_5                -1.491843e-01 1 1  ON 15
 ud_6                -1.576959e-01 1 1  ON 16
 ud_7                -1.083050e-01 1 1  ON 17
 ud_8                 8.947603e-03 1 1  ON 18
 ud_9                 9.242302e-02 1 1  ON 19
 eO_0                -6.816869e-01 1 1  ON 20
 eO_1                -4.031239e-01 1 1  ON 21
 eO_2                -6.188664e-02 1 1  ON 22
 eO_3                 1.615452e-01 1 1  ON 23
 eO_4                 2.638834e-01 1 1  ON 24
 eO_5                 3.073808e-01 1 1  ON 25
 eO_6                 2.490519e-01 1 1  ON 26
 eO_7                 1.089103e-01 1 1  ON 27
 eO_8                 2.738083e-02 1 1  ON 28
 eO_9                 1.816804e-02 1 1  ON 29
eH1_0                -1.764040e-01 1 1  ON 30
eH1_1                -9.895856e-02 1 1  ON 31
eH1_2                -6.254136e-02 1 1  ON 32
eH1_3                -2.909902e-02 1 1  ON 33
eH1_4                 1.764439e-02 1 1  ON 34
eH1_5                 3.213719e-02 1 1  ON 35
eH1_6                 7.795929e-02 1 1  ON 36
eH1_7                 1.114858e-01 1 1  ON 37
eH1_8                 8.898325e-02 1 1  ON 38
eH1_9                 2.373343e-02 1 1  ON 39
eH2_0                -1.772544e-01 1 1  ON 40
eH2_1                -1.004566e-01 1 1  ON 41
eH2_2                -6.418090e-02 1 1  ON 42
eH2_3                -3.065707e-02 1 1  ON 43
eH2_4                 1.581992e-02 1 1  ON 44
eH2_5                 3.143190e-02 1 1  ON 45
eH2_6                 8.006167e-02 1 1  ON 46
eH2_7                 1.153857e-01 1 1  ON 47
eH2_8                 9.215453e-02 1 1  ON 48
eH2_9                 2.578744e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1686
    reference variance = 0.37704
====================================================
  Execution time = 2.0281e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.2004e-01
  Total weights = 2.0000e+06
  Execution time = 1.8182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.420007051490
                                         uncertainty =       0.008412012656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.420007051490
                                         uncertainty =       0.008412012656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000458383958
  error estimate for blocks of size 2^( 2) =       0.000469223297
  error estimate for blocks of size 2^( 3) =       0.000478255527
  error estimate for blocks of size 2^( 4) =       0.000483849113
  error estimate for blocks of size 2^( 5) =       0.000487918196
  error estimate for blocks of size 2^( 6) =       0.000489203663
  error estimate for blocks of size 2^( 7) =       0.000490136196

      target function =                  N/A
              le_mean =     -17.200318446066
             les_mean =     296.271186140974
             stat err =       0.000487776792
             autocorr =       1.132357200716
              std dev =       0.648252809482
             le_variance =       0.420231705001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.419788517807
                                         uncertainty =       0.008407840083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.419788517807
                                         uncertainty =       0.008407840083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000458264610
  error estimate for blocks of size 2^( 2) =       0.000469106364
  error estimate for blocks of size 2^( 3) =       0.000478140112
  error estimate for blocks of size 2^( 4) =       0.000483727929
  error estimate for blocks of size 2^( 5) =       0.000487792420
  error estimate for blocks of size 2^( 6) =       0.000489069684
  error estimate for blocks of size 2^( 7) =       0.000490009099

      target function =                  N/A
              le_mean =     -17.200313380958
             les_mean =     296.270793098058
             stat err =       0.000487649783
             autocorr =       1.132357164079
              std dev =       0.648084026108
             le_variance =       0.420012904897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.419636836645
                                         uncertainty =       0.008403703237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.419636836645
                                         uncertainty =       0.008403703237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000458181738
  error estimate for blocks of size 2^( 2) =       0.000469030236
  error estimate for blocks of size 2^( 3) =       0.000478069895
  error estimate for blocks of size 2^( 4) =       0.000483659251
  error estimate for blocks of size 2^( 5) =       0.000487723746
  error estimate for blocks of size 2^( 6) =       0.000489001798
  error estimate for blocks of size 2^( 7) =       0.000489938093

      target function =                  N/A
              le_mean =     -17.200310494677
             les_mean =     296.270541913166
             stat err =       0.000487580722
             autocorr =       1.132445999668
              std dev =       0.647966827693
             le_variance =       0.419861009791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.419908268907
                                         uncertainty =       0.008409713382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.419908268907
                                         uncertainty =       0.008409713382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000458330013
  error estimate for blocks of size 2^( 2) =       0.000469171927
  error estimate for blocks of size 2^( 3) =       0.000478206155
  error estimate for blocks of size 2^( 4) =       0.000483798555
  error estimate for blocks of size 2^( 5) =       0.000487866564
  error estimate for blocks of size 2^( 6) =       0.000489150445
  error estimate for blocks of size 2^( 7) =       0.000490083357

      target function =                  N/A
              le_mean =     -17.200315628503
             les_mean =     296.270990310968
             stat err =       0.000487724730
             autocorr =       1.132382007658
              std dev =       0.648176519856
             le_variance =       0.420132800893


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.200318446066        initial  <--
     3.8147e-02     3.8147e-01             3.4355e-03       -17.200313380958
     1.5259e-01     1.5259e+00             1.0785e-03       -17.200310494677
     6.1035e-01     6.1035e+00             3.2318e-04       -17.200315628503

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4499
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.920240e-01 1 1  ON 0
 uu_1                 3.590030e-02 1 1  ON 1
 uu_2                -4.558154e-02 1 1  ON 2
 uu_3                -9.369684e-02 1 1  ON 3
 uu_4                -1.254395e-01 1 1  ON 4
 uu_5                -1.327175e-01 1 1  ON 5
 uu_6                -1.091752e-01 1 1  ON 6
 uu_7                -3.320252e-02 1 1  ON 7
 uu_8                 1.031049e-01 1 1  ON 8
 uu_9                 1.188043e-01 1 1  ON 9
 ud_0                 3.150724e-01 1 1  ON 10
 ud_1                 7.588460e-02 1 1  ON 11
 ud_2                -7.349772e-03 1 1  ON 12
 ud_3                -5.544534e-02 1 1  ON 13
 ud_4                -1.064909e-01 1 1  ON 14
 ud_5                -1.490267e-01 1 1  ON 15
 ud_6                -1.574002e-01 1 1  ON 16
 ud_7                -1.077651e-01 1 1  ON 17
 ud_8                 9.784573e-03 1 1  ON 18
 ud_9                 9.249274e-02 1 1  ON 19
 eO_0                -6.811427e-01 1 1  ON 20
 eO_1                -4.031138e-01 1 1  ON 21
 eO_2                -6.148171e-02 1 1  ON 22
 eO_3                 1.622024e-01 1 1  ON 23
 eO_4                 2.643912e-01 1 1  ON 24
 eO_5                 3.070669e-01 1 1  ON 25
 eO_6                 2.482060e-01 1 1  ON 26
 eO_7                 1.081196e-01 1 1  ON 27
 eO_8                 2.727080e-02 1 1  ON 28
 eO_9                 1.812841e-02 1 1  ON 29
eH1_0                -1.758194e-01 1 1  ON 30
eH1_1                -9.846473e-02 1 1  ON 31
eH1_2                -6.212059e-02 1 1  ON 32
eH1_3                -2.888859e-02 1 1  ON 33
eH1_4                 1.765530e-02 1 1  ON 34
eH1_5                 3.105868e-02 1 1  ON 35
eH1_6                 7.793711e-02 1 1  ON 36
eH1_7                 1.115201e-01 1 1  ON 37
eH1_8                 8.852174e-02 1 1  ON 38
eH1_9                 2.358150e-02 1 1  ON 39
eH2_0                -1.775248e-01 1 1  ON 40
eH2_1                -1.001682e-01 1 1  ON 41
eH2_2                -6.426985e-02 1 1  ON 42
eH2_3                -3.035996e-02 1 1  ON 43
eH2_4                 1.621120e-02 1 1  ON 44
eH2_5                 3.146590e-02 1 1  ON 45
eH2_6                 8.032629e-02 1 1  ON 46
eH2_7                 1.152633e-01 1 1  ON 47
eH2_8                 9.157523e-02 1 1  ON 48
eH2_9                 2.561166e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5897e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2761
    reference variance = 0.204766
====================================================
  Execution time = 2.0513e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.2177e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421948616930
                                         uncertainty =       0.005312371054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.421948616930
                                         uncertainty =       0.005312371054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000459224274
  error estimate for blocks of size 2^( 2) =       0.000470002102
  error estimate for blocks of size 2^( 3) =       0.000479172172
  error estimate for blocks of size 2^( 4) =       0.000485402793
  error estimate for blocks of size 2^( 5) =       0.000487954703
  error estimate for blocks of size 2^( 6) =       0.000490028563
  error estimate for blocks of size 2^( 7) =       0.000491486867

      target function =                  N/A
              le_mean =     -17.200504910336
             les_mean =     296.279142827162
             stat err =       0.000488718232
             autocorr =       1.132576142077
              std dev =       0.649441196381
             le_variance =       0.421773867557


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720050491034e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200504910336       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200504726151       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200505067738       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200505331442       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200505642856       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200505853925       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200506080775       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200505963607       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200505931185       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 5.372542e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200504910336       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200504848321       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200504944466       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200505055232       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200505147001       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200505204146       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200505260244       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200505245370       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.845698e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200504910336       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200504893361       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200504918302       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200504951593       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200504974647       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200504989222       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200505002649       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200505001745       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 5.120031e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201501 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6102e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.920647e-01 1 1  ON 0
 uu_1                 3.594071e-02 1 1  ON 1
 uu_2                -4.565395e-02 1 1  ON 2
 uu_3                -9.376457e-02 1 1  ON 3
 uu_4                -1.254382e-01 1 1  ON 4
 uu_5                -1.327081e-01 1 1  ON 5
 uu_6                -1.091648e-01 1 1  ON 6
 uu_7                -3.321580e-02 1 1  ON 7
 uu_8                 1.030807e-01 1 1  ON 8
 uu_9                 1.188422e-01 1 1  ON 9
 ud_0                 3.152569e-01 1 1  ON 10
 ud_1                 7.595330e-02 1 1  ON 11
 ud_2                -7.313548e-03 1 1  ON 12
 ud_3                -5.549667e-02 1 1  ON 13
 ud_4                -1.064389e-01 1 1  ON 14
 ud_5                -1.490973e-01 1 1  ON 15
 ud_6                -1.574958e-01 1 1  ON 16
 ud_7                -1.078472e-01 1 1  ON 17
 ud_8                 9.708487e-03 1 1  ON 18
 ud_9                 9.249700e-02 1 1  ON 19
 eO_0                -6.811864e-01 1 1  ON 20
 eO_1                -4.032112e-01 1 1  ON 21
 eO_2                -6.143753e-02 1 1  ON 22
 eO_3                 1.621941e-01 1 1  ON 23
 eO_4                 2.642905e-01 1 1  ON 24
 eO_5                 3.070668e-01 1 1  ON 25
 eO_6                 2.483148e-01 1 1  ON 26
 eO_7                 1.082021e-01 1 1  ON 27
 eO_8                 2.728077e-02 1 1  ON 28
 eO_9                 1.813163e-02 1 1  ON 29
eH1_0                -1.758689e-01 1 1  ON 30
eH1_1                -9.853918e-02 1 1  ON 31
eH1_2                -6.214001e-02 1 1  ON 32
eH1_3                -2.883604e-02 1 1  ON 33
eH1_4                 1.771284e-02 1 1  ON 34
eH1_5                 3.104181e-02 1 1  ON 35
eH1_6                 7.790134e-02 1 1  ON 36
eH1_7                 1.115318e-01 1 1  ON 37
eH1_8                 8.857739e-02 1 1  ON 38
eH1_9                 2.359764e-02 1 1  ON 39
eH2_0                -1.775062e-01 1 1  ON 40
eH2_1                -1.002383e-01 1 1  ON 41
eH2_2                -6.430044e-02 1 1  ON 42
eH2_3                -3.033656e-02 1 1  ON 43
eH2_4                 1.618349e-02 1 1  ON 44
eH2_5                 3.150094e-02 1 1  ON 45
eH2_6                 8.029801e-02 1 1  ON 46
eH2_7                 1.152713e-01 1 1  ON 47
eH2_8                 9.162907e-02 1 1  ON 48
eH2_9                 2.562747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1903
    reference variance = 0.252791
====================================================
  Execution time = 2.0080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.1648e-01
  Total weights = 2.0000e+06
  Execution time = 1.8114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416358859405
                                         uncertainty =       0.004804849629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416358859405
                                         uncertainty =       0.004804849629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456266333
  error estimate for blocks of size 2^( 2) =       0.000467631156
  error estimate for blocks of size 2^( 3) =       0.000477010886
  error estimate for blocks of size 2^( 4) =       0.000483496674
  error estimate for blocks of size 2^( 5) =       0.000486635098
  error estimate for blocks of size 2^( 6) =       0.000490340409
  error estimate for blocks of size 2^( 7) =       0.000489455213

      target function =                  N/A
              le_mean =     -17.200097272040
             les_mean =     296.259703891837
             stat err =       0.000487481848
             autocorr =       1.141510868930
              std dev =       0.645258035508
             le_variance =       0.416357932388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416677730456
                                         uncertainty =       0.004808029684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416677730456
                                         uncertainty =       0.004808029684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456441213
  error estimate for blocks of size 2^( 2) =       0.000467794917
  error estimate for blocks of size 2^( 3) =       0.000477163967
  error estimate for blocks of size 2^( 4) =       0.000483639956
  error estimate for blocks of size 2^( 5) =       0.000486778861
  error estimate for blocks of size 2^( 6) =       0.000490487578
  error estimate for blocks of size 2^( 7) =       0.000489596031

      target function =                  N/A
              le_mean =     -17.200094884154
             les_mean =     296.259940977709
             stat err =       0.000487625606
             autocorr =       1.141309164313
              std dev =       0.645505354068
             le_variance =       0.416677162130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416613408003
                                         uncertainty =       0.004807368765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416613408003
                                         uncertainty =       0.004807368765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456405924
  error estimate for blocks of size 2^( 2) =       0.000467762194
  error estimate for blocks of size 2^( 3) =       0.000477133866
  error estimate for blocks of size 2^( 4) =       0.000483612047
  error estimate for blocks of size 2^( 5) =       0.000486750978
  error estimate for blocks of size 2^( 6) =       0.000490458739
  error estimate for blocks of size 2^( 7) =       0.000489568150

      target function =                  N/A
              le_mean =     -17.200095140518
             les_mean =     296.259885369213
             stat err =       0.000487597478
             autocorr =       1.141353977676
              std dev =       0.645455447451
             le_variance =       0.416612734645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416395220141
                                         uncertainty =       0.004805210687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416395220141
                                         uncertainty =       0.004805210687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456286275
  error estimate for blocks of size 2^( 2) =       0.000467649864
  error estimate for blocks of size 2^( 3) =       0.000477028447
  error estimate for blocks of size 2^( 4) =       0.000483513119
  error estimate for blocks of size 2^( 5) =       0.000486651629
  error estimate for blocks of size 2^( 6) =       0.000490357289
  error estimate for blocks of size 2^( 7) =       0.000489471279

      target function =                  N/A
              le_mean =     -17.200096887181
             les_mean =     296.259727049321
             stat err =       0.000487498329
             autocorr =       1.141488268294
              std dev =       0.645286238131
             le_variance =       0.416394329121


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.200097272040        initial  <--
     3.8147e-01     3.8147e+00             5.3725e-04       -17.200094884154
     1.5259e+00     1.5259e+01             1.8457e-04       -17.200095140518
     6.1035e+00     6.1035e+01             5.1200e-05       -17.200096887181

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2378
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.920240e-01 1 1  ON 0
 uu_1                 3.590030e-02 1 1  ON 1
 uu_2                -4.558154e-02 1 1  ON 2
 uu_3                -9.369684e-02 1 1  ON 3
 uu_4                -1.254395e-01 1 1  ON 4
 uu_5                -1.327175e-01 1 1  ON 5
 uu_6                -1.091752e-01 1 1  ON 6
 uu_7                -3.320252e-02 1 1  ON 7
 uu_8                 1.031049e-01 1 1  ON 8
 uu_9                 1.188043e-01 1 1  ON 9
 ud_0                 3.150724e-01 1 1  ON 10
 ud_1                 7.588460e-02 1 1  ON 11
 ud_2                -7.349772e-03 1 1  ON 12
 ud_3                -5.544534e-02 1 1  ON 13
 ud_4                -1.064909e-01 1 1  ON 14
 ud_5                -1.490267e-01 1 1  ON 15
 ud_6                -1.574002e-01 1 1  ON 16
 ud_7                -1.077651e-01 1 1  ON 17
 ud_8                 9.784573e-03 1 1  ON 18
 ud_9                 9.249274e-02 1 1  ON 19
 eO_0                -6.811427e-01 1 1  ON 20
 eO_1                -4.031138e-01 1 1  ON 21
 eO_2                -6.148171e-02 1 1  ON 22
 eO_3                 1.622024e-01 1 1  ON 23
 eO_4                 2.643912e-01 1 1  ON 24
 eO_5                 3.070669e-01 1 1  ON 25
 eO_6                 2.482060e-01 1 1  ON 26
 eO_7                 1.081196e-01 1 1  ON 27
 eO_8                 2.727080e-02 1 1  ON 28
 eO_9                 1.812841e-02 1 1  ON 29
eH1_0                -1.758194e-01 1 1  ON 30
eH1_1                -9.846473e-02 1 1  ON 31
eH1_2                -6.212059e-02 1 1  ON 32
eH1_3                -2.888859e-02 1 1  ON 33
eH1_4                 1.765530e-02 1 1  ON 34
eH1_5                 3.105868e-02 1 1  ON 35
eH1_6                 7.793711e-02 1 1  ON 36
eH1_7                 1.115201e-01 1 1  ON 37
eH1_8                 8.852174e-02 1 1  ON 38
eH1_9                 2.358150e-02 1 1  ON 39
eH2_0                -1.775248e-01 1 1  ON 40
eH2_1                -1.001682e-01 1 1  ON 41
eH2_2                -6.426985e-02 1 1  ON 42
eH2_3                -3.035996e-02 1 1  ON 43
eH2_4                 1.621120e-02 1 1  ON 44
eH2_5                 3.146590e-02 1 1  ON 45
eH2_6                 8.032629e-02 1 1  ON 46
eH2_7                 1.152633e-01 1 1  ON 47
eH2_8                 9.157523e-02 1 1  ON 48
eH2_9                 2.561166e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5345e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1363
    reference variance = 0.436274
====================================================
  Execution time = 2.0651e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.1703e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5483e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.417147076460
                                         uncertainty =       0.004916303542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.417147076460
                                         uncertainty =       0.004916303542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456634609
  error estimate for blocks of size 2^( 2) =       0.000468063629
  error estimate for blocks of size 2^( 3) =       0.000477454976
  error estimate for blocks of size 2^( 4) =       0.000484654692
  error estimate for blocks of size 2^( 5) =       0.000488093201
  error estimate for blocks of size 2^( 6) =       0.000490225473
  error estimate for blocks of size 2^( 7) =       0.000490225227

      target function =                  N/A
              le_mean =     -17.200157464856
             les_mean =     296.262446939061
             stat err =       0.000488299648
             autocorr =       1.143497383887
              std dev =       0.645778856693
             le_variance =       0.417030331752


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720015746486e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200157464856       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200157765505       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200157711347       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200157728362       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200157659161       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200157678469       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200157672411       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200157696774       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 4.918775e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200157464856       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200157543714       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200157525579       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200157530891       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200157511164       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200157515704       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200157514538       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200157519843       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.332695e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200157464856       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200157484815       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200157479994       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200157481389       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200157476251       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200157477357       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200157477090       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.507856e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204021 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6205e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.920237e-01 1 1  ON 0
 uu_1                 3.589852e-02 1 1  ON 1
 uu_2                -4.558947e-02 1 1  ON 2
 uu_3                -9.369961e-02 1 1  ON 3
 uu_4                -1.254370e-01 1 1  ON 4
 uu_5                -1.327165e-01 1 1  ON 5
 uu_6                -1.091721e-01 1 1  ON 6
 uu_7                -3.320600e-02 1 1  ON 7
 uu_8                 1.031020e-01 1 1  ON 8
 uu_9                 1.188100e-01 1 1  ON 9
 ud_0                 3.150782e-01 1 1  ON 10
 ud_1                 7.588965e-02 1 1  ON 11
 ud_2                -7.349979e-03 1 1  ON 12
 ud_3                -5.545866e-02 1 1  ON 13
 ud_4                -1.064822e-01 1 1  ON 14
 ud_5                -1.490267e-01 1 1  ON 15
 ud_6                -1.574023e-01 1 1  ON 16
 ud_7                -1.077696e-01 1 1  ON 17
 ud_8                 9.778468e-03 1 1  ON 18
 ud_9                 9.249398e-02 1 1  ON 19
 eO_0                -6.811545e-01 1 1  ON 20
 eO_1                -4.031178e-01 1 1  ON 21
 eO_2                -6.148062e-02 1 1  ON 22
 eO_3                 1.621936e-01 1 1  ON 23
 eO_4                 2.643892e-01 1 1  ON 24
 eO_5                 3.070711e-01 1 1  ON 25
 eO_6                 2.482151e-01 1 1  ON 26
 eO_7                 1.081284e-01 1 1  ON 27
 eO_8                 2.727250e-02 1 1  ON 28
 eO_9                 1.812928e-02 1 1  ON 29
eH1_0                -1.758194e-01 1 1  ON 30
eH1_1                -9.847389e-02 1 1  ON 31
eH1_2                -6.212458e-02 1 1  ON 32
eH1_3                -2.888418e-02 1 1  ON 33
eH1_4                 1.765654e-02 1 1  ON 34
eH1_5                 3.105999e-02 1 1  ON 35
eH1_6                 7.793571e-02 1 1  ON 36
eH1_7                 1.115202e-01 1 1  ON 37
eH1_8                 8.852653e-02 1 1  ON 38
eH1_9                 2.358322e-02 1 1  ON 39
eH2_0                -1.775256e-01 1 1  ON 40
eH2_1                -1.001716e-01 1 1  ON 41
eH2_2                -6.426559e-02 1 1  ON 42
eH2_3                -3.036684e-02 1 1  ON 43
eH2_4                 1.621227e-02 1 1  ON 44
eH2_5                 3.146609e-02 1 1  ON 45
eH2_6                 8.032394e-02 1 1  ON 46
eH2_7                 1.152628e-01 1 1  ON 47
eH2_8                 9.158084e-02 1 1  ON 48
eH2_9                 2.561356e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2467
    reference variance = 0.283758
====================================================
  Execution time = 2.0196e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.3523e-01
  Total weights = 2.0000e+06
  Execution time = 1.8160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435205906363
                                         uncertainty =       0.009183094957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435205906363
                                         uncertainty =       0.009183094957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466493068
  error estimate for blocks of size 2^( 2) =       0.000477692912
  error estimate for blocks of size 2^( 3) =       0.000486734706
  error estimate for blocks of size 2^( 4) =       0.000494352953
  error estimate for blocks of size 2^( 5) =       0.000498385243
  error estimate for blocks of size 2^( 6) =       0.000501184041
  error estimate for blocks of size 2^( 7) =       0.000500805906

      target function =                  N/A
              le_mean =     -17.201099399275
             les_mean =     296.313051890731
             stat err =       0.000498682036
             autocorr =       1.142765337149
              std dev =       0.659720823241
             le_variance =       0.435231564618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435218562803
                                         uncertainty =       0.009182441749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435218562803
                                         uncertainty =       0.009182441749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466499874
  error estimate for blocks of size 2^( 2) =       0.000477699573
  error estimate for blocks of size 2^( 3) =       0.000486741430
  error estimate for blocks of size 2^( 4) =       0.000494359443
  error estimate for blocks of size 2^( 5) =       0.000498392151
  error estimate for blocks of size 2^( 6) =       0.000501190966
  error estimate for blocks of size 2^( 7) =       0.000500812979

      target function =                  N/A
              le_mean =     -17.201099175971
             les_mean =     296.313056909590
             stat err =       0.000498688885
             autocorr =       1.142763379149
              std dev =       0.659730449213
             le_variance =       0.435244265619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435212024945
                                         uncertainty =       0.009182725647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435212024945
                                         uncertainty =       0.009182725647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466496359
  error estimate for blocks of size 2^( 2) =       0.000477696141
  error estimate for blocks of size 2^( 3) =       0.000486737975
  error estimate for blocks of size 2^( 4) =       0.000494356097
  error estimate for blocks of size 2^( 5) =       0.000498388614
  error estimate for blocks of size 2^( 6) =       0.000501187429
  error estimate for blocks of size 2^( 7) =       0.000500809397

      target function =                  N/A
              le_mean =     -17.201099267298
             les_mean =     296.313053492540
             stat err =       0.000498685384
             autocorr =       1.142764556163
              std dev =       0.659725478301
             le_variance =       0.435237706720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435206598223
                                         uncertainty =       0.009183046365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435206598223
                                         uncertainty =       0.009183046365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466493440
  error estimate for blocks of size 2^( 2) =       0.000477693279
  error estimate for blocks of size 2^( 3) =       0.000486735081
  error estimate for blocks of size 2^( 4) =       0.000494353311
  error estimate for blocks of size 2^( 5) =       0.000498385632
  error estimate for blocks of size 2^( 6) =       0.000501184432
  error estimate for blocks of size 2^( 7) =       0.000500806314

      target function =                  N/A
              le_mean =     -17.201099380263
             les_mean =     296.313051931514
             stat err =       0.000498682422
             autocorr =       1.142765284651
              std dev =       0.659721349841
             le_variance =       0.435232259436


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.201099399275        initial  <--
     3.8147e+00     3.8147e+01             4.9188e-05       -17.201099175971
     1.5259e+01     1.5259e+02             1.3327e-05       -17.201099267298
     6.1035e+01     6.1035e+02             3.5079e-06       -17.201099380263

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3772
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.920240e-01 1 1  ON 0
 uu_1                 3.590030e-02 1 1  ON 1
 uu_2                -4.558154e-02 1 1  ON 2
 uu_3                -9.369684e-02 1 1  ON 3
 uu_4                -1.254395e-01 1 1  ON 4
 uu_5                -1.327175e-01 1 1  ON 5
 uu_6                -1.091752e-01 1 1  ON 6
 uu_7                -3.320252e-02 1 1  ON 7
 uu_8                 1.031049e-01 1 1  ON 8
 uu_9                 1.188043e-01 1 1  ON 9
 ud_0                 3.150724e-01 1 1  ON 10
 ud_1                 7.588460e-02 1 1  ON 11
 ud_2                -7.349772e-03 1 1  ON 12
 ud_3                -5.544534e-02 1 1  ON 13
 ud_4                -1.064909e-01 1 1  ON 14
 ud_5                -1.490267e-01 1 1  ON 15
 ud_6                -1.574002e-01 1 1  ON 16
 ud_7                -1.077651e-01 1 1  ON 17
 ud_8                 9.784573e-03 1 1  ON 18
 ud_9                 9.249274e-02 1 1  ON 19
 eO_0                -6.811427e-01 1 1  ON 20
 eO_1                -4.031138e-01 1 1  ON 21
 eO_2                -6.148171e-02 1 1  ON 22
 eO_3                 1.622024e-01 1 1  ON 23
 eO_4                 2.643912e-01 1 1  ON 24
 eO_5                 3.070669e-01 1 1  ON 25
 eO_6                 2.482060e-01 1 1  ON 26
 eO_7                 1.081196e-01 1 1  ON 27
 eO_8                 2.727080e-02 1 1  ON 28
 eO_9                 1.812841e-02 1 1  ON 29
eH1_0                -1.758194e-01 1 1  ON 30
eH1_1                -9.846473e-02 1 1  ON 31
eH1_2                -6.212059e-02 1 1  ON 32
eH1_3                -2.888859e-02 1 1  ON 33
eH1_4                 1.765530e-02 1 1  ON 34
eH1_5                 3.105868e-02 1 1  ON 35
eH1_6                 7.793711e-02 1 1  ON 36
eH1_7                 1.115201e-01 1 1  ON 37
eH1_8                 8.852174e-02 1 1  ON 38
eH1_9                 2.358150e-02 1 1  ON 39
eH2_0                -1.775248e-01 1 1  ON 40
eH2_1                -1.001682e-01 1 1  ON 41
eH2_2                -6.426985e-02 1 1  ON 42
eH2_3                -3.035996e-02 1 1  ON 43
eH2_4                 1.621120e-02 1 1  ON 44
eH2_5                 3.146590e-02 1 1  ON 45
eH2_6                 8.032629e-02 1 1  ON 46
eH2_7                 1.152633e-01 1 1  ON 47
eH2_8                 9.157523e-02 1 1  ON 48
eH2_9                 2.561166e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5588e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.258
    reference variance = 0.378142
====================================================
  Execution time = 2.3463e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.3396e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434072755826
                                         uncertainty =       0.008932827772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434072755826
                                         uncertainty =       0.008932827772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465812063
  error estimate for blocks of size 2^( 2) =       0.000477523216
  error estimate for blocks of size 2^( 3) =       0.000487553684
  error estimate for blocks of size 2^( 4) =       0.000494360723
  error estimate for blocks of size 2^( 5) =       0.000501613514
  error estimate for blocks of size 2^( 6) =       0.000504424879
  error estimate for blocks of size 2^( 7) =       0.000506009171

      target function =                  N/A
              le_mean =     -17.200401541707
             les_mean =     296.287774735820
             stat err =       0.000501602072
             autocorr =       1.159570557862
              std dev =       0.658757737597
             le_variance =       0.433961756844


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720040154171e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200401541707       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200401557023       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200401579852       residual = 9.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200401576310       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200401572482       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200401582181       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200401581871       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 6.470488e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200401541707       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200401545558       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200401551319       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200401550428       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200401549465       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200401551887       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200401551818       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.625595e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200401541707       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200401542671       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200401544115       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200401543892       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200401543651       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200401544257       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200401544239       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 4.069013e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206307 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8994e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.920230e-01 1 1  ON 0
 uu_1                 3.590070e-02 1 1  ON 1
 uu_2                -4.558187e-02 1 1  ON 2
 uu_3                -9.369646e-02 1 1  ON 3
 uu_4                -1.254389e-01 1 1  ON 4
 uu_5                -1.327166e-01 1 1  ON 5
 uu_6                -1.091756e-01 1 1  ON 6
 uu_7                -3.320323e-02 1 1  ON 7
 uu_8                 1.031044e-01 1 1  ON 8
 uu_9                 1.188046e-01 1 1  ON 9
 ud_0                 3.150723e-01 1 1  ON 10
 ud_1                 7.588592e-02 1 1  ON 11
 ud_2                -7.348900e-03 1 1  ON 12
 ud_3                -5.544564e-02 1 1  ON 13
 ud_4                -1.064897e-01 1 1  ON 14
 ud_5                -1.490270e-01 1 1  ON 15
 ud_6                -1.574013e-01 1 1  ON 16
 ud_7                -1.077663e-01 1 1  ON 17
 ud_8                 9.783696e-03 1 1  ON 18
 ud_9                 9.249279e-02 1 1  ON 19
 eO_0                -6.811443e-01 1 1  ON 20
 eO_1                -4.031139e-01 1 1  ON 21
 eO_2                -6.148170e-02 1 1  ON 22
 eO_3                 1.622023e-01 1 1  ON 23
 eO_4                 2.643914e-01 1 1  ON 24
 eO_5                 3.070668e-01 1 1  ON 25
 eO_6                 2.482067e-01 1 1  ON 26
 eO_7                 1.081202e-01 1 1  ON 27
 eO_8                 2.727086e-02 1 1  ON 28
 eO_9                 1.812847e-02 1 1  ON 29
eH1_0                -1.758190e-01 1 1  ON 30
eH1_1                -9.846488e-02 1 1  ON 31
eH1_2                -6.212138e-02 1 1  ON 32
eH1_3                -2.888891e-02 1 1  ON 33
eH1_4                 1.765484e-02 1 1  ON 34
eH1_5                 3.105964e-02 1 1  ON 35
eH1_6                 7.793697e-02 1 1  ON 36
eH1_7                 1.115200e-01 1 1  ON 37
eH1_8                 8.852215e-02 1 1  ON 38
eH1_9                 2.358159e-02 1 1  ON 39
eH2_0                -1.775240e-01 1 1  ON 40
eH2_1                -1.001686e-01 1 1  ON 41
eH2_2                -6.427005e-02 1 1  ON 42
eH2_3                -3.036087e-02 1 1  ON 43
eH2_4                 1.621104e-02 1 1  ON 44
eH2_5                 3.146629e-02 1 1  ON 45
eH2_6                 8.032593e-02 1 1  ON 46
eH2_7                 1.152635e-01 1 1  ON 47
eH2_8                 9.157570e-02 1 1  ON 48
eH2_9                 2.561176e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2534
    reference variance = 0.584697
====================================================
  Execution time = 2.0313e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.2853e-01
  Total weights = 2.0000e+06
  Execution time = 1.8359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428472169685
                                         uncertainty =       0.009078734496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428472169685
                                         uncertainty =       0.009078734496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000462889491
  error estimate for blocks of size 2^( 2) =       0.000474248791
  error estimate for blocks of size 2^( 3) =       0.000483898293
  error estimate for blocks of size 2^( 4) =       0.000490255703
  error estimate for blocks of size 2^( 5) =       0.000493986136
  error estimate for blocks of size 2^( 6) =       0.000495886414
  error estimate for blocks of size 2^( 7) =       0.000493985505

      target function =                  N/A
              le_mean =     -17.200544500090
             les_mean =     296.287264246452
             stat err =       0.000493528439
             autocorr =       1.136762466981
              std dev =       0.654624595594
             le_variance =       0.428533361157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428469010204
                                         uncertainty =       0.009078639735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428469010204
                                         uncertainty =       0.009078639735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000462887782
  error estimate for blocks of size 2^( 2) =       0.000474247164
  error estimate for blocks of size 2^( 3) =       0.000483896741
  error estimate for blocks of size 2^( 4) =       0.000490254132
  error estimate for blocks of size 2^( 5) =       0.000493984527
  error estimate for blocks of size 2^( 6) =       0.000495884766
  error estimate for blocks of size 2^( 7) =       0.000493983787

      target function =                  N/A
              le_mean =     -17.200544506492
             les_mean =     296.287261303176
             stat err =       0.000493526803
             autocorr =       1.136763321004
              std dev =       0.654622179310
             le_variance =       0.428530197645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428470567022
                                         uncertainty =       0.009078686674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428470567022
                                         uncertainty =       0.009078686674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000462888624
  error estimate for blocks of size 2^( 2) =       0.000474247966
  error estimate for blocks of size 2^( 3) =       0.000483897506
  error estimate for blocks of size 2^( 4) =       0.000490254906
  error estimate for blocks of size 2^( 5) =       0.000493985320
  error estimate for blocks of size 2^( 6) =       0.000495885579
  error estimate for blocks of size 2^( 7) =       0.000493984634

      target function =                  N/A
              le_mean =     -17.200544503342
             les_mean =     296.287262753630
             stat err =       0.000493527610
             autocorr =       1.136762902952
              std dev =       0.654623369932
             le_variance =       0.428531756461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428471968594
                                         uncertainty =       0.009078728504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428471968594
                                         uncertainty =       0.009078728504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000462889382
  error estimate for blocks of size 2^( 2) =       0.000474248688
  error estimate for blocks of size 2^( 3) =       0.000483898194
  error estimate for blocks of size 2^( 4) =       0.000490255603
  error estimate for blocks of size 2^( 5) =       0.000493986034
  error estimate for blocks of size 2^( 6) =       0.000495886309
  error estimate for blocks of size 2^( 7) =       0.000493985396

      target function =                  N/A
              le_mean =     -17.200544500494
             les_mean =     296.287264059035
             stat err =       0.000493528335
             autocorr =       1.136762521765
              std dev =       0.654624441808
             le_variance =       0.428533159812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.200544500090        initial
     3.8147e+01     3.8147e+02             6.4705e-06       -17.200544506492  <--
     1.5259e+02     1.5259e+03             1.6256e-06       -17.200544503342
     6.1035e+02     6.1035e+03             4.0690e-07       -17.200544500494

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 2.9479e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.920198e-01 1 1  ON 0
 uu_1                 3.590192e-02 1 1  ON 1
 uu_2                -4.558287e-02 1 1  ON 2
 uu_3                -9.369533e-02 1 1  ON 3
 uu_4                -1.254372e-01 1 1  ON 4
 uu_5                -1.327141e-01 1 1  ON 5
 uu_6                -1.091768e-01 1 1  ON 6
 uu_7                -3.320535e-02 1 1  ON 7
 uu_8                 1.031028e-01 1 1  ON 8
 uu_9                 1.188055e-01 1 1  ON 9
 ud_0                 3.150722e-01 1 1  ON 10
 ud_1                 7.588983e-02 1 1  ON 11
 ud_2                -7.346306e-03 1 1  ON 12
 ud_3                -5.544652e-02 1 1  ON 13
 ud_4                -1.064861e-01 1 1  ON 14
 ud_5                -1.490277e-01 1 1  ON 15
 ud_6                -1.574047e-01 1 1  ON 16
 ud_7                -1.077700e-01 1 1  ON 17
 ud_8                 9.781067e-03 1 1  ON 18
 ud_9                 9.249293e-02 1 1  ON 19
 eO_0                -6.811492e-01 1 1  ON 20
 eO_1                -4.031140e-01 1 1  ON 21
 eO_2                -6.148169e-02 1 1  ON 22
 eO_3                 1.622020e-01 1 1  ON 23
 eO_4                 2.643921e-01 1 1  ON 24
 eO_5                 3.070667e-01 1 1  ON 25
 eO_6                 2.482091e-01 1 1  ON 26
 eO_7                 1.081221e-01 1 1  ON 27
 eO_8                 2.727103e-02 1 1  ON 28
 eO_9                 1.812867e-02 1 1  ON 29
eH1_0                -1.758177e-01 1 1  ON 30
eH1_1                -9.846534e-02 1 1  ON 31
eH1_2                -6.212374e-02 1 1  ON 32
eH1_3                -2.888987e-02 1 1  ON 33
eH1_4                 1.765345e-02 1 1  ON 34
eH1_5                 3.106249e-02 1 1  ON 35
eH1_6                 7.793653e-02 1 1  ON 36
eH1_7                 1.115199e-01 1 1  ON 37
eH1_8                 8.852336e-02 1 1  ON 38
eH1_9                 2.358187e-02 1 1  ON 39
eH2_0                -1.775216e-01 1 1  ON 40
eH2_1                -1.001698e-01 1 1  ON 41
eH2_2                -6.427066e-02 1 1  ON 42
eH2_3                -3.036357e-02 1 1  ON 43
eH2_4                 1.621057e-02 1 1  ON 44
eH2_5                 3.146745e-02 1 1  ON 45
eH2_6                 8.032484e-02 1 1  ON 46
eH2_7                 1.152641e-01 1 1  ON 47
eH2_8                 9.157709e-02 1 1  ON 48
eH2_9                 2.561206e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8478e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1858
    reference variance = 0.590741
====================================================
  Execution time = 2.0736e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7202e+01
  VMC Evar = 4.2886e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6449e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428946551541
                                         uncertainty =       0.010019532075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428946551541
                                         uncertainty =       0.010019532075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463064672
  error estimate for blocks of size 2^( 2) =       0.000474699222
  error estimate for blocks of size 2^( 3) =       0.000485031946
  error estimate for blocks of size 2^( 4) =       0.000491813098
  error estimate for blocks of size 2^( 5) =       0.000496683346
  error estimate for blocks of size 2^( 6) =       0.000498396723
  error estimate for blocks of size 2^( 7) =       0.000501948498

      target function =                  N/A
              le_mean =     -17.201524565707
             les_mean =     296.321304950934
             stat err =       0.000497210416
             autocorr =       1.152914599068
              std dev =       0.654872339265
             le_variance =       0.428857780735


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720152456571e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.201524565707       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.201524612563       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.201524732673       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.201524716028       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.201524689197       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.201524684028       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.201524688001       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.201524693152       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.076816e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.201524565707       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.201524577596       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.201524608242       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.201524604139       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.201524596887       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.201524595830       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.201524596788       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.201524597995       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 5.301414e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.201524565707       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.201524568690       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.201524576392       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.201524575370       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.201524573522       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.201524573273       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.201524573509       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.201524573806       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.332372e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209014 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6387e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.920162e-01 1 1  ON 0
 uu_1                 3.590198e-02 1 1  ON 1
 uu_2                -4.558551e-02 1 1  ON 2
 uu_3                -9.369554e-02 1 1  ON 3
 uu_4                -1.254385e-01 1 1  ON 4
 uu_5                -1.327112e-01 1 1  ON 5
 uu_6                -1.091741e-01 1 1  ON 6
 uu_7                -3.320624e-02 1 1  ON 7
 uu_8                 1.031016e-01 1 1  ON 8
 uu_9                 1.188074e-01 1 1  ON 9
 ud_0                 3.150736e-01 1 1  ON 10
 ud_1                 7.589290e-02 1 1  ON 11
 ud_2                -7.344358e-03 1 1  ON 12
 ud_3                -5.544726e-02 1 1  ON 13
 ud_4                -1.064841e-01 1 1  ON 14
 ud_5                -1.490310e-01 1 1  ON 15
 ud_6                -1.574078e-01 1 1  ON 16
 ud_7                -1.077715e-01 1 1  ON 17
 ud_8                 9.778867e-03 1 1  ON 18
 ud_9                 9.249342e-02 1 1  ON 19
 eO_0                -6.811543e-01 1 1  ON 20
 eO_1                -4.031131e-01 1 1  ON 21
 eO_2                -6.148281e-02 1 1  ON 22
 eO_3                 1.622023e-01 1 1  ON 23
 eO_4                 2.643882e-01 1 1  ON 24
 eO_5                 3.070667e-01 1 1  ON 25
 eO_6                 2.482132e-01 1 1  ON 26
 eO_7                 1.081257e-01 1 1  ON 27
 eO_8                 2.727160e-02 1 1  ON 28
 eO_9                 1.812896e-02 1 1  ON 29
eH1_0                -1.758190e-01 1 1  ON 30
eH1_1                -9.846767e-02 1 1  ON 31
eH1_2                -6.212423e-02 1 1  ON 32
eH1_3                -2.889256e-02 1 1  ON 33
eH1_4                 1.765704e-02 1 1  ON 34
eH1_5                 3.106176e-02 1 1  ON 35
eH1_6                 7.793692e-02 1 1  ON 36
eH1_7                 1.115204e-01 1 1  ON 37
eH1_8                 8.852555e-02 1 1  ON 38
eH1_9                 2.358253e-02 1 1  ON 39
eH2_0                -1.775224e-01 1 1  ON 40
eH2_1                -1.001741e-01 1 1  ON 41
eH2_2                -6.426536e-02 1 1  ON 42
eH2_3                -3.036571e-02 1 1  ON 43
eH2_4                 1.621175e-02 1 1  ON 44
eH2_5                 3.146726e-02 1 1  ON 45
eH2_6                 8.032254e-02 1 1  ON 46
eH2_7                 1.152643e-01 1 1  ON 47
eH2_8                 9.157920e-02 1 1  ON 48
eH2_9                 2.561278e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.229
    reference variance = 0.241909
====================================================
  Execution time = 1.9896e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.3370e-01
  Total weights = 2.0000e+06
  Execution time = 1.8182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433702249039
                                         uncertainty =       0.007707365308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433702249039
                                         uncertainty =       0.007707365308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465670189
  error estimate for blocks of size 2^( 2) =       0.000476893082
  error estimate for blocks of size 2^( 3) =       0.000485783807
  error estimate for blocks of size 2^( 4) =       0.000492481558
  error estimate for blocks of size 2^( 5) =       0.000496297840
  error estimate for blocks of size 2^( 6) =       0.000498301837
  error estimate for blocks of size 2^( 7) =       0.000498557621

      target function =                  N/A
              le_mean =     -17.200876075150
             les_mean =     296.303834986481
             stat err =       0.000496409714
             autocorr =       1.136380230607
              std dev =       0.658557097496
             le_variance =       0.433697450662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433696330627
                                         uncertainty =       0.007707305899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433696330627
                                         uncertainty =       0.007707305899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465667016
  error estimate for blocks of size 2^( 2) =       0.000476890005
  error estimate for blocks of size 2^( 3) =       0.000485780742
  error estimate for blocks of size 2^( 4) =       0.000492478645
  error estimate for blocks of size 2^( 5) =       0.000496294909
  error estimate for blocks of size 2^( 6) =       0.000498298825
  error estimate for blocks of size 2^( 7) =       0.000498554161

      target function =                  N/A
              le_mean =     -17.200876115280
             les_mean =     296.303830455357
             stat err =       0.000496406635
             autocorr =       1.136381622176
              std dev =       0.658552609141
             le_variance =       0.433691539006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433699103314
                                         uncertainty =       0.007707333400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433699103314
                                         uncertainty =       0.007707333400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465668503
  error estimate for blocks of size 2^( 2) =       0.000476891449
  error estimate for blocks of size 2^( 3) =       0.000485782181
  error estimate for blocks of size 2^( 4) =       0.000492480013
  error estimate for blocks of size 2^( 5) =       0.000496296286
  error estimate for blocks of size 2^( 6) =       0.000498300244
  error estimate for blocks of size 2^( 7) =       0.000498555794

      target function =                  N/A
              le_mean =     -17.200876094646
             les_mean =     296.303832514997
             stat err =       0.000496408084
             autocorr =       1.136380999636
              std dev =       0.658554711834
             le_variance =       0.433694308479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433701849429
                                         uncertainty =       0.007707361247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433701849429
                                         uncertainty =       0.007707361247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465669975
  error estimate for blocks of size 2^( 2) =       0.000476892875
  error estimate for blocks of size 2^( 3) =       0.000485783601
  error estimate for blocks of size 2^( 4) =       0.000492481362
  error estimate for blocks of size 2^( 5) =       0.000496297643
  error estimate for blocks of size 2^( 6) =       0.000498301635
  error estimate for blocks of size 2^( 7) =       0.000498557389

      target function =                  N/A
              le_mean =     -17.200876077532
             les_mean =     296.303834669268
             stat err =       0.000496409507
             autocorr =       1.136380329066
              std dev =       0.658556794437
             le_variance =       0.433697051499


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.200876075150        initial
     9.5367e+00     9.5367e+01             2.0768e-05       -17.200876115280  <--
     3.8147e+01     3.8147e+02             5.3014e-06       -17.200876094646
     1.5259e+02     1.5259e+03             1.3324e-06       -17.200876077532

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 2.9073e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.920054e-01 1 1  ON 0
 uu_1                 3.590195e-02 1 1  ON 1
 uu_2                -4.559320e-02 1 1  ON 2
 uu_3                -9.369633e-02 1 1  ON 3
 uu_4                -1.254424e-01 1 1  ON 4
 uu_5                -1.327025e-01 1 1  ON 5
 uu_6                -1.091659e-01 1 1  ON 6
 uu_7                -3.320891e-02 1 1  ON 7
 uu_8                 1.030981e-01 1 1  ON 8
 uu_9                 1.188130e-01 1 1  ON 9
 ud_0                 3.150780e-01 1 1  ON 10
 ud_1                 7.590189e-02 1 1  ON 11
 ud_2                -7.338664e-03 1 1  ON 12
 ud_3                -5.544926e-02 1 1  ON 13
 ud_4                -1.064782e-01 1 1  ON 14
 ud_5                -1.490405e-01 1 1  ON 15
 ud_6                -1.574171e-01 1 1  ON 16
 ud_7                -1.077761e-01 1 1  ON 17
 ud_8                 9.772284e-03 1 1  ON 18
 ud_9                 9.249491e-02 1 1  ON 19
 eO_0                -6.811694e-01 1 1  ON 20
 eO_1                -4.031104e-01 1 1  ON 21
 eO_2                -6.148616e-02 1 1  ON 22
 eO_3                 1.622033e-01 1 1  ON 23
 eO_4                 2.643764e-01 1 1  ON 24
 eO_5                 3.070668e-01 1 1  ON 25
 eO_6                 2.482256e-01 1 1  ON 26
 eO_7                 1.081366e-01 1 1  ON 27
 eO_8                 2.727328e-02 1 1  ON 28
 eO_9                 1.812982e-02 1 1  ON 29
eH1_0                -1.758229e-01 1 1  ON 30
eH1_1                -9.847470e-02 1 1  ON 31
eH1_2                -6.212571e-02 1 1  ON 32
eH1_3                -2.890051e-02 1 1  ON 33
eH1_4                 1.766763e-02 1 1  ON 34
eH1_5                 3.105966e-02 1 1  ON 35
eH1_6                 7.793809e-02 1 1  ON 36
eH1_7                 1.115220e-01 1 1  ON 37
eH1_8                 8.853209e-02 1 1  ON 38
eH1_9                 2.358450e-02 1 1  ON 39
eH2_0                -1.775251e-01 1 1  ON 40
eH2_1                -1.001865e-01 1 1  ON 41
eH2_2                -6.424989e-02 1 1  ON 42
eH2_3                -3.037191e-02 1 1  ON 43
eH2_4                 1.621523e-02 1 1  ON 44
eH2_5                 3.146665e-02 1 1  ON 45
eH2_6                 8.031567e-02 1 1  ON 46
eH2_7                 1.152651e-01 1 1  ON 47
eH2_8                 9.158550e-02 1 1  ON 48
eH2_9                 2.561491e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5466e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2222
    reference variance = 0.313668
====================================================
  Execution time = 2.0591e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.1693e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.417096970693
                                         uncertainty =       0.005111320784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.417096970693
                                         uncertainty =       0.005111320784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456582309
  error estimate for blocks of size 2^( 2) =       0.000468209282
  error estimate for blocks of size 2^( 3) =       0.000478143351
  error estimate for blocks of size 2^( 4) =       0.000486626576
  error estimate for blocks of size 2^( 5) =       0.000490798780
  error estimate for blocks of size 2^( 6) =       0.000493655966
  error estimate for blocks of size 2^( 7) =       0.000498367710

      target function =                  N/A
              le_mean =     -17.200982702295
             les_mean =     296.290740526484
             stat err =       0.000492362258
             autocorr =       1.162870488211
              std dev =       0.645704894118
             le_variance =       0.416934810288


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720098270230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200982702295       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200982606476       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200982632539       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200982487458       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200982515747       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200982424860       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200982448871       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200982497536       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 7.456971e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200982702295       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200982677249       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200982682645       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200982642323       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200982643973       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200982618931       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200982623346       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200982635813       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.876663e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200982702295       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200982695962       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200982697223       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200982686840       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200982686823       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200982680413       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200982681395       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200982684484       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 4.695278e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211703 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6050e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.919888e-01 1 1  ON 0
 uu_1                 3.589612e-02 1 1  ON 1
 uu_2                -4.559521e-02 1 1  ON 2
 uu_3                -9.370130e-02 1 1  ON 3
 uu_4                -1.254358e-01 1 1  ON 4
 uu_5                -1.326985e-01 1 1  ON 5
 uu_6                -1.091533e-01 1 1  ON 6
 uu_7                -3.320972e-02 1 1  ON 7
 uu_8                 1.030931e-01 1 1  ON 8
 uu_9                 1.188189e-01 1 1  ON 9
 ud_0                 3.150629e-01 1 1  ON 10
 ud_1                 7.591553e-02 1 1  ON 11
 ud_2                -7.331778e-03 1 1  ON 12
 ud_3                -5.544565e-02 1 1  ON 13
 ud_4                -1.064611e-01 1 1  ON 14
 ud_5                -1.490532e-01 1 1  ON 15
 ud_6                -1.574213e-01 1 1  ON 16
 ud_7                -1.077752e-01 1 1  ON 17
 ud_8                 9.759328e-03 1 1  ON 18
 ud_9                 9.249365e-02 1 1  ON 19
 eO_0                -6.811779e-01 1 1  ON 20
 eO_1                -4.031172e-01 1 1  ON 21
 eO_2                -6.149350e-02 1 1  ON 22
 eO_3                 1.621846e-01 1 1  ON 23
 eO_4                 2.643780e-01 1 1  ON 24
 eO_5                 3.070740e-01 1 1  ON 25
 eO_6                 2.482423e-01 1 1  ON 26
 eO_7                 1.081503e-01 1 1  ON 27
 eO_8                 2.727487e-02 1 1  ON 28
 eO_9                 1.813029e-02 1 1  ON 29
eH1_0                -1.758276e-01 1 1  ON 30
eH1_1                -9.848668e-02 1 1  ON 31
eH1_2                -6.213934e-02 1 1  ON 32
eH1_3                -2.890508e-02 1 1  ON 33
eH1_4                 1.767139e-02 1 1  ON 34
eH1_5                 3.107656e-02 1 1  ON 35
eH1_6                 7.794017e-02 1 1  ON 36
eH1_7                 1.115231e-01 1 1  ON 37
eH1_8                 8.854008e-02 1 1  ON 38
eH1_9                 2.358701e-02 1 1  ON 39
eH2_0                -1.775079e-01 1 1  ON 40
eH2_1                -1.001882e-01 1 1  ON 41
eH2_2                -6.425150e-02 1 1  ON 42
eH2_3                -3.037669e-02 1 1  ON 43
eH2_4                 1.619742e-02 1 1  ON 44
eH2_5                 3.146451e-02 1 1  ON 45
eH2_6                 8.030983e-02 1 1  ON 46
eH2_7                 1.152681e-01 1 1  ON 47
eH2_8                 9.159574e-02 1 1  ON 48
eH2_9                 2.561789e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1895
    reference variance = 0.31129
====================================================
  Execution time = 2.0168e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7200e+01
  VMC Evar = 1.8560e+00
  Total weights = 2.0000e+06
  Execution time = 1.8150e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.858444364027
                                         uncertainty =       1.425475063699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.858444364027
                                         uncertainty =       1.425475063699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000963342982
  error estimate for blocks of size 2^( 2) =       0.000968673165
  error estimate for blocks of size 2^( 3) =       0.000973346338
  error estimate for blocks of size 2^( 4) =       0.000976351851
  error estimate for blocks of size 2^( 5) =       0.000977732714
  error estimate for blocks of size 2^( 6) =       0.000978669020
  error estimate for blocks of size 2^( 7) =       0.000981481462

      target function =                  N/A
              le_mean =     -17.199946464680
             les_mean =     297.694216862628
             stat err =       0.000978558762
             autocorr =       1.031839011548
              std dev =       1.362372710682
             le_variance =       1.856059402811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.858132355670
                                         uncertainty =       1.425229661959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.858132355670
                                         uncertainty =       1.425229661959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000963262115
  error estimate for blocks of size 2^( 2) =       0.000968593006
  error estimate for blocks of size 2^( 3) =       0.000973267305
  error estimate for blocks of size 2^( 4) =       0.000976273231
  error estimate for blocks of size 2^( 5) =       0.000977654487
  error estimate for blocks of size 2^( 6) =       0.000978591669
  error estimate for blocks of size 2^( 7) =       0.000981402898

      target function =                  N/A
              le_mean =     -17.199945990310
             les_mean =     297.693888945834
             stat err =       0.000978480571
             autocorr =       1.031847351052
              std dev =       1.362258347059
             le_variance =       1.855747804133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.858259155985
                                         uncertainty =       1.425328916806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.858259155985
                                         uncertainty =       1.425328916806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000963294980
  error estimate for blocks of size 2^( 2) =       0.000968625593
  error estimate for blocks of size 2^( 3) =       0.000973299444
  error estimate for blocks of size 2^( 4) =       0.000976305210
  error estimate for blocks of size 2^( 5) =       0.000977686322
  error estimate for blocks of size 2^( 6) =       0.000978623088
  error estimate for blocks of size 2^( 7) =       0.000981434853

      target function =                  N/A
              le_mean =     -17.199946194888
             les_mean =     297.694022617755
             stat err =       0.000978512368
             autocorr =       1.031844002706
              std dev =       1.362304825889
             le_variance =       1.855874438642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.858420095502
                                         uncertainty =       1.425455903352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.858420095502
                                         uncertainty =       1.425455903352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000963336693
  error estimate for blocks of size 2^( 2) =       0.000968666932
  error estimate for blocks of size 2^( 3) =       0.000973340194
  error estimate for blocks of size 2^( 4) =       0.000976345740
  error estimate for blocks of size 2^( 5) =       0.000977726636
  error estimate for blocks of size 2^( 6) =       0.000978663000
  error estimate for blocks of size 2^( 7) =       0.000981475355

      target function =                  N/A
              le_mean =     -17.199946429169
             les_mean =     297.694191404528
             stat err =       0.000978552683
             autocorr =       1.031839666494
              std dev =       1.362363815674
             le_variance =       1.856035166259


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.199946464680        initial  <--
     2.3842e+00     2.3842e+01             7.4570e-05       -17.199945990310
     9.5367e+00     9.5367e+01             1.8767e-05       -17.199946194888
     3.8147e+01     3.8147e+02             4.6953e-06       -17.199946429169

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4190
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.920054e-01 1 1  ON 0
 uu_1                 3.590195e-02 1 1  ON 1
 uu_2                -4.559320e-02 1 1  ON 2
 uu_3                -9.369633e-02 1 1  ON 3
 uu_4                -1.254424e-01 1 1  ON 4
 uu_5                -1.327025e-01 1 1  ON 5
 uu_6                -1.091659e-01 1 1  ON 6
 uu_7                -3.320891e-02 1 1  ON 7
 uu_8                 1.030981e-01 1 1  ON 8
 uu_9                 1.188130e-01 1 1  ON 9
 ud_0                 3.150780e-01 1 1  ON 10
 ud_1                 7.590189e-02 1 1  ON 11
 ud_2                -7.338664e-03 1 1  ON 12
 ud_3                -5.544926e-02 1 1  ON 13
 ud_4                -1.064782e-01 1 1  ON 14
 ud_5                -1.490405e-01 1 1  ON 15
 ud_6                -1.574171e-01 1 1  ON 16
 ud_7                -1.077761e-01 1 1  ON 17
 ud_8                 9.772284e-03 1 1  ON 18
 ud_9                 9.249491e-02 1 1  ON 19
 eO_0                -6.811694e-01 1 1  ON 20
 eO_1                -4.031104e-01 1 1  ON 21
 eO_2                -6.148616e-02 1 1  ON 22
 eO_3                 1.622033e-01 1 1  ON 23
 eO_4                 2.643764e-01 1 1  ON 24
 eO_5                 3.070668e-01 1 1  ON 25
 eO_6                 2.482256e-01 1 1  ON 26
 eO_7                 1.081366e-01 1 1  ON 27
 eO_8                 2.727328e-02 1 1  ON 28
 eO_9                 1.812982e-02 1 1  ON 29
eH1_0                -1.758229e-01 1 1  ON 30
eH1_1                -9.847470e-02 1 1  ON 31
eH1_2                -6.212571e-02 1 1  ON 32
eH1_3                -2.890051e-02 1 1  ON 33
eH1_4                 1.766763e-02 1 1  ON 34
eH1_5                 3.105966e-02 1 1  ON 35
eH1_6                 7.793809e-02 1 1  ON 36
eH1_7                 1.115220e-01 1 1  ON 37
eH1_8                 8.853209e-02 1 1  ON 38
eH1_9                 2.358450e-02 1 1  ON 39
eH2_0                -1.775251e-01 1 1  ON 40
eH2_1                -1.001865e-01 1 1  ON 41
eH2_2                -6.424989e-02 1 1  ON 42
eH2_3                -3.037191e-02 1 1  ON 43
eH2_4                 1.621523e-02 1 1  ON 44
eH2_5                 3.146665e-02 1 1  ON 45
eH2_6                 8.031567e-02 1 1  ON 46
eH2_7                 1.152651e-01 1 1  ON 47
eH2_8                 9.158550e-02 1 1  ON 48
eH2_9                 2.561491e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5473e+01 secs
  Total Execution time = 1.1148e+03 secs

=========================================================
  A new xml input file : H2O.s019.cont.xml
