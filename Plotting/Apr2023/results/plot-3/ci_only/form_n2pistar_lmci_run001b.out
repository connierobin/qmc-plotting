Rank =    0  Free Memory = 38276 MB
Rank =    1  Free Memory = 38268 MB
Rank =    2  Free Memory = 38268 MB
Rank =    3  Free Memory = 38268 MB
Rank =    4  Free Memory = 38267 MB
Rank =    5  Free Memory = 38267 MB
Rank =    6  Free Memory = 38267 MB
Rank =    7  Free Memory = 38267 MB
Rank =    8  Free Memory = 38267 MB
Rank =    9  Free Memory = 38267 MB
Rank =   10  Free Memory = 38267 MB
Rank =   11  Free Memory = 38267 MB
Rank =   12  Free Memory = 38267 MB
Rank =   13  Free Memory = 38267 MB
Rank =   14  Free Memory = 38267 MB
Rank =   15  Free Memory = 38254 MB
Rank =   16  Free Memory = 38252 MB
Rank =   17  Free Memory = 38250 MB
Rank =   18  Free Memory = 38250 MB
Rank =   19  Free Memory = 38250 MB
Rank =   20  Free Memory = 38250 MB
Rank =   21  Free Memory = 38250 MB
Rank =   22  Free Memory = 38250 MB
Rank =   23  Free Memory = 38250 MB
Rank =   24  Free Memory = 40518 MB
Rank =   25  Free Memory = 40518 MB
Rank =   26  Free Memory = 40518 MB
Rank =   27  Free Memory = 40518 MB
Rank =   28  Free Memory = 40518 MB
Rank =   29  Free Memory = 40518 MB
Rank =   30  Free Memory = 40518 MB
Rank =   31  Free Memory = 40518 MB
Rank =   32  Free Memory = 40518 MB
Rank =   33  Free Memory = 40518 MB
Rank =   34  Free Memory = 40518 MB
Rank =   35  Free Memory = 40518 MB
Rank =   36  Free Memory = 40518 MB
Rank =   37  Free Memory = 40518 MB
Rank =   38  Free Memory = 40518 MB
Rank =   39  Free Memory = 40518 MB
Rank =   40  Free Memory = 40518 MB
Rank =   41  Free Memory = 40518 MB
Rank =   42  Free Memory = 40518 MB
Rank =   43  Free Memory = 40518 MB
Rank =   44  Free Memory = 40518 MB
Rank =   45  Free Memory = 40518 MB
Rank =   46  Free Memory = 40518 MB
Rank =   47  Free Memory = 40518 MB
Rank =   48  Free Memory = 38403 MB
Rank =   49  Free Memory = 38403 MB
Rank =   50  Free Memory = 38403 MB
Rank =   51  Free Memory = 38403 MB
Rank =   52  Free Memory = 38403 MB
Rank =   53  Free Memory = 38403 MB
Rank =   54  Free Memory = 38403 MB
Rank =   55  Free Memory = 38403 MB
Rank =   56  Free Memory = 38403 MB
Rank =   57  Free Memory = 38403 MB
Rank =   58  Free Memory = 38403 MB
Rank =   59  Free Memory = 38403 MB
Rank =   60  Free Memory = 38403 MB
Rank =   61  Free Memory = 38402 MB
Rank =   62  Free Memory = 38402 MB
Rank =   63  Free Memory = 38402 MB
Rank =   64  Free Memory = 38402 MB
Rank =   65  Free Memory = 38402 MB
Rank =   66  Free Memory = 38402 MB
Rank =   67  Free Memory = 38402 MB
Rank =   68  Free Memory = 38402 MB
Rank =   69  Free Memory = 38402 MB
Rank =   70  Free Memory = 38402 MB
Rank =   71  Free Memory = 38402 MB
Rank =   72  Free Memory = 36858 MB
Rank =   73  Free Memory = 36858 MB
Rank =   74  Free Memory = 36858 MB
Rank =   75  Free Memory = 36858 MB
Rank =   76  Free Memory = 36858 MB
Rank =   77  Free Memory = 36858 MB
Rank =   78  Free Memory = 36858 MB
Rank =   79  Free Memory = 36858 MB
Rank =   80  Free Memory = 36858 MB
Rank =   81  Free Memory = 36858 MB
Rank =   82  Free Memory = 36858 MB
Rank =   83  Free Memory = 36858 MB
Rank =   84  Free Memory = 36858 MB
Rank =   85  Free Memory = 36857 MB
Rank =   86  Free Memory = 36857 MB
Rank =   87  Free Memory = 36857 MB
Rank =   88  Free Memory = 36857 MB
Rank =   89  Free Memory = 36857 MB
Rank =   90  Free Memory = 36857 MB
Rank =   91  Free Memory = 36854 MB
Rank =   92  Free Memory = 36852 MB
Rank =   93  Free Memory = 36852 MB
Rank =   94  Free Memory = 36852 MB
Rank =   95  Free Memory = 36852 MB
  Input file(s): opt_form_n2pistar_lmci_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 96
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 96
  MPI ranks per node        = 24
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_lmci_run001b.xml

  Project = FORM
  date    = 2023-05-02 09:53:34 PDT
  host    = n0112.savio2

 Random Number
 -------------
  Offset for the random number seeds based on time: 14

  Range of prime numbers to use as seeds over processors and threads = 53-613


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0
  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 12.7057

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 10.1859

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 12.7057

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 12.7057

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 77 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.00046
Norm of qchem ci vector (sum of qchem_ci^2): 0
Found 24 unique up determinants.
Found 24 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 1.405

  Adding pseudopotential for O
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 1.075

  Adding pseudopotential for H1
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1e-10
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 0.001
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 0.001

  Adding pseudopotential for H2
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1e-10
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 0.001
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 0.001
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 0.1737 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAB source=e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 76
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.3148
    reference variance = 3.31164
====================================================
  Execution time = 2.3808e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0308e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6941e+00
  Total weights = 1.949660903e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9426e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745793436662
                                         uncertainty =       0.031761044786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745793436662
                                         uncertainty =       0.031761044786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368529129
  error estimate for blocks of size 2^( 2) =       0.001439807587
  error estimate for blocks of size 2^( 3) =       0.001504803295
  error estimate for blocks of size 2^( 4) =       0.001548638980
  error estimate for blocks of size 2^( 5) =       0.001568739140
  error estimate for blocks of size 2^( 6) =       0.001577676604
  error estimate for blocks of size 2^( 7) =       0.001584166551

      target function =                  N/A
              le_mean =     -22.329632636114
             les_mean =     502.306549821357
             stat err =       0.001569805319
             autocorr =       1.315780666064
              std dev =       1.935423421336
             le_variance =       3.745863819857


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.232963263611e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329632635313       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329699827451       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329700303694       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329700261122       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.247172e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329632635313       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329657674685       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329657662123       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 4.638494e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329632635313       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329639770260       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329639774298       residual = 4.66e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 1.324230e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006332 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9770e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_001 -6.983782e-01                3 1 ON  0
ci_002 -7.021158e-01                3 1 ON  1
ci_003 -6.084546e-02                3 1 ON  2
ci_004 -6.210415e-02                3 1 ON  3
ci_005 4.533087e-02                 3 1 ON  4
ci_006 4.546506e-02                 3 1 ON  5
ci_007 3.081065e-02                 3 1 ON  6
ci_008 3.269418e-02                 3 1 ON  7
ci_009 -2.593688e-02                3 1 ON  8
ci_010 -2.457675e-02                3 1 ON  9
ci_011 -2.250675e-02                3 1 ON  10
ci_012 -2.296808e-02                3 1 ON  11
ci_013 1.905469e-02                 3 1 ON  12
ci_014 1.998990e-02                 3 1 ON  13
ci_015 1.991951e-02                 3 1 ON  14
ci_016 2.073249e-02                 3 1 ON  15
ci_017 1.540019e-02                 3 1 ON  16
ci_018 1.591527e-02                 3 1 ON  17
ci_019 8.968116e-03                 3 1 ON  18
ci_020 9.981209e-03                 3 1 ON  19
ci_021 -9.746334e-03                3 1 ON  20
ci_022 -1.020252e-02                3 1 ON  21
ci_023 8.539401e-03                 3 1 ON  22
ci_024 9.292191e-03                 3 1 ON  23
ci_025 7.973758e-03                 3 1 ON  24
ci_026 8.416891e-03                 3 1 ON  25
ci_027 8.089641e-03                 3 1 ON  26
ci_028 7.774459e-03                 3 1 ON  27
ci_029 -8.269465e-03                3 1 ON  28
ci_030 -7.127950e-03                3 1 ON  29
ci_031 -7.491735e-03                3 1 ON  30
ci_032 -6.973832e-03                3 1 ON  31
ci_033 7.190893e-03                 3 1 ON  32
ci_034 7.090411e-03                 3 1 ON  33
ci_035 6.876197e-03                 3 1 ON  34
ci_036 7.007197e-03                 3 1 ON  35
ci_037 5.986077e-03                 3 1 ON  36
ci_038 6.624618e-03                 3 1 ON  37
ci_039 5.666352e-03                 3 1 ON  38
ci_040 5.718732e-03                 3 1 ON  39
ci_041 5.900506e-03                 3 1 ON  40
ci_042 5.045705e-03                 3 1 ON  41
ci_043 5.117384e-03                 3 1 ON  42
ci_044 5.134082e-03                 3 1 ON  43
ci_045 4.499577e-03                 3 1 ON  44
ci_046 5.564254e-03                 3 1 ON  45
ci_047 -4.902243e-03                3 1 ON  46
ci_048 -4.156349e-03                3 1 ON  47
ci_049 3.002539e-03                 3 1 ON  48
ci_050 3.433038e-03                 3 1 ON  49
ci_051 -2.551851e-03                3 1 ON  50
ci_052 -2.484558e-03                3 1 ON  51
ci_053 -2.807656e-03                3 1 ON  52
ci_054 -1.996583e-03                3 1 ON  53
ci_055 -2.328670e-03                3 1 ON  54
ci_056 -3.372958e-03                3 1 ON  55
ci_057 -1.840968e-03                3 1 ON  56
ci_058 -2.378918e-03                3 1 ON  57
ci_059 -1.493708e-03                3 1 ON  58
ci_060 -1.564547e-03                3 1 ON  59
ci_061 -1.448130e-03                3 1 ON  60
ci_062 -1.413647e-03                3 1 ON  61
ci_063 -1.076277e-03                3 1 ON  62
ci_064 -1.306564e-03                3 1 ON  63
ci_065 -1.874450e-03                3 1 ON  64
ci_066 -1.674202e-03                3 1 ON  65
ci_067 -1.578489e-03                3 1 ON  66
ci_068 -7.565899e-04                3 1 ON  67
ci_069 1.669362e-03                 3 1 ON  68
ci_070 7.336612e-04                 3 1 ON  69
ci_071 -1.670187e-03                3 1 ON  70
ci_072 -1.229766e-03                3 1 ON  71
ci_073 6.141592e-04                 3 1 ON  72
ci_074 9.504440e-04                 3 1 ON  73
ci_075 -9.267243e-04                3 1 ON  74
ci_076 -1.622401e-03                3 1 ON  75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.2877
    reference variance = 3.44539
====================================================
  Execution time = 2.3216e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 6.4438e+00
  Total weights = 1.9500e+06
  Execution time = 4.4367e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0269562
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       6.544812166902
                                         uncertainty =       2.651676530150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       6.544812166902
                                         uncertainty =       2.651676530150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001807798648
  error estimate for blocks of size 2^( 2) =       0.001863858142
  error estimate for blocks of size 2^( 3) =       0.001912227871
  error estimate for blocks of size 2^( 4) =       0.001946774449
  error estimate for blocks of size 2^( 5) =       0.001967181484
  error estimate for blocks of size 2^( 6) =       0.001978550720
  error estimate for blocks of size 2^( 7) =       0.001983873417

      target function =                  N/A
              le_mean =     -22.326587637227
             les_mean =     505.083179333852
             stat err =       0.001969095017
             autocorr =       1.186405720376
              std dev =       2.556654271391
             le_variance =       6.536481063421

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00466818
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       6.544841431758
                                         uncertainty =       2.651687448512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       6.544841431758
                                         uncertainty =       2.651687448512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001807802800
  error estimate for blocks of size 2^( 2) =       0.001863881090
  error estimate for blocks of size 2^( 3) =       0.001912266928
  error estimate for blocks of size 2^( 4) =       0.001946816725
  error estimate for blocks of size 2^( 5) =       0.001967238081
  error estimate for blocks of size 2^( 6) =       0.001978601538
  error estimate for blocks of size 2^( 7) =       0.001983931570

      target function =                  N/A
              le_mean =     -22.326606071083
             les_mean =     504.953694919003
             stat err =       0.001969146978
             autocorr =       1.186462885243
              std dev =       2.556660143489
             le_variance =       6.536511089304

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0276637
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       6.544780049835
                                         uncertainty =       2.651684068028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       6.544780049835
                                         uncertainty =       2.651684068028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001807794267
  error estimate for blocks of size 2^( 2) =       0.001863867592
  error estimate for blocks of size 2^( 3) =       0.001912240895
  error estimate for blocks of size 2^( 4) =       0.001946783424
  error estimate for blocks of size 2^( 5) =       0.001967201552
  error estimate for blocks of size 2^( 6) =       0.001978570183
  error estimate for blocks of size 2^( 7) =       0.001983899189

      target function =                  N/A
              le_mean =     -22.326597327733
             les_mean =     504.921058585086
             stat err =       0.001969113587
             autocorr =       1.186433847360
              std dev =       2.556648075875
             le_variance =       6.536449383878

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0997984
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       6.544786756665
                                         uncertainty =       2.651677687466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       6.544786756665
                                         uncertainty =       2.651677687466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001807795142
  error estimate for blocks of size 2^( 2) =       0.001863857153
  error estimate for blocks of size 2^( 3) =       0.001912222844
  error estimate for blocks of size 2^( 4) =       0.001946768510
  error estimate for blocks of size 2^( 5) =       0.001967179505
  error estimate for blocks of size 2^( 6) =       0.001978550219
  error estimate for blocks of size 2^( 7) =       0.001983892464

      target function =                  N/A
              le_mean =     -22.326590280819
             les_mean =     504.921087895882
             stat err =       0.001969097674
             autocorr =       1.186413523727
              std dev =       2.556649313006
             le_variance =       6.536455709692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326587637227        initial
     2.5000e-01     2.5000e+00             1.2472e-03       -22.326606071083  <--
     1.0000e+00     1.0000e+01             4.6385e-04       -22.326597327733
     4.0000e+00     4.0000e+01             1.3242e-04       -22.326590280819

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.5388e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_001                -6.983650e-01 3 1  ON 0
ci_002                -7.021719e-01 3 1  ON 1
ci_003                -6.109856e-02 3 1  ON 2
ci_004                -6.214781e-02 3 1  ON 3
ci_005                 4.511339e-02 3 1  ON 4
ci_006                 4.539504e-02 3 1  ON 5
ci_007                 3.081456e-02 3 1  ON 6
ci_008                 3.254956e-02 3 1  ON 7
ci_009                -2.541444e-02 3 1  ON 8
ci_010                -2.455100e-02 3 1  ON 9
ci_011                -2.205196e-02 3 1  ON 10
ci_012                -2.309522e-02 3 1  ON 11
ci_013                 1.943884e-02 3 1  ON 12
ci_014                 1.986425e-02 3 1  ON 13
ci_015                 2.014630e-02 3 1  ON 14
ci_016                 2.076894e-02 3 1  ON 15
ci_017                 1.485936e-02 3 1  ON 16
ci_018                 1.623441e-02 3 1  ON 17
ci_019                 9.226001e-03 3 1  ON 18
ci_020                 9.687016e-03 3 1  ON 19
ci_021                -9.432189e-03 3 1  ON 20
ci_022                -9.899207e-03 3 1  ON 21
ci_023                 8.723907e-03 3 1  ON 22
ci_024                 9.818681e-03 3 1  ON 23
ci_025                 7.556541e-03 3 1  ON 24
ci_026                 8.515715e-03 3 1  ON 25
ci_027                 7.621220e-03 3 1  ON 26
ci_028                 7.961104e-03 3 1  ON 27
ci_029                -7.903631e-03 3 1  ON 28
ci_030                -7.102540e-03 3 1  ON 29
ci_031                -7.734418e-03 3 1  ON 30
ci_032                -6.818034e-03 3 1  ON 31
ci_033                 7.459431e-03 3 1  ON 32
ci_034                 7.305530e-03 3 1  ON 33
ci_035                 6.791079e-03 3 1  ON 34
ci_036                 6.863249e-03 3 1  ON 35
ci_037                 5.785220e-03 3 1  ON 36
ci_038                 6.223155e-03 3 1  ON 37
ci_039                 5.708020e-03 3 1  ON 38
ci_040                 5.487743e-03 3 1  ON 39
ci_041                 5.505384e-03 3 1  ON 40
ci_042                 4.925354e-03 3 1  ON 41
ci_043                 4.956329e-03 3 1  ON 42
ci_044                 4.350759e-03 3 1  ON 43
ci_045                 4.711088e-03 3 1  ON 44
ci_046                 5.469045e-03 3 1  ON 45
ci_047                -4.893972e-03 3 1  ON 46
ci_048                -4.217899e-03 3 1  ON 47
ci_049                 3.500290e-03 3 1  ON 48
ci_050                 3.527201e-03 3 1  ON 49
ci_051                -2.498190e-03 3 1  ON 50
ci_052                -2.775410e-03 3 1  ON 51
ci_053                -2.903053e-03 3 1  ON 52
ci_054                -2.608503e-03 3 1  ON 53
ci_055                -2.729375e-03 3 1  ON 54
ci_056                -3.042093e-03 3 1  ON 55
ci_057                -1.718008e-03 3 1  ON 56
ci_058                -2.431112e-03 3 1  ON 57
ci_059                -1.932322e-03 3 1  ON 58
ci_060                -1.519088e-03 3 1  ON 59
ci_061                -1.723933e-03 3 1  ON 60
ci_062                -1.841668e-03 3 1  ON 61
ci_063                -1.108792e-03 3 1  ON 62
ci_064                -1.155800e-03 3 1  ON 63
ci_065                -1.715756e-03 3 1  ON 64
ci_066                -1.615911e-03 3 1  ON 65
ci_067                -1.992114e-03 3 1  ON 66
ci_068                -1.167909e-03 3 1  ON 67
ci_069                 1.636018e-03 3 1  ON 68
ci_070                 7.131523e-04 3 1  ON 69
ci_071                -1.874395e-03 3 1  ON 70
ci_072                -6.774563e-04 3 1  ON 71
ci_073                 8.919551e-04 3 1  ON 72
ci_074                 1.112880e-03 3 1  ON 73
ci_075                -1.316364e-03 3 1  ON 74
ci_076                -1.367493e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5169e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2301e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.1555
    reference variance = 3.8003
====================================================
  Execution time = 2.3826e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0282e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7415e+00
  Total weights = 1.949952544e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8956e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792120136716
                                         uncertainty =       0.035479188062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792120136716
                                         uncertainty =       0.035479188062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376921358
  error estimate for blocks of size 2^( 2) =       0.001448652096
  error estimate for blocks of size 2^( 3) =       0.001511839420
  error estimate for blocks of size 2^( 4) =       0.001554560094
  error estimate for blocks of size 2^( 5) =       0.001577751137
  error estimate for blocks of size 2^( 6) =       0.001588899779
  error estimate for blocks of size 2^( 7) =       0.001600056225

      target function =                  N/A
              le_mean =     -22.326117826269
             les_mean =     502.197014420907
             stat err =       0.001580316809
             autocorr =       1.317255577092
              std dev =       1.947292014692
             le_variance =       3.791946190482


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232611782627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326117825423       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326162957015       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326170507897       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326170689076       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326170696074       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.326170682105       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 1.455152e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326117825423       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326145175462       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326147274276       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326147245237       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 7.982177e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326117825423       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326128442739       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326128667614       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.240061e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.010837 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9734e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_001                -6.983444e-01 3 1  ON 0
ci_002                -7.023038e-01 3 1  ON 1
ci_003                -6.060770e-02 3 1  ON 2
ci_004                -6.170486e-02 3 1  ON 3
ci_005                 4.520610e-02 3 1  ON 4
ci_006                 4.546290e-02 3 1  ON 5
ci_007                 3.089382e-02 3 1  ON 6
ci_008                 3.214438e-02 3 1  ON 7
ci_009                -2.617124e-02 3 1  ON 8
ci_010                -2.414807e-02 3 1  ON 9
ci_011                -2.252406e-02 3 1  ON 10
ci_012                -2.254187e-02 3 1  ON 11
ci_013                 1.947576e-02 3 1  ON 12
ci_014                 2.015483e-02 3 1  ON 13
ci_015                 1.977887e-02 3 1  ON 14
ci_016                 2.079193e-02 3 1  ON 15
ci_017                 1.491308e-02 3 1  ON 16
ci_018                 1.570961e-02 3 1  ON 17
ci_019                 9.423579e-03 3 1  ON 18
ci_020                 9.886178e-03 3 1  ON 19
ci_021                -9.013299e-03 3 1  ON 20
ci_022                -1.011974e-02 3 1  ON 21
ci_023                 9.053438e-03 3 1  ON 22
ci_024                 9.020463e-03 3 1  ON 23
ci_025                 6.947061e-03 3 1  ON 24
ci_026                 8.559492e-03 3 1  ON 25
ci_027                 8.039179e-03 3 1  ON 26
ci_028                 7.945309e-03 3 1  ON 27
ci_029                -8.012508e-03 3 1  ON 28
ci_030                -7.024518e-03 3 1  ON 29
ci_031                -7.520228e-03 3 1  ON 30
ci_032                -7.024914e-03 3 1  ON 31
ci_033                 7.104070e-03 3 1  ON 32
ci_034                 6.918234e-03 3 1  ON 33
ci_035                 6.101215e-03 3 1  ON 34
ci_036                 7.611907e-03 3 1  ON 35
ci_037                 5.879549e-03 3 1  ON 36
ci_038                 6.239789e-03 3 1  ON 37
ci_039                 5.358022e-03 3 1  ON 38
ci_040                 5.130404e-03 3 1  ON 39
ci_041                 5.642571e-03 3 1  ON 40
ci_042                 5.209180e-03 3 1  ON 41
ci_043                 4.828606e-03 3 1  ON 42
ci_044                 4.272918e-03 3 1  ON 43
ci_045                 4.854799e-03 3 1  ON 44
ci_046                 5.456892e-03 3 1  ON 45
ci_047                -4.661918e-03 3 1  ON 46
ci_048                -3.588804e-03 3 1  ON 47
ci_049                 3.820395e-03 3 1  ON 48
ci_050                 3.849320e-03 3 1  ON 49
ci_051                -2.281145e-03 3 1  ON 50
ci_052                -3.093887e-03 3 1  ON 51
ci_053                -2.690132e-03 3 1  ON 52
ci_054                -2.642401e-03 3 1  ON 53
ci_055                -2.816000e-03 3 1  ON 54
ci_056                -2.377206e-03 3 1  ON 55
ci_057                -1.160036e-03 3 1  ON 56
ci_058                -2.353633e-03 3 1  ON 57
ci_059                -1.774232e-03 3 1  ON 58
ci_060                -1.917122e-03 3 1  ON 59
ci_061                -1.235385e-03 3 1  ON 60
ci_062                -1.610510e-03 3 1  ON 61
ci_063                -1.326828e-03 3 1  ON 62
ci_064                -1.459934e-03 3 1  ON 63
ci_065                -1.995576e-03 3 1  ON 64
ci_066                -1.514310e-03 3 1  ON 65
ci_067                -2.141775e-03 3 1  ON 66
ci_068                -1.438320e-03 3 1  ON 67
ci_069                 1.596553e-03 3 1  ON 68
ci_070                 7.822166e-04 3 1  ON 69
ci_071                -1.501074e-03 3 1  ON 70
ci_072                -1.198536e-03 3 1  ON 71
ci_073                 6.091565e-04 3 1  ON 72
ci_074                 4.772891e-04 3 1  ON 73
ci_075                -1.171507e-03 3 1  ON 74
ci_076                -1.543136e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.5669
    reference variance = 2.58985
====================================================
  Execution time = 2.3168e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7660e+00
  Total weights = 1.9501e+06
  Execution time = 4.3938e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.819269792148
                                         uncertainty =       0.047295908489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.819269792148
                                         uncertainty =       0.047295908489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381756078
  error estimate for blocks of size 2^( 2) =       0.001452420766
  error estimate for blocks of size 2^( 3) =       0.001515775428
  error estimate for blocks of size 2^( 4) =       0.001560522106
  error estimate for blocks of size 2^( 5) =       0.001583932431
  error estimate for blocks of size 2^( 6) =       0.001597815215
  error estimate for blocks of size 2^( 7) =       0.001608505717

      target function =                  N/A
              le_mean =     -22.325581989403
             les_mean =     502.201294884821
             stat err =       0.001587693867
             autocorr =       1.320294357528
              std dev =       1.954129450807
             le_variance =       3.818621910510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820931198274
                                         uncertainty =       0.047216828865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820931198274
                                         uncertainty =       0.047216828865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382054834
  error estimate for blocks of size 2^( 2) =       0.001452712193
  error estimate for blocks of size 2^( 3) =       0.001516074341
  error estimate for blocks of size 2^( 4) =       0.001560784398
  error estimate for blocks of size 2^( 5) =       0.001584234485
  error estimate for blocks of size 2^( 6) =       0.001598068625
  error estimate for blocks of size 2^( 7) =       0.001608718770

      target function =                  N/A
              le_mean =     -22.325540754482
             les_mean =     502.210213953325
             stat err =       0.001587951570
             autocorr =       1.320152058765
              std dev =       1.954551961850
             le_variance =       3.820273371572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.822152961310
                                         uncertainty =       0.047185175683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.822152961310
                                         uncertainty =       0.047185175683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382275010
  error estimate for blocks of size 2^( 2) =       0.001452932606
  error estimate for blocks of size 2^( 3) =       0.001516296696
  error estimate for blocks of size 2^( 4) =       0.001561001203
  error estimate for blocks of size 2^( 5) =       0.001584526913
  error estimate for blocks of size 2^( 6) =       0.001598308646
  error estimate for blocks of size 2^( 7) =       0.001608946261

      target function =                  N/A
              le_mean =     -22.325558398863
             les_mean =     502.331711606718
             stat err =       0.001588195756
             autocorr =       1.320137442231
              std dev =       1.954863343718
             le_variance =       3.821490692611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.819775290894
                                         uncertainty =       0.047272176106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.819775290894
                                         uncertainty =       0.047272176106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381847322
  error estimate for blocks of size 2^( 2) =       0.001452507142
  error estimate for blocks of size 2^( 3) =       0.001515860842
  error estimate for blocks of size 2^( 4) =       0.001560602960
  error estimate for blocks of size 2^( 5) =       0.001584051340
  error estimate for blocks of size 2^( 6) =       0.001597926716
  error estimate for blocks of size 2^( 7) =       0.001608473905

      target function =                  N/A
              le_mean =     -22.325582508149
             les_mean =     502.692107720803
             stat err =       0.001587763730
             autocorr =       1.320236185161
              std dev =       1.954258490754
             le_variance =       3.819126248684


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325581989403        initial
     6.2500e-02     6.2500e-01             1.4552e-03       -22.325540754482
     2.5000e-01     2.5000e+00             7.9822e-04       -22.325558398863
     1.0000e+00     1.0000e+01             3.2401e-04       -22.325582508149  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.5209e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_001                -6.983568e-01 3 1  ON 0
ci_002                -7.022138e-01 3 1  ON 1
ci_003                -6.097001e-02 3 1  ON 2
ci_004                -6.201052e-02 3 1  ON 3
ci_005                 4.515956e-02 3 1  ON 4
ci_006                 4.541619e-02 3 1  ON 5
ci_007                 3.085799e-02 3 1  ON 6
ci_008                 3.239442e-02 3 1  ON 7
ci_009                -2.568410e-02 3 1  ON 8
ci_010                -2.440543e-02 3 1  ON 9
ci_011                -2.221764e-02 3 1  ON 10
ci_012                -2.289617e-02 3 1  ON 11
ci_013                 1.945883e-02 3 1  ON 12
ci_014                 1.995873e-02 3 1  ON 13
ci_015                 2.002402e-02 3 1  ON 14
ci_016                 2.077352e-02 3 1  ON 15
ci_017                 1.487922e-02 3 1  ON 16
ci_018                 1.604868e-02 3 1  ON 17
ci_019                 9.286124e-03 3 1  ON 18
ci_020                 9.748579e-03 3 1  ON 19
ci_021                -9.290801e-03 3 1  ON 20
ci_022                -9.972311e-03 3 1  ON 21
ci_023                 8.847485e-03 3 1  ON 22
ci_024                 9.520334e-03 3 1  ON 23
ci_025                 7.349972e-03 3 1  ON 24
ci_026                 8.533921e-03 3 1  ON 25
ci_027                 7.795625e-03 3 1  ON 26
ci_028                 7.948837e-03 3 1  ON 27
ci_029                -7.937561e-03 3 1  ON 28
ci_030                -7.079343e-03 3 1  ON 29
ci_031                -7.655292e-03 3 1  ON 30
ci_032                -6.890325e-03 3 1  ON 31
ci_033                 7.339761e-03 3 1  ON 32
ci_034                 7.169164e-03 3 1  ON 33
ci_035                 6.501238e-03 3 1  ON 34
ci_036                 7.187256e-03 3 1  ON 35
ci_037                 5.816822e-03 3 1  ON 36
ci_038                 6.225350e-03 3 1  ON 37
ci_039                 5.564601e-03 3 1  ON 38
ci_040                 5.339296e-03 3 1  ON 39
ci_041                 5.560943e-03 3 1  ON 40
ci_042                 5.035525e-03 3 1  ON 41
ci_043                 4.906260e-03 3 1  ON 42
ci_044                 4.340447e-03 3 1  ON 43
ci_045                 4.758223e-03 3 1  ON 44
ci_046                 5.456950e-03 3 1  ON 45
ci_047                -4.786944e-03 3 1  ON 46
ci_048                -3.959922e-03 3 1  ON 47
ci_049                 3.612167e-03 3 1  ON 48
ci_050                 3.640792e-03 3 1  ON 49
ci_051                -2.416170e-03 3 1  ON 50
ci_052                -2.903618e-03 3 1  ON 51
ci_053                -2.832632e-03 3 1  ON 52
ci_054                -2.619024e-03 3 1  ON 53
ci_055                -2.753118e-03 3 1  ON 54
ci_056                -2.819288e-03 3 1  ON 55
ci_057                -1.504853e-03 3 1  ON 56
ci_058                -2.398589e-03 3 1  ON 57
ci_059                -1.863404e-03 3 1  ON 58
ci_060                -1.691651e-03 3 1  ON 59
ci_061                -1.530826e-03 3 1  ON 60
ci_062                -1.759470e-03 3 1  ON 61
ci_063                -1.188473e-03 3 1  ON 62
ci_064                -1.266880e-03 3 1  ON 63
ci_065                -1.809688e-03 3 1  ON 64
ci_066                -1.583276e-03 3 1  ON 65
ci_067                -2.043706e-03 3 1  ON 66
ci_068                -1.259636e-03 3 1  ON 67
ci_069                 1.618966e-03 3 1  ON 68
ci_070                 7.397017e-04 3 1  ON 69
ci_071                -1.732263e-03 3 1  ON 70
ci_072                -8.748580e-04 3 1  ON 71
ci_073                 7.764924e-04 3 1  ON 72
ci_074                 8.465143e-04 3 1  ON 73
ci_075                -1.261830e-03 3 1  ON 74
ci_076                -1.428482e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4955e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2331e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.1991
    reference variance = 4.48613
====================================================
  Execution time = 2.3783e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0325e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.8065e+00
  Total weights = 1.949555748e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8802e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.861473028956
                                         uncertainty =       0.083774777650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.861473028956
                                         uncertainty =       0.083774777650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389415457
  error estimate for blocks of size 2^( 2) =       0.001459876525
  error estimate for blocks of size 2^( 3) =       0.001521904862
  error estimate for blocks of size 2^( 4) =       0.001565313843
  error estimate for blocks of size 2^( 5) =       0.001589874318
  error estimate for blocks of size 2^( 6) =       0.001602225044
  error estimate for blocks of size 2^( 7) =       0.001612747072

      target function =                  N/A
              le_mean =     -22.326698065505
             les_mean =     502.287956112486
             stat err =       0.001592540069
             autocorr =       1.313761359713
              std dev =       1.964961621826
             le_variance =       3.861074175249


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232669806551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326698064666       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326748391664       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326750258641       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326750325894       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.222004e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326698064666       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326717332051       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326717569163       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 4.428933e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326698064666       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326703619415       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326703656973       residual = 1.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 1.251822e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.014056 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9674e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_001                -6.983254e-01 3 1  ON 0
ci_002                -7.021949e-01 3 1  ON 1
ci_003                -6.092477e-02 3 1  ON 2
ci_004                -6.217829e-02 3 1  ON 3
ci_005                 4.499555e-02 3 1  ON 4
ci_006                 4.551183e-02 3 1  ON 5
ci_007                 3.130088e-02 3 1  ON 6
ci_008                 3.265241e-02 3 1  ON 7
ci_009                -2.574452e-02 3 1  ON 8
ci_010                -2.463038e-02 3 1  ON 9
ci_011                -2.209095e-02 3 1  ON 10
ci_012                -2.275567e-02 3 1  ON 11
ci_013                 1.970613e-02 3 1  ON 12
ci_014                 1.990925e-02 3 1  ON 13
ci_015                 2.008848e-02 3 1  ON 14
ci_016                 2.063153e-02 3 1  ON 15
ci_017                 1.470590e-02 3 1  ON 16
ci_018                 1.629859e-02 3 1  ON 17
ci_019                 9.436584e-03 3 1  ON 18
ci_020                 9.714852e-03 3 1  ON 19
ci_021                -9.342156e-03 3 1  ON 20
ci_022                -9.854794e-03 3 1  ON 21
ci_023                 9.002238e-03 3 1  ON 22
ci_024                 9.400144e-03 3 1  ON 23
ci_025                 7.527548e-03 3 1  ON 24
ci_026                 8.644925e-03 3 1  ON 25
ci_027                 8.090464e-03 3 1  ON 26
ci_028                 7.819220e-03 3 1  ON 27
ci_029                -7.806733e-03 3 1  ON 28
ci_030                -6.998619e-03 3 1  ON 29
ci_031                -7.599575e-03 3 1  ON 30
ci_032                -7.166592e-03 3 1  ON 31
ci_033                 7.399791e-03 3 1  ON 32
ci_034                 7.077977e-03 3 1  ON 33
ci_035                 6.465426e-03 3 1  ON 34
ci_036                 6.871813e-03 3 1  ON 35
ci_037                 5.764462e-03 3 1  ON 36
ci_038                 6.525120e-03 3 1  ON 37
ci_039                 5.430612e-03 3 1  ON 38
ci_040                 5.666116e-03 3 1  ON 39
ci_041                 5.634196e-03 3 1  ON 40
ci_042                 5.245588e-03 3 1  ON 41
ci_043                 4.736098e-03 3 1  ON 42
ci_044                 4.523895e-03 3 1  ON 43
ci_045                 4.903235e-03 3 1  ON 44
ci_046                 5.333304e-03 3 1  ON 45
ci_047                -4.662832e-03 3 1  ON 46
ci_048                -4.035957e-03 3 1  ON 47
ci_049                 3.340476e-03 3 1  ON 48
ci_050                 3.550603e-03 3 1  ON 49
ci_051                -2.376408e-03 3 1  ON 50
ci_052                -3.038898e-03 3 1  ON 51
ci_053                -2.753903e-03 3 1  ON 52
ci_054                -2.865008e-03 3 1  ON 53
ci_055                -2.800766e-03 3 1  ON 54
ci_056                -2.956556e-03 3 1  ON 55
ci_057                -1.615541e-03 3 1  ON 56
ci_058                -2.159732e-03 3 1  ON 57
ci_059                -1.782745e-03 3 1  ON 58
ci_060                -1.889147e-03 3 1  ON 59
ci_061                -1.473211e-03 3 1  ON 60
ci_062                -1.846225e-03 3 1  ON 61
ci_063                -1.263119e-03 3 1  ON 62
ci_064                -1.161978e-03 3 1  ON 63
ci_065                -1.694935e-03 3 1  ON 64
ci_066                -1.602727e-03 3 1  ON 65
ci_067                -1.993506e-03 3 1  ON 66
ci_068                -1.243399e-03 3 1  ON 67
ci_069                 1.470926e-03 3 1  ON 68
ci_070                 7.772153e-04 3 1  ON 69
ci_071                -1.386960e-03 3 1  ON 70
ci_072                -1.121204e-03 3 1  ON 71
ci_073                 1.144683e-03 3 1  ON 72
ci_074                 9.509708e-04 3 1  ON 73
ci_075                -1.136052e-03 3 1  ON 74
ci_076                -1.354850e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.3861
    reference variance = 2.63316
====================================================
  Execution time = 2.3332e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.6744e+00
  Total weights = 1.9502e+06
  Execution time = 4.3345e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.725067257491
                                         uncertainty =       0.027474923643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.725067257491
                                         uncertainty =       0.027474923643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364695624
  error estimate for blocks of size 2^( 2) =       0.001435858248
  error estimate for blocks of size 2^( 3) =       0.001498834183
  error estimate for blocks of size 2^( 4) =       0.001543724659
  error estimate for blocks of size 2^( 5) =       0.001572268716
  error estimate for blocks of size 2^( 6) =       0.001583928052
  error estimate for blocks of size 2^( 7) =       0.001595592678

      target function =                  N/A
              le_mean =     -22.330823934427
             les_mean =     502.552917608118
             stat err =       0.001573878526
             autocorr =       1.330058741529
              std dev =       1.930001939561
             le_variance =       3.724907486711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.725207044707
                                         uncertainty =       0.027485913860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.725207044707
                                         uncertainty =       0.027485913860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364721376
  error estimate for blocks of size 2^( 2) =       0.001435873335
  error estimate for blocks of size 2^( 3) =       0.001498840820
  error estimate for blocks of size 2^( 4) =       0.001543712633
  error estimate for blocks of size 2^( 5) =       0.001572243571
  error estimate for blocks of size 2^( 6) =       0.001583887649
  error estimate for blocks of size 2^( 7) =       0.001595589966

      target function =                  N/A
              le_mean =     -22.330839227672
             les_mean =     502.356502235181
             stat err =       0.001573858455
             autocorr =       1.329974623239
              std dev =       1.930038359314
             le_variance =       3.725048068425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.725084701659
                                         uncertainty =       0.027483016363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.725084701659
                                         uncertainty =       0.027483016363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364698994
  error estimate for blocks of size 2^( 2) =       0.001435852279
  error estimate for blocks of size 2^( 3) =       0.001498816823
  error estimate for blocks of size 2^( 4) =       0.001543690321
  error estimate for blocks of size 2^( 5) =       0.001572213174
  error estimate for blocks of size 2^( 6) =       0.001583860915
  error estimate for blocks of size 2^( 7) =       0.001595562177

      target function =                  N/A
              le_mean =     -22.330836826948
             les_mean =     502.342603666920
             stat err =       0.001573831647
             autocorr =       1.329972940366
              std dev =       1.930006705718
             le_variance =       3.724925884118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.725018184667
                                         uncertainty =       0.027477984517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.725018184667
                                         uncertainty =       0.027477984517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364686636
  error estimate for blocks of size 2^( 2) =       0.001435848847
  error estimate for blocks of size 2^( 3) =       0.001498821994
  error estimate for blocks of size 2^( 4) =       0.001543704642
  error estimate for blocks of size 2^( 5) =       0.001572236832
  error estimate for blocks of size 2^( 6) =       0.001583890532
  error estimate for blocks of size 2^( 7) =       0.001595562991

      target function =                  N/A
              le_mean =     -22.330829014791
             les_mean =     502.341273274241
             stat err =       0.001573848749
             autocorr =       1.330025933420
              std dev =       1.929989227997
             le_variance =       3.724858420185


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330823934427        initial
     2.5000e-01     2.5000e+00             1.2220e-03       -22.330839227672  <--
     1.0000e+00     1.0000e+01             4.4289e-04       -22.330836826948
     4.0000e+00     4.0000e+01             1.2518e-04       -22.330829014791

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.5597e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_001                -6.982574e-01 3 1  ON 0
ci_002                -7.021769e-01 3 1  ON 1
ci_003                -6.078398e-02 3 1  ON 2
ci_004                -6.255920e-02 3 1  ON 3
ci_005                 4.472644e-02 3 1  ON 4
ci_006                 4.564298e-02 3 1  ON 5
ci_007                 3.207999e-02 3 1  ON 6
ci_008                 3.312226e-02 3 1  ON 7
ci_009                -2.579659e-02 3 1  ON 8
ci_010                -2.499728e-02 3 1  ON 9
ci_011                -2.181880e-02 3 1  ON 10
ci_012                -2.246735e-02 3 1  ON 11
ci_013                 2.015954e-02 3 1  ON 12
ci_014                 1.985816e-02 3 1  ON 13
ci_015                 2.019630e-02 3 1  ON 14
ci_016                 2.035070e-02 3 1  ON 15
ci_017                 1.437000e-02 3 1  ON 16
ci_018                 1.676632e-02 3 1  ON 17
ci_019                 9.728307e-03 3 1  ON 18
ci_020                 9.627036e-03 3 1  ON 19
ci_021                -9.454768e-03 3 1  ON 20
ci_022                -9.579919e-03 3 1  ON 21
ci_023                 9.269125e-03 3 1  ON 22
ci_024                 9.195309e-03 3 1  ON 23
ci_025                 7.863751e-03 3 1  ON 24
ci_026                 8.877078e-03 3 1  ON 25
ci_027                 8.492432e-03 3 1  ON 26
ci_028                 7.628404e-03 3 1  ON 27
ci_029                -7.588017e-03 3 1  ON 28
ci_030                -6.855357e-03 3 1  ON 29
ci_031                -7.522326e-03 3 1  ON 30
ci_032                -7.705397e-03 3 1  ON 31
ci_033                 7.489383e-03 3 1  ON 32
ci_034                 6.915771e-03 3 1  ON 33
ci_035                 6.422356e-03 3 1  ON 34
ci_036                 6.444716e-03 3 1  ON 35
ci_037                 5.705649e-03 3 1  ON 36
ci_038                 7.043615e-03 3 1  ON 37
ci_039                 5.245604e-03 3 1  ON 38
ci_040                 6.103132e-03 3 1  ON 39
ci_041                 5.744959e-03 3 1  ON 40
ci_042                 5.555013e-03 3 1  ON 41
ci_043                 4.454492e-03 3 1  ON 42
ci_044                 4.818171e-03 3 1  ON 43
ci_045                 5.135255e-03 3 1  ON 44
ci_046                 5.133921e-03 3 1  ON 45
ci_047                -4.514893e-03 3 1  ON 46
ci_048                -4.178918e-03 3 1  ON 47
ci_049                 2.835731e-03 3 1  ON 48
ci_050                 3.396717e-03 3 1  ON 49
ci_051                -2.406031e-03 3 1  ON 50
ci_052                -3.295451e-03 3 1  ON 51
ci_053                -2.626125e-03 3 1  ON 52
ci_054                -3.328366e-03 3 1  ON 53
ci_055                -2.890823e-03 3 1  ON 54
ci_056                -3.224233e-03 3 1  ON 55
ci_057                -1.805596e-03 3 1  ON 56
ci_058                -1.756337e-03 3 1  ON 57
ci_059                -1.700700e-03 3 1  ON 58
ci_060                -2.173928e-03 3 1  ON 59
ci_061                -1.381911e-03 3 1  ON 60
ci_062                -1.988959e-03 3 1  ON 61
ci_063                -1.373287e-03 3 1  ON 62
ci_064                -9.758380e-04 3 1  ON 63
ci_065                -1.505611e-03 3 1  ON 64
ci_066                -1.673216e-03 3 1  ON 65
ci_067                -1.888478e-03 3 1  ON 66
ci_068                -1.188970e-03 3 1  ON 67
ci_069                 1.195395e-03 3 1  ON 68
ci_070                 8.646429e-04 3 1  ON 69
ci_071                -7.938857e-04 3 1  ON 70
ci_072                -1.547813e-03 3 1  ON 71
ci_073                 1.624808e-03 3 1  ON 72
ci_074                 1.128869e-03 3 1  ON 73
ci_075                -9.048121e-04 3 1  ON 74
ci_076                -1.260393e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5286e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2318e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.4028
    reference variance = 3.7362
====================================================
  Execution time = 2.6649e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0310e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7614e+00
  Total weights = 1.949470119e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8716e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.809090845916
                                         uncertainty =       0.041973389902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.809090845916
                                         uncertainty =       0.041973389902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379883863
  error estimate for blocks of size 2^( 2) =       0.001450580453
  error estimate for blocks of size 2^( 3) =       0.001512791140
  error estimate for blocks of size 2^( 4) =       0.001552576122
  error estimate for blocks of size 2^( 5) =       0.001577621595
  error estimate for blocks of size 2^( 6) =       0.001586959603
  error estimate for blocks of size 2^( 7) =       0.001604143744

      target function =                  N/A
              le_mean =     -22.328376421123
             les_mean =     502.317796671854
             stat err =       0.001580325266
             autocorr =       1.311619592902
              std dev =       1.951481696561
             le_variance =       3.808280812012


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232837642112e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328376420276       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328435110468       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328448458421       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328452652649       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328455615895       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328455247485       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.328455456645       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 4.349332e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328376420276       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328411257688       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328414499682       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328414442165       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328414605824       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.073841e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328376420276       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328389688191       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328390172487       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328390130949       residual = 9.25e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.535847e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.016617 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2528e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_001                -6.993313e-01 3 1  ON 0
ci_002                -7.011955e-01 3 1  ON 1
ci_003                -6.120841e-02 3 1  ON 2
ci_004                -6.231670e-02 3 1  ON 3
ci_005                 4.462648e-02 3 1  ON 4
ci_006                 4.539756e-02 3 1  ON 5
ci_007                 3.173533e-02 3 1  ON 6
ci_008                 3.263130e-02 3 1  ON 7
ci_009                -2.566637e-02 3 1  ON 8
ci_010                -2.470389e-02 3 1  ON 9
ci_011                -2.128369e-02 3 1  ON 10
ci_012                -2.199529e-02 3 1  ON 11
ci_013                 2.071569e-02 3 1  ON 12
ci_014                 2.014872e-02 3 1  ON 13
ci_015                 2.035269e-02 3 1  ON 14
ci_016                 2.052472e-02 3 1  ON 15
ci_017                 1.433679e-02 3 1  ON 16
ci_018                 1.595598e-02 3 1  ON 17
ci_019                 1.044975e-02 3 1  ON 18
ci_020                 9.649223e-03 3 1  ON 19
ci_021                -9.590489e-03 3 1  ON 20
ci_022                -9.508118e-03 3 1  ON 21
ci_023                 9.350217e-03 3 1  ON 22
ci_024                 8.821318e-03 3 1  ON 23
ci_025                 8.140534e-03 3 1  ON 24
ci_026                 8.600288e-03 3 1  ON 25
ci_027                 7.720423e-03 3 1  ON 26
ci_028                 7.627535e-03 3 1  ON 27
ci_029                -7.672504e-03 3 1  ON 28
ci_030                -6.819986e-03 3 1  ON 29
ci_031                -7.675864e-03 3 1  ON 30
ci_032                -7.384010e-03 3 1  ON 31
ci_033                 7.848579e-03 3 1  ON 32
ci_034                 6.753424e-03 3 1  ON 33
ci_035                 6.490553e-03 3 1  ON 34
ci_036                 6.422028e-03 3 1  ON 35
ci_037                 6.017427e-03 3 1  ON 36
ci_038                 6.945964e-03 3 1  ON 37
ci_039                 5.661228e-03 3 1  ON 38
ci_040                 5.697784e-03 3 1  ON 39
ci_041                 5.318614e-03 3 1  ON 40
ci_042                 5.906812e-03 3 1  ON 41
ci_043                 5.080867e-03 3 1  ON 42
ci_044                 4.460858e-03 3 1  ON 43
ci_045                 5.637098e-03 3 1  ON 44
ci_046                 4.551694e-03 3 1  ON 45
ci_047                -4.840410e-03 3 1  ON 46
ci_048                -4.175423e-03 3 1  ON 47
ci_049                 2.827610e-03 3 1  ON 48
ci_050                 3.346296e-03 3 1  ON 49
ci_051                -2.298213e-03 3 1  ON 50
ci_052                -3.115432e-03 3 1  ON 51
ci_053                -3.199942e-03 3 1  ON 52
ci_054                -2.934983e-03 3 1  ON 53
ci_055                -3.075131e-03 3 1  ON 54
ci_056                -2.228595e-03 3 1  ON 55
ci_057                -1.696646e-03 3 1  ON 56
ci_058                -1.525975e-03 3 1  ON 57
ci_059                -1.756142e-03 3 1  ON 58
ci_060                -2.412380e-03 3 1  ON 59
ci_061                -1.551640e-03 3 1  ON 60
ci_062                -1.951209e-03 3 1  ON 61
ci_063                -1.198705e-03 3 1  ON 62
ci_064                -1.419825e-03 3 1  ON 63
ci_065                -1.542141e-03 3 1  ON 64
ci_066                -1.204454e-03 3 1  ON 65
ci_067                -1.496429e-03 3 1  ON 66
ci_068                -1.190613e-03 3 1  ON 67
ci_069                 1.266866e-03 3 1  ON 68
ci_070                 9.529825e-04 3 1  ON 69
ci_071                -2.989098e-04 3 1  ON 70
ci_072                -1.229714e-03 3 1  ON 71
ci_073                 8.287582e-04 3 1  ON 72
ci_074                 1.330187e-03 3 1  ON 73
ci_075                -8.656681e-04 3 1  ON 74
ci_076                -1.100574e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.3424
    reference variance = 3.9008
====================================================
  Execution time = 2.3181e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.9381e+00
  Total weights = 1.9495e+06
  Execution time = 4.3479e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.994260573513
                                         uncertainty =       0.172488724705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.994260573513
                                         uncertainty =       0.172488724705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001413322882
  error estimate for blocks of size 2^( 2) =       0.001482823168
  error estimate for blocks of size 2^( 3) =       0.001544347309
  error estimate for blocks of size 2^( 4) =       0.001588811809
  error estimate for blocks of size 2^( 5) =       0.001610254667
  error estimate for blocks of size 2^( 6) =       0.001627253888
  error estimate for blocks of size 2^( 7) =       0.001625774118

      target function =                  N/A
              le_mean =     -22.324677740705
             les_mean =     502.333829791540
             stat err =       0.001613023620
             autocorr =       1.302562808378
              std dev =       1.998772366627
             le_variance =       3.995090973591

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.258965
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.994418831203
                                         uncertainty =       0.172489768543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.994418831203
                                         uncertainty =       0.172489768543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001413350929
  error estimate for blocks of size 2^( 2) =       0.001482893180
  error estimate for blocks of size 2^( 3) =       0.001544444560
  error estimate for blocks of size 2^( 4) =       0.001588954633
  error estimate for blocks of size 2^( 5) =       0.001610428329
  error estimate for blocks of size 2^( 6) =       0.001627420485
  error estimate for blocks of size 2^( 7) =       0.001626024919

      target function =                  N/A
              le_mean =     -22.324672093068
             les_mean =     502.337488153749
             stat err =       0.001613207092
             autocorr =       1.302807432288
              std dev =       1.998812032694
             le_variance =       3.995249542042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.994400437502
                                         uncertainty =       0.172489474466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.994400437502
                                         uncertainty =       0.172489474466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001413347598
  error estimate for blocks of size 2^( 2) =       0.001482901616
  error estimate for blocks of size 2^( 3) =       0.001544460107
  error estimate for blocks of size 2^( 4) =       0.001588961222
  error estimate for blocks of size 2^( 5) =       0.001610459336
  error estimate for blocks of size 2^( 6) =       0.001627499543
  error estimate for blocks of size 2^( 7) =       0.001626127807

      target function =                  N/A
              le_mean =     -22.324697861839
             les_mean =     502.354276874748
             stat err =       0.001613261977
             autocorr =       1.302902225116
              std dev =       1.998807321380
             le_variance =       3.995230708002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.994203878988
                                         uncertainty =       0.172489205675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.994203878988
                                         uncertainty =       0.172489205675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001413312868
  error estimate for blocks of size 2^( 2) =       0.001482824889
  error estimate for blocks of size 2^( 3) =       0.001544361478
  error estimate for blocks of size 2^( 4) =       0.001588835327
  error estimate for blocks of size 2^( 5) =       0.001610292518
  error estimate for blocks of size 2^( 6) =       0.001627297210
  error estimate for blocks of size 2^( 7) =       0.001625865997

      target function =                  N/A
              le_mean =     -22.324665771633
             les_mean =     502.331214882934
             stat err =       0.001613072763
             autocorr =       1.302660636303
              std dev =       1.998758205184
             le_variance =       3.995034362789


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.324677740705        initial
     6.2500e-02     6.2500e-01             4.3493e-03       -22.324672093068
     2.5000e-01     2.5000e+00             1.0738e-03       -22.324697861839  <--
     1.0000e+00     1.0000e+01             3.5358e-04       -22.324665771633

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.5023e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_001                -6.993313e-01 3 1  ON 0
ci_002                -7.011955e-01 3 1  ON 1
ci_003                -6.120841e-02 3 1  ON 2
ci_004                -6.231670e-02 3 1  ON 3
ci_005                 4.462648e-02 3 1  ON 4
ci_006                 4.539756e-02 3 1  ON 5
ci_007                 3.173533e-02 3 1  ON 6
ci_008                 3.263130e-02 3 1  ON 7
ci_009                -2.566637e-02 3 1  ON 8
ci_010                -2.470389e-02 3 1  ON 9
ci_011                -2.128369e-02 3 1  ON 10
ci_012                -2.199529e-02 3 1  ON 11
ci_013                 2.071569e-02 3 1  ON 12
ci_014                 2.014872e-02 3 1  ON 13
ci_015                 2.035269e-02 3 1  ON 14
ci_016                 2.052472e-02 3 1  ON 15
ci_017                 1.433679e-02 3 1  ON 16
ci_018                 1.595598e-02 3 1  ON 17
ci_019                 1.044975e-02 3 1  ON 18
ci_020                 9.649223e-03 3 1  ON 19
ci_021                -9.590489e-03 3 1  ON 20
ci_022                -9.508118e-03 3 1  ON 21
ci_023                 9.350217e-03 3 1  ON 22
ci_024                 8.821318e-03 3 1  ON 23
ci_025                 8.140534e-03 3 1  ON 24
ci_026                 8.600288e-03 3 1  ON 25
ci_027                 7.720423e-03 3 1  ON 26
ci_028                 7.627535e-03 3 1  ON 27
ci_029                -7.672504e-03 3 1  ON 28
ci_030                -6.819986e-03 3 1  ON 29
ci_031                -7.675864e-03 3 1  ON 30
ci_032                -7.384010e-03 3 1  ON 31
ci_033                 7.848579e-03 3 1  ON 32
ci_034                 6.753424e-03 3 1  ON 33
ci_035                 6.490553e-03 3 1  ON 34
ci_036                 6.422028e-03 3 1  ON 35
ci_037                 6.017427e-03 3 1  ON 36
ci_038                 6.945964e-03 3 1  ON 37
ci_039                 5.661228e-03 3 1  ON 38
ci_040                 5.697784e-03 3 1  ON 39
ci_041                 5.318614e-03 3 1  ON 40
ci_042                 5.906812e-03 3 1  ON 41
ci_043                 5.080867e-03 3 1  ON 42
ci_044                 4.460858e-03 3 1  ON 43
ci_045                 5.637098e-03 3 1  ON 44
ci_046                 4.551694e-03 3 1  ON 45
ci_047                -4.840410e-03 3 1  ON 46
ci_048                -4.175423e-03 3 1  ON 47
ci_049                 2.827610e-03 3 1  ON 48
ci_050                 3.346296e-03 3 1  ON 49
ci_051                -2.298213e-03 3 1  ON 50
ci_052                -3.115432e-03 3 1  ON 51
ci_053                -3.199942e-03 3 1  ON 52
ci_054                -2.934983e-03 3 1  ON 53
ci_055                -3.075131e-03 3 1  ON 54
ci_056                -2.228595e-03 3 1  ON 55
ci_057                -1.696646e-03 3 1  ON 56
ci_058                -1.525975e-03 3 1  ON 57
ci_059                -1.756142e-03 3 1  ON 58
ci_060                -2.412380e-03 3 1  ON 59
ci_061                -1.551640e-03 3 1  ON 60
ci_062                -1.951209e-03 3 1  ON 61
ci_063                -1.198705e-03 3 1  ON 62
ci_064                -1.419825e-03 3 1  ON 63
ci_065                -1.542141e-03 3 1  ON 64
ci_066                -1.204454e-03 3 1  ON 65
ci_067                -1.496429e-03 3 1  ON 66
ci_068                -1.190613e-03 3 1  ON 67
ci_069                 1.266866e-03 3 1  ON 68
ci_070                 9.529825e-04 3 1  ON 69
ci_071                -2.989098e-04 3 1  ON 70
ci_072                -1.229714e-03 3 1  ON 71
ci_073                 8.287582e-04 3 1  ON 72
ci_074                 1.330187e-03 3 1  ON 73
ci_075                -8.656681e-04 3 1  ON 74
ci_076                -1.100574e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7558e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2332e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.2808
    reference variance = 2.86559
====================================================
  Execution time = 2.3780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0282e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6950e+00
  Total weights = 1.950075870e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8400e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.744884341802
                                         uncertainty =       0.024617372452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.744884341802
                                         uncertainty =       0.024617372452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368224374
  error estimate for blocks of size 2^( 2) =       0.001440858731
  error estimate for blocks of size 2^( 3) =       0.001503022656
  error estimate for blocks of size 2^( 4) =       0.001547173466
  error estimate for blocks of size 2^( 5) =       0.001575743416
  error estimate for blocks of size 2^( 6) =       0.001592688314
  error estimate for blocks of size 2^( 7) =       0.001605025096

      target function =                  N/A
              le_mean =     -22.328838749498
             les_mean =     502.272071452646
             stat err =       0.001580157573
             autocorr =       1.333785980090
              std dev =       1.934992425261
             le_variance =       3.744195685816


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232883874950e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328838748658       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328925301194       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328930481570       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328932588739       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328935477763       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328935344829       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.328935140493       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 2.385958e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328838748658       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328890059775       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328890956700       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328891103137       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328891261373       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.103548e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328838748658       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328858268286       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328858310077       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328858306532       residual = 1.71e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 4.009802e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018612 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9627e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_001                -6.986765e-01 3 1  ON 0
ci_002                -7.016561e-01 3 1  ON 1
ci_003                -6.172171e-02 3 1  ON 2
ci_004                -6.254277e-02 3 1  ON 3
ci_005                 4.533544e-02 3 1  ON 4
ci_006                 4.550515e-02 3 1  ON 5
ci_007                 3.178247e-02 3 1  ON 6
ci_008                 3.208403e-02 3 1  ON 7
ci_009                -2.511989e-02 3 1  ON 8
ci_010                -2.454762e-02 3 1  ON 9
ci_011                -2.238723e-02 3 1  ON 10
ci_012                -2.260060e-02 3 1  ON 11
ci_013                 2.065082e-02 3 1  ON 12
ci_014                 2.030211e-02 3 1  ON 13
ci_015                 2.100067e-02 3 1  ON 14
ci_016                 2.047118e-02 3 1  ON 15
ci_017                 1.481721e-02 3 1  ON 16
ci_018                 1.594742e-02 3 1  ON 17
ci_019                 1.103390e-02 3 1  ON 18
ci_020                 1.035246e-02 3 1  ON 19
ci_021                -9.387207e-03 3 1  ON 20
ci_022                -9.809228e-03 3 1  ON 21
ci_023                 9.267249e-03 3 1  ON 22
ci_024                 9.262099e-03 3 1  ON 23
ci_025                 8.350570e-03 3 1  ON 24
ci_026                 8.411518e-03 3 1  ON 25
ci_027                 7.624206e-03 3 1  ON 26
ci_028                 8.187663e-03 3 1  ON 27
ci_029                -7.753175e-03 3 1  ON 28
ci_030                -7.011693e-03 3 1  ON 29
ci_031                -7.701485e-03 3 1  ON 30
ci_032                -8.357879e-03 3 1  ON 31
ci_033                 7.909642e-03 3 1  ON 32
ci_034                 7.395435e-03 3 1  ON 33
ci_035                 6.203987e-03 3 1  ON 34
ci_036                 6.886114e-03 3 1  ON 35
ci_037                 6.070232e-03 3 1  ON 36
ci_038                 5.932753e-03 3 1  ON 37
ci_039                 5.906895e-03 3 1  ON 38
ci_040                 5.393165e-03 3 1  ON 39
ci_041                 5.859007e-03 3 1  ON 40
ci_042                 5.546448e-03 3 1  ON 41
ci_043                 4.700108e-03 3 1  ON 42
ci_044                 4.758676e-03 3 1  ON 43
ci_045                 5.166771e-03 3 1  ON 44
ci_046                 5.189436e-03 3 1  ON 45
ci_047                -4.442425e-03 3 1  ON 46
ci_048                -4.247021e-03 3 1  ON 47
ci_049                 2.877609e-03 3 1  ON 48
ci_050                 3.388280e-03 3 1  ON 49
ci_051                -2.646450e-03 3 1  ON 50
ci_052                -3.301831e-03 3 1  ON 51
ci_053                -3.049522e-03 3 1  ON 52
ci_054                -3.522726e-03 3 1  ON 53
ci_055                -2.587840e-03 3 1  ON 54
ci_056                -2.643166e-03 3 1  ON 55
ci_057                -2.155614e-03 3 1  ON 56
ci_058                -1.882319e-03 3 1  ON 57
ci_059                -1.407295e-03 3 1  ON 58
ci_060                -1.809339e-03 3 1  ON 59
ci_061                -1.860236e-03 3 1  ON 60
ci_062                -2.406029e-03 3 1  ON 61
ci_063                -8.054154e-04 3 1  ON 62
ci_064                -1.250642e-03 3 1  ON 63
ci_065                -1.630137e-03 3 1  ON 64
ci_066                -1.359023e-03 3 1  ON 65
ci_067                -1.002747e-03 3 1  ON 66
ci_068                -1.267627e-03 3 1  ON 67
ci_069                 1.134533e-03 3 1  ON 68
ci_070                 6.949373e-04 3 1  ON 69
ci_071                -5.635290e-04 3 1  ON 70
ci_072                -1.127466e-03 3 1  ON 71
ci_073                 1.222164e-03 3 1  ON 72
ci_074                 1.476851e-03 3 1  ON 73
ci_075                -8.848431e-04 3 1  ON 74
ci_076                -1.314554e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.3793
    reference variance = 3.11744
====================================================
  Execution time = 2.3131e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7434e+00
  Total weights = 1.9496e+06
  Execution time = 4.3415e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796560468476
                                         uncertainty =       0.064807240429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796560468476
                                         uncertainty =       0.064807240429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377607022
  error estimate for blocks of size 2^( 2) =       0.001448350936
  error estimate for blocks of size 2^( 3) =       0.001512187468
  error estimate for blocks of size 2^( 4) =       0.001557557077
  error estimate for blocks of size 2^( 5) =       0.001583814622
  error estimate for blocks of size 2^( 6) =       0.001598575204
  error estimate for blocks of size 2^( 7) =       0.001608369187

      target function =                  N/A
              le_mean =     -22.328563422774
             les_mean =     502.311793647903
             stat err =       0.001587079023
             autocorr =       1.327230664909
              std dev =       1.948261705401
             le_variance =       3.795723672734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797242507742
                                         uncertainty =       0.064806471567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797242507742
                                         uncertainty =       0.064806471567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377730248
  error estimate for blocks of size 2^( 2) =       0.001448443500
  error estimate for blocks of size 2^( 3) =       0.001512236907
  error estimate for blocks of size 2^( 4) =       0.001557611345
  error estimate for blocks of size 2^( 5) =       0.001583829075
  error estimate for blocks of size 2^( 6) =       0.001598660548
  error estimate for blocks of size 2^( 7) =       0.001608457060

      target function =                  N/A
              le_mean =     -22.328570872233
             les_mean =     502.331864781706
             stat err =       0.001587139507
             autocorr =       1.327094403810
              std dev =       1.948435975827
             le_variance =       3.796402751897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797366324257
                                         uncertainty =       0.064807095323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797366324257
                                         uncertainty =       0.064807095323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377752609
  error estimate for blocks of size 2^( 2) =       0.001448454282
  error estimate for blocks of size 2^( 3) =       0.001512233742
  error estimate for blocks of size 2^( 4) =       0.001557602427
  error estimate for blocks of size 2^( 5) =       0.001583808466
  error estimate for blocks of size 2^( 6) =       0.001598629057
  error estimate for blocks of size 2^( 7) =       0.001608429470

      target function =                  N/A
              le_mean =     -22.328582817953
             les_mean =     502.322690337964
             stat err =       0.001587117355
             autocorr =       1.327014283198
              std dev =       1.948467599449
             le_variance =       3.796525986103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796635486137
                                         uncertainty =       0.064806955475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796635486137
                                         uncertainty =       0.064806955475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377620520
  error estimate for blocks of size 2^( 2) =       0.001448357832
  error estimate for blocks of size 2^( 3) =       0.001512182398
  error estimate for blocks of size 2^( 4) =       0.001557553986
  error estimate for blocks of size 2^( 5) =       0.001583804428
  error estimate for blocks of size 2^( 6) =       0.001598577502
  error estimate for blocks of size 2^( 7) =       0.001608389781

      target function =                  N/A
              le_mean =     -22.328557803023
             les_mean =     502.310196113880
             stat err =       0.001587081424
             autocorr =       1.327208671656
              std dev =       1.948280795589
             le_variance =       3.795798058462


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328563422774        initial
     6.2500e-02     6.2500e-01             2.3860e-03       -22.328570872233
     2.5000e-01     2.5000e+00             1.1035e-03       -22.328582817953  <--
     1.0000e+00     1.0000e+01             4.0098e-04       -22.328557803023

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.5022e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_001                -6.986765e-01 3 1  ON 0
ci_002                -7.016561e-01 3 1  ON 1
ci_003                -6.172171e-02 3 1  ON 2
ci_004                -6.254277e-02 3 1  ON 3
ci_005                 4.533544e-02 3 1  ON 4
ci_006                 4.550515e-02 3 1  ON 5
ci_007                 3.178247e-02 3 1  ON 6
ci_008                 3.208403e-02 3 1  ON 7
ci_009                -2.511989e-02 3 1  ON 8
ci_010                -2.454762e-02 3 1  ON 9
ci_011                -2.238723e-02 3 1  ON 10
ci_012                -2.260060e-02 3 1  ON 11
ci_013                 2.065082e-02 3 1  ON 12
ci_014                 2.030211e-02 3 1  ON 13
ci_015                 2.100067e-02 3 1  ON 14
ci_016                 2.047118e-02 3 1  ON 15
ci_017                 1.481721e-02 3 1  ON 16
ci_018                 1.594742e-02 3 1  ON 17
ci_019                 1.103390e-02 3 1  ON 18
ci_020                 1.035246e-02 3 1  ON 19
ci_021                -9.387207e-03 3 1  ON 20
ci_022                -9.809228e-03 3 1  ON 21
ci_023                 9.267249e-03 3 1  ON 22
ci_024                 9.262099e-03 3 1  ON 23
ci_025                 8.350570e-03 3 1  ON 24
ci_026                 8.411518e-03 3 1  ON 25
ci_027                 7.624206e-03 3 1  ON 26
ci_028                 8.187663e-03 3 1  ON 27
ci_029                -7.753175e-03 3 1  ON 28
ci_030                -7.011693e-03 3 1  ON 29
ci_031                -7.701485e-03 3 1  ON 30
ci_032                -8.357879e-03 3 1  ON 31
ci_033                 7.909642e-03 3 1  ON 32
ci_034                 7.395435e-03 3 1  ON 33
ci_035                 6.203987e-03 3 1  ON 34
ci_036                 6.886114e-03 3 1  ON 35
ci_037                 6.070232e-03 3 1  ON 36
ci_038                 5.932753e-03 3 1  ON 37
ci_039                 5.906895e-03 3 1  ON 38
ci_040                 5.393165e-03 3 1  ON 39
ci_041                 5.859007e-03 3 1  ON 40
ci_042                 5.546448e-03 3 1  ON 41
ci_043                 4.700108e-03 3 1  ON 42
ci_044                 4.758676e-03 3 1  ON 43
ci_045                 5.166771e-03 3 1  ON 44
ci_046                 5.189436e-03 3 1  ON 45
ci_047                -4.442425e-03 3 1  ON 46
ci_048                -4.247021e-03 3 1  ON 47
ci_049                 2.877609e-03 3 1  ON 48
ci_050                 3.388280e-03 3 1  ON 49
ci_051                -2.646450e-03 3 1  ON 50
ci_052                -3.301831e-03 3 1  ON 51
ci_053                -3.049522e-03 3 1  ON 52
ci_054                -3.522726e-03 3 1  ON 53
ci_055                -2.587840e-03 3 1  ON 54
ci_056                -2.643166e-03 3 1  ON 55
ci_057                -2.155614e-03 3 1  ON 56
ci_058                -1.882319e-03 3 1  ON 57
ci_059                -1.407295e-03 3 1  ON 58
ci_060                -1.809339e-03 3 1  ON 59
ci_061                -1.860236e-03 3 1  ON 60
ci_062                -2.406029e-03 3 1  ON 61
ci_063                -8.054154e-04 3 1  ON 62
ci_064                -1.250642e-03 3 1  ON 63
ci_065                -1.630137e-03 3 1  ON 64
ci_066                -1.359023e-03 3 1  ON 65
ci_067                -1.002747e-03 3 1  ON 66
ci_068                -1.267627e-03 3 1  ON 67
ci_069                 1.134533e-03 3 1  ON 68
ci_070                 6.949373e-04 3 1  ON 69
ci_071                -5.635290e-04 3 1  ON 70
ci_072                -1.127466e-03 3 1  ON 71
ci_073                 1.222164e-03 3 1  ON 72
ci_074                 1.476851e-03 3 1  ON 73
ci_075                -8.848431e-04 3 1  ON 74
ci_076                -1.314554e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4656e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2332e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6757
    reference variance = 1.88453
====================================================
  Execution time = 2.3848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0296e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7281e+00
  Total weights = 1.949760638e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8929e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775465328262
                                         uncertainty =       0.028674314015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775465328262
                                         uncertainty =       0.028674314015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374019978
  error estimate for blocks of size 2^( 2) =       0.001445543338
  error estimate for blocks of size 2^( 3) =       0.001508613818
  error estimate for blocks of size 2^( 4) =       0.001549983548
  error estimate for blocks of size 2^( 5) =       0.001572255790
  error estimate for blocks of size 2^( 6) =       0.001583442729
  error estimate for blocks of size 2^( 7) =       0.001588537997

      target function =                  N/A
              le_mean =     -22.329029368449
             les_mean =     502.313672330697
             stat err =       0.001573555016
             autocorr =       1.311528610014
              std dev =       1.943188778100
             le_variance =       3.775982627332


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232902936845e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329029367622       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329116112495       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329129579783       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329129411358       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329130553231       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329130254950       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.329130187910       residual = 9.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 1.750139e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329029367622       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329080559530       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329084625355       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329084347110       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329084446456       residual = 2.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 9.691882e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329029367622       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329048762546       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329049537458       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329049487968       residual = 4.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.519342e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020626 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9748e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_001                -6.985385e-01 3 1  ON 0
ci_002                -7.018307e-01 3 1  ON 1
ci_003                -6.154262e-02 3 1  ON 2
ci_004                -6.299318e-02 3 1  ON 3
ci_005                 4.523288e-02 3 1  ON 4
ci_006                 4.607040e-02 3 1  ON 5
ci_007                 3.120348e-02 3 1  ON 6
ci_008                 3.212891e-02 3 1  ON 7
ci_009                -2.462688e-02 3 1  ON 8
ci_010                -2.487031e-02 3 1  ON 9
ci_011                -2.154250e-02 3 1  ON 10
ci_012                -2.191033e-02 3 1  ON 11
ci_013                 2.087418e-02 3 1  ON 12
ci_014                 2.063489e-02 3 1  ON 13
ci_015                 2.074441e-02 3 1  ON 14
ci_016                 2.043471e-02 3 1  ON 15
ci_017                 1.503942e-02 3 1  ON 16
ci_018                 1.611180e-02 3 1  ON 17
ci_019                 1.019471e-02 3 1  ON 18
ci_020                 1.013926e-02 3 1  ON 19
ci_021                -8.671834e-03 3 1  ON 20
ci_022                -1.026786e-02 3 1  ON 21
ci_023                 8.764782e-03 3 1  ON 22
ci_024                 9.282835e-03 3 1  ON 23
ci_025                 7.746317e-03 3 1  ON 24
ci_026                 8.765762e-03 3 1  ON 25
ci_027                 8.020804e-03 3 1  ON 26
ci_028                 8.021949e-03 3 1  ON 27
ci_029                -6.960238e-03 3 1  ON 28
ci_030                -7.738367e-03 3 1  ON 29
ci_031                -8.464349e-03 3 1  ON 30
ci_032                -8.797905e-03 3 1  ON 31
ci_033                 7.462650e-03 3 1  ON 32
ci_034                 7.939952e-03 3 1  ON 33
ci_035                 6.161092e-03 3 1  ON 34
ci_036                 7.309545e-03 3 1  ON 35
ci_037                 5.727287e-03 3 1  ON 36
ci_038                 5.937683e-03 3 1  ON 37
ci_039                 5.317657e-03 3 1  ON 38
ci_040                 5.204097e-03 3 1  ON 39
ci_041                 5.130759e-03 3 1  ON 40
ci_042                 5.565378e-03 3 1  ON 41
ci_043                 4.505649e-03 3 1  ON 42
ci_044                 5.018217e-03 3 1  ON 43
ci_045                 5.562927e-03 3 1  ON 44
ci_046                 5.455741e-03 3 1  ON 45
ci_047                -3.934781e-03 3 1  ON 46
ci_048                -4.632630e-03 3 1  ON 47
ci_049                 2.203460e-03 3 1  ON 48
ci_050                 3.629145e-03 3 1  ON 49
ci_051                -2.745378e-03 3 1  ON 50
ci_052                -3.294289e-03 3 1  ON 51
ci_053                -2.679512e-03 3 1  ON 52
ci_054                -3.251847e-03 3 1  ON 53
ci_055                -2.896058e-03 3 1  ON 54
ci_056                -2.098645e-03 3 1  ON 55
ci_057                -2.263005e-03 3 1  ON 56
ci_058                -1.955198e-03 3 1  ON 57
ci_059                -2.171607e-03 3 1  ON 58
ci_060                -1.886731e-03 3 1  ON 59
ci_061                -2.112917e-03 3 1  ON 60
ci_062                -2.189971e-03 3 1  ON 61
ci_063                -4.306086e-04 3 1  ON 62
ci_064                -2.814538e-04 3 1  ON 63
ci_065                -1.784819e-03 3 1  ON 64
ci_066                -1.169192e-03 3 1  ON 65
ci_067                -5.348303e-04 3 1  ON 66
ci_068                -9.339033e-04 3 1  ON 67
ci_069                 1.554016e-03 3 1  ON 68
ci_070                 6.706770e-04 3 1  ON 69
ci_071                -5.287532e-04 3 1  ON 70
ci_072                -1.011133e-03 3 1  ON 71
ci_073                 1.312701e-03 3 1  ON 72
ci_074                 6.967055e-04 3 1  ON 73
ci_075                -1.167136e-03 3 1  ON 74
ci_076                -1.310315e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.1956
    reference variance = 3.0179
====================================================
  Execution time = 2.3122e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7523e+00
  Total weights = 1.9499e+06
  Execution time = 4.3459e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.805980297338
                                         uncertainty =       0.051555385541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.805980297338
                                         uncertainty =       0.051555385541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379476359
  error estimate for blocks of size 2^( 2) =       0.001450375179
  error estimate for blocks of size 2^( 3) =       0.001513086112
  error estimate for blocks of size 2^( 4) =       0.001557661007
  error estimate for blocks of size 2^( 5) =       0.001583367489
  error estimate for blocks of size 2^( 6) =       0.001603588217
  error estimate for blocks of size 2^( 7) =       0.001614120285

      target function =                  N/A
              le_mean =     -22.326480532179
             les_mean =     502.253913552015
             stat err =       0.001589684250
             autocorr =       1.327985150535
              std dev =       1.950905389206
             le_variance =       3.806031837631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.806182380449
                                         uncertainty =       0.051550018590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.806182380449
                                         uncertainty =       0.051550018590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379513118
  error estimate for blocks of size 2^( 2) =       0.001450419555
  error estimate for blocks of size 2^( 3) =       0.001513136075
  error estimate for blocks of size 2^( 4) =       0.001557685050
  error estimate for blocks of size 2^( 5) =       0.001583390712
  error estimate for blocks of size 2^( 6) =       0.001603544770
  error estimate for blocks of size 2^( 7) =       0.001614097600

      target function =                  N/A
              le_mean =     -22.326469474473
             les_mean =     502.227058229827
             stat err =       0.001589679533
             autocorr =       1.327906498762
              std dev =       1.950957375709
             le_variance =       3.806234681834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.806252318214
                                         uncertainty =       0.051548885934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.806252318214
                                         uncertainty =       0.051548885934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379525822
  error estimate for blocks of size 2^( 2) =       0.001450434068
  error estimate for blocks of size 2^( 3) =       0.001513154347
  error estimate for blocks of size 2^( 4) =       0.001557699678
  error estimate for blocks of size 2^( 5) =       0.001583410600
  error estimate for blocks of size 2^( 6) =       0.001603542466
  error estimate for blocks of size 2^( 7) =       0.001614097282

      target function =                  N/A
              le_mean =     -22.326473878036
             les_mean =     502.227744568972
             stat err =       0.001589687507
             autocorr =       1.327895362658
              std dev =       1.950975341831
             le_variance =       3.806304784434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.805928163178
                                         uncertainty =       0.051552549961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.805928163178
                                         uncertainty =       0.051552549961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379466925
  error estimate for blocks of size 2^( 2) =       0.001450368750
  error estimate for blocks of size 2^( 3) =       0.001513091098
  error estimate for blocks of size 2^( 4) =       0.001557654629
  error estimate for blocks of size 2^( 5) =       0.001583375289
  error estimate for blocks of size 2^( 6) =       0.001603566814
  error estimate for blocks of size 2^( 7) =       0.001614086463

      target function =                  N/A
              le_mean =     -22.326467980446
             les_mean =     502.228962235494
             stat err =       0.001589670799
             autocorr =       1.327980839719
              std dev =       1.950892048313
             le_variance =       3.805979784171


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326480532179        initial  <--
     6.2500e-02     6.2500e-01             1.7501e-03       -22.326469474473
     2.5000e-01     2.5000e+00             9.6919e-04       -22.326473878036
     1.0000e+00     1.0000e+01             3.5193e-04       -22.326467980446

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9811
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_001                -6.986765e-01 3 1  ON 0
ci_002                -7.016561e-01 3 1  ON 1
ci_003                -6.172171e-02 3 1  ON 2
ci_004                -6.254277e-02 3 1  ON 3
ci_005                 4.533544e-02 3 1  ON 4
ci_006                 4.550515e-02 3 1  ON 5
ci_007                 3.178247e-02 3 1  ON 6
ci_008                 3.208403e-02 3 1  ON 7
ci_009                -2.511989e-02 3 1  ON 8
ci_010                -2.454762e-02 3 1  ON 9
ci_011                -2.238723e-02 3 1  ON 10
ci_012                -2.260060e-02 3 1  ON 11
ci_013                 2.065082e-02 3 1  ON 12
ci_014                 2.030211e-02 3 1  ON 13
ci_015                 2.100067e-02 3 1  ON 14
ci_016                 2.047118e-02 3 1  ON 15
ci_017                 1.481721e-02 3 1  ON 16
ci_018                 1.594742e-02 3 1  ON 17
ci_019                 1.103390e-02 3 1  ON 18
ci_020                 1.035246e-02 3 1  ON 19
ci_021                -9.387207e-03 3 1  ON 20
ci_022                -9.809228e-03 3 1  ON 21
ci_023                 9.267249e-03 3 1  ON 22
ci_024                 9.262099e-03 3 1  ON 23
ci_025                 8.350570e-03 3 1  ON 24
ci_026                 8.411518e-03 3 1  ON 25
ci_027                 7.624206e-03 3 1  ON 26
ci_028                 8.187663e-03 3 1  ON 27
ci_029                -7.753175e-03 3 1  ON 28
ci_030                -7.011693e-03 3 1  ON 29
ci_031                -7.701485e-03 3 1  ON 30
ci_032                -8.357879e-03 3 1  ON 31
ci_033                 7.909642e-03 3 1  ON 32
ci_034                 7.395435e-03 3 1  ON 33
ci_035                 6.203987e-03 3 1  ON 34
ci_036                 6.886114e-03 3 1  ON 35
ci_037                 6.070232e-03 3 1  ON 36
ci_038                 5.932753e-03 3 1  ON 37
ci_039                 5.906895e-03 3 1  ON 38
ci_040                 5.393165e-03 3 1  ON 39
ci_041                 5.859007e-03 3 1  ON 40
ci_042                 5.546448e-03 3 1  ON 41
ci_043                 4.700108e-03 3 1  ON 42
ci_044                 4.758676e-03 3 1  ON 43
ci_045                 5.166771e-03 3 1  ON 44
ci_046                 5.189436e-03 3 1  ON 45
ci_047                -4.442425e-03 3 1  ON 46
ci_048                -4.247021e-03 3 1  ON 47
ci_049                 2.877609e-03 3 1  ON 48
ci_050                 3.388280e-03 3 1  ON 49
ci_051                -2.646450e-03 3 1  ON 50
ci_052                -3.301831e-03 3 1  ON 51
ci_053                -3.049522e-03 3 1  ON 52
ci_054                -3.522726e-03 3 1  ON 53
ci_055                -2.587840e-03 3 1  ON 54
ci_056                -2.643166e-03 3 1  ON 55
ci_057                -2.155614e-03 3 1  ON 56
ci_058                -1.882319e-03 3 1  ON 57
ci_059                -1.407295e-03 3 1  ON 58
ci_060                -1.809339e-03 3 1  ON 59
ci_061                -1.860236e-03 3 1  ON 60
ci_062                -2.406029e-03 3 1  ON 61
ci_063                -8.054154e-04 3 1  ON 62
ci_064                -1.250642e-03 3 1  ON 63
ci_065                -1.630137e-03 3 1  ON 64
ci_066                -1.359023e-03 3 1  ON 65
ci_067                -1.002747e-03 3 1  ON 66
ci_068                -1.267627e-03 3 1  ON 67
ci_069                 1.134533e-03 3 1  ON 68
ci_070                 6.949373e-04 3 1  ON 69
ci_071                -5.635290e-04 3 1  ON 70
ci_072                -1.127466e-03 3 1  ON 71
ci_073                 1.222164e-03 3 1  ON 72
ci_074                 1.476851e-03 3 1  ON 73
ci_075                -8.848431e-04 3 1  ON 74
ci_076                -1.314554e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4736e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2349e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.1658
    reference variance = 3.00548
====================================================
  Execution time = 2.3658e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0294e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7374e+00
  Total weights = 1.950012690e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8393e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789391410156
                                         uncertainty =       0.032144663110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789391410156
                                         uncertainty =       0.032144663110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376376801
  error estimate for blocks of size 2^( 2) =       0.001447519326
  error estimate for blocks of size 2^( 3) =       0.001509933067
  error estimate for blocks of size 2^( 4) =       0.001555703379
  error estimate for blocks of size 2^( 5) =       0.001578014607
  error estimate for blocks of size 2^( 6) =       0.001595717204
  error estimate for blocks of size 2^( 7) =       0.001607706400

      target function =                  N/A
              le_mean =     -22.326299225067
             les_mean =     502.201064817085
             stat err =       0.001584285397
             autocorr =       1.324927611932
              std dev =       1.946521881859
             le_variance =       3.788947436554


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232629922507e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326299224257       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326320672091       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326321629852       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326321578825       residual = 1.13e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 4.513594e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326299224257       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326305708063       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326305829932       residual = 3.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.457442e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326299224257       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326300934673       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326300955025       residual = 2.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 3.964298e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.021959 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9504e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_001                -6.986585e-01 3 1  ON 0
ci_002                -7.016568e-01 3 1  ON 1
ci_003                -6.182774e-02 3 1  ON 2
ci_004                -6.260227e-02 3 1  ON 3
ci_005                 4.540510e-02 3 1  ON 4
ci_006                 4.549504e-02 3 1  ON 5
ci_007                 3.181856e-02 3 1  ON 6
ci_008                 3.200630e-02 3 1  ON 7
ci_009                -2.516926e-02 3 1  ON 8
ci_010                -2.466166e-02 3 1  ON 9
ci_011                -2.245110e-02 3 1  ON 10
ci_012                -2.266499e-02 3 1  ON 11
ci_013                 2.058379e-02 3 1  ON 12
ci_014                 2.025475e-02 3 1  ON 13
ci_015                 2.093519e-02 3 1  ON 14
ci_016                 2.045092e-02 3 1  ON 15
ci_017                 1.481153e-02 3 1  ON 16
ci_018                 1.599685e-02 3 1  ON 17
ci_019                 1.096330e-02 3 1  ON 18
ci_020                 1.022850e-02 3 1  ON 19
ci_021                -9.351821e-03 3 1  ON 20
ci_022                -9.899773e-03 3 1  ON 21
ci_023                 9.230727e-03 3 1  ON 22
ci_024                 9.268687e-03 3 1  ON 23
ci_025                 8.370140e-03 3 1  ON 24
ci_026                 8.411409e-03 3 1  ON 25
ci_027                 7.565785e-03 3 1  ON 26
ci_028                 8.184744e-03 3 1  ON 27
ci_029                -7.807119e-03 3 1  ON 28
ci_030                -7.073426e-03 3 1  ON 29
ci_031                -7.690269e-03 3 1  ON 30
ci_032                -8.407823e-03 3 1  ON 31
ci_033                 7.835811e-03 3 1  ON 32
ci_034                 7.302573e-03 3 1  ON 33
ci_035                 6.238341e-03 3 1  ON 34
ci_036                 6.740370e-03 3 1  ON 35
ci_037                 6.132955e-03 3 1  ON 36
ci_038                 5.966838e-03 3 1  ON 37
ci_039                 5.952246e-03 3 1  ON 38
ci_040                 5.427673e-03 3 1  ON 39
ci_041                 5.845906e-03 3 1  ON 40
ci_042                 5.545284e-03 3 1  ON 41
ci_043                 4.657411e-03 3 1  ON 42
ci_044                 4.818713e-03 3 1  ON 43
ci_045                 5.127163e-03 3 1  ON 44
ci_046                 5.174351e-03 3 1  ON 45
ci_047                -4.407276e-03 3 1  ON 46
ci_048                -4.151528e-03 3 1  ON 47
ci_049                 2.893297e-03 3 1  ON 48
ci_050                 3.440604e-03 3 1  ON 49
ci_051                -2.590207e-03 3 1  ON 50
ci_052                -3.282966e-03 3 1  ON 51
ci_053                -3.005738e-03 3 1  ON 52
ci_054                -3.394335e-03 3 1  ON 53
ci_055                -2.579515e-03 3 1  ON 54
ci_056                -2.576830e-03 3 1  ON 55
ci_057                -2.118813e-03 3 1  ON 56
ci_058                -1.912523e-03 3 1  ON 57
ci_059                -1.540651e-03 3 1  ON 58
ci_060                -1.857539e-03 3 1  ON 59
ci_061                -1.807494e-03 3 1  ON 60
ci_062                -2.402351e-03 3 1  ON 61
ci_063                -9.365462e-04 3 1  ON 62
ci_064                -1.120264e-03 3 1  ON 63
ci_065                -1.606515e-03 3 1  ON 64
ci_066                -1.458363e-03 3 1  ON 65
ci_067                -1.066862e-03 3 1  ON 66
ci_068                -1.312817e-03 3 1  ON 67
ci_069                 1.146684e-03 3 1  ON 68
ci_070                 7.740069e-04 3 1  ON 69
ci_071                -6.134088e-04 3 1  ON 70
ci_072                -1.212532e-03 3 1  ON 71
ci_073                 1.199855e-03 3 1  ON 72
ci_074                 1.449104e-03 3 1  ON 73
ci_075                -9.820531e-04 3 1  ON 74
ci_076                -1.368874e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.0846
    reference variance = 10.5985
====================================================
  Execution time = 2.3178e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7103e+00
  Total weights = 1.9503e+06
  Execution time = 4.3478e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762114549062
                                         uncertainty =       0.032556986216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762114549062
                                         uncertainty =       0.032556986216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371533608
  error estimate for blocks of size 2^( 2) =       0.001442968324
  error estimate for blocks of size 2^( 3) =       0.001507085712
  error estimate for blocks of size 2^( 4) =       0.001553323082
  error estimate for blocks of size 2^( 5) =       0.001583459199
  error estimate for blocks of size 2^( 6) =       0.001591022826
  error estimate for blocks of size 2^( 7) =       0.001600568023

      target function =                  N/A
              le_mean =     -22.326092177849
             les_mean =     502.167551806248
             stat err =       0.001582093283
             autocorr =       1.330611477004
              std dev =       1.939672463759
             le_variance =       3.762329266665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762178074129
                                         uncertainty =       0.032556193791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762178074129
                                         uncertainty =       0.032556193791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371545116
  error estimate for blocks of size 2^( 2) =       0.001442974999
  error estimate for blocks of size 2^( 3) =       0.001507086130
  error estimate for blocks of size 2^( 4) =       0.001553313022
  error estimate for blocks of size 2^( 5) =       0.001583442698
  error estimate for blocks of size 2^( 6) =       0.001590999014
  error estimate for blocks of size 2^( 7) =       0.001600528893

      target function =                  N/A
              le_mean =     -22.326095399713
             les_mean =     502.185764031137
             stat err =       0.001582070907
             autocorr =       1.330551509987
              std dev =       1.939688739327
             le_variance =       3.762392405472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762143572512
                                         uncertainty =       0.032556391507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762143572512
                                         uncertainty =       0.032556391507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371538849
  error estimate for blocks of size 2^( 2) =       0.001442969476
  error estimate for blocks of size 2^( 3) =       0.001507083235
  error estimate for blocks of size 2^( 4) =       0.001553314867
  error estimate for blocks of size 2^( 5) =       0.001583448444
  error estimate for blocks of size 2^( 6) =       0.001591007842
  error estimate for blocks of size 2^( 7) =       0.001600544116

      target function =                  N/A
              le_mean =     -22.326094677571
             les_mean =     502.165368615293
             stat err =       0.001582078817
             autocorr =       1.330576976708
              std dev =       1.939679875555
             le_variance =       3.762358019631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762117063026
                                         uncertainty =       0.032556887666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762117063026
                                         uncertainty =       0.032556887666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371534060
  error estimate for blocks of size 2^( 2) =       0.001442968110
  error estimate for blocks of size 2^( 3) =       0.001507084705
  error estimate for blocks of size 2^( 4) =       0.001553319866
  error estimate for blocks of size 2^( 5) =       0.001583456372
  error estimate for blocks of size 2^( 6) =       0.001591019986
  error estimate for blocks of size 2^( 7) =       0.001600564344

      target function =                  N/A
              le_mean =     -22.326092626016
             les_mean =     502.167320062442
             stat err =       0.001582090142
             autocorr =       1.330605317817
              std dev =       1.939673102675
             le_variance =       3.762331745241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326092177849        initial
     6.2500e-01     6.2500e+00             4.5136e-04       -22.326095399713  <--
     2.5000e+00     2.5000e+01             1.4574e-04       -22.326094677571
     1.0000e+01     1.0000e+02             3.9643e-05       -22.326092626016

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.5049e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_001                -6.986121e-01 3 1  ON 0
ci_002                -7.016594e-01 3 1  ON 1
ci_003                -6.211842e-02 3 1  ON 2
ci_004                -6.275698e-02 3 1  ON 3
ci_005                 4.554880e-02 3 1  ON 4
ci_006                 4.546540e-02 3 1  ON 5
ci_007                 3.189483e-02 3 1  ON 6
ci_008                 3.181215e-02 3 1  ON 7
ci_009                -2.527982e-02 3 1  ON 8
ci_010                -2.493529e-02 3 1  ON 9
ci_011                -2.261130e-02 3 1  ON 10
ci_012                -2.283441e-02 3 1  ON 11
ci_013                 2.041157e-02 3 1  ON 12
ci_014                 2.014627e-02 3 1  ON 13
ci_015                 2.076384e-02 3 1  ON 14
ci_016                 2.040138e-02 3 1  ON 15
ci_017                 1.479646e-02 3 1  ON 16
ci_018                 1.612057e-02 3 1  ON 17
ci_019                 1.078539e-02 3 1  ON 18
ci_020                 9.927041e-03 3 1  ON 19
ci_021                -9.257662e-03 3 1  ON 20
ci_022                -1.011090e-02 3 1  ON 21
ci_023                 9.148041e-03 3 1  ON 22
ci_024                 9.281322e-03 3 1  ON 23
ci_025                 8.423267e-03 3 1  ON 24
ci_026                 8.415758e-03 3 1  ON 25
ci_027                 7.443400e-03 3 1  ON 26
ci_028                 8.176039e-03 3 1  ON 27
ci_029                -7.944369e-03 3 1  ON 28
ci_030                -7.221307e-03 3 1  ON 29
ci_031                -7.664498e-03 3 1  ON 30
ci_032                -8.523424e-03 3 1  ON 31
ci_033                 7.660972e-03 3 1  ON 32
ci_034                 7.080362e-03 3 1  ON 33
ci_035                 6.316100e-03 3 1  ON 34
ci_036                 6.444708e-03 3 1  ON 35
ci_037                 6.275927e-03 3 1  ON 36
ci_038                 6.046263e-03 3 1  ON 37
ci_039                 6.048036e-03 3 1  ON 38
ci_040                 5.498788e-03 3 1  ON 39
ci_041                 5.818332e-03 3 1  ON 40
ci_042                 5.543603e-03 3 1  ON 41
ci_043                 4.566291e-03 3 1  ON 42
ci_044                 4.961858e-03 3 1  ON 43
ci_045                 5.036404e-03 3 1  ON 44
ci_046                 5.144921e-03 3 1  ON 45
ci_047                -4.343861e-03 3 1  ON 46
ci_048                -3.966855e-03 3 1  ON 47
ci_049                 2.930353e-03 3 1  ON 48
ci_050                 3.568440e-03 3 1  ON 49
ci_051                -2.451221e-03 3 1  ON 50
ci_052                -3.222157e-03 3 1  ON 51
ci_053                -2.898505e-03 3 1  ON 52
ci_054                -3.086666e-03 3 1  ON 53
ci_055                -2.552636e-03 3 1  ON 54
ci_056                -2.412500e-03 3 1  ON 55
ci_057                -2.035430e-03 3 1  ON 56
ci_058                -1.980191e-03 3 1  ON 57
ci_059                -1.817341e-03 3 1  ON 58
ci_060                -1.956366e-03 3 1  ON 59
ci_061                -1.689739e-03 3 1  ON 60
ci_062                -2.397752e-03 3 1  ON 61
ci_063                -1.256775e-03 3 1  ON 62
ci_064                -8.155550e-04 3 1  ON 63
ci_065                -1.547346e-03 3 1  ON 64
ci_066                -1.688557e-03 3 1  ON 65
ci_067                -1.220085e-03 3 1  ON 66
ci_068                -1.425543e-03 3 1  ON 67
ci_069                 1.176172e-03 3 1  ON 68
ci_070                 9.627567e-04 3 1  ON 69
ci_071                -7.335105e-04 3 1  ON 70
ci_072                -1.405771e-03 3 1  ON 71
ci_073                 1.154358e-03 3 1  ON 72
ci_074                 1.394505e-03 3 1  ON 73
ci_075                -1.203744e-03 3 1  ON 74
ci_076                -1.495133e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4560e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2317e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.4331
    reference variance = 3.74639
====================================================
  Execution time = 2.5971e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0349e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6704e+00
  Total weights = 1.950005284e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8923e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719542956747
                                         uncertainty =       0.024858967788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719542956747
                                         uncertainty =       0.024858967788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363824954
  error estimate for blocks of size 2^( 2) =       0.001436203977
  error estimate for blocks of size 2^( 3) =       0.001501194412
  error estimate for blocks of size 2^( 4) =       0.001544293380
  error estimate for blocks of size 2^( 5) =       0.001567555933
  error estimate for blocks of size 2^( 6) =       0.001581169572
  error estimate for blocks of size 2^( 7) =       0.001592293301

      target function =                  N/A
              le_mean =     -22.328794926865
             les_mean =     502.245522339168
             stat err =       0.001571328047
             autocorr =       1.327444766201
              std dev =       1.928770606393
             le_variance =       3.720156052084


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232879492686e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328794926072       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328847140259       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328849394110       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328849392490       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328849336214       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 1.470453e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328794926072       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328816964925       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328817201543       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328817196407       residual = 4.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 5.664476e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328794926072       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328801580978       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328801607353       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.640897e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.023482 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1869e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_001                -6.987385e-01 3 1  ON 0
ci_002                -7.015064e-01 3 1  ON 1
ci_003                -6.251489e-02 3 1  ON 2
ci_004                -6.276330e-02 3 1  ON 3
ci_005                 4.524668e-02 3 1  ON 4
ci_006                 4.575072e-02 3 1  ON 5
ci_007                 3.156068e-02 3 1  ON 6
ci_008                 3.184005e-02 3 1  ON 7
ci_009                -2.522054e-02 3 1  ON 8
ci_010                -2.504016e-02 3 1  ON 9
ci_011                -2.251238e-02 3 1  ON 10
ci_012                -2.270913e-02 3 1  ON 11
ci_013                 2.047501e-02 3 1  ON 12
ci_014                 2.035663e-02 3 1  ON 13
ci_015                 2.055317e-02 3 1  ON 14
ci_016                 2.056506e-02 3 1  ON 15
ci_017                 1.536291e-02 3 1  ON 16
ci_018                 1.606691e-02 3 1  ON 17
ci_019                 1.030445e-02 3 1  ON 18
ci_020                 1.000391e-02 3 1  ON 19
ci_021                -9.719291e-03 3 1  ON 20
ci_022                -1.009226e-02 3 1  ON 21
ci_023                 9.285565e-03 3 1  ON 22
ci_024                 9.457863e-03 3 1  ON 23
ci_025                 8.139037e-03 3 1  ON 24
ci_026                 8.259286e-03 3 1  ON 25
ci_027                 7.637139e-03 3 1  ON 26
ci_028                 8.321929e-03 3 1  ON 27
ci_029                -8.046078e-03 3 1  ON 28
ci_030                -7.467359e-03 3 1  ON 29
ci_031                -7.370460e-03 3 1  ON 30
ci_032                -8.685610e-03 3 1  ON 31
ci_033                 7.251284e-03 3 1  ON 32
ci_034                 7.197590e-03 3 1  ON 33
ci_035                 6.189805e-03 3 1  ON 34
ci_036                 6.062125e-03 3 1  ON 35
ci_037                 6.413279e-03 3 1  ON 36
ci_038                 5.791841e-03 3 1  ON 37
ci_039                 5.930471e-03 3 1  ON 38
ci_040                 5.464623e-03 3 1  ON 39
ci_041                 5.719869e-03 3 1  ON 40
ci_042                 5.445362e-03 3 1  ON 41
ci_043                 4.702754e-03 3 1  ON 42
ci_044                 4.943596e-03 3 1  ON 43
ci_045                 5.066450e-03 3 1  ON 44
ci_046                 5.541914e-03 3 1  ON 45
ci_047                -4.548276e-03 3 1  ON 46
ci_048                -3.913699e-03 3 1  ON 47
ci_049                 2.893403e-03 3 1  ON 48
ci_050                 3.750021e-03 3 1  ON 49
ci_051                -2.451202e-03 3 1  ON 50
ci_052                -2.858721e-03 3 1  ON 51
ci_053                -2.774077e-03 3 1  ON 52
ci_054                -3.043633e-03 3 1  ON 53
ci_055                -2.462391e-03 3 1  ON 54
ci_056                -2.161209e-03 3 1  ON 55
ci_057                -1.867288e-03 3 1  ON 56
ci_058                -1.967556e-03 3 1  ON 57
ci_059                -1.755454e-03 3 1  ON 58
ci_060                -1.827450e-03 3 1  ON 59
ci_061                -1.812662e-03 3 1  ON 60
ci_062                -2.387295e-03 3 1  ON 61
ci_063                -1.452753e-03 3 1  ON 62
ci_064                -1.025368e-03 3 1  ON 63
ci_065                -1.366335e-03 3 1  ON 64
ci_066                -1.699927e-03 3 1  ON 65
ci_067                -1.301062e-03 3 1  ON 66
ci_068                -1.414363e-03 3 1  ON 67
ci_069                 1.624569e-03 3 1  ON 68
ci_070                 1.243784e-03 3 1  ON 69
ci_071                -8.031664e-04 3 1  ON 70
ci_072                -1.295793e-03 3 1  ON 71
ci_073                 1.014219e-03 3 1  ON 72
ci_074                 1.622080e-03 3 1  ON 73
ci_075                -9.591285e-04 3 1  ON 74
ci_076                -1.442171e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.1926
    reference variance = 3.84704
====================================================
  Execution time = 2.3149e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.7380e+00
  Total weights = 1.9498e+06
  Execution time = 4.3468e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788802172613
                                         uncertainty =       0.046196351556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788802172613
                                         uncertainty =       0.046196351556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376587815
  error estimate for blocks of size 2^( 2) =       0.001446750942
  error estimate for blocks of size 2^( 3) =       0.001511072815
  error estimate for blocks of size 2^( 4) =       0.001556414067
  error estimate for blocks of size 2^( 5) =       0.001582708525
  error estimate for blocks of size 2^( 6) =       0.001595866882
  error estimate for blocks of size 2^( 7) =       0.001599310252

      target function =                  N/A
              le_mean =     -22.331124431748
             les_mean =     502.469554338955
             stat err =       0.001583574931
             autocorr =       1.323333765819
              std dev =       1.946820306196
             le_variance =       3.790109304617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788738551038
                                         uncertainty =       0.046188575175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788738551038
                                         uncertainty =       0.046188575175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376576305
  error estimate for blocks of size 2^( 2) =       0.001446746616
  error estimate for blocks of size 2^( 3) =       0.001511071883
  error estimate for blocks of size 2^( 4) =       0.001556408454
  error estimate for blocks of size 2^( 5) =       0.001582689772
  error estimate for blocks of size 2^( 6) =       0.001595851372
  error estimate for blocks of size 2^( 7) =       0.001599296471

      target function =                  N/A
              le_mean =     -22.331136164603
             les_mean =     502.433789578307
             stat err =       0.001583561517
             autocorr =       1.323333476648
              std dev =       1.946804028128
             le_variance =       3.790045923937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788730089207
                                         uncertainty =       0.046186231708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788730089207
                                         uncertainty =       0.046186231708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376574768
  error estimate for blocks of size 2^( 2) =       0.001446743583
  error estimate for blocks of size 2^( 3) =       0.001511071859
  error estimate for blocks of size 2^( 4) =       0.001556412178
  error estimate for blocks of size 2^( 5) =       0.001582690934
  error estimate for blocks of size 2^( 6) =       0.001595854150
  error estimate for blocks of size 2^( 7) =       0.001599286429

      target function =                  N/A
              le_mean =     -22.331130614859
             les_mean =     502.438483221789
             stat err =       0.001583560923
             autocorr =       1.323335438007
              std dev =       1.946801854314
             le_variance =       3.790037459961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788704018185
                                         uncertainty =       0.046183264486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788704018185
                                         uncertainty =       0.046183264486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376569971
  error estimate for blocks of size 2^( 2) =       0.001446737923
  error estimate for blocks of size 2^( 3) =       0.001511064590
  error estimate for blocks of size 2^( 4) =       0.001556408088
  error estimate for blocks of size 2^( 5) =       0.001582703339
  error estimate for blocks of size 2^( 6) =       0.001595879308
  error estimate for blocks of size 2^( 7) =       0.001599323894

      target function =                  N/A
              le_mean =     -22.331128744028
             les_mean =     502.419076516273
             stat err =       0.001583578657
             autocorr =       1.323374301996
              std dev =       1.946795070269
             le_variance =       3.790011045624


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.331124431748        initial
     1.5625e-01     1.5625e+00             1.4705e-03       -22.331136164603  <--
     6.2500e-01     6.2500e+00             5.6645e-04       -22.331130614859
     2.5000e+00     2.5000e+01             1.6409e-04       -22.331128744028

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 4.5003e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_001                -6.990599e-01 3 1  ON 0
ci_002                -7.011274e-01 3 1  ON 1
ci_003                -6.342685e-02 3 1  ON 2
ci_004                -6.271935e-02 3 1  ON 3
ci_005                 4.489931e-02 3 1  ON 4
ci_006                 4.605931e-02 3 1  ON 5
ci_007                 3.109092e-02 3 1  ON 6
ci_008                 3.181862e-02 3 1  ON 7
ci_009                -2.516591e-02 3 1  ON 8
ci_010                -2.519216e-02 3 1  ON 9
ci_011                -2.238462e-02 3 1  ON 10
ci_012                -2.247963e-02 3 1  ON 11
ci_013                 2.054832e-02 3 1  ON 12
ci_014                 2.061778e-02 3 1  ON 13
ci_015                 2.019266e-02 3 1  ON 14
ci_016                 2.076471e-02 3 1  ON 15
ci_017                 1.626691e-02 3 1  ON 16
ci_018                 1.601717e-02 3 1  ON 17
ci_019                 9.549888e-03 3 1  ON 18
ci_020                 1.015270e-02 3 1  ON 19
ci_021                -1.049374e-02 3 1  ON 20
ci_022                -1.004307e-02 3 1  ON 21
ci_023                 9.455666e-03 3 1  ON 22
ci_024                 9.674999e-03 3 1  ON 23
ci_025                 7.728315e-03 3 1  ON 24
ci_026                 7.969296e-03 3 1  ON 25
ci_027                 7.839156e-03 3 1  ON 26
ci_028                 8.464611e-03 3 1  ON 27
ci_029                -8.238993e-03 3 1  ON 28
ci_030                -7.842509e-03 3 1  ON 29
ci_031                -6.815298e-03 3 1  ON 30
ci_032                -8.928169e-03 3 1  ON 31
ci_033                 6.623797e-03 3 1  ON 32
ci_034                 7.334818e-03 3 1  ON 33
ci_035                 6.073387e-03 3 1  ON 34
ci_036                 5.666310e-03 3 1  ON 35
ci_037                 6.596398e-03 3 1  ON 36
ci_038                 5.451278e-03 3 1  ON 37
ci_039                 5.806709e-03 3 1  ON 38
ci_040                 5.423261e-03 3 1  ON 39
ci_041                 5.616740e-03 3 1  ON 40
ci_042                 5.332157e-03 3 1  ON 41
ci_043                 4.877422e-03 3 1  ON 42
ci_044                 4.921584e-03 3 1  ON 43
ci_045                 5.150390e-03 3 1  ON 44
ci_046                 6.096938e-03 3 1  ON 45
ci_047                -4.776369e-03 3 1  ON 46
ci_048                -3.871307e-03 3 1  ON 47
ci_049                 2.853003e-03 3 1  ON 48
ci_050                 4.018792e-03 3 1  ON 49
ci_051                -2.404549e-03 3 1  ON 50
ci_052                -2.350638e-03 3 1  ON 51
ci_053                -2.629647e-03 3 1  ON 52
ci_054                -2.992505e-03 3 1  ON 53
ci_055                -2.317101e-03 3 1  ON 54
ci_056                -1.740670e-03 3 1  ON 55
ci_057                -1.655228e-03 3 1  ON 56
ci_058                -1.945612e-03 3 1  ON 57
ci_059                -1.651285e-03 3 1  ON 58
ci_060                -1.708361e-03 3 1  ON 59
ci_061                -2.044263e-03 3 1  ON 60
ci_062                -2.392783e-03 3 1  ON 61
ci_063                -1.735043e-03 3 1  ON 62
ci_064                -1.319582e-03 3 1  ON 63
ci_065                -1.102619e-03 3 1  ON 64
ci_066                -1.727206e-03 3 1  ON 65
ci_067                -1.444162e-03 3 1  ON 66
ci_068                -1.425762e-03 3 1  ON 67
ci_069                 2.247623e-03 3 1  ON 68
ci_070                 1.637445e-03 3 1  ON 69
ci_071                -8.854852e-04 3 1  ON 70
ci_072                -1.213680e-03 3 1  ON 71
ci_073                 8.818967e-04 3 1  ON 72
ci_074                 1.858280e-03 3 1  ON 73
ci_075                -6.429053e-04 3 1  ON 74
ci_076                -1.369026e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6879e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2316e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.6134
    reference variance = 2.48736
====================================================
  Execution time = 2.3734e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0346e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7211e+00
  Total weights = 1.949790428e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8797e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773103200528
                                         uncertainty =       0.037139430822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773103200528
                                         uncertainty =       0.037139430822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373383834
  error estimate for blocks of size 2^( 2) =       0.001444960397
  error estimate for blocks of size 2^( 3) =       0.001507805027
  error estimate for blocks of size 2^( 4) =       0.001551380279
  error estimate for blocks of size 2^( 5) =       0.001574455217
  error estimate for blocks of size 2^( 6) =       0.001588176641
  error estimate for blocks of size 2^( 7) =       0.001598272013

      target function =                  N/A
              le_mean =     -22.326140736076
             les_mean =     502.177661820752
             stat err =       0.001578071037
             autocorr =       1.320289703880
              std dev =       1.942289119961
             le_variance =       3.772487025517


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232614073608e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326140735244       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326202687201       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326201144734       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326201699756       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326201805330       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.326201977482       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-02 is 2.261234e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326140735244       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326181313002       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326180461370       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326180608122       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326180622017       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 1.412327e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326140735244       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326157784246       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326157753564       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326157759353       residual = 2.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 5.645770e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9621e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_001                -6.989816e-01 3 1  ON 0
ci_002                -7.012839e-01 3 1  ON 1
ci_003                -6.390778e-02 3 1  ON 2
ci_004                -6.175260e-02 3 1  ON 3
ci_005                 4.519051e-02 3 1  ON 4
ci_006                 4.578550e-02 3 1  ON 5
ci_007                 3.086720e-02 3 1  ON 6
ci_008                 3.243193e-02 3 1  ON 7
ci_009                -2.438990e-02 3 1  ON 8
ci_010                -2.555524e-02 3 1  ON 9
ci_011                -2.287910e-02 3 1  ON 10
ci_012                -2.267652e-02 3 1  ON 11
ci_013                 2.074289e-02 3 1  ON 12
ci_014                 2.000483e-02 3 1  ON 13
ci_015                 2.087746e-02 3 1  ON 14
ci_016                 2.024491e-02 3 1  ON 15
ci_017                 1.485458e-02 3 1  ON 16
ci_018                 1.618764e-02 3 1  ON 17
ci_019                 1.005850e-02 3 1  ON 18
ci_020                 1.005239e-02 3 1  ON 19
ci_021                -1.106763e-02 3 1  ON 20
ci_022                -9.358447e-03 3 1  ON 21
ci_023                 8.704499e-03 3 1  ON 22
ci_024                 8.691487e-03 3 1  ON 23
ci_025                 8.457966e-03 3 1  ON 24
ci_026                 8.125844e-03 3 1  ON 25
ci_027                 8.054076e-03 3 1  ON 26
ci_028                 8.165467e-03 3 1  ON 27
ci_029                -9.192448e-03 3 1  ON 28
ci_030                -8.269331e-03 3 1  ON 29
ci_031                -6.867532e-03 3 1  ON 30
ci_032                -7.617819e-03 3 1  ON 31
ci_033                 6.881910e-03 3 1  ON 32
ci_034                 6.786323e-03 3 1  ON 33
ci_035                 6.652782e-03 3 1  ON 34
ci_036                 6.067866e-03 3 1  ON 35
ci_037                 6.707388e-03 3 1  ON 36
ci_038                 5.221655e-03 3 1  ON 37
ci_039                 6.205459e-03 3 1  ON 38
ci_040                 5.675789e-03 3 1  ON 39
ci_041                 5.394075e-03 3 1  ON 40
ci_042                 4.933125e-03 3 1  ON 41
ci_043                 5.126894e-03 3 1  ON 42
ci_044                 4.116095e-03 3 1  ON 43
ci_045                 5.992187e-03 3 1  ON 44
ci_046                 5.375068e-03 3 1  ON 45
ci_047                -4.399574e-03 3 1  ON 46
ci_048                -4.303716e-03 3 1  ON 47
ci_049                 2.104887e-03 3 1  ON 48
ci_050                 3.119167e-03 3 1  ON 49
ci_051                -2.364622e-03 3 1  ON 50
ci_052                -2.084404e-03 3 1  ON 51
ci_053                -2.935313e-03 3 1  ON 52
ci_054                -2.146450e-03 3 1  ON 53
ci_055                -2.166632e-03 3 1  ON 54
ci_056                -2.172540e-03 3 1  ON 55
ci_057                -1.814384e-03 3 1  ON 56
ci_058                -1.872642e-03 3 1  ON 57
ci_059                -2.197602e-03 3 1  ON 58
ci_060                -1.600044e-03 3 1  ON 59
ci_061                -2.026355e-03 3 1  ON 60
ci_062                -2.332938e-03 3 1  ON 61
ci_063                -1.489360e-03 3 1  ON 62
ci_064                -1.758798e-03 3 1  ON 63
ci_065                -1.922889e-05 3 1  ON 64
ci_066                -1.466931e-03 3 1  ON 65
ci_067                -1.310398e-03 3 1  ON 66
ci_068                -1.200990e-03 3 1  ON 67
ci_069                 2.139370e-03 3 1  ON 68
ci_070                 1.273311e-03 3 1  ON 69
ci_071                -7.398466e-04 3 1  ON 70
ci_072                -1.018658e-03 3 1  ON 71
ci_073                 1.260688e-03 3 1  ON 72
ci_074                 1.673552e-03 3 1  ON 73
ci_075                -1.253524e-03 3 1  ON 74
ci_076                -1.531044e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.1499
    reference variance = 3.21876
====================================================
  Execution time = 2.3186e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7300e+00
  Total weights = 1.9494e+06
  Execution time = 4.3598e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780947363610
                                         uncertainty =       0.033259476142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780947363610
                                         uncertainty =       0.033259476142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374989666
  error estimate for blocks of size 2^( 2) =       0.001446362792
  error estimate for blocks of size 2^( 3) =       0.001511131603
  error estimate for blocks of size 2^( 4) =       0.001555532096
  error estimate for blocks of size 2^( 5) =       0.001582475818
  error estimate for blocks of size 2^( 6) =       0.001592138642
  error estimate for blocks of size 2^( 7) =       0.001592394576

      target function =                  N/A
              le_mean =     -22.327196881553
             les_mean =     502.239966144893
             stat err =       0.001580635283
             autocorr =       1.321491809724
              std dev =       1.944560145525
             le_variance =       3.781314159565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780733393867
                                         uncertainty =       0.033256450451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780733393867
                                         uncertainty =       0.033256450451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374950685
  error estimate for blocks of size 2^( 2) =       0.001446332813
  error estimate for blocks of size 2^( 3) =       0.001511121698
  error estimate for blocks of size 2^( 4) =       0.001555507711
  error estimate for blocks of size 2^( 5) =       0.001582408688
  error estimate for blocks of size 2^( 6) =       0.001592071974
  error estimate for blocks of size 2^( 7) =       0.001592388492

      target function =                  N/A
              le_mean =     -22.327163291719
             les_mean =     502.233914859496
             stat err =       0.001580594216
             autocorr =       1.321498070438
              std dev =       1.944505017651
             le_variance =       3.781099763670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781234889999
                                         uncertainty =       0.033249539105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781234889999
                                         uncertainty =       0.033249539105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375041492
  error estimate for blocks of size 2^( 2) =       0.001446424689
  error estimate for blocks of size 2^( 3) =       0.001511212556
  error estimate for blocks of size 2^( 4) =       0.001555602392
  error estimate for blocks of size 2^( 5) =       0.001582510847
  error estimate for blocks of size 2^( 6) =       0.001592198006
  error estimate for blocks of size 2^( 7) =       0.001592510189

      target function =                  N/A
              le_mean =     -22.327195106283
             les_mean =     502.314421714030
             stat err =       0.001580705359
             autocorr =       1.321509362614
              std dev =       1.944633440690
             le_variance =       3.781599218649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781016837422
                                         uncertainty =       0.033267691289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781016837422
                                         uncertainty =       0.033267691289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375002237
  error estimate for blocks of size 2^( 2) =       0.001446380515
  error estimate for blocks of size 2^( 3) =       0.001511158037
  error estimate for blocks of size 2^( 4) =       0.001555568341
  error estimate for blocks of size 2^( 5) =       0.001582512761
  error estimate for blocks of size 2^( 6) =       0.001592193671
  error estimate for blocks of size 2^( 7) =       0.001592519401

      target function =                  N/A
              le_mean =     -22.327183613751
             les_mean =     502.316109493666
             stat err =       0.001580698544
             autocorr =       1.321573424052
              std dev =       1.944577924611
             le_variance =       3.781383304884


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327196881553        initial  <--
     3.9062e-02     3.9062e-01             2.2612e-03       -22.327163291719
     1.5625e-01     1.5625e+00             1.4123e-03       -22.327195106283
     6.2500e-01     6.2500e+00             5.6458e-04       -22.327183613751

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0734
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_001                -6.990599e-01 3 1  ON 0
ci_002                -7.011274e-01 3 1  ON 1
ci_003                -6.342685e-02 3 1  ON 2
ci_004                -6.271935e-02 3 1  ON 3
ci_005                 4.489931e-02 3 1  ON 4
ci_006                 4.605931e-02 3 1  ON 5
ci_007                 3.109092e-02 3 1  ON 6
ci_008                 3.181862e-02 3 1  ON 7
ci_009                -2.516591e-02 3 1  ON 8
ci_010                -2.519216e-02 3 1  ON 9
ci_011                -2.238462e-02 3 1  ON 10
ci_012                -2.247963e-02 3 1  ON 11
ci_013                 2.054832e-02 3 1  ON 12
ci_014                 2.061778e-02 3 1  ON 13
ci_015                 2.019266e-02 3 1  ON 14
ci_016                 2.076471e-02 3 1  ON 15
ci_017                 1.626691e-02 3 1  ON 16
ci_018                 1.601717e-02 3 1  ON 17
ci_019                 9.549888e-03 3 1  ON 18
ci_020                 1.015270e-02 3 1  ON 19
ci_021                -1.049374e-02 3 1  ON 20
ci_022                -1.004307e-02 3 1  ON 21
ci_023                 9.455666e-03 3 1  ON 22
ci_024                 9.674999e-03 3 1  ON 23
ci_025                 7.728315e-03 3 1  ON 24
ci_026                 7.969296e-03 3 1  ON 25
ci_027                 7.839156e-03 3 1  ON 26
ci_028                 8.464611e-03 3 1  ON 27
ci_029                -8.238993e-03 3 1  ON 28
ci_030                -7.842509e-03 3 1  ON 29
ci_031                -6.815298e-03 3 1  ON 30
ci_032                -8.928169e-03 3 1  ON 31
ci_033                 6.623797e-03 3 1  ON 32
ci_034                 7.334818e-03 3 1  ON 33
ci_035                 6.073387e-03 3 1  ON 34
ci_036                 5.666310e-03 3 1  ON 35
ci_037                 6.596398e-03 3 1  ON 36
ci_038                 5.451278e-03 3 1  ON 37
ci_039                 5.806709e-03 3 1  ON 38
ci_040                 5.423261e-03 3 1  ON 39
ci_041                 5.616740e-03 3 1  ON 40
ci_042                 5.332157e-03 3 1  ON 41
ci_043                 4.877422e-03 3 1  ON 42
ci_044                 4.921584e-03 3 1  ON 43
ci_045                 5.150390e-03 3 1  ON 44
ci_046                 6.096938e-03 3 1  ON 45
ci_047                -4.776369e-03 3 1  ON 46
ci_048                -3.871307e-03 3 1  ON 47
ci_049                 2.853003e-03 3 1  ON 48
ci_050                 4.018792e-03 3 1  ON 49
ci_051                -2.404549e-03 3 1  ON 50
ci_052                -2.350638e-03 3 1  ON 51
ci_053                -2.629647e-03 3 1  ON 52
ci_054                -2.992505e-03 3 1  ON 53
ci_055                -2.317101e-03 3 1  ON 54
ci_056                -1.740670e-03 3 1  ON 55
ci_057                -1.655228e-03 3 1  ON 56
ci_058                -1.945612e-03 3 1  ON 57
ci_059                -1.651285e-03 3 1  ON 58
ci_060                -1.708361e-03 3 1  ON 59
ci_061                -2.044263e-03 3 1  ON 60
ci_062                -2.392783e-03 3 1  ON 61
ci_063                -1.735043e-03 3 1  ON 62
ci_064                -1.319582e-03 3 1  ON 63
ci_065                -1.102619e-03 3 1  ON 64
ci_066                -1.727206e-03 3 1  ON 65
ci_067                -1.444162e-03 3 1  ON 66
ci_068                -1.425762e-03 3 1  ON 67
ci_069                 2.247623e-03 3 1  ON 68
ci_070                 1.637445e-03 3 1  ON 69
ci_071                -8.854852e-04 3 1  ON 70
ci_072                -1.213680e-03 3 1  ON 71
ci_073                 8.818967e-04 3 1  ON 72
ci_074                 1.858280e-03 3 1  ON 73
ci_075                -6.429053e-04 3 1  ON 74
ci_076                -1.369026e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4701e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2324e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.0484
    reference variance = 3.84791
====================================================
  Execution time = 2.3763e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0316e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7183e+00
  Total weights = 1.949608482e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9025e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.770723390716
                                         uncertainty =       0.033062572576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.770723390716
                                         uncertainty =       0.033062572576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372939989
  error estimate for blocks of size 2^( 2) =       0.001443779536
  error estimate for blocks of size 2^( 3) =       0.001507472087
  error estimate for blocks of size 2^( 4) =       0.001550789741
  error estimate for blocks of size 2^( 5) =       0.001577012604
  error estimate for blocks of size 2^( 6) =       0.001591825387
  error estimate for blocks of size 2^( 7) =       0.001602304467

      target function =                  N/A
              le_mean =     -22.328162244229
             les_mean =     502.265115601659
             stat err =       0.001580483050
             autocorr =       1.325185196107
              std dev =       1.941661418675
             le_variance =       3.770049064772


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232816224423e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328162243409       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328196247743       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328196314083       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328196375491       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 7.031809e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328162243409       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328174019976       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328174003014       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 2.628649e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328162243409       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328165501372       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328165504053       residual = 2.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 7.521835e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.026670 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9672e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_001                -6.990525e-01 3 1  ON 0
ci_002                -7.011270e-01 3 1  ON 1
ci_003                -6.328948e-02 3 1  ON 2
ci_004                -6.277647e-02 3 1  ON 3
ci_005                 4.512769e-02 3 1  ON 4
ci_006                 4.599226e-02 3 1  ON 5
ci_007                 3.125658e-02 3 1  ON 6
ci_008                 3.171571e-02 3 1  ON 7
ci_009                -2.532944e-02 3 1  ON 8
ci_010                -2.512867e-02 3 1  ON 9
ci_011                -2.253396e-02 3 1  ON 10
ci_012                -2.239181e-02 3 1  ON 11
ci_013                 2.055193e-02 3 1  ON 12
ci_014                 2.046069e-02 3 1  ON 13
ci_015                 2.037518e-02 3 1  ON 14
ci_016                 2.065335e-02 3 1  ON 15
ci_017                 1.632094e-02 3 1  ON 16
ci_018                 1.604691e-02 3 1  ON 17
ci_019                 9.521048e-03 3 1  ON 18
ci_020                 1.022037e-02 3 1  ON 19
ci_021                -1.041450e-02 3 1  ON 20
ci_022                -1.001886e-02 3 1  ON 21
ci_023                 9.402627e-03 3 1  ON 22
ci_024                 9.597840e-03 3 1  ON 23
ci_025                 7.649197e-03 3 1  ON 24
ci_026                 7.840305e-03 3 1  ON 25
ci_027                 7.718887e-03 3 1  ON 26
ci_028                 8.362889e-03 3 1  ON 27
ci_029                -8.249150e-03 3 1  ON 28
ci_030                -7.834550e-03 3 1  ON 29
ci_031                -6.868283e-03 3 1  ON 30
ci_032                -8.963981e-03 3 1  ON 31
ci_033                 6.549572e-03 3 1  ON 32
ci_034                 7.325262e-03 3 1  ON 33
ci_035                 6.140681e-03 3 1  ON 34
ci_036                 5.929175e-03 3 1  ON 35
ci_037                 6.580519e-03 3 1  ON 36
ci_038                 5.586572e-03 3 1  ON 37
ci_039                 5.713558e-03 3 1  ON 38
ci_040                 5.660729e-03 3 1  ON 39
ci_041                 5.838605e-03 3 1  ON 40
ci_042                 5.298588e-03 3 1  ON 41
ci_043                 4.915392e-03 3 1  ON 42
ci_044                 5.012662e-03 3 1  ON 43
ci_045                 5.066298e-03 3 1  ON 44
ci_046                 5.950729e-03 3 1  ON 45
ci_047                -4.622104e-03 3 1  ON 46
ci_048                -3.981059e-03 3 1  ON 47
ci_049                 2.887042e-03 3 1  ON 48
ci_050                 3.932709e-03 3 1  ON 49
ci_051                -2.427144e-03 3 1  ON 50
ci_052                -2.383947e-03 3 1  ON 51
ci_053                -2.780739e-03 3 1  ON 52
ci_054                -3.114742e-03 3 1  ON 53
ci_055                -2.317496e-03 3 1  ON 54
ci_056                -1.836714e-03 3 1  ON 55
ci_057                -1.504945e-03 3 1  ON 56
ci_058                -1.999023e-03 3 1  ON 57
ci_059                -1.755551e-03 3 1  ON 58
ci_060                -1.730694e-03 3 1  ON 59
ci_061                -2.002661e-03 3 1  ON 60
ci_062                -2.306535e-03 3 1  ON 61
ci_063                -1.646759e-03 3 1  ON 62
ci_064                -1.405135e-03 3 1  ON 63
ci_065                -1.058137e-03 3 1  ON 64
ci_066                -1.767059e-03 3 1  ON 65
ci_067                -1.395582e-03 3 1  ON 66
ci_068                -1.535251e-03 3 1  ON 67
ci_069                 2.087954e-03 3 1  ON 68
ci_070                 1.640579e-03 3 1  ON 69
ci_071                -9.445541e-04 3 1  ON 70
ci_072                -1.258326e-03 3 1  ON 71
ci_073                 9.393329e-04 3 1  ON 72
ci_074                 1.643325e-03 3 1  ON 73
ci_075                -7.410370e-04 3 1  ON 74
ci_076                -1.290880e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -21.7889
    reference variance = 6.86372
====================================================
  Execution time = 2.3305e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7604e+00
  Total weights = 1.9497e+06
  Execution time = 4.3465e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0625592
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810800799272
                                         uncertainty =       0.065643336496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810800799272
                                         uncertainty =       0.065643336496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380489134
  error estimate for blocks of size 2^( 2) =       0.001450664032
  error estimate for blocks of size 2^( 3) =       0.001511726782
  error estimate for blocks of size 2^( 4) =       0.001554859010
  error estimate for blocks of size 2^( 5) =       0.001576966447
  error estimate for blocks of size 2^( 6) =       0.001589372884
  error estimate for blocks of size 2^( 7) =       0.001594745264

      target function =                  N/A
              le_mean =     -22.330191529581
             les_mean =     503.007123741755
             stat err =       0.001578985901
             autocorr =       1.308249324134
              std dev =       1.952337693243
             le_variance =       3.811622468456

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00409173
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810691498435
                                         uncertainty =       0.065652475769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810691498435
                                         uncertainty =       0.065652475769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380469543
  error estimate for blocks of size 2^( 2) =       0.001450630012
  error estimate for blocks of size 2^( 3) =       0.001511675378
  error estimate for blocks of size 2^( 4) =       0.001554825598
  error estimate for blocks of size 2^( 5) =       0.001576919674
  error estimate for blocks of size 2^( 6) =       0.001589334775
  error estimate for blocks of size 2^( 7) =       0.001594615161

      target function =                  N/A
              le_mean =     -22.330193639016
             les_mean =     502.417317291215
             stat err =       0.001578923802
             autocorr =       1.308183552919
              std dev =       1.952309986674
             le_variance =       3.811514284068

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0646399
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810608723068
                                         uncertainty =       0.065651366229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810608723068
                                         uncertainty =       0.065651366229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380454524
  error estimate for blocks of size 2^( 2) =       0.001450621795
  error estimate for blocks of size 2^( 3) =       0.001511673244
  error estimate for blocks of size 2^( 4) =       0.001554824106
  error estimate for blocks of size 2^( 5) =       0.001576915268
  error estimate for blocks of size 2^( 6) =       0.001589327861
  error estimate for blocks of size 2^( 7) =       0.001594626698

      target function =                  N/A
              le_mean =     -22.330183611074
             les_mean =     502.402068887093
             stat err =       0.001578923483
             autocorr =       1.308211490574
              std dev =       1.952288746086
             le_variance =       3.811431348092

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.215506
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810545705455
                                         uncertainty =       0.065648164518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810545705455
                                         uncertainty =       0.065648164518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380442989
  error estimate for blocks of size 2^( 2) =       0.001450621064
  error estimate for blocks of size 2^( 3) =       0.001511679236
  error estimate for blocks of size 2^( 4) =       0.001554840148
  error estimate for blocks of size 2^( 5) =       0.001576935017
  error estimate for blocks of size 2^( 6) =       0.001589353600
  error estimate for blocks of size 2^( 7) =       0.001594649702

      target function =                  N/A
              le_mean =     -22.330181051298
             les_mean =     502.425990996436
             stat err =       0.001578944617
             autocorr =       1.308268373444
              std dev =       1.952272433356
             le_variance =       3.811367654043


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330191529581        initial
     3.9062e-01     3.9062e+00             7.0318e-04       -22.330193639016  <--
     1.5625e+00     1.5625e+01             2.6286e-04       -22.330183611074
     6.2500e+00     6.2500e+01             7.5218e-05       -22.330181051298

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 4.5170e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_001                -6.990596e-01 3 1  ON 0
ci_002                -7.011087e-01 3 1  ON 1
ci_003                -6.291075e-02 3 1  ON 2
ci_004                -6.295805e-02 3 1  ON 3
ci_005                 4.553307e-02 3 1  ON 4
ci_006                 4.588245e-02 3 1  ON 5
ci_007                 3.159501e-02 3 1  ON 6
ci_008                 3.152427e-02 3 1  ON 7
ci_009                -2.565075e-02 3 1  ON 8
ci_010                -2.501110e-02 3 1  ON 9
ci_011                -2.284963e-02 3 1  ON 10
ci_012                -2.221367e-02 3 1  ON 11
ci_013                 2.056092e-02 3 1  ON 12
ci_014                 2.013401e-02 3 1  ON 13
ci_015                 2.080196e-02 3 1  ON 14
ci_016                 2.038651e-02 3 1  ON 15
ci_017                 1.644632e-02 3 1  ON 16
ci_018                 1.609487e-02 3 1  ON 17
ci_019                 9.467154e-03 3 1  ON 18
ci_020                 1.037975e-02 3 1  ON 19
ci_021                -1.021842e-02 3 1  ON 20
ci_022                -9.966393e-03 3 1  ON 21
ci_023                 9.298747e-03 3 1  ON 22
ci_024                 9.445628e-03 3 1  ON 23
ci_025                 7.466509e-03 3 1  ON 24
ci_026                 7.555454e-03 3 1  ON 25
ci_027                 7.514237e-03 3 1  ON 26
ci_028                 8.187903e-03 3 1  ON 27
ci_029                -8.284800e-03 3 1  ON 28
ci_030                -7.808346e-03 3 1  ON 29
ci_031                -6.987190e-03 3 1  ON 30
ci_032                -9.025852e-03 3 1  ON 31
ci_033                 6.400900e-03 3 1  ON 32
ci_034                 7.318037e-03 3 1  ON 33
ci_035                 6.261755e-03 3 1  ON 34
ci_036                 6.369491e-03 3 1  ON 35
ci_037                 6.551870e-03 3 1  ON 36
ci_038                 5.843664e-03 3 1  ON 37
ci_039                 5.549148e-03 3 1  ON 38
ci_040                 6.063123e-03 3 1  ON 39
ci_041                 6.255116e-03 3 1  ON 40
ci_042                 5.234025e-03 3 1  ON 41
ci_043                 5.003485e-03 3 1  ON 42
ci_044                 5.164665e-03 3 1  ON 43
ci_045                 4.893805e-03 3 1  ON 44
ci_046                 5.642115e-03 3 1  ON 45
ci_047                -4.375869e-03 3 1  ON 46
ci_048                -4.152178e-03 3 1  ON 47
ci_049                 2.957232e-03 3 1  ON 48
ci_050                 3.745119e-03 3 1  ON 49
ci_051                -2.481606e-03 3 1  ON 50
ci_052                -2.431087e-03 3 1  ON 51
ci_053                -3.077727e-03 3 1  ON 52
ci_054                -3.374918e-03 3 1  ON 53
ci_055                -2.333554e-03 3 1  ON 54
ci_056                -2.043046e-03 3 1  ON 55
ci_057                -1.207017e-03 3 1  ON 56
ci_058                -2.109248e-03 3 1  ON 57
ci_059                -1.945207e-03 3 1  ON 58
ci_060                -1.747926e-03 3 1  ON 59
ci_061                -1.917500e-03 3 1  ON 60
ci_062                -2.126317e-03 3 1  ON 61
ci_063                -1.458237e-03 3 1  ON 62
ci_064                -1.595718e-03 3 1  ON 63
ci_065                -9.704050e-04 3 1  ON 64
ci_066                -1.852993e-03 3 1  ON 65
ci_067                -1.286585e-03 3 1  ON 66
ci_068                -1.747703e-03 3 1  ON 67
ci_069                 1.765437e-03 3 1  ON 68
ci_070                 1.643388e-03 3 1  ON 69
ci_071                -1.070538e-03 3 1  ON 70
ci_072                -1.346764e-03 3 1  ON 71
ci_073                 1.046150e-03 3 1  ON 72
ci_074                 1.289754e-03 3 1  ON 73
ci_075                -9.456144e-04 3 1  ON 74
ci_076                -1.144117e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4851e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2283e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.4607
    reference variance = 2.39284
====================================================
  Execution time = 2.3811e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0289e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7909e+00
  Total weights = 1.949912298e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8947e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.843804813843
                                         uncertainty =       0.064235330931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.843804813843
                                         uncertainty =       0.064235330931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386168873
  error estimate for blocks of size 2^( 2) =       0.001455702243
  error estimate for blocks of size 2^( 3) =       0.001515882967
  error estimate for blocks of size 2^( 4) =       0.001557817843
  error estimate for blocks of size 2^( 5) =       0.001580849486
  error estimate for blocks of size 2^( 6) =       0.001591022669
  error estimate for blocks of size 2^( 7) =       0.001594593015

      target function =                  N/A
              le_mean =     -22.328630706664
             les_mean =     502.358612108514
             stat err =       0.001581070753
             autocorr =       1.300979117016
              std dev =       1.960370185182
             le_variance =       3.843051262949


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232863070666e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328630705832       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328712756682       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328728435219       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328730281491       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328730880878       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328730929635       residual = 6.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-02 is 4.304816e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328630705832       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328668597289       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328670119034       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328669969077       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 1.066020e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328630705832       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328642724157       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328642798711       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 2.812603e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.030454 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9717e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_001                -6.980117e-01 3 1  ON 0
ci_002                -7.021748e-01 3 1  ON 1
ci_003                -6.281832e-02 3 1  ON 2
ci_004                -6.349066e-02 3 1  ON 3
ci_005                 4.549549e-02 3 1  ON 4
ci_006                 4.596794e-02 3 1  ON 5
ci_007                 3.147287e-02 3 1  ON 6
ci_008                 3.113775e-02 3 1  ON 7
ci_009                -2.515485e-02 3 1  ON 8
ci_010                -2.536625e-02 3 1  ON 9
ci_011                -2.253000e-02 3 1  ON 10
ci_012                -2.242245e-02 3 1  ON 11
ci_013                 2.050100e-02 3 1  ON 12
ci_014                 2.029198e-02 3 1  ON 13
ci_015                 1.987247e-02 3 1  ON 14
ci_016                 2.065346e-02 3 1  ON 15
ci_017                 1.624628e-02 3 1  ON 16
ci_018                 1.584194e-02 3 1  ON 17
ci_019                 9.783852e-03 3 1  ON 18
ci_020                 1.004853e-02 3 1  ON 19
ci_021                -1.011811e-02 3 1  ON 20
ci_022                -9.990861e-03 3 1  ON 21
ci_023                 9.652654e-03 3 1  ON 22
ci_024                 9.026711e-03 3 1  ON 23
ci_025                 7.193122e-03 3 1  ON 24
ci_026                 7.927982e-03 3 1  ON 25
ci_027                 7.745862e-03 3 1  ON 26
ci_028                 7.762540e-03 3 1  ON 27
ci_029                -7.828463e-03 3 1  ON 28
ci_030                -7.588773e-03 3 1  ON 29
ci_031                -7.070849e-03 3 1  ON 30
ci_032                -9.099616e-03 3 1  ON 31
ci_033                 6.669542e-03 3 1  ON 32
ci_034                 7.574006e-03 3 1  ON 33
ci_035                 6.727060e-03 3 1  ON 34
ci_036                 6.591508e-03 3 1  ON 35
ci_037                 6.176475e-03 3 1  ON 36
ci_038                 5.880393e-03 3 1  ON 37
ci_039                 5.509644e-03 3 1  ON 38
ci_040                 6.108968e-03 3 1  ON 39
ci_041                 6.081727e-03 3 1  ON 40
ci_042                 5.147869e-03 3 1  ON 41
ci_043                 5.265011e-03 3 1  ON 42
ci_044                 5.095133e-03 3 1  ON 43
ci_045                 4.902487e-03 3 1  ON 44
ci_046                 5.950623e-03 3 1  ON 45
ci_047                -4.303388e-03 3 1  ON 46
ci_048                -4.080057e-03 3 1  ON 47
ci_049                 3.215102e-03 3 1  ON 48
ci_050                 4.014512e-03 3 1  ON 49
ci_051                -2.568805e-03 3 1  ON 50
ci_052                -2.208137e-03 3 1  ON 51
ci_053                -3.036368e-03 3 1  ON 52
ci_054                -3.111155e-03 3 1  ON 53
ci_055                -2.216821e-03 3 1  ON 54
ci_056                -1.759279e-03 3 1  ON 55
ci_057                -1.821647e-03 3 1  ON 56
ci_058                -1.982040e-03 3 1  ON 57
ci_059                -1.653433e-03 3 1  ON 58
ci_060                -1.706946e-03 3 1  ON 59
ci_061                -2.079960e-03 3 1  ON 60
ci_062                -1.992213e-03 3 1  ON 61
ci_063                -1.803529e-03 3 1  ON 62
ci_064                -1.304563e-03 3 1  ON 63
ci_065                -5.028020e-04 3 1  ON 64
ci_066                -1.318490e-03 3 1  ON 65
ci_067                -1.043174e-03 3 1  ON 66
ci_068                -1.875964e-03 3 1  ON 67
ci_069                 1.364967e-03 3 1  ON 68
ci_070                 1.684135e-03 3 1  ON 69
ci_071                -1.359282e-03 3 1  ON 70
ci_072                -1.271284e-03 3 1  ON 71
ci_073                 1.023469e-03 3 1  ON 72
ci_074                 1.342552e-03 3 1  ON 73
ci_075                -1.152177e-03 3 1  ON 74
ci_076                -1.253111e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.3608
    reference variance = 3.33842
====================================================
  Execution time = 2.3176e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6827e+00
  Total weights = 1.9500e+06
  Execution time = 4.3498e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.731993552293
                                         uncertainty =       0.026016232879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.731993552293
                                         uncertainty =       0.026016232879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365967918
  error estimate for blocks of size 2^( 2) =       0.001437709924
  error estimate for blocks of size 2^( 3) =       0.001503428375
  error estimate for blocks of size 2^( 4) =       0.001547040675
  error estimate for blocks of size 2^( 5) =       0.001574946394
  error estimate for blocks of size 2^( 6) =       0.001586877179
  error estimate for blocks of size 2^( 7) =       0.001591308789

      target function =                  N/A
              le_mean =     -22.329000239220
             les_mean =     502.278474816116
             stat err =       0.001575043259
             autocorr =       1.329547855213
              std dev =       1.931801264117
             le_variance =       3.731856124045

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.11481
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732641828659
                                         uncertainty =       0.025963509291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732641828659
                                         uncertainty =       0.025963509291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366086106
  error estimate for blocks of size 2^( 2) =       0.001437822578
  error estimate for blocks of size 2^( 3) =       0.001503542728
  error estimate for blocks of size 2^( 4) =       0.001547122779
  error estimate for blocks of size 2^( 5) =       0.001574972448
  error estimate for blocks of size 2^( 6) =       0.001586828895
  error estimate for blocks of size 2^( 7) =       0.001591170968

      target function =                  N/A
              le_mean =     -22.329028899176
             les_mean =     502.816342732356
             stat err =       0.001575023772
             autocorr =       1.329284919449
              std dev =       1.931968408768
             le_variance =       3.732501932477

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.298424
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732545922165
                                         uncertainty =       0.026002511586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732545922165
                                         uncertainty =       0.026002511586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366068371
  error estimate for blocks of size 2^( 2) =       0.001437811620
  error estimate for blocks of size 2^( 3) =       0.001503525861
  error estimate for blocks of size 2^( 4) =       0.001547109026
  error estimate for blocks of size 2^( 5) =       0.001575055636
  error estimate for blocks of size 2^( 6) =       0.001586955089
  error estimate for blocks of size 2^( 7) =       0.001591301420

      target function =                  N/A
              le_mean =     -22.329025923180
             les_mean =     503.713469189383
             stat err =       0.001575105293
             autocorr =       1.329457044898
              std dev =       1.931943327065
             le_variance =       3.732405018990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.731919021142
                                         uncertainty =       0.026016783248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.731919021142
                                         uncertainty =       0.026016783248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365954269
  error estimate for blocks of size 2^( 2) =       0.001437698422
  error estimate for blocks of size 2^( 3) =       0.001503415874
  error estimate for blocks of size 2^( 4) =       0.001547015965
  error estimate for blocks of size 2^( 5) =       0.001574940029
  error estimate for blocks of size 2^( 6) =       0.001586864668
  error estimate for blocks of size 2^( 7) =       0.001591278355

      target function =                  N/A
              le_mean =     -22.328993908180
             les_mean =     502.301254588433
             stat err =       0.001575024754
             autocorr =       1.329543184751
              std dev =       1.931781960516
             le_variance =       3.731781542976


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329000239220        initial
     9.7656e-02     9.7656e-01             4.3048e-03       -22.329028899176  <--
     3.9062e-01     3.9062e+00             1.0660e-03       -22.329025923180
     1.5625e+00     1.5625e+01             2.8126e-04       -22.328993908180

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 4.5018e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_001                -6.947548e-01 3 1  ON 0
ci_002                -7.054107e-01 3 1  ON 1
ci_003                -6.262335e-02 3 1  ON 2
ci_004                -6.463708e-02 3 1  ON 3
ci_005                 4.532778e-02 3 1  ON 4
ci_006                 4.619884e-02 3 1  ON 5
ci_007                 3.128349e-02 3 1  ON 6
ci_008                 3.070596e-02 3 1  ON 7
ci_009                -2.448720e-02 3 1  ON 8
ci_010                -2.581156e-02 3 1  ON 9
ci_011                -2.214602e-02 3 1  ON 10
ci_012                -2.271732e-02 3 1  ON 11
ci_013                 2.034371e-02 3 1  ON 12
ci_014                 2.052928e-02 3 1  ON 13
ci_015                 1.860166e-02 3 1  ON 14
ci_016                 2.107161e-02 3 1  ON 15
ci_017                 1.596532e-02 3 1  ON 16
ci_018                 1.563951e-02 3 1  ON 17
ci_019                 1.023626e-02 3 1  ON 18
ci_020                 9.569731e-03 3 1  ON 19
ci_021                -1.000672e-02 3 1  ON 20
ci_022                -1.003834e-02 3 1  ON 21
ci_023                 9.967160e-03 3 1  ON 22
ci_024                 8.642771e-03 3 1  ON 23
ci_025                 6.787204e-03 3 1  ON 24
ci_026                 8.458798e-03 3 1  ON 25
ci_027                 7.888427e-03 3 1  ON 26
ci_028                 7.478081e-03 3 1  ON 27
ci_029                -7.270192e-03 3 1  ON 28
ci_030                -7.426072e-03 3 1  ON 29
ci_031                -7.162286e-03 3 1  ON 30
ci_032                -9.222238e-03 3 1  ON 31
ci_033                 6.978589e-03 3 1  ON 32
ci_034                 7.834754e-03 3 1  ON 33
ci_035                 7.025058e-03 3 1  ON 34
ci_036                 6.830953e-03 3 1  ON 35
ci_037                 5.740988e-03 3 1  ON 36
ci_038                 5.964748e-03 3 1  ON 37
ci_039                 5.455218e-03 3 1  ON 38
ci_040                 6.187635e-03 3 1  ON 39
ci_041                 5.923981e-03 3 1  ON 40
ci_042                 5.083127e-03 3 1  ON 41
ci_043                 5.516562e-03 3 1  ON 42
ci_044                 5.060121e-03 3 1  ON 43
ci_045                 4.881975e-03 3 1  ON 44
ci_046                 6.323826e-03 3 1  ON 45
ci_047                -4.196584e-03 3 1  ON 46
ci_048                -4.023571e-03 3 1  ON 47
ci_049                 3.495899e-03 3 1  ON 48
ci_050                 4.295047e-03 3 1  ON 49
ci_051                -2.620402e-03 3 1  ON 50
ci_052                -1.939146e-03 3 1  ON 51
ci_053                -2.979763e-03 3 1  ON 52
ci_054                -2.816078e-03 3 1  ON 53
ci_055                -2.106603e-03 3 1  ON 54
ci_056                -1.401069e-03 3 1  ON 55
ci_057                -2.403310e-03 3 1  ON 56
ci_058                -1.855377e-03 3 1  ON 57
ci_059                -1.402623e-03 3 1  ON 58
ci_060                -1.675880e-03 3 1  ON 59
ci_061                -2.271525e-03 3 1  ON 60
ci_062                -1.881081e-03 3 1  ON 61
ci_063                -2.182801e-03 3 1  ON 62
ci_064                -9.859195e-04 3 1  ON 63
ci_065                 9.200507e-06 3 1  ON 64
ci_066                -7.682001e-04 3 1  ON 65
ci_067                -7.862357e-04 3 1  ON 66
ci_068                -2.066337e-03 3 1  ON 67
ci_069                 8.945257e-04 3 1  ON 68
ci_070                 1.690965e-03 3 1  ON 69
ci_071                -1.672688e-03 3 1  ON 70
ci_072                -1.210796e-03 3 1  ON 71
ci_073                 9.934914e-04 3 1  ON 72
ci_074                 1.368267e-03 3 1  ON 73
ci_075                -1.382484e-03 3 1  ON 74
ci_076                -1.386581e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4749e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2295e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.0364
    reference variance = 5.50466
====================================================
  Execution time = 2.6209e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0268e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7004e+00
  Total weights = 1.949947484e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9020e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751296812289
                                         uncertainty =       0.027448015558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751296812289
                                         uncertainty =       0.027448015558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369438141
  error estimate for blocks of size 2^( 2) =       0.001439856891
  error estimate for blocks of size 2^( 3) =       0.001502942461
  error estimate for blocks of size 2^( 4) =       0.001547119219
  error estimate for blocks of size 2^( 5) =       0.001575224569
  error estimate for blocks of size 2^( 6) =       0.001591988797
  error estimate for blocks of size 2^( 7) =       0.001599348648

      target function =                  N/A
              le_mean =     -22.329622348294
             les_mean =     502.312455266524
             stat err =       0.001578420308
             autocorr =       1.328496703447
              std dev =       1.936708978372
             le_variance =       3.750841666907


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232962234829e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329622347458       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329759104262       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329779471619       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329806398712       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329818531426       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329823715232       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.329824154071       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.329824150461       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.329824099256       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-02 is 1.091826e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329622347458       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329722387851       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329729254316       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329733546123       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329733786933       residual = 9.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329733845769       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.329733803969       residual = 9.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-02 is 2.716113e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329622347458       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329670584104       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329671161481       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329671408127       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 8.558247e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033596 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2121e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_001                -6.922276e-01 3 1  ON 0
ci_002                -7.081268e-01 3 1  ON 1
ci_003                -6.131299e-02 3 1  ON 2
ci_004                -6.284449e-02 3 1  ON 3
ci_005                 4.514664e-02 3 1  ON 4
ci_006                 4.641742e-02 3 1  ON 5
ci_007                 3.236642e-02 3 1  ON 6
ci_008                 3.072713e-02 3 1  ON 7
ci_009                -2.501209e-02 3 1  ON 8
ci_010                -2.596282e-02 3 1  ON 9
ci_011                -2.243053e-02 3 1  ON 10
ci_012                -2.168519e-02 3 1  ON 11
ci_013                 2.116024e-02 3 1  ON 12
ci_014                 2.042924e-02 3 1  ON 13
ci_015                 1.872124e-02 3 1  ON 14
ci_016                 2.205443e-02 3 1  ON 15
ci_017                 1.525428e-02 3 1  ON 16
ci_018                 1.468484e-02 3 1  ON 17
ci_019                 1.067825e-02 3 1  ON 18
ci_020                 9.784980e-03 3 1  ON 19
ci_021                -9.373856e-03 3 1  ON 20
ci_022                -1.038326e-02 3 1  ON 21
ci_023                 9.895557e-03 3 1  ON 22
ci_024                 8.127580e-03 3 1  ON 23
ci_025                 8.156325e-03 3 1  ON 24
ci_026                 9.034057e-03 3 1  ON 25
ci_027                 7.978413e-03 3 1  ON 26
ci_028                 7.618675e-03 3 1  ON 27
ci_029                -7.599337e-03 3 1  ON 28
ci_030                -7.658546e-03 3 1  ON 29
ci_031                -7.938824e-03 3 1  ON 30
ci_032                -7.652402e-03 3 1  ON 31
ci_033                 6.659510e-03 3 1  ON 32
ci_034                 7.745132e-03 3 1  ON 33
ci_035                 6.324184e-03 3 1  ON 34
ci_036                 6.775384e-03 3 1  ON 35
ci_037                 5.345206e-03 3 1  ON 36
ci_038                 7.647815e-03 3 1  ON 37
ci_039                 5.706263e-03 3 1  ON 38
ci_040                 5.475249e-03 3 1  ON 39
ci_041                 5.347446e-03 3 1  ON 40
ci_042                 5.073659e-03 3 1  ON 41
ci_043                 5.300505e-03 3 1  ON 42
ci_044                 4.243854e-03 3 1  ON 43
ci_045                 4.957517e-03 3 1  ON 44
ci_046                 5.249126e-03 3 1  ON 45
ci_047                -4.223200e-03 3 1  ON 46
ci_048                -4.408202e-03 3 1  ON 47
ci_049                 3.937974e-03 3 1  ON 48
ci_050                 4.709743e-03 3 1  ON 49
ci_051                -2.895873e-03 3 1  ON 50
ci_052                -2.793332e-03 3 1  ON 51
ci_053                -2.384016e-03 3 1  ON 52
ci_054                -1.574739e-03 3 1  ON 53
ci_055                -2.959953e-03 3 1  ON 54
ci_056                -1.686436e-03 3 1  ON 55
ci_057                -2.400148e-03 3 1  ON 56
ci_058                -1.819612e-03 3 1  ON 57
ci_059                -2.579544e-03 3 1  ON 58
ci_060                -1.702525e-03 3 1  ON 59
ci_061                -1.878190e-03 3 1  ON 60
ci_062                -1.253937e-03 3 1  ON 61
ci_063                -1.103063e-03 3 1  ON 62
ci_064                -2.106230e-03 3 1  ON 63
ci_065                -1.757720e-03 3 1  ON 64
ci_066                -1.883339e-03 3 1  ON 65
ci_067                -8.693910e-04 3 1  ON 66
ci_068                -2.018041e-03 3 1  ON 67
ci_069                 2.890236e-04 3 1  ON 68
ci_070                 1.486948e-03 3 1  ON 69
ci_071                -1.185250e-03 3 1  ON 70
ci_072                -6.857025e-04 3 1  ON 71
ci_073                 6.382548e-04 3 1  ON 72
ci_074                 7.031288e-04 3 1  ON 73
ci_075                -1.454476e-03 3 1  ON 74
ci_076                -1.127284e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.3772
    reference variance = 2.21071
====================================================
  Execution time = 2.3125e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7359e+00
  Total weights = 1.9499e+06
  Execution time = 4.3457e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000357205
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793205524864
                                         uncertainty =       0.033573882629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793205524864
                                         uncertainty =       0.033573882629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377044189
  error estimate for blocks of size 2^( 2) =       0.001446593596
  error estimate for blocks of size 2^( 3) =       0.001507910230
  error estimate for blocks of size 2^( 4) =       0.001549028265
  error estimate for blocks of size 2^( 5) =       0.001571643537
  error estimate for blocks of size 2^( 6) =       0.001582689528
  error estimate for blocks of size 2^( 7) =       0.001592370666

      target function =                  N/A
              le_mean =     -22.327716746740
             les_mean =     503.048788012032
             stat err =       0.001573932999
             autocorr =       1.306401672884
              std dev =       1.947465726905
             le_variance =       3.792622757470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788733982694
                                         uncertainty =       0.033151302451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788733982694
                                         uncertainty =       0.033151302451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376232937
  error estimate for blocks of size 2^( 2) =       0.001445760057
  error estimate for blocks of size 2^( 3) =       0.001507065930
  error estimate for blocks of size 2^( 4) =       0.001548216538
  error estimate for blocks of size 2^( 5) =       0.001570977557
  error estimate for blocks of size 2^( 6) =       0.001581704801
  error estimate for blocks of size 2^( 7) =       0.001591408275

      target function =                  N/A
              le_mean =     -22.327647901982
             les_mean =     502.378261532783
             stat err =       0.001573076793
             autocorr =       1.306519671340
              std dev =       1.946318425059
             le_variance =       3.788155411724

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000355465
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.945236013372
                                         uncertainty =       0.150499676588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.945236013372
                                         uncertainty =       0.150499676588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001404294869
  error estimate for blocks of size 2^( 2) =       0.001472490814
  error estimate for blocks of size 2^( 3) =       0.001532404710
  error estimate for blocks of size 2^( 4) =       0.001572897532
  error estimate for blocks of size 2^( 5) =       0.001595088622
  error estimate for blocks of size 2^( 6) =       0.001606089879
  error estimate for blocks of size 2^( 7) =       0.001615742361

      target function =                  N/A
              le_mean =     -22.327265854424
             les_mean =     523.735007362872
             stat err =       0.001597454599
             autocorr =       1.294018334776
              std dev =       1.986004624422
             le_variance =       3.944214368225

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00406954
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.787247741377
                                         uncertainty =       0.033140171159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.787247741377
                                         uncertainty =       0.033140171159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375963896
  error estimate for blocks of size 2^( 2) =       0.001445517319
  error estimate for blocks of size 2^( 3) =       0.001506794979
  error estimate for blocks of size 2^( 4) =       0.001547956643
  error estimate for blocks of size 2^( 5) =       0.001570647363
  error estimate for blocks of size 2^( 6) =       0.001581283228
  error estimate for blocks of size 2^( 7) =       0.001591137888

      target function =                  N/A
              le_mean =     -22.327611296359
             les_mean =     502.381200481044
             stat err =       0.001572756280
             autocorr =       1.306498090652
              std dev =       1.945937936673
             le_variance =       3.786674453384


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327716746740        initial  <--
     2.4414e-02     2.4414e-01             1.0918e-02       -22.327647901982
     9.7656e-02     9.7656e-01             2.7161e-03       -22.327265854424
     3.9062e-01     3.9062e+00             8.5582e-04       -22.327611296359

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9441
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_001                -6.947548e-01 3 1  ON 0
ci_002                -7.054107e-01 3 1  ON 1
ci_003                -6.262335e-02 3 1  ON 2
ci_004                -6.463708e-02 3 1  ON 3
ci_005                 4.532778e-02 3 1  ON 4
ci_006                 4.619884e-02 3 1  ON 5
ci_007                 3.128349e-02 3 1  ON 6
ci_008                 3.070596e-02 3 1  ON 7
ci_009                -2.448720e-02 3 1  ON 8
ci_010                -2.581156e-02 3 1  ON 9
ci_011                -2.214602e-02 3 1  ON 10
ci_012                -2.271732e-02 3 1  ON 11
ci_013                 2.034371e-02 3 1  ON 12
ci_014                 2.052928e-02 3 1  ON 13
ci_015                 1.860166e-02 3 1  ON 14
ci_016                 2.107161e-02 3 1  ON 15
ci_017                 1.596532e-02 3 1  ON 16
ci_018                 1.563951e-02 3 1  ON 17
ci_019                 1.023626e-02 3 1  ON 18
ci_020                 9.569731e-03 3 1  ON 19
ci_021                -1.000672e-02 3 1  ON 20
ci_022                -1.003834e-02 3 1  ON 21
ci_023                 9.967160e-03 3 1  ON 22
ci_024                 8.642771e-03 3 1  ON 23
ci_025                 6.787204e-03 3 1  ON 24
ci_026                 8.458798e-03 3 1  ON 25
ci_027                 7.888427e-03 3 1  ON 26
ci_028                 7.478081e-03 3 1  ON 27
ci_029                -7.270192e-03 3 1  ON 28
ci_030                -7.426072e-03 3 1  ON 29
ci_031                -7.162286e-03 3 1  ON 30
ci_032                -9.222238e-03 3 1  ON 31
ci_033                 6.978589e-03 3 1  ON 32
ci_034                 7.834754e-03 3 1  ON 33
ci_035                 7.025058e-03 3 1  ON 34
ci_036                 6.830953e-03 3 1  ON 35
ci_037                 5.740988e-03 3 1  ON 36
ci_038                 5.964748e-03 3 1  ON 37
ci_039                 5.455218e-03 3 1  ON 38
ci_040                 6.187635e-03 3 1  ON 39
ci_041                 5.923981e-03 3 1  ON 40
ci_042                 5.083127e-03 3 1  ON 41
ci_043                 5.516562e-03 3 1  ON 42
ci_044                 5.060121e-03 3 1  ON 43
ci_045                 4.881975e-03 3 1  ON 44
ci_046                 6.323826e-03 3 1  ON 45
ci_047                -4.196584e-03 3 1  ON 46
ci_048                -4.023571e-03 3 1  ON 47
ci_049                 3.495899e-03 3 1  ON 48
ci_050                 4.295047e-03 3 1  ON 49
ci_051                -2.620402e-03 3 1  ON 50
ci_052                -1.939146e-03 3 1  ON 51
ci_053                -2.979763e-03 3 1  ON 52
ci_054                -2.816078e-03 3 1  ON 53
ci_055                -2.106603e-03 3 1  ON 54
ci_056                -1.401069e-03 3 1  ON 55
ci_057                -2.403310e-03 3 1  ON 56
ci_058                -1.855377e-03 3 1  ON 57
ci_059                -1.402623e-03 3 1  ON 58
ci_060                -1.675880e-03 3 1  ON 59
ci_061                -2.271525e-03 3 1  ON 60
ci_062                -1.881081e-03 3 1  ON 61
ci_063                -2.182801e-03 3 1  ON 62
ci_064                -9.859195e-04 3 1  ON 63
ci_065                 9.200507e-06 3 1  ON 64
ci_066                -7.682001e-04 3 1  ON 65
ci_067                -7.862357e-04 3 1  ON 66
ci_068                -2.066337e-03 3 1  ON 67
ci_069                 8.945257e-04 3 1  ON 68
ci_070                 1.690965e-03 3 1  ON 69
ci_071                -1.672688e-03 3 1  ON 70
ci_072                -1.210796e-03 3 1  ON 71
ci_073                 9.934914e-04 3 1  ON 72
ci_074                 1.368267e-03 3 1  ON 73
ci_075                -1.382484e-03 3 1  ON 74
ci_076                -1.386581e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7075e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2287e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.2123
    reference variance = 12.8479
====================================================
  Execution time = 2.3755e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0330e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7382e+00
  Total weights = 1.949929391e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8514e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789594540826
                                         uncertainty =       0.069051987555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789594540826
                                         uncertainty =       0.069051987555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376381427
  error estimate for blocks of size 2^( 2) =       0.001447254091
  error estimate for blocks of size 2^( 3) =       0.001509347541
  error estimate for blocks of size 2^( 4) =       0.001550901178
  error estimate for blocks of size 2^( 5) =       0.001573078072
  error estimate for blocks of size 2^( 6) =       0.001590535834
  error estimate for blocks of size 2^( 7) =       0.001600800950

      target function =                  N/A
              le_mean =     -22.329124354208
             les_mean =     502.327984271738
             stat err =       0.001578829008
             autocorr =       1.315808195621
              std dev =       1.946528425219
             le_variance =       3.788972910185


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232912435421e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329124353368       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329175478905       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329177421905       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329177845182       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329177757779       residual = 7.25e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 1.231790e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329124353368       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329143499077       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329143706557       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329143730610       residual = 8.68e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 4.324630e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329124353368       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329129820335       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329129845726       residual = 6.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 1.265251e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.037151 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9617e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_001                -6.947953e-01 3 1  ON 0
ci_002                -7.054003e-01 3 1  ON 1
ci_003                -6.275677e-02 3 1  ON 2
ci_004                -6.430319e-02 3 1  ON 3
ci_005                 4.535886e-02 3 1  ON 4
ci_006                 4.616526e-02 3 1  ON 5
ci_007                 3.138688e-02 3 1  ON 6
ci_008                 3.082298e-02 3 1  ON 7
ci_009                -2.457516e-02 3 1  ON 8
ci_010                -2.573913e-02 3 1  ON 9
ci_011                -2.220393e-02 3 1  ON 10
ci_012                -2.267624e-02 3 1  ON 11
ci_013                 2.019013e-02 3 1  ON 12
ci_014                 2.048675e-02 3 1  ON 13
ci_015                 1.900587e-02 3 1  ON 14
ci_016                 2.095258e-02 3 1  ON 15
ci_017                 1.568359e-02 3 1  ON 16
ci_018                 1.558259e-02 3 1  ON 17
ci_019                 1.016121e-02 3 1  ON 18
ci_020                 9.615780e-03 3 1  ON 19
ci_021                -1.031087e-02 3 1  ON 20
ci_022                -1.005165e-02 3 1  ON 21
ci_023                 9.722134e-03 3 1  ON 22
ci_024                 8.841479e-03 3 1  ON 23
ci_025                 6.977771e-03 3 1  ON 24
ci_026                 8.272698e-03 3 1  ON 25
ci_027                 7.788190e-03 3 1  ON 26
ci_028                 7.615886e-03 3 1  ON 27
ci_029                -7.145977e-03 3 1  ON 28
ci_030                -7.410053e-03 3 1  ON 29
ci_031                -7.250967e-03 3 1  ON 30
ci_032                -8.939987e-03 3 1  ON 31
ci_033                 7.067223e-03 3 1  ON 32
ci_034                 7.475010e-03 3 1  ON 33
ci_035                 6.975260e-03 3 1  ON 34
ci_036                 7.003845e-03 3 1  ON 35
ci_037                 5.778986e-03 3 1  ON 36
ci_038                 5.985367e-03 3 1  ON 37
ci_039                 5.583417e-03 3 1  ON 38
ci_040                 5.788493e-03 3 1  ON 39
ci_041                 5.491518e-03 3 1  ON 40
ci_042                 5.158113e-03 3 1  ON 41
ci_043                 5.377051e-03 3 1  ON 42
ci_044                 5.122073e-03 3 1  ON 43
ci_045                 4.728838e-03 3 1  ON 44
ci_046                 6.186088e-03 3 1  ON 45
ci_047                -4.191471e-03 3 1  ON 46
ci_048                -4.029805e-03 3 1  ON 47
ci_049                 3.471241e-03 3 1  ON 48
ci_050                 4.039980e-03 3 1  ON 49
ci_051                -2.460945e-03 3 1  ON 50
ci_052                -2.008270e-03 3 1  ON 51
ci_053                -3.034905e-03 3 1  ON 52
ci_054                -2.595644e-03 3 1  ON 53
ci_055                -2.177833e-03 3 1  ON 54
ci_056                -1.476276e-03 3 1  ON 55
ci_057                -2.369381e-03 3 1  ON 56
ci_058                -1.952599e-03 3 1  ON 57
ci_059                -1.639763e-03 3 1  ON 58
ci_060                -1.756896e-03 3 1  ON 59
ci_061                -2.242542e-03 3 1  ON 60
ci_062                -1.960579e-03 3 1  ON 61
ci_063                -2.037552e-03 3 1  ON 62
ci_064                -1.061066e-03 3 1  ON 63
ci_065                -1.334847e-04 3 1  ON 64
ci_066                -1.005073e-03 3 1  ON 65
ci_067                -9.868918e-04 3 1  ON 66
ci_068                -2.008099e-03 3 1  ON 67
ci_069                 6.747956e-04 3 1  ON 68
ci_070                 1.373363e-03 3 1  ON 69
ci_071                -1.461498e-03 3 1  ON 70
ci_072                -1.336382e-03 3 1  ON 71
ci_073                 8.815755e-04 3 1  ON 72
ci_074                 1.261475e-03 3 1  ON 73
ci_075                -1.309999e-03 3 1  ON 74
ci_076                -1.171899e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.092
    reference variance = 4.32043
====================================================
  Execution time = 2.3156e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7177e+00
  Total weights = 1.9498e+06
  Execution time = 4.3529e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.771692087405
                                         uncertainty =       0.031098272542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.771692087405
                                         uncertainty =       0.031098272542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373071927
  error estimate for blocks of size 2^( 2) =       0.001445404666
  error estimate for blocks of size 2^( 3) =       0.001508742403
  error estimate for blocks of size 2^( 4) =       0.001552776868
  error estimate for blocks of size 2^( 5) =       0.001575120600
  error estimate for blocks of size 2^( 6) =       0.001589170101
  error estimate for blocks of size 2^( 7) =       0.001591219235

      target function =                  N/A
              le_mean =     -22.330122534335
             les_mean =     502.352357988707
             stat err =       0.001577071701
             autocorr =       1.319217189138
              std dev =       1.941848010633
             le_variance =       3.770773696398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.771699909591
                                         uncertainty =       0.031093388125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.771699909591
                                         uncertainty =       0.031093388125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373073637
  error estimate for blocks of size 2^( 2) =       0.001445417228
  error estimate for blocks of size 2^( 3) =       0.001508757382
  error estimate for blocks of size 2^( 4) =       0.001552822297
  error estimate for blocks of size 2^( 5) =       0.001575176493
  error estimate for blocks of size 2^( 6) =       0.001589218416
  error estimate for blocks of size 2^( 7) =       0.001591251848

      target function =                  N/A
              le_mean =     -22.330126908597
             les_mean =     502.447732898892
             stat err =       0.001577117263
             autocorr =       1.319290131899
              std dev =       1.941850427842
             le_variance =       3.770783084110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.771637308079
                                         uncertainty =       0.031094600836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.771637308079
                                         uncertainty =       0.031094600836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373062208
  error estimate for blocks of size 2^( 2) =       0.001445405960
  error estimate for blocks of size 2^( 3) =       0.001508742433
  error estimate for blocks of size 2^( 4) =       0.001552799790
  error estimate for blocks of size 2^( 5) =       0.001575160386
  error estimate for blocks of size 2^( 6) =       0.001589200083
  error estimate for blocks of size 2^( 7) =       0.001591237884

      target function =                  N/A
              le_mean =     -22.330120748259
             les_mean =     502.354593323121
             stat err =       0.001577099536
             autocorr =       1.319282433564
              std dev =       1.941834265600
             le_variance =       3.770720315060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.771676549497
                                         uncertainty =       0.031097721726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.771676549497
                                         uncertainty =       0.031097721726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373069137
  error estimate for blocks of size 2^( 2) =       0.001445403488
  error estimate for blocks of size 2^( 3) =       0.001508741528
  error estimate for blocks of size 2^( 4) =       0.001552780088
  error estimate for blocks of size 2^( 5) =       0.001575126231
  error estimate for blocks of size 2^( 6) =       0.001589173899
  error estimate for blocks of size 2^( 7) =       0.001591222294

      target function =                  N/A
              le_mean =     -22.330120406063
             les_mean =     502.352059166749
             stat err =       0.001577075628
             autocorr =       1.319229121530
              std dev =       1.941844064380
             le_variance =       3.770758370369


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330122534335        initial
     2.4414e-01     2.4414e+00             1.2318e-03       -22.330126908597  <--
     9.7656e-01     9.7656e+00             4.3246e-04       -22.330120748259
     3.9062e+00     3.9062e+01             1.2653e-04       -22.330120406063

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.4999e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_001                -6.949153e-01 3 1  ON 0
ci_002                -7.053392e-01 3 1  ON 1
ci_003                -6.308801e-02 3 1  ON 2
ci_004                -6.351005e-02 3 1  ON 3
ci_005                 4.541400e-02 3 1  ON 4
ci_006                 4.610974e-02 3 1  ON 5
ci_007                 3.154279e-02 3 1  ON 6
ci_008                 3.108503e-02 3 1  ON 7
ci_009                -2.469918e-02 3 1  ON 8
ci_010                -2.561978e-02 3 1  ON 9
ci_011                -2.229725e-02 3 1  ON 10
ci_012                -2.264950e-02 3 1  ON 11
ci_013                 1.991606e-02 3 1  ON 12
ci_014                 2.042202e-02 3 1  ON 13
ci_015                 1.983345e-02 3 1  ON 14
ci_016                 2.073236e-02 3 1  ON 15
ci_017                 1.517316e-02 3 1  ON 16
ci_018                 1.543175e-02 3 1  ON 17
ci_019                 1.001604e-02 3 1  ON 18
ci_020                 9.733923e-03 3 1  ON 19
ci_021                -1.088111e-02 3 1  ON 20
ci_022                -1.009488e-02 3 1  ON 21
ci_023                 9.332999e-03 3 1  ON 22
ci_024                 9.168646e-03 3 1  ON 23
ci_025                 7.364750e-03 3 1  ON 24
ci_026                 7.898473e-03 3 1  ON 25
ci_027                 7.649521e-03 3 1  ON 26
ci_028                 7.813980e-03 3 1  ON 27
ci_029                -6.927340e-03 3 1  ON 28
ci_030                -7.356844e-03 3 1  ON 29
ci_031                -7.403283e-03 3 1  ON 30
ci_032                -8.407813e-03 3 1  ON 31
ci_033                 7.232088e-03 3 1  ON 32
ci_034                 6.833599e-03 3 1  ON 33
ci_035                 6.910798e-03 3 1  ON 34
ci_036                 7.209163e-03 3 1  ON 35
ci_037                 5.849117e-03 3 1  ON 36
ci_038                 6.014582e-03 3 1  ON 37
ci_039                 5.785960e-03 3 1  ON 38
ci_040                 5.246725e-03 3 1  ON 39
ci_041                 4.829623e-03 3 1  ON 40
ci_042                 5.287566e-03 3 1  ON 41
ci_043                 5.128691e-03 3 1  ON 42
ci_044                 5.216287e-03 3 1  ON 43
ci_045                 4.458612e-03 3 1  ON 44
ci_046                 5.967804e-03 3 1  ON 45
ci_047                -4.205176e-03 3 1  ON 46
ci_048                -4.052324e-03 3 1  ON 47
ci_049                 3.429400e-03 3 1  ON 48
ci_050                 3.587710e-03 3 1  ON 49
ci_051                -2.214961e-03 3 1  ON 50
ci_052                -2.126173e-03 3 1  ON 51
ci_053                -3.118920e-03 3 1  ON 52
ci_054                -2.200020e-03 3 1  ON 53
ci_055                -2.262274e-03 3 1  ON 54
ci_056                -1.635257e-03 3 1  ON 55
ci_057                -2.311932e-03 3 1  ON 56
ci_058                -2.113740e-03 3 1  ON 57
ci_059                -1.954468e-03 3 1  ON 58
ci_060                -1.864501e-03 3 1  ON 59
ci_061                -2.159980e-03 3 1  ON 60
ci_062                -2.081807e-03 3 1  ON 61
ci_063                -1.796800e-03 3 1  ON 62
ci_064                -1.200841e-03 3 1  ON 63
ci_065                -3.939625e-04 3 1  ON 64
ci_066                -1.391052e-03 3 1  ON 65
ci_067                -1.342557e-03 3 1  ON 66
ci_068                -1.917968e-03 3 1  ON 67
ci_069                 2.977870e-04 3 1  ON 68
ci_070                 8.228753e-04 3 1  ON 69
ci_071                -1.101286e-03 3 1  ON 70
ci_072                -1.547239e-03 3 1  ON 71
ci_073                 7.365525e-04 3 1  ON 72
ci_074                 1.118888e-03 3 1  ON 73
ci_075                -1.175904e-03 3 1  ON 74
ci_076                -7.885006e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4632e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2277e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.5505
    reference variance = 3.69658
====================================================
  Execution time = 2.3754e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0320e+04
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.7017e+00
  Total weights = 1.949654936e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8769e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753687536134
                                         uncertainty =       0.033221171513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753687536134
                                         uncertainty =       0.033221171513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369826668
  error estimate for blocks of size 2^( 2) =       0.001441209616
  error estimate for blocks of size 2^( 3) =       0.001504373092
  error estimate for blocks of size 2^( 4) =       0.001550627435
  error estimate for blocks of size 2^( 5) =       0.001575592010
  error estimate for blocks of size 2^( 6) =       0.001588653734
  error estimate for blocks of size 2^( 7) =       0.001597682222

      target function =                  N/A
              le_mean =     -22.330911051843
             les_mean =     502.371311537834
             stat err =       0.001578138850
             autocorr =       1.327269727472
              std dev =       1.937258446717
             le_variance =       3.752970289375


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233091105184e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330911050996       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330977846053       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330986584351       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330985236811       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.330986874483       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.330987151101       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.330987173558       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 2.274248e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330911050996       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330950556951       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330953104961       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330952739514       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.330952855624       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 1.265625e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330911050996       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330926048230       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330926379444       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330926351714       residual = 8.69e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 4.579469e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.041484 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9642e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_001                -6.952669e-01 3 1  ON 0
ci_002                -7.049458e-01 3 1  ON 1
ci_003                -6.284561e-02 3 1  ON 2
ci_004                -6.333271e-02 3 1  ON 3
ci_005                 4.537444e-02 3 1  ON 4
ci_006                 4.637440e-02 3 1  ON 5
ci_007                 3.159552e-02 3 1  ON 6
ci_008                 3.140789e-02 3 1  ON 7
ci_009                -2.534993e-02 3 1  ON 8
ci_010                -2.559561e-02 3 1  ON 9
ci_011                -2.245386e-02 3 1  ON 10
ci_012                -2.238102e-02 3 1  ON 11
ci_013                 2.011120e-02 3 1  ON 12
ci_014                 2.068771e-02 3 1  ON 13
ci_015                 1.982327e-02 3 1  ON 14
ci_016                 2.038094e-02 3 1  ON 15
ci_017                 1.558822e-02 3 1  ON 16
ci_018                 1.563361e-02 3 1  ON 17
ci_019                 9.608691e-03 3 1  ON 18
ci_020                 1.006230e-02 3 1  ON 19
ci_021                -1.137173e-02 3 1  ON 20
ci_022                -9.565251e-03 3 1  ON 21
ci_023                 9.494299e-03 3 1  ON 22
ci_024                 1.003281e-02 3 1  ON 23
ci_025                 7.227172e-03 3 1  ON 24
ci_026                 7.844252e-03 3 1  ON 25
ci_027                 7.664600e-03 3 1  ON 26
ci_028                 7.698953e-03 3 1  ON 27
ci_029                -7.236311e-03 3 1  ON 28
ci_030                -7.741156e-03 3 1  ON 29
ci_031                -7.547061e-03 3 1  ON 30
ci_032                -8.241369e-03 3 1  ON 31
ci_033                 7.035074e-03 3 1  ON 32
ci_034                 6.951091e-03 3 1  ON 33
ci_035                 6.178339e-03 3 1  ON 34
ci_036                 7.185891e-03 3 1  ON 35
ci_037                 6.077231e-03 3 1  ON 36
ci_038                 5.931058e-03 3 1  ON 37
ci_039                 6.277060e-03 3 1  ON 38
ci_040                 5.310435e-03 3 1  ON 39
ci_041                 5.381622e-03 3 1  ON 40
ci_042                 5.459750e-03 3 1  ON 41
ci_043                 4.778830e-03 3 1  ON 42
ci_044                 5.586815e-03 3 1  ON 43
ci_045                 5.243647e-03 3 1  ON 44
ci_046                 5.543624e-03 3 1  ON 45
ci_047                -4.201170e-03 3 1  ON 46
ci_048                -3.726332e-03 3 1  ON 47
ci_049                 4.230470e-03 3 1  ON 48
ci_050                 3.760075e-03 3 1  ON 49
ci_051                -2.037300e-03 3 1  ON 50
ci_052                -2.658280e-03 3 1  ON 51
ci_053                -2.885053e-03 3 1  ON 52
ci_054                -2.253502e-03 3 1  ON 53
ci_055                -1.978409e-03 3 1  ON 54
ci_056                -1.467824e-03 3 1  ON 55
ci_057                -2.276154e-03 3 1  ON 56
ci_058                -1.740804e-03 3 1  ON 57
ci_059                -2.483236e-03 3 1  ON 58
ci_060                -1.859463e-03 3 1  ON 59
ci_061                -1.793981e-03 3 1  ON 60
ci_062                -1.931283e-03 3 1  ON 61
ci_063                -1.487177e-03 3 1  ON 62
ci_064                -1.492747e-03 3 1  ON 63
ci_065                -1.659587e-03 3 1  ON 64
ci_066                -1.335790e-03 3 1  ON 65
ci_067                -1.331693e-03 3 1  ON 66
ci_068                -1.862027e-03 3 1  ON 67
ci_069                 1.107489e-03 3 1  ON 68
ci_070                 1.557869e-03 3 1  ON 69
ci_071                -8.109647e-04 3 1  ON 70
ci_072                -5.198394e-04 3 1  ON 71
ci_073                 1.334906e-03 3 1  ON 72
ci_074                 1.498202e-03 3 1  ON 73
ci_075                -1.130917e-03 3 1  ON 74
ci_076                -2.783345e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.4523
    reference variance = 2.08399
====================================================
  Execution time = 2.3059e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7221e+00
  Total weights = 1.9499e+06
  Execution time = 4.3533e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773619853031
                                         uncertainty =       0.031771379378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773619853031
                                         uncertainty =       0.031771379378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373643278
  error estimate for blocks of size 2^( 2) =       0.001443446198
  error estimate for blocks of size 2^( 3) =       0.001504857491
  error estimate for blocks of size 2^( 4) =       0.001549985480
  error estimate for blocks of size 2^( 5) =       0.001575104946
  error estimate for blocks of size 2^( 6) =       0.001591639333
  error estimate for blocks of size 2^( 7) =       0.001607442285

      target function =                  N/A
              le_mean =     -22.328272018053
             les_mean =     502.275787547835
             stat err =       0.001581043011
             autocorr =       1.324766809851
              std dev =       1.942656034938
             le_variance =       3.773912470082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773870732550
                                         uncertainty =       0.031773544314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773870732550
                                         uncertainty =       0.031773544314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373690457
  error estimate for blocks of size 2^( 2) =       0.001443465458
  error estimate for blocks of size 2^( 3) =       0.001504850278
  error estimate for blocks of size 2^( 4) =       0.001549957692
  error estimate for blocks of size 2^( 5) =       0.001575065312
  error estimate for blocks of size 2^( 6) =       0.001591629211
  error estimate for blocks of size 2^( 7) =       0.001607377503

      target function =                  N/A
              le_mean =     -22.328247775637
             les_mean =     502.278925465573
             stat err =       0.001581007430
             autocorr =       1.324616191366
              std dev =       1.942722757288
             le_variance =       3.774171711683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775450322080
                                         uncertainty =       0.032053580386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775450322080
                                         uncertainty =       0.032053580386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373977196
  error estimate for blocks of size 2^( 2) =       0.001443737810
  error estimate for blocks of size 2^( 3) =       0.001505117278
  error estimate for blocks of size 2^( 4) =       0.001550221430
  error estimate for blocks of size 2^( 5) =       0.001575340915
  error estimate for blocks of size 2^( 6) =       0.001591851721
  error estimate for blocks of size 2^( 7) =       0.001607582596

      target function =                  N/A
              le_mean =     -22.328275499708
             les_mean =     502.668407899912
             stat err =       0.001581249165
             autocorr =       1.324468302768
              std dev =       1.943128274011
             le_variance =       3.775747489261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773736339198
                                         uncertainty =       0.031782215836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773736339198
                                         uncertainty =       0.031782215836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373664699
  error estimate for blocks of size 2^( 2) =       0.001443458834
  error estimate for blocks of size 2^( 3) =       0.001504876031
  error estimate for blocks of size 2^( 4) =       0.001549997079
  error estimate for blocks of size 2^( 5) =       0.001575128976
  error estimate for blocks of size 2^( 6) =       0.001591645308
  error estimate for blocks of size 2^( 7) =       0.001607492030

      target function =                  N/A
              le_mean =     -22.328267162439
             les_mean =     502.321612779186
             stat err =       0.001581065848
             autocorr =       1.324763762712
              std dev =       1.942686330229
             le_variance =       3.774030177658


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328272018053        initial
     6.1035e-02     6.1035e-01             2.2742e-03       -22.328247775637
     2.4414e-01     2.4414e+00             1.2656e-03       -22.328275499708  <--
     9.7656e-01     9.7656e+00             4.5795e-04       -22.328267162439

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.4952e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_001                -6.952669e-01 3 1  ON 0
ci_002                -7.049458e-01 3 1  ON 1
ci_003                -6.284561e-02 3 1  ON 2
ci_004                -6.333271e-02 3 1  ON 3
ci_005                 4.537444e-02 3 1  ON 4
ci_006                 4.637440e-02 3 1  ON 5
ci_007                 3.159552e-02 3 1  ON 6
ci_008                 3.140789e-02 3 1  ON 7
ci_009                -2.534993e-02 3 1  ON 8
ci_010                -2.559561e-02 3 1  ON 9
ci_011                -2.245386e-02 3 1  ON 10
ci_012                -2.238102e-02 3 1  ON 11
ci_013                 2.011120e-02 3 1  ON 12
ci_014                 2.068771e-02 3 1  ON 13
ci_015                 1.982327e-02 3 1  ON 14
ci_016                 2.038094e-02 3 1  ON 15
ci_017                 1.558822e-02 3 1  ON 16
ci_018                 1.563361e-02 3 1  ON 17
ci_019                 9.608691e-03 3 1  ON 18
ci_020                 1.006230e-02 3 1  ON 19
ci_021                -1.137173e-02 3 1  ON 20
ci_022                -9.565251e-03 3 1  ON 21
ci_023                 9.494299e-03 3 1  ON 22
ci_024                 1.003281e-02 3 1  ON 23
ci_025                 7.227172e-03 3 1  ON 24
ci_026                 7.844252e-03 3 1  ON 25
ci_027                 7.664600e-03 3 1  ON 26
ci_028                 7.698953e-03 3 1  ON 27
ci_029                -7.236311e-03 3 1  ON 28
ci_030                -7.741156e-03 3 1  ON 29
ci_031                -7.547061e-03 3 1  ON 30
ci_032                -8.241369e-03 3 1  ON 31
ci_033                 7.035074e-03 3 1  ON 32
ci_034                 6.951091e-03 3 1  ON 33
ci_035                 6.178339e-03 3 1  ON 34
ci_036                 7.185891e-03 3 1  ON 35
ci_037                 6.077231e-03 3 1  ON 36
ci_038                 5.931058e-03 3 1  ON 37
ci_039                 6.277060e-03 3 1  ON 38
ci_040                 5.310435e-03 3 1  ON 39
ci_041                 5.381622e-03 3 1  ON 40
ci_042                 5.459750e-03 3 1  ON 41
ci_043                 4.778830e-03 3 1  ON 42
ci_044                 5.586815e-03 3 1  ON 43
ci_045                 5.243647e-03 3 1  ON 44
ci_046                 5.543624e-03 3 1  ON 45
ci_047                -4.201170e-03 3 1  ON 46
ci_048                -3.726332e-03 3 1  ON 47
ci_049                 4.230470e-03 3 1  ON 48
ci_050                 3.760075e-03 3 1  ON 49
ci_051                -2.037300e-03 3 1  ON 50
ci_052                -2.658280e-03 3 1  ON 51
ci_053                -2.885053e-03 3 1  ON 52
ci_054                -2.253502e-03 3 1  ON 53
ci_055                -1.978409e-03 3 1  ON 54
ci_056                -1.467824e-03 3 1  ON 55
ci_057                -2.276154e-03 3 1  ON 56
ci_058                -1.740804e-03 3 1  ON 57
ci_059                -2.483236e-03 3 1  ON 58
ci_060                -1.859463e-03 3 1  ON 59
ci_061                -1.793981e-03 3 1  ON 60
ci_062                -1.931283e-03 3 1  ON 61
ci_063                -1.487177e-03 3 1  ON 62
ci_064                -1.492747e-03 3 1  ON 63
ci_065                -1.659587e-03 3 1  ON 64
ci_066                -1.335790e-03 3 1  ON 65
ci_067                -1.331693e-03 3 1  ON 66
ci_068                -1.862027e-03 3 1  ON 67
ci_069                 1.107489e-03 3 1  ON 68
ci_070                 1.557869e-03 3 1  ON 69
ci_071                -8.109647e-04 3 1  ON 70
ci_072                -5.198394e-04 3 1  ON 71
ci_073                 1.334906e-03 3 1  ON 72
ci_074                 1.498202e-03 3 1  ON 73
ci_075                -1.130917e-03 3 1  ON 74
ci_076                -2.783345e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4609e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2293e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7023
    reference variance = 2.47251
====================================================
  Execution time = 2.3631e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0341e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.9882e+00
  Total weights = 1.949574603e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8447e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.044651807418
                                         uncertainty =       0.269759147495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.044651807418
                                         uncertainty =       0.269759147495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001422182919
  error estimate for blocks of size 2^( 2) =       0.001490861353
  error estimate for blocks of size 2^( 3) =       0.001551427623
  error estimate for blocks of size 2^( 4) =       0.001593229534
  error estimate for blocks of size 2^( 5) =       0.001616906633
  error estimate for blocks of size 2^( 6) =       0.001629131888
  error estimate for blocks of size 2^( 7) =       0.001634082948

      target function =                  N/A
              le_mean =     -22.325771618995
             les_mean =     502.428266830724
             stat err =       0.001618337751
             autocorr =       1.294873709194
              std dev =       2.011302552900
             le_variance =       4.045337959301


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232577161899e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325771618187       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325855629666       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325864473629       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325866091999       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.325867092222       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.325866942848       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.325866890981       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 1.982811e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325771618187       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325821203595       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325823707279       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325823850981       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.325823898766       residual = 9.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 1.048346e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325771618187       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325790406698       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325790754396       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325790753788       residual = 8.09e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 4.397204e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045867 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9488e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_001                -6.956367e-01 3 1  ON 0
ci_002                -7.046179e-01 3 1  ON 1
ci_003                -6.273634e-02 3 1  ON 2
ci_004                -6.306502e-02 3 1  ON 3
ci_005                 4.589874e-02 3 1  ON 4
ci_006                 4.591398e-02 3 1  ON 5
ci_007                 3.157032e-02 3 1  ON 6
ci_008                 3.161783e-02 3 1  ON 7
ci_009                -2.506876e-02 3 1  ON 8
ci_010                -2.532859e-02 3 1  ON 9
ci_011                -2.255218e-02 3 1  ON 10
ci_012                -2.279125e-02 3 1  ON 11
ci_013                 2.034242e-02 3 1  ON 12
ci_014                 2.021314e-02 3 1  ON 13
ci_015                 2.050916e-02 3 1  ON 14
ci_016                 2.021987e-02 3 1  ON 15
ci_017                 1.537660e-02 3 1  ON 16
ci_018                 1.596555e-02 3 1  ON 17
ci_019                 1.064463e-02 3 1  ON 18
ci_020                 9.838135e-03 3 1  ON 19
ci_021                -1.032339e-02 3 1  ON 20
ci_022                -9.468449e-03 3 1  ON 21
ci_023                 9.091810e-03 3 1  ON 22
ci_024                 9.265717e-03 3 1  ON 23
ci_025                 7.666311e-03 3 1  ON 24
ci_026                 7.935964e-03 3 1  ON 25
ci_027                 7.625783e-03 3 1  ON 26
ci_028                 7.896259e-03 3 1  ON 27
ci_029                -7.424788e-03 3 1  ON 28
ci_030                -8.000906e-03 3 1  ON 29
ci_031                -7.360269e-03 3 1  ON 30
ci_032                -7.474347e-03 3 1  ON 31
ci_033                 7.315121e-03 3 1  ON 32
ci_034                 6.582288e-03 3 1  ON 33
ci_035                 6.707299e-03 3 1  ON 34
ci_036                 6.976868e-03 3 1  ON 35
ci_037                 6.487143e-03 3 1  ON 36
ci_038                 5.157965e-03 3 1  ON 37
ci_039                 6.059616e-03 3 1  ON 38
ci_040                 5.133138e-03 3 1  ON 39
ci_041                 5.565217e-03 3 1  ON 40
ci_042                 5.246301e-03 3 1  ON 41
ci_043                 5.112749e-03 3 1  ON 42
ci_044                 5.463365e-03 3 1  ON 43
ci_045                 5.306790e-03 3 1  ON 44
ci_046                 5.882218e-03 3 1  ON 45
ci_047                -4.086695e-03 3 1  ON 46
ci_048                -4.765565e-03 3 1  ON 47
ci_049                 3.892753e-03 3 1  ON 48
ci_050                 3.561407e-03 3 1  ON 49
ci_051                -2.500680e-03 3 1  ON 50
ci_052                -2.456896e-03 3 1  ON 51
ci_053                -3.251458e-03 3 1  ON 52
ci_054                -3.181132e-03 3 1  ON 53
ci_055                -2.000184e-03 3 1  ON 54
ci_056                -1.543809e-03 3 1  ON 55
ci_057                -1.368360e-03 3 1  ON 56
ci_058                -2.363511e-03 3 1  ON 57
ci_059                -2.137090e-03 3 1  ON 58
ci_060                -1.460649e-03 3 1  ON 59
ci_061                -2.151847e-03 3 1  ON 60
ci_062                -1.799696e-03 3 1  ON 61
ci_063                -1.885324e-03 3 1  ON 62
ci_064                -1.021703e-03 3 1  ON 63
ci_065                -1.340696e-03 3 1  ON 64
ci_066                -1.255870e-03 3 1  ON 65
ci_067                -1.710400e-03 3 1  ON 66
ci_068                -1.244697e-03 3 1  ON 67
ci_069                 1.546828e-03 3 1  ON 68
ci_070                 1.336307e-03 3 1  ON 69
ci_071                -2.601428e-04 3 1  ON 70
ci_072                -8.552235e-04 3 1  ON 71
ci_073                 1.487291e-03 3 1  ON 72
ci_074                 1.309943e-03 3 1  ON 73
ci_075                -1.165235e-03 3 1  ON 74
ci_076                -8.582105e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.2673
    reference variance = 2.70516
====================================================
  Execution time = 2.3058e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7245e+00
  Total weights = 1.9501e+06
  Execution time = 4.3383e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 5.7839e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778142498149
                                         uncertainty =       0.045463857371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778142498149
                                         uncertainty =       0.045463857371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374300472
  error estimate for blocks of size 2^( 2) =       0.001445461765
  error estimate for blocks of size 2^( 3) =       0.001507897157
  error estimate for blocks of size 2^( 4) =       0.001549090143
  error estimate for blocks of size 2^( 5) =       0.001570728607
  error estimate for blocks of size 2^( 6) =       0.001577625624
  error estimate for blocks of size 2^( 7) =       0.001575928819

      target function =                  N/A
              le_mean =     -22.328195992553
             les_mean =     502.280860304058
             stat err =       0.001568343298
             autocorr =       1.302323488628
              std dev =       1.943585462987
             le_variance =       3.777524451935

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 6.09671e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778234816927
                                         uncertainty =       0.045451902235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778234816927
                                         uncertainty =       0.045451902235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374316783
  error estimate for blocks of size 2^( 2) =       0.001445477669
  error estimate for blocks of size 2^( 3) =       0.001507913914
  error estimate for blocks of size 2^( 4) =       0.001549118094
  error estimate for blocks of size 2^( 5) =       0.001570792792
  error estimate for blocks of size 2^( 6) =       0.001577702610
  error estimate for blocks of size 2^( 7) =       0.001575941011

      target function =                  N/A
              le_mean =     -22.328184335329
             les_mean =     502.275070139490
             stat err =       0.001568388627
             autocorr =       1.302367855037
              std dev =       1.943608530563
             le_variance =       3.777614120075

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 5.78309e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800099874006
                                         uncertainty =       0.049962205062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800099874006
                                         uncertainty =       0.049962205062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378271632
  error estimate for blocks of size 2^( 2) =       0.001449272620
  error estimate for blocks of size 2^( 3) =       0.001511512775
  error estimate for blocks of size 2^( 4) =       0.001552683877
  error estimate for blocks of size 2^( 5) =       0.001574129563
  error estimate for blocks of size 2^( 6) =       0.001580913703
  error estimate for blocks of size 2^( 7) =       0.001579279923

      target function =                  N/A
              le_mean =     -22.328317584908
             les_mean =     502.471897673963
             stat err =       0.001571751766
             autocorr =       1.300463834136
              std dev =       1.949201621596
             le_variance =       3.799386961633

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 7.28033e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778091247015
                                         uncertainty =       0.045461516338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778091247015
                                         uncertainty =       0.045461516338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374291060
  error estimate for blocks of size 2^( 2) =       0.001445453605
  error estimate for blocks of size 2^( 3) =       0.001507888145
  error estimate for blocks of size 2^( 4) =       0.001549083916
  error estimate for blocks of size 2^( 5) =       0.001570721893
  error estimate for blocks of size 2^( 6) =       0.001577617881
  error estimate for blocks of size 2^( 7) =       0.001575902523

      target function =                  N/A
              le_mean =     -22.328181981270
             les_mean =     502.272627129408
             stat err =       0.001568331553
             autocorr =       1.302321821195
              std dev =       1.943572152214
             le_variance =       3.777472710861


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328195992553        initial
     6.1035e-02     6.1035e-01             1.9828e-03       -22.328184335329
     2.4414e-01     2.4414e+00             1.0483e-03       -22.328317584908  <--
     9.7656e-01     9.7656e+00             4.3972e-04       -22.328181981270

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.4906e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_001                -6.956367e-01 3 1  ON 0
ci_002                -7.046179e-01 3 1  ON 1
ci_003                -6.273634e-02 3 1  ON 2
ci_004                -6.306502e-02 3 1  ON 3
ci_005                 4.589874e-02 3 1  ON 4
ci_006                 4.591398e-02 3 1  ON 5
ci_007                 3.157032e-02 3 1  ON 6
ci_008                 3.161783e-02 3 1  ON 7
ci_009                -2.506876e-02 3 1  ON 8
ci_010                -2.532859e-02 3 1  ON 9
ci_011                -2.255218e-02 3 1  ON 10
ci_012                -2.279125e-02 3 1  ON 11
ci_013                 2.034242e-02 3 1  ON 12
ci_014                 2.021314e-02 3 1  ON 13
ci_015                 2.050916e-02 3 1  ON 14
ci_016                 2.021987e-02 3 1  ON 15
ci_017                 1.537660e-02 3 1  ON 16
ci_018                 1.596555e-02 3 1  ON 17
ci_019                 1.064463e-02 3 1  ON 18
ci_020                 9.838135e-03 3 1  ON 19
ci_021                -1.032339e-02 3 1  ON 20
ci_022                -9.468449e-03 3 1  ON 21
ci_023                 9.091810e-03 3 1  ON 22
ci_024                 9.265717e-03 3 1  ON 23
ci_025                 7.666311e-03 3 1  ON 24
ci_026                 7.935964e-03 3 1  ON 25
ci_027                 7.625783e-03 3 1  ON 26
ci_028                 7.896259e-03 3 1  ON 27
ci_029                -7.424788e-03 3 1  ON 28
ci_030                -8.000906e-03 3 1  ON 29
ci_031                -7.360269e-03 3 1  ON 30
ci_032                -7.474347e-03 3 1  ON 31
ci_033                 7.315121e-03 3 1  ON 32
ci_034                 6.582288e-03 3 1  ON 33
ci_035                 6.707299e-03 3 1  ON 34
ci_036                 6.976868e-03 3 1  ON 35
ci_037                 6.487143e-03 3 1  ON 36
ci_038                 5.157965e-03 3 1  ON 37
ci_039                 6.059616e-03 3 1  ON 38
ci_040                 5.133138e-03 3 1  ON 39
ci_041                 5.565217e-03 3 1  ON 40
ci_042                 5.246301e-03 3 1  ON 41
ci_043                 5.112749e-03 3 1  ON 42
ci_044                 5.463365e-03 3 1  ON 43
ci_045                 5.306790e-03 3 1  ON 44
ci_046                 5.882218e-03 3 1  ON 45
ci_047                -4.086695e-03 3 1  ON 46
ci_048                -4.765565e-03 3 1  ON 47
ci_049                 3.892753e-03 3 1  ON 48
ci_050                 3.561407e-03 3 1  ON 49
ci_051                -2.500680e-03 3 1  ON 50
ci_052                -2.456896e-03 3 1  ON 51
ci_053                -3.251458e-03 3 1  ON 52
ci_054                -3.181132e-03 3 1  ON 53
ci_055                -2.000184e-03 3 1  ON 54
ci_056                -1.543809e-03 3 1  ON 55
ci_057                -1.368360e-03 3 1  ON 56
ci_058                -2.363511e-03 3 1  ON 57
ci_059                -2.137090e-03 3 1  ON 58
ci_060                -1.460649e-03 3 1  ON 59
ci_061                -2.151847e-03 3 1  ON 60
ci_062                -1.799696e-03 3 1  ON 61
ci_063                -1.885324e-03 3 1  ON 62
ci_064                -1.021703e-03 3 1  ON 63
ci_065                -1.340696e-03 3 1  ON 64
ci_066                -1.255870e-03 3 1  ON 65
ci_067                -1.710400e-03 3 1  ON 66
ci_068                -1.244697e-03 3 1  ON 67
ci_069                 1.546828e-03 3 1  ON 68
ci_070                 1.336307e-03 3 1  ON 69
ci_071                -2.601428e-04 3 1  ON 70
ci_072                -8.552235e-04 3 1  ON 71
ci_073                 1.487291e-03 3 1  ON 72
ci_074                 1.309943e-03 3 1  ON 73
ci_075                -1.165235e-03 3 1  ON 74
ci_076                -8.582105e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4408e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2306e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.2254
    reference variance = 3.65987
====================================================
  Execution time = 2.5806e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0299e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7681e+00
  Total weights = 1.950037625e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8687e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.821339693868
                                         uncertainty =       0.050608121567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.821339693868
                                         uncertainty =       0.050608121567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382190475
  error estimate for blocks of size 2^( 2) =       0.001452101724
  error estimate for blocks of size 2^( 3) =       0.001514842276
  error estimate for blocks of size 2^( 4) =       0.001558347017
  error estimate for blocks of size 2^( 5) =       0.001582311705
  error estimate for blocks of size 2^( 6) =       0.001591084911
  error estimate for blocks of size 2^( 7) =       0.001594175591

      target function =                  N/A
              le_mean =     -22.325874554544
             les_mean =     502.212815085625
             stat err =       0.001581479806
             autocorr =       1.309156329870
              std dev =       1.954743790722
             le_variance =       3.821023287368


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232587455454e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325874553771       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325956472938       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325961907482       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325965213275       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.325964820646       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.325965256046       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.325965120994       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 2.603123e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325874553771       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325922514067       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325922824480       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325923073523       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.325923033064       residual = 8.92e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 1.040244e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325874553771       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325892596258       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325892398031       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 4.310866e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.050076 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1686e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605300e-02 3 1  ON 4
ci_006                 4.617156e-02 3 1  ON 5
ci_007                 3.181968e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553487e-02 3 1  ON 9
ci_011                -2.290101e-02 3 1  ON 10
ci_012                -2.258352e-02 3 1  ON 11
ci_013                 2.001107e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537432e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064008e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778798e-03 3 1  ON 20
ci_022                -9.436051e-03 3 1  ON 21
ci_023                 8.739987e-03 3 1  ON 22
ci_024                 9.497584e-03 3 1  ON 23
ci_025                 7.133677e-03 3 1  ON 24
ci_026                 8.150646e-03 3 1  ON 25
ci_027                 7.920672e-03 3 1  ON 26
ci_028                 7.855786e-03 3 1  ON 27
ci_029                -7.650194e-03 3 1  ON 28
ci_030                -7.775380e-03 3 1  ON 29
ci_031                -7.190606e-03 3 1  ON 30
ci_032                -7.557115e-03 3 1  ON 31
ci_033                 6.842345e-03 3 1  ON 32
ci_034                 6.312630e-03 3 1  ON 33
ci_035                 6.419769e-03 3 1  ON 34
ci_036                 6.977822e-03 3 1  ON 35
ci_037                 6.510535e-03 3 1  ON 36
ci_038                 5.592920e-03 3 1  ON 37
ci_039                 5.925453e-03 3 1  ON 38
ci_040                 6.143332e-03 3 1  ON 39
ci_041                 5.439204e-03 3 1  ON 40
ci_042                 5.123463e-03 3 1  ON 41
ci_043                 5.094827e-03 3 1  ON 42
ci_044                 4.423121e-03 3 1  ON 43
ci_045                 5.134250e-03 3 1  ON 44
ci_046                 5.270976e-03 3 1  ON 45
ci_047                -3.975262e-03 3 1  ON 46
ci_048                -4.391774e-03 3 1  ON 47
ci_049                 4.071059e-03 3 1  ON 48
ci_050                 3.474394e-03 3 1  ON 49
ci_051                -3.066919e-03 3 1  ON 50
ci_052                -2.182961e-03 3 1  ON 51
ci_053                -2.742359e-03 3 1  ON 52
ci_054                -3.472292e-03 3 1  ON 53
ci_055                -1.937684e-03 3 1  ON 54
ci_056                -2.005108e-03 3 1  ON 55
ci_057                -1.785120e-03 3 1  ON 56
ci_058                -1.819900e-03 3 1  ON 57
ci_059                -1.894059e-03 3 1  ON 58
ci_060                -2.083946e-03 3 1  ON 59
ci_061                -1.834589e-03 3 1  ON 60
ci_062                -1.924330e-03 3 1  ON 61
ci_063                -1.939869e-03 3 1  ON 62
ci_064                -9.368953e-04 3 1  ON 63
ci_065                -1.769467e-03 3 1  ON 64
ci_066                -1.408035e-03 3 1  ON 65
ci_067                -1.989757e-03 3 1  ON 66
ci_068                -1.522011e-03 3 1  ON 67
ci_069                 1.138818e-03 3 1  ON 68
ci_070                 1.595899e-03 3 1  ON 69
ci_071                 2.755105e-05 3 1  ON 70
ci_072                -2.335043e-04 3 1  ON 71
ci_073                 1.366621e-03 3 1  ON 72
ci_074                 8.864998e-04 3 1  ON 73
ci_075                -1.348863e-03 3 1  ON 74
ci_076                -7.319704e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.4643
    reference variance = 3.58567
====================================================
  Execution time = 2.3168e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6938e+00
  Total weights = 1.9499e+06
  Execution time = 4.3716e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746460067730
                                         uncertainty =       0.028534230919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746460067730
                                         uncertainty =       0.028534230919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368469566
  error estimate for blocks of size 2^( 2) =       0.001440190648
  error estimate for blocks of size 2^( 3) =       0.001504160873
  error estimate for blocks of size 2^( 4) =       0.001546594165
  error estimate for blocks of size 2^( 5) =       0.001569557689
  error estimate for blocks of size 2^( 6) =       0.001581221751
  error estimate for blocks of size 2^( 7) =       0.001581232470

      target function =                  N/A
              le_mean =     -22.329498448540
             les_mean =     502.308200351098
             stat err =       0.001569651519
             autocorr =       1.315637375401
              std dev =       1.935339183990
             le_variance =       3.745537757088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746684319613
                                         uncertainty =       0.028534391086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746684319613
                                         uncertainty =       0.028534391086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368510893
  error estimate for blocks of size 2^( 2) =       0.001440219673
  error estimate for blocks of size 2^( 3) =       0.001504200198
  error estimate for blocks of size 2^( 4) =       0.001546657233
  error estimate for blocks of size 2^( 5) =       0.001569625145
  error estimate for blocks of size 2^( 6) =       0.001581256995
  error estimate for blocks of size 2^( 7) =       0.001581309615

      target function =                  N/A
              le_mean =     -22.329494366147
             les_mean =     502.304917253597
             stat err =       0.001569712247
             autocorr =       1.315659712445
              std dev =       1.935397630599
             le_variance =       3.745763988527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746630663922
                                         uncertainty =       0.028534517204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746630663922
                                         uncertainty =       0.028534517204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368501234
  error estimate for blocks of size 2^( 2) =       0.001440208741
  error estimate for blocks of size 2^( 3) =       0.001504188581
  error estimate for blocks of size 2^( 4) =       0.001546640772
  error estimate for blocks of size 2^( 5) =       0.001569602530
  error estimate for blocks of size 2^( 6) =       0.001581233410
  error estimate for blocks of size 2^( 7) =       0.001581307079

      target function =                  N/A
              le_mean =     -22.329498988438
             les_mean =     502.303391546998
             stat err =       0.001569695948
             autocorr =       1.315650962367
              std dev =       1.935383970093
             le_variance =       3.745711111693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746462893744
                                         uncertainty =       0.028531279498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746462893744
                                         uncertainty =       0.028531279498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368470192
  error estimate for blocks of size 2^( 2) =       0.001440183365
  error estimate for blocks of size 2^( 3) =       0.001504157795
  error estimate for blocks of size 2^( 4) =       0.001546598335
  error estimate for blocks of size 2^( 5) =       0.001569566807
  error estimate for blocks of size 2^( 6) =       0.001581213245
  error estimate for blocks of size 2^( 7) =       0.001581243530

      target function =                  N/A
              le_mean =     -22.329492263388
             les_mean =     502.339529555687
             stat err =       0.001569655479
             autocorr =       1.315642809439
              std dev =       1.935340070228
             le_variance =       3.745541187432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329498448540        initial
     6.1035e-02     6.1035e-01             2.6031e-03       -22.329494366147
     2.4414e-01     2.4414e+00             1.0402e-03       -22.329498988438  <--
     9.7656e-01     9.7656e+00             4.3109e-04       -22.329492263388

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.5055e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605300e-02 3 1  ON 4
ci_006                 4.617156e-02 3 1  ON 5
ci_007                 3.181968e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553487e-02 3 1  ON 9
ci_011                -2.290101e-02 3 1  ON 10
ci_012                -2.258352e-02 3 1  ON 11
ci_013                 2.001107e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537432e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064008e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778798e-03 3 1  ON 20
ci_022                -9.436051e-03 3 1  ON 21
ci_023                 8.739987e-03 3 1  ON 22
ci_024                 9.497584e-03 3 1  ON 23
ci_025                 7.133677e-03 3 1  ON 24
ci_026                 8.150646e-03 3 1  ON 25
ci_027                 7.920672e-03 3 1  ON 26
ci_028                 7.855786e-03 3 1  ON 27
ci_029                -7.650194e-03 3 1  ON 28
ci_030                -7.775380e-03 3 1  ON 29
ci_031                -7.190606e-03 3 1  ON 30
ci_032                -7.557115e-03 3 1  ON 31
ci_033                 6.842345e-03 3 1  ON 32
ci_034                 6.312630e-03 3 1  ON 33
ci_035                 6.419769e-03 3 1  ON 34
ci_036                 6.977822e-03 3 1  ON 35
ci_037                 6.510535e-03 3 1  ON 36
ci_038                 5.592920e-03 3 1  ON 37
ci_039                 5.925453e-03 3 1  ON 38
ci_040                 6.143332e-03 3 1  ON 39
ci_041                 5.439204e-03 3 1  ON 40
ci_042                 5.123463e-03 3 1  ON 41
ci_043                 5.094827e-03 3 1  ON 42
ci_044                 4.423121e-03 3 1  ON 43
ci_045                 5.134250e-03 3 1  ON 44
ci_046                 5.270976e-03 3 1  ON 45
ci_047                -3.975262e-03 3 1  ON 46
ci_048                -4.391774e-03 3 1  ON 47
ci_049                 4.071059e-03 3 1  ON 48
ci_050                 3.474394e-03 3 1  ON 49
ci_051                -3.066919e-03 3 1  ON 50
ci_052                -2.182961e-03 3 1  ON 51
ci_053                -2.742359e-03 3 1  ON 52
ci_054                -3.472292e-03 3 1  ON 53
ci_055                -1.937684e-03 3 1  ON 54
ci_056                -2.005108e-03 3 1  ON 55
ci_057                -1.785120e-03 3 1  ON 56
ci_058                -1.819900e-03 3 1  ON 57
ci_059                -1.894059e-03 3 1  ON 58
ci_060                -2.083946e-03 3 1  ON 59
ci_061                -1.834589e-03 3 1  ON 60
ci_062                -1.924330e-03 3 1  ON 61
ci_063                -1.939869e-03 3 1  ON 62
ci_064                -9.368953e-04 3 1  ON 63
ci_065                -1.769467e-03 3 1  ON 64
ci_066                -1.408035e-03 3 1  ON 65
ci_067                -1.989757e-03 3 1  ON 66
ci_068                -1.522011e-03 3 1  ON 67
ci_069                 1.138818e-03 3 1  ON 68
ci_070                 1.595899e-03 3 1  ON 69
ci_071                 2.755105e-05 3 1  ON 70
ci_072                -2.335043e-04 3 1  ON 71
ci_073                 1.366621e-03 3 1  ON 72
ci_074                 8.864998e-04 3 1  ON 73
ci_075                -1.348863e-03 3 1  ON 74
ci_076                -7.319704e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6756e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2308e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.4311
    reference variance = 1.84962
====================================================
  Execution time = 2.3729e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0273e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7271e+00
  Total weights = 1.949934215e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9291e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778763281734
                                         uncertainty =       0.043162747207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778763281734
                                         uncertainty =       0.043162747207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374518237
  error estimate for blocks of size 2^( 2) =       0.001446087014
  error estimate for blocks of size 2^( 3) =       0.001509997410
  error estimate for blocks of size 2^( 4) =       0.001555946429
  error estimate for blocks of size 2^( 5) =       0.001578818870
  error estimate for blocks of size 2^( 6) =       0.001588717799
  error estimate for blocks of size 2^( 7) =       0.001593824136

      target function =                  N/A
              le_mean =     -22.326138591367
             les_mean =     502.183580108118
             stat err =       0.001579326808
             autocorr =       1.320209951048
              std dev =       1.943893434280
             le_variance =       3.778721683837


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232613859137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326138590568       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326201244793       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326202229341       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326201924597       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326201856019       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.326201936495       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 3.280803e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326138590568       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326174255694       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326174598040       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326174470440       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 1.562709e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326138590568       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326151687969       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326151979967       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326151944580       residual = 8.31e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 5.100599e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054054 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9669e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_001                -6.963478e-01 3 1  ON 0
ci_002                -7.040315e-01 3 1  ON 1
ci_003                -6.199160e-02 3 1  ON 2
ci_004                -6.218591e-02 3 1  ON 3
ci_005                 4.575126e-02 3 1  ON 4
ci_006                 4.602768e-02 3 1  ON 5
ci_007                 3.172073e-02 3 1  ON 6
ci_008                 3.230721e-02 3 1  ON 7
ci_009                -2.491117e-02 3 1  ON 8
ci_010                -2.595831e-02 3 1  ON 9
ci_011                -2.371904e-02 3 1  ON 10
ci_012                -2.222869e-02 3 1  ON 11
ci_013                 2.002532e-02 3 1  ON 12
ci_014                 2.068895e-02 3 1  ON 13
ci_015                 2.125226e-02 3 1  ON 14
ci_016                 2.044520e-02 3 1  ON 15
ci_017                 1.530254e-02 3 1  ON 16
ci_018                 1.507837e-02 3 1  ON 17
ci_019                 1.077722e-02 3 1  ON 18
ci_020                 9.972301e-03 3 1  ON 19
ci_021                -9.547512e-03 3 1  ON 20
ci_022                -9.533365e-03 3 1  ON 21
ci_023                 8.818791e-03 3 1  ON 22
ci_024                 9.185582e-03 3 1  ON 23
ci_025                 7.072599e-03 3 1  ON 24
ci_026                 8.947347e-03 3 1  ON 25
ci_027                 7.438238e-03 3 1  ON 26
ci_028                 7.475813e-03 3 1  ON 27
ci_029                -7.755065e-03 3 1  ON 28
ci_030                -7.587787e-03 3 1  ON 29
ci_031                -6.964366e-03 3 1  ON 30
ci_032                -7.349011e-03 3 1  ON 31
ci_033                 7.196699e-03 3 1  ON 32
ci_034                 6.758739e-03 3 1  ON 33
ci_035                 6.213033e-03 3 1  ON 34
ci_036                 6.668509e-03 3 1  ON 35
ci_037                 6.627893e-03 3 1  ON 36
ci_038                 5.358102e-03 3 1  ON 37
ci_039                 6.130291e-03 3 1  ON 38
ci_040                 5.649632e-03 3 1  ON 39
ci_041                 5.091456e-03 3 1  ON 40
ci_042                 5.054027e-03 3 1  ON 41
ci_043                 4.956387e-03 3 1  ON 42
ci_044                 4.526257e-03 3 1  ON 43
ci_045                 5.010724e-03 3 1  ON 44
ci_046                 4.972050e-03 3 1  ON 45
ci_047                -3.777812e-03 3 1  ON 46
ci_048                -4.432119e-03 3 1  ON 47
ci_049                 4.240044e-03 3 1  ON 48
ci_050                 3.329999e-03 3 1  ON 49
ci_051                -3.078573e-03 3 1  ON 50
ci_052                -2.442967e-03 3 1  ON 51
ci_053                -2.510044e-03 3 1  ON 52
ci_054                -3.253880e-03 3 1  ON 53
ci_055                -2.362878e-03 3 1  ON 54
ci_056                -2.468059e-03 3 1  ON 55
ci_057                -2.437052e-03 3 1  ON 56
ci_058                -1.090319e-03 3 1  ON 57
ci_059                -1.807494e-03 3 1  ON 58
ci_060                -1.904387e-03 3 1  ON 59
ci_061                -1.678742e-03 3 1  ON 60
ci_062                -2.002977e-03 3 1  ON 61
ci_063                -1.641712e-03 3 1  ON 62
ci_064                -8.818734e-04 3 1  ON 63
ci_065                -9.305676e-04 3 1  ON 64
ci_066                -1.850415e-03 3 1  ON 65
ci_067                -2.575328e-03 3 1  ON 66
ci_068                -1.375789e-03 3 1  ON 67
ci_069                 8.087317e-04 3 1  ON 68
ci_070                 7.398560e-04 3 1  ON 69
ci_071                -1.801633e-04 3 1  ON 70
ci_072                -7.603864e-04 3 1  ON 71
ci_073                 1.377676e-03 3 1  ON 72
ci_074                 5.677746e-04 3 1  ON 73
ci_075                -9.643794e-04 3 1  ON 74
ci_076                -7.908394e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.3333
    reference variance = 4.00787
====================================================
  Execution time = 2.3234e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7375e+00
  Total weights = 1.9496e+06
  Execution time = 4.3360e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784955181446
                                         uncertainty =       0.034340825066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784955181446
                                         uncertainty =       0.034340825066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376679493
  error estimate for blocks of size 2^( 2) =       0.001447970663
  error estimate for blocks of size 2^( 3) =       0.001513482989
  error estimate for blocks of size 2^( 4) =       0.001556904380
  error estimate for blocks of size 2^( 5) =       0.001583352984
  error estimate for blocks of size 2^( 6) =       0.001596602153
  error estimate for blocks of size 2^( 7) =       0.001611643465

      target function =                  N/A
              le_mean =     -22.328936245661
             les_mean =     502.323642901953
             stat err =       0.001587125745
             autocorr =       1.329097944984
              std dev =       1.946949960927
             le_variance =       3.790614150353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785067245845
                                         uncertainty =       0.034334164707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785067245845
                                         uncertainty =       0.034334164707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376699777
  error estimate for blocks of size 2^( 2) =       0.001447983748
  error estimate for blocks of size 2^( 3) =       0.001513474853
  error estimate for blocks of size 2^( 4) =       0.001556881915
  error estimate for blocks of size 2^( 5) =       0.001583368382
  error estimate for blocks of size 2^( 6) =       0.001596593241
  error estimate for blocks of size 2^( 7) =       0.001611661612

      target function =                  N/A
              le_mean =     -22.328920576370
             les_mean =     502.427060914096
             stat err =       0.001587126288
             autocorr =       1.329059689592
              std dev =       1.946978646209
             le_variance =       3.790725848794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785071957083
                                         uncertainty =       0.034332686352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785071957083
                                         uncertainty =       0.034332686352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376700637
  error estimate for blocks of size 2^( 2) =       0.001447985514
  error estimate for blocks of size 2^( 3) =       0.001513479003
  error estimate for blocks of size 2^( 4) =       0.001556896127
  error estimate for blocks of size 2^( 5) =       0.001583374806
  error estimate for blocks of size 2^( 6) =       0.001596610291
  error estimate for blocks of size 2^( 7) =       0.001611685244

      target function =                  N/A
              le_mean =     -22.328926227776
             les_mean =     502.319364470409
             stat err =       0.001587141617
             autocorr =       1.329083702871
              std dev =       1.946979862604
             le_variance =       3.790730585386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785203192837
                                         uncertainty =       0.034329613272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785203192837
                                         uncertainty =       0.034329613272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376724498
  error estimate for blocks of size 2^( 2) =       0.001448013738
  error estimate for blocks of size 2^( 3) =       0.001513531559
  error estimate for blocks of size 2^( 4) =       0.001556914132
  error estimate for blocks of size 2^( 5) =       0.001583381680
  error estimate for blocks of size 2^( 6) =       0.001596598421
  error estimate for blocks of size 2^( 7) =       0.001611598385

      target function =                  N/A
              le_mean =     -22.328930357063
             les_mean =     502.493121271130
             stat err =       0.001587123154
             autocorr =       1.329006711072
              std dev =       1.947013608539
             le_variance =       3.790861991837


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328936245661        initial  <--
     6.1035e-02     6.1035e-01             3.2808e-03       -22.328920576370
     2.4414e-01     2.4414e+00             1.5627e-03       -22.328926227776
     9.7656e-01     9.7656e+00             5.1006e-04       -22.328930357063

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1162
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605300e-02 3 1  ON 4
ci_006                 4.617156e-02 3 1  ON 5
ci_007                 3.181968e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553487e-02 3 1  ON 9
ci_011                -2.290101e-02 3 1  ON 10
ci_012                -2.258352e-02 3 1  ON 11
ci_013                 2.001107e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537432e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064008e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778798e-03 3 1  ON 20
ci_022                -9.436051e-03 3 1  ON 21
ci_023                 8.739987e-03 3 1  ON 22
ci_024                 9.497584e-03 3 1  ON 23
ci_025                 7.133677e-03 3 1  ON 24
ci_026                 8.150646e-03 3 1  ON 25
ci_027                 7.920672e-03 3 1  ON 26
ci_028                 7.855786e-03 3 1  ON 27
ci_029                -7.650194e-03 3 1  ON 28
ci_030                -7.775380e-03 3 1  ON 29
ci_031                -7.190606e-03 3 1  ON 30
ci_032                -7.557115e-03 3 1  ON 31
ci_033                 6.842345e-03 3 1  ON 32
ci_034                 6.312630e-03 3 1  ON 33
ci_035                 6.419769e-03 3 1  ON 34
ci_036                 6.977822e-03 3 1  ON 35
ci_037                 6.510535e-03 3 1  ON 36
ci_038                 5.592920e-03 3 1  ON 37
ci_039                 5.925453e-03 3 1  ON 38
ci_040                 6.143332e-03 3 1  ON 39
ci_041                 5.439204e-03 3 1  ON 40
ci_042                 5.123463e-03 3 1  ON 41
ci_043                 5.094827e-03 3 1  ON 42
ci_044                 4.423121e-03 3 1  ON 43
ci_045                 5.134250e-03 3 1  ON 44
ci_046                 5.270976e-03 3 1  ON 45
ci_047                -3.975262e-03 3 1  ON 46
ci_048                -4.391774e-03 3 1  ON 47
ci_049                 4.071059e-03 3 1  ON 48
ci_050                 3.474394e-03 3 1  ON 49
ci_051                -3.066919e-03 3 1  ON 50
ci_052                -2.182961e-03 3 1  ON 51
ci_053                -2.742359e-03 3 1  ON 52
ci_054                -3.472292e-03 3 1  ON 53
ci_055                -1.937684e-03 3 1  ON 54
ci_056                -2.005108e-03 3 1  ON 55
ci_057                -1.785120e-03 3 1  ON 56
ci_058                -1.819900e-03 3 1  ON 57
ci_059                -1.894059e-03 3 1  ON 58
ci_060                -2.083946e-03 3 1  ON 59
ci_061                -1.834589e-03 3 1  ON 60
ci_062                -1.924330e-03 3 1  ON 61
ci_063                -1.939869e-03 3 1  ON 62
ci_064                -9.368953e-04 3 1  ON 63
ci_065                -1.769467e-03 3 1  ON 64
ci_066                -1.408035e-03 3 1  ON 65
ci_067                -1.989757e-03 3 1  ON 66
ci_068                -1.522011e-03 3 1  ON 67
ci_069                 1.138818e-03 3 1  ON 68
ci_070                 1.595899e-03 3 1  ON 69
ci_071                 2.755105e-05 3 1  ON 70
ci_072                -2.335043e-04 3 1  ON 71
ci_073                 1.366621e-03 3 1  ON 72
ci_074                 8.864998e-04 3 1  ON 73
ci_075                -1.348863e-03 3 1  ON 74
ci_076                -7.319704e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4800e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2313e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.2087
    reference variance = 3.96772
====================================================
  Execution time = 2.3789e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0288e+04
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7272e+00
  Total weights = 1.949630957e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9509e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778410300415
                                         uncertainty =       0.035837837121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778410300415
                                         uncertainty =       0.035837837121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374518081
  error estimate for blocks of size 2^( 2) =       0.001444406259
  error estimate for blocks of size 2^( 3) =       0.001508043404
  error estimate for blocks of size 2^( 4) =       0.001552062689
  error estimate for blocks of size 2^( 5) =       0.001575882155
  error estimate for blocks of size 2^( 6) =       0.001585010841
  error estimate for blocks of size 2^( 7) =       0.001592565335

      target function =                  N/A
              le_mean =     -22.324543553500
             les_mean =     502.112404195227
             stat err =       0.001576380255
             autocorr =       1.315288608885
              std dev =       1.943893212781
             le_variance =       3.778720822696


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232454355350e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324543552650       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324563727919       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324564470326       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.324564412590       residual = 2.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 4.960167e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324543552650       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324549804016       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324549915254       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+00 is 1.578784e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324543552650       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324545214986       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324545236350       residual = 7.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+00 is 4.297961e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057325 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9750e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_001                -6.963228e-01 3 1  ON 0
ci_002                -7.040975e-01 3 1  ON 1
ci_003                -6.189736e-02 3 1  ON 2
ci_004                -6.236355e-02 3 1  ON 3
ci_005                 4.591946e-02 3 1  ON 4
ci_006                 4.616022e-02 3 1  ON 5
ci_007                 3.179802e-02 3 1  ON 6
ci_008                 3.153534e-02 3 1  ON 7
ci_009                -2.493056e-02 3 1  ON 8
ci_010                -2.547351e-02 3 1  ON 9
ci_011                -2.294919e-02 3 1  ON 10
ci_012                -2.252114e-02 3 1  ON 11
ci_013                 2.007402e-02 3 1  ON 12
ci_014                 2.026717e-02 3 1  ON 13
ci_015                 1.963010e-02 3 1  ON 14
ci_016                 2.072186e-02 3 1  ON 15
ci_017                 1.542662e-02 3 1  ON 16
ci_018                 1.558999e-02 3 1  ON 17
ci_019                 1.060549e-02 3 1  ON 18
ci_020                 1.039959e-02 3 1  ON 19
ci_021                -9.803938e-03 3 1  ON 20
ci_022                -9.459041e-03 3 1  ON 21
ci_023                 8.738793e-03 3 1  ON 22
ci_024                 9.439501e-03 3 1  ON 23
ci_025                 7.128425e-03 3 1  ON 24
ci_026                 8.109965e-03 3 1  ON 25
ci_027                 7.922375e-03 3 1  ON 26
ci_028                 7.866199e-03 3 1  ON 27
ci_029                -7.645259e-03 3 1  ON 28
ci_030                -7.758645e-03 3 1  ON 29
ci_031                -7.254348e-03 3 1  ON 30
ci_032                -7.462604e-03 3 1  ON 31
ci_033                 6.819692e-03 3 1  ON 32
ci_034                 6.350564e-03 3 1  ON 33
ci_035                 6.577647e-03 3 1  ON 34
ci_036                 6.945199e-03 3 1  ON 35
ci_037                 6.510623e-03 3 1  ON 36
ci_038                 5.673000e-03 3 1  ON 37
ci_039                 5.829046e-03 3 1  ON 38
ci_040                 6.095486e-03 3 1  ON 39
ci_041                 5.426983e-03 3 1  ON 40
ci_042                 5.113241e-03 3 1  ON 41
ci_043                 5.057210e-03 3 1  ON 42
ci_044                 4.568782e-03 3 1  ON 43
ci_045                 5.082133e-03 3 1  ON 44
ci_046                 5.372404e-03 3 1  ON 45
ci_047                -4.048249e-03 3 1  ON 46
ci_048                -4.526988e-03 3 1  ON 47
ci_049                 4.075112e-03 3 1  ON 48
ci_050                 3.470353e-03 3 1  ON 49
ci_051                -3.096221e-03 3 1  ON 50
ci_052                -2.223994e-03 3 1  ON 51
ci_053                -2.815080e-03 3 1  ON 52
ci_054                -3.446641e-03 3 1  ON 53
ci_055                -1.987245e-03 3 1  ON 54
ci_056                -2.057511e-03 3 1  ON 55
ci_057                -1.819752e-03 3 1  ON 56
ci_058                -1.856506e-03 3 1  ON 57
ci_059                -1.828527e-03 3 1  ON 58
ci_060                -2.131581e-03 3 1  ON 59
ci_061                -1.834279e-03 3 1  ON 60
ci_062                -1.962001e-03 3 1  ON 61
ci_063                -1.845380e-03 3 1  ON 62
ci_064                -8.561601e-04 3 1  ON 63
ci_065                -1.808203e-03 3 1  ON 64
ci_066                -1.399287e-03 3 1  ON 65
ci_067                -1.940077e-03 3 1  ON 66
ci_068                -1.553844e-03 3 1  ON 67
ci_069                 9.876940e-04 3 1  ON 68
ci_070                 1.495861e-03 3 1  ON 69
ci_071                -5.172428e-05 3 1  ON 70
ci_072                -2.893795e-04 3 1  ON 71
ci_073                 1.351885e-03 3 1  ON 72
ci_074                 9.045428e-04 3 1  ON 73
ci_075                -1.222296e-03 3 1  ON 74
ci_076                -6.765409e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6212
    reference variance = 2.45528
====================================================
  Execution time = 2.3139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7084e+00
  Total weights = 1.9501e+06
  Execution time = 4.3382e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758288561569
                                         uncertainty =       0.064079563523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758288561569
                                         uncertainty =       0.064079563523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370875645
  error estimate for blocks of size 2^( 2) =       0.001442177030
  error estimate for blocks of size 2^( 3) =       0.001506050403
  error estimate for blocks of size 2^( 4) =       0.001548501188
  error estimate for blocks of size 2^( 5) =       0.001573708288
  error estimate for blocks of size 2^( 6) =       0.001586670911
  error estimate for blocks of size 2^( 7) =       0.001597191440

      target function =                  N/A
              le_mean =     -22.327413317756
             les_mean =     502.221900781673
             stat err =       0.001576517957
             autocorr =       1.322518397266
              std dev =       1.938741948254
             le_variance =       3.758720341920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758241238171
                                         uncertainty =       0.064080105443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758241238171
                                         uncertainty =       0.064080105443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370866908
  error estimate for blocks of size 2^( 2) =       0.001442182679
  error estimate for blocks of size 2^( 3) =       0.001506067924
  error estimate for blocks of size 2^( 4) =       0.001548529602
  error estimate for blocks of size 2^( 5) =       0.001573738039
  error estimate for blocks of size 2^( 6) =       0.001586693536
  error estimate for blocks of size 2^( 7) =       0.001597219146

      target function =                  N/A
              le_mean =     -22.327413150467
             les_mean =     502.226764991292
             stat err =       0.001576545081
             autocorr =       1.322580764254
              std dev =       1.938729591874
             le_variance =       3.758672430407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758253476469
                                         uncertainty =       0.064079913548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758253476469
                                         uncertainty =       0.064079913548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370869183
  error estimate for blocks of size 2^( 2) =       0.001442179928
  error estimate for blocks of size 2^( 3) =       0.001506061039
  error estimate for blocks of size 2^( 4) =       0.001548519430
  error estimate for blocks of size 2^( 5) =       0.001573727516
  error estimate for blocks of size 2^( 6) =       0.001586687083
  error estimate for blocks of size 2^( 7) =       0.001597211408

      target function =                  N/A
              le_mean =     -22.327411418418
             les_mean =     502.221668686313
             stat err =       0.001576536359
             autocorr =       1.322561741013
              std dev =       1.938732809641
             le_variance =       3.758684907179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758282578061
                                         uncertainty =       0.064079612649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758282578061
                                         uncertainty =       0.064079612649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370874545
  error estimate for blocks of size 2^( 2) =       0.001442177219
  error estimate for blocks of size 2^( 3) =       0.001506051648
  error estimate for blocks of size 2^( 4) =       0.001548503502
  error estimate for blocks of size 2^( 5) =       0.001573710784
  error estimate for blocks of size 2^( 6) =       0.001586673102
  error estimate for blocks of size 2^( 7) =       0.001597194153

      target function =                  N/A
              le_mean =     -22.327412765562
             les_mean =     502.221830636585
             stat err =       0.001576520385
             autocorr =       1.322524592755
              std dev =       1.938740393550
             le_variance =       3.758714313581


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327413317756        initial  <--
     6.1035e-01     6.1035e+00             4.9602e-04       -22.327413150467
     2.4414e+00     2.4414e+01             1.5788e-04       -22.327411418418
     9.7656e+00     9.7656e+01             4.2980e-05       -22.327412765562

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9690
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605300e-02 3 1  ON 4
ci_006                 4.617156e-02 3 1  ON 5
ci_007                 3.181968e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553487e-02 3 1  ON 9
ci_011                -2.290101e-02 3 1  ON 10
ci_012                -2.258352e-02 3 1  ON 11
ci_013                 2.001107e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537432e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064008e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778798e-03 3 1  ON 20
ci_022                -9.436051e-03 3 1  ON 21
ci_023                 8.739987e-03 3 1  ON 22
ci_024                 9.497584e-03 3 1  ON 23
ci_025                 7.133677e-03 3 1  ON 24
ci_026                 8.150646e-03 3 1  ON 25
ci_027                 7.920672e-03 3 1  ON 26
ci_028                 7.855786e-03 3 1  ON 27
ci_029                -7.650194e-03 3 1  ON 28
ci_030                -7.775380e-03 3 1  ON 29
ci_031                -7.190606e-03 3 1  ON 30
ci_032                -7.557115e-03 3 1  ON 31
ci_033                 6.842345e-03 3 1  ON 32
ci_034                 6.312630e-03 3 1  ON 33
ci_035                 6.419769e-03 3 1  ON 34
ci_036                 6.977822e-03 3 1  ON 35
ci_037                 6.510535e-03 3 1  ON 36
ci_038                 5.592920e-03 3 1  ON 37
ci_039                 5.925453e-03 3 1  ON 38
ci_040                 6.143332e-03 3 1  ON 39
ci_041                 5.439204e-03 3 1  ON 40
ci_042                 5.123463e-03 3 1  ON 41
ci_043                 5.094827e-03 3 1  ON 42
ci_044                 4.423121e-03 3 1  ON 43
ci_045                 5.134250e-03 3 1  ON 44
ci_046                 5.270976e-03 3 1  ON 45
ci_047                -3.975262e-03 3 1  ON 46
ci_048                -4.391774e-03 3 1  ON 47
ci_049                 4.071059e-03 3 1  ON 48
ci_050                 3.474394e-03 3 1  ON 49
ci_051                -3.066919e-03 3 1  ON 50
ci_052                -2.182961e-03 3 1  ON 51
ci_053                -2.742359e-03 3 1  ON 52
ci_054                -3.472292e-03 3 1  ON 53
ci_055                -1.937684e-03 3 1  ON 54
ci_056                -2.005108e-03 3 1  ON 55
ci_057                -1.785120e-03 3 1  ON 56
ci_058                -1.819900e-03 3 1  ON 57
ci_059                -1.894059e-03 3 1  ON 58
ci_060                -2.083946e-03 3 1  ON 59
ci_061                -1.834589e-03 3 1  ON 60
ci_062                -1.924330e-03 3 1  ON 61
ci_063                -1.939869e-03 3 1  ON 62
ci_064                -9.368953e-04 3 1  ON 63
ci_065                -1.769467e-03 3 1  ON 64
ci_066                -1.408035e-03 3 1  ON 65
ci_067                -1.989757e-03 3 1  ON 66
ci_068                -1.522011e-03 3 1  ON 67
ci_069                 1.138818e-03 3 1  ON 68
ci_070                 1.595899e-03 3 1  ON 69
ci_071                 2.755105e-05 3 1  ON 70
ci_072                -2.335043e-04 3 1  ON 71
ci_073                 1.366621e-03 3 1  ON 72
ci_074                 8.864998e-04 3 1  ON 73
ci_075                -1.348863e-03 3 1  ON 74
ci_076                -7.319704e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4734e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2318e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.5223
    reference variance = 2.52607
====================================================
  Execution time = 2.3878e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0324e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7491e+00
  Total weights = 1.949815196e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8348e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800450958762
                                         uncertainty =       0.040393226796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800450958762
                                         uncertainty =       0.040393226796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378612684
  error estimate for blocks of size 2^( 2) =       0.001448353913
  error estimate for blocks of size 2^( 3) =       0.001509184614
  error estimate for blocks of size 2^( 4) =       0.001551635258
  error estimate for blocks of size 2^( 5) =       0.001578209786
  error estimate for blocks of size 2^( 6) =       0.001598785322
  error estimate for blocks of size 2^( 7) =       0.001607226046

      target function =                  N/A
              le_mean =     -22.328634431221
             les_mean =     502.317026633404
             stat err =       0.001583964103
             autocorr =       1.320097869113
              std dev =       1.949683949770
             le_variance =       3.801267503993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232863443122e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328634430402       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328639170855       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328639143187       residual = 8.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 7.848912e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328634430402       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328635645681       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328635639482       residual = 7.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+01 is 2.029518e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328634430402       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328634736167       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328634734670       residual = 7.10e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+01 is 5.117651e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058484 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9719e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_001                -6.963154e-01 3 1  ON 0
ci_002                -7.040944e-01 3 1  ON 1
ci_003                -6.188070e-02 3 1  ON 2
ci_004                -6.235445e-02 3 1  ON 3
ci_005                 4.604181e-02 3 1  ON 4
ci_006                 4.616532e-02 3 1  ON 5
ci_007                 3.181301e-02 3 1  ON 6
ci_008                 3.148115e-02 3 1  ON 7
ci_009                -2.501481e-02 3 1  ON 8
ci_010                -2.554031e-02 3 1  ON 9
ci_011                -2.290945e-02 3 1  ON 10
ci_012                -2.258042e-02 3 1  ON 11
ci_013                 2.001064e-02 3 1  ON 12
ci_014                 2.019569e-02 3 1  ON 13
ci_015                 1.969798e-02 3 1  ON 14
ci_016                 2.074416e-02 3 1  ON 15
ci_017                 1.536491e-02 3 1  ON 16
ci_018                 1.572211e-02 3 1  ON 17
ci_019                 1.063389e-02 3 1  ON 18
ci_020                 1.043948e-02 3 1  ON 19
ci_021                -9.780082e-03 3 1  ON 20
ci_022                -9.433178e-03 3 1  ON 21
ci_023                 8.739044e-03 3 1  ON 22
ci_024                 9.493999e-03 3 1  ON 23
ci_025                 7.133858e-03 3 1  ON 24
ci_026                 8.153470e-03 3 1  ON 25
ci_027                 7.925930e-03 3 1  ON 26
ci_028                 7.876081e-03 3 1  ON 27
ci_029                -7.650360e-03 3 1  ON 28
ci_030                -7.781314e-03 3 1  ON 29
ci_031                -7.198064e-03 3 1  ON 30
ci_032                -7.551047e-03 3 1  ON 31
ci_033                 6.844031e-03 3 1  ON 32
ci_034                 6.318905e-03 3 1  ON 33
ci_035                 6.404456e-03 3 1  ON 34
ci_036                 6.981931e-03 3 1  ON 35
ci_037                 6.508448e-03 3 1  ON 36
ci_038                 5.608696e-03 3 1  ON 37
ci_039                 5.929254e-03 3 1  ON 38
ci_040                 6.130256e-03 3 1  ON 39
ci_041                 5.430709e-03 3 1  ON 40
ci_042                 5.131971e-03 3 1  ON 41
ci_043                 5.095103e-03 3 1  ON 42
ci_044                 4.425276e-03 3 1  ON 43
ci_045                 5.128368e-03 3 1  ON 44
ci_046                 5.269653e-03 3 1  ON 45
ci_047                -3.967747e-03 3 1  ON 46
ci_048                -4.385766e-03 3 1  ON 47
ci_049                 4.070383e-03 3 1  ON 48
ci_050                 3.464043e-03 3 1  ON 49
ci_051                -3.082885e-03 3 1  ON 50
ci_052                -2.192874e-03 3 1  ON 51
ci_053                -2.744623e-03 3 1  ON 52
ci_054                -3.455081e-03 3 1  ON 53
ci_055                -1.944828e-03 3 1  ON 54
ci_056                -2.019063e-03 3 1  ON 55
ci_057                -1.791475e-03 3 1  ON 56
ci_058                -1.824034e-03 3 1  ON 57
ci_059                -1.893046e-03 3 1  ON 58
ci_060                -2.082095e-03 3 1  ON 59
ci_061                -1.832877e-03 3 1  ON 60
ci_062                -1.926210e-03 3 1  ON 61
ci_063                -1.931835e-03 3 1  ON 62
ci_064                -9.322676e-04 3 1  ON 63
ci_065                -1.765190e-03 3 1  ON 64
ci_066                -1.400893e-03 3 1  ON 65
ci_067                -1.980056e-03 3 1  ON 66
ci_068                -1.520257e-03 3 1  ON 67
ci_069                 1.138086e-03 3 1  ON 68
ci_070                 1.593184e-03 3 1  ON 69
ci_071                 1.026750e-05 3 1  ON 70
ci_072                -2.371392e-04 3 1  ON 71
ci_073                 1.364691e-03 3 1  ON 72
ci_074                 8.825162e-04 3 1  ON 73
ci_075                -1.343350e-03 3 1  ON 74
ci_076                -7.320958e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.3039
    reference variance = 2.29086
====================================================
  Execution time = 2.3256e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2322e+01
  VMC Evar = 3.7274e+00
  Total weights = 1.9493e+06
  Execution time = 4.3525e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778056809528
                                         uncertainty =       0.029510689264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778056809528
                                         uncertainty =       0.029510689264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374351481
  error estimate for blocks of size 2^( 2) =       0.001446141327
  error estimate for blocks of size 2^( 3) =       0.001510193315
  error estimate for blocks of size 2^( 4) =       0.001554054078
  error estimate for blocks of size 2^( 5) =       0.001578925327
  error estimate for blocks of size 2^( 6) =       0.001590706971
  error estimate for blocks of size 2^( 7) =       0.001597619211

      target function =                  N/A
              le_mean =     -22.322497569096
             les_mean =     502.022324598722
             stat err =       0.001580326397
             autocorr =       1.322202454215
              std dev =       1.943657601996
             le_variance =       3.777804873795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778049721950
                                         uncertainty =       0.029510333930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778049721950
                                         uncertainty =       0.029510333930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374350212
  error estimate for blocks of size 2^( 2) =       0.001446141630
  error estimate for blocks of size 2^( 3) =       0.001510194710
  error estimate for blocks of size 2^( 4) =       0.001554056303
  error estimate for blocks of size 2^( 5) =       0.001578926903
  error estimate for blocks of size 2^( 6) =       0.001590709819
  error estimate for blocks of size 2^( 7) =       0.001597619934

      target function =                  N/A
              le_mean =     -22.322496645602
             les_mean =     502.021296034370
             stat err =       0.001580328240
             autocorr =       1.322207980647
              std dev =       1.943655807054
             le_variance =       3.777797896295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778052924707
                                         uncertainty =       0.029510507617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778052924707
                                         uncertainty =       0.029510507617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374350785
  error estimate for blocks of size 2^( 2) =       0.001446141450
  error estimate for blocks of size 2^( 3) =       0.001510193976
  error estimate for blocks of size 2^( 4) =       0.001554055179
  error estimate for blocks of size 2^( 5) =       0.001578926089
  error estimate for blocks of size 2^( 6) =       0.001590708339
  error estimate for blocks of size 2^( 7) =       0.001597619669

      target function =                  N/A
              le_mean =     -22.322497046121
             les_mean =     502.021223628684
             stat err =       0.001580327319
             autocorr =       1.322205337417
              std dev =       1.943656617302
             le_variance =       3.777801045981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778056295389
                                         uncertainty =       0.029510666346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778056295389
                                         uncertainty =       0.029510666346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374351389
  error estimate for blocks of size 2^( 2) =       0.001446141341
  error estimate for blocks of size 2^( 3) =       0.001510193404
  error estimate for blocks of size 2^( 4) =       0.001554054220
  error estimate for blocks of size 2^( 5) =       0.001578925458
  error estimate for blocks of size 2^( 6) =       0.001590707196
  error estimate for blocks of size 2^( 7) =       0.001597619290

      target function =                  N/A
              le_mean =     -22.322497508860
             les_mean =     502.021742542951
             stat err =       0.001580326541
             autocorr =       1.322202873187
              std dev =       1.943657471585
             le_variance =       3.777804366848


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.322497569096        initial  <--
     6.1035e+00     6.1035e+01             7.8489e-05       -22.322496645602
     2.4414e+01     2.4414e+02             2.0295e-05       -22.322497046121
     9.7656e+01     9.7656e+02             5.1177e-06       -22.322497508860

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0997
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605300e-02 3 1  ON 4
ci_006                 4.617156e-02 3 1  ON 5
ci_007                 3.181968e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553487e-02 3 1  ON 9
ci_011                -2.290101e-02 3 1  ON 10
ci_012                -2.258352e-02 3 1  ON 11
ci_013                 2.001107e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537432e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064008e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778798e-03 3 1  ON 20
ci_022                -9.436051e-03 3 1  ON 21
ci_023                 8.739987e-03 3 1  ON 22
ci_024                 9.497584e-03 3 1  ON 23
ci_025                 7.133677e-03 3 1  ON 24
ci_026                 8.150646e-03 3 1  ON 25
ci_027                 7.920672e-03 3 1  ON 26
ci_028                 7.855786e-03 3 1  ON 27
ci_029                -7.650194e-03 3 1  ON 28
ci_030                -7.775380e-03 3 1  ON 29
ci_031                -7.190606e-03 3 1  ON 30
ci_032                -7.557115e-03 3 1  ON 31
ci_033                 6.842345e-03 3 1  ON 32
ci_034                 6.312630e-03 3 1  ON 33
ci_035                 6.419769e-03 3 1  ON 34
ci_036                 6.977822e-03 3 1  ON 35
ci_037                 6.510535e-03 3 1  ON 36
ci_038                 5.592920e-03 3 1  ON 37
ci_039                 5.925453e-03 3 1  ON 38
ci_040                 6.143332e-03 3 1  ON 39
ci_041                 5.439204e-03 3 1  ON 40
ci_042                 5.123463e-03 3 1  ON 41
ci_043                 5.094827e-03 3 1  ON 42
ci_044                 4.423121e-03 3 1  ON 43
ci_045                 5.134250e-03 3 1  ON 44
ci_046                 5.270976e-03 3 1  ON 45
ci_047                -3.975262e-03 3 1  ON 46
ci_048                -4.391774e-03 3 1  ON 47
ci_049                 4.071059e-03 3 1  ON 48
ci_050                 3.474394e-03 3 1  ON 49
ci_051                -3.066919e-03 3 1  ON 50
ci_052                -2.182961e-03 3 1  ON 51
ci_053                -2.742359e-03 3 1  ON 52
ci_054                -3.472292e-03 3 1  ON 53
ci_055                -1.937684e-03 3 1  ON 54
ci_056                -2.005108e-03 3 1  ON 55
ci_057                -1.785120e-03 3 1  ON 56
ci_058                -1.819900e-03 3 1  ON 57
ci_059                -1.894059e-03 3 1  ON 58
ci_060                -2.083946e-03 3 1  ON 59
ci_061                -1.834589e-03 3 1  ON 60
ci_062                -1.924330e-03 3 1  ON 61
ci_063                -1.939869e-03 3 1  ON 62
ci_064                -9.368953e-04 3 1  ON 63
ci_065                -1.769467e-03 3 1  ON 64
ci_066                -1.408035e-03 3 1  ON 65
ci_067                -1.989757e-03 3 1  ON 66
ci_068                -1.522011e-03 3 1  ON 67
ci_069                 1.138818e-03 3 1  ON 68
ci_070                 1.595899e-03 3 1  ON 69
ci_071                 2.755105e-05 3 1  ON 70
ci_072                -2.335043e-04 3 1  ON 71
ci_073                 1.366621e-03 3 1  ON 72
ci_074                 8.864998e-04 3 1  ON 73
ci_075                -1.348863e-03 3 1  ON 74
ci_076                -7.319704e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4825e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2323e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.4003
    reference variance = 3.58058
====================================================
  Execution time = 2.6086e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0314e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7517e+00
  Total weights = 1.949657084e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8884e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801324168815
                                         uncertainty =       0.033874828912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801324168815
                                         uncertainty =       0.033874828912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378692108
  error estimate for blocks of size 2^( 2) =       0.001450327969
  error estimate for blocks of size 2^( 3) =       0.001514068115
  error estimate for blocks of size 2^( 4) =       0.001560386484
  error estimate for blocks of size 2^( 5) =       0.001580898822
  error estimate for blocks of size 2^( 6) =       0.001595276982
  error estimate for blocks of size 2^( 7) =       0.001607238096

      target function =                  N/A
              le_mean =     -22.326138114873
             les_mean =     502.208104695079
             stat err =       0.001585950096
             autocorr =       1.323257780238
              std dev =       1.949796272814
             le_variance =       3.801705505479


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232613811487e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326138114027       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326138468506       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326138470808       residual = 2.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+01 is 6.790500e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326138114027       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326138202852       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326138203440       residual = 2.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+02 is 1.701627e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326138114027       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326138136246       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326138136394       residual = 2.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+02 is 4.256579e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1981e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_001                -6.963170e-01 3 1  ON 0
ci_002                -7.040922e-01 3 1  ON 1
ci_003                -6.187476e-02 3 1  ON 2
ci_004                -6.235919e-02 3 1  ON 3
ci_005                 4.605273e-02 3 1  ON 4
ci_006                 4.617080e-02 3 1  ON 5
ci_007                 3.181877e-02 3 1  ON 6
ci_008                 3.146877e-02 3 1  ON 7
ci_009                -2.501553e-02 3 1  ON 8
ci_010                -2.553437e-02 3 1  ON 9
ci_011                -2.290065e-02 3 1  ON 10
ci_012                -2.258317e-02 3 1  ON 11
ci_013                 2.001143e-02 3 1  ON 12
ci_014                 2.020398e-02 3 1  ON 13
ci_015                 1.969006e-02 3 1  ON 14
ci_016                 2.075051e-02 3 1  ON 15
ci_017                 1.537468e-02 3 1  ON 16
ci_018                 1.572305e-02 3 1  ON 17
ci_019                 1.063945e-02 3 1  ON 18
ci_020                 1.044001e-02 3 1  ON 19
ci_021                -9.777551e-03 3 1  ON 20
ci_022                -9.435792e-03 3 1  ON 21
ci_023                 8.740682e-03 3 1  ON 22
ci_024                 9.496337e-03 3 1  ON 23
ci_025                 7.134190e-03 3 1  ON 24
ci_026                 8.151164e-03 3 1  ON 25
ci_027                 7.920485e-03 3 1  ON 26
ci_028                 7.855199e-03 3 1  ON 27
ci_029                -7.649263e-03 3 1  ON 28
ci_030                -7.776091e-03 3 1  ON 29
ci_031                -7.190987e-03 3 1  ON 30
ci_032                -7.556645e-03 3 1  ON 31
ci_033                 6.842155e-03 3 1  ON 32
ci_034                 6.313066e-03 3 1  ON 33
ci_035                 6.419688e-03 3 1  ON 34
ci_036                 6.977207e-03 3 1  ON 35
ci_037                 6.510498e-03 3 1  ON 36
ci_038                 5.593020e-03 3 1  ON 37
ci_039                 5.924359e-03 3 1  ON 38
ci_040                 6.141903e-03 3 1  ON 39
ci_041                 5.439525e-03 3 1  ON 40
ci_042                 5.124052e-03 3 1  ON 41
ci_043                 5.094424e-03 3 1  ON 42
ci_044                 4.423463e-03 3 1  ON 43
ci_045                 5.134407e-03 3 1  ON 44
ci_046                 5.271320e-03 3 1  ON 45
ci_047                -3.975908e-03 3 1  ON 46
ci_048                -4.390668e-03 3 1  ON 47
ci_049                 4.069767e-03 3 1  ON 48
ci_050                 3.474936e-03 3 1  ON 49
ci_051                -3.065300e-03 3 1  ON 50
ci_052                -2.183783e-03 3 1  ON 51
ci_053                -2.741659e-03 3 1  ON 52
ci_054                -3.472532e-03 3 1  ON 53
ci_055                -1.938673e-03 3 1  ON 54
ci_056                -2.005556e-03 3 1  ON 55
ci_057                -1.785598e-03 3 1  ON 56
ci_058                -1.820083e-03 3 1  ON 57
ci_059                -1.895265e-03 3 1  ON 58
ci_060                -2.084361e-03 3 1  ON 59
ci_061                -1.833679e-03 3 1  ON 60
ci_062                -1.924817e-03 3 1  ON 61
ci_063                -1.940153e-03 3 1  ON 62
ci_064                -9.380148e-04 3 1  ON 63
ci_065                -1.769845e-03 3 1  ON 64
ci_066                -1.407456e-03 3 1  ON 65
ci_067                -1.988498e-03 3 1  ON 66
ci_068                -1.522197e-03 3 1  ON 67
ci_069                 1.138624e-03 3 1  ON 68
ci_070                 1.595434e-03 3 1  ON 69
ci_071                 2.731603e-05 3 1  ON 70
ci_072                -2.352059e-04 3 1  ON 71
ci_073                 1.366479e-03 3 1  ON 72
ci_074                 8.871038e-04 3 1  ON 73
ci_075                -1.349428e-03 3 1  ON 74
ci_076                -7.314564e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.1409
    reference variance = 2.89049
====================================================
  Execution time = 2.3251e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6909e+00
  Total weights = 1.9497e+06
  Execution time = 4.3535e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742591618028
                                         uncertainty =       0.028334752296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742591618028
                                         uncertainty =       0.028334752296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367932445
  error estimate for blocks of size 2^( 2) =       0.001438273946
  error estimate for blocks of size 2^( 3) =       0.001502613704
  error estimate for blocks of size 2^( 4) =       0.001550207900
  error estimate for blocks of size 2^( 5) =       0.001575645430
  error estimate for blocks of size 2^( 6) =       0.001581572609
  error estimate for blocks of size 2^( 7) =       0.001592816334

      target function =                  N/A
              le_mean =     -22.329137746462
             les_mean =     502.281309790578
             stat err =       0.001575060568
             autocorr =       1.325760932918
              std dev =       1.934579568821
             le_variance =       3.742598108100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742590394280
                                         uncertainty =       0.028334738541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742590394280
                                         uncertainty =       0.028334738541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367932222
  error estimate for blocks of size 2^( 2) =       0.001438273916
  error estimate for blocks of size 2^( 3) =       0.001502613836
  error estimate for blocks of size 2^( 4) =       0.001550208137
  error estimate for blocks of size 2^( 5) =       0.001575645686
  error estimate for blocks of size 2^( 6) =       0.001581572770
  error estimate for blocks of size 2^( 7) =       0.001592816420

      target function =                  N/A
              le_mean =     -22.329137698856
             les_mean =     502.281307919904
             stat err =       0.001575060754
             autocorr =       1.325761677583
              std dev =       1.934579253195
             le_variance =       3.742596886892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742591003615
                                         uncertainty =       0.028334745397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742591003615
                                         uncertainty =       0.028334745397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367932333
  error estimate for blocks of size 2^( 2) =       0.001438273931
  error estimate for blocks of size 2^( 3) =       0.001502613770
  error estimate for blocks of size 2^( 4) =       0.001550208019
  error estimate for blocks of size 2^( 5) =       0.001575645558
  error estimate for blocks of size 2^( 6) =       0.001581572690
  error estimate for blocks of size 2^( 7) =       0.001592816377

      target function =                  N/A
              le_mean =     -22.329137722325
             les_mean =     502.281308696701
             stat err =       0.001575060661
             autocorr =       1.325761306454
              std dev =       1.934579410353
             le_variance =       3.742597494961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742591541058
                                         uncertainty =       0.028334751432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742591541058
                                         uncertainty =       0.028334751432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367932431
  error estimate for blocks of size 2^( 2) =       0.001438273944
  error estimate for blocks of size 2^( 3) =       0.001502613712
  error estimate for blocks of size 2^( 4) =       0.001550207915
  error estimate for blocks of size 2^( 5) =       0.001575645446
  error estimate for blocks of size 2^( 6) =       0.001581572619
  error estimate for blocks of size 2^( 7) =       0.001592816339

      target function =                  N/A
              le_mean =     -22.329137743415
             les_mean =     502.281309637338
             stat err =       0.001575060580
             autocorr =       1.325760979647
              std dev =       1.934579548969
             le_variance =       3.742598031289


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329137746462        initial  <--
     6.1035e+01     6.1035e+02             6.7905e-06       -22.329137698856
     2.4414e+02     2.4414e+03             1.7016e-06       -22.329137722325
     9.7656e+02     9.7656e+03             4.2566e-07       -22.329137743415

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1027
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605300e-02 3 1  ON 4
ci_006                 4.617156e-02 3 1  ON 5
ci_007                 3.181968e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553487e-02 3 1  ON 9
ci_011                -2.290101e-02 3 1  ON 10
ci_012                -2.258352e-02 3 1  ON 11
ci_013                 2.001107e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537432e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064008e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778798e-03 3 1  ON 20
ci_022                -9.436051e-03 3 1  ON 21
ci_023                 8.739987e-03 3 1  ON 22
ci_024                 9.497584e-03 3 1  ON 23
ci_025                 7.133677e-03 3 1  ON 24
ci_026                 8.150646e-03 3 1  ON 25
ci_027                 7.920672e-03 3 1  ON 26
ci_028                 7.855786e-03 3 1  ON 27
ci_029                -7.650194e-03 3 1  ON 28
ci_030                -7.775380e-03 3 1  ON 29
ci_031                -7.190606e-03 3 1  ON 30
ci_032                -7.557115e-03 3 1  ON 31
ci_033                 6.842345e-03 3 1  ON 32
ci_034                 6.312630e-03 3 1  ON 33
ci_035                 6.419769e-03 3 1  ON 34
ci_036                 6.977822e-03 3 1  ON 35
ci_037                 6.510535e-03 3 1  ON 36
ci_038                 5.592920e-03 3 1  ON 37
ci_039                 5.925453e-03 3 1  ON 38
ci_040                 6.143332e-03 3 1  ON 39
ci_041                 5.439204e-03 3 1  ON 40
ci_042                 5.123463e-03 3 1  ON 41
ci_043                 5.094827e-03 3 1  ON 42
ci_044                 4.423121e-03 3 1  ON 43
ci_045                 5.134250e-03 3 1  ON 44
ci_046                 5.270976e-03 3 1  ON 45
ci_047                -3.975262e-03 3 1  ON 46
ci_048                -4.391774e-03 3 1  ON 47
ci_049                 4.071059e-03 3 1  ON 48
ci_050                 3.474394e-03 3 1  ON 49
ci_051                -3.066919e-03 3 1  ON 50
ci_052                -2.182961e-03 3 1  ON 51
ci_053                -2.742359e-03 3 1  ON 52
ci_054                -3.472292e-03 3 1  ON 53
ci_055                -1.937684e-03 3 1  ON 54
ci_056                -2.005108e-03 3 1  ON 55
ci_057                -1.785120e-03 3 1  ON 56
ci_058                -1.819900e-03 3 1  ON 57
ci_059                -1.894059e-03 3 1  ON 58
ci_060                -2.083946e-03 3 1  ON 59
ci_061                -1.834589e-03 3 1  ON 60
ci_062                -1.924330e-03 3 1  ON 61
ci_063                -1.939869e-03 3 1  ON 62
ci_064                -9.368953e-04 3 1  ON 63
ci_065                -1.769467e-03 3 1  ON 64
ci_066                -1.408035e-03 3 1  ON 65
ci_067                -1.989757e-03 3 1  ON 66
ci_068                -1.522011e-03 3 1  ON 67
ci_069                 1.138818e-03 3 1  ON 68
ci_070                 1.595899e-03 3 1  ON 69
ci_071                 2.755105e-05 3 1  ON 70
ci_072                -2.335043e-04 3 1  ON 71
ci_073                 1.366621e-03 3 1  ON 72
ci_074                 8.864998e-04 3 1  ON 73
ci_075                -1.348863e-03 3 1  ON 74
ci_076                -7.319704e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7091e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2321e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.4657
    reference variance = 4.19554
====================================================
  Execution time = 2.3784e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0302e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6949e+00
  Total weights = 1.949837527e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8944e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746558655417
                                         uncertainty =       0.026236382122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746558655417
                                         uncertainty =       0.026236382122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368546512
  error estimate for blocks of size 2^( 2) =       0.001440399705
  error estimate for blocks of size 2^( 3) =       0.001503005861
  error estimate for blocks of size 2^( 4) =       0.001545744926
  error estimate for blocks of size 2^( 5) =       0.001566859162
  error estimate for blocks of size 2^( 6) =       0.001579518525
  error estimate for blocks of size 2^( 7) =       0.001589251519

      target function =                  N/A
              le_mean =     -22.328978339901
             les_mean =     502.278195762574
             stat err =       0.001570343533
             autocorr =       1.316649614481
              std dev =       1.935448004589
             le_variance =       3.745958978467


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232897833990e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328978339092       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328978369186       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328978369455       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+02 is 7.567591e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328978339092       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328978346618       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328978346685       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+03 is 1.892158e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328978339092       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328978340974       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328978340991       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+03 is 4.730556e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060905 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9685e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040926e-01 3 1  ON 1
ci_003                -6.187507e-02 3 1  ON 2
ci_004                -6.235963e-02 3 1  ON 3
ci_005                 4.605293e-02 3 1  ON 4
ci_006                 4.617155e-02 3 1  ON 5
ci_007                 3.181980e-02 3 1  ON 6
ci_008                 3.146819e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553481e-02 3 1  ON 9
ci_011                -2.290100e-02 3 1  ON 10
ci_012                -2.258359e-02 3 1  ON 11
ci_013                 2.001099e-02 3 1  ON 12
ci_014                 2.020482e-02 3 1  ON 13
ci_015                 1.968974e-02 3 1  ON 14
ci_016                 2.075009e-02 3 1  ON 15
ci_017                 1.537442e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.063995e-02 3 1  ON 18
ci_020                 1.044016e-02 3 1  ON 19
ci_021                -9.778730e-03 3 1  ON 20
ci_022                -9.436072e-03 3 1  ON 21
ci_023                 8.739989e-03 3 1  ON 22
ci_024                 9.497685e-03 3 1  ON 23
ci_025                 7.133699e-03 3 1  ON 24
ci_026                 8.150545e-03 3 1  ON 25
ci_027                 7.920591e-03 3 1  ON 26
ci_028                 7.855838e-03 3 1  ON 27
ci_029                -7.650178e-03 3 1  ON 28
ci_030                -7.775427e-03 3 1  ON 29
ci_031                -7.190673e-03 3 1  ON 30
ci_032                -7.557037e-03 3 1  ON 31
ci_033                 6.842350e-03 3 1  ON 32
ci_034                 6.312660e-03 3 1  ON 33
ci_035                 6.419802e-03 3 1  ON 34
ci_036                 6.977721e-03 3 1  ON 35
ci_037                 6.510375e-03 3 1  ON 36
ci_038                 5.592893e-03 3 1  ON 37
ci_039                 5.925336e-03 3 1  ON 38
ci_040                 6.143176e-03 3 1  ON 39
ci_041                 5.439113e-03 3 1  ON 40
ci_042                 5.123354e-03 3 1  ON 41
ci_043                 5.094724e-03 3 1  ON 42
ci_044                 4.423171e-03 3 1  ON 43
ci_045                 5.134151e-03 3 1  ON 44
ci_046                 5.271008e-03 3 1  ON 45
ci_047                -3.975301e-03 3 1  ON 46
ci_048                -4.391815e-03 3 1  ON 47
ci_049                 4.070958e-03 3 1  ON 48
ci_050                 3.474501e-03 3 1  ON 49
ci_051                -3.066837e-03 3 1  ON 50
ci_052                -2.182969e-03 3 1  ON 51
ci_053                -2.742433e-03 3 1  ON 52
ci_054                -3.472214e-03 3 1  ON 53
ci_055                -1.937596e-03 3 1  ON 54
ci_056                -2.005146e-03 3 1  ON 55
ci_057                -1.785069e-03 3 1  ON 56
ci_058                -1.819908e-03 3 1  ON 57
ci_059                -1.894091e-03 3 1  ON 58
ci_060                -2.083900e-03 3 1  ON 59
ci_061                -1.834576e-03 3 1  ON 60
ci_062                -1.924375e-03 3 1  ON 61
ci_063                -1.939766e-03 3 1  ON 62
ci_064                -9.369395e-04 3 1  ON 63
ci_065                -1.769399e-03 3 1  ON 64
ci_066                -1.408159e-03 3 1  ON 65
ci_067                -1.989724e-03 3 1  ON 66
ci_068                -1.522060e-03 3 1  ON 67
ci_069                 1.138896e-03 3 1  ON 68
ci_070                 1.595873e-03 3 1  ON 69
ci_071                 2.756683e-05 3 1  ON 70
ci_072                -2.336782e-04 3 1  ON 71
ci_073                 1.366501e-03 3 1  ON 72
ci_074                 8.865879e-04 3 1  ON 73
ci_075                -1.348946e-03 3 1  ON 74
ci_076                -7.319260e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.2157
    reference variance = 5.06265
====================================================
  Execution time = 2.3165e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6825e+00
  Total weights = 1.9502e+06
  Execution time = 4.3537e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732816314588
                                         uncertainty =       0.030744366739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732816314588
                                         uncertainty =       0.030744366739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366092272
  error estimate for blocks of size 2^( 2) =       0.001437675401
  error estimate for blocks of size 2^( 3) =       0.001500749443
  error estimate for blocks of size 2^( 4) =       0.001545233953
  error estimate for blocks of size 2^( 5) =       0.001564198211
  error estimate for blocks of size 2^( 6) =       0.001583211749
  error estimate for blocks of size 2^( 7) =       0.001588493439

      target function =                  N/A
              le_mean =     -22.328516296783
             les_mean =     502.245134704529
             stat err =       0.001570284338
             autocorr =       1.321285074000
              std dev =       1.931977129672
             le_variance =       3.732535629575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732816259982
                                         uncertainty =       0.030744368626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732816259982
                                         uncertainty =       0.030744368626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366092263
  error estimate for blocks of size 2^( 2) =       0.001437675393
  error estimate for blocks of size 2^( 3) =       0.001500749443
  error estimate for blocks of size 2^( 4) =       0.001545233960
  error estimate for blocks of size 2^( 5) =       0.001564198214
  error estimate for blocks of size 2^( 6) =       0.001583211756
  error estimate for blocks of size 2^( 7) =       0.001588493481

      target function =                  N/A
              le_mean =     -22.328516292654
             les_mean =     502.245134307761
             stat err =       0.001570284352
             autocorr =       1.321285116472
              std dev =       1.931977116263
             le_variance =       3.732535577762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732816287258
                                         uncertainty =       0.030744367683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732816287258
                                         uncertainty =       0.030744367683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366092267
  error estimate for blocks of size 2^( 2) =       0.001437675397
  error estimate for blocks of size 2^( 3) =       0.001500749443
  error estimate for blocks of size 2^( 4) =       0.001545233956
  error estimate for blocks of size 2^( 5) =       0.001564198212
  error estimate for blocks of size 2^( 6) =       0.001583211752
  error estimate for blocks of size 2^( 7) =       0.001588493460

      target function =                  N/A
              le_mean =     -22.328516294714
             les_mean =     502.245134503065
             stat err =       0.001570284345
             autocorr =       1.321285095245
              std dev =       1.931977122960
             le_variance =       3.732535603641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732816311170
                                         uncertainty =       0.030744366857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732816311170
                                         uncertainty =       0.030744366857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366092272
  error estimate for blocks of size 2^( 2) =       0.001437675401
  error estimate for blocks of size 2^( 3) =       0.001500749443
  error estimate for blocks of size 2^( 4) =       0.001545233954
  error estimate for blocks of size 2^( 5) =       0.001564198211
  error estimate for blocks of size 2^( 6) =       0.001583211749
  error estimate for blocks of size 2^( 7) =       0.001588493442

      target function =                  N/A
              le_mean =     -22.328516296524
             les_mean =     502.245134679009
             stat err =       0.001570284339
             autocorr =       1.321285076657
              std dev =       1.931977128832
             le_variance =       3.732535626331


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328516296783        initial  <--
     6.1035e+02     6.1035e+03             7.5676e-07       -22.328516292654
     2.4414e+03     2.4414e+04             1.8922e-07       -22.328516294714
     9.7656e+03     9.7656e+04             4.7306e-08       -22.328516296524

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0326
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605300e-02 3 1  ON 4
ci_006                 4.617156e-02 3 1  ON 5
ci_007                 3.181968e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553487e-02 3 1  ON 9
ci_011                -2.290101e-02 3 1  ON 10
ci_012                -2.258352e-02 3 1  ON 11
ci_013                 2.001107e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537432e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064008e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778798e-03 3 1  ON 20
ci_022                -9.436051e-03 3 1  ON 21
ci_023                 8.739987e-03 3 1  ON 22
ci_024                 9.497584e-03 3 1  ON 23
ci_025                 7.133677e-03 3 1  ON 24
ci_026                 8.150646e-03 3 1  ON 25
ci_027                 7.920672e-03 3 1  ON 26
ci_028                 7.855786e-03 3 1  ON 27
ci_029                -7.650194e-03 3 1  ON 28
ci_030                -7.775380e-03 3 1  ON 29
ci_031                -7.190606e-03 3 1  ON 30
ci_032                -7.557115e-03 3 1  ON 31
ci_033                 6.842345e-03 3 1  ON 32
ci_034                 6.312630e-03 3 1  ON 33
ci_035                 6.419769e-03 3 1  ON 34
ci_036                 6.977822e-03 3 1  ON 35
ci_037                 6.510535e-03 3 1  ON 36
ci_038                 5.592920e-03 3 1  ON 37
ci_039                 5.925453e-03 3 1  ON 38
ci_040                 6.143332e-03 3 1  ON 39
ci_041                 5.439204e-03 3 1  ON 40
ci_042                 5.123463e-03 3 1  ON 41
ci_043                 5.094827e-03 3 1  ON 42
ci_044                 4.423121e-03 3 1  ON 43
ci_045                 5.134250e-03 3 1  ON 44
ci_046                 5.270976e-03 3 1  ON 45
ci_047                -3.975262e-03 3 1  ON 46
ci_048                -4.391774e-03 3 1  ON 47
ci_049                 4.071059e-03 3 1  ON 48
ci_050                 3.474394e-03 3 1  ON 49
ci_051                -3.066919e-03 3 1  ON 50
ci_052                -2.182961e-03 3 1  ON 51
ci_053                -2.742359e-03 3 1  ON 52
ci_054                -3.472292e-03 3 1  ON 53
ci_055                -1.937684e-03 3 1  ON 54
ci_056                -2.005108e-03 3 1  ON 55
ci_057                -1.785120e-03 3 1  ON 56
ci_058                -1.819900e-03 3 1  ON 57
ci_059                -1.894059e-03 3 1  ON 58
ci_060                -2.083946e-03 3 1  ON 59
ci_061                -1.834589e-03 3 1  ON 60
ci_062                -1.924330e-03 3 1  ON 61
ci_063                -1.939869e-03 3 1  ON 62
ci_064                -9.368953e-04 3 1  ON 63
ci_065                -1.769467e-03 3 1  ON 64
ci_066                -1.408035e-03 3 1  ON 65
ci_067                -1.989757e-03 3 1  ON 66
ci_068                -1.522011e-03 3 1  ON 67
ci_069                 1.138818e-03 3 1  ON 68
ci_070                 1.595899e-03 3 1  ON 69
ci_071                 2.755105e-05 3 1  ON 70
ci_072                -2.335043e-04 3 1  ON 71
ci_073                 1.366621e-03 3 1  ON 72
ci_074                 8.864998e-04 3 1  ON 73
ci_075                -1.348863e-03 3 1  ON 74
ci_076                -7.319704e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4725e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2322e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.3176
    reference variance = 3.54552
====================================================
  Execution time = 2.3756e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0323e+04
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7632e+00
  Total weights = 1.949929531e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8973e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814226909250
                                         uncertainty =       0.037971372779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814226909250
                                         uncertainty =       0.037971372779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380863265
  error estimate for blocks of size 2^( 2) =       0.001452120414
  error estimate for blocks of size 2^( 3) =       0.001514372369
  error estimate for blocks of size 2^( 4) =       0.001558784940
  error estimate for blocks of size 2^( 5) =       0.001582872803
  error estimate for blocks of size 2^( 6) =       0.001594734198
  error estimate for blocks of size 2^( 7) =       0.001607811921

      target function =                  N/A
              le_mean =     -22.325131066012
             les_mean =     502.174668170820
             stat err =       0.001586050965
             autocorr =       1.319267684648
              std dev =       1.952866802452
             le_variance =       3.813688748120


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232513106601e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325131065192       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325131068295       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325131068304       residual = 1.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+03 is 6.829152e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325131065192       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325131065967       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325131065970       residual = 1.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+04 is 1.707348e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325131065192       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325131065386       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325131065386       residual = 1.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+04 is 4.268408e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.062098 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9660e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187508e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605299e-02 3 1  ON 4
ci_006                 4.617156e-02 3 1  ON 5
ci_007                 3.181967e-02 3 1  ON 6
ci_008                 3.146823e-02 3 1  ON 7
ci_009                -2.501551e-02 3 1  ON 8
ci_010                -2.553485e-02 3 1  ON 9
ci_011                -2.290100e-02 3 1  ON 10
ci_012                -2.258353e-02 3 1  ON 11
ci_013                 2.001106e-02 3 1  ON 12
ci_014                 2.020477e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537432e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064007e-02 3 1  ON 18
ci_020                 1.044015e-02 3 1  ON 19
ci_021                -9.778796e-03 3 1  ON 20
ci_022                -9.436048e-03 3 1  ON 21
ci_023                 8.739996e-03 3 1  ON 22
ci_024                 9.497568e-03 3 1  ON 23
ci_025                 7.133681e-03 3 1  ON 24
ci_026                 8.150649e-03 3 1  ON 25
ci_027                 7.920675e-03 3 1  ON 26
ci_028                 7.855792e-03 3 1  ON 27
ci_029                -7.650191e-03 3 1  ON 28
ci_030                -7.775385e-03 3 1  ON 29
ci_031                -7.190616e-03 3 1  ON 30
ci_032                -7.557113e-03 3 1  ON 31
ci_033                 6.842355e-03 3 1  ON 32
ci_034                 6.312637e-03 3 1  ON 33
ci_035                 6.419779e-03 3 1  ON 34
ci_036                 6.977814e-03 3 1  ON 35
ci_037                 6.510536e-03 3 1  ON 36
ci_038                 5.592920e-03 3 1  ON 37
ci_039                 5.925448e-03 3 1  ON 38
ci_040                 6.143324e-03 3 1  ON 39
ci_041                 5.439199e-03 3 1  ON 40
ci_042                 5.123466e-03 3 1  ON 41
ci_043                 5.094829e-03 3 1  ON 42
ci_044                 4.423123e-03 3 1  ON 43
ci_045                 5.134247e-03 3 1  ON 44
ci_046                 5.270968e-03 3 1  ON 45
ci_047                -3.975275e-03 3 1  ON 46
ci_048                -4.391784e-03 3 1  ON 47
ci_049                 4.071046e-03 3 1  ON 48
ci_050                 3.474397e-03 3 1  ON 49
ci_051                -3.066911e-03 3 1  ON 50
ci_052                -2.182956e-03 3 1  ON 51
ci_053                -2.742367e-03 3 1  ON 52
ci_054                -3.472280e-03 3 1  ON 53
ci_055                -1.937691e-03 3 1  ON 54
ci_056                -2.005108e-03 3 1  ON 55
ci_057                -1.785127e-03 3 1  ON 56
ci_058                -1.819890e-03 3 1  ON 57
ci_059                -1.894076e-03 3 1  ON 58
ci_060                -2.083943e-03 3 1  ON 59
ci_061                -1.834594e-03 3 1  ON 60
ci_062                -1.924326e-03 3 1  ON 61
ci_063                -1.939869e-03 3 1  ON 62
ci_064                -9.369041e-04 3 1  ON 63
ci_065                -1.769465e-03 3 1  ON 64
ci_066                -1.408038e-03 3 1  ON 65
ci_067                -1.989747e-03 3 1  ON 66
ci_068                -1.522003e-03 3 1  ON 67
ci_069                 1.138817e-03 3 1  ON 68
ci_070                 1.595900e-03 3 1  ON 69
ci_071                 2.753869e-05 3 1  ON 70
ci_072                -2.335012e-04 3 1  ON 71
ci_073                 1.366616e-03 3 1  ON 72
ci_074                 8.865074e-04 3 1  ON 73
ci_075                -1.348855e-03 3 1  ON 74
ci_076                -7.319764e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.274
    reference variance = 4.00617
====================================================
  Execution time = 2.3165e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7112e+00
  Total weights = 1.9497e+06
  Execution time = 4.3670e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760790331384
                                         uncertainty =       0.026515281580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760790331384
                                         uncertainty =       0.026515281580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371216017
  error estimate for blocks of size 2^( 2) =       0.001442298089
  error estimate for blocks of size 2^( 3) =       0.001505783900
  error estimate for blocks of size 2^( 4) =       0.001547388579
  error estimate for blocks of size 2^( 5) =       0.001566208211
  error estimate for blocks of size 2^( 6) =       0.001580398131
  error estimate for blocks of size 2^( 7) =       0.001584738912

      target function =                  N/A
              le_mean =     -22.325777071090
             les_mean =     502.151526839962
             stat err =       0.001569683458
             autocorr =       1.310425718176
              std dev =       1.939223315689
             le_variance =       3.760587068112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760790317571
                                         uncertainty =       0.026515280788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760790317571
                                         uncertainty =       0.026515280788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371216015
  error estimate for blocks of size 2^( 2) =       0.001442298088
  error estimate for blocks of size 2^( 3) =       0.001505783898
  error estimate for blocks of size 2^( 4) =       0.001547388578
  error estimate for blocks of size 2^( 5) =       0.001566208208
  error estimate for blocks of size 2^( 6) =       0.001580398129
  error estimate for blocks of size 2^( 7) =       0.001584738908

      target function =                  N/A
              le_mean =     -22.325777070544
             les_mean =     502.151526751771
             stat err =       0.001569683456
             autocorr =       1.310425718518
              std dev =       1.939223312183
             le_variance =       3.760587054513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760790324478
                                         uncertainty =       0.026515281184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760790324478
                                         uncertainty =       0.026515281184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371216016
  error estimate for blocks of size 2^( 2) =       0.001442298089
  error estimate for blocks of size 2^( 3) =       0.001505783899
  error estimate for blocks of size 2^( 4) =       0.001547388579
  error estimate for blocks of size 2^( 5) =       0.001566208210
  error estimate for blocks of size 2^( 6) =       0.001580398130
  error estimate for blocks of size 2^( 7) =       0.001584738910

      target function =                  N/A
              le_mean =     -22.325777070817
             les_mean =     502.151526795813
             stat err =       0.001569683457
             autocorr =       1.310425718348
              std dev =       1.939223313936
             le_variance =       3.760587061312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760790330521
                                         uncertainty =       0.026515281531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760790330521
                                         uncertainty =       0.026515281531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371216017
  error estimate for blocks of size 2^( 2) =       0.001442298089
  error estimate for blocks of size 2^( 3) =       0.001505783899
  error estimate for blocks of size 2^( 4) =       0.001547388579
  error estimate for blocks of size 2^( 5) =       0.001566208211
  error estimate for blocks of size 2^( 6) =       0.001580398131
  error estimate for blocks of size 2^( 7) =       0.001584738912

      target function =                  N/A
              le_mean =     -22.325777071056
             les_mean =     502.151526834437
             stat err =       0.001569683458
             autocorr =       1.310425718197
              std dev =       1.939223315470
             le_variance =       3.760587067262


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325777071090        initial  <--
     6.1035e+03     6.1035e+04             6.8292e-08       -22.325777070544
     2.4414e+04     2.4414e+05             1.7073e-08       -22.325777070817
     9.7656e+04     9.7656e+05             4.2684e-09       -22.325777071056

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0988
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605300e-02 3 1  ON 4
ci_006                 4.617156e-02 3 1  ON 5
ci_007                 3.181968e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553487e-02 3 1  ON 9
ci_011                -2.290101e-02 3 1  ON 10
ci_012                -2.258352e-02 3 1  ON 11
ci_013                 2.001107e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537432e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064008e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778798e-03 3 1  ON 20
ci_022                -9.436051e-03 3 1  ON 21
ci_023                 8.739987e-03 3 1  ON 22
ci_024                 9.497584e-03 3 1  ON 23
ci_025                 7.133677e-03 3 1  ON 24
ci_026                 8.150646e-03 3 1  ON 25
ci_027                 7.920672e-03 3 1  ON 26
ci_028                 7.855786e-03 3 1  ON 27
ci_029                -7.650194e-03 3 1  ON 28
ci_030                -7.775380e-03 3 1  ON 29
ci_031                -7.190606e-03 3 1  ON 30
ci_032                -7.557115e-03 3 1  ON 31
ci_033                 6.842345e-03 3 1  ON 32
ci_034                 6.312630e-03 3 1  ON 33
ci_035                 6.419769e-03 3 1  ON 34
ci_036                 6.977822e-03 3 1  ON 35
ci_037                 6.510535e-03 3 1  ON 36
ci_038                 5.592920e-03 3 1  ON 37
ci_039                 5.925453e-03 3 1  ON 38
ci_040                 6.143332e-03 3 1  ON 39
ci_041                 5.439204e-03 3 1  ON 40
ci_042                 5.123463e-03 3 1  ON 41
ci_043                 5.094827e-03 3 1  ON 42
ci_044                 4.423121e-03 3 1  ON 43
ci_045                 5.134250e-03 3 1  ON 44
ci_046                 5.270976e-03 3 1  ON 45
ci_047                -3.975262e-03 3 1  ON 46
ci_048                -4.391774e-03 3 1  ON 47
ci_049                 4.071059e-03 3 1  ON 48
ci_050                 3.474394e-03 3 1  ON 49
ci_051                -3.066919e-03 3 1  ON 50
ci_052                -2.182961e-03 3 1  ON 51
ci_053                -2.742359e-03 3 1  ON 52
ci_054                -3.472292e-03 3 1  ON 53
ci_055                -1.937684e-03 3 1  ON 54
ci_056                -2.005108e-03 3 1  ON 55
ci_057                -1.785120e-03 3 1  ON 56
ci_058                -1.819900e-03 3 1  ON 57
ci_059                -1.894059e-03 3 1  ON 58
ci_060                -2.083946e-03 3 1  ON 59
ci_061                -1.834589e-03 3 1  ON 60
ci_062                -1.924330e-03 3 1  ON 61
ci_063                -1.939869e-03 3 1  ON 62
ci_064                -9.368953e-04 3 1  ON 63
ci_065                -1.769467e-03 3 1  ON 64
ci_066                -1.408035e-03 3 1  ON 65
ci_067                -1.989757e-03 3 1  ON 66
ci_068                -1.522011e-03 3 1  ON 67
ci_069                 1.138818e-03 3 1  ON 68
ci_070                 1.595899e-03 3 1  ON 69
ci_071                 2.755105e-05 3 1  ON 70
ci_072                -2.335043e-04 3 1  ON 71
ci_073                 1.366621e-03 3 1  ON 72
ci_074                 8.864998e-04 3 1  ON 73
ci_075                -1.348863e-03 3 1  ON 74
ci_076                -7.319704e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4766e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2320e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.3359
    reference variance = 4.16668
====================================================
  Execution time = 2.3864e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0302e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7115e+00
  Total weights = 1.949795553e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8038e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764000203900
                                         uncertainty =       0.032963472458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764000203900
                                         uncertainty =       0.032963472458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371888091
  error estimate for blocks of size 2^( 2) =       0.001443066082
  error estimate for blocks of size 2^( 3) =       0.001505063403
  error estimate for blocks of size 2^( 4) =       0.001548851207
  error estimate for blocks of size 2^( 5) =       0.001575857813
  error estimate for blocks of size 2^( 6) =       0.001589279533
  error estimate for blocks of size 2^( 7) =       0.001600479507

      target function =                  N/A
              le_mean =     -22.327286422048
             les_mean =     502.219212289945
             stat err =       0.001578617015
             autocorr =       1.324085979721
              std dev =       1.940173785907
             le_variance =       3.764274319522


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232728642205e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327286421253       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327286421519       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327286421522       residual = 7.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+04 is 7.887089e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327286421253       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327286421320       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327286421320       residual = 7.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+05 is 1.971777e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327286421253       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327286421270       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327286421270       residual = 7.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+05 is 4.929445e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063264 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9674e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605300e-02 3 1  ON 4
ci_006                 4.617156e-02 3 1  ON 5
ci_007                 3.181968e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553487e-02 3 1  ON 9
ci_011                -2.290101e-02 3 1  ON 10
ci_012                -2.258352e-02 3 1  ON 11
ci_013                 2.001107e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537432e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064008e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778798e-03 3 1  ON 20
ci_022                -9.436052e-03 3 1  ON 21
ci_023                 8.739987e-03 3 1  ON 22
ci_024                 9.497582e-03 3 1  ON 23
ci_025                 7.133677e-03 3 1  ON 24
ci_026                 8.150646e-03 3 1  ON 25
ci_027                 7.920674e-03 3 1  ON 26
ci_028                 7.855785e-03 3 1  ON 27
ci_029                -7.650194e-03 3 1  ON 28
ci_030                -7.775380e-03 3 1  ON 29
ci_031                -7.190606e-03 3 1  ON 30
ci_032                -7.557114e-03 3 1  ON 31
ci_033                 6.842345e-03 3 1  ON 32
ci_034                 6.312631e-03 3 1  ON 33
ci_035                 6.419769e-03 3 1  ON 34
ci_036                 6.977821e-03 3 1  ON 35
ci_037                 6.510533e-03 3 1  ON 36
ci_038                 5.592920e-03 3 1  ON 37
ci_039                 5.925453e-03 3 1  ON 38
ci_040                 6.143332e-03 3 1  ON 39
ci_041                 5.439204e-03 3 1  ON 40
ci_042                 5.123462e-03 3 1  ON 41
ci_043                 5.094828e-03 3 1  ON 42
ci_044                 4.423121e-03 3 1  ON 43
ci_045                 5.134249e-03 3 1  ON 44
ci_046                 5.270976e-03 3 1  ON 45
ci_047                -3.975263e-03 3 1  ON 46
ci_048                -4.391775e-03 3 1  ON 47
ci_049                 4.071059e-03 3 1  ON 48
ci_050                 3.474394e-03 3 1  ON 49
ci_051                -3.066918e-03 3 1  ON 50
ci_052                -2.182961e-03 3 1  ON 51
ci_053                -2.742359e-03 3 1  ON 52
ci_054                -3.472291e-03 3 1  ON 53
ci_055                -1.937683e-03 3 1  ON 54
ci_056                -2.005108e-03 3 1  ON 55
ci_057                -1.785120e-03 3 1  ON 56
ci_058                -1.819900e-03 3 1  ON 57
ci_059                -1.894059e-03 3 1  ON 58
ci_060                -2.083946e-03 3 1  ON 59
ci_061                -1.834589e-03 3 1  ON 60
ci_062                -1.924330e-03 3 1  ON 61
ci_063                -1.939868e-03 3 1  ON 62
ci_064                -9.368946e-04 3 1  ON 63
ci_065                -1.769467e-03 3 1  ON 64
ci_066                -1.408035e-03 3 1  ON 65
ci_067                -1.989756e-03 3 1  ON 66
ci_068                -1.522011e-03 3 1  ON 67
ci_069                 1.138819e-03 3 1  ON 68
ci_070                 1.595899e-03 3 1  ON 69
ci_071                 2.755017e-05 3 1  ON 70
ci_072                -2.335046e-04 3 1  ON 71
ci_073                 1.366620e-03 3 1  ON 72
ci_074                 8.865004e-04 3 1  ON 73
ci_075                -1.348861e-03 3 1  ON 74
ci_076                -7.319714e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.2836
    reference variance = 6.2904
====================================================
  Execution time = 2.3258e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6940e+00
  Total weights = 1.9494e+06
  Execution time = 4.3361e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747277427013
                                         uncertainty =       0.051409898557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747277427013
                                         uncertainty =       0.051409898557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368765044
  error estimate for blocks of size 2^( 2) =       0.001440132970
  error estimate for blocks of size 2^( 3) =       0.001502453362
  error estimate for blocks of size 2^( 4) =       0.001544818373
  error estimate for blocks of size 2^( 5) =       0.001568092242
  error estimate for blocks of size 2^( 6) =       0.001582199666
  error estimate for blocks of size 2^( 7) =       0.001583557633

      target function =                  N/A
              le_mean =     -22.327892564631
             les_mean =     502.228822884488
             stat err =       0.001569666979
             autocorr =       1.315095323256
              std dev =       1.935757059783
             le_variance =       3.747155394499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747277426442
                                         uncertainty =       0.051409898556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747277426442
                                         uncertainty =       0.051409898556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368765044
  error estimate for blocks of size 2^( 2) =       0.001440132969
  error estimate for blocks of size 2^( 3) =       0.001502453362
  error estimate for blocks of size 2^( 4) =       0.001544818373
  error estimate for blocks of size 2^( 5) =       0.001568092242
  error estimate for blocks of size 2^( 6) =       0.001582199666
  error estimate for blocks of size 2^( 7) =       0.001583557633

      target function =                  N/A
              le_mean =     -22.327892564667
             les_mean =     502.228822867148
             stat err =       0.001569666979
             autocorr =       1.315095323555
              std dev =       1.935757059636
             le_variance =       3.747155393930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747277426728
                                         uncertainty =       0.051409898557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747277426728
                                         uncertainty =       0.051409898557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368765044
  error estimate for blocks of size 2^( 2) =       0.001440132969
  error estimate for blocks of size 2^( 3) =       0.001502453362
  error estimate for blocks of size 2^( 4) =       0.001544818373
  error estimate for blocks of size 2^( 5) =       0.001568092242
  error estimate for blocks of size 2^( 6) =       0.001582199666
  error estimate for blocks of size 2^( 7) =       0.001583557633

      target function =                  N/A
              le_mean =     -22.327892564649
             les_mean =     502.228822875812
             stat err =       0.001569666979
             autocorr =       1.315095323404
              std dev =       1.935757059709
             le_variance =       3.747155394214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747277426977
                                         uncertainty =       0.051409898557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747277426977
                                         uncertainty =       0.051409898557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368765044
  error estimate for blocks of size 2^( 2) =       0.001440132970
  error estimate for blocks of size 2^( 3) =       0.001502453362
  error estimate for blocks of size 2^( 4) =       0.001544818373
  error estimate for blocks of size 2^( 5) =       0.001568092242
  error estimate for blocks of size 2^( 6) =       0.001582199666
  error estimate for blocks of size 2^( 7) =       0.001583557633

      target function =                  N/A
              le_mean =     -22.327892564633
             les_mean =     502.228822883403
             stat err =       0.001569666979
             autocorr =       1.315095323275
              std dev =       1.935757059773
             le_variance =       3.747155394463


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327892564631        initial
     6.1035e+04     6.1035e+05             7.8871e-09       -22.327892564667  <--
     2.4414e+05     2.4414e+06             1.9718e-09       -22.327892564649
     9.7656e+05     9.7656e+06             4.9294e-10       -22.327892564633

*****************************************************************************
Applying the update for shift_i =   6.1035e+04     and shift_s =   6.1035e+05
*****************************************************************************

  Execution time = 4.5029e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605301e-02 3 1  ON 4
ci_006                 4.617155e-02 3 1  ON 5
ci_007                 3.181968e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553487e-02 3 1  ON 9
ci_011                -2.290100e-02 3 1  ON 10
ci_012                -2.258353e-02 3 1  ON 11
ci_013                 2.001107e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537432e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064008e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778797e-03 3 1  ON 20
ci_022                -9.436056e-03 3 1  ON 21
ci_023                 8.739988e-03 3 1  ON 22
ci_024                 9.497577e-03 3 1  ON 23
ci_025                 7.133678e-03 3 1  ON 24
ci_026                 8.150646e-03 3 1  ON 25
ci_027                 7.920678e-03 3 1  ON 26
ci_028                 7.855784e-03 3 1  ON 27
ci_029                -7.650192e-03 3 1  ON 28
ci_030                -7.775379e-03 3 1  ON 29
ci_031                -7.190604e-03 3 1  ON 30
ci_032                -7.557112e-03 3 1  ON 31
ci_033                 6.842345e-03 3 1  ON 32
ci_034                 6.312636e-03 3 1  ON 33
ci_035                 6.419768e-03 3 1  ON 34
ci_036                 6.977817e-03 3 1  ON 35
ci_037                 6.510528e-03 3 1  ON 36
ci_038                 5.592920e-03 3 1  ON 37
ci_039                 5.925454e-03 3 1  ON 38
ci_040                 6.143332e-03 3 1  ON 39
ci_041                 5.439205e-03 3 1  ON 40
ci_042                 5.123461e-03 3 1  ON 41
ci_043                 5.094829e-03 3 1  ON 42
ci_044                 4.423120e-03 3 1  ON 43
ci_045                 5.134248e-03 3 1  ON 44
ci_046                 5.270974e-03 3 1  ON 45
ci_047                -3.975266e-03 3 1  ON 46
ci_048                -4.391776e-03 3 1  ON 47
ci_049                 4.071058e-03 3 1  ON 48
ci_050                 3.474394e-03 3 1  ON 49
ci_051                -3.066917e-03 3 1  ON 50
ci_052                -2.182961e-03 3 1  ON 51
ci_053                -2.742358e-03 3 1  ON 52
ci_054                -3.472290e-03 3 1  ON 53
ci_055                -1.937681e-03 3 1  ON 54
ci_056                -2.005108e-03 3 1  ON 55
ci_057                -1.785121e-03 3 1  ON 56
ci_058                -1.819900e-03 3 1  ON 57
ci_059                -1.894059e-03 3 1  ON 58
ci_060                -2.083944e-03 3 1  ON 59
ci_061                -1.834589e-03 3 1  ON 60
ci_062                -1.924331e-03 3 1  ON 61
ci_063                -1.939866e-03 3 1  ON 62
ci_064                -9.368923e-04 3 1  ON 63
ci_065                -1.769468e-03 3 1  ON 64
ci_066                -1.408037e-03 3 1  ON 65
ci_067                -1.989752e-03 3 1  ON 66
ci_068                -1.522012e-03 3 1  ON 67
ci_069                 1.138822e-03 3 1  ON 68
ci_070                 1.595897e-03 3 1  ON 69
ci_071                 2.754754e-05 3 1  ON 70
ci_072                -2.335055e-04 3 1  ON 71
ci_073                 1.366620e-03 3 1  ON 72
ci_074                 8.865019e-04 3 1  ON 73
ci_075                -1.348855e-03 3 1  ON 74
ci_076                -7.319742e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4710e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2320e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.3056
    reference variance = 3.76125
====================================================
  Execution time = 2.5773e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0285e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7258e+00
  Total weights = 1.949858702e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8355e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777186627006
                                         uncertainty =       0.042859242033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777186627006
                                         uncertainty =       0.042859242033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374320349
  error estimate for blocks of size 2^( 2) =       0.001446556040
  error estimate for blocks of size 2^( 3) =       0.001510141146
  error estimate for blocks of size 2^( 4) =       0.001555669252
  error estimate for blocks of size 2^( 5) =       0.001579164873
  error estimate for blocks of size 2^( 6) =       0.001589808079
  error estimate for blocks of size 2^( 7) =       0.001596871297

      target function =                  N/A
              le_mean =     -22.329043960532
             les_mean =     502.311970939054
             stat err =       0.001580378375
             autocorr =       1.322349341378
              std dev =       1.943613572967
             le_variance =       3.777633721021


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232904396053e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329043959713       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329043961071       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329043961084       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+04 is 3.314635e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329043959713       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329043960053       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329043960056       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+04 is 8.286714e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329043959713       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329043959798       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329043959799       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+05 is 2.071686e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064453 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1615e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235963e-02 3 1  ON 3
ci_005                 4.605300e-02 3 1  ON 4
ci_006                 4.617155e-02 3 1  ON 5
ci_007                 3.181968e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553486e-02 3 1  ON 9
ci_011                -2.290100e-02 3 1  ON 10
ci_012                -2.258352e-02 3 1  ON 11
ci_013                 2.001106e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537432e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064007e-02 3 1  ON 18
ci_020                 1.044013e-02 3 1  ON 19
ci_021                -9.778797e-03 3 1  ON 20
ci_022                -9.436056e-03 3 1  ON 21
ci_023                 8.739989e-03 3 1  ON 22
ci_024                 9.497575e-03 3 1  ON 23
ci_025                 7.133682e-03 3 1  ON 24
ci_026                 8.150646e-03 3 1  ON 25
ci_027                 7.920684e-03 3 1  ON 26
ci_028                 7.855779e-03 3 1  ON 27
ci_029                -7.650193e-03 3 1  ON 28
ci_030                -7.775381e-03 3 1  ON 29
ci_031                -7.190605e-03 3 1  ON 30
ci_032                -7.557110e-03 3 1  ON 31
ci_033                 6.842346e-03 3 1  ON 32
ci_034                 6.312640e-03 3 1  ON 33
ci_035                 6.419772e-03 3 1  ON 34
ci_036                 6.977817e-03 3 1  ON 35
ci_037                 6.510529e-03 3 1  ON 36
ci_038                 5.592917e-03 3 1  ON 37
ci_039                 5.925454e-03 3 1  ON 38
ci_040                 6.143332e-03 3 1  ON 39
ci_041                 5.439200e-03 3 1  ON 40
ci_042                 5.123464e-03 3 1  ON 41
ci_043                 5.094831e-03 3 1  ON 42
ci_044                 4.423116e-03 3 1  ON 43
ci_045                 5.134247e-03 3 1  ON 44
ci_046                 5.270977e-03 3 1  ON 45
ci_047                -3.975275e-03 3 1  ON 46
ci_048                -4.391775e-03 3 1  ON 47
ci_049                 4.071055e-03 3 1  ON 48
ci_050                 3.474393e-03 3 1  ON 49
ci_051                -3.066917e-03 3 1  ON 50
ci_052                -2.182959e-03 3 1  ON 51
ci_053                -2.742356e-03 3 1  ON 52
ci_054                -3.472289e-03 3 1  ON 53
ci_055                -1.937683e-03 3 1  ON 54
ci_056                -2.005111e-03 3 1  ON 55
ci_057                -1.785120e-03 3 1  ON 56
ci_058                -1.819903e-03 3 1  ON 57
ci_059                -1.894061e-03 3 1  ON 58
ci_060                -2.083949e-03 3 1  ON 59
ci_061                -1.834591e-03 3 1  ON 60
ci_062                -1.924327e-03 3 1  ON 61
ci_063                -1.939864e-03 3 1  ON 62
ci_064                -9.368940e-04 3 1  ON 63
ci_065                -1.769465e-03 3 1  ON 64
ci_066                -1.408038e-03 3 1  ON 65
ci_067                -1.989749e-03 3 1  ON 66
ci_068                -1.522013e-03 3 1  ON 67
ci_069                 1.138823e-03 3 1  ON 68
ci_070                 1.595898e-03 3 1  ON 69
ci_071                 2.754478e-05 3 1  ON 70
ci_072                -2.335104e-04 3 1  ON 71
ci_073                 1.366619e-03 3 1  ON 72
ci_074                 8.865101e-04 3 1  ON 73
ci_075                -1.348853e-03 3 1  ON 74
ci_076                -7.319754e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.3871
    reference variance = 2.40212
====================================================
  Execution time = 2.3195e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7231e+00
  Total weights = 1.9501e+06
  Execution time = 4.3562e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773670481775
                                         uncertainty =       0.044392481068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773670481775
                                         uncertainty =       0.044392481068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373411233
  error estimate for blocks of size 2^( 2) =       0.001444044816
  error estimate for blocks of size 2^( 3) =       0.001506599001
  error estimate for blocks of size 2^( 4) =       0.001550832334
  error estimate for blocks of size 2^( 5) =       0.001576414471
  error estimate for blocks of size 2^( 6) =       0.001585417585
  error estimate for blocks of size 2^( 7) =       0.001592653868

      target function =                  N/A
              le_mean =     -22.327613754050
             les_mean =     502.245417267032
             stat err =       0.001576329564
             autocorr =       1.317324750084
              std dev =       1.942327869041
             le_variance =       3.772637550853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773670469817
                                         uncertainty =       0.044392480776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773670469817
                                         uncertainty =       0.044392480776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373411231
  error estimate for blocks of size 2^( 2) =       0.001444044814
  error estimate for blocks of size 2^( 3) =       0.001506598999
  error estimate for blocks of size 2^( 4) =       0.001550832332
  error estimate for blocks of size 2^( 5) =       0.001576414470
  error estimate for blocks of size 2^( 6) =       0.001585417584
  error estimate for blocks of size 2^( 7) =       0.001592653867

      target function =                  N/A
              le_mean =     -22.327613753900
             les_mean =     502.245417250678
             stat err =       0.001576329563
             autocorr =       1.317324752687
              std dev =       1.942327865975
             le_variance =       3.772637538943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773670475796
                                         uncertainty =       0.044392480922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773670475796
                                         uncertainty =       0.044392480922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373411232
  error estimate for blocks of size 2^( 2) =       0.001444044815
  error estimate for blocks of size 2^( 3) =       0.001506599000
  error estimate for blocks of size 2^( 4) =       0.001550832333
  error estimate for blocks of size 2^( 5) =       0.001576414470
  error estimate for blocks of size 2^( 6) =       0.001585417585
  error estimate for blocks of size 2^( 7) =       0.001592653868

      target function =                  N/A
              le_mean =     -22.327613753975
             les_mean =     502.245417258853
             stat err =       0.001576329564
             autocorr =       1.317324751386
              std dev =       1.942327867508
             le_variance =       3.772637544898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773670481028
                                         uncertainty =       0.044392481050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773670481028
                                         uncertainty =       0.044392481050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373411233
  error estimate for blocks of size 2^( 2) =       0.001444044816
  error estimate for blocks of size 2^( 3) =       0.001506599000
  error estimate for blocks of size 2^( 4) =       0.001550832334
  error estimate for blocks of size 2^( 5) =       0.001576414471
  error estimate for blocks of size 2^( 6) =       0.001585417585
  error estimate for blocks of size 2^( 7) =       0.001592653868

      target function =                  N/A
              le_mean =     -22.327613754041
             les_mean =     502.245417266009
             stat err =       0.001576329564
             autocorr =       1.317324750248
              std dev =       1.942327868849
             le_variance =       3.772637550109


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327613754050        initial  <--
     1.5259e+04     1.5259e+05             3.3146e-08       -22.327613753900
     6.1035e+04     6.1035e+05             8.2867e-09       -22.327613753975
     2.4414e+05     2.4414e+06             2.0717e-09       -22.327613754041

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0553
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605301e-02 3 1  ON 4
ci_006                 4.617155e-02 3 1  ON 5
ci_007                 3.181968e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553487e-02 3 1  ON 9
ci_011                -2.290100e-02 3 1  ON 10
ci_012                -2.258353e-02 3 1  ON 11
ci_013                 2.001107e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537432e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064008e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778797e-03 3 1  ON 20
ci_022                -9.436056e-03 3 1  ON 21
ci_023                 8.739988e-03 3 1  ON 22
ci_024                 9.497577e-03 3 1  ON 23
ci_025                 7.133678e-03 3 1  ON 24
ci_026                 8.150646e-03 3 1  ON 25
ci_027                 7.920678e-03 3 1  ON 26
ci_028                 7.855784e-03 3 1  ON 27
ci_029                -7.650192e-03 3 1  ON 28
ci_030                -7.775379e-03 3 1  ON 29
ci_031                -7.190604e-03 3 1  ON 30
ci_032                -7.557112e-03 3 1  ON 31
ci_033                 6.842345e-03 3 1  ON 32
ci_034                 6.312636e-03 3 1  ON 33
ci_035                 6.419768e-03 3 1  ON 34
ci_036                 6.977817e-03 3 1  ON 35
ci_037                 6.510528e-03 3 1  ON 36
ci_038                 5.592920e-03 3 1  ON 37
ci_039                 5.925454e-03 3 1  ON 38
ci_040                 6.143332e-03 3 1  ON 39
ci_041                 5.439205e-03 3 1  ON 40
ci_042                 5.123461e-03 3 1  ON 41
ci_043                 5.094829e-03 3 1  ON 42
ci_044                 4.423120e-03 3 1  ON 43
ci_045                 5.134248e-03 3 1  ON 44
ci_046                 5.270974e-03 3 1  ON 45
ci_047                -3.975266e-03 3 1  ON 46
ci_048                -4.391776e-03 3 1  ON 47
ci_049                 4.071058e-03 3 1  ON 48
ci_050                 3.474394e-03 3 1  ON 49
ci_051                -3.066917e-03 3 1  ON 50
ci_052                -2.182961e-03 3 1  ON 51
ci_053                -2.742358e-03 3 1  ON 52
ci_054                -3.472290e-03 3 1  ON 53
ci_055                -1.937681e-03 3 1  ON 54
ci_056                -2.005108e-03 3 1  ON 55
ci_057                -1.785121e-03 3 1  ON 56
ci_058                -1.819900e-03 3 1  ON 57
ci_059                -1.894059e-03 3 1  ON 58
ci_060                -2.083944e-03 3 1  ON 59
ci_061                -1.834589e-03 3 1  ON 60
ci_062                -1.924331e-03 3 1  ON 61
ci_063                -1.939866e-03 3 1  ON 62
ci_064                -9.368923e-04 3 1  ON 63
ci_065                -1.769468e-03 3 1  ON 64
ci_066                -1.408037e-03 3 1  ON 65
ci_067                -1.989752e-03 3 1  ON 66
ci_068                -1.522012e-03 3 1  ON 67
ci_069                 1.138822e-03 3 1  ON 68
ci_070                 1.595897e-03 3 1  ON 69
ci_071                 2.754754e-05 3 1  ON 70
ci_072                -2.335055e-04 3 1  ON 71
ci_073                 1.366620e-03 3 1  ON 72
ci_074                 8.865019e-04 3 1  ON 73
ci_075                -1.348855e-03 3 1  ON 74
ci_076                -7.319742e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6680e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2321e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.1447
    reference variance = 2.96192
====================================================
  Execution time = 2.3752e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0279e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6752e+00
  Total weights = 1.949977657e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8273e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.724314674843
                                         uncertainty =       0.029586251856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.724314674843
                                         uncertainty =       0.029586251856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364616640
  error estimate for blocks of size 2^( 2) =       0.001435717522
  error estimate for blocks of size 2^( 3) =       0.001498634060
  error estimate for blocks of size 2^( 4) =       0.001541724020
  error estimate for blocks of size 2^( 5) =       0.001567686902
  error estimate for blocks of size 2^( 6) =       0.001580302305
  error estimate for blocks of size 2^( 7) =       0.001588824174

      target function =                  N/A
              le_mean =     -22.330399511772
             les_mean =     502.321981838660
             stat err =       0.001569634350
             autocorr =       1.323048191581
              std dev =       1.929890236599
             le_variance =       3.724476325321


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233039951177e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330399511014       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330399511146       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330399511147       residual = 6.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+05 is 3.206536e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330399511014       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330399511047       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330399511047       residual = 6.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+05 is 8.016345e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330399511014       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330399511022       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330399511022       residual = 6.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+06 is 2.004087e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065662 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9586e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605301e-02 3 1  ON 4
ci_006                 4.617155e-02 3 1  ON 5
ci_007                 3.181968e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553487e-02 3 1  ON 9
ci_011                -2.290100e-02 3 1  ON 10
ci_012                -2.258353e-02 3 1  ON 11
ci_013                 2.001107e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537432e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064008e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778797e-03 3 1  ON 20
ci_022                -9.436056e-03 3 1  ON 21
ci_023                 8.739988e-03 3 1  ON 22
ci_024                 9.497577e-03 3 1  ON 23
ci_025                 7.133678e-03 3 1  ON 24
ci_026                 8.150645e-03 3 1  ON 25
ci_027                 7.920677e-03 3 1  ON 26
ci_028                 7.855784e-03 3 1  ON 27
ci_029                -7.650192e-03 3 1  ON 28
ci_030                -7.775379e-03 3 1  ON 29
ci_031                -7.190604e-03 3 1  ON 30
ci_032                -7.557112e-03 3 1  ON 31
ci_033                 6.842345e-03 3 1  ON 32
ci_034                 6.312635e-03 3 1  ON 33
ci_035                 6.419769e-03 3 1  ON 34
ci_036                 6.977817e-03 3 1  ON 35
ci_037                 6.510528e-03 3 1  ON 36
ci_038                 5.592920e-03 3 1  ON 37
ci_039                 5.925453e-03 3 1  ON 38
ci_040                 6.143332e-03 3 1  ON 39
ci_041                 5.439205e-03 3 1  ON 40
ci_042                 5.123460e-03 3 1  ON 41
ci_043                 5.094829e-03 3 1  ON 42
ci_044                 4.423120e-03 3 1  ON 43
ci_045                 5.134248e-03 3 1  ON 44
ci_046                 5.270974e-03 3 1  ON 45
ci_047                -3.975267e-03 3 1  ON 46
ci_048                -4.391775e-03 3 1  ON 47
ci_049                 4.071057e-03 3 1  ON 48
ci_050                 3.474394e-03 3 1  ON 49
ci_051                -3.066917e-03 3 1  ON 50
ci_052                -2.182961e-03 3 1  ON 51
ci_053                -2.742358e-03 3 1  ON 52
ci_054                -3.472290e-03 3 1  ON 53
ci_055                -1.937682e-03 3 1  ON 54
ci_056                -2.005108e-03 3 1  ON 55
ci_057                -1.785120e-03 3 1  ON 56
ci_058                -1.819900e-03 3 1  ON 57
ci_059                -1.894060e-03 3 1  ON 58
ci_060                -2.083944e-03 3 1  ON 59
ci_061                -1.834589e-03 3 1  ON 60
ci_062                -1.924331e-03 3 1  ON 61
ci_063                -1.939866e-03 3 1  ON 62
ci_064                -9.368926e-04 3 1  ON 63
ci_065                -1.769468e-03 3 1  ON 64
ci_066                -1.408037e-03 3 1  ON 65
ci_067                -1.989752e-03 3 1  ON 66
ci_068                -1.522012e-03 3 1  ON 67
ci_069                 1.138822e-03 3 1  ON 68
ci_070                 1.595897e-03 3 1  ON 69
ci_071                 2.754734e-05 3 1  ON 70
ci_072                -2.335060e-04 3 1  ON 71
ci_073                 1.366620e-03 3 1  ON 72
ci_074                 8.865021e-04 3 1  ON 73
ci_075                -1.348855e-03 3 1  ON 74
ci_076                -7.319746e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.1994
    reference variance = 3.97017
====================================================
  Execution time = 2.3236e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7250e+00
  Total weights = 1.9497e+06
  Execution time = 4.3501e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778682572594
                                         uncertainty =       0.038329574910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778682572594
                                         uncertainty =       0.038329574910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374474573
  error estimate for blocks of size 2^( 2) =       0.001445609369
  error estimate for blocks of size 2^( 3) =       0.001508893947
  error estimate for blocks of size 2^( 4) =       0.001553514767
  error estimate for blocks of size 2^( 5) =       0.001578116587
  error estimate for blocks of size 2^( 6) =       0.001596701922
  error estimate for blocks of size 2^( 7) =       0.001594538545

      target function =                  N/A
              le_mean =     -22.328855602766
             les_mean =     502.302745222002
             stat err =       0.001580717955
             autocorr =       1.322620813345
              std dev =       1.943831683041
             le_variance =       3.778481611993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778682572332
                                         uncertainty =       0.038329574910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778682572332
                                         uncertainty =       0.038329574910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374474573
  error estimate for blocks of size 2^( 2) =       0.001445609369
  error estimate for blocks of size 2^( 3) =       0.001508893947
  error estimate for blocks of size 2^( 4) =       0.001553514767
  error estimate for blocks of size 2^( 5) =       0.001578116587
  error estimate for blocks of size 2^( 6) =       0.001596701922
  error estimate for blocks of size 2^( 7) =       0.001594538545

      target function =                  N/A
              le_mean =     -22.328855602785
             les_mean =     502.302745223177
             stat err =       0.001580717955
             autocorr =       1.322620813417
              std dev =       1.943831682973
             le_variance =       3.778481611731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778682572463
                                         uncertainty =       0.038329574910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778682572463
                                         uncertainty =       0.038329574910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374474573
  error estimate for blocks of size 2^( 2) =       0.001445609369
  error estimate for blocks of size 2^( 3) =       0.001508893947
  error estimate for blocks of size 2^( 4) =       0.001553514767
  error estimate for blocks of size 2^( 5) =       0.001578116587
  error estimate for blocks of size 2^( 6) =       0.001596701922
  error estimate for blocks of size 2^( 7) =       0.001594538545

      target function =                  N/A
              le_mean =     -22.328855602776
             les_mean =     502.302745222589
             stat err =       0.001580717955
             autocorr =       1.322620813381
              std dev =       1.943831683007
             le_variance =       3.778481611862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778682572578
                                         uncertainty =       0.038329574910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778682572578
                                         uncertainty =       0.038329574910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374474573
  error estimate for blocks of size 2^( 2) =       0.001445609369
  error estimate for blocks of size 2^( 3) =       0.001508893947
  error estimate for blocks of size 2^( 4) =       0.001553514767
  error estimate for blocks of size 2^( 5) =       0.001578116587
  error estimate for blocks of size 2^( 6) =       0.001596701922
  error estimate for blocks of size 2^( 7) =       0.001594538545

      target function =                  N/A
              le_mean =     -22.328855602767
             les_mean =     502.302745222075
             stat err =       0.001580717955
             autocorr =       1.322620813351
              std dev =       1.943831683037
             le_variance =       3.778481611977


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328855602766        initial
     1.5259e+05     1.5259e+06             3.2065e-09       -22.328855602785  <--
     6.1035e+05     6.1035e+06             8.0163e-10       -22.328855602776
     2.4414e+06     2.4414e+07             2.0041e-10       -22.328855602767

*****************************************************************************
Applying the update for shift_i =   1.5259e+05     and shift_s =   1.5259e+06
*****************************************************************************

  Execution time = 4.5074e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605301e-02 3 1  ON 4
ci_006                 4.617155e-02 3 1  ON 5
ci_007                 3.181968e-02 3 1  ON 6
ci_008                 3.146822e-02 3 1  ON 7
ci_009                -2.501551e-02 3 1  ON 8
ci_010                -2.553486e-02 3 1  ON 9
ci_011                -2.290100e-02 3 1  ON 10
ci_012                -2.258353e-02 3 1  ON 11
ci_013                 2.001107e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537432e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064008e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778796e-03 3 1  ON 20
ci_022                -9.436057e-03 3 1  ON 21
ci_023                 8.739988e-03 3 1  ON 22
ci_024                 9.497576e-03 3 1  ON 23
ci_025                 7.133677e-03 3 1  ON 24
ci_026                 8.150645e-03 3 1  ON 25
ci_027                 7.920676e-03 3 1  ON 26
ci_028                 7.855785e-03 3 1  ON 27
ci_029                -7.650192e-03 3 1  ON 28
ci_030                -7.775379e-03 3 1  ON 29
ci_031                -7.190603e-03 3 1  ON 30
ci_032                -7.557111e-03 3 1  ON 31
ci_033                 6.842345e-03 3 1  ON 32
ci_034                 6.312635e-03 3 1  ON 33
ci_035                 6.419769e-03 3 1  ON 34
ci_036                 6.977818e-03 3 1  ON 35
ci_037                 6.510528e-03 3 1  ON 36
ci_038                 5.592920e-03 3 1  ON 37
ci_039                 5.925453e-03 3 1  ON 38
ci_040                 6.143331e-03 3 1  ON 39
ci_041                 5.439204e-03 3 1  ON 40
ci_042                 5.123460e-03 3 1  ON 41
ci_043                 5.094829e-03 3 1  ON 42
ci_044                 4.423121e-03 3 1  ON 43
ci_045                 5.134247e-03 3 1  ON 44
ci_046                 5.270974e-03 3 1  ON 45
ci_047                -3.975267e-03 3 1  ON 46
ci_048                -4.391774e-03 3 1  ON 47
ci_049                 4.071057e-03 3 1  ON 48
ci_050                 3.474394e-03 3 1  ON 49
ci_051                -3.066916e-03 3 1  ON 50
ci_052                -2.182961e-03 3 1  ON 51
ci_053                -2.742358e-03 3 1  ON 52
ci_054                -3.472290e-03 3 1  ON 53
ci_055                -1.937685e-03 3 1  ON 54
ci_056                -2.005107e-03 3 1  ON 55
ci_057                -1.785119e-03 3 1  ON 56
ci_058                -1.819899e-03 3 1  ON 57
ci_059                -1.894060e-03 3 1  ON 58
ci_060                -2.083943e-03 3 1  ON 59
ci_061                -1.834588e-03 3 1  ON 60
ci_062                -1.924330e-03 3 1  ON 61
ci_063                -1.939865e-03 3 1  ON 62
ci_064                -9.368934e-04 3 1  ON 63
ci_065                -1.769469e-03 3 1  ON 64
ci_066                -1.408038e-03 3 1  ON 65
ci_067                -1.989752e-03 3 1  ON 66
ci_068                -1.522012e-03 3 1  ON 67
ci_069                 1.138823e-03 3 1  ON 68
ci_070                 1.595897e-03 3 1  ON 69
ci_071                 2.754674e-05 3 1  ON 70
ci_072                -2.335072e-04 3 1  ON 71
ci_073                 1.366620e-03 3 1  ON 72
ci_074                 8.865025e-04 3 1  ON 73
ci_075                -1.348855e-03 3 1  ON 74
ci_076                -7.319757e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4668e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2315e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -21.9934
    reference variance = 2.50949
====================================================
  Execution time = 2.3789e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0292e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7798e+00
  Total weights = 1.949931068e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9039e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.833215226095
                                         uncertainty =       0.075806232089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.833215226095
                                         uncertainty =       0.075806232089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001384199450
  error estimate for blocks of size 2^( 2) =       0.001456043250
  error estimate for blocks of size 2^( 3) =       0.001520262485
  error estimate for blocks of size 2^( 4) =       0.001562955102
  error estimate for blocks of size 2^( 5) =       0.001585545747
  error estimate for blocks of size 2^( 6) =       0.001604993452
  error estimate for blocks of size 2^( 7) =       0.001616996612

      target function =                  N/A
              le_mean =     -22.327895071258
             les_mean =     502.314703586521
             stat err =       0.001592622728
             autocorr =       1.323818585047
              std dev =       1.957584955826
             le_variance =       3.832138859278


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232789507126e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327895070440       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327895071034       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327895071039       residual = 1.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+04 is 1.260585e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327895070440       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327895070588       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327895070589       residual = 1.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+05 is 3.151474e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327895070440       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327895070477       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327895070477       residual = 1.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+05 is 7.878691e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.066867 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9699e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605301e-02 3 1  ON 4
ci_006                 4.617155e-02 3 1  ON 5
ci_007                 3.181968e-02 3 1  ON 6
ci_008                 3.146822e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553486e-02 3 1  ON 9
ci_011                -2.290100e-02 3 1  ON 10
ci_012                -2.258353e-02 3 1  ON 11
ci_013                 2.001107e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537432e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064007e-02 3 1  ON 18
ci_020                 1.044013e-02 3 1  ON 19
ci_021                -9.778796e-03 3 1  ON 20
ci_022                -9.436057e-03 3 1  ON 21
ci_023                 8.739989e-03 3 1  ON 22
ci_024                 9.497576e-03 3 1  ON 23
ci_025                 7.133677e-03 3 1  ON 24
ci_026                 8.150645e-03 3 1  ON 25
ci_027                 7.920677e-03 3 1  ON 26
ci_028                 7.855785e-03 3 1  ON 27
ci_029                -7.650191e-03 3 1  ON 28
ci_030                -7.775379e-03 3 1  ON 29
ci_031                -7.190602e-03 3 1  ON 30
ci_032                -7.557110e-03 3 1  ON 31
ci_033                 6.842344e-03 3 1  ON 32
ci_034                 6.312636e-03 3 1  ON 33
ci_035                 6.419771e-03 3 1  ON 34
ci_036                 6.977818e-03 3 1  ON 35
ci_037                 6.510526e-03 3 1  ON 36
ci_038                 5.592921e-03 3 1  ON 37
ci_039                 5.925451e-03 3 1  ON 38
ci_040                 6.143330e-03 3 1  ON 39
ci_041                 5.439203e-03 3 1  ON 40
ci_042                 5.123460e-03 3 1  ON 41
ci_043                 5.094826e-03 3 1  ON 42
ci_044                 4.423121e-03 3 1  ON 43
ci_045                 5.134248e-03 3 1  ON 44
ci_046                 5.270975e-03 3 1  ON 45
ci_047                -3.975269e-03 3 1  ON 46
ci_048                -4.391776e-03 3 1  ON 47
ci_049                 4.071057e-03 3 1  ON 48
ci_050                 3.474393e-03 3 1  ON 49
ci_051                -3.066916e-03 3 1  ON 50
ci_052                -2.182961e-03 3 1  ON 51
ci_053                -2.742359e-03 3 1  ON 52
ci_054                -3.472288e-03 3 1  ON 53
ci_055                -1.937687e-03 3 1  ON 54
ci_056                -2.005108e-03 3 1  ON 55
ci_057                -1.785119e-03 3 1  ON 56
ci_058                -1.819901e-03 3 1  ON 57
ci_059                -1.894059e-03 3 1  ON 58
ci_060                -2.083940e-03 3 1  ON 59
ci_061                -1.834589e-03 3 1  ON 60
ci_062                -1.924330e-03 3 1  ON 61
ci_063                -1.939866e-03 3 1  ON 62
ci_064                -9.368924e-04 3 1  ON 63
ci_065                -1.769469e-03 3 1  ON 64
ci_066                -1.408037e-03 3 1  ON 65
ci_067                -1.989751e-03 3 1  ON 66
ci_068                -1.522011e-03 3 1  ON 67
ci_069                 1.138823e-03 3 1  ON 68
ci_070                 1.595896e-03 3 1  ON 69
ci_071                 2.754566e-05 3 1  ON 70
ci_072                -2.335103e-04 3 1  ON 71
ci_073                 1.366618e-03 3 1  ON 72
ci_074                 8.865045e-04 3 1  ON 73
ci_075                -1.348857e-03 3 1  ON 74
ci_076                -7.319758e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -21.9131
    reference variance = 11.5535
====================================================
  Execution time = 2.3150e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7606e+00
  Total weights = 1.9499e+06
  Execution time = 4.3635e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813953208958
                                         uncertainty =       0.042862670623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813953208958
                                         uncertainty =       0.042862670623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380832011
  error estimate for blocks of size 2^( 2) =       0.001450308217
  error estimate for blocks of size 2^( 3) =       0.001514112838
  error estimate for blocks of size 2^( 4) =       0.001557958246
  error estimate for blocks of size 2^( 5) =       0.001585806681
  error estimate for blocks of size 2^( 6) =       0.001593549197
  error estimate for blocks of size 2^( 7) =       0.001597834364

      target function =                  N/A
              le_mean =     -22.325549967783
             les_mean =     502.190799987036
             stat err =       0.001583787122
             autocorr =       1.315563822058
              std dev =       1.952822601437
             le_variance =       3.813516112682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813953206868
                                         uncertainty =       0.042862670493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813953206868
                                         uncertainty =       0.042862670493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380832010
  error estimate for blocks of size 2^( 2) =       0.001450308217
  error estimate for blocks of size 2^( 3) =       0.001514112838
  error estimate for blocks of size 2^( 4) =       0.001557958246
  error estimate for blocks of size 2^( 5) =       0.001585806682
  error estimate for blocks of size 2^( 6) =       0.001593549197
  error estimate for blocks of size 2^( 7) =       0.001597834366

      target function =                  N/A
              le_mean =     -22.325549967858
             les_mean =     502.190799987247
             stat err =       0.001583787123
             autocorr =       1.315563823831
              std dev =       1.952822600904
             le_variance =       3.813516110601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813953207913
                                         uncertainty =       0.042862670558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813953207913
                                         uncertainty =       0.042862670558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380832011
  error estimate for blocks of size 2^( 2) =       0.001450308217
  error estimate for blocks of size 2^( 3) =       0.001514112838
  error estimate for blocks of size 2^( 4) =       0.001557958246
  error estimate for blocks of size 2^( 5) =       0.001585806682
  error estimate for blocks of size 2^( 6) =       0.001593549197
  error estimate for blocks of size 2^( 7) =       0.001597834365

      target function =                  N/A
              le_mean =     -22.325549967821
             les_mean =     502.190799987142
             stat err =       0.001583787122
             autocorr =       1.315563822943
              std dev =       1.952822601170
             le_variance =       3.813516111642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813953208827
                                         uncertainty =       0.042862670615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813953208827
                                         uncertainty =       0.042862670615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380832011
  error estimate for blocks of size 2^( 2) =       0.001450308217
  error estimate for blocks of size 2^( 3) =       0.001514112838
  error estimate for blocks of size 2^( 4) =       0.001557958246
  error estimate for blocks of size 2^( 5) =       0.001585806681
  error estimate for blocks of size 2^( 6) =       0.001593549197
  error estimate for blocks of size 2^( 7) =       0.001597834365

      target function =                  N/A
              le_mean =     -22.325549967788
             les_mean =     502.190799987049
             stat err =       0.001583787122
             autocorr =       1.315563822170
              std dev =       1.952822601403
             le_variance =       3.813516112552


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325549967783        initial
     3.8147e+04     3.8147e+05             1.2606e-08       -22.325549967858  <--
     1.5259e+05     1.5259e+06             3.1515e-09       -22.325549967821
     6.1035e+05     6.1035e+06             7.8787e-10       -22.325549967788

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 4.5083e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187508e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605300e-02 3 1  ON 4
ci_006                 4.617156e-02 3 1  ON 5
ci_007                 3.181967e-02 3 1  ON 6
ci_008                 3.146822e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553486e-02 3 1  ON 9
ci_011                -2.290100e-02 3 1  ON 10
ci_012                -2.258353e-02 3 1  ON 11
ci_013                 2.001107e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.075004e-02 3 1  ON 15
ci_017                 1.537431e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064007e-02 3 1  ON 18
ci_020                 1.044013e-02 3 1  ON 19
ci_021                -9.778794e-03 3 1  ON 20
ci_022                -9.436055e-03 3 1  ON 21
ci_023                 8.739991e-03 3 1  ON 22
ci_024                 9.497576e-03 3 1  ON 23
ci_025                 7.133676e-03 3 1  ON 24
ci_026                 8.150647e-03 3 1  ON 25
ci_027                 7.920678e-03 3 1  ON 26
ci_028                 7.855783e-03 3 1  ON 27
ci_029                -7.650188e-03 3 1  ON 28
ci_030                -7.775378e-03 3 1  ON 29
ci_031                -7.190598e-03 3 1  ON 30
ci_032                -7.557106e-03 3 1  ON 31
ci_033                 6.842342e-03 3 1  ON 32
ci_034                 6.312641e-03 3 1  ON 33
ci_035                 6.419777e-03 3 1  ON 34
ci_036                 6.977819e-03 3 1  ON 35
ci_037                 6.510521e-03 3 1  ON 36
ci_038                 5.592923e-03 3 1  ON 37
ci_039                 5.925447e-03 3 1  ON 38
ci_040                 6.143327e-03 3 1  ON 39
ci_041                 5.439198e-03 3 1  ON 40
ci_042                 5.123459e-03 3 1  ON 41
ci_043                 5.094816e-03 3 1  ON 42
ci_044                 4.423119e-03 3 1  ON 43
ci_045                 5.134252e-03 3 1  ON 44
ci_046                 5.270980e-03 3 1  ON 45
ci_047                -3.975275e-03 3 1  ON 46
ci_048                -4.391781e-03 3 1  ON 47
ci_049                 4.071056e-03 3 1  ON 48
ci_050                 3.474390e-03 3 1  ON 49
ci_051                -3.066918e-03 3 1  ON 50
ci_052                -2.182960e-03 3 1  ON 51
ci_053                -2.742361e-03 3 1  ON 52
ci_054                -3.472284e-03 3 1  ON 53
ci_055                -1.937694e-03 3 1  ON 54
ci_056                -2.005108e-03 3 1  ON 55
ci_057                -1.785118e-03 3 1  ON 56
ci_058                -1.819907e-03 3 1  ON 57
ci_059                -1.894057e-03 3 1  ON 58
ci_060                -2.083933e-03 3 1  ON 59
ci_061                -1.834592e-03 3 1  ON 60
ci_062                -1.924329e-03 3 1  ON 61
ci_063                -1.939867e-03 3 1  ON 62
ci_064                -9.368895e-04 3 1  ON 63
ci_065                -1.769467e-03 3 1  ON 64
ci_066                -1.408037e-03 3 1  ON 65
ci_067                -1.989749e-03 3 1  ON 66
ci_068                -1.522007e-03 3 1  ON 67
ci_069                 1.138823e-03 3 1  ON 68
ci_070                 1.595893e-03 3 1  ON 69
ci_071                 2.754244e-05 3 1  ON 70
ci_072                -2.335198e-04 3 1  ON 71
ci_073                 1.366613e-03 3 1  ON 72
ci_074                 8.865108e-04 3 1  ON 73
ci_075                -1.348860e-03 3 1  ON 74
ci_076                -7.319760e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4789e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2301e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.092
    reference variance = 6.16577
====================================================
  Execution time = 2.3724e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0290e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7177e+00
  Total weights = 1.949968974e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9175e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767975809356
                                         uncertainty =       0.035237287744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767975809356
                                         uncertainty =       0.035237287744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372570709
  error estimate for blocks of size 2^( 2) =       0.001443736046
  error estimate for blocks of size 2^( 3) =       0.001505925889
  error estimate for blocks of size 2^( 4) =       0.001550647718
  error estimate for blocks of size 2^( 5) =       0.001573177326
  error estimate for blocks of size 2^( 6) =       0.001585736947
  error estimate for blocks of size 2^( 7) =       0.001592459830

      target function =                  N/A
              le_mean =     -22.328216988386
             les_mean =     502.267004847836
             stat err =       0.001575505455
             autocorr =       1.317559902475
              std dev =       1.941139168894
             le_variance =       3.768021273016


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232821698839e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328216987562       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328216989444       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328216989654       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328216989654       residual = 1.20e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+03 is 6.301779e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328216987562       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328216988033       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328216988085       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328216988085       residual = 1.20e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+04 is 1.575460e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328216987562       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328216987680       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328216987693       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328216987703       residual = 1.20e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+05 is 3.938660e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068482 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9649e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187508e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605300e-02 3 1  ON 4
ci_006                 4.617154e-02 3 1  ON 5
ci_007                 3.181967e-02 3 1  ON 6
ci_008                 3.146822e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553486e-02 3 1  ON 9
ci_011                -2.290100e-02 3 1  ON 10
ci_012                -2.258353e-02 3 1  ON 11
ci_013                 2.001107e-02 3 1  ON 12
ci_014                 2.020475e-02 3 1  ON 13
ci_015                 1.968956e-02 3 1  ON 14
ci_016                 2.075002e-02 3 1  ON 15
ci_017                 1.537431e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064007e-02 3 1  ON 18
ci_020                 1.044013e-02 3 1  ON 19
ci_021                -9.778796e-03 3 1  ON 20
ci_022                -9.436059e-03 3 1  ON 21
ci_023                 8.740001e-03 3 1  ON 22
ci_024                 9.497576e-03 3 1  ON 23
ci_025                 7.133681e-03 3 1  ON 24
ci_026                 8.150638e-03 3 1  ON 25
ci_027                 7.920676e-03 3 1  ON 26
ci_028                 7.855789e-03 3 1  ON 27
ci_029                -7.650186e-03 3 1  ON 28
ci_030                -7.775389e-03 3 1  ON 29
ci_031                -7.190604e-03 3 1  ON 30
ci_032                -7.557100e-03 3 1  ON 31
ci_033                 6.842329e-03 3 1  ON 32
ci_034                 6.312644e-03 3 1  ON 33
ci_035                 6.419779e-03 3 1  ON 34
ci_036                 6.977819e-03 3 1  ON 35
ci_037                 6.510519e-03 3 1  ON 36
ci_038                 5.592924e-03 3 1  ON 37
ci_039                 5.925436e-03 3 1  ON 38
ci_040                 6.143325e-03 3 1  ON 39
ci_041                 5.439194e-03 3 1  ON 40
ci_042                 5.123462e-03 3 1  ON 41
ci_043                 5.094816e-03 3 1  ON 42
ci_044                 4.423121e-03 3 1  ON 43
ci_045                 5.134246e-03 3 1  ON 44
ci_046                 5.270974e-03 3 1  ON 45
ci_047                -3.975278e-03 3 1  ON 46
ci_048                -4.391777e-03 3 1  ON 47
ci_049                 4.071065e-03 3 1  ON 48
ci_050                 3.474396e-03 3 1  ON 49
ci_051                -3.066907e-03 3 1  ON 50
ci_052                -2.182963e-03 3 1  ON 51
ci_053                -2.742360e-03 3 1  ON 52
ci_054                -3.472281e-03 3 1  ON 53
ci_055                -1.937693e-03 3 1  ON 54
ci_056                -2.005098e-03 3 1  ON 55
ci_057                -1.785120e-03 3 1  ON 56
ci_058                -1.819912e-03 3 1  ON 57
ci_059                -1.894062e-03 3 1  ON 58
ci_060                -2.083925e-03 3 1  ON 59
ci_061                -1.834592e-03 3 1  ON 60
ci_062                -1.924334e-03 3 1  ON 61
ci_063                -1.939869e-03 3 1  ON 62
ci_064                -9.368892e-04 3 1  ON 63
ci_065                -1.769460e-03 3 1  ON 64
ci_066                -1.408030e-03 3 1  ON 65
ci_067                -1.989745e-03 3 1  ON 66
ci_068                -1.522005e-03 3 1  ON 67
ci_069                 1.138828e-03 3 1  ON 68
ci_070                 1.595891e-03 3 1  ON 69
ci_071                 2.753075e-05 3 1  ON 70
ci_072                -2.335236e-04 3 1  ON 71
ci_073                 1.366614e-03 3 1  ON 72
ci_074                 8.865123e-04 3 1  ON 73
ci_075                -1.348857e-03 3 1  ON 74
ci_076                -7.319767e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.1309
    reference variance = 2.62381
====================================================
  Execution time = 2.3183e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7830e+00
  Total weights = 1.9500e+06
  Execution time = 4.3626e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.836767709814
                                         uncertainty =       0.047213963945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.836767709814
                                         uncertainty =       0.047213963945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001384932383
  error estimate for blocks of size 2^( 2) =       0.001455918406
  error estimate for blocks of size 2^( 3) =       0.001516898239
  error estimate for blocks of size 2^( 4) =       0.001559417289
  error estimate for blocks of size 2^( 5) =       0.001583897695
  error estimate for blocks of size 2^( 6) =       0.001603695993
  error estimate for blocks of size 2^( 7) =       0.001608493311

      target function =                  N/A
              le_mean =     -22.325212696618
             les_mean =     502.198101088645
             stat err =       0.001588876072
             autocorr =       1.316203098691
              std dev =       1.958621496323
             le_variance =       3.836198165860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.836767706707
                                         uncertainty =       0.047213964139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.836767706707
                                         uncertainty =       0.047213964139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001384932383
  error estimate for blocks of size 2^( 2) =       0.001455918407
  error estimate for blocks of size 2^( 3) =       0.001516898240
  error estimate for blocks of size 2^( 4) =       0.001559417292
  error estimate for blocks of size 2^( 5) =       0.001583897699
  error estimate for blocks of size 2^( 6) =       0.001603695997
  error estimate for blocks of size 2^( 7) =       0.001608493314

      target function =                  N/A
              le_mean =     -22.325212696837
             les_mean =     502.198101161034
             stat err =       0.001588876075
             autocorr =       1.316203105575
              std dev =       1.958621495535
             le_variance =       3.836198162773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.836767708260
                                         uncertainty =       0.047213964042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.836767708260
                                         uncertainty =       0.047213964042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001384932383
  error estimate for blocks of size 2^( 2) =       0.001455918407
  error estimate for blocks of size 2^( 3) =       0.001516898239
  error estimate for blocks of size 2^( 4) =       0.001559417290
  error estimate for blocks of size 2^( 5) =       0.001583897697
  error estimate for blocks of size 2^( 6) =       0.001603695995
  error estimate for blocks of size 2^( 7) =       0.001608493313

      target function =                  N/A
              le_mean =     -22.325212696728
             les_mean =     502.198101124829
             stat err =       0.001588876074
             autocorr =       1.316203102133
              std dev =       1.958621495929
             le_variance =       3.836198164317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.836767709620
                                         uncertainty =       0.047213963957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.836767709620
                                         uncertainty =       0.047213963957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001384932383
  error estimate for blocks of size 2^( 2) =       0.001455918406
  error estimate for blocks of size 2^( 3) =       0.001516898239
  error estimate for blocks of size 2^( 4) =       0.001559417289
  error estimate for blocks of size 2^( 5) =       0.001583897695
  error estimate for blocks of size 2^( 6) =       0.001603695994
  error estimate for blocks of size 2^( 7) =       0.001608493311

      target function =                  N/A
              le_mean =     -22.325212696632
             les_mean =     502.198101093167
             stat err =       0.001588876072
             autocorr =       1.316203099121
              std dev =       1.958621496274
             le_variance =       3.836198165667


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325212696618        initial
     9.5367e+03     9.5367e+04             6.3018e-08       -22.325212696837  <--
     3.8147e+04     3.8147e+05             1.5755e-08       -22.325212696728
     1.5259e+05     1.5259e+06             3.9387e-09       -22.325212696632

*****************************************************************************
Applying the update for shift_i =   9.5367e+03     and shift_s =   9.5367e+04
*****************************************************************************

  Execution time = 4.5083e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187508e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605300e-02 3 1  ON 4
ci_006                 4.617151e-02 3 1  ON 5
ci_007                 3.181967e-02 3 1  ON 6
ci_008                 3.146822e-02 3 1  ON 7
ci_009                -2.501551e-02 3 1  ON 8
ci_010                -2.553486e-02 3 1  ON 9
ci_011                -2.290100e-02 3 1  ON 10
ci_012                -2.258355e-02 3 1  ON 11
ci_013                 2.001106e-02 3 1  ON 12
ci_014                 2.020473e-02 3 1  ON 13
ci_015                 1.968958e-02 3 1  ON 14
ci_016                 2.074998e-02 3 1  ON 15
ci_017                 1.537429e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064005e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778802e-03 3 1  ON 20
ci_022                -9.436073e-03 3 1  ON 21
ci_023                 8.740031e-03 3 1  ON 22
ci_024                 9.497573e-03 3 1  ON 23
ci_025                 7.133697e-03 3 1  ON 24
ci_026                 8.150613e-03 3 1  ON 25
ci_027                 7.920668e-03 3 1  ON 26
ci_028                 7.855807e-03 3 1  ON 27
ci_029                -7.650179e-03 3 1  ON 28
ci_030                -7.775423e-03 3 1  ON 29
ci_031                -7.190624e-03 3 1  ON 30
ci_032                -7.557082e-03 3 1  ON 31
ci_033                 6.842289e-03 3 1  ON 32
ci_034                 6.312653e-03 3 1  ON 33
ci_035                 6.419785e-03 3 1  ON 34
ci_036                 6.977816e-03 3 1  ON 35
ci_037                 6.510514e-03 3 1  ON 36
ci_038                 5.592928e-03 3 1  ON 37
ci_039                 5.925403e-03 3 1  ON 38
ci_040                 6.143319e-03 3 1  ON 39
ci_041                 5.439183e-03 3 1  ON 40
ci_042                 5.123471e-03 3 1  ON 41
ci_043                 5.094816e-03 3 1  ON 42
ci_044                 4.423125e-03 3 1  ON 43
ci_045                 5.134229e-03 3 1  ON 44
ci_046                 5.270959e-03 3 1  ON 45
ci_047                -3.975289e-03 3 1  ON 46
ci_048                -4.391764e-03 3 1  ON 47
ci_049                 4.071091e-03 3 1  ON 48
ci_050                 3.474415e-03 3 1  ON 49
ci_051                -3.066875e-03 3 1  ON 50
ci_052                -2.182975e-03 3 1  ON 51
ci_053                -2.742357e-03 3 1  ON 52
ci_054                -3.472274e-03 3 1  ON 53
ci_055                -1.937693e-03 3 1  ON 54
ci_056                -2.005070e-03 3 1  ON 55
ci_057                -1.785127e-03 3 1  ON 56
ci_058                -1.819925e-03 3 1  ON 57
ci_059                -1.894079e-03 3 1  ON 58
ci_060                -2.083903e-03 3 1  ON 59
ci_061                -1.834594e-03 3 1  ON 60
ci_062                -1.924349e-03 3 1  ON 61
ci_063                -1.939874e-03 3 1  ON 62
ci_064                -9.368884e-04 3 1  ON 63
ci_065                -1.769439e-03 3 1  ON 64
ci_066                -1.408009e-03 3 1  ON 65
ci_067                -1.989734e-03 3 1  ON 66
ci_068                -1.521999e-03 3 1  ON 67
ci_069                 1.138843e-03 3 1  ON 68
ci_070                 1.595884e-03 3 1  ON 69
ci_071                 2.749567e-05 3 1  ON 70
ci_072                -2.335352e-04 3 1  ON 71
ci_073                 1.366616e-03 3 1  ON 72
ci_074                 8.865169e-04 3 1  ON 73
ci_075                -1.348847e-03 3 1  ON 74
ci_076                -7.319785e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4738e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2294e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.3825
    reference variance = 2.83288
====================================================
  Execution time = 2.5861e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0346e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7253e+00
  Total weights = 1.950133648e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9005e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776798518787
                                         uncertainty =       0.045425382361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776798518787
                                         uncertainty =       0.045425382361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374199313
  error estimate for blocks of size 2^( 2) =       0.001445134639
  error estimate for blocks of size 2^( 3) =       0.001507845061
  error estimate for blocks of size 2^( 4) =       0.001550951325
  error estimate for blocks of size 2^( 5) =       0.001575661488
  error estimate for blocks of size 2^( 6) =       0.001588617510
  error estimate for blocks of size 2^( 7) =       0.001595603135

      target function =                  N/A
              le_mean =     -22.328099118657
             les_mean =     502.269346853070
             stat err =       0.001577708364
             autocorr =       1.318117123671
              std dev =       1.943442399683
             le_variance =       3.776968360885


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232809911866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328099117861       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328099125105       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328099125153       residual = 2.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+03 is 1.858255e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328099117861       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328099119672       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328099119684       residual = 2.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+03 is 4.645916e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328099117861       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328099118314       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328099118317       residual = 2.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+04 is 1.161496e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.069690 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1769e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187508e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605299e-02 3 1  ON 4
ci_006                 4.617151e-02 3 1  ON 5
ci_007                 3.181968e-02 3 1  ON 6
ci_008                 3.146823e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553488e-02 3 1  ON 9
ci_011                -2.290101e-02 3 1  ON 10
ci_012                -2.258354e-02 3 1  ON 11
ci_013                 2.001106e-02 3 1  ON 12
ci_014                 2.020474e-02 3 1  ON 13
ci_015                 1.968961e-02 3 1  ON 14
ci_016                 2.074999e-02 3 1  ON 15
ci_017                 1.537427e-02 3 1  ON 16
ci_018                 1.572230e-02 3 1  ON 17
ci_019                 1.064006e-02 3 1  ON 18
ci_020                 1.044016e-02 3 1  ON 19
ci_021                -9.778785e-03 3 1  ON 20
ci_022                -9.436092e-03 3 1  ON 21
ci_023                 8.740019e-03 3 1  ON 22
ci_024                 9.497562e-03 3 1  ON 23
ci_025                 7.133705e-03 3 1  ON 24
ci_026                 8.150637e-03 3 1  ON 25
ci_027                 7.920667e-03 3 1  ON 26
ci_028                 7.855803e-03 3 1  ON 27
ci_029                -7.650184e-03 3 1  ON 28
ci_030                -7.775425e-03 3 1  ON 29
ci_031                -7.190646e-03 3 1  ON 30
ci_032                -7.557081e-03 3 1  ON 31
ci_033                 6.842304e-03 3 1  ON 32
ci_034                 6.312643e-03 3 1  ON 33
ci_035                 6.419801e-03 3 1  ON 34
ci_036                 6.977805e-03 3 1  ON 35
ci_037                 6.510530e-03 3 1  ON 36
ci_038                 5.592974e-03 3 1  ON 37
ci_039                 5.925363e-03 3 1  ON 38
ci_040                 6.143312e-03 3 1  ON 39
ci_041                 5.439163e-03 3 1  ON 40
ci_042                 5.123470e-03 3 1  ON 41
ci_043                 5.094818e-03 3 1  ON 42
ci_044                 4.423128e-03 3 1  ON 43
ci_045                 5.134245e-03 3 1  ON 44
ci_046                 5.270980e-03 3 1  ON 45
ci_047                -3.975279e-03 3 1  ON 46
ci_048                -4.391765e-03 3 1  ON 47
ci_049                 4.071062e-03 3 1  ON 48
ci_050                 3.474422e-03 3 1  ON 49
ci_051                -3.066859e-03 3 1  ON 50
ci_052                -2.182986e-03 3 1  ON 51
ci_053                -2.742376e-03 3 1  ON 52
ci_054                -3.472252e-03 3 1  ON 53
ci_055                -1.937679e-03 3 1  ON 54
ci_056                -2.005091e-03 3 1  ON 55
ci_057                -1.785136e-03 3 1  ON 56
ci_058                -1.819920e-03 3 1  ON 57
ci_059                -1.894085e-03 3 1  ON 58
ci_060                -2.083909e-03 3 1  ON 59
ci_061                -1.834608e-03 3 1  ON 60
ci_062                -1.924311e-03 3 1  ON 61
ci_063                -1.939861e-03 3 1  ON 62
ci_064                -9.369067e-04 3 1  ON 63
ci_065                -1.769412e-03 3 1  ON 64
ci_066                -1.408016e-03 3 1  ON 65
ci_067                -1.989702e-03 3 1  ON 66
ci_068                -1.522006e-03 3 1  ON 67
ci_069                 1.138846e-03 3 1  ON 68
ci_070                 1.595888e-03 3 1  ON 69
ci_071                 2.746461e-05 3 1  ON 70
ci_072                -2.335361e-04 3 1  ON 71
ci_073                 1.366594e-03 3 1  ON 72
ci_074                 8.865123e-04 3 1  ON 73
ci_075                -1.348802e-03 3 1  ON 74
ci_076                -7.320059e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.6043
    reference variance = 2.10578
====================================================
  Execution time = 2.3193e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7098e+00
  Total weights = 1.9498e+06
  Execution time = 4.3802e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755455682809
                                         uncertainty =       0.025571824942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755455682809
                                         uncertainty =       0.025571824942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371111824
  error estimate for blocks of size 2^( 2) =       0.001442238101
  error estimate for blocks of size 2^( 3) =       0.001504411891
  error estimate for blocks of size 2^( 4) =       0.001545866836
  error estimate for blocks of size 2^( 5) =       0.001568913568
  error estimate for blocks of size 2^( 6) =       0.001581769550
  error estimate for blocks of size 2^( 7) =       0.001592161264

      target function =                  N/A
              le_mean =     -22.330051469632
             les_mean =     502.340951816365
             stat err =       0.001572177805
             autocorr =       1.314793564077
              std dev =       1.939075961234
             le_variance =       3.760015583434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755455690121
                                         uncertainty =       0.025571824579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755455690121
                                         uncertainty =       0.025571824579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371111825
  error estimate for blocks of size 2^( 2) =       0.001442238101
  error estimate for blocks of size 2^( 3) =       0.001504411889
  error estimate for blocks of size 2^( 4) =       0.001545866832
  error estimate for blocks of size 2^( 5) =       0.001568913565
  error estimate for blocks of size 2^( 6) =       0.001581769547
  error estimate for blocks of size 2^( 7) =       0.001592161257

      target function =                  N/A
              le_mean =     -22.330051468905
             les_mean =     502.340951815039
             stat err =       0.001572177800
             autocorr =       1.314793554626
              std dev =       1.939075962965
             le_variance =       3.760015590148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755455686464
                                         uncertainty =       0.025571824761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755455686464
                                         uncertainty =       0.025571824761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371111824
  error estimate for blocks of size 2^( 2) =       0.001442238101
  error estimate for blocks of size 2^( 3) =       0.001504411890
  error estimate for blocks of size 2^( 4) =       0.001545866834
  error estimate for blocks of size 2^( 5) =       0.001568913567
  error estimate for blocks of size 2^( 6) =       0.001581769548
  error estimate for blocks of size 2^( 7) =       0.001592161261

      target function =                  N/A
              le_mean =     -22.330051469268
             les_mean =     502.340951815665
             stat err =       0.001572177802
             autocorr =       1.314793559351
              std dev =       1.939075962099
             le_variance =       3.760015586790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755455683266
                                         uncertainty =       0.025571824920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755455683266
                                         uncertainty =       0.025571824920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371111824
  error estimate for blocks of size 2^( 2) =       0.001442238101
  error estimate for blocks of size 2^( 3) =       0.001504411891
  error estimate for blocks of size 2^( 4) =       0.001545866836
  error estimate for blocks of size 2^( 5) =       0.001568913568
  error estimate for blocks of size 2^( 6) =       0.001581769549
  error estimate for blocks of size 2^( 7) =       0.001592161264

      target function =                  N/A
              le_mean =     -22.330051469587
             les_mean =     502.340951816274
             stat err =       0.001572177804
             autocorr =       1.314793563487
              std dev =       1.939075961342
             le_variance =       3.760015583853


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330051469632        initial  <--
     2.3842e+03     2.3842e+04             1.8583e-07       -22.330051468905
     9.5367e+03     9.5367e+04             4.6459e-08       -22.330051469268
     3.8147e+04     3.8147e+05             1.1615e-08       -22.330051469587

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1834
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_001                -6.963162e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187508e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605300e-02 3 1  ON 4
ci_006                 4.617151e-02 3 1  ON 5
ci_007                 3.181967e-02 3 1  ON 6
ci_008                 3.146822e-02 3 1  ON 7
ci_009                -2.501551e-02 3 1  ON 8
ci_010                -2.553486e-02 3 1  ON 9
ci_011                -2.290100e-02 3 1  ON 10
ci_012                -2.258355e-02 3 1  ON 11
ci_013                 2.001106e-02 3 1  ON 12
ci_014                 2.020473e-02 3 1  ON 13
ci_015                 1.968958e-02 3 1  ON 14
ci_016                 2.074998e-02 3 1  ON 15
ci_017                 1.537429e-02 3 1  ON 16
ci_018                 1.572229e-02 3 1  ON 17
ci_019                 1.064005e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778802e-03 3 1  ON 20
ci_022                -9.436073e-03 3 1  ON 21
ci_023                 8.740031e-03 3 1  ON 22
ci_024                 9.497573e-03 3 1  ON 23
ci_025                 7.133697e-03 3 1  ON 24
ci_026                 8.150613e-03 3 1  ON 25
ci_027                 7.920668e-03 3 1  ON 26
ci_028                 7.855807e-03 3 1  ON 27
ci_029                -7.650179e-03 3 1  ON 28
ci_030                -7.775423e-03 3 1  ON 29
ci_031                -7.190624e-03 3 1  ON 30
ci_032                -7.557082e-03 3 1  ON 31
ci_033                 6.842289e-03 3 1  ON 32
ci_034                 6.312653e-03 3 1  ON 33
ci_035                 6.419785e-03 3 1  ON 34
ci_036                 6.977816e-03 3 1  ON 35
ci_037                 6.510514e-03 3 1  ON 36
ci_038                 5.592928e-03 3 1  ON 37
ci_039                 5.925403e-03 3 1  ON 38
ci_040                 6.143319e-03 3 1  ON 39
ci_041                 5.439183e-03 3 1  ON 40
ci_042                 5.123471e-03 3 1  ON 41
ci_043                 5.094816e-03 3 1  ON 42
ci_044                 4.423125e-03 3 1  ON 43
ci_045                 5.134229e-03 3 1  ON 44
ci_046                 5.270959e-03 3 1  ON 45
ci_047                -3.975289e-03 3 1  ON 46
ci_048                -4.391764e-03 3 1  ON 47
ci_049                 4.071091e-03 3 1  ON 48
ci_050                 3.474415e-03 3 1  ON 49
ci_051                -3.066875e-03 3 1  ON 50
ci_052                -2.182975e-03 3 1  ON 51
ci_053                -2.742357e-03 3 1  ON 52
ci_054                -3.472274e-03 3 1  ON 53
ci_055                -1.937693e-03 3 1  ON 54
ci_056                -2.005070e-03 3 1  ON 55
ci_057                -1.785127e-03 3 1  ON 56
ci_058                -1.819925e-03 3 1  ON 57
ci_059                -1.894079e-03 3 1  ON 58
ci_060                -2.083903e-03 3 1  ON 59
ci_061                -1.834594e-03 3 1  ON 60
ci_062                -1.924349e-03 3 1  ON 61
ci_063                -1.939874e-03 3 1  ON 62
ci_064                -9.368884e-04 3 1  ON 63
ci_065                -1.769439e-03 3 1  ON 64
ci_066                -1.408009e-03 3 1  ON 65
ci_067                -1.989734e-03 3 1  ON 66
ci_068                -1.521999e-03 3 1  ON 67
ci_069                 1.138843e-03 3 1  ON 68
ci_070                 1.595884e-03 3 1  ON 69
ci_071                 2.749567e-05 3 1  ON 70
ci_072                -2.335352e-04 3 1  ON 71
ci_073                 1.366616e-03 3 1  ON 72
ci_074                 8.865169e-04 3 1  ON 73
ci_075                -1.348847e-03 3 1  ON 74
ci_076                -7.319785e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6959e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2301e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.0122
    reference variance = 3.76872
====================================================
  Execution time = 2.3750e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0305e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7076e+00
  Total weights = 1.949994701e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0382e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757044099450
                                         uncertainty =       0.029873937534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757044099450
                                         uncertainty =       0.029873937534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370525767
  error estimate for blocks of size 2^( 2) =       0.001442396482
  error estimate for blocks of size 2^( 3) =       0.001504728243
  error estimate for blocks of size 2^( 4) =       0.001548786979
  error estimate for blocks of size 2^( 5) =       0.001568784703
  error estimate for blocks of size 2^( 6) =       0.001579151337
  error estimate for blocks of size 2^( 7) =       0.001589038358

      target function =                  N/A
              le_mean =     -22.326920309477
             les_mean =     502.198930386034
             stat err =       0.001571440344
             autocorr =       1.314684030475
              std dev =       1.938247138106
             le_variance =       3.756801968377


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232692030948e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326920308632       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326920309436       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326920309437       residual = 6.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+04 is 1.562759e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326920308632       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326920308833       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326920308834       residual = 6.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+04 is 3.906923e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326920308632       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326920308683       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326920308683       residual = 6.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+05 is 9.767322e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070864 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9795e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187508e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605300e-02 3 1  ON 4
ci_006                 4.617150e-02 3 1  ON 5
ci_007                 3.181967e-02 3 1  ON 6
ci_008                 3.146822e-02 3 1  ON 7
ci_009                -2.501551e-02 3 1  ON 8
ci_010                -2.553486e-02 3 1  ON 9
ci_011                -2.290100e-02 3 1  ON 10
ci_012                -2.258355e-02 3 1  ON 11
ci_013                 2.001106e-02 3 1  ON 12
ci_014                 2.020473e-02 3 1  ON 13
ci_015                 1.968958e-02 3 1  ON 14
ci_016                 2.074998e-02 3 1  ON 15
ci_017                 1.537429e-02 3 1  ON 16
ci_018                 1.572228e-02 3 1  ON 17
ci_019                 1.064005e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778801e-03 3 1  ON 20
ci_022                -9.436077e-03 3 1  ON 21
ci_023                 8.740031e-03 3 1  ON 22
ci_024                 9.497569e-03 3 1  ON 23
ci_025                 7.133697e-03 3 1  ON 24
ci_026                 8.150614e-03 3 1  ON 25
ci_027                 7.920672e-03 3 1  ON 26
ci_028                 7.855807e-03 3 1  ON 27
ci_029                -7.650178e-03 3 1  ON 28
ci_030                -7.775424e-03 3 1  ON 29
ci_031                -7.190625e-03 3 1  ON 30
ci_032                -7.557083e-03 3 1  ON 31
ci_033                 6.842290e-03 3 1  ON 32
ci_034                 6.312651e-03 3 1  ON 33
ci_035                 6.419783e-03 3 1  ON 34
ci_036                 6.977814e-03 3 1  ON 35
ci_037                 6.510511e-03 3 1  ON 36
ci_038                 5.592929e-03 3 1  ON 37
ci_039                 5.925401e-03 3 1  ON 38
ci_040                 6.143320e-03 3 1  ON 39
ci_041                 5.439181e-03 3 1  ON 40
ci_042                 5.123473e-03 3 1  ON 41
ci_043                 5.094817e-03 3 1  ON 42
ci_044                 4.423128e-03 3 1  ON 43
ci_045                 5.134227e-03 3 1  ON 44
ci_046                 5.270957e-03 3 1  ON 45
ci_047                -3.975291e-03 3 1  ON 46
ci_048                -4.391762e-03 3 1  ON 47
ci_049                 4.071090e-03 3 1  ON 48
ci_050                 3.474414e-03 3 1  ON 49
ci_051                -3.066876e-03 3 1  ON 50
ci_052                -2.182976e-03 3 1  ON 51
ci_053                -2.742360e-03 3 1  ON 52
ci_054                -3.472273e-03 3 1  ON 53
ci_055                -1.937693e-03 3 1  ON 54
ci_056                -2.005072e-03 3 1  ON 55
ci_057                -1.785130e-03 3 1  ON 56
ci_058                -1.819928e-03 3 1  ON 57
ci_059                -1.894079e-03 3 1  ON 58
ci_060                -2.083901e-03 3 1  ON 59
ci_061                -1.834593e-03 3 1  ON 60
ci_062                -1.924347e-03 3 1  ON 61
ci_063                -1.939872e-03 3 1  ON 62
ci_064                -9.368871e-04 3 1  ON 63
ci_065                -1.769438e-03 3 1  ON 64
ci_066                -1.408011e-03 3 1  ON 65
ci_067                -1.989734e-03 3 1  ON 66
ci_068                -1.521997e-03 3 1  ON 67
ci_069                 1.138843e-03 3 1  ON 68
ci_070                 1.595883e-03 3 1  ON 69
ci_071                 2.749444e-05 3 1  ON 70
ci_072                -2.335359e-04 3 1  ON 71
ci_073                 1.366615e-03 3 1  ON 72
ci_074                 8.865158e-04 3 1  ON 73
ci_075                -1.348844e-03 3 1  ON 74
ci_076                -7.319779e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.3087
    reference variance = 4.02964
====================================================
  Execution time = 2.3271e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8223e+00
  Total weights = 1.9501e+06
  Execution time = 4.3800e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.876256494582
                                         uncertainty =       0.076535261921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.876256494582
                                         uncertainty =       0.076535261921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001392011702
  error estimate for blocks of size 2^( 2) =       0.001461460229
  error estimate for blocks of size 2^( 3) =       0.001524187550
  error estimate for blocks of size 2^( 4) =       0.001566682940
  error estimate for blocks of size 2^( 5) =       0.001588318319
  error estimate for blocks of size 2^( 6) =       0.001601678136
  error estimate for blocks of size 2^( 7) =       0.001609734620

      target function =                  N/A
              le_mean =     -22.327729797089
             les_mean =     502.349769463409
             stat err =       0.001591603504
             autocorr =       1.307326307255
              std dev =       1.968633325544
             le_variance =       3.875517170443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.876256488589
                                         uncertainty =       0.076535261879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.876256488589
                                         uncertainty =       0.076535261879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001392011701
  error estimate for blocks of size 2^( 2) =       0.001461460228
  error estimate for blocks of size 2^( 3) =       0.001524187550
  error estimate for blocks of size 2^( 4) =       0.001566682940
  error estimate for blocks of size 2^( 5) =       0.001588318319
  error estimate for blocks of size 2^( 6) =       0.001601678136
  error estimate for blocks of size 2^( 7) =       0.001609734620

      target function =                  N/A
              le_mean =     -22.327729797214
             les_mean =     502.349769470655
             stat err =       0.001591603504
             autocorr =       1.307326309322
              std dev =       1.968633324022
             le_variance =       3.875517164449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.876256491586
                                         uncertainty =       0.076535261900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.876256491586
                                         uncertainty =       0.076535261900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001392011702
  error estimate for blocks of size 2^( 2) =       0.001461460228
  error estimate for blocks of size 2^( 3) =       0.001524187550
  error estimate for blocks of size 2^( 4) =       0.001566682940
  error estimate for blocks of size 2^( 5) =       0.001588318319
  error estimate for blocks of size 2^( 6) =       0.001601678136
  error estimate for blocks of size 2^( 7) =       0.001609734620

      target function =                  N/A
              le_mean =     -22.327729797152
             les_mean =     502.349769467030
             stat err =       0.001591603504
             autocorr =       1.307326308288
              std dev =       1.968633324783
             le_variance =       3.875517167446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.876256494207
                                         uncertainty =       0.076535261918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.876256494207
                                         uncertainty =       0.076535261918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001392011702
  error estimate for blocks of size 2^( 2) =       0.001461460229
  error estimate for blocks of size 2^( 3) =       0.001524187550
  error estimate for blocks of size 2^( 4) =       0.001566682940
  error estimate for blocks of size 2^( 5) =       0.001588318319
  error estimate for blocks of size 2^( 6) =       0.001601678136
  error estimate for blocks of size 2^( 7) =       0.001609734620

      target function =                  N/A
              le_mean =     -22.327729797097
             les_mean =     502.349769463861
             stat err =       0.001591603504
             autocorr =       1.307326307383
              std dev =       1.968633325449
             le_variance =       3.875517170068


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327729797089        initial
     2.3842e+04     2.3842e+05             1.5628e-08       -22.327729797214  <--
     9.5367e+04     9.5367e+05             3.9069e-09       -22.327729797152
     3.8147e+05     3.8147e+06             9.7673e-10       -22.327729797097

*****************************************************************************
Applying the update for shift_i =   2.3842e+04     and shift_s =   2.3842e+05
*****************************************************************************

  Execution time = 4.5243e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187507e-02 3 1  ON 2
ci_004                -6.235963e-02 3 1  ON 3
ci_005                 4.605299e-02 3 1  ON 4
ci_006                 4.617150e-02 3 1  ON 5
ci_007                 3.181967e-02 3 1  ON 6
ci_008                 3.146822e-02 3 1  ON 7
ci_009                -2.501550e-02 3 1  ON 8
ci_010                -2.553486e-02 3 1  ON 9
ci_011                -2.290099e-02 3 1  ON 10
ci_012                -2.258355e-02 3 1  ON 11
ci_013                 2.001106e-02 3 1  ON 12
ci_014                 2.020473e-02 3 1  ON 13
ci_015                 1.968958e-02 3 1  ON 14
ci_016                 2.074999e-02 3 1  ON 15
ci_017                 1.537429e-02 3 1  ON 16
ci_018                 1.572228e-02 3 1  ON 17
ci_019                 1.064004e-02 3 1  ON 18
ci_020                 1.044014e-02 3 1  ON 19
ci_021                -9.778799e-03 3 1  ON 20
ci_022                -9.436089e-03 3 1  ON 21
ci_023                 8.740033e-03 3 1  ON 22
ci_024                 9.497558e-03 3 1  ON 23
ci_025                 7.133697e-03 3 1  ON 24
ci_026                 8.150618e-03 3 1  ON 25
ci_027                 7.920682e-03 3 1  ON 26
ci_028                 7.855806e-03 3 1  ON 27
ci_029                -7.650174e-03 3 1  ON 28
ci_030                -7.775428e-03 3 1  ON 29
ci_031                -7.190626e-03 3 1  ON 30
ci_032                -7.557087e-03 3 1  ON 31
ci_033                 6.842295e-03 3 1  ON 32
ci_034                 6.312645e-03 3 1  ON 33
ci_035                 6.419777e-03 3 1  ON 34
ci_036                 6.977807e-03 3 1  ON 35
ci_037                 6.510503e-03 3 1  ON 36
ci_038                 5.592934e-03 3 1  ON 37
ci_039                 5.925394e-03 3 1  ON 38
ci_040                 6.143323e-03 3 1  ON 39
ci_041                 5.439177e-03 3 1  ON 40
ci_042                 5.123479e-03 3 1  ON 41
ci_043                 5.094820e-03 3 1  ON 42
ci_044                 4.423136e-03 3 1  ON 43
ci_045                 5.134222e-03 3 1  ON 44
ci_046                 5.270952e-03 3 1  ON 45
ci_047                -3.975297e-03 3 1  ON 46
ci_048                -4.391758e-03 3 1  ON 47
ci_049                 4.071088e-03 3 1  ON 48
ci_050                 3.474412e-03 3 1  ON 49
ci_051                -3.066878e-03 3 1  ON 50
ci_052                -2.182980e-03 3 1  ON 51
ci_053                -2.742368e-03 3 1  ON 52
ci_054                -3.472270e-03 3 1  ON 53
ci_055                -1.937695e-03 3 1  ON 54
ci_056                -2.005076e-03 3 1  ON 55
ci_057                -1.785139e-03 3 1  ON 56
ci_058                -1.819934e-03 3 1  ON 57
ci_059                -1.894079e-03 3 1  ON 58
ci_060                -2.083897e-03 3 1  ON 59
ci_061                -1.834589e-03 3 1  ON 60
ci_062                -1.924340e-03 3 1  ON 61
ci_063                -1.939865e-03 3 1  ON 62
ci_064                -9.368834e-04 3 1  ON 63
ci_065                -1.769436e-03 3 1  ON 64
ci_066                -1.408015e-03 3 1  ON 65
ci_067                -1.989733e-03 3 1  ON 66
ci_068                -1.521991e-03 3 1  ON 67
ci_069                 1.138843e-03 3 1  ON 68
ci_070                 1.595880e-03 3 1  ON 69
ci_071                 2.749076e-05 3 1  ON 70
ci_072                -2.335381e-04 3 1  ON 71
ci_073                 1.366615e-03 3 1  ON 72
ci_074                 8.865124e-04 3 1  ON 73
ci_075                -1.348835e-03 3 1  ON 74
ci_076                -7.319760e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5045e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2296e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.3889
    reference variance = 2.26498
====================================================
  Execution time = 2.3779e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0298e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6911e+00
  Total weights = 1.950041009e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0035e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.743923872900
                                         uncertainty =       0.025335722638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.743923872900
                                         uncertainty =       0.025335722638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368102275
  error estimate for blocks of size 2^( 2) =       0.001439206927
  error estimate for blocks of size 2^( 3) =       0.001501656411
  error estimate for blocks of size 2^( 4) =       0.001547630660
  error estimate for blocks of size 2^( 5) =       0.001568362972
  error estimate for blocks of size 2^( 6) =       0.001579011865
  error estimate for blocks of size 2^( 7) =       0.001581958763

      target function =                  N/A
              le_mean =     -22.328473143864
             les_mean =     502.251824745026
             stat err =       0.001569241065
             autocorr =       1.315655540937
              std dev =       1.934819747912
             le_variance =       3.743527456911


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232847314386e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328473143058       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328473145400       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328473145442       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+03 is 7.878359e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328473143058       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328473143644       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328473143654       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+04 is 1.969625e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328473143058       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328473143205       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328473143207       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+04 is 4.924084e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.072063 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9789e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187507e-02 3 1  ON 2
ci_004                -6.235963e-02 3 1  ON 3
ci_005                 4.605299e-02 3 1  ON 4
ci_006                 4.617151e-02 3 1  ON 5
ci_007                 3.181966e-02 3 1  ON 6
ci_008                 3.146822e-02 3 1  ON 7
ci_009                -2.501551e-02 3 1  ON 8
ci_010                -2.553486e-02 3 1  ON 9
ci_011                -2.290098e-02 3 1  ON 10
ci_012                -2.258354e-02 3 1  ON 11
ci_013                 2.001105e-02 3 1  ON 12
ci_014                 2.020473e-02 3 1  ON 13
ci_015                 1.968958e-02 3 1  ON 14
ci_016                 2.074997e-02 3 1  ON 15
ci_017                 1.537429e-02 3 1  ON 16
ci_018                 1.572227e-02 3 1  ON 17
ci_019                 1.064004e-02 3 1  ON 18
ci_020                 1.044012e-02 3 1  ON 19
ci_021                -9.778802e-03 3 1  ON 20
ci_022                -9.436097e-03 3 1  ON 21
ci_023                 8.740040e-03 3 1  ON 22
ci_024                 9.497556e-03 3 1  ON 23
ci_025                 7.133694e-03 3 1  ON 24
ci_026                 8.150621e-03 3 1  ON 25
ci_027                 7.920683e-03 3 1  ON 26
ci_028                 7.855814e-03 3 1  ON 27
ci_029                -7.650170e-03 3 1  ON 28
ci_030                -7.775432e-03 3 1  ON 29
ci_031                -7.190626e-03 3 1  ON 30
ci_032                -7.557095e-03 3 1  ON 31
ci_033                 6.842292e-03 3 1  ON 32
ci_034                 6.312654e-03 3 1  ON 33
ci_035                 6.419776e-03 3 1  ON 34
ci_036                 6.977794e-03 3 1  ON 35
ci_037                 6.510505e-03 3 1  ON 36
ci_038                 5.592939e-03 3 1  ON 37
ci_039                 5.925395e-03 3 1  ON 38
ci_040                 6.143313e-03 3 1  ON 39
ci_041                 5.439189e-03 3 1  ON 40
ci_042                 5.123471e-03 3 1  ON 41
ci_043                 5.094810e-03 3 1  ON 42
ci_044                 4.423146e-03 3 1  ON 43
ci_045                 5.134223e-03 3 1  ON 44
ci_046                 5.270945e-03 3 1  ON 45
ci_047                -3.975293e-03 3 1  ON 46
ci_048                -4.391755e-03 3 1  ON 47
ci_049                 4.071075e-03 3 1  ON 48
ci_050                 3.474402e-03 3 1  ON 49
ci_051                -3.066870e-03 3 1  ON 50
ci_052                -2.182981e-03 3 1  ON 51
ci_053                -2.742368e-03 3 1  ON 52
ci_054                -3.472260e-03 3 1  ON 53
ci_055                -1.937699e-03 3 1  ON 54
ci_056                -2.005075e-03 3 1  ON 55
ci_057                -1.785140e-03 3 1  ON 56
ci_058                -1.819923e-03 3 1  ON 57
ci_059                -1.894089e-03 3 1  ON 58
ci_060                -2.083895e-03 3 1  ON 59
ci_061                -1.834580e-03 3 1  ON 60
ci_062                -1.924333e-03 3 1  ON 61
ci_063                -1.939858e-03 3 1  ON 62
ci_064                -9.368850e-04 3 1  ON 63
ci_065                -1.769431e-03 3 1  ON 64
ci_066                -1.408012e-03 3 1  ON 65
ci_067                -1.989724e-03 3 1  ON 66
ci_068                -1.521989e-03 3 1  ON 67
ci_069                 1.138844e-03 3 1  ON 68
ci_070                 1.595881e-03 3 1  ON 69
ci_071                 2.748429e-05 3 1  ON 70
ci_072                -2.335492e-04 3 1  ON 71
ci_073                 1.366615e-03 3 1  ON 72
ci_074                 8.865125e-04 3 1  ON 73
ci_075                -1.348835e-03 3 1  ON 74
ci_076                -7.319787e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.4222
    reference variance = 2.27476
====================================================
  Execution time = 2.3228e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.8010e+00
  Total weights = 1.9499e+06
  Execution time = 4.3822e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.855471739420
                                         uncertainty =       0.054091441608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.855471739420
                                         uncertainty =       0.054091441608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001388188856
  error estimate for blocks of size 2^( 2) =       0.001460235338
  error estimate for blocks of size 2^( 3) =       0.001523749016
  error estimate for blocks of size 2^( 4) =       0.001564761203
  error estimate for blocks of size 2^( 5) =       0.001590172923
  error estimate for blocks of size 2^( 6) =       0.001602289705
  error estimate for blocks of size 2^( 7) =       0.001611614443

      target function =                  N/A
              le_mean =     -22.327273166749
             les_mean =     502.308172718054
             stat err =       0.001592209568
             autocorr =       1.315537861494
              std dev =       1.963226917992
             le_variance =       3.854259931530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.855471719387
                                         uncertainty =       0.054091441748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.855471719387
                                         uncertainty =       0.054091441748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001388188852
  error estimate for blocks of size 2^( 2) =       0.001460235335
  error estimate for blocks of size 2^( 3) =       0.001523749014
  error estimate for blocks of size 2^( 4) =       0.001564761200
  error estimate for blocks of size 2^( 5) =       0.001590172920
  error estimate for blocks of size 2^( 6) =       0.001602289703
  error estimate for blocks of size 2^( 7) =       0.001611614439

      target function =                  N/A
              le_mean =     -22.327273167041
             les_mean =     502.308172883898
             stat err =       0.001592209565
             autocorr =       1.315537863280
              std dev =       1.963226912889
             le_variance =       3.854259911490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.855471729403
                                         uncertainty =       0.054091441678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.855471729403
                                         uncertainty =       0.054091441678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001388188854
  error estimate for blocks of size 2^( 2) =       0.001460235337
  error estimate for blocks of size 2^( 3) =       0.001523749015
  error estimate for blocks of size 2^( 4) =       0.001564761201
  error estimate for blocks of size 2^( 5) =       0.001590172921
  error estimate for blocks of size 2^( 6) =       0.001602289704
  error estimate for blocks of size 2^( 7) =       0.001611614441

      target function =                  N/A
              le_mean =     -22.327273166895
             les_mean =     502.308172798348
             stat err =       0.001592209567
             autocorr =       1.315537862386
              std dev =       1.963226915440
             le_variance =       3.854259921510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.855471738168
                                         uncertainty =       0.054091441617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.855471738168
                                         uncertainty =       0.054091441617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001388188856
  error estimate for blocks of size 2^( 2) =       0.001460235338
  error estimate for blocks of size 2^( 3) =       0.001523749016
  error estimate for blocks of size 2^( 4) =       0.001564761202
  error estimate for blocks of size 2^( 5) =       0.001590172922
  error estimate for blocks of size 2^( 6) =       0.001602289705
  error estimate for blocks of size 2^( 7) =       0.001611614443

      target function =                  N/A
              le_mean =     -22.327273166767
             les_mean =     502.308172727816
             stat err =       0.001592209568
             autocorr =       1.315537861606
              std dev =       1.963226917673
             le_variance =       3.854259930278


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327273166749        initial
     5.9605e+03     5.9605e+04             7.8784e-08       -22.327273167041  <--
     2.3842e+04     2.3842e+05             1.9696e-08       -22.327273166895
     9.5367e+04     9.5367e+05             4.9241e-09       -22.327273166767

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 4.5251e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187507e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605297e-02 3 1  ON 4
ci_006                 4.617153e-02 3 1  ON 5
ci_007                 3.181963e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501552e-02 3 1  ON 8
ci_010                -2.553486e-02 3 1  ON 9
ci_011                -2.290096e-02 3 1  ON 10
ci_012                -2.258354e-02 3 1  ON 11
ci_013                 2.001103e-02 3 1  ON 12
ci_014                 2.020474e-02 3 1  ON 13
ci_015                 1.968957e-02 3 1  ON 14
ci_016                 2.074992e-02 3 1  ON 15
ci_017                 1.537430e-02 3 1  ON 16
ci_018                 1.572225e-02 3 1  ON 17
ci_019                 1.064002e-02 3 1  ON 18
ci_020                 1.044006e-02 3 1  ON 19
ci_021                -9.778812e-03 3 1  ON 20
ci_022                -9.436120e-03 3 1  ON 21
ci_023                 8.740059e-03 3 1  ON 22
ci_024                 9.497551e-03 3 1  ON 23
ci_025                 7.133686e-03 3 1  ON 24
ci_026                 8.150630e-03 3 1  ON 25
ci_027                 7.920687e-03 3 1  ON 26
ci_028                 7.855839e-03 3 1  ON 27
ci_029                -7.650157e-03 3 1  ON 28
ci_030                -7.775445e-03 3 1  ON 29
ci_031                -7.190624e-03 3 1  ON 30
ci_032                -7.557119e-03 3 1  ON 31
ci_033                 6.842283e-03 3 1  ON 32
ci_034                 6.312678e-03 3 1  ON 33
ci_035                 6.419772e-03 3 1  ON 34
ci_036                 6.977756e-03 3 1  ON 35
ci_037                 6.510512e-03 3 1  ON 36
ci_038                 5.592954e-03 3 1  ON 37
ci_039                 5.925399e-03 3 1  ON 38
ci_040                 6.143284e-03 3 1  ON 39
ci_041                 5.439227e-03 3 1  ON 40
ci_042                 5.123447e-03 3 1  ON 41
ci_043                 5.094781e-03 3 1  ON 42
ci_044                 4.423175e-03 3 1  ON 43
ci_045                 5.134226e-03 3 1  ON 44
ci_046                 5.270923e-03 3 1  ON 45
ci_047                -3.975280e-03 3 1  ON 46
ci_048                -4.391744e-03 3 1  ON 47
ci_049                 4.071037e-03 3 1  ON 48
ci_050                 3.474371e-03 3 1  ON 49
ci_051                -3.066846e-03 3 1  ON 50
ci_052                -2.182984e-03 3 1  ON 51
ci_053                -2.742368e-03 3 1  ON 52
ci_054                -3.472232e-03 3 1  ON 53
ci_055                -1.937709e-03 3 1  ON 54
ci_056                -2.005071e-03 3 1  ON 55
ci_057                -1.785140e-03 3 1  ON 56
ci_058                -1.819891e-03 3 1  ON 57
ci_059                -1.894119e-03 3 1  ON 58
ci_060                -2.083887e-03 3 1  ON 59
ci_061                -1.834553e-03 3 1  ON 60
ci_062                -1.924312e-03 3 1  ON 61
ci_063                -1.939837e-03 3 1  ON 62
ci_064                -9.368897e-04 3 1  ON 63
ci_065                -1.769415e-03 3 1  ON 64
ci_066                -1.408001e-03 3 1  ON 65
ci_067                -1.989697e-03 3 1  ON 66
ci_068                -1.521982e-03 3 1  ON 67
ci_069                 1.138850e-03 3 1  ON 68
ci_070                 1.595884e-03 3 1  ON 69
ci_071                 2.746491e-05 3 1  ON 70
ci_072                -2.335825e-04 3 1  ON 71
ci_073                 1.366615e-03 3 1  ON 72
ci_074                 8.865128e-04 3 1  ON 73
ci_075                -1.348833e-03 3 1  ON 74
ci_076                -7.319868e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5047e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2300e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.0958
    reference variance = 2.92384
====================================================
  Execution time = 2.3723e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0326e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6544e+00
  Total weights = 1.949892009e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8739e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.704907464738
                                         uncertainty =       0.020150827243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.704907464738
                                         uncertainty =       0.020150827243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001360942270
  error estimate for blocks of size 2^( 2) =       0.001432286681
  error estimate for blocks of size 2^( 3) =       0.001494574228
  error estimate for blocks of size 2^( 4) =       0.001538412057
  error estimate for blocks of size 2^( 5) =       0.001562605484
  error estimate for blocks of size 2^( 6) =       0.001571388618
  error estimate for blocks of size 2^( 7) =       0.001580353286

      target function =                  N/A
              le_mean =     -22.328818297321
             les_mean =     502.230544008097
             stat err =       0.001563189861
             autocorr =       1.319301489872
              std dev =       1.924693810044
             le_variance =       3.704446262423


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232881829732e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328818296468       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328818307589       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328818308798       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328818308851       residual = 7.57e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+03 is 3.233303e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328818296468       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328818299248       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328818299550       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328818299565       residual = 7.56e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+03 is 8.084058e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328818296468       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328818297163       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328818297238       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328818297242       residual = 7.56e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+04 is 2.021064e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073574 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9604e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187501e-02 3 1  ON 2
ci_004                -6.235967e-02 3 1  ON 3
ci_005                 4.605292e-02 3 1  ON 4
ci_006                 4.617159e-02 3 1  ON 5
ci_007                 3.181962e-02 3 1  ON 6
ci_008                 3.146824e-02 3 1  ON 7
ci_009                -2.501551e-02 3 1  ON 8
ci_010                -2.553485e-02 3 1  ON 9
ci_011                -2.290091e-02 3 1  ON 10
ci_012                -2.258352e-02 3 1  ON 11
ci_013                 2.001103e-02 3 1  ON 12
ci_014                 2.020473e-02 3 1  ON 13
ci_015                 1.968963e-02 3 1  ON 14
ci_016                 2.074991e-02 3 1  ON 15
ci_017                 1.537427e-02 3 1  ON 16
ci_018                 1.572227e-02 3 1  ON 17
ci_019                 1.063999e-02 3 1  ON 18
ci_020                 1.044010e-02 3 1  ON 19
ci_021                -9.778819e-03 3 1  ON 20
ci_022                -9.436084e-03 3 1  ON 21
ci_023                 8.740043e-03 3 1  ON 22
ci_024                 9.497493e-03 3 1  ON 23
ci_025                 7.133705e-03 3 1  ON 24
ci_026                 8.150651e-03 3 1  ON 25
ci_027                 7.920672e-03 3 1  ON 26
ci_028                 7.855853e-03 3 1  ON 27
ci_029                -7.650120e-03 3 1  ON 28
ci_030                -7.775458e-03 3 1  ON 29
ci_031                -7.190666e-03 3 1  ON 30
ci_032                -7.557178e-03 3 1  ON 31
ci_033                 6.842284e-03 3 1  ON 32
ci_034                 6.312718e-03 3 1  ON 33
ci_035                 6.419692e-03 3 1  ON 34
ci_036                 6.977735e-03 3 1  ON 35
ci_037                 6.510495e-03 3 1  ON 36
ci_038                 5.592990e-03 3 1  ON 37
ci_039                 5.925421e-03 3 1  ON 38
ci_040                 6.143276e-03 3 1  ON 39
ci_041                 5.439200e-03 3 1  ON 40
ci_042                 5.123425e-03 3 1  ON 41
ci_043                 5.094747e-03 3 1  ON 42
ci_044                 4.423256e-03 3 1  ON 43
ci_045                 5.134185e-03 3 1  ON 44
ci_046                 5.270916e-03 3 1  ON 45
ci_047                -3.975335e-03 3 1  ON 46
ci_048                -4.391710e-03 3 1  ON 47
ci_049                 4.071013e-03 3 1  ON 48
ci_050                 3.474349e-03 3 1  ON 49
ci_051                -3.066868e-03 3 1  ON 50
ci_052                -2.183034e-03 3 1  ON 51
ci_053                -2.742383e-03 3 1  ON 52
ci_054                -3.472208e-03 3 1  ON 53
ci_055                -1.937729e-03 3 1  ON 54
ci_056                -2.005085e-03 3 1  ON 55
ci_057                -1.785138e-03 3 1  ON 56
ci_058                -1.819878e-03 3 1  ON 57
ci_059                -1.894125e-03 3 1  ON 58
ci_060                -2.083876e-03 3 1  ON 59
ci_061                -1.834515e-03 3 1  ON 60
ci_062                -1.924366e-03 3 1  ON 61
ci_063                -1.939779e-03 3 1  ON 62
ci_064                -9.368762e-04 3 1  ON 63
ci_065                -1.769380e-03 3 1  ON 64
ci_066                -1.408001e-03 3 1  ON 65
ci_067                -1.989703e-03 3 1  ON 66
ci_068                -1.521980e-03 3 1  ON 67
ci_069                 1.138828e-03 3 1  ON 68
ci_070                 1.595939e-03 3 1  ON 69
ci_071                 2.743912e-05 3 1  ON 70
ci_072                -2.335954e-04 3 1  ON 71
ci_073                 1.366601e-03 3 1  ON 72
ci_074                 8.864965e-04 3 1  ON 73
ci_075                -1.348830e-03 3 1  ON 74
ci_076                -7.320036e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.0576
    reference variance = 4.11916
====================================================
  Execution time = 2.3135e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.8374e+00
  Total weights = 1.9499e+06
  Execution time = 4.4171e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.885795014746
                                         uncertainty =       0.090488840058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.885795014746
                                         uncertainty =       0.090488840058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001394177640
  error estimate for blocks of size 2^( 2) =       0.001464404403
  error estimate for blocks of size 2^( 3) =       0.001523906216
  error estimate for blocks of size 2^( 4) =       0.001568906918
  error estimate for blocks of size 2^( 5) =       0.001595383269
  error estimate for blocks of size 2^( 6) =       0.001607072627
  error estimate for blocks of size 2^( 7) =       0.001619464763

      target function =                  N/A
              le_mean =     -22.329772306460
             les_mean =     502.456083044425
             stat err =       0.001597706894
             autocorr =       1.313282001054
              std dev =       1.971696472579
             le_variance =       3.887586979982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.885794916024
                                         uncertainty =       0.090488838452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.885794916024
                                         uncertainty =       0.090488838452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001394177622
  error estimate for blocks of size 2^( 2) =       0.001464404388
  error estimate for blocks of size 2^( 3) =       0.001523906201
  error estimate for blocks of size 2^( 4) =       0.001568906903
  error estimate for blocks of size 2^( 5) =       0.001595383255
  error estimate for blocks of size 2^( 6) =       0.001607072612
  error estimate for blocks of size 2^( 7) =       0.001619464739

      target function =                  N/A
              le_mean =     -22.329772302814
             les_mean =     502.456082941701
             stat err =       0.001597706877
             autocorr =       1.313282007118
              std dev =       1.971696447349
             le_variance =       3.887586880490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.885794965376
                                         uncertainty =       0.090488839255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.885794965376
                                         uncertainty =       0.090488839255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001394177631
  error estimate for blocks of size 2^( 2) =       0.001464404395
  error estimate for blocks of size 2^( 3) =       0.001523906209
  error estimate for blocks of size 2^( 4) =       0.001568906910
  error estimate for blocks of size 2^( 5) =       0.001595383262
  error estimate for blocks of size 2^( 6) =       0.001607072620
  error estimate for blocks of size 2^( 7) =       0.001619464751

      target function =                  N/A
              le_mean =     -22.329772304636
             les_mean =     502.456082992844
             stat err =       0.001597706886
             autocorr =       1.313282004088
              std dev =       1.971696459962
             le_variance =       3.887586930227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.885795008574
                                         uncertainty =       0.090488839958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.885795008574
                                         uncertainty =       0.090488839958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001394177638
  error estimate for blocks of size 2^( 2) =       0.001464404402
  error estimate for blocks of size 2^( 3) =       0.001523906215
  error estimate for blocks of size 2^( 4) =       0.001568906917
  error estimate for blocks of size 2^( 5) =       0.001595383268
  error estimate for blocks of size 2^( 6) =       0.001607072626
  error estimate for blocks of size 2^( 7) =       0.001619464761

      target function =                  N/A
              le_mean =     -22.329772306232
             les_mean =     502.456083037954
             stat err =       0.001597706893
             autocorr =       1.313282001434
              std dev =       1.971696471002
             le_variance =       3.887586973762


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329772306460        initial  <--
     1.4901e+03     1.4901e+04             3.2333e-07       -22.329772302814
     5.9605e+03     5.9605e+04             8.0841e-08       -22.329772304636
     2.3842e+04     2.3842e+05             2.0211e-08       -22.329772306232

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.5824
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187507e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605297e-02 3 1  ON 4
ci_006                 4.617153e-02 3 1  ON 5
ci_007                 3.181963e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501552e-02 3 1  ON 8
ci_010                -2.553486e-02 3 1  ON 9
ci_011                -2.290096e-02 3 1  ON 10
ci_012                -2.258354e-02 3 1  ON 11
ci_013                 2.001103e-02 3 1  ON 12
ci_014                 2.020474e-02 3 1  ON 13
ci_015                 1.968957e-02 3 1  ON 14
ci_016                 2.074992e-02 3 1  ON 15
ci_017                 1.537430e-02 3 1  ON 16
ci_018                 1.572225e-02 3 1  ON 17
ci_019                 1.064002e-02 3 1  ON 18
ci_020                 1.044006e-02 3 1  ON 19
ci_021                -9.778812e-03 3 1  ON 20
ci_022                -9.436120e-03 3 1  ON 21
ci_023                 8.740059e-03 3 1  ON 22
ci_024                 9.497551e-03 3 1  ON 23
ci_025                 7.133686e-03 3 1  ON 24
ci_026                 8.150630e-03 3 1  ON 25
ci_027                 7.920687e-03 3 1  ON 26
ci_028                 7.855839e-03 3 1  ON 27
ci_029                -7.650157e-03 3 1  ON 28
ci_030                -7.775445e-03 3 1  ON 29
ci_031                -7.190624e-03 3 1  ON 30
ci_032                -7.557119e-03 3 1  ON 31
ci_033                 6.842283e-03 3 1  ON 32
ci_034                 6.312678e-03 3 1  ON 33
ci_035                 6.419772e-03 3 1  ON 34
ci_036                 6.977756e-03 3 1  ON 35
ci_037                 6.510512e-03 3 1  ON 36
ci_038                 5.592954e-03 3 1  ON 37
ci_039                 5.925399e-03 3 1  ON 38
ci_040                 6.143284e-03 3 1  ON 39
ci_041                 5.439227e-03 3 1  ON 40
ci_042                 5.123447e-03 3 1  ON 41
ci_043                 5.094781e-03 3 1  ON 42
ci_044                 4.423175e-03 3 1  ON 43
ci_045                 5.134226e-03 3 1  ON 44
ci_046                 5.270923e-03 3 1  ON 45
ci_047                -3.975280e-03 3 1  ON 46
ci_048                -4.391744e-03 3 1  ON 47
ci_049                 4.071037e-03 3 1  ON 48
ci_050                 3.474371e-03 3 1  ON 49
ci_051                -3.066846e-03 3 1  ON 50
ci_052                -2.182984e-03 3 1  ON 51
ci_053                -2.742368e-03 3 1  ON 52
ci_054                -3.472232e-03 3 1  ON 53
ci_055                -1.937709e-03 3 1  ON 54
ci_056                -2.005071e-03 3 1  ON 55
ci_057                -1.785140e-03 3 1  ON 56
ci_058                -1.819891e-03 3 1  ON 57
ci_059                -1.894119e-03 3 1  ON 58
ci_060                -2.083887e-03 3 1  ON 59
ci_061                -1.834553e-03 3 1  ON 60
ci_062                -1.924312e-03 3 1  ON 61
ci_063                -1.939837e-03 3 1  ON 62
ci_064                -9.368897e-04 3 1  ON 63
ci_065                -1.769415e-03 3 1  ON 64
ci_066                -1.408001e-03 3 1  ON 65
ci_067                -1.989697e-03 3 1  ON 66
ci_068                -1.521982e-03 3 1  ON 67
ci_069                 1.138850e-03 3 1  ON 68
ci_070                 1.595884e-03 3 1  ON 69
ci_071                 2.746491e-05 3 1  ON 70
ci_072                -2.335825e-04 3 1  ON 71
ci_073                 1.366615e-03 3 1  ON 72
ci_074                 8.865128e-04 3 1  ON 73
ci_075                -1.348833e-03 3 1  ON 74
ci_076                -7.319868e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7193e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2293e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.1197
    reference variance = 4.02184
====================================================
  Execution time = 2.3772e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0360e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7355e+00
  Total weights = 1.949573367e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8167e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785067657036
                                         uncertainty =       0.035014870084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785067657036
                                         uncertainty =       0.035014870084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375942500
  error estimate for blocks of size 2^( 2) =       0.001446446487
  error estimate for blocks of size 2^( 3) =       0.001509334069
  error estimate for blocks of size 2^( 4) =       0.001551424703
  error estimate for blocks of size 2^( 5) =       0.001572500786
  error estimate for blocks of size 2^( 6) =       0.001588015982
  error estimate for blocks of size 2^( 7) =       0.001595929777

      target function =                  N/A
              le_mean =     -22.325743315174
             les_mean =     502.174299389859
             stat err =       0.001576967812
             autocorr =       1.313545398406
              std dev =       1.945907677988
             le_variance =       3.786556691251


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232574331517e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325743314351       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325743315361       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325743315363       residual = 1.92e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+04 is 2.820365e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325743314351       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325743314604       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325743314604       residual = 1.92e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+04 is 7.050967e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325743314351       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325743314414       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325743314414       residual = 1.92e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+05 is 1.762745e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074891 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9595e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187506e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605297e-02 3 1  ON 4
ci_006                 4.617153e-02 3 1  ON 5
ci_007                 3.181963e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501552e-02 3 1  ON 8
ci_010                -2.553486e-02 3 1  ON 9
ci_011                -2.290096e-02 3 1  ON 10
ci_012                -2.258354e-02 3 1  ON 11
ci_013                 2.001103e-02 3 1  ON 12
ci_014                 2.020474e-02 3 1  ON 13
ci_015                 1.968958e-02 3 1  ON 14
ci_016                 2.074992e-02 3 1  ON 15
ci_017                 1.537430e-02 3 1  ON 16
ci_018                 1.572224e-02 3 1  ON 17
ci_019                 1.064002e-02 3 1  ON 18
ci_020                 1.044006e-02 3 1  ON 19
ci_021                -9.778811e-03 3 1  ON 20
ci_022                -9.436123e-03 3 1  ON 21
ci_023                 8.740058e-03 3 1  ON 22
ci_024                 9.497547e-03 3 1  ON 23
ci_025                 7.133689e-03 3 1  ON 24
ci_026                 8.150631e-03 3 1  ON 25
ci_027                 7.920687e-03 3 1  ON 26
ci_028                 7.855844e-03 3 1  ON 27
ci_029                -7.650155e-03 3 1  ON 28
ci_030                -7.775446e-03 3 1  ON 29
ci_031                -7.190625e-03 3 1  ON 30
ci_032                -7.557121e-03 3 1  ON 31
ci_033                 6.842284e-03 3 1  ON 32
ci_034                 6.312682e-03 3 1  ON 33
ci_035                 6.419773e-03 3 1  ON 34
ci_036                 6.977756e-03 3 1  ON 35
ci_037                 6.510511e-03 3 1  ON 36
ci_038                 5.592959e-03 3 1  ON 37
ci_039                 5.925395e-03 3 1  ON 38
ci_040                 6.143283e-03 3 1  ON 39
ci_041                 5.439228e-03 3 1  ON 40
ci_042                 5.123444e-03 3 1  ON 41
ci_043                 5.094779e-03 3 1  ON 42
ci_044                 4.423179e-03 3 1  ON 43
ci_045                 5.134227e-03 3 1  ON 44
ci_046                 5.270923e-03 3 1  ON 45
ci_047                -3.975281e-03 3 1  ON 46
ci_048                -4.391744e-03 3 1  ON 47
ci_049                 4.071036e-03 3 1  ON 48
ci_050                 3.474370e-03 3 1  ON 49
ci_051                -3.066853e-03 3 1  ON 50
ci_052                -2.182982e-03 3 1  ON 51
ci_053                -2.742367e-03 3 1  ON 52
ci_054                -3.472230e-03 3 1  ON 53
ci_055                -1.937709e-03 3 1  ON 54
ci_056                -2.005068e-03 3 1  ON 55
ci_057                -1.785142e-03 3 1  ON 56
ci_058                -1.819890e-03 3 1  ON 57
ci_059                -1.894119e-03 3 1  ON 58
ci_060                -2.083888e-03 3 1  ON 59
ci_061                -1.834554e-03 3 1  ON 60
ci_062                -1.924314e-03 3 1  ON 61
ci_063                -1.939834e-03 3 1  ON 62
ci_064                -9.368893e-04 3 1  ON 63
ci_065                -1.769414e-03 3 1  ON 64
ci_066                -1.408001e-03 3 1  ON 65
ci_067                -1.989696e-03 3 1  ON 66
ci_068                -1.521975e-03 3 1  ON 67
ci_069                 1.138854e-03 3 1  ON 68
ci_070                 1.595884e-03 3 1  ON 69
ci_071                 2.746557e-05 3 1  ON 70
ci_072                -2.335841e-04 3 1  ON 71
ci_073                 1.366618e-03 3 1  ON 72
ci_074                 8.865170e-04 3 1  ON 73
ci_075                -1.348832e-03 3 1  ON 74
ci_076                -7.319835e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.4271
    reference variance = 2.788
====================================================
  Execution time = 2.3148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7306e+00
  Total weights = 1.9501e+06
  Execution time = 4.3517e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781776524343
                                         uncertainty =       0.042140735992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781776524343
                                         uncertainty =       0.042140735992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374994215
  error estimate for blocks of size 2^( 2) =       0.001445970783
  error estimate for blocks of size 2^( 3) =       0.001508809836
  error estimate for blocks of size 2^( 4) =       0.001553287702
  error estimate for blocks of size 2^( 5) =       0.001577433261
  error estimate for blocks of size 2^( 6) =       0.001588004350
  error estimate for blocks of size 2^( 7) =       0.001598738049

      target function =                  N/A
              le_mean =     -22.327176063571
             les_mean =     502.233384222306
             stat err =       0.001579365841
             autocorr =       1.319361295334
              std dev =       1.944566579135
             le_variance =       3.781339180689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781776518850
                                         uncertainty =       0.042140735801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781776518850
                                         uncertainty =       0.042140735801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374994214
  error estimate for blocks of size 2^( 2) =       0.001445970783
  error estimate for blocks of size 2^( 3) =       0.001508809836
  error estimate for blocks of size 2^( 4) =       0.001553287703
  error estimate for blocks of size 2^( 5) =       0.001577433263
  error estimate for blocks of size 2^( 6) =       0.001588004353
  error estimate for blocks of size 2^( 7) =       0.001598738051

      target function =                  N/A
              le_mean =     -22.327176063760
             les_mean =     502.233384212586
             stat err =       0.001579365842
             autocorr =       1.319361300057
              std dev =       1.944566577715
             le_variance =       3.781339175168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781776521596
                                         uncertainty =       0.042140735897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781776521596
                                         uncertainty =       0.042140735897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374994214
  error estimate for blocks of size 2^( 2) =       0.001445970783
  error estimate for blocks of size 2^( 3) =       0.001508809836
  error estimate for blocks of size 2^( 4) =       0.001553287703
  error estimate for blocks of size 2^( 5) =       0.001577433262
  error estimate for blocks of size 2^( 6) =       0.001588004352
  error estimate for blocks of size 2^( 7) =       0.001598738050

      target function =                  N/A
              le_mean =     -22.327176063666
             les_mean =     502.233384217439
             stat err =       0.001579365842
             autocorr =       1.319361297696
              std dev =       1.944566578425
             le_variance =       3.781339177928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781776523999
                                         uncertainty =       0.042140735980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781776523999
                                         uncertainty =       0.042140735980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374994215
  error estimate for blocks of size 2^( 2) =       0.001445970783
  error estimate for blocks of size 2^( 3) =       0.001508809836
  error estimate for blocks of size 2^( 4) =       0.001553287702
  error estimate for blocks of size 2^( 5) =       0.001577433261
  error estimate for blocks of size 2^( 6) =       0.001588004351
  error estimate for blocks of size 2^( 7) =       0.001598738049

      target function =                  N/A
              le_mean =     -22.327176063583
             les_mean =     502.233384221697
             stat err =       0.001579365841
             autocorr =       1.319361295630
              std dev =       1.944566579046
             le_variance =       3.781339180344


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327176063571        initial
     1.4901e+04     1.4901e+05             2.8204e-08       -22.327176063760  <--
     5.9605e+04     5.9605e+05             7.0510e-09       -22.327176063666
     2.3842e+05     2.3842e+06             1.7627e-09       -22.327176063583

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 4.4984e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187506e-02 3 1  ON 2
ci_004                -6.235963e-02 3 1  ON 3
ci_005                 4.605297e-02 3 1  ON 4
ci_006                 4.617152e-02 3 1  ON 5
ci_007                 3.181963e-02 3 1  ON 6
ci_008                 3.146820e-02 3 1  ON 7
ci_009                -2.501552e-02 3 1  ON 8
ci_010                -2.553487e-02 3 1  ON 9
ci_011                -2.290095e-02 3 1  ON 10
ci_012                -2.258352e-02 3 1  ON 11
ci_013                 2.001102e-02 3 1  ON 12
ci_014                 2.020474e-02 3 1  ON 13
ci_015                 1.968960e-02 3 1  ON 14
ci_016                 2.074992e-02 3 1  ON 15
ci_017                 1.537429e-02 3 1  ON 16
ci_018                 1.572224e-02 3 1  ON 17
ci_019                 1.064002e-02 3 1  ON 18
ci_020                 1.044006e-02 3 1  ON 19
ci_021                -9.778809e-03 3 1  ON 20
ci_022                -9.436133e-03 3 1  ON 21
ci_023                 8.740055e-03 3 1  ON 22
ci_024                 9.497535e-03 3 1  ON 23
ci_025                 7.133697e-03 3 1  ON 24
ci_026                 8.150631e-03 3 1  ON 25
ci_027                 7.920688e-03 3 1  ON 26
ci_028                 7.855862e-03 3 1  ON 27
ci_029                -7.650151e-03 3 1  ON 28
ci_030                -7.775449e-03 3 1  ON 29
ci_031                -7.190628e-03 3 1  ON 30
ci_032                -7.557126e-03 3 1  ON 31
ci_033                 6.842287e-03 3 1  ON 32
ci_034                 6.312694e-03 3 1  ON 33
ci_035                 6.419776e-03 3 1  ON 34
ci_036                 6.977755e-03 3 1  ON 35
ci_037                 6.510506e-03 3 1  ON 36
ci_038                 5.592973e-03 3 1  ON 37
ci_039                 5.925383e-03 3 1  ON 38
ci_040                 6.143281e-03 3 1  ON 39
ci_041                 5.439232e-03 3 1  ON 40
ci_042                 5.123434e-03 3 1  ON 41
ci_043                 5.094770e-03 3 1  ON 42
ci_044                 4.423190e-03 3 1  ON 43
ci_045                 5.134229e-03 3 1  ON 44
ci_046                 5.270923e-03 3 1  ON 45
ci_047                -3.975285e-03 3 1  ON 46
ci_048                -4.391742e-03 3 1  ON 47
ci_049                 4.071035e-03 3 1  ON 48
ci_050                 3.474365e-03 3 1  ON 49
ci_051                -3.066874e-03 3 1  ON 50
ci_052                -2.182976e-03 3 1  ON 51
ci_053                -2.742364e-03 3 1  ON 52
ci_054                -3.472223e-03 3 1  ON 53
ci_055                -1.937708e-03 3 1  ON 54
ci_056                -2.005059e-03 3 1  ON 55
ci_057                -1.785149e-03 3 1  ON 56
ci_058                -1.819887e-03 3 1  ON 57
ci_059                -1.894120e-03 3 1  ON 58
ci_060                -2.083890e-03 3 1  ON 59
ci_061                -1.834558e-03 3 1  ON 60
ci_062                -1.924320e-03 3 1  ON 61
ci_063                -1.939823e-03 3 1  ON 62
ci_064                -9.368881e-04 3 1  ON 63
ci_065                -1.769410e-03 3 1  ON 64
ci_066                -1.408000e-03 3 1  ON 65
ci_067                -1.989693e-03 3 1  ON 66
ci_068                -1.521955e-03 3 1  ON 67
ci_069                 1.138867e-03 3 1  ON 68
ci_070                 1.595884e-03 3 1  ON 69
ci_071                 2.746756e-05 3 1  ON 70
ci_072                -2.335887e-04 3 1  ON 71
ci_073                 1.366628e-03 3 1  ON 72
ci_074                 8.865295e-04 3 1  ON 73
ci_075                -1.348832e-03 3 1  ON 74
ci_076                -7.319737e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4586e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2292e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.0271
    reference variance = 5.87302
====================================================
  Execution time = 2.3749e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0306e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7066e+00
  Total weights = 1.949600981e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8268e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758392841276
                                         uncertainty =       0.044826371113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758392841276
                                         uncertainty =       0.044826371113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370932692
  error estimate for blocks of size 2^( 2) =       0.001442299134
  error estimate for blocks of size 2^( 3) =       0.001505443685
  error estimate for blocks of size 2^( 4) =       0.001550094444
  error estimate for blocks of size 2^( 5) =       0.001577985059
  error estimate for blocks of size 2^( 6) =       0.001593599457
  error estimate for blocks of size 2^( 7) =       0.001602607887

      target function =                  N/A
              le_mean =     -22.327411003088
             les_mean =     502.219925481696
             stat err =       0.001581071712
             autocorr =       1.330058891709
              std dev =       1.938822626590
             le_variance =       3.759033177377


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232741100309e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327411002276       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327411006162       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327411006727       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327411006736       residual = 1.59e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+03 is 1.110186e-07

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327411002276       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327411003248       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327411003389       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327411003382       residual = 1.59e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+04 is 2.775641e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327411002276       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327411002519       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327411002554       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327411002555       residual = 1.59e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+04 is 6.939214e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076411 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9583e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187504e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605295e-02 3 1  ON 4
ci_006                 4.617150e-02 3 1  ON 5
ci_007                 3.181962e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501552e-02 3 1  ON 8
ci_010                -2.553486e-02 3 1  ON 9
ci_011                -2.290094e-02 3 1  ON 10
ci_012                -2.258353e-02 3 1  ON 11
ci_013                 2.001100e-02 3 1  ON 12
ci_014                 2.020475e-02 3 1  ON 13
ci_015                 1.968960e-02 3 1  ON 14
ci_016                 2.074991e-02 3 1  ON 15
ci_017                 1.537429e-02 3 1  ON 16
ci_018                 1.572224e-02 3 1  ON 17
ci_019                 1.064001e-02 3 1  ON 18
ci_020                 1.044006e-02 3 1  ON 19
ci_021                -9.778818e-03 3 1  ON 20
ci_022                -9.436141e-03 3 1  ON 21
ci_023                 8.740055e-03 3 1  ON 22
ci_024                 9.497525e-03 3 1  ON 23
ci_025                 7.133700e-03 3 1  ON 24
ci_026                 8.150637e-03 3 1  ON 25
ci_027                 7.920690e-03 3 1  ON 26
ci_028                 7.855843e-03 3 1  ON 27
ci_029                -7.650148e-03 3 1  ON 28
ci_030                -7.775463e-03 3 1  ON 29
ci_031                -7.190633e-03 3 1  ON 30
ci_032                -7.557126e-03 3 1  ON 31
ci_033                 6.842284e-03 3 1  ON 32
ci_034                 6.312714e-03 3 1  ON 33
ci_035                 6.419772e-03 3 1  ON 34
ci_036                 6.977739e-03 3 1  ON 35
ci_037                 6.510513e-03 3 1  ON 36
ci_038                 5.592982e-03 3 1  ON 37
ci_039                 5.925387e-03 3 1  ON 38
ci_040                 6.143265e-03 3 1  ON 39
ci_041                 5.439227e-03 3 1  ON 40
ci_042                 5.123430e-03 3 1  ON 41
ci_043                 5.094777e-03 3 1  ON 42
ci_044                 4.423196e-03 3 1  ON 43
ci_045                 5.134237e-03 3 1  ON 44
ci_046                 5.270910e-03 3 1  ON 45
ci_047                -3.975272e-03 3 1  ON 46
ci_048                -4.391729e-03 3 1  ON 47
ci_049                 4.071034e-03 3 1  ON 48
ci_050                 3.474359e-03 3 1  ON 49
ci_051                -3.066862e-03 3 1  ON 50
ci_052                -2.182984e-03 3 1  ON 51
ci_053                -2.742350e-03 3 1  ON 52
ci_054                -3.472205e-03 3 1  ON 53
ci_055                -1.937700e-03 3 1  ON 54
ci_056                -2.005051e-03 3 1  ON 55
ci_057                -1.785153e-03 3 1  ON 56
ci_058                -1.819879e-03 3 1  ON 57
ci_059                -1.894147e-03 3 1  ON 58
ci_060                -2.083869e-03 3 1  ON 59
ci_061                -1.834560e-03 3 1  ON 60
ci_062                -1.924339e-03 3 1  ON 61
ci_063                -1.939807e-03 3 1  ON 62
ci_064                -9.368859e-04 3 1  ON 63
ci_065                -1.769407e-03 3 1  ON 64
ci_066                -1.408014e-03 3 1  ON 65
ci_067                -1.989685e-03 3 1  ON 66
ci_068                -1.521961e-03 3 1  ON 67
ci_069                 1.138871e-03 3 1  ON 68
ci_070                 1.595878e-03 3 1  ON 69
ci_071                 2.744280e-05 3 1  ON 70
ci_072                -2.336014e-04 3 1  ON 71
ci_073                 1.366618e-03 3 1  ON 72
ci_074                 8.865212e-04 3 1  ON 73
ci_075                -1.348816e-03 3 1  ON 74
ci_076                -7.319813e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.1767
    reference variance = 3.20345
====================================================
  Execution time = 2.3243e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7561e+00
  Total weights = 1.9498e+06
  Execution time = 4.3510e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807358526282
                                         uncertainty =       0.050338060172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807358526282
                                         uncertainty =       0.050338060172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379762662
  error estimate for blocks of size 2^( 2) =       0.001449576669
  error estimate for blocks of size 2^( 3) =       0.001512591068
  error estimate for blocks of size 2^( 4) =       0.001556346845
  error estimate for blocks of size 2^( 5) =       0.001579483650
  error estimate for blocks of size 2^( 6) =       0.001593234802
  error estimate for blocks of size 2^( 7) =       0.001608976045

      target function =                  N/A
              le_mean =     -22.327259702038
             les_mean =     502.262636598013
             stat err =       0.001584510336
             autocorr =       1.318807402180
              std dev =       1.951310290240
             le_variance =       3.807611848798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807358484291
                                         uncertainty =       0.050338059734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807358484291
                                         uncertainty =       0.050338059734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379762655
  error estimate for blocks of size 2^( 2) =       0.001449576665
  error estimate for blocks of size 2^( 3) =       0.001512591068
  error estimate for blocks of size 2^( 4) =       0.001556346847
  error estimate for blocks of size 2^( 5) =       0.001579483655
  error estimate for blocks of size 2^( 6) =       0.001593234806
  error estimate for blocks of size 2^( 7) =       0.001608976048

      target function =                  N/A
              le_mean =     -22.327259699891
             les_mean =     502.262636420915
             stat err =       0.001584510339
             autocorr =       1.318807422437
              std dev =       1.951310279497
             le_variance =       3.807611806873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807358505285
                                         uncertainty =       0.050338059953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807358505285
                                         uncertainty =       0.050338059953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379762659
  error estimate for blocks of size 2^( 2) =       0.001449576667
  error estimate for blocks of size 2^( 3) =       0.001512591068
  error estimate for blocks of size 2^( 4) =       0.001556346846
  error estimate for blocks of size 2^( 5) =       0.001579483653
  error estimate for blocks of size 2^( 6) =       0.001593234804
  error estimate for blocks of size 2^( 7) =       0.001608976046

      target function =                  N/A
              le_mean =     -22.327259700965
             les_mean =     502.262636509393
             stat err =       0.001584510337
             autocorr =       1.318807412309
              std dev =       1.951310284869
             le_variance =       3.807611827834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807358523657
                                         uncertainty =       0.050338060144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807358523657
                                         uncertainty =       0.050338060144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379762662
  error estimate for blocks of size 2^( 2) =       0.001449576669
  error estimate for blocks of size 2^( 3) =       0.001512591068
  error estimate for blocks of size 2^( 4) =       0.001556346845
  error estimate for blocks of size 2^( 5) =       0.001579483651
  error estimate for blocks of size 2^( 6) =       0.001593234803
  error estimate for blocks of size 2^( 7) =       0.001608976045

      target function =                  N/A
              le_mean =     -22.327259701904
             les_mean =     502.262636586928
             stat err =       0.001584510336
             autocorr =       1.318807403447
              std dev =       1.951310289569
             le_variance =       3.807611846177


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327259702038        initial  <--
     3.7253e+03     3.7253e+04             1.1102e-07       -22.327259699891
     1.4901e+04     1.4901e+05             2.7756e-08       -22.327259700965
     5.9605e+04     5.9605e+05             6.9392e-09       -22.327259701904

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0939
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187506e-02 3 1  ON 2
ci_004                -6.235963e-02 3 1  ON 3
ci_005                 4.605297e-02 3 1  ON 4
ci_006                 4.617152e-02 3 1  ON 5
ci_007                 3.181963e-02 3 1  ON 6
ci_008                 3.146820e-02 3 1  ON 7
ci_009                -2.501552e-02 3 1  ON 8
ci_010                -2.553487e-02 3 1  ON 9
ci_011                -2.290095e-02 3 1  ON 10
ci_012                -2.258352e-02 3 1  ON 11
ci_013                 2.001102e-02 3 1  ON 12
ci_014                 2.020474e-02 3 1  ON 13
ci_015                 1.968960e-02 3 1  ON 14
ci_016                 2.074992e-02 3 1  ON 15
ci_017                 1.537429e-02 3 1  ON 16
ci_018                 1.572224e-02 3 1  ON 17
ci_019                 1.064002e-02 3 1  ON 18
ci_020                 1.044006e-02 3 1  ON 19
ci_021                -9.778809e-03 3 1  ON 20
ci_022                -9.436133e-03 3 1  ON 21
ci_023                 8.740055e-03 3 1  ON 22
ci_024                 9.497535e-03 3 1  ON 23
ci_025                 7.133697e-03 3 1  ON 24
ci_026                 8.150631e-03 3 1  ON 25
ci_027                 7.920688e-03 3 1  ON 26
ci_028                 7.855862e-03 3 1  ON 27
ci_029                -7.650151e-03 3 1  ON 28
ci_030                -7.775449e-03 3 1  ON 29
ci_031                -7.190628e-03 3 1  ON 30
ci_032                -7.557126e-03 3 1  ON 31
ci_033                 6.842287e-03 3 1  ON 32
ci_034                 6.312694e-03 3 1  ON 33
ci_035                 6.419776e-03 3 1  ON 34
ci_036                 6.977755e-03 3 1  ON 35
ci_037                 6.510506e-03 3 1  ON 36
ci_038                 5.592973e-03 3 1  ON 37
ci_039                 5.925383e-03 3 1  ON 38
ci_040                 6.143281e-03 3 1  ON 39
ci_041                 5.439232e-03 3 1  ON 40
ci_042                 5.123434e-03 3 1  ON 41
ci_043                 5.094770e-03 3 1  ON 42
ci_044                 4.423190e-03 3 1  ON 43
ci_045                 5.134229e-03 3 1  ON 44
ci_046                 5.270923e-03 3 1  ON 45
ci_047                -3.975285e-03 3 1  ON 46
ci_048                -4.391742e-03 3 1  ON 47
ci_049                 4.071035e-03 3 1  ON 48
ci_050                 3.474365e-03 3 1  ON 49
ci_051                -3.066874e-03 3 1  ON 50
ci_052                -2.182976e-03 3 1  ON 51
ci_053                -2.742364e-03 3 1  ON 52
ci_054                -3.472223e-03 3 1  ON 53
ci_055                -1.937708e-03 3 1  ON 54
ci_056                -2.005059e-03 3 1  ON 55
ci_057                -1.785149e-03 3 1  ON 56
ci_058                -1.819887e-03 3 1  ON 57
ci_059                -1.894120e-03 3 1  ON 58
ci_060                -2.083890e-03 3 1  ON 59
ci_061                -1.834558e-03 3 1  ON 60
ci_062                -1.924320e-03 3 1  ON 61
ci_063                -1.939823e-03 3 1  ON 62
ci_064                -9.368881e-04 3 1  ON 63
ci_065                -1.769410e-03 3 1  ON 64
ci_066                -1.408000e-03 3 1  ON 65
ci_067                -1.989693e-03 3 1  ON 66
ci_068                -1.521955e-03 3 1  ON 67
ci_069                 1.138867e-03 3 1  ON 68
ci_070                 1.595884e-03 3 1  ON 69
ci_071                 2.746756e-05 3 1  ON 70
ci_072                -2.335887e-04 3 1  ON 71
ci_073                 1.366628e-03 3 1  ON 72
ci_074                 8.865295e-04 3 1  ON 73
ci_075                -1.348832e-03 3 1  ON 74
ci_076                -7.319737e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4684e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2286e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.222
    reference variance = 3.39909
====================================================
  Execution time = 2.3821e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0284e+04
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.6925e+00
  Total weights = 1.950091209e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8364e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741893066382
                                         uncertainty =       0.025044731329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741893066382
                                         uncertainty =       0.025044731329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367754231
  error estimate for blocks of size 2^( 2) =       0.001439662096
  error estimate for blocks of size 2^( 3) =       0.001500678928
  error estimate for blocks of size 2^( 4) =       0.001545991457
  error estimate for blocks of size 2^( 5) =       0.001570961975
  error estimate for blocks of size 2^( 6) =       0.001581631760
  error estimate for blocks of size 2^( 7) =       0.001589388188

      target function =                  N/A
              le_mean =     -22.330607374496
             les_mean =     502.348478194078
             stat err =       0.001571993345
             autocorr =       1.320946633673
              std dev =       1.934327532118
             le_variance =       3.741623001509


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233060737450e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330607373739       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330607374080       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330607374082       residual = 2.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+04 is 1.400029e-08

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330607373739       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330607373825       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330607373825       residual = 2.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+05 is 3.500086e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330607373739       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330607373761       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330607373761       residual = 2.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+05 is 8.750222e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077589 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9665e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187505e-02 3 1  ON 2
ci_004                -6.235963e-02 3 1  ON 3
ci_005                 4.605296e-02 3 1  ON 4
ci_006                 4.617152e-02 3 1  ON 5
ci_007                 3.181963e-02 3 1  ON 6
ci_008                 3.146820e-02 3 1  ON 7
ci_009                -2.501552e-02 3 1  ON 8
ci_010                -2.553487e-02 3 1  ON 9
ci_011                -2.290095e-02 3 1  ON 10
ci_012                -2.258352e-02 3 1  ON 11
ci_013                 2.001102e-02 3 1  ON 12
ci_014                 2.020474e-02 3 1  ON 13
ci_015                 1.968960e-02 3 1  ON 14
ci_016                 2.074991e-02 3 1  ON 15
ci_017                 1.537429e-02 3 1  ON 16
ci_018                 1.572224e-02 3 1  ON 17
ci_019                 1.064002e-02 3 1  ON 18
ci_020                 1.044006e-02 3 1  ON 19
ci_021                -9.778807e-03 3 1  ON 20
ci_022                -9.436133e-03 3 1  ON 21
ci_023                 8.740056e-03 3 1  ON 22
ci_024                 9.497533e-03 3 1  ON 23
ci_025                 7.133697e-03 3 1  ON 24
ci_026                 8.150630e-03 3 1  ON 25
ci_027                 7.920689e-03 3 1  ON 26
ci_028                 7.855862e-03 3 1  ON 27
ci_029                -7.650151e-03 3 1  ON 28
ci_030                -7.775449e-03 3 1  ON 29
ci_031                -7.190627e-03 3 1  ON 30
ci_032                -7.557125e-03 3 1  ON 31
ci_033                 6.842287e-03 3 1  ON 32
ci_034                 6.312696e-03 3 1  ON 33
ci_035                 6.419777e-03 3 1  ON 34
ci_036                 6.977756e-03 3 1  ON 35
ci_037                 6.510506e-03 3 1  ON 36
ci_038                 5.592976e-03 3 1  ON 37
ci_039                 5.925383e-03 3 1  ON 38
ci_040                 6.143282e-03 3 1  ON 39
ci_041                 5.439233e-03 3 1  ON 40
ci_042                 5.123433e-03 3 1  ON 41
ci_043                 5.094767e-03 3 1  ON 42
ci_044                 4.423191e-03 3 1  ON 43
ci_045                 5.134226e-03 3 1  ON 44
ci_046                 5.270922e-03 3 1  ON 45
ci_047                -3.975285e-03 3 1  ON 46
ci_048                -4.391742e-03 3 1  ON 47
ci_049                 4.071033e-03 3 1  ON 48
ci_050                 3.474367e-03 3 1  ON 49
ci_051                -3.066876e-03 3 1  ON 50
ci_052                -2.182977e-03 3 1  ON 51
ci_053                -2.742363e-03 3 1  ON 52
ci_054                -3.472223e-03 3 1  ON 53
ci_055                -1.937709e-03 3 1  ON 54
ci_056                -2.005058e-03 3 1  ON 55
ci_057                -1.785150e-03 3 1  ON 56
ci_058                -1.819888e-03 3 1  ON 57
ci_059                -1.894120e-03 3 1  ON 58
ci_060                -2.083889e-03 3 1  ON 59
ci_061                -1.834557e-03 3 1  ON 60
ci_062                -1.924320e-03 3 1  ON 61
ci_063                -1.939824e-03 3 1  ON 62
ci_064                -9.368899e-04 3 1  ON 63
ci_065                -1.769409e-03 3 1  ON 64
ci_066                -1.408000e-03 3 1  ON 65
ci_067                -1.989694e-03 3 1  ON 66
ci_068                -1.521955e-03 3 1  ON 67
ci_069                 1.138868e-03 3 1  ON 68
ci_070                 1.595884e-03 3 1  ON 69
ci_071                 2.746652e-05 3 1  ON 70
ci_072                -2.335884e-04 3 1  ON 71
ci_073                 1.366627e-03 3 1  ON 72
ci_074                 8.865304e-04 3 1  ON 73
ci_075                -1.348830e-03 3 1  ON 74
ci_076                -7.319743e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.2743
    reference variance = 2.7028
====================================================
  Execution time = 2.3190e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7758e+00
  Total weights = 1.9497e+06
  Execution time = 4.3518e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.827920204516
                                         uncertainty =       0.087255104647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.827920204516
                                         uncertainty =       0.087255104647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383327556
  error estimate for blocks of size 2^( 2) =       0.001453633117
  error estimate for blocks of size 2^( 3) =       0.001516251536
  error estimate for blocks of size 2^( 4) =       0.001559120870
  error estimate for blocks of size 2^( 5) =       0.001581686192
  error estimate for blocks of size 2^( 6) =       0.001591340162
  error estimate for blocks of size 2^( 7) =       0.001606565445

      target function =                  N/A
              le_mean =     -22.329506046102
             les_mean =     502.382673835283
             stat err =       0.001584678167
             autocorr =       1.312296868592
              std dev =       1.956351891771
             le_variance =       3.827312724434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.827920193259
                                         uncertainty =       0.087255104831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.827920193259
                                         uncertainty =       0.087255104831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383327554
  error estimate for blocks of size 2^( 2) =       0.001453633115
  error estimate for blocks of size 2^( 3) =       0.001516251535
  error estimate for blocks of size 2^( 4) =       0.001559120869
  error estimate for blocks of size 2^( 5) =       0.001581686190
  error estimate for blocks of size 2^( 6) =       0.001591340159
  error estimate for blocks of size 2^( 7) =       0.001606565441

      target function =                  N/A
              le_mean =     -22.329506046359
             les_mean =     502.382673661434
             stat err =       0.001584678165
             autocorr =       1.312296868583
              std dev =       1.956351888886
             le_variance =       3.827312713147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.827920198888
                                         uncertainty =       0.087255104739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.827920198888
                                         uncertainty =       0.087255104739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383327555
  error estimate for blocks of size 2^( 2) =       0.001453633116
  error estimate for blocks of size 2^( 3) =       0.001516251535
  error estimate for blocks of size 2^( 4) =       0.001559120869
  error estimate for blocks of size 2^( 5) =       0.001581686191
  error estimate for blocks of size 2^( 6) =       0.001591340160
  error estimate for blocks of size 2^( 7) =       0.001606565443

      target function =                  N/A
              le_mean =     -22.329506046231
             les_mean =     502.382673748356
             stat err =       0.001584678166
             autocorr =       1.312296868587
              std dev =       1.956351890328
             le_variance =       3.827312718790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.827920203812
                                         uncertainty =       0.087255104658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.827920203812
                                         uncertainty =       0.087255104658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383327556
  error estimate for blocks of size 2^( 2) =       0.001453633117
  error estimate for blocks of size 2^( 3) =       0.001516251536
  error estimate for blocks of size 2^( 4) =       0.001559120870
  error estimate for blocks of size 2^( 5) =       0.001581686192
  error estimate for blocks of size 2^( 6) =       0.001591340162
  error estimate for blocks of size 2^( 7) =       0.001606565444

      target function =                  N/A
              le_mean =     -22.329506046118
             les_mean =     502.382673824417
             stat err =       0.001584678167
             autocorr =       1.312296868591
              std dev =       1.956351891590
             le_variance =       3.827312723729


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329506046102        initial
     3.7253e+04     3.7253e+05             1.4000e-08       -22.329506046359  <--
     1.4901e+05     1.4901e+06             3.5001e-09       -22.329506046231
     5.9605e+05     5.9605e+06             8.7502e-10       -22.329506046118

*****************************************************************************
Applying the update for shift_i =   3.7253e+04     and shift_s =   3.7253e+05
*****************************************************************************

  Execution time = 4.5033e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187505e-02 3 1  ON 2
ci_004                -6.235963e-02 3 1  ON 3
ci_005                 4.605295e-02 3 1  ON 4
ci_006                 4.617152e-02 3 1  ON 5
ci_007                 3.181963e-02 3 1  ON 6
ci_008                 3.146820e-02 3 1  ON 7
ci_009                -2.501552e-02 3 1  ON 8
ci_010                -2.553486e-02 3 1  ON 9
ci_011                -2.290096e-02 3 1  ON 10
ci_012                -2.258352e-02 3 1  ON 11
ci_013                 2.001102e-02 3 1  ON 12
ci_014                 2.020473e-02 3 1  ON 13
ci_015                 1.968960e-02 3 1  ON 14
ci_016                 2.074991e-02 3 1  ON 15
ci_017                 1.537429e-02 3 1  ON 16
ci_018                 1.572224e-02 3 1  ON 17
ci_019                 1.064002e-02 3 1  ON 18
ci_020                 1.044005e-02 3 1  ON 19
ci_021                -9.778802e-03 3 1  ON 20
ci_022                -9.436132e-03 3 1  ON 21
ci_023                 8.740059e-03 3 1  ON 22
ci_024                 9.497528e-03 3 1  ON 23
ci_025                 7.133697e-03 3 1  ON 24
ci_026                 8.150627e-03 3 1  ON 25
ci_027                 7.920692e-03 3 1  ON 26
ci_028                 7.855862e-03 3 1  ON 27
ci_029                -7.650154e-03 3 1  ON 28
ci_030                -7.775450e-03 3 1  ON 29
ci_031                -7.190626e-03 3 1  ON 30
ci_032                -7.557123e-03 3 1  ON 31
ci_033                 6.842287e-03 3 1  ON 32
ci_034                 6.312701e-03 3 1  ON 33
ci_035                 6.419780e-03 3 1  ON 34
ci_036                 6.977757e-03 3 1  ON 35
ci_037                 6.510504e-03 3 1  ON 36
ci_038                 5.592983e-03 3 1  ON 37
ci_039                 5.925383e-03 3 1  ON 38
ci_040                 6.143284e-03 3 1  ON 39
ci_041                 5.439237e-03 3 1  ON 40
ci_042                 5.123431e-03 3 1  ON 41
ci_043                 5.094758e-03 3 1  ON 42
ci_044                 4.423192e-03 3 1  ON 43
ci_045                 5.134215e-03 3 1  ON 44
ci_046                 5.270921e-03 3 1  ON 45
ci_047                -3.975286e-03 3 1  ON 46
ci_048                -4.391742e-03 3 1  ON 47
ci_049                 4.071030e-03 3 1  ON 48
ci_050                 3.474372e-03 3 1  ON 49
ci_051                -3.066883e-03 3 1  ON 50
ci_052                -2.182981e-03 3 1  ON 51
ci_053                -2.742360e-03 3 1  ON 52
ci_054                -3.472222e-03 3 1  ON 53
ci_055                -1.937712e-03 3 1  ON 54
ci_056                -2.005055e-03 3 1  ON 55
ci_057                -1.785152e-03 3 1  ON 56
ci_058                -1.819889e-03 3 1  ON 57
ci_059                -1.894119e-03 3 1  ON 58
ci_060                -2.083888e-03 3 1  ON 59
ci_061                -1.834554e-03 3 1  ON 60
ci_062                -1.924323e-03 3 1  ON 61
ci_063                -1.939826e-03 3 1  ON 62
ci_064                -9.368954e-04 3 1  ON 63
ci_065                -1.769407e-03 3 1  ON 64
ci_066                -1.408002e-03 3 1  ON 65
ci_067                -1.989697e-03 3 1  ON 66
ci_068                -1.521955e-03 3 1  ON 67
ci_069                 1.138872e-03 3 1  ON 68
ci_070                 1.595884e-03 3 1  ON 69
ci_071                 2.746340e-05 3 1  ON 70
ci_072                -2.335875e-04 3 1  ON 71
ci_073                 1.366624e-03 3 1  ON 72
ci_074                 8.865328e-04 3 1  ON 73
ci_075                -1.348825e-03 3 1  ON 74
ci_076                -7.319758e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4706e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2285e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.4663
    reference variance = 2.80044
====================================================
  Execution time = 2.3813e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0280e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6874e+00
  Total weights = 1.950077523e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8282e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.736780236808
                                         uncertainty =       0.032380831151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.736780236808
                                         uncertainty =       0.032380831151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366985850
  error estimate for blocks of size 2^( 2) =       0.001437957226
  error estimate for blocks of size 2^( 3) =       0.001501866872
  error estimate for blocks of size 2^( 4) =       0.001544711405
  error estimate for blocks of size 2^( 5) =       0.001565324109
  error estimate for blocks of size 2^( 6) =       0.001583324548
  error estimate for blocks of size 2^( 7) =       0.001586892332

      target function =                  N/A
              le_mean =     -22.327810934220
             les_mean =     502.218558398173
             stat err =       0.001570063099
             autocorr =       1.319186428439
              std dev =       1.933240859841
             le_variance =       3.737420222160


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232781093422e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327810933405       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327810935343       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327810935339       residual = 2.26e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+03 is 4.726755e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327810933405       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327810933889       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327810933888       residual = 2.26e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+04 is 1.181705e-08

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327810933405       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327810933526       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327810933526       residual = 2.26e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+05 is 2.954274e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.078764 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9649e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187506e-02 3 1  ON 2
ci_004                -6.235963e-02 3 1  ON 3
ci_005                 4.605295e-02 3 1  ON 4
ci_006                 4.617153e-02 3 1  ON 5
ci_007                 3.181963e-02 3 1  ON 6
ci_008                 3.146820e-02 3 1  ON 7
ci_009                -2.501552e-02 3 1  ON 8
ci_010                -2.553487e-02 3 1  ON 9
ci_011                -2.290096e-02 3 1  ON 10
ci_012                -2.258350e-02 3 1  ON 11
ci_013                 2.001102e-02 3 1  ON 12
ci_014                 2.020473e-02 3 1  ON 13
ci_015                 1.968960e-02 3 1  ON 14
ci_016                 2.074991e-02 3 1  ON 15
ci_017                 1.537429e-02 3 1  ON 16
ci_018                 1.572223e-02 3 1  ON 17
ci_019                 1.064002e-02 3 1  ON 18
ci_020                 1.044006e-02 3 1  ON 19
ci_021                -9.778804e-03 3 1  ON 20
ci_022                -9.436143e-03 3 1  ON 21
ci_023                 8.740065e-03 3 1  ON 22
ci_024                 9.497533e-03 3 1  ON 23
ci_025                 7.133702e-03 3 1  ON 24
ci_026                 8.150625e-03 3 1  ON 25
ci_027                 7.920690e-03 3 1  ON 26
ci_028                 7.855860e-03 3 1  ON 27
ci_029                -7.650150e-03 3 1  ON 28
ci_030                -7.775450e-03 3 1  ON 29
ci_031                -7.190634e-03 3 1  ON 30
ci_032                -7.557123e-03 3 1  ON 31
ci_033                 6.842283e-03 3 1  ON 32
ci_034                 6.312702e-03 3 1  ON 33
ci_035                 6.419781e-03 3 1  ON 34
ci_036                 6.977754e-03 3 1  ON 35
ci_037                 6.510503e-03 3 1  ON 36
ci_038                 5.592986e-03 3 1  ON 37
ci_039                 5.925384e-03 3 1  ON 38
ci_040                 6.143289e-03 3 1  ON 39
ci_041                 5.439233e-03 3 1  ON 40
ci_042                 5.123432e-03 3 1  ON 41
ci_043                 5.094762e-03 3 1  ON 42
ci_044                 4.423194e-03 3 1  ON 43
ci_045                 5.134215e-03 3 1  ON 44
ci_046                 5.270929e-03 3 1  ON 45
ci_047                -3.975286e-03 3 1  ON 46
ci_048                -4.391743e-03 3 1  ON 47
ci_049                 4.071029e-03 3 1  ON 48
ci_050                 3.474373e-03 3 1  ON 49
ci_051                -3.066883e-03 3 1  ON 50
ci_052                -2.182979e-03 3 1  ON 51
ci_053                -2.742361e-03 3 1  ON 52
ci_054                -3.472217e-03 3 1  ON 53
ci_055                -1.937717e-03 3 1  ON 54
ci_056                -2.005054e-03 3 1  ON 55
ci_057                -1.785150e-03 3 1  ON 56
ci_058                -1.819894e-03 3 1  ON 57
ci_059                -1.894120e-03 3 1  ON 58
ci_060                -2.083888e-03 3 1  ON 59
ci_061                -1.834561e-03 3 1  ON 60
ci_062                -1.924318e-03 3 1  ON 61
ci_063                -1.939816e-03 3 1  ON 62
ci_064                -9.368965e-04 3 1  ON 63
ci_065                -1.769413e-03 3 1  ON 64
ci_066                -1.407999e-03 3 1  ON 65
ci_067                -1.989693e-03 3 1  ON 66
ci_068                -1.521954e-03 3 1  ON 67
ci_069                 1.138873e-03 3 1  ON 68
ci_070                 1.595880e-03 3 1  ON 69
ci_071                 2.746142e-05 3 1  ON 70
ci_072                -2.335988e-04 3 1  ON 71
ci_073                 1.366621e-03 3 1  ON 72
ci_074                 8.865417e-04 3 1  ON 73
ci_075                -1.348819e-03 3 1  ON 74
ci_076                -7.319754e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.2912
    reference variance = 3.46735
====================================================
  Execution time = 2.3249e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7385e+00
  Total weights = 1.9499e+06
  Execution time = 4.3445e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788735107442
                                         uncertainty =       0.055421894479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788735107442
                                         uncertainty =       0.055421894479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376375658
  error estimate for blocks of size 2^( 2) =       0.001448020102
  error estimate for blocks of size 2^( 3) =       0.001511489469
  error estimate for blocks of size 2^( 4) =       0.001558688827
  error estimate for blocks of size 2^( 5) =       0.001585401492
  error estimate for blocks of size 2^( 6) =       0.001602369920
  error estimate for blocks of size 2^( 7) =       0.001614113654

      target function =                  N/A
              le_mean =     -22.329369819213
             les_mean =     502.339222188777
             stat err =       0.001590143473
             autocorr =       1.334746083797
              std dev =       1.946520266174
             le_variance =       3.788941146626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788735108917
                                         uncertainty =       0.055421894569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788735108917
                                         uncertainty =       0.055421894569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376375658
  error estimate for blocks of size 2^( 2) =       0.001448020101
  error estimate for blocks of size 2^( 3) =       0.001511489468
  error estimate for blocks of size 2^( 4) =       0.001558688825
  error estimate for blocks of size 2^( 5) =       0.001585401490
  error estimate for blocks of size 2^( 6) =       0.001602369918
  error estimate for blocks of size 2^( 7) =       0.001614113654

      target function =                  N/A
              le_mean =     -22.329369819677
             les_mean =     502.339222183295
             stat err =       0.001590143472
             autocorr =       1.334746081166
              std dev =       1.946520266560
             le_variance =       3.788941148131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788735108179
                                         uncertainty =       0.055421894524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788735108179
                                         uncertainty =       0.055421894524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376375658
  error estimate for blocks of size 2^( 2) =       0.001448020101
  error estimate for blocks of size 2^( 3) =       0.001511489469
  error estimate for blocks of size 2^( 4) =       0.001558688826
  error estimate for blocks of size 2^( 5) =       0.001585401491
  error estimate for blocks of size 2^( 6) =       0.001602369919
  error estimate for blocks of size 2^( 7) =       0.001614113654

      target function =                  N/A
              le_mean =     -22.329369819445
             les_mean =     502.339222186003
             stat err =       0.001590143472
             autocorr =       1.334746082482
              std dev =       1.946520266367
             le_variance =       3.788941147378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788735107534
                                         uncertainty =       0.055421894484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788735107534
                                         uncertainty =       0.055421894484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376375658
  error estimate for blocks of size 2^( 2) =       0.001448020102
  error estimate for blocks of size 2^( 3) =       0.001511489469
  error estimate for blocks of size 2^( 4) =       0.001558688826
  error estimate for blocks of size 2^( 5) =       0.001585401491
  error estimate for blocks of size 2^( 6) =       0.001602369919
  error estimate for blocks of size 2^( 7) =       0.001614113654

      target function =                  N/A
              le_mean =     -22.329369819242
             les_mean =     502.339222188426
             stat err =       0.001590143473
             autocorr =       1.334746083634
              std dev =       1.946520266198
             le_variance =       3.788941146720


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329369819213        initial
     9.3132e+03     9.3132e+04             4.7268e-08       -22.329369819677  <--
     3.7253e+04     3.7253e+05             1.1817e-08       -22.329369819445
     1.4901e+05     1.4901e+06             2.9543e-09       -22.329369819242

*****************************************************************************
Applying the update for shift_i =   9.3132e+03     and shift_s =   9.3132e+04
*****************************************************************************

  Execution time = 4.6693e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235961e-02 3 1  ON 3
ci_005                 4.605295e-02 3 1  ON 4
ci_006                 4.617155e-02 3 1  ON 5
ci_007                 3.181961e-02 3 1  ON 6
ci_008                 3.146820e-02 3 1  ON 7
ci_009                -2.501551e-02 3 1  ON 8
ci_010                -2.553489e-02 3 1  ON 9
ci_011                -2.290094e-02 3 1  ON 10
ci_012                -2.258347e-02 3 1  ON 11
ci_013                 2.001104e-02 3 1  ON 12
ci_014                 2.020472e-02 3 1  ON 13
ci_015                 1.968959e-02 3 1  ON 14
ci_016                 2.074991e-02 3 1  ON 15
ci_017                 1.537428e-02 3 1  ON 16
ci_018                 1.572223e-02 3 1  ON 17
ci_019                 1.064002e-02 3 1  ON 18
ci_020                 1.044007e-02 3 1  ON 19
ci_021                -9.778812e-03 3 1  ON 20
ci_022                -9.436174e-03 3 1  ON 21
ci_023                 8.740083e-03 3 1  ON 22
ci_024                 9.497550e-03 3 1  ON 23
ci_025                 7.133718e-03 3 1  ON 24
ci_026                 8.150619e-03 3 1  ON 25
ci_027                 7.920681e-03 3 1  ON 26
ci_028                 7.855854e-03 3 1  ON 27
ci_029                -7.650140e-03 3 1  ON 28
ci_030                -7.775452e-03 3 1  ON 29
ci_031                -7.190660e-03 3 1  ON 30
ci_032                -7.557124e-03 3 1  ON 31
ci_033                 6.842273e-03 3 1  ON 32
ci_034                 6.312704e-03 3 1  ON 33
ci_035                 6.419784e-03 3 1  ON 34
ci_036                 6.977745e-03 3 1  ON 35
ci_037                 6.510503e-03 3 1  ON 36
ci_038                 5.592997e-03 3 1  ON 37
ci_039                 5.925385e-03 3 1  ON 38
ci_040                 6.143305e-03 3 1  ON 39
ci_041                 5.439220e-03 3 1  ON 40
ci_042                 5.123437e-03 3 1  ON 41
ci_043                 5.094775e-03 3 1  ON 42
ci_044                 4.423197e-03 3 1  ON 43
ci_045                 5.134214e-03 3 1  ON 44
ci_046                 5.270953e-03 3 1  ON 45
ci_047                -3.975285e-03 3 1  ON 46
ci_048                -4.391747e-03 3 1  ON 47
ci_049                 4.071025e-03 3 1  ON 48
ci_050                 3.474377e-03 3 1  ON 49
ci_051                -3.066882e-03 3 1  ON 50
ci_052                -2.182972e-03 3 1  ON 51
ci_053                -2.742364e-03 3 1  ON 52
ci_054                -3.472202e-03 3 1  ON 53
ci_055                -1.937734e-03 3 1  ON 54
ci_056                -2.005050e-03 3 1  ON 55
ci_057                -1.785142e-03 3 1  ON 56
ci_058                -1.819909e-03 3 1  ON 57
ci_059                -1.894123e-03 3 1  ON 58
ci_060                -2.083887e-03 3 1  ON 59
ci_061                -1.834581e-03 3 1  ON 60
ci_062                -1.924302e-03 3 1  ON 61
ci_063                -1.939786e-03 3 1  ON 62
ci_064                -9.368999e-04 3 1  ON 63
ci_065                -1.769430e-03 3 1  ON 64
ci_066                -1.407992e-03 3 1  ON 65
ci_067                -1.989681e-03 3 1  ON 66
ci_068                -1.521952e-03 3 1  ON 67
ci_069                 1.138874e-03 3 1  ON 68
ci_070                 1.595870e-03 3 1  ON 69
ci_071                 2.745546e-05 3 1  ON 70
ci_072                -2.336327e-04 3 1  ON 71
ci_073                 1.366610e-03 3 1  ON 72
ci_074                 8.865685e-04 3 1  ON 73
ci_075                -1.348799e-03 3 1  ON 74
ci_076                -7.319740e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6348e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2288e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.1911
    reference variance = 2.4988
====================================================
  Execution time = 2.3873e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0338e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7617e+00
  Total weights = 1.949721047e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9394e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810967194701
                                         uncertainty =       0.043937259406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810967194701
                                         uncertainty =       0.043937259406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380633962
  error estimate for blocks of size 2^( 2) =       0.001451717502
  error estimate for blocks of size 2^( 3) =       0.001514876553
  error estimate for blocks of size 2^( 4) =       0.001558876629
  error estimate for blocks of size 2^( 5) =       0.001587671822
  error estimate for blocks of size 2^( 6) =       0.001600262785
  error estimate for blocks of size 2^( 7) =       0.001605774038

      target function =                  N/A
              le_mean =     -22.325983273680
             les_mean =     502.211210849134
             stat err =       0.001588146318
             autocorr =       1.323195208529
              std dev =       1.952542514014
             le_variance =       3.812422269031


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232598327368e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325983272841       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325983281232       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325983281218       residual = 1.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+03 is 1.875493e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325983272841       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325983274939       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325983274935       residual = 1.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+03 is 4.688991e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325983272841       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325983273365       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325983273364       residual = 1.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+04 is 1.172264e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079948 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9819e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187511e-02 3 1  ON 2
ci_004                -6.235960e-02 3 1  ON 3
ci_005                 4.605291e-02 3 1  ON 4
ci_006                 4.617156e-02 3 1  ON 5
ci_007                 3.181959e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501551e-02 3 1  ON 8
ci_010                -2.553488e-02 3 1  ON 9
ci_011                -2.290093e-02 3 1  ON 10
ci_012                -2.258348e-02 3 1  ON 11
ci_013                 2.001102e-02 3 1  ON 12
ci_014                 2.020474e-02 3 1  ON 13
ci_015                 1.968961e-02 3 1  ON 14
ci_016                 2.074992e-02 3 1  ON 15
ci_017                 1.537429e-02 3 1  ON 16
ci_018                 1.572223e-02 3 1  ON 17
ci_019                 1.063998e-02 3 1  ON 18
ci_020                 1.044008e-02 3 1  ON 19
ci_021                -9.778833e-03 3 1  ON 20
ci_022                -9.436189e-03 3 1  ON 21
ci_023                 8.740082e-03 3 1  ON 22
ci_024                 9.497546e-03 3 1  ON 23
ci_025                 7.133739e-03 3 1  ON 24
ci_026                 8.150610e-03 3 1  ON 25
ci_027                 7.920680e-03 3 1  ON 26
ci_028                 7.855832e-03 3 1  ON 27
ci_029                -7.650119e-03 3 1  ON 28
ci_030                -7.775451e-03 3 1  ON 29
ci_031                -7.190673e-03 3 1  ON 30
ci_032                -7.557135e-03 3 1  ON 31
ci_033                 6.842266e-03 3 1  ON 32
ci_034                 6.312700e-03 3 1  ON 33
ci_035                 6.419780e-03 3 1  ON 34
ci_036                 6.977709e-03 3 1  ON 35
ci_037                 6.510488e-03 3 1  ON 36
ci_038                 5.593011e-03 3 1  ON 37
ci_039                 5.925357e-03 3 1  ON 38
ci_040                 6.143307e-03 3 1  ON 39
ci_041                 5.439222e-03 3 1  ON 40
ci_042                 5.123441e-03 3 1  ON 41
ci_043                 5.094790e-03 3 1  ON 42
ci_044                 4.423227e-03 3 1  ON 43
ci_045                 5.134182e-03 3 1  ON 44
ci_046                 5.270946e-03 3 1  ON 45
ci_047                -3.975273e-03 3 1  ON 46
ci_048                -4.391754e-03 3 1  ON 47
ci_049                 4.071015e-03 3 1  ON 48
ci_050                 3.474384e-03 3 1  ON 49
ci_051                -3.066891e-03 3 1  ON 50
ci_052                -2.182960e-03 3 1  ON 51
ci_053                -2.742366e-03 3 1  ON 52
ci_054                -3.472193e-03 3 1  ON 53
ci_055                -1.937733e-03 3 1  ON 54
ci_056                -2.005060e-03 3 1  ON 55
ci_057                -1.785151e-03 3 1  ON 56
ci_058                -1.819931e-03 3 1  ON 57
ci_059                -1.894120e-03 3 1  ON 58
ci_060                -2.083885e-03 3 1  ON 59
ci_061                -1.834606e-03 3 1  ON 60
ci_062                -1.924331e-03 3 1  ON 61
ci_063                -1.939778e-03 3 1  ON 62
ci_064                -9.369085e-04 3 1  ON 63
ci_065                -1.769420e-03 3 1  ON 64
ci_066                -1.408000e-03 3 1  ON 65
ci_067                -1.989662e-03 3 1  ON 66
ci_068                -1.521963e-03 3 1  ON 67
ci_069                 1.138904e-03 3 1  ON 68
ci_070                 1.595887e-03 3 1  ON 69
ci_071                 2.744667e-05 3 1  ON 70
ci_072                -2.336796e-04 3 1  ON 71
ci_073                 1.366591e-03 3 1  ON 72
ci_074                 8.865811e-04 3 1  ON 73
ci_075                -1.348797e-03 3 1  ON 74
ci_076                -7.319692e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.2304
    reference variance = 4.08616
====================================================
  Execution time = 2.3202e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7717e+00
  Total weights = 1.9496e+06
  Execution time = 4.3446e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.825179322663
                                         uncertainty =       0.081339813301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.825179322663
                                         uncertainty =       0.081339813301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382875582
  error estimate for blocks of size 2^( 2) =       0.001452465958
  error estimate for blocks of size 2^( 3) =       0.001516432727
  error estimate for blocks of size 2^( 4) =       0.001559823152
  error estimate for blocks of size 2^( 5) =       0.001582575342
  error estimate for blocks of size 2^( 6) =       0.001597095761
  error estimate for blocks of size 2^( 7) =       0.001610708714

      target function =                  N/A
              le_mean =     -22.325506191173
             les_mean =     502.199899304681
             stat err =       0.001587550742
             autocorr =       1.317919895819
              std dev =       1.955712693809
             le_variance =       3.824812140727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.825179297170
                                         uncertainty =       0.081339814041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.825179297170
                                         uncertainty =       0.081339814041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382875577
  error estimate for blocks of size 2^( 2) =       0.001452465958
  error estimate for blocks of size 2^( 3) =       0.001516432734
  error estimate for blocks of size 2^( 4) =       0.001559823162
  error estimate for blocks of size 2^( 5) =       0.001582575359
  error estimate for blocks of size 2^( 6) =       0.001597095777
  error estimate for blocks of size 2^( 7) =       0.001610708728

      target function =                  N/A
              le_mean =     -22.325506188659
             les_mean =     502.199899160510
             stat err =       0.001587550756
             autocorr =       1.317919928217
              std dev =       1.955712687269
             le_variance =       3.824812115145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.825179309915
                                         uncertainty =       0.081339813671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.825179309915
                                         uncertainty =       0.081339813671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382875580
  error estimate for blocks of size 2^( 2) =       0.001452465958
  error estimate for blocks of size 2^( 3) =       0.001516432730
  error estimate for blocks of size 2^( 4) =       0.001559823157
  error estimate for blocks of size 2^( 5) =       0.001582575350
  error estimate for blocks of size 2^( 6) =       0.001597095769
  error estimate for blocks of size 2^( 7) =       0.001610708721

      target function =                  N/A
              le_mean =     -22.325506189916
             les_mean =     502.199899232519
             stat err =       0.001587550749
             autocorr =       1.317919912019
              std dev =       1.955712690539
             le_variance =       3.824812127934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.825179321069
                                         uncertainty =       0.081339813347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.825179321069
                                         uncertainty =       0.081339813347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382875582
  error estimate for blocks of size 2^( 2) =       0.001452465958
  error estimate for blocks of size 2^( 3) =       0.001516432728
  error estimate for blocks of size 2^( 4) =       0.001559823153
  error estimate for blocks of size 2^( 5) =       0.001582575343
  error estimate for blocks of size 2^( 6) =       0.001597095762
  error estimate for blocks of size 2^( 7) =       0.001610708714

      target function =                  N/A
              le_mean =     -22.325506191016
             les_mean =     502.199899295652
             stat err =       0.001587550743
             autocorr =       1.317919897844
              std dev =       1.955712693401
             le_variance =       3.824812139128


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325506191173        initial  <--
     2.3283e+03     2.3283e+04             1.8755e-07       -22.325506188659
     9.3132e+03     9.3132e+04             4.6890e-08       -22.325506189916
     3.7253e+04     3.7253e+05             1.1723e-08       -22.325506191016

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0306
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235961e-02 3 1  ON 3
ci_005                 4.605295e-02 3 1  ON 4
ci_006                 4.617155e-02 3 1  ON 5
ci_007                 3.181961e-02 3 1  ON 6
ci_008                 3.146820e-02 3 1  ON 7
ci_009                -2.501551e-02 3 1  ON 8
ci_010                -2.553489e-02 3 1  ON 9
ci_011                -2.290094e-02 3 1  ON 10
ci_012                -2.258347e-02 3 1  ON 11
ci_013                 2.001104e-02 3 1  ON 12
ci_014                 2.020472e-02 3 1  ON 13
ci_015                 1.968959e-02 3 1  ON 14
ci_016                 2.074991e-02 3 1  ON 15
ci_017                 1.537428e-02 3 1  ON 16
ci_018                 1.572223e-02 3 1  ON 17
ci_019                 1.064002e-02 3 1  ON 18
ci_020                 1.044007e-02 3 1  ON 19
ci_021                -9.778812e-03 3 1  ON 20
ci_022                -9.436174e-03 3 1  ON 21
ci_023                 8.740083e-03 3 1  ON 22
ci_024                 9.497550e-03 3 1  ON 23
ci_025                 7.133718e-03 3 1  ON 24
ci_026                 8.150619e-03 3 1  ON 25
ci_027                 7.920681e-03 3 1  ON 26
ci_028                 7.855854e-03 3 1  ON 27
ci_029                -7.650140e-03 3 1  ON 28
ci_030                -7.775452e-03 3 1  ON 29
ci_031                -7.190660e-03 3 1  ON 30
ci_032                -7.557124e-03 3 1  ON 31
ci_033                 6.842273e-03 3 1  ON 32
ci_034                 6.312704e-03 3 1  ON 33
ci_035                 6.419784e-03 3 1  ON 34
ci_036                 6.977745e-03 3 1  ON 35
ci_037                 6.510503e-03 3 1  ON 36
ci_038                 5.592997e-03 3 1  ON 37
ci_039                 5.925385e-03 3 1  ON 38
ci_040                 6.143305e-03 3 1  ON 39
ci_041                 5.439220e-03 3 1  ON 40
ci_042                 5.123437e-03 3 1  ON 41
ci_043                 5.094775e-03 3 1  ON 42
ci_044                 4.423197e-03 3 1  ON 43
ci_045                 5.134214e-03 3 1  ON 44
ci_046                 5.270953e-03 3 1  ON 45
ci_047                -3.975285e-03 3 1  ON 46
ci_048                -4.391747e-03 3 1  ON 47
ci_049                 4.071025e-03 3 1  ON 48
ci_050                 3.474377e-03 3 1  ON 49
ci_051                -3.066882e-03 3 1  ON 50
ci_052                -2.182972e-03 3 1  ON 51
ci_053                -2.742364e-03 3 1  ON 52
ci_054                -3.472202e-03 3 1  ON 53
ci_055                -1.937734e-03 3 1  ON 54
ci_056                -2.005050e-03 3 1  ON 55
ci_057                -1.785142e-03 3 1  ON 56
ci_058                -1.819909e-03 3 1  ON 57
ci_059                -1.894123e-03 3 1  ON 58
ci_060                -2.083887e-03 3 1  ON 59
ci_061                -1.834581e-03 3 1  ON 60
ci_062                -1.924302e-03 3 1  ON 61
ci_063                -1.939786e-03 3 1  ON 62
ci_064                -9.368999e-04 3 1  ON 63
ci_065                -1.769430e-03 3 1  ON 64
ci_066                -1.407992e-03 3 1  ON 65
ci_067                -1.989681e-03 3 1  ON 66
ci_068                -1.521952e-03 3 1  ON 67
ci_069                 1.138874e-03 3 1  ON 68
ci_070                 1.595870e-03 3 1  ON 69
ci_071                 2.745546e-05 3 1  ON 70
ci_072                -2.336327e-04 3 1  ON 71
ci_073                 1.366610e-03 3 1  ON 72
ci_074                 8.865685e-04 3 1  ON 73
ci_075                -1.348799e-03 3 1  ON 74
ci_076                -7.319740e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4856e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2286e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.4398
    reference variance = 2.34688
====================================================
  Execution time = 2.3785e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0253e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.6966e+00
  Total weights = 1.950141306e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8904e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.748094246878
                                         uncertainty =       0.034098487632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.748094246878
                                         uncertainty =       0.034098487632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368939815
  error estimate for blocks of size 2^( 2) =       0.001440940916
  error estimate for blocks of size 2^( 3) =       0.001505426346
  error estimate for blocks of size 2^( 4) =       0.001548875936
  error estimate for blocks of size 2^( 5) =       0.001573166484
  error estimate for blocks of size 2^( 6) =       0.001587303104
  error estimate for blocks of size 2^( 7) =       0.001593040540

      target function =                  N/A
              le_mean =     -22.326735507544
             les_mean =     502.179707293372
             stat err =       0.001575596516
             autocorr =       1.324711522647
              std dev =       1.936004227552
             le_variance =       3.748112369100


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232673550754e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326735506745       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326735507518       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326735507510       residual = 2.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+04 is 1.868041e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326735506745       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326735506938       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326735506936       residual = 2.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+04 is 4.670127e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326735506745       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326735506793       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326735506793       residual = 2.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+05 is 1.167533e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081149 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9682e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235962e-02 3 1  ON 3
ci_005                 4.605295e-02 3 1  ON 4
ci_006                 4.617155e-02 3 1  ON 5
ci_007                 3.181961e-02 3 1  ON 6
ci_008                 3.146820e-02 3 1  ON 7
ci_009                -2.501551e-02 3 1  ON 8
ci_010                -2.553489e-02 3 1  ON 9
ci_011                -2.290094e-02 3 1  ON 10
ci_012                -2.258347e-02 3 1  ON 11
ci_013                 2.001103e-02 3 1  ON 12
ci_014                 2.020472e-02 3 1  ON 13
ci_015                 1.968959e-02 3 1  ON 14
ci_016                 2.074992e-02 3 1  ON 15
ci_017                 1.537428e-02 3 1  ON 16
ci_018                 1.572223e-02 3 1  ON 17
ci_019                 1.064002e-02 3 1  ON 18
ci_020                 1.044007e-02 3 1  ON 19
ci_021                -9.778812e-03 3 1  ON 20
ci_022                -9.436173e-03 3 1  ON 21
ci_023                 8.740083e-03 3 1  ON 22
ci_024                 9.497548e-03 3 1  ON 23
ci_025                 7.133721e-03 3 1  ON 24
ci_026                 8.150617e-03 3 1  ON 25
ci_027                 7.920681e-03 3 1  ON 26
ci_028                 7.855853e-03 3 1  ON 27
ci_029                -7.650138e-03 3 1  ON 28
ci_030                -7.775451e-03 3 1  ON 29
ci_031                -7.190661e-03 3 1  ON 30
ci_032                -7.557124e-03 3 1  ON 31
ci_033                 6.842271e-03 3 1  ON 32
ci_034                 6.312706e-03 3 1  ON 33
ci_035                 6.419787e-03 3 1  ON 34
ci_036                 6.977743e-03 3 1  ON 35
ci_037                 6.510506e-03 3 1  ON 36
ci_038                 5.592998e-03 3 1  ON 37
ci_039                 5.925385e-03 3 1  ON 38
ci_040                 6.143302e-03 3 1  ON 39
ci_041                 5.439222e-03 3 1  ON 40
ci_042                 5.123439e-03 3 1  ON 41
ci_043                 5.094775e-03 3 1  ON 42
ci_044                 4.423202e-03 3 1  ON 43
ci_045                 5.134214e-03 3 1  ON 44
ci_046                 5.270951e-03 3 1  ON 45
ci_047                -3.975285e-03 3 1  ON 46
ci_048                -4.391744e-03 3 1  ON 47
ci_049                 4.071020e-03 3 1  ON 48
ci_050                 3.474379e-03 3 1  ON 49
ci_051                -3.066882e-03 3 1  ON 50
ci_052                -2.182973e-03 3 1  ON 51
ci_053                -2.742367e-03 3 1  ON 52
ci_054                -3.472201e-03 3 1  ON 53
ci_055                -1.937732e-03 3 1  ON 54
ci_056                -2.005052e-03 3 1  ON 55
ci_057                -1.785142e-03 3 1  ON 56
ci_058                -1.819909e-03 3 1  ON 57
ci_059                -1.894123e-03 3 1  ON 58
ci_060                -2.083890e-03 3 1  ON 59
ci_061                -1.834580e-03 3 1  ON 60
ci_062                -1.924303e-03 3 1  ON 61
ci_063                -1.939785e-03 3 1  ON 62
ci_064                -9.369000e-04 3 1  ON 63
ci_065                -1.769428e-03 3 1  ON 64
ci_066                -1.407990e-03 3 1  ON 65
ci_067                -1.989679e-03 3 1  ON 66
ci_068                -1.521953e-03 3 1  ON 67
ci_069                 1.138873e-03 3 1  ON 68
ci_070                 1.595866e-03 3 1  ON 69
ci_071                 2.745418e-05 3 1  ON 70
ci_072                -2.336355e-04 3 1  ON 71
ci_073                 1.366611e-03 3 1  ON 72
ci_074                 8.865684e-04 3 1  ON 73
ci_075                -1.348797e-03 3 1  ON 74
ci_076                -7.319705e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.1718
    reference variance = 4.14993
====================================================
  Execution time = 2.3262e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7454e+00
  Total weights = 1.9497e+06
  Execution time = 4.3472e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797989378463
                                         uncertainty =       0.038730301197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797989378463
                                         uncertainty =       0.038730301197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378013335
  error estimate for blocks of size 2^( 2) =       0.001450173561
  error estimate for blocks of size 2^( 3) =       0.001513257810
  error estimate for blocks of size 2^( 4) =       0.001558995037
  error estimate for blocks of size 2^( 5) =       0.001581398127
  error estimate for blocks of size 2^( 6) =       0.001596107112
  error estimate for blocks of size 2^( 7) =       0.001605293027

      target function =                  N/A
              le_mean =     -22.327905352556
             les_mean =     502.280745215379
             stat err =       0.001585448326
             autocorr =       1.323723695194
              std dev =       1.948836327717
             le_variance =       3.797963032230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797989377337
                                         uncertainty =       0.038730301185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797989377337
                                         uncertainty =       0.038730301185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378013335
  error estimate for blocks of size 2^( 2) =       0.001450173561
  error estimate for blocks of size 2^( 3) =       0.001513257810
  error estimate for blocks of size 2^( 4) =       0.001558995037
  error estimate for blocks of size 2^( 5) =       0.001581398126
  error estimate for blocks of size 2^( 6) =       0.001596107111
  error estimate for blocks of size 2^( 7) =       0.001605293026

      target function =                  N/A
              le_mean =     -22.327905352679
             les_mean =     502.280745241569
             stat err =       0.001585448325
             autocorr =       1.323723694304
              std dev =       1.948836327435
             le_variance =       3.797963031132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797989377900
                                         uncertainty =       0.038730301191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797989377900
                                         uncertainty =       0.038730301191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378013335
  error estimate for blocks of size 2^( 2) =       0.001450173561
  error estimate for blocks of size 2^( 3) =       0.001513257810
  error estimate for blocks of size 2^( 4) =       0.001558995037
  error estimate for blocks of size 2^( 5) =       0.001581398126
  error estimate for blocks of size 2^( 6) =       0.001596107111
  error estimate for blocks of size 2^( 7) =       0.001605293026

      target function =                  N/A
              le_mean =     -22.327905352617
             les_mean =     502.280745228471
             stat err =       0.001585448325
             autocorr =       1.323723694749
              std dev =       1.948836327576
             le_variance =       3.797963031681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797989378392
                                         uncertainty =       0.038730301197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797989378392
                                         uncertainty =       0.038730301197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378013335
  error estimate for blocks of size 2^( 2) =       0.001450173561
  error estimate for blocks of size 2^( 3) =       0.001513257810
  error estimate for blocks of size 2^( 4) =       0.001558995037
  error estimate for blocks of size 2^( 5) =       0.001581398127
  error estimate for blocks of size 2^( 6) =       0.001596107112
  error estimate for blocks of size 2^( 7) =       0.001605293027

      target function =                  N/A
              le_mean =     -22.327905352564
             les_mean =     502.280745217015
             stat err =       0.001585448325
             autocorr =       1.323723695139
              std dev =       1.948836327700
             le_variance =       3.797963032162


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327905352556        initial
     2.3283e+04     2.3283e+05             1.8680e-08       -22.327905352679  <--
     9.3132e+04     9.3132e+05             4.6701e-09       -22.327905352617
     3.7253e+05     3.7253e+06             1.1675e-09       -22.327905352564

*****************************************************************************
Applying the update for shift_i =   2.3283e+04     and shift_s =   2.3283e+05
*****************************************************************************

  Execution time = 4.5088e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187508e-02 3 1  ON 2
ci_004                -6.235963e-02 3 1  ON 3
ci_005                 4.605295e-02 3 1  ON 4
ci_006                 4.617155e-02 3 1  ON 5
ci_007                 3.181960e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501551e-02 3 1  ON 8
ci_010                -2.553488e-02 3 1  ON 9
ci_011                -2.290094e-02 3 1  ON 10
ci_012                -2.258346e-02 3 1  ON 11
ci_013                 2.001103e-02 3 1  ON 12
ci_014                 2.020473e-02 3 1  ON 13
ci_015                 1.968959e-02 3 1  ON 14
ci_016                 2.074992e-02 3 1  ON 15
ci_017                 1.537427e-02 3 1  ON 16
ci_018                 1.572224e-02 3 1  ON 17
ci_019                 1.064001e-02 3 1  ON 18
ci_020                 1.044007e-02 3 1  ON 19
ci_021                -9.778811e-03 3 1  ON 20
ci_022                -9.436171e-03 3 1  ON 21
ci_023                 8.740081e-03 3 1  ON 22
ci_024                 9.497542e-03 3 1  ON 23
ci_025                 7.133729e-03 3 1  ON 24
ci_026                 8.150610e-03 3 1  ON 25
ci_027                 7.920681e-03 3 1  ON 26
ci_028                 7.855851e-03 3 1  ON 27
ci_029                -7.650133e-03 3 1  ON 28
ci_030                -7.775449e-03 3 1  ON 29
ci_031                -7.190663e-03 3 1  ON 30
ci_032                -7.557125e-03 3 1  ON 31
ci_033                 6.842268e-03 3 1  ON 32
ci_034                 6.312709e-03 3 1  ON 33
ci_035                 6.419797e-03 3 1  ON 34
ci_036                 6.977738e-03 3 1  ON 35
ci_037                 6.510514e-03 3 1  ON 36
ci_038                 5.592999e-03 3 1  ON 37
ci_039                 5.925387e-03 3 1  ON 38
ci_040                 6.143292e-03 3 1  ON 39
ci_041                 5.439228e-03 3 1  ON 40
ci_042                 5.123446e-03 3 1  ON 41
ci_043                 5.094775e-03 3 1  ON 42
ci_044                 4.423215e-03 3 1  ON 43
ci_045                 5.134215e-03 3 1  ON 44
ci_046                 5.270948e-03 3 1  ON 45
ci_047                -3.975284e-03 3 1  ON 46
ci_048                -4.391735e-03 3 1  ON 47
ci_049                 4.071006e-03 3 1  ON 48
ci_050                 3.474385e-03 3 1  ON 49
ci_051                -3.066879e-03 3 1  ON 50
ci_052                -2.182974e-03 3 1  ON 51
ci_053                -2.742376e-03 3 1  ON 52
ci_054                -3.472197e-03 3 1  ON 53
ci_055                -1.937727e-03 3 1  ON 54
ci_056                -2.005058e-03 3 1  ON 55
ci_057                -1.785143e-03 3 1  ON 56
ci_058                -1.819909e-03 3 1  ON 57
ci_059                -1.894125e-03 3 1  ON 58
ci_060                -2.083900e-03 3 1  ON 59
ci_061                -1.834580e-03 3 1  ON 60
ci_062                -1.924305e-03 3 1  ON 61
ci_063                -1.939783e-03 3 1  ON 62
ci_064                -9.369002e-04 3 1  ON 63
ci_065                -1.769421e-03 3 1  ON 64
ci_066                -1.407983e-03 3 1  ON 65
ci_067                -1.989675e-03 3 1  ON 66
ci_068                -1.521956e-03 3 1  ON 67
ci_069                 1.138871e-03 3 1  ON 68
ci_070                 1.595856e-03 3 1  ON 69
ci_071                 2.745036e-05 3 1  ON 70
ci_072                -2.336439e-04 3 1  ON 71
ci_073                 1.366616e-03 3 1  ON 72
ci_074                 8.865680e-04 3 1  ON 73
ci_075                -1.348792e-03 3 1  ON 74
ci_076                -7.319600e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4777e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2286e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.2962
    reference variance = 2.9957
====================================================
  Execution time = 2.3794e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0320e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7861e+00
  Total weights = 1.949847661e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8768e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.839883190911
                                         uncertainty =       0.092442365358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.839883190911
                                         uncertainty =       0.092442365358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385566718
  error estimate for blocks of size 2^( 2) =       0.001456044711
  error estimate for blocks of size 2^( 3) =       0.001516298354
  error estimate for blocks of size 2^( 4) =       0.001558280031
  error estimate for blocks of size 2^( 5) =       0.001583939366
  error estimate for blocks of size 2^( 6) =       0.001598621542
  error estimate for blocks of size 2^( 7) =       0.001601266508

      target function =                  N/A
              le_mean =     -22.327651666613
             les_mean =     502.310158414785
             stat err =       0.001585526862
             autocorr =       1.309460259429
              std dev =       1.959518595990
             le_variance =       3.839713128029


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232765166661e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327651665821       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327651669698       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327651669880       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327651669874       residual = 8.24e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+03 is 1.101938e-07

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327651665821       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327651666790       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327651666836       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327651666834       residual = 8.24e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+04 is 2.754913e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327651665821       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327651666063       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327651666075       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327651666074       residual = 8.23e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+04 is 6.887326e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.082678 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9677e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.605295e-02 3 1  ON 4
ci_006                 4.617155e-02 3 1  ON 5
ci_007                 3.181959e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501551e-02 3 1  ON 8
ci_010                -2.553490e-02 3 1  ON 9
ci_011                -2.290094e-02 3 1  ON 10
ci_012                -2.258346e-02 3 1  ON 11
ci_013                 2.001103e-02 3 1  ON 12
ci_014                 2.020474e-02 3 1  ON 13
ci_015                 1.968960e-02 3 1  ON 14
ci_016                 2.074991e-02 3 1  ON 15
ci_017                 1.537428e-02 3 1  ON 16
ci_018                 1.572224e-02 3 1  ON 17
ci_019                 1.063999e-02 3 1  ON 18
ci_020                 1.044007e-02 3 1  ON 19
ci_021                -9.778822e-03 3 1  ON 20
ci_022                -9.436172e-03 3 1  ON 21
ci_023                 8.740093e-03 3 1  ON 22
ci_024                 9.497542e-03 3 1  ON 23
ci_025                 7.133738e-03 3 1  ON 24
ci_026                 8.150601e-03 3 1  ON 25
ci_027                 7.920669e-03 3 1  ON 26
ci_028                 7.855847e-03 3 1  ON 27
ci_029                -7.650143e-03 3 1  ON 28
ci_030                -7.775447e-03 3 1  ON 29
ci_031                -7.190666e-03 3 1  ON 30
ci_032                -7.557132e-03 3 1  ON 31
ci_033                 6.842274e-03 3 1  ON 32
ci_034                 6.312708e-03 3 1  ON 33
ci_035                 6.419793e-03 3 1  ON 34
ci_036                 6.977735e-03 3 1  ON 35
ci_037                 6.510508e-03 3 1  ON 36
ci_038                 5.593012e-03 3 1  ON 37
ci_039                 5.925398e-03 3 1  ON 38
ci_040                 6.143274e-03 3 1  ON 39
ci_041                 5.439227e-03 3 1  ON 40
ci_042                 5.123450e-03 3 1  ON 41
ci_043                 5.094778e-03 3 1  ON 42
ci_044                 4.423221e-03 3 1  ON 43
ci_045                 5.134206e-03 3 1  ON 44
ci_046                 5.270942e-03 3 1  ON 45
ci_047                -3.975285e-03 3 1  ON 46
ci_048                -4.391717e-03 3 1  ON 47
ci_049                 4.070997e-03 3 1  ON 48
ci_050                 3.474385e-03 3 1  ON 49
ci_051                -3.066881e-03 3 1  ON 50
ci_052                -2.182971e-03 3 1  ON 51
ci_053                -2.742366e-03 3 1  ON 52
ci_054                -3.472191e-03 3 1  ON 53
ci_055                -1.937722e-03 3 1  ON 54
ci_056                -2.005066e-03 3 1  ON 55
ci_057                -1.785150e-03 3 1  ON 56
ci_058                -1.819913e-03 3 1  ON 57
ci_059                -1.894126e-03 3 1  ON 58
ci_060                -2.083904e-03 3 1  ON 59
ci_061                -1.834593e-03 3 1  ON 60
ci_062                -1.924294e-03 3 1  ON 61
ci_063                -1.939774e-03 3 1  ON 62
ci_064                -9.369022e-04 3 1  ON 63
ci_065                -1.769427e-03 3 1  ON 64
ci_066                -1.407989e-03 3 1  ON 65
ci_067                -1.989672e-03 3 1  ON 66
ci_068                -1.521957e-03 3 1  ON 67
ci_069                 1.138878e-03 3 1  ON 68
ci_070                 1.595863e-03 3 1  ON 69
ci_071                 2.742281e-05 3 1  ON 70
ci_072                -2.336597e-04 3 1  ON 71
ci_073                 1.366612e-03 3 1  ON 72
ci_074                 8.865757e-04 3 1  ON 73
ci_075                -1.348785e-03 3 1  ON 74
ci_076                -7.319702e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.274
    reference variance = 2.32612
====================================================
  Execution time = 2.3196e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.7411e+00
  Total weights = 1.9500e+06
  Execution time = 4.3550e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793162702315
                                         uncertainty =       0.037091004736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793162702315
                                         uncertainty =       0.037091004736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377262406
  error estimate for blocks of size 2^( 2) =       0.001448176358
  error estimate for blocks of size 2^( 3) =       0.001509366901
  error estimate for blocks of size 2^( 4) =       0.001551157251
  error estimate for blocks of size 2^( 5) =       0.001571036964
  error estimate for blocks of size 2^( 6) =       0.001583506530
  error estimate for blocks of size 2^( 7) =       0.001592313491

      target function =                  N/A
              le_mean =     -22.330868253282
             les_mean =     502.408763200630
             stat err =       0.001574503559
             autocorr =       1.306934754619
              std dev =       1.947774337459
             le_variance =       3.793824869665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793162701702
                                         uncertainty =       0.037091003917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793162701702
                                         uncertainty =       0.037091003917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377262406
  error estimate for blocks of size 2^( 2) =       0.001448176357
  error estimate for blocks of size 2^( 3) =       0.001509366901
  error estimate for blocks of size 2^( 4) =       0.001551157250
  error estimate for blocks of size 2^( 5) =       0.001571036960
  error estimate for blocks of size 2^( 6) =       0.001583506525
  error estimate for blocks of size 2^( 7) =       0.001592313482

      target function =                  N/A
              le_mean =     -22.330868253784
             les_mean =     502.408763210942
             stat err =       0.001574503554
             autocorr =       1.306934746610
              std dev =       1.947774337285
             le_variance =       3.793824868986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793162702008
                                         uncertainty =       0.037091004326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793162702008
                                         uncertainty =       0.037091004326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377262406
  error estimate for blocks of size 2^( 2) =       0.001448176357
  error estimate for blocks of size 2^( 3) =       0.001509366901
  error estimate for blocks of size 2^( 4) =       0.001551157251
  error estimate for blocks of size 2^( 5) =       0.001571036962
  error estimate for blocks of size 2^( 6) =       0.001583506528
  error estimate for blocks of size 2^( 7) =       0.001592313486

      target function =                  N/A
              le_mean =     -22.330868253533
             les_mean =     502.408763205750
             stat err =       0.001574503557
             autocorr =       1.306934750614
              std dev =       1.947774337372
             le_variance =       3.793824869325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793162702276
                                         uncertainty =       0.037091004685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793162702276
                                         uncertainty =       0.037091004685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377262406
  error estimate for blocks of size 2^( 2) =       0.001448176358
  error estimate for blocks of size 2^( 3) =       0.001509366901
  error estimate for blocks of size 2^( 4) =       0.001551157251
  error estimate for blocks of size 2^( 5) =       0.001571036964
  error estimate for blocks of size 2^( 6) =       0.001583506530
  error estimate for blocks of size 2^( 7) =       0.001592313490

      target function =                  N/A
              le_mean =     -22.330868253313
             les_mean =     502.408763201266
             stat err =       0.001574503559
             autocorr =       1.306934754118
              std dev =       1.947774337448
             le_variance =       3.793824869623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330868253282        initial
     5.8208e+03     5.8208e+04             1.1019e-07       -22.330868253784  <--
     2.3283e+04     2.3283e+05             2.7549e-08       -22.330868253533
     9.3132e+04     9.3132e+05             6.8873e-09       -22.330868253313

*****************************************************************************
Applying the update for shift_i =   5.8208e+03     and shift_s =   5.8208e+04
*****************************************************************************

  Execution time = 4.5059e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235967e-02 3 1  ON 3
ci_005                 4.605294e-02 3 1  ON 4
ci_006                 4.617153e-02 3 1  ON 5
ci_007                 3.181957e-02 3 1  ON 6
ci_008                 3.146821e-02 3 1  ON 7
ci_009                -2.501554e-02 3 1  ON 8
ci_010                -2.553495e-02 3 1  ON 9
ci_011                -2.290093e-02 3 1  ON 10
ci_012                -2.258345e-02 3 1  ON 11
ci_013                 2.001103e-02 3 1  ON 12
ci_014                 2.020476e-02 3 1  ON 13
ci_015                 1.968961e-02 3 1  ON 14
ci_016                 2.074989e-02 3 1  ON 15
ci_017                 1.537430e-02 3 1  ON 16
ci_018                 1.572223e-02 3 1  ON 17
ci_019                 1.063994e-02 3 1  ON 18
ci_020                 1.044009e-02 3 1  ON 19
ci_021                -9.778855e-03 3 1  ON 20
ci_022                -9.436174e-03 3 1  ON 21
ci_023                 8.740130e-03 3 1  ON 22
ci_024                 9.497543e-03 3 1  ON 23
ci_025                 7.133763e-03 3 1  ON 24
ci_026                 8.150575e-03 3 1  ON 25
ci_027                 7.920634e-03 3 1  ON 26
ci_028                 7.855836e-03 3 1  ON 27
ci_029                -7.650174e-03 3 1  ON 28
ci_030                -7.775440e-03 3 1  ON 29
ci_031                -7.190675e-03 3 1  ON 30
ci_032                -7.557153e-03 3 1  ON 31
ci_033                 6.842293e-03 3 1  ON 32
ci_034                 6.312706e-03 3 1  ON 33
ci_035                 6.419781e-03 3 1  ON 34
ci_036                 6.977725e-03 3 1  ON 35
ci_037                 6.510487e-03 3 1  ON 36
ci_038                 5.593053e-03 3 1  ON 37
ci_039                 5.925430e-03 3 1  ON 38
ci_040                 6.143221e-03 3 1  ON 39
ci_041                 5.439226e-03 3 1  ON 40
ci_042                 5.123462e-03 3 1  ON 41
ci_043                 5.094788e-03 3 1  ON 42
ci_044                 4.423239e-03 3 1  ON 43
ci_045                 5.134181e-03 3 1  ON 44
ci_046                 5.270924e-03 3 1  ON 45
ci_047                -3.975286e-03 3 1  ON 46
ci_048                -4.391664e-03 3 1  ON 47
ci_049                 4.070968e-03 3 1  ON 48
ci_050                 3.474386e-03 3 1  ON 49
ci_051                -3.066885e-03 3 1  ON 50
ci_052                -2.182961e-03 3 1  ON 51
ci_053                -2.742334e-03 3 1  ON 52
ci_054                -3.472174e-03 3 1  ON 53
ci_055                -1.937709e-03 3 1  ON 54
ci_056                -2.005087e-03 3 1  ON 55
ci_057                -1.785172e-03 3 1  ON 56
ci_058                -1.819925e-03 3 1  ON 57
ci_059                -1.894130e-03 3 1  ON 58
ci_060                -2.083915e-03 3 1  ON 59
ci_061                -1.834634e-03 3 1  ON 60
ci_062                -1.924260e-03 3 1  ON 61
ci_063                -1.939745e-03 3 1  ON 62
ci_064                -9.369081e-04 3 1  ON 63
ci_065                -1.769443e-03 3 1  ON 64
ci_066                -1.408004e-03 3 1  ON 65
ci_067                -1.989661e-03 3 1  ON 66
ci_068                -1.521962e-03 3 1  ON 67
ci_069                 1.138899e-03 3 1  ON 68
ci_070                 1.595883e-03 3 1  ON 69
ci_071                 2.734017e-05 3 1  ON 70
ci_072                -2.337072e-04 3 1  ON 71
ci_073                 1.366602e-03 3 1  ON 72
ci_074                 8.865991e-04 3 1  ON 73
ci_075                -1.348762e-03 3 1  ON 74
ci_076                -7.320009e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4743e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2286e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.3202
    reference variance = 2.21896
====================================================
  Execution time = 2.3799e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0270e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.9676e+00
  Total weights = 1.949981463e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8225e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.021165040286
                                         uncertainty =       0.230422019732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.021165040286
                                         uncertainty =       0.230422019732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001417815734
  error estimate for blocks of size 2^( 2) =       0.001487225477
  error estimate for blocks of size 2^( 3) =       0.001548338923
  error estimate for blocks of size 2^( 4) =       0.001591208931
  error estimate for blocks of size 2^( 5) =       0.001614657183
  error estimate for blocks of size 2^( 6) =       0.001623306905
  error estimate for blocks of size 2^( 7) =       0.001630317786

      target function =                  N/A
              le_mean =     -22.328935022480
             les_mean =     502.548936950341
             stat err =       0.001614872701
             autocorr =       1.297289798446
              std dev =       2.005126321066
             le_variance =       4.020531563432


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232893502248e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328935021641       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328935031965       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328935031947       residual = 4.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+03 is 3.316373e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328935021641       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328935024222       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328935024218       residual = 4.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+03 is 8.292169e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328935021641       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328935022286       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328935022285       residual = 4.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+04 is 2.073119e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083905 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9629e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187506e-02 3 1  ON 2
ci_004                -6.235968e-02 3 1  ON 3
ci_005                 4.605293e-02 3 1  ON 4
ci_006                 4.617156e-02 3 1  ON 5
ci_007                 3.181958e-02 3 1  ON 6
ci_008                 3.146822e-02 3 1  ON 7
ci_009                -2.501558e-02 3 1  ON 8
ci_010                -2.553498e-02 3 1  ON 9
ci_011                -2.290092e-02 3 1  ON 10
ci_012                -2.258350e-02 3 1  ON 11
ci_013                 2.001106e-02 3 1  ON 12
ci_014                 2.020475e-02 3 1  ON 13
ci_015                 1.968963e-02 3 1  ON 14
ci_016                 2.074987e-02 3 1  ON 15
ci_017                 1.537431e-02 3 1  ON 16
ci_018                 1.572225e-02 3 1  ON 17
ci_019                 1.063990e-02 3 1  ON 18
ci_020                 1.044008e-02 3 1  ON 19
ci_021                -9.778849e-03 3 1  ON 20
ci_022                -9.436222e-03 3 1  ON 21
ci_023                 8.740151e-03 3 1  ON 22
ci_024                 9.497535e-03 3 1  ON 23
ci_025                 7.133797e-03 3 1  ON 24
ci_026                 8.150568e-03 3 1  ON 25
ci_027                 7.920681e-03 3 1  ON 26
ci_028                 7.855840e-03 3 1  ON 27
ci_029                -7.650166e-03 3 1  ON 28
ci_030                -7.775458e-03 3 1  ON 29
ci_031                -7.190640e-03 3 1  ON 30
ci_032                -7.557210e-03 3 1  ON 31
ci_033                 6.842297e-03 3 1  ON 32
ci_034                 6.312716e-03 3 1  ON 33
ci_035                 6.419768e-03 3 1  ON 34
ci_036                 6.977692e-03 3 1  ON 35
ci_037                 6.510472e-03 3 1  ON 36
ci_038                 5.593052e-03 3 1  ON 37
ci_039                 5.925446e-03 3 1  ON 38
ci_040                 6.143195e-03 3 1  ON 39
ci_041                 5.439235e-03 3 1  ON 40
ci_042                 5.123497e-03 3 1  ON 41
ci_043                 5.094762e-03 3 1  ON 42
ci_044                 4.423264e-03 3 1  ON 43
ci_045                 5.134198e-03 3 1  ON 44
ci_046                 5.270914e-03 3 1  ON 45
ci_047                -3.975295e-03 3 1  ON 46
ci_048                -4.391661e-03 3 1  ON 47
ci_049                 4.070955e-03 3 1  ON 48
ci_050                 3.474356e-03 3 1  ON 49
ci_051                -3.066875e-03 3 1  ON 50
ci_052                -2.182997e-03 3 1  ON 51
ci_053                -2.742383e-03 3 1  ON 52
ci_054                -3.472153e-03 3 1  ON 53
ci_055                -1.937668e-03 3 1  ON 54
ci_056                -2.005108e-03 3 1  ON 55
ci_057                -1.785169e-03 3 1  ON 56
ci_058                -1.819957e-03 3 1  ON 57
ci_059                -1.894093e-03 3 1  ON 58
ci_060                -2.083894e-03 3 1  ON 59
ci_061                -1.834611e-03 3 1  ON 60
ci_062                -1.924249e-03 3 1  ON 61
ci_063                -1.939712e-03 3 1  ON 62
ci_064                -9.369045e-04 3 1  ON 63
ci_065                -1.769432e-03 3 1  ON 64
ci_066                -1.407994e-03 3 1  ON 65
ci_067                -1.989632e-03 3 1  ON 66
ci_068                -1.521928e-03 3 1  ON 67
ci_069                 1.138916e-03 3 1  ON 68
ci_070                 1.595862e-03 3 1  ON 69
ci_071                 2.733622e-05 3 1  ON 70
ci_072                -2.337361e-04 3 1  ON 71
ci_073                 1.366519e-03 3 1  ON 72
ci_074                 8.865948e-04 3 1  ON 73
ci_075                -1.348730e-03 3 1  ON 74
ci_076                -7.319857e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.413
    reference variance = 2.77105
====================================================
  Execution time = 2.3215e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7666e+00
  Total weights = 1.9497e+06
  Execution time = 4.3401e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820136162416
                                         uncertainty =       0.053804695373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820136162416
                                         uncertainty =       0.053804695373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381951216
  error estimate for blocks of size 2^( 2) =       0.001452758297
  error estimate for blocks of size 2^( 3) =       0.001515033249
  error estimate for blocks of size 2^( 4) =       0.001555690866
  error estimate for blocks of size 2^( 5) =       0.001575559314
  error estimate for blocks of size 2^( 6) =       0.001578802724
  error estimate for blocks of size 2^( 7) =       0.001587980519

      target function =                  N/A
              le_mean =     -22.330022450904
             les_mean =     502.396528049704
             stat err =       0.001574508356
             autocorr =       1.298089134613
              std dev =       1.954405421798
             le_variance =       3.819700552752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820136171452
                                         uncertainty =       0.053804697060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820136171452
                                         uncertainty =       0.053804697060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381951218
  error estimate for blocks of size 2^( 2) =       0.001452758292
  error estimate for blocks of size 2^( 3) =       0.001515033237
  error estimate for blocks of size 2^( 4) =       0.001555690852
  error estimate for blocks of size 2^( 5) =       0.001575559299
  error estimate for blocks of size 2^( 6) =       0.001578802708
  error estimate for blocks of size 2^( 7) =       0.001587980509

      target function =                  N/A
              le_mean =     -22.330022451794
             les_mean =     502.396527955849
             stat err =       0.001574508342
             autocorr =       1.298089109166
              std dev =       1.954405424182
             le_variance =       3.819700562071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820136166932
                                         uncertainty =       0.053804696217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820136166932
                                         uncertainty =       0.053804696217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381951217
  error estimate for blocks of size 2^( 2) =       0.001452758295
  error estimate for blocks of size 2^( 3) =       0.001515033243
  error estimate for blocks of size 2^( 4) =       0.001555690859
  error estimate for blocks of size 2^( 5) =       0.001575559307
  error estimate for blocks of size 2^( 6) =       0.001578802716
  error estimate for blocks of size 2^( 7) =       0.001587980514

      target function =                  N/A
              le_mean =     -22.330022451349
             les_mean =     502.396528002288
             stat err =       0.001574508349
             autocorr =       1.298089121888
              std dev =       1.954405422989
             le_variance =       3.819700557410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820136162980
                                         uncertainty =       0.053804695478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820136162980
                                         uncertainty =       0.053804695478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381951216
  error estimate for blocks of size 2^( 2) =       0.001452758296
  error estimate for blocks of size 2^( 3) =       0.001515033248
  error estimate for blocks of size 2^( 4) =       0.001555690865
  error estimate for blocks of size 2^( 5) =       0.001575559313
  error estimate for blocks of size 2^( 6) =       0.001578802723
  error estimate for blocks of size 2^( 7) =       0.001587980518

      target function =                  N/A
              le_mean =     -22.330022450960
             les_mean =     502.396528043725
             stat err =       0.001574508355
             autocorr =       1.298089133021
              std dev =       1.954405421947
             le_variance =       3.819700553334


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330022450904        initial
     1.4552e+03     1.4552e+04             3.3164e-07       -22.330022451794  <--
     5.8208e+03     5.8208e+04             8.2922e-08       -22.330022451349
     2.3283e+04     2.3283e+05             2.0731e-08       -22.330022450960

*****************************************************************************
Applying the update for shift_i =   1.4552e+03     and shift_s =   1.4552e+04
*****************************************************************************

  Execution time = 4.5922e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187497e-02 3 1  ON 2
ci_004                -6.235971e-02 3 1  ON 3
ci_005                 4.605288e-02 3 1  ON 4
ci_006                 4.617163e-02 3 1  ON 5
ci_007                 3.181964e-02 3 1  ON 6
ci_008                 3.146827e-02 3 1  ON 7
ci_009                -2.501572e-02 3 1  ON 8
ci_010                -2.553506e-02 3 1  ON 9
ci_011                -2.290091e-02 3 1  ON 10
ci_012                -2.258363e-02 3 1  ON 11
ci_013                 2.001115e-02 3 1  ON 12
ci_014                 2.020471e-02 3 1  ON 13
ci_015                 1.968971e-02 3 1  ON 14
ci_016                 2.074980e-02 3 1  ON 15
ci_017                 1.537436e-02 3 1  ON 16
ci_018                 1.572231e-02 3 1  ON 17
ci_019                 1.063975e-02 3 1  ON 18
ci_020                 1.044005e-02 3 1  ON 19
ci_021                -9.778833e-03 3 1  ON 20
ci_022                -9.436365e-03 3 1  ON 21
ci_023                 8.740215e-03 3 1  ON 22
ci_024                 9.497513e-03 3 1  ON 23
ci_025                 7.133900e-03 3 1  ON 24
ci_026                 8.150546e-03 3 1  ON 25
ci_027                 7.920820e-03 3 1  ON 26
ci_028                 7.855854e-03 3 1  ON 27
ci_029                -7.650145e-03 3 1  ON 28
ci_030                -7.775514e-03 3 1  ON 29
ci_031                -7.190534e-03 3 1  ON 30
ci_032                -7.557382e-03 3 1  ON 31
ci_033                 6.842307e-03 3 1  ON 32
ci_034                 6.312746e-03 3 1  ON 33
ci_035                 6.419730e-03 3 1  ON 34
ci_036                 6.977593e-03 3 1  ON 35
ci_037                 6.510425e-03 3 1  ON 36
ci_038                 5.593047e-03 3 1  ON 37
ci_039                 5.925493e-03 3 1  ON 38
ci_040                 6.143118e-03 3 1  ON 39
ci_041                 5.439265e-03 3 1  ON 40
ci_042                 5.123601e-03 3 1  ON 41
ci_043                 5.094682e-03 3 1  ON 42
ci_044                 4.423341e-03 3 1  ON 43
ci_045                 5.134250e-03 3 1  ON 44
ci_046                 5.270883e-03 3 1  ON 45
ci_047                -3.975324e-03 3 1  ON 46
ci_048                -4.391653e-03 3 1  ON 47
ci_049                 4.070916e-03 3 1  ON 48
ci_050                 3.474268e-03 3 1  ON 49
ci_051                -3.066847e-03 3 1  ON 50
ci_052                -2.183107e-03 3 1  ON 51
ci_053                -2.742530e-03 3 1  ON 52
ci_054                -3.472092e-03 3 1  ON 53
ci_055                -1.937544e-03 3 1  ON 54
ci_056                -2.005170e-03 3 1  ON 55
ci_057                -1.785161e-03 3 1  ON 56
ci_058                -1.820055e-03 3 1  ON 57
ci_059                -1.893983e-03 3 1  ON 58
ci_060                -2.083831e-03 3 1  ON 59
ci_061                -1.834544e-03 3 1  ON 60
ci_062                -1.924216e-03 3 1  ON 61
ci_063                -1.939612e-03 3 1  ON 62
ci_064                -9.368938e-04 3 1  ON 63
ci_065                -1.769399e-03 3 1  ON 64
ci_066                -1.407964e-03 3 1  ON 65
ci_067                -1.989542e-03 3 1  ON 66
ci_068                -1.521825e-03 3 1  ON 67
ci_069                 1.138968e-03 3 1  ON 68
ci_070                 1.595798e-03 3 1  ON 69
ci_071                 2.732440e-05 3 1  ON 70
ci_072                -2.338227e-04 3 1  ON 71
ci_073                 1.366270e-03 3 1  ON 72
ci_074                 8.865818e-04 3 1  ON 73
ci_075                -1.348633e-03 3 1  ON 74
ci_076                -7.319400e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5556e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2288e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.515
    reference variance = 2.90099
====================================================
  Execution time = 2.3939e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0295e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6717e+00
  Total weights = 1.950122073e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8508e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722274458608
                                         uncertainty =       0.026945594136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722274458608
                                         uncertainty =       0.026945594136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364118306
  error estimate for blocks of size 2^( 2) =       0.001435387854
  error estimate for blocks of size 2^( 3) =       0.001498919548
  error estimate for blocks of size 2^( 4) =       0.001543173411
  error estimate for blocks of size 2^( 5) =       0.001566694191
  error estimate for blocks of size 2^( 6) =       0.001574758929
  error estimate for blocks of size 2^( 7) =       0.001581960110

      target function =                  N/A
              le_mean =     -22.330161190559
             les_mean =     502.307838179698
             stat err =       0.001566646660
             autocorr =       1.318979483287
              std dev =       1.929185475628
             le_variance =       3.721756599374


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233016119056e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330161189774       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330161241705       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330161241777       residual = 2.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+02 is 1.072382e-06

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330161189774       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330161202762       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330161202780       residual = 2.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+03 is 2.682073e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330161189774       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330161193021       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330161193026       residual = 2.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+03 is 6.705882e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085083 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9796e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_001                -6.963163e-01 3 1  ON 0
ci_002                -7.040927e-01 3 1  ON 1
ci_003                -6.187486e-02 3 1  ON 2
ci_004                -6.235983e-02 3 1  ON 3
ci_005                 4.605266e-02 3 1  ON 4
ci_006                 4.617153e-02 3 1  ON 5
ci_007                 3.181950e-02 3 1  ON 6
ci_008                 3.146833e-02 3 1  ON 7
ci_009                -2.501561e-02 3 1  ON 8
ci_010                -2.553505e-02 3 1  ON 9
ci_011                -2.290102e-02 3 1  ON 10
ci_012                -2.258374e-02 3 1  ON 11
ci_013                 2.001120e-02 3 1  ON 12
ci_014                 2.020474e-02 3 1  ON 13
ci_015                 1.968973e-02 3 1  ON 14
ci_016                 2.074999e-02 3 1  ON 15
ci_017                 1.537446e-02 3 1  ON 16
ci_018                 1.572248e-02 3 1  ON 17
ci_019                 1.063965e-02 3 1  ON 18
ci_020                 1.043993e-02 3 1  ON 19
ci_021                -9.778677e-03 3 1  ON 20
ci_022                -9.436550e-03 3 1  ON 21
ci_023                 8.740200e-03 3 1  ON 22
ci_024                 9.497244e-03 3 1  ON 23
ci_025                 7.134001e-03 3 1  ON 24
ci_026                 8.150752e-03 3 1  ON 25
ci_027                 7.920745e-03 3 1  ON 26
ci_028                 7.855751e-03 3 1  ON 27
ci_029                -7.649942e-03 3 1  ON 28
ci_030                -7.775590e-03 3 1  ON 29
ci_031                -7.190605e-03 3 1  ON 30
ci_032                -7.557272e-03 3 1  ON 31
ci_033                 6.842237e-03 3 1  ON 32
ci_034                 6.312837e-03 3 1  ON 33
ci_035                 6.419742e-03 3 1  ON 34
ci_036                 6.977481e-03 3 1  ON 35
ci_037                 6.510391e-03 3 1  ON 36
ci_038                 5.593176e-03 3 1  ON 37
ci_039                 5.925359e-03 3 1  ON 38
ci_040                 6.143179e-03 3 1  ON 39
ci_041                 5.439247e-03 3 1  ON 40
ci_042                 5.123610e-03 3 1  ON 41
ci_043                 5.094657e-03 3 1  ON 42
ci_044                 4.423463e-03 3 1  ON 43
ci_045                 5.134277e-03 3 1  ON 44
ci_046                 5.270928e-03 3 1  ON 45
ci_047                -3.975310e-03 3 1  ON 46
ci_048                -4.391687e-03 3 1  ON 47
ci_049                 4.070937e-03 3 1  ON 48
ci_050                 3.474206e-03 3 1  ON 49
ci_051                -3.066864e-03 3 1  ON 50
ci_052                -2.183313e-03 3 1  ON 51
ci_053                -2.742650e-03 3 1  ON 52
ci_054                -3.472044e-03 3 1  ON 53
ci_055                -1.937588e-03 3 1  ON 54
ci_056                -2.005272e-03 3 1  ON 55
ci_057                -1.785102e-03 3 1  ON 56
ci_058                -1.820005e-03 3 1  ON 57
ci_059                -1.894088e-03 3 1  ON 58
ci_060                -2.083603e-03 3 1  ON 59
ci_061                -1.834675e-03 3 1  ON 60
ci_062                -1.924045e-03 3 1  ON 61
ci_063                -1.939454e-03 3 1  ON 62
ci_064                -9.369194e-04 3 1  ON 63
ci_065                -1.769265e-03 3 1  ON 64
ci_066                -1.407897e-03 3 1  ON 65
ci_067                -1.989389e-03 3 1  ON 66
ci_068                -1.521702e-03 3 1  ON 67
ci_069                 1.139035e-03 3 1  ON 68
ci_070                 1.595802e-03 3 1  ON 69
ci_071                 2.715763e-05 3 1  ON 70
ci_072                -2.339106e-04 3 1  ON 71
ci_073                 1.366103e-03 3 1  ON 72
ci_074                 8.867334e-04 3 1  ON 73
ci_075                -1.348632e-03 3 1  ON 74
ci_076                -7.319108e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.3331
    reference variance = 2.38544
====================================================
  Execution time = 2.3202e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 4.1852e+00
  Total weights = 1.9504e+06
  Execution time = 4.3661e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.246211841511
                                         uncertainty =       0.336514725402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.246211841511
                                         uncertainty =       0.336514725402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001457018524
  error estimate for blocks of size 2^( 2) =       0.001523972052
  error estimate for blocks of size 2^( 3) =       0.001582102514
  error estimate for blocks of size 2^( 4) =       0.001625516210
  error estimate for blocks of size 2^( 5) =       0.001646958846
  error estimate for blocks of size 2^( 6) =       0.001662206859
  error estimate for blocks of size 2^( 7) =       0.001668024767

      target function =                  N/A
              le_mean =     -22.325502570294
             les_mean =     502.613296619455
             stat err =       0.001650676670
             autocorr =       1.283494110471
              std dev =       2.060568325324
             le_variance =       4.245941823328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.246211757551
                                         uncertainty =       0.336514733162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.246211757551
                                         uncertainty =       0.336514733162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001457018509
  error estimate for blocks of size 2^( 2) =       0.001523972061
  error estimate for blocks of size 2^( 3) =       0.001582102537
  error estimate for blocks of size 2^( 4) =       0.001625516231
  error estimate for blocks of size 2^( 5) =       0.001646958906
  error estimate for blocks of size 2^( 6) =       0.001662206916
  error estimate for blocks of size 2^( 7) =       0.001668024795

      target function =                  N/A
              le_mean =     -22.325502584858
             les_mean =     502.613301058125
             stat err =       0.001650676712
             autocorr =       1.283494200576
              std dev =       2.060568304706
             le_variance =       4.245941738357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.246211799479
                                         uncertainty =       0.336514729284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.246211799479
                                         uncertainty =       0.336514729284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001457018517
  error estimate for blocks of size 2^( 2) =       0.001523972056
  error estimate for blocks of size 2^( 3) =       0.001582102526
  error estimate for blocks of size 2^( 4) =       0.001625516220
  error estimate for blocks of size 2^( 5) =       0.001646958876
  error estimate for blocks of size 2^( 6) =       0.001662206888
  error estimate for blocks of size 2^( 7) =       0.001668024781

      target function =                  N/A
              le_mean =     -22.325502577553
             les_mean =     502.613299780028
             stat err =       0.001650676691
             autocorr =       1.283494155532
              std dev =       2.060568315002
             le_variance =       4.245941780791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.246211836253
                                         uncertainty =       0.336514725887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.246211836253
                                         uncertainty =       0.336514725887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001457018523
  error estimate for blocks of size 2^( 2) =       0.001523972052
  error estimate for blocks of size 2^( 3) =       0.001582102516
  error estimate for blocks of size 2^( 4) =       0.001625516212
  error estimate for blocks of size 2^( 5) =       0.001646958850
  error estimate for blocks of size 2^( 6) =       0.001662206862
  error estimate for blocks of size 2^( 7) =       0.001668024769

      target function =                  N/A
              le_mean =     -22.325502571201
             les_mean =     502.613296712713
             stat err =       0.001650676673
             autocorr =       1.283494116105
              std dev =       2.060568324033
             le_variance =       4.245941818007


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325502570294        initial
     3.6380e+02     3.6380e+03             1.0724e-06       -22.325502584858  <--
     1.4552e+03     1.4552e+04             2.6821e-07       -22.325502577553
     5.8208e+03     5.8208e+04             6.7059e-08       -22.325502571201

*****************************************************************************
Applying the update for shift_i =   3.6380e+02     and shift_s =   3.6380e+03
*****************************************************************************

  Execution time = 4.5108e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_001                -6.963166e-01 3 1  ON 0
ci_002                -7.040925e-01 3 1  ON 1
ci_003                -6.187455e-02 3 1  ON 2
ci_004                -6.236022e-02 3 1  ON 3
ci_005                 4.605202e-02 3 1  ON 4
ci_006                 4.617123e-02 3 1  ON 5
ci_007                 3.181907e-02 3 1  ON 6
ci_008                 3.146849e-02 3 1  ON 7
ci_009                -2.501527e-02 3 1  ON 8
ci_010                -2.553502e-02 3 1  ON 9
ci_011                -2.290134e-02 3 1  ON 10
ci_012                -2.258410e-02 3 1  ON 11
ci_013                 2.001136e-02 3 1  ON 12
ci_014                 2.020484e-02 3 1  ON 13
ci_015                 1.968979e-02 3 1  ON 14
ci_016                 2.075056e-02 3 1  ON 15
ci_017                 1.537475e-02 3 1  ON 16
ci_018                 1.572299e-02 3 1  ON 17
ci_019                 1.063934e-02 3 1  ON 18
ci_020                 1.043959e-02 3 1  ON 19
ci_021                -9.778211e-03 3 1  ON 20
ci_022                -9.437105e-03 3 1  ON 21
ci_023                 8.740155e-03 3 1  ON 22
ci_024                 9.496440e-03 3 1  ON 23
ci_025                 7.134303e-03 3 1  ON 24
ci_026                 8.151370e-03 3 1  ON 25
ci_027                 7.920521e-03 3 1  ON 26
ci_028                 7.855441e-03 3 1  ON 27
ci_029                -7.649334e-03 3 1  ON 28
ci_030                -7.775817e-03 3 1  ON 29
ci_031                -7.190818e-03 3 1  ON 30
ci_032                -7.556941e-03 3 1  ON 31
ci_033                 6.842024e-03 3 1  ON 32
ci_034                 6.313109e-03 3 1  ON 33
ci_035                 6.419776e-03 3 1  ON 34
ci_036                 6.977146e-03 3 1  ON 35
ci_037                 6.510288e-03 3 1  ON 36
ci_038                 5.593561e-03 3 1  ON 37
ci_039                 5.924957e-03 3 1  ON 38
ci_040                 6.143361e-03 3 1  ON 39
ci_041                 5.439194e-03 3 1  ON 40
ci_042                 5.123636e-03 3 1  ON 41
ci_043                 5.094579e-03 3 1  ON 42
ci_044                 4.423829e-03 3 1  ON 43
ci_045                 5.134358e-03 3 1  ON 44
ci_046                 5.271064e-03 3 1  ON 45
ci_047                -3.975268e-03 3 1  ON 46
ci_048                -4.391790e-03 3 1  ON 47
ci_049                 4.070999e-03 3 1  ON 48
ci_050                 3.474018e-03 3 1  ON 49
ci_051                -3.066916e-03 3 1  ON 50
ci_052                -2.183930e-03 3 1  ON 51
ci_053                -2.743010e-03 3 1  ON 52
ci_054                -3.471901e-03 3 1  ON 53
ci_055                -1.937723e-03 3 1  ON 54
ci_056                -2.005580e-03 3 1  ON 55
ci_057                -1.784925e-03 3 1  ON 56
ci_058                -1.819857e-03 3 1  ON 57
ci_059                -1.894404e-03 3 1  ON 58
ci_060                -2.082919e-03 3 1  ON 59
ci_061                -1.835069e-03 3 1  ON 60
ci_062                -1.923531e-03 3 1  ON 61
ci_063                -1.938980e-03 3 1  ON 62
ci_064                -9.369961e-04 3 1  ON 63
ci_065                -1.768862e-03 3 1  ON 64
ci_066                -1.407695e-03 3 1  ON 65
ci_067                -1.988928e-03 3 1  ON 66
ci_068                -1.521331e-03 3 1  ON 67
ci_069                 1.139235e-03 3 1  ON 68
ci_070                 1.595814e-03 3 1  ON 69
ci_071                 2.665760e-05 3 1  ON 70
ci_072                -2.341741e-04 3 1  ON 71
ci_073                 1.365603e-03 3 1  ON 72
ci_074                 8.871878e-04 3 1  ON 73
ci_075                -1.348629e-03 3 1  ON 74
ci_076                -7.318235e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4912e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2292e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.1697
    reference variance = 7.50219
====================================================
  Execution time = 2.3760e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0240e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7242e+00
  Total weights = 1.949750914e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9077e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774885217896
                                         uncertainty =       0.025813497821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774885217896
                                         uncertainty =       0.025813497821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373773209
  error estimate for blocks of size 2^( 2) =       0.001444907396
  error estimate for blocks of size 2^( 3) =       0.001507241303
  error estimate for blocks of size 2^( 4) =       0.001548299774
  error estimate for blocks of size 2^( 5) =       0.001573008911
  error estimate for blocks of size 2^( 6) =       0.001579696182
  error estimate for blocks of size 2^( 7) =       0.001588277476

      target function =                  N/A
              le_mean =     -22.327684318568
             les_mean =     502.249732338152
             stat err =       0.001572320586
             autocorr =       1.309942146912
              std dev =       1.942839788607
             le_variance =       3.774626444195


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232768431857e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327684317710       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327684547674       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327684552442       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+01 is 4.818196e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327684317710       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327684375295       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327684376478       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+02 is 1.206035e-06

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327684317710       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327684332112       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327684332408       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+03 is 3.016017e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086257 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9674e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_001                -6.963160e-01 3 1  ON 0
ci_002                -7.040929e-01 3 1  ON 1
ci_003                -6.187504e-02 3 1  ON 2
ci_004                -6.236057e-02 3 1  ON 3
ci_005                 4.605244e-02 3 1  ON 4
ci_006                 4.617142e-02 3 1  ON 5
ci_007                 3.181881e-02 3 1  ON 6
ci_008                 3.146892e-02 3 1  ON 7
ci_009                -2.501577e-02 3 1  ON 8
ci_010                -2.553533e-02 3 1  ON 9
ci_011                -2.290121e-02 3 1  ON 10
ci_012                -2.258397e-02 3 1  ON 11
ci_013                 2.001194e-02 3 1  ON 12
ci_014                 2.020410e-02 3 1  ON 13
ci_015                 1.968977e-02 3 1  ON 14
ci_016                 2.075054e-02 3 1  ON 15
ci_017                 1.537427e-02 3 1  ON 16
ci_018                 1.572289e-02 3 1  ON 17
ci_019                 1.063943e-02 3 1  ON 18
ci_020                 1.043838e-02 3 1  ON 19
ci_021                -9.778655e-03 3 1  ON 20
ci_022                -9.438126e-03 3 1  ON 21
ci_023                 8.739818e-03 3 1  ON 22
ci_024                 9.497386e-03 3 1  ON 23
ci_025                 7.134160e-03 3 1  ON 24
ci_026                 8.151636e-03 3 1  ON 25
ci_027                 7.920299e-03 3 1  ON 26
ci_028                 7.855453e-03 3 1  ON 27
ci_029                -7.649894e-03 3 1  ON 28
ci_030                -7.775928e-03 3 1  ON 29
ci_031                -7.190885e-03 3 1  ON 30
ci_032                -7.557502e-03 3 1  ON 31
ci_033                 6.842739e-03 3 1  ON 32
ci_034                 6.313342e-03 3 1  ON 33
ci_035                 6.419647e-03 3 1  ON 34
ci_036                 6.976400e-03 3 1  ON 35
ci_037                 6.510310e-03 3 1  ON 36
ci_038                 5.594049e-03 3 1  ON 37
ci_039                 5.924386e-03 3 1  ON 38
ci_040                 6.142683e-03 3 1  ON 39
ci_041                 5.438797e-03 3 1  ON 40
ci_042                 5.122866e-03 3 1  ON 41
ci_043                 5.094739e-03 3 1  ON 42
ci_044                 4.424602e-03 3 1  ON 43
ci_045                 5.133781e-03 3 1  ON 44
ci_046                 5.270752e-03 3 1  ON 45
ci_047                -3.974559e-03 3 1  ON 46
ci_048                -4.392060e-03 3 1  ON 47
ci_049                 4.070133e-03 3 1  ON 48
ci_050                 3.473337e-03 3 1  ON 49
ci_051                -3.067786e-03 3 1  ON 50
ci_052                -2.184212e-03 3 1  ON 51
ci_053                -2.743066e-03 3 1  ON 52
ci_054                -3.470742e-03 3 1  ON 53
ci_055                -1.937935e-03 3 1  ON 54
ci_056                -2.006182e-03 3 1  ON 55
ci_057                -1.785771e-03 3 1  ON 56
ci_058                -1.820391e-03 3 1  ON 57
ci_059                -1.894831e-03 3 1  ON 58
ci_060                -2.083310e-03 3 1  ON 59
ci_061                -1.835417e-03 3 1  ON 60
ci_062                -1.923438e-03 3 1  ON 61
ci_063                -1.939378e-03 3 1  ON 62
ci_064                -9.369875e-04 3 1  ON 63
ci_065                -1.768304e-03 3 1  ON 64
ci_066                -1.407778e-03 3 1  ON 65
ci_067                -1.988371e-03 3 1  ON 66
ci_068                -1.520855e-03 3 1  ON 67
ci_069                 1.139202e-03 3 1  ON 68
ci_070                 1.595756e-03 3 1  ON 69
ci_071                 2.573004e-05 3 1  ON 70
ci_072                -2.348122e-04 3 1  ON 71
ci_073                 1.365597e-03 3 1  ON 72
ci_074                 8.867594e-04 3 1  ON 73
ci_075                -1.347987e-03 3 1  ON 74
ci_076                -7.315231e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.4131
    reference variance = 3.44264
====================================================
  Execution time = 2.3216e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7859e+00
  Total weights = 1.9500e+06
  Execution time = 4.3457e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.839533987396
                                         uncertainty =       0.084504043476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.839533987396
                                         uncertainty =       0.084504043476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385400748
  error estimate for blocks of size 2^( 2) =       0.001456362873
  error estimate for blocks of size 2^( 3) =       0.001518963547
  error estimate for blocks of size 2^( 4) =       0.001564352238
  error estimate for blocks of size 2^( 5) =       0.001594387784
  error estimate for blocks of size 2^( 6) =       0.001612853869
  error estimate for blocks of size 2^( 7) =       0.001618990886

      target function =                  N/A
              le_mean =     -22.328218492197
             les_mean =     502.335261515404
             stat err =       0.001597646194
             autocorr =       1.329873654848
              std dev =       1.959283875447
             le_variance =       3.838793304587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.839533506816
                                         uncertainty =       0.084504064951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.839533506816
                                         uncertainty =       0.084504064951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385400662
  error estimate for blocks of size 2^( 2) =       0.001456362735
  error estimate for blocks of size 2^( 3) =       0.001518963308
  error estimate for blocks of size 2^( 4) =       0.001564351906
  error estimate for blocks of size 2^( 5) =       0.001594387453
  error estimate for blocks of size 2^( 6) =       0.001612853491
  error estimate for blocks of size 2^( 7) =       0.001618990446

      target function =                  N/A
              le_mean =     -22.328218515762
             les_mean =     502.335274448029
             stat err =       0.001597645824
             autocorr =       1.329873203703
              std dev =       1.959283753768
             le_variance =       3.838792827780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.839533745951
                                         uncertainty =       0.084504054226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.839533745951
                                         uncertainty =       0.084504054226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385400705
  error estimate for blocks of size 2^( 2) =       0.001456362804
  error estimate for blocks of size 2^( 3) =       0.001518963427
  error estimate for blocks of size 2^( 4) =       0.001564352072
  error estimate for blocks of size 2^( 5) =       0.001594387618
  error estimate for blocks of size 2^( 6) =       0.001612853679
  error estimate for blocks of size 2^( 7) =       0.001618990665

      target function =                  N/A
              le_mean =     -22.328218503883
             les_mean =     502.335266680760
             stat err =       0.001597646009
             autocorr =       1.329873428793
              std dev =       1.959283814314
             le_variance =       3.838793065033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.839533957129
                                         uncertainty =       0.084504044820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.839533957129
                                         uncertainty =       0.084504044820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385400743
  error estimate for blocks of size 2^( 2) =       0.001456362865
  error estimate for blocks of size 2^( 3) =       0.001518963532
  error estimate for blocks of size 2^( 4) =       0.001564352217
  error estimate for blocks of size 2^( 5) =       0.001594387763
  error estimate for blocks of size 2^( 6) =       0.001612853845
  error estimate for blocks of size 2^( 7) =       0.001618990859

      target function =                  N/A
              le_mean =     -22.328218493644
             les_mean =     502.335262073247
             stat err =       0.001597646171
             autocorr =       1.329873626564
              std dev =       1.959283867783
             le_variance =       3.838793274556


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328218492197        initial
     9.0949e+01     9.0949e+02             4.8182e-06       -22.328218515762  <--
     3.6380e+02     3.6380e+03             1.2060e-06       -22.328218503883
     1.4552e+03     1.4552e+04             3.0160e-07       -22.328218493644

*****************************************************************************
Applying the update for shift_i =   9.0949e+01     and shift_s =   9.0949e+02
*****************************************************************************

  Execution time = 4.5047e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_001                -6.963144e-01 3 1  ON 0
ci_002                -7.040940e-01 3 1  ON 1
ci_003                -6.187651e-02 3 1  ON 2
ci_004                -6.236164e-02 3 1  ON 3
ci_005                 4.605370e-02 3 1  ON 4
ci_006                 4.617200e-02 3 1  ON 5
ci_007                 3.181802e-02 3 1  ON 6
ci_008                 3.147021e-02 3 1  ON 7
ci_009                -2.501728e-02 3 1  ON 8
ci_010                -2.553627e-02 3 1  ON 9
ci_011                -2.290083e-02 3 1  ON 10
ci_012                -2.258358e-02 3 1  ON 11
ci_013                 2.001368e-02 3 1  ON 12
ci_014                 2.020190e-02 3 1  ON 13
ci_015                 1.968971e-02 3 1  ON 14
ci_016                 2.075047e-02 3 1  ON 15
ci_017                 1.537284e-02 3 1  ON 16
ci_018                 1.572259e-02 3 1  ON 17
ci_019                 1.063972e-02 3 1  ON 18
ci_020                 1.043477e-02 3 1  ON 19
ci_021                -9.779984e-03 3 1  ON 20
ci_022                -9.441186e-03 3 1  ON 21
ci_023                 8.738809e-03 3 1  ON 22
ci_024                 9.500218e-03 3 1  ON 23
ci_025                 7.133733e-03 3 1  ON 24
ci_026                 8.152435e-03 3 1  ON 25
ci_027                 7.919635e-03 3 1  ON 26
ci_028                 7.855489e-03 3 1  ON 27
ci_029                -7.651571e-03 3 1  ON 28
ci_030                -7.776260e-03 3 1  ON 29
ci_031                -7.191086e-03 3 1  ON 30
ci_032                -7.559181e-03 3 1  ON 31
ci_033                 6.844881e-03 3 1  ON 32
ci_034                 6.314041e-03 3 1  ON 33
ci_035                 6.419263e-03 3 1  ON 34
ci_036                 6.974170e-03 3 1  ON 35
ci_037                 6.510376e-03 3 1  ON 36
ci_038                 5.595511e-03 3 1  ON 37
ci_039                 5.922677e-03 3 1  ON 38
ci_040                 6.140655e-03 3 1  ON 39
ci_041                 5.437612e-03 3 1  ON 40
ci_042                 5.120561e-03 3 1  ON 41
ci_043                 5.095215e-03 3 1  ON 42
ci_044                 4.426916e-03 3 1  ON 43
ci_045                 5.132053e-03 3 1  ON 44
ci_046                 5.269817e-03 3 1  ON 45
ci_047                -3.972442e-03 3 1  ON 46
ci_048                -4.392869e-03 3 1  ON 47
ci_049                 4.067538e-03 3 1  ON 48
ci_050                 3.471297e-03 3 1  ON 49
ci_051                -3.070392e-03 3 1  ON 50
ci_052                -2.185053e-03 3 1  ON 51
ci_053                -2.743232e-03 3 1  ON 52
ci_054                -3.467273e-03 3 1  ON 53
ci_055                -1.938570e-03 3 1  ON 54
ci_056                -2.007988e-03 3 1  ON 55
ci_057                -1.788304e-03 3 1  ON 56
ci_058                -1.821987e-03 3 1  ON 57
ci_059                -1.896107e-03 3 1  ON 58
ci_060                -2.084480e-03 3 1  ON 59
ci_061                -1.836459e-03 3 1  ON 60
ci_062                -1.923160e-03 3 1  ON 61
ci_063                -1.940567e-03 3 1  ON 62
ci_064                -9.369626e-04 3 1  ON 63
ci_065                -1.766634e-03 3 1  ON 64
ci_066                -1.408026e-03 3 1  ON 65
ci_067                -1.986704e-03 3 1  ON 66
ci_068                -1.519430e-03 3 1  ON 67
ci_069                 1.139105e-03 3 1  ON 68
ci_070                 1.595582e-03 3 1  ON 69
ci_071                 2.295369e-05 3 1  ON 70
ci_072                -2.367225e-04 3 1  ON 71
ci_073                 1.365579e-03 3 1  ON 72
ci_074                 8.854799e-04 3 1  ON 73
ci_075                -1.346066e-03 3 1  ON 74
ci_076                -7.306245e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4728e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2292e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.235
    reference variance = 4.3693
====================================================
  Execution time = 2.3972e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0297e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.8401e+00
  Total weights = 1.950011892e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9317e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.889698910286
                                         uncertainty =       0.055868512605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.889698910286
                                         uncertainty =       0.055868512605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001394500430
  error estimate for blocks of size 2^( 2) =       0.001464854319
  error estimate for blocks of size 2^( 3) =       0.001527763603
  error estimate for blocks of size 2^( 4) =       0.001571015827
  error estimate for blocks of size 2^( 5) =       0.001593791249
  error estimate for blocks of size 2^( 6) =       0.001604148716
  error estimate for blocks of size 2^( 7) =       0.001616938712

      target function =                  N/A
              le_mean =     -22.327439630513
             les_mean =     502.354614898844
             stat err =       0.001596473626
             autocorr =       1.310648369329
              std dev =       1.972152974894
             le_variance =       3.889387356382


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232743963051e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327439629665       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327440570669       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327440569019       residual = 3.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+01 is 2.230395e-05

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327439629665       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327439866540       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327439866143       residual = 3.96e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+01 is 5.627182e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327439629665       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327439688986       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327439688888       residual = 3.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+02 is 1.410031e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087447 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9910e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_001                -6.963149e-01 3 1  ON 0
ci_002                -7.040940e-01 3 1  ON 1
ci_003                -6.187508e-02 3 1  ON 2
ci_004                -6.236366e-02 3 1  ON 3
ci_005                 4.605167e-02 3 1  ON 4
ci_006                 4.616767e-02 3 1  ON 5
ci_007                 3.181948e-02 3 1  ON 6
ci_008                 3.147030e-02 3 1  ON 7
ci_009                -2.501604e-02 3 1  ON 8
ci_010                -2.553484e-02 3 1  ON 9
ci_011                -2.290308e-02 3 1  ON 10
ci_012                -2.258545e-02 3 1  ON 11
ci_013                 2.001608e-02 3 1  ON 12
ci_014                 2.020128e-02 3 1  ON 13
ci_015                 1.968804e-02 3 1  ON 14
ci_016                 2.074909e-02 3 1  ON 15
ci_017                 1.537369e-02 3 1  ON 16
ci_018                 1.572198e-02 3 1  ON 17
ci_019                 1.064004e-02 3 1  ON 18
ci_020                 1.043685e-02 3 1  ON 19
ci_021                -9.780729e-03 3 1  ON 20
ci_022                -9.440826e-03 3 1  ON 21
ci_023                 8.733785e-03 3 1  ON 22
ci_024                 9.497712e-03 3 1  ON 23
ci_025                 7.134753e-03 3 1  ON 24
ci_026                 8.152243e-03 3 1  ON 25
ci_027                 7.920526e-03 3 1  ON 26
ci_028                 7.855285e-03 3 1  ON 27
ci_029                -7.651285e-03 3 1  ON 28
ci_030                -7.776662e-03 3 1  ON 29
ci_031                -7.191559e-03 3 1  ON 30
ci_032                -7.556786e-03 3 1  ON 31
ci_033                 6.842255e-03 3 1  ON 32
ci_034                 6.314855e-03 3 1  ON 33
ci_035                 6.420451e-03 3 1  ON 34
ci_036                 6.970573e-03 3 1  ON 35
ci_037                 6.509515e-03 3 1  ON 36
ci_038                 5.594717e-03 3 1  ON 37
ci_039                 5.923617e-03 3 1  ON 38
ci_040                 6.141777e-03 3 1  ON 39
ci_041                 5.434918e-03 3 1  ON 40
ci_042                 5.118553e-03 3 1  ON 41
ci_043                 5.094659e-03 3 1  ON 42
ci_044                 4.428328e-03 3 1  ON 43
ci_045                 5.130632e-03 3 1  ON 44
ci_046                 5.269369e-03 3 1  ON 45
ci_047                -3.974238e-03 3 1  ON 46
ci_048                -4.392774e-03 3 1  ON 47
ci_049                 4.064651e-03 3 1  ON 48
ci_050                 3.472647e-03 3 1  ON 49
ci_051                -3.068426e-03 3 1  ON 50
ci_052                -2.186278e-03 3 1  ON 51
ci_053                -2.742501e-03 3 1  ON 52
ci_054                -3.464083e-03 3 1  ON 53
ci_055                -1.941575e-03 3 1  ON 54
ci_056                -2.010018e-03 3 1  ON 55
ci_057                -1.790649e-03 3 1  ON 56
ci_058                -1.822569e-03 3 1  ON 57
ci_059                -1.897060e-03 3 1  ON 58
ci_060                -2.078853e-03 3 1  ON 59
ci_061                -1.834926e-03 3 1  ON 60
ci_062                -1.927346e-03 3 1  ON 61
ci_063                -1.940765e-03 3 1  ON 62
ci_064                -9.354653e-04 3 1  ON 63
ci_065                -1.764569e-03 3 1  ON 64
ci_066                -1.409525e-03 3 1  ON 65
ci_067                -1.987986e-03 3 1  ON 66
ci_068                -1.521173e-03 3 1  ON 67
ci_069                 1.140330e-03 3 1  ON 68
ci_070                 1.598203e-03 3 1  ON 69
ci_071                 2.362069e-05 3 1  ON 70
ci_072                -2.367881e-04 3 1  ON 71
ci_073                 1.367536e-03 3 1  ON 72
ci_074                 8.844455e-04 3 1  ON 73
ci_075                -1.346386e-03 3 1  ON 74
ci_076                -7.304452e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -21.8793
    reference variance = 5.61983
====================================================
  Execution time = 2.3307e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6672e+00
  Total weights = 1.9497e+06
  Execution time = 4.3711e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718313634202
                                         uncertainty =       0.023584509671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718313634202
                                         uncertainty =       0.023584509671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363488595
  error estimate for blocks of size 2^( 2) =       0.001434330082
  error estimate for blocks of size 2^( 3) =       0.001498213727
  error estimate for blocks of size 2^( 4) =       0.001541259916
  error estimate for blocks of size 2^( 5) =       0.001564053511
  error estimate for blocks of size 2^( 6) =       0.001577951662
  error estimate for blocks of size 2^( 7) =       0.001584311074

      target function =                  N/A
              le_mean =     -22.328216732449
             les_mean =     502.216480824246
             stat err =       0.001566894041
             autocorr =       1.320615038753
              std dev =       1.928294915094
             le_variance =       3.718321279577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718309521818
                                         uncertainty =       0.023584440485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718309521818
                                         uncertainty =       0.023584440485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363487842
  error estimate for blocks of size 2^( 2) =       0.001434329911
  error estimate for blocks of size 2^( 3) =       0.001498213868
  error estimate for blocks of size 2^( 4) =       0.001541260671
  error estimate for blocks of size 2^( 5) =       0.001564053923
  error estimate for blocks of size 2^( 6) =       0.001577952301
  error estimate for blocks of size 2^( 7) =       0.001584311985

      target function =                  N/A
              le_mean =     -22.328216714324
             les_mean =     502.216468084196
             stat err =       0.001566894720
             autocorr =       1.320617641608
              std dev =       1.928293850512
             le_variance =       3.718317173922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718311551880
                                         uncertainty =       0.023584474783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718311551880
                                         uncertainty =       0.023584474783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363488214
  error estimate for blocks of size 2^( 2) =       0.001434329994
  error estimate for blocks of size 2^( 3) =       0.001498213797
  error estimate for blocks of size 2^( 4) =       0.001541260295
  error estimate for blocks of size 2^( 5) =       0.001564053717
  error estimate for blocks of size 2^( 6) =       0.001577951982
  error estimate for blocks of size 2^( 7) =       0.001584311532

      target function =                  N/A
              le_mean =     -22.328216721105
             les_mean =     502.216473552262
             stat err =       0.001566894381
             autocorr =       1.320616351111
              std dev =       1.928294376046
             le_variance =       3.718319200690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718313372297
                                         uncertainty =       0.023584505301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718313372297
                                         uncertainty =       0.023584505301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363488547
  error estimate for blocks of size 2^( 2) =       0.001434330071
  error estimate for blocks of size 2^( 3) =       0.001498213735
  error estimate for blocks of size 2^( 4) =       0.001541259963
  error estimate for blocks of size 2^( 5) =       0.001564053537
  error estimate for blocks of size 2^( 6) =       0.001577951702
  error estimate for blocks of size 2^( 7) =       0.001584311131

      target function =                  N/A
              le_mean =     -22.328216730783
             les_mean =     502.216479820882
             stat err =       0.001566894083
             autocorr =       1.320615203137
              std dev =       1.928294847295
             le_variance =       3.718321018104


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328216732449        initial  <--
     2.2737e+01     2.2737e+02             2.2304e-05       -22.328216714324
     9.0949e+01     9.0949e+02             5.6272e-06       -22.328216721105
     3.6380e+02     3.6380e+03             1.4100e-06       -22.328216730783

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.2576
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_001                -6.963144e-01 3 1  ON 0
ci_002                -7.040940e-01 3 1  ON 1
ci_003                -6.187651e-02 3 1  ON 2
ci_004                -6.236164e-02 3 1  ON 3
ci_005                 4.605370e-02 3 1  ON 4
ci_006                 4.617200e-02 3 1  ON 5
ci_007                 3.181802e-02 3 1  ON 6
ci_008                 3.147021e-02 3 1  ON 7
ci_009                -2.501728e-02 3 1  ON 8
ci_010                -2.553627e-02 3 1  ON 9
ci_011                -2.290083e-02 3 1  ON 10
ci_012                -2.258358e-02 3 1  ON 11
ci_013                 2.001368e-02 3 1  ON 12
ci_014                 2.020190e-02 3 1  ON 13
ci_015                 1.968971e-02 3 1  ON 14
ci_016                 2.075047e-02 3 1  ON 15
ci_017                 1.537284e-02 3 1  ON 16
ci_018                 1.572259e-02 3 1  ON 17
ci_019                 1.063972e-02 3 1  ON 18
ci_020                 1.043477e-02 3 1  ON 19
ci_021                -9.779984e-03 3 1  ON 20
ci_022                -9.441186e-03 3 1  ON 21
ci_023                 8.738809e-03 3 1  ON 22
ci_024                 9.500218e-03 3 1  ON 23
ci_025                 7.133733e-03 3 1  ON 24
ci_026                 8.152435e-03 3 1  ON 25
ci_027                 7.919635e-03 3 1  ON 26
ci_028                 7.855489e-03 3 1  ON 27
ci_029                -7.651571e-03 3 1  ON 28
ci_030                -7.776260e-03 3 1  ON 29
ci_031                -7.191086e-03 3 1  ON 30
ci_032                -7.559181e-03 3 1  ON 31
ci_033                 6.844881e-03 3 1  ON 32
ci_034                 6.314041e-03 3 1  ON 33
ci_035                 6.419263e-03 3 1  ON 34
ci_036                 6.974170e-03 3 1  ON 35
ci_037                 6.510376e-03 3 1  ON 36
ci_038                 5.595511e-03 3 1  ON 37
ci_039                 5.922677e-03 3 1  ON 38
ci_040                 6.140655e-03 3 1  ON 39
ci_041                 5.437612e-03 3 1  ON 40
ci_042                 5.120561e-03 3 1  ON 41
ci_043                 5.095215e-03 3 1  ON 42
ci_044                 4.426916e-03 3 1  ON 43
ci_045                 5.132053e-03 3 1  ON 44
ci_046                 5.269817e-03 3 1  ON 45
ci_047                -3.972442e-03 3 1  ON 46
ci_048                -4.392869e-03 3 1  ON 47
ci_049                 4.067538e-03 3 1  ON 48
ci_050                 3.471297e-03 3 1  ON 49
ci_051                -3.070392e-03 3 1  ON 50
ci_052                -2.185053e-03 3 1  ON 51
ci_053                -2.743232e-03 3 1  ON 52
ci_054                -3.467273e-03 3 1  ON 53
ci_055                -1.938570e-03 3 1  ON 54
ci_056                -2.007988e-03 3 1  ON 55
ci_057                -1.788304e-03 3 1  ON 56
ci_058                -1.821987e-03 3 1  ON 57
ci_059                -1.896107e-03 3 1  ON 58
ci_060                -2.084480e-03 3 1  ON 59
ci_061                -1.836459e-03 3 1  ON 60
ci_062                -1.923160e-03 3 1  ON 61
ci_063                -1.940567e-03 3 1  ON 62
ci_064                -9.369626e-04 3 1  ON 63
ci_065                -1.766634e-03 3 1  ON 64
ci_066                -1.408026e-03 3 1  ON 65
ci_067                -1.986704e-03 3 1  ON 66
ci_068                -1.519430e-03 3 1  ON 67
ci_069                 1.139105e-03 3 1  ON 68
ci_070                 1.595582e-03 3 1  ON 69
ci_071                 2.295369e-05 3 1  ON 70
ci_072                -2.367225e-04 3 1  ON 71
ci_073                 1.365579e-03 3 1  ON 72
ci_074                 8.854799e-04 3 1  ON 73
ci_075                -1.346066e-03 3 1  ON 74
ci_076                -7.306245e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5176e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2286e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.3966
    reference variance = 3.78154
====================================================
  Execution time = 2.3840e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0315e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6759e+00
  Total weights = 1.950039879e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8743e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722434520363
                                         uncertainty =       0.026715285939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722434520363
                                         uncertainty =       0.026715285939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365194506
  error estimate for blocks of size 2^( 2) =       0.001436470783
  error estimate for blocks of size 2^( 3) =       0.001499483823
  error estimate for blocks of size 2^( 4) =       0.001546419598
  error estimate for blocks of size 2^( 5) =       0.001569831291
  error estimate for blocks of size 2^( 6) =       0.001586965737
  error estimate for blocks of size 2^( 7) =       0.001596608884

      target function =                  N/A
              le_mean =     -22.328558534134
             les_mean =     502.240432496955
             stat err =       0.001574956378
             autocorr =       1.330907875400
              std dev =       1.930707476600
             le_variance =       3.727631360199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232855853413e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328558533302       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328558641242       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328558641361       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+02 is 2.742261e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328558533302       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328558560308       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328558560336       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+02 is 6.862524e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328558533302       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328558540054       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328558540062       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+03 is 1.716061e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.088720 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9721e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_001                -6.963145e-01 3 1  ON 0
ci_002                -7.040940e-01 3 1  ON 1
ci_003                -6.187659e-02 3 1  ON 2
ci_004                -6.236146e-02 3 1  ON 3
ci_005                 4.605362e-02 3 1  ON 4
ci_006                 4.617199e-02 3 1  ON 5
ci_007                 3.181807e-02 3 1  ON 6
ci_008                 3.147034e-02 3 1  ON 7
ci_009                -2.501706e-02 3 1  ON 8
ci_010                -2.553616e-02 3 1  ON 9
ci_011                -2.290078e-02 3 1  ON 10
ci_012                -2.258333e-02 3 1  ON 11
ci_013                 2.001381e-02 3 1  ON 12
ci_014                 2.020192e-02 3 1  ON 13
ci_015                 1.968984e-02 3 1  ON 14
ci_016                 2.075046e-02 3 1  ON 15
ci_017                 1.537311e-02 3 1  ON 16
ci_018                 1.572239e-02 3 1  ON 17
ci_019                 1.063976e-02 3 1  ON 18
ci_020                 1.043504e-02 3 1  ON 19
ci_021                -9.779776e-03 3 1  ON 20
ci_022                -9.441201e-03 3 1  ON 21
ci_023                 8.738859e-03 3 1  ON 22
ci_024                 9.499963e-03 3 1  ON 23
ci_025                 7.133924e-03 3 1  ON 24
ci_026                 8.152548e-03 3 1  ON 25
ci_027                 7.919651e-03 3 1  ON 26
ci_028                 7.855098e-03 3 1  ON 27
ci_029                -7.651467e-03 3 1  ON 28
ci_030                -7.776223e-03 3 1  ON 29
ci_031                -7.191197e-03 3 1  ON 30
ci_032                -7.559236e-03 3 1  ON 31
ci_033                 6.845228e-03 3 1  ON 32
ci_034                 6.314148e-03 3 1  ON 33
ci_035                 6.419737e-03 3 1  ON 34
ci_036                 6.974336e-03 3 1  ON 35
ci_037                 6.510074e-03 3 1  ON 36
ci_038                 5.595562e-03 3 1  ON 37
ci_039                 5.922436e-03 3 1  ON 38
ci_040                 6.139969e-03 3 1  ON 39
ci_041                 5.437558e-03 3 1  ON 40
ci_042                 5.120716e-03 3 1  ON 41
ci_043                 5.095365e-03 3 1  ON 42
ci_044                 4.426996e-03 3 1  ON 43
ci_045                 5.132198e-03 3 1  ON 44
ci_046                 5.269644e-03 3 1  ON 45
ci_047                -3.972799e-03 3 1  ON 46
ci_048                -4.392635e-03 3 1  ON 47
ci_049                 4.067287e-03 3 1  ON 48
ci_050                 3.471145e-03 3 1  ON 49
ci_051                -3.070366e-03 3 1  ON 50
ci_052                -2.185031e-03 3 1  ON 51
ci_053                -2.743392e-03 3 1  ON 52
ci_054                -3.467267e-03 3 1  ON 53
ci_055                -1.938665e-03 3 1  ON 54
ci_056                -2.008070e-03 3 1  ON 55
ci_057                -1.788471e-03 3 1  ON 56
ci_058                -1.821950e-03 3 1  ON 57
ci_059                -1.896204e-03 3 1  ON 58
ci_060                -2.084316e-03 3 1  ON 59
ci_061                -1.836648e-03 3 1  ON 60
ci_062                -1.922830e-03 3 1  ON 61
ci_063                -1.940386e-03 3 1  ON 62
ci_064                -9.369726e-04 3 1  ON 63
ci_065                -1.766557e-03 3 1  ON 64
ci_066                -1.407916e-03 3 1  ON 65
ci_067                -1.986786e-03 3 1  ON 66
ci_068                -1.519570e-03 3 1  ON 67
ci_069                 1.139349e-03 3 1  ON 68
ci_070                 1.595577e-03 3 1  ON 69
ci_071                 2.257339e-05 3 1  ON 70
ci_072                -2.368142e-04 3 1  ON 71
ci_073                 1.365536e-03 3 1  ON 72
ci_074                 8.852946e-04 3 1  ON 73
ci_075                -1.345917e-03 3 1  ON 74
ci_076                -7.306742e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.5149
    reference variance = 2.38386
====================================================
  Execution time = 2.3304e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.8727e+00
  Total weights = 1.9499e+06
  Execution time = 4.3361e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.920070327070
                                         uncertainty =       0.186790494875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.920070327070
                                         uncertainty =       0.186790494875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001400229268
  error estimate for blocks of size 2^( 2) =       0.001471330010
  error estimate for blocks of size 2^( 3) =       0.001532603777
  error estimate for blocks of size 2^( 4) =       0.001573603158
  error estimate for blocks of size 2^( 5) =       0.001596568913
  error estimate for blocks of size 2^( 6) =       0.001607197516
  error estimate for blocks of size 2^( 7) =       0.001616730435

      target function =                  N/A
              le_mean =     -22.329462755762
             les_mean =     502.477610519072
             stat err =       0.001598525006
             autocorr =       1.303288509949
              std dev =       1.980254904302
             le_variance =       3.921409486012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.920070748349
                                         uncertainty =       0.186790474937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.920070748349
                                         uncertainty =       0.186790474937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001400229343
  error estimate for blocks of size 2^( 2) =       0.001471330101
  error estimate for blocks of size 2^( 3) =       0.001532603887
  error estimate for blocks of size 2^( 4) =       0.001573603277
  error estimate for blocks of size 2^( 5) =       0.001596569044
  error estimate for blocks of size 2^( 6) =       0.001607197658
  error estimate for blocks of size 2^( 7) =       0.001616730518

      target function =                  N/A
              le_mean =     -22.329462745222
             les_mean =     502.477607377860
             stat err =       0.001598525124
             autocorr =       1.303288563421
              std dev =       1.980255010216
             le_variance =       3.921409905485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.920070537789
                                         uncertainty =       0.186790484892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.920070537789
                                         uncertainty =       0.186790484892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001400229305
  error estimate for blocks of size 2^( 2) =       0.001471330056
  error estimate for blocks of size 2^( 3) =       0.001532603832
  error estimate for blocks of size 2^( 4) =       0.001573603218
  error estimate for blocks of size 2^( 5) =       0.001596568978
  error estimate for blocks of size 2^( 6) =       0.001607197587
  error estimate for blocks of size 2^( 7) =       0.001616730477

      target function =                  N/A
              le_mean =     -22.329462750456
             les_mean =     502.477611407853
             stat err =       0.001598525065
             autocorr =       1.303288536883
              std dev =       1.980254957279
             le_variance =       3.921409695828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.920070353403
                                         uncertainty =       0.186790493627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.920070353403
                                         uncertainty =       0.186790493627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001400229273
  error estimate for blocks of size 2^( 2) =       0.001471330016
  error estimate for blocks of size 2^( 3) =       0.001532603784
  error estimate for blocks of size 2^( 4) =       0.001573603165
  error estimate for blocks of size 2^( 5) =       0.001596568921
  error estimate for blocks of size 2^( 6) =       0.001607197525
  error estimate for blocks of size 2^( 7) =       0.001616730441

      target function =                  N/A
              le_mean =     -22.329462755102
             les_mean =     502.477610372518
             stat err =       0.001598525013
             autocorr =       1.303288513302
              std dev =       1.980254910922
             le_variance =       3.921409512232


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329462755762        initial  <--
     2.2737e+02     2.2737e+03             2.7423e-06       -22.329462745222
     9.0949e+02     9.0949e+03             6.8625e-07       -22.329462750456
     3.6380e+03     3.6380e+04             1.7161e-07       -22.329462755102

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.3154
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_001                -6.963144e-01 3 1  ON 0
ci_002                -7.040940e-01 3 1  ON 1
ci_003                -6.187651e-02 3 1  ON 2
ci_004                -6.236164e-02 3 1  ON 3
ci_005                 4.605370e-02 3 1  ON 4
ci_006                 4.617200e-02 3 1  ON 5
ci_007                 3.181802e-02 3 1  ON 6
ci_008                 3.147021e-02 3 1  ON 7
ci_009                -2.501728e-02 3 1  ON 8
ci_010                -2.553627e-02 3 1  ON 9
ci_011                -2.290083e-02 3 1  ON 10
ci_012                -2.258358e-02 3 1  ON 11
ci_013                 2.001368e-02 3 1  ON 12
ci_014                 2.020190e-02 3 1  ON 13
ci_015                 1.968971e-02 3 1  ON 14
ci_016                 2.075047e-02 3 1  ON 15
ci_017                 1.537284e-02 3 1  ON 16
ci_018                 1.572259e-02 3 1  ON 17
ci_019                 1.063972e-02 3 1  ON 18
ci_020                 1.043477e-02 3 1  ON 19
ci_021                -9.779984e-03 3 1  ON 20
ci_022                -9.441186e-03 3 1  ON 21
ci_023                 8.738809e-03 3 1  ON 22
ci_024                 9.500218e-03 3 1  ON 23
ci_025                 7.133733e-03 3 1  ON 24
ci_026                 8.152435e-03 3 1  ON 25
ci_027                 7.919635e-03 3 1  ON 26
ci_028                 7.855489e-03 3 1  ON 27
ci_029                -7.651571e-03 3 1  ON 28
ci_030                -7.776260e-03 3 1  ON 29
ci_031                -7.191086e-03 3 1  ON 30
ci_032                -7.559181e-03 3 1  ON 31
ci_033                 6.844881e-03 3 1  ON 32
ci_034                 6.314041e-03 3 1  ON 33
ci_035                 6.419263e-03 3 1  ON 34
ci_036                 6.974170e-03 3 1  ON 35
ci_037                 6.510376e-03 3 1  ON 36
ci_038                 5.595511e-03 3 1  ON 37
ci_039                 5.922677e-03 3 1  ON 38
ci_040                 6.140655e-03 3 1  ON 39
ci_041                 5.437612e-03 3 1  ON 40
ci_042                 5.120561e-03 3 1  ON 41
ci_043                 5.095215e-03 3 1  ON 42
ci_044                 4.426916e-03 3 1  ON 43
ci_045                 5.132053e-03 3 1  ON 44
ci_046                 5.269817e-03 3 1  ON 45
ci_047                -3.972442e-03 3 1  ON 46
ci_048                -4.392869e-03 3 1  ON 47
ci_049                 4.067538e-03 3 1  ON 48
ci_050                 3.471297e-03 3 1  ON 49
ci_051                -3.070392e-03 3 1  ON 50
ci_052                -2.185053e-03 3 1  ON 51
ci_053                -2.743232e-03 3 1  ON 52
ci_054                -3.467273e-03 3 1  ON 53
ci_055                -1.938570e-03 3 1  ON 54
ci_056                -2.007988e-03 3 1  ON 55
ci_057                -1.788304e-03 3 1  ON 56
ci_058                -1.821987e-03 3 1  ON 57
ci_059                -1.896107e-03 3 1  ON 58
ci_060                -2.084480e-03 3 1  ON 59
ci_061                -1.836459e-03 3 1  ON 60
ci_062                -1.923160e-03 3 1  ON 61
ci_063                -1.940567e-03 3 1  ON 62
ci_064                -9.369626e-04 3 1  ON 63
ci_065                -1.766634e-03 3 1  ON 64
ci_066                -1.408026e-03 3 1  ON 65
ci_067                -1.986704e-03 3 1  ON 66
ci_068                -1.519430e-03 3 1  ON 67
ci_069                 1.139105e-03 3 1  ON 68
ci_070                 1.595582e-03 3 1  ON 69
ci_071                 2.295369e-05 3 1  ON 70
ci_072                -2.367225e-04 3 1  ON 71
ci_073                 1.365579e-03 3 1  ON 72
ci_074                 8.854799e-04 3 1  ON 73
ci_075                -1.346066e-03 3 1  ON 74
ci_076                -7.306245e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8043e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2290e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.6501
    reference variance = 1.99645
====================================================
  Execution time = 2.3858e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0314e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.6895e+00
  Total weights = 1.949961183e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8480e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.738537968348
                                         uncertainty =       0.022095107585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.738537968348
                                         uncertainty =       0.022095107585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367336062
  error estimate for blocks of size 2^( 2) =       0.001439812021
  error estimate for blocks of size 2^( 3) =       0.001502862807
  error estimate for blocks of size 2^( 4) =       0.001548039476
  error estimate for blocks of size 2^( 5) =       0.001573933988
  error estimate for blocks of size 2^( 6) =       0.001589519355
  error estimate for blocks of size 2^( 7) =       0.001598355645

      target function =                  N/A
              le_mean =     -22.326636391227
             les_mean =     502.168213466752
             stat err =       0.001577462116
             autocorr =       1.330967162360
              std dev =       1.933736141561
             le_variance =       3.739335465180


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232663639123e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326636390419       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326636397430       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326636397652       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+03 is 1.787721e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326636390419       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326636392172       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326636392228       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+03 is 4.469482e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326636390419       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326636390857       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326636390871       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+04 is 1.117382e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089905 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9713e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_001                -6.963145e-01 3 1  ON 0
ci_002                -7.040940e-01 3 1  ON 1
ci_003                -6.187653e-02 3 1  ON 2
ci_004                -6.236165e-02 3 1  ON 3
ci_005                 4.605371e-02 3 1  ON 4
ci_006                 4.617200e-02 3 1  ON 5
ci_007                 3.181800e-02 3 1  ON 6
ci_008                 3.147023e-02 3 1  ON 7
ci_009                -2.501729e-02 3 1  ON 8
ci_010                -2.553627e-02 3 1  ON 9
ci_011                -2.290083e-02 3 1  ON 10
ci_012                -2.258360e-02 3 1  ON 11
ci_013                 2.001366e-02 3 1  ON 12
ci_014                 2.020189e-02 3 1  ON 13
ci_015                 1.968976e-02 3 1  ON 14
ci_016                 2.075048e-02 3 1  ON 15
ci_017                 1.537285e-02 3 1  ON 16
ci_018                 1.572259e-02 3 1  ON 17
ci_019                 1.063971e-02 3 1  ON 18
ci_020                 1.043479e-02 3 1  ON 19
ci_021                -9.779962e-03 3 1  ON 20
ci_022                -9.441195e-03 3 1  ON 21
ci_023                 8.738803e-03 3 1  ON 22
ci_024                 9.500228e-03 3 1  ON 23
ci_025                 7.133727e-03 3 1  ON 24
ci_026                 8.152440e-03 3 1  ON 25
ci_027                 7.919628e-03 3 1  ON 26
ci_028                 7.855464e-03 3 1  ON 27
ci_029                -7.651561e-03 3 1  ON 28
ci_030                -7.776280e-03 3 1  ON 29
ci_031                -7.191102e-03 3 1  ON 30
ci_032                -7.559166e-03 3 1  ON 31
ci_033                 6.844893e-03 3 1  ON 32
ci_034                 6.314024e-03 3 1  ON 33
ci_035                 6.419261e-03 3 1  ON 34
ci_036                 6.974172e-03 3 1  ON 35
ci_037                 6.510366e-03 3 1  ON 36
ci_038                 5.595540e-03 3 1  ON 37
ci_039                 5.922691e-03 3 1  ON 38
ci_040                 6.140655e-03 3 1  ON 39
ci_041                 5.437625e-03 3 1  ON 40
ci_042                 5.120563e-03 3 1  ON 41
ci_043                 5.095220e-03 3 1  ON 42
ci_044                 4.426937e-03 3 1  ON 43
ci_045                 5.132049e-03 3 1  ON 44
ci_046                 5.269816e-03 3 1  ON 45
ci_047                -3.972464e-03 3 1  ON 46
ci_048                -4.392874e-03 3 1  ON 47
ci_049                 4.067521e-03 3 1  ON 48
ci_050                 3.471299e-03 3 1  ON 49
ci_051                -3.070412e-03 3 1  ON 50
ci_052                -2.185044e-03 3 1  ON 51
ci_053                -2.743246e-03 3 1  ON 52
ci_054                -3.467244e-03 3 1  ON 53
ci_055                -1.938565e-03 3 1  ON 54
ci_056                -2.007977e-03 3 1  ON 55
ci_057                -1.788313e-03 3 1  ON 56
ci_058                -1.822013e-03 3 1  ON 57
ci_059                -1.896082e-03 3 1  ON 58
ci_060                -2.084463e-03 3 1  ON 59
ci_061                -1.836483e-03 3 1  ON 60
ci_062                -1.923156e-03 3 1  ON 61
ci_063                -1.940545e-03 3 1  ON 62
ci_064                -9.369549e-04 3 1  ON 63
ci_065                -1.766605e-03 3 1  ON 64
ci_066                -1.408033e-03 3 1  ON 65
ci_067                -1.986676e-03 3 1  ON 66
ci_068                -1.519458e-03 3 1  ON 67
ci_069                 1.139109e-03 3 1  ON 68
ci_070                 1.595583e-03 3 1  ON 69
ci_071                 2.292101e-05 3 1  ON 70
ci_072                -2.367476e-04 3 1  ON 71
ci_073                 1.365588e-03 3 1  ON 72
ci_074                 8.854913e-04 3 1  ON 73
ci_075                -1.346038e-03 3 1  ON 74
ci_076                -7.306289e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.3677
    reference variance = 2.49569
====================================================
  Execution time = 2.3232e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7239e+00
  Total weights = 1.9501e+06
  Execution time = 4.3485e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774833153728
                                         uncertainty =       0.045630271380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774833153728
                                         uncertainty =       0.045630271380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373753809
  error estimate for blocks of size 2^( 2) =       0.001443812308
  error estimate for blocks of size 2^( 3) =       0.001506114537
  error estimate for blocks of size 2^( 4) =       0.001550280026
  error estimate for blocks of size 2^( 5) =       0.001575224413
  error estimate for blocks of size 2^( 6) =       0.001589318334
  error estimate for blocks of size 2^( 7) =       0.001592031045

      target function =                  N/A
              le_mean =     -22.327701724193
             les_mean =     502.250132751944
             stat err =       0.001576713455
             autocorr =       1.317309208872
              std dev =       1.942812352827
             le_variance =       3.774519838299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774833163505
                                         uncertainty =       0.045630272461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774833163505
                                         uncertainty =       0.045630272461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373753811
  error estimate for blocks of size 2^( 2) =       0.001443812308
  error estimate for blocks of size 2^( 3) =       0.001506114536
  error estimate for blocks of size 2^( 4) =       0.001550280023
  error estimate for blocks of size 2^( 5) =       0.001575224406
  error estimate for blocks of size 2^( 6) =       0.001589318326
  error estimate for blocks of size 2^( 7) =       0.001592031039

      target function =                  N/A
              le_mean =     -22.327701724958
             les_mean =     502.250132380716
             stat err =       0.001576713449
             autocorr =       1.317309195087
              std dev =       1.942812355402
             le_variance =       3.774519848301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774833158615
                                         uncertainty =       0.045630271921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774833158615
                                         uncertainty =       0.045630271921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373753810
  error estimate for blocks of size 2^( 2) =       0.001443812308
  error estimate for blocks of size 2^( 3) =       0.001506114536
  error estimate for blocks of size 2^( 4) =       0.001550280025
  error estimate for blocks of size 2^( 5) =       0.001575224410
  error estimate for blocks of size 2^( 6) =       0.001589318330
  error estimate for blocks of size 2^( 7) =       0.001592031042

      target function =                  N/A
              le_mean =     -22.327701724576
             les_mean =     502.250132564423
             stat err =       0.001576713452
             autocorr =       1.317309201980
              std dev =       1.942812354114
             le_variance =       3.774519843299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774833154339
                                         uncertainty =       0.045630271448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774833154339
                                         uncertainty =       0.045630271448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373753809
  error estimate for blocks of size 2^( 2) =       0.001443812308
  error estimate for blocks of size 2^( 3) =       0.001506114537
  error estimate for blocks of size 2^( 4) =       0.001550280026
  error estimate for blocks of size 2^( 5) =       0.001575224413
  error estimate for blocks of size 2^( 6) =       0.001589318334
  error estimate for blocks of size 2^( 7) =       0.001592031045

      target function =                  N/A
              le_mean =     -22.327701724241
             les_mean =     502.250132728293
             stat err =       0.001576713454
             autocorr =       1.317309208011
              std dev =       1.942812352988
             le_variance =       3.774519838924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327701724193        initial
     2.2737e+03     2.2737e+04             1.7877e-07       -22.327701724958  <--
     9.0949e+03     9.0949e+04             4.4695e-08       -22.327701724576
     3.6380e+04     3.6380e+05             1.1174e-08       -22.327701724241

*****************************************************************************
Applying the update for shift_i =   2.2737e+03     and shift_s =   2.2737e+04
*****************************************************************************

  Execution time = 4.5053e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_001                -6.963145e-01 3 1  ON 0
ci_002                -7.040940e-01 3 1  ON 1
ci_003                -6.187661e-02 3 1  ON 2
ci_004                -6.236169e-02 3 1  ON 3
ci_005                 4.605373e-02 3 1  ON 4
ci_006                 4.617199e-02 3 1  ON 5
ci_007                 3.181793e-02 3 1  ON 6
ci_008                 3.147029e-02 3 1  ON 7
ci_009                -2.501732e-02 3 1  ON 8
ci_010                -2.553627e-02 3 1  ON 9
ci_011                -2.290084e-02 3 1  ON 10
ci_012                -2.258365e-02 3 1  ON 11
ci_013                 2.001361e-02 3 1  ON 12
ci_014                 2.020185e-02 3 1  ON 13
ci_015                 1.968989e-02 3 1  ON 14
ci_016                 2.075052e-02 3 1  ON 15
ci_017                 1.537290e-02 3 1  ON 16
ci_018                 1.572260e-02 3 1  ON 17
ci_019                 1.063968e-02 3 1  ON 18
ci_020                 1.043484e-02 3 1  ON 19
ci_021                -9.779896e-03 3 1  ON 20
ci_022                -9.441223e-03 3 1  ON 21
ci_023                 8.738784e-03 3 1  ON 22
ci_024                 9.500257e-03 3 1  ON 23
ci_025                 7.133708e-03 3 1  ON 24
ci_026                 8.152456e-03 3 1  ON 25
ci_027                 7.919606e-03 3 1  ON 26
ci_028                 7.855387e-03 3 1  ON 27
ci_029                -7.651533e-03 3 1  ON 28
ci_030                -7.776343e-03 3 1  ON 29
ci_031                -7.191150e-03 3 1  ON 30
ci_032                -7.559120e-03 3 1  ON 31
ci_033                 6.844931e-03 3 1  ON 32
ci_034                 6.313974e-03 3 1  ON 33
ci_035                 6.419255e-03 3 1  ON 34
ci_036                 6.974176e-03 3 1  ON 35
ci_037                 6.510333e-03 3 1  ON 36
ci_038                 5.595626e-03 3 1  ON 37
ci_039                 5.922735e-03 3 1  ON 38
ci_040                 6.140655e-03 3 1  ON 39
ci_041                 5.437663e-03 3 1  ON 40
ci_042                 5.120568e-03 3 1  ON 41
ci_043                 5.095234e-03 3 1  ON 42
ci_044                 4.427000e-03 3 1  ON 43
ci_045                 5.132034e-03 3 1  ON 44
ci_046                 5.269812e-03 3 1  ON 45
ci_047                -3.972530e-03 3 1  ON 46
ci_048                -4.392888e-03 3 1  ON 47
ci_049                 4.067471e-03 3 1  ON 48
ci_050                 3.471306e-03 3 1  ON 49
ci_051                -3.070471e-03 3 1  ON 50
ci_052                -2.185016e-03 3 1  ON 51
ci_053                -2.743291e-03 3 1  ON 52
ci_054                -3.467157e-03 3 1  ON 53
ci_055                -1.938548e-03 3 1  ON 54
ci_056                -2.007942e-03 3 1  ON 55
ci_057                -1.788341e-03 3 1  ON 56
ci_058                -1.822091e-03 3 1  ON 57
ci_059                -1.896005e-03 3 1  ON 58
ci_060                -2.084411e-03 3 1  ON 59
ci_061                -1.836557e-03 3 1  ON 60
ci_062                -1.923142e-03 3 1  ON 61
ci_063                -1.940480e-03 3 1  ON 62
ci_064                -9.369318e-04 3 1  ON 63
ci_065                -1.766521e-03 3 1  ON 64
ci_066                -1.408055e-03 3 1  ON 65
ci_067                -1.986593e-03 3 1  ON 66
ci_068                -1.519541e-03 3 1  ON 67
ci_069                 1.139122e-03 3 1  ON 68
ci_070                 1.595583e-03 3 1  ON 69
ci_071                 2.282299e-05 3 1  ON 70
ci_072                -2.368232e-04 3 1  ON 71
ci_073                 1.365616e-03 3 1  ON 72
ci_074                 8.855254e-04 3 1  ON 73
ci_075                -1.345956e-03 3 1  ON 74
ci_076                -7.306422e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4773e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2295e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.5114
    reference variance = 2.27678
====================================================
  Execution time = 2.3841e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0337e+04
  VMC Eavg = -2.2324e+01
  VMC Evar = 4.1737e+00
  Total weights = 1.949923928e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8287e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.234830692126
                                         uncertainty =       0.445329947119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.234830692126
                                         uncertainty =       0.445329947119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001454855827
  error estimate for blocks of size 2^( 2) =       0.001521604146
  error estimate for blocks of size 2^( 3) =       0.001580602011
  error estimate for blocks of size 2^( 4) =       0.001623476551
  error estimate for blocks of size 2^( 5) =       0.001650321137
  error estimate for blocks of size 2^( 6) =       0.001667696633
  error estimate for blocks of size 2^( 7) =       0.001668538079

      target function =                  N/A
              le_mean =     -22.324245384386
             les_mean =     502.545676285834
             stat err =       0.001652508100
             autocorr =       1.290171007671
              std dev =       2.057509760857
             le_variance =       4.233346416022


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232424538439e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324245383557       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324245416879       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324245417023       residual = 2.66e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+02 is 7.383966e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324245383557       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324245391889       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324245391925       residual = 2.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+03 is 1.846462e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324245383557       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324245385640       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324245385649       residual = 2.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+03 is 4.616448e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091085 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9676e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_001                -6.963144e-01 3 1  ON 0
ci_002                -7.040940e-01 3 1  ON 1
ci_003                -6.187667e-02 3 1  ON 2
ci_004                -6.236178e-02 3 1  ON 3
ci_005                 4.605364e-02 3 1  ON 4
ci_006                 4.617185e-02 3 1  ON 5
ci_007                 3.181800e-02 3 1  ON 6
ci_008                 3.147033e-02 3 1  ON 7
ci_009                -2.501728e-02 3 1  ON 8
ci_010                -2.553627e-02 3 1  ON 9
ci_011                -2.290074e-02 3 1  ON 10
ci_012                -2.258360e-02 3 1  ON 11
ci_013                 2.001364e-02 3 1  ON 12
ci_014                 2.020186e-02 3 1  ON 13
ci_015                 1.968988e-02 3 1  ON 14
ci_016                 2.075055e-02 3 1  ON 15
ci_017                 1.537291e-02 3 1  ON 16
ci_018                 1.572257e-02 3 1  ON 17
ci_019                 1.063972e-02 3 1  ON 18
ci_020                 1.043485e-02 3 1  ON 19
ci_021                -9.779934e-03 3 1  ON 20
ci_022                -9.441364e-03 3 1  ON 21
ci_023                 8.738885e-03 3 1  ON 22
ci_024                 9.500230e-03 3 1  ON 23
ci_025                 7.133567e-03 3 1  ON 24
ci_026                 8.152276e-03 3 1  ON 25
ci_027                 7.919609e-03 3 1  ON 26
ci_028                 7.855334e-03 3 1  ON 27
ci_029                -7.651554e-03 3 1  ON 28
ci_030                -7.776314e-03 3 1  ON 29
ci_031                -7.191273e-03 3 1  ON 30
ci_032                -7.559109e-03 3 1  ON 31
ci_033                 6.844959e-03 3 1  ON 32
ci_034                 6.314039e-03 3 1  ON 33
ci_035                 6.419215e-03 3 1  ON 34
ci_036                 6.974106e-03 3 1  ON 35
ci_037                 6.510231e-03 3 1  ON 36
ci_038                 5.595811e-03 3 1  ON 37
ci_039                 5.922729e-03 3 1  ON 38
ci_040                 6.140494e-03 3 1  ON 39
ci_041                 5.437618e-03 3 1  ON 40
ci_042                 5.120599e-03 3 1  ON 41
ci_043                 5.095078e-03 3 1  ON 42
ci_044                 4.426947e-03 3 1  ON 43
ci_045                 5.132051e-03 3 1  ON 44
ci_046                 5.269746e-03 3 1  ON 45
ci_047                -3.972577e-03 3 1  ON 46
ci_048                -4.392909e-03 3 1  ON 47
ci_049                 4.067390e-03 3 1  ON 48
ci_050                 3.471300e-03 3 1  ON 49
ci_051                -3.070386e-03 3 1  ON 50
ci_052                -2.185145e-03 3 1  ON 51
ci_053                -2.743286e-03 3 1  ON 52
ci_054                -3.467087e-03 3 1  ON 53
ci_055                -1.938598e-03 3 1  ON 54
ci_056                -2.008056e-03 3 1  ON 55
ci_057                -1.788338e-03 3 1  ON 56
ci_058                -1.822169e-03 3 1  ON 57
ci_059                -1.896037e-03 3 1  ON 58
ci_060                -2.084489e-03 3 1  ON 59
ci_061                -1.836637e-03 3 1  ON 60
ci_062                -1.923239e-03 3 1  ON 61
ci_063                -1.940448e-03 3 1  ON 62
ci_064                -9.369009e-04 3 1  ON 63
ci_065                -1.766563e-03 3 1  ON 64
ci_066                -1.408051e-03 3 1  ON 65
ci_067                -1.986537e-03 3 1  ON 66
ci_068                -1.519561e-03 3 1  ON 67
ci_069                 1.139172e-03 3 1  ON 68
ci_070                 1.595657e-03 3 1  ON 69
ci_071                 2.280215e-05 3 1  ON 70
ci_072                -2.368690e-04 3 1  ON 71
ci_073                 1.365557e-03 3 1  ON 72
ci_074                 8.854623e-04 3 1  ON 73
ci_075                -1.345977e-03 3 1  ON 74
ci_076                -7.306286e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.3428
    reference variance = 2.92068
====================================================
  Execution time = 2.3181e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7027e+00
  Total weights = 1.9498e+06
  Execution time = 4.3407e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.754195374328
                                         uncertainty =       0.037099263220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.754195374328
                                         uncertainty =       0.037099263220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369954159
  error estimate for blocks of size 2^( 2) =       0.001440241364
  error estimate for blocks of size 2^( 3) =       0.001502755131
  error estimate for blocks of size 2^( 4) =       0.001546697524
  error estimate for blocks of size 2^( 5) =       0.001574667113
  error estimate for blocks of size 2^( 6) =       0.001587045031
  error estimate for blocks of size 2^( 7) =       0.001599861921

      target function =                  N/A
              le_mean =     -22.328981456685
             les_mean =     502.286121961674
             stat err =       0.001577067897
             autocorr =       1.325222230617
              std dev =       1.937438749180
             le_variance =       3.753668906823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.754195314811
                                         uncertainty =       0.037099264858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.754195314811
                                         uncertainty =       0.037099264858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369954148
  error estimate for blocks of size 2^( 2) =       0.001440241374
  error estimate for blocks of size 2^( 3) =       0.001502755157
  error estimate for blocks of size 2^( 4) =       0.001546697571
  error estimate for blocks of size 2^( 5) =       0.001574667169
  error estimate for blocks of size 2^( 6) =       0.001587045097
  error estimate for blocks of size 2^( 7) =       0.001599861984

      target function =                  N/A
              le_mean =     -22.328981458267
             les_mean =     502.286121369321
             stat err =       0.001577067955
             autocorr =       1.325222348555
              std dev =       1.937438734094
             le_variance =       3.753668848370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.754195344544
                                         uncertainty =       0.037099264039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.754195344544
                                         uncertainty =       0.037099264039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369954153
  error estimate for blocks of size 2^( 2) =       0.001440241369
  error estimate for blocks of size 2^( 3) =       0.001502755144
  error estimate for blocks of size 2^( 4) =       0.001546697547
  error estimate for blocks of size 2^( 5) =       0.001574667141
  error estimate for blocks of size 2^( 6) =       0.001587045064
  error estimate for blocks of size 2^( 7) =       0.001599861952

      target function =                  N/A
              le_mean =     -22.328981457474
             les_mean =     502.286121653357
             stat err =       0.001577067926
             autocorr =       1.325222289617
              std dev =       1.937438741631
             le_variance =       3.753668877571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.754195370603
                                         uncertainty =       0.037099263322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.754195370603
                                         uncertainty =       0.037099263322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369954158
  error estimate for blocks of size 2^( 2) =       0.001440241364
  error estimate for blocks of size 2^( 3) =       0.001502755133
  error estimate for blocks of size 2^( 4) =       0.001546697527
  error estimate for blocks of size 2^( 5) =       0.001574667117
  error estimate for blocks of size 2^( 6) =       0.001587045035
  error estimate for blocks of size 2^( 7) =       0.001599861925

      target function =                  N/A
              le_mean =     -22.328981456783
             les_mean =     502.286121921832
             stat err =       0.001577067901
             autocorr =       1.325222237993
              std dev =       1.937438748236
             le_variance =       3.753668903165


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328981456685        initial
     5.6843e+02     5.6843e+03             7.3840e-07       -22.328981458267  <--
     2.2737e+03     2.2737e+04             1.8465e-07       -22.328981457474
     9.0949e+03     9.0949e+04             4.6164e-08       -22.328981456783

*****************************************************************************
Applying the update for shift_i =   5.6843e+02     and shift_s =   5.6843e+03
*****************************************************************************

  Execution time = 4.4980e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_001                -6.963143e-01 3 1  ON 0
ci_002                -7.040941e-01 3 1  ON 1
ci_003                -6.187687e-02 3 1  ON 2
ci_004                -6.236204e-02 3 1  ON 3
ci_005                 4.605338e-02 3 1  ON 4
ci_006                 4.617143e-02 3 1  ON 5
ci_007                 3.181820e-02 3 1  ON 6
ci_008                 3.147043e-02 3 1  ON 7
ci_009                -2.501713e-02 3 1  ON 8
ci_010                -2.553625e-02 3 1  ON 9
ci_011                -2.290044e-02 3 1  ON 10
ci_012                -2.258348e-02 3 1  ON 11
ci_013                 2.001376e-02 3 1  ON 12
ci_014                 2.020191e-02 3 1  ON 13
ci_015                 1.968983e-02 3 1  ON 14
ci_016                 2.075065e-02 3 1  ON 15
ci_017                 1.537295e-02 3 1  ON 16
ci_018                 1.572246e-02 3 1  ON 17
ci_019                 1.063983e-02 3 1  ON 18
ci_020                 1.043487e-02 3 1  ON 19
ci_021                -9.780049e-03 3 1  ON 20
ci_022                -9.441790e-03 3 1  ON 21
ci_023                 8.739188e-03 3 1  ON 22
ci_024                 9.500148e-03 3 1  ON 23
ci_025                 7.133145e-03 3 1  ON 24
ci_026                 8.151734e-03 3 1  ON 25
ci_027                 7.919618e-03 3 1  ON 26
ci_028                 7.855176e-03 3 1  ON 27
ci_029                -7.651616e-03 3 1  ON 28
ci_030                -7.776230e-03 3 1  ON 29
ci_031                -7.191643e-03 3 1  ON 30
ci_032                -7.559076e-03 3 1  ON 31
ci_033                 6.845045e-03 3 1  ON 32
ci_034                 6.314233e-03 3 1  ON 33
ci_035                 6.419094e-03 3 1  ON 34
ci_036                 6.973897e-03 3 1  ON 35
ci_037                 6.509924e-03 3 1  ON 36
ci_038                 5.596365e-03 3 1  ON 37
ci_039                 5.922713e-03 3 1  ON 38
ci_040                 6.140012e-03 3 1  ON 39
ci_041                 5.437483e-03 3 1  ON 40
ci_042                 5.120690e-03 3 1  ON 41
ci_043                 5.094610e-03 3 1  ON 42
ci_044                 4.426787e-03 3 1  ON 43
ci_045                 5.132102e-03 3 1  ON 44
ci_046                 5.269550e-03 3 1  ON 45
ci_047                -3.972720e-03 3 1  ON 46
ci_048                -4.392973e-03 3 1  ON 47
ci_049                 4.067145e-03 3 1  ON 48
ci_050                 3.471279e-03 3 1  ON 49
ci_051                -3.070134e-03 3 1  ON 50
ci_052                -2.185531e-03 3 1  ON 51
ci_053                -2.743271e-03 3 1  ON 52
ci_054                -3.466875e-03 3 1  ON 53
ci_055                -1.938747e-03 3 1  ON 54
ci_056                -2.008398e-03 3 1  ON 55
ci_057                -1.788329e-03 3 1  ON 56
ci_058                -1.822403e-03 3 1  ON 57
ci_059                -1.896131e-03 3 1  ON 58
ci_060                -2.084724e-03 3 1  ON 59
ci_061                -1.836878e-03 3 1  ON 60
ci_062                -1.923529e-03 3 1  ON 61
ci_063                -1.940352e-03 3 1  ON 62
ci_064                -9.368083e-04 3 1  ON 63
ci_065                -1.766688e-03 3 1  ON 64
ci_066                -1.408039e-03 3 1  ON 65
ci_067                -1.986371e-03 3 1  ON 66
ci_068                -1.519622e-03 3 1  ON 67
ci_069                 1.139323e-03 3 1  ON 68
ci_070                 1.595877e-03 3 1  ON 69
ci_071                 2.273964e-05 3 1  ON 70
ci_072                -2.370064e-04 3 1  ON 71
ci_073                 1.365383e-03 3 1  ON 72
ci_074                 8.852732e-04 3 1  ON 73
ci_075                -1.346043e-03 3 1  ON 74
ci_076                -7.305879e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4663e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2298e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.1247
    reference variance = 3.95799
====================================================
  Execution time = 2.3830e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0309e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6975e+00
  Total weights = 1.950014361e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8349e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.749475385934
                                         uncertainty =       0.032343370488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.749475385934
                                         uncertainty =       0.032343370488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369097982
  error estimate for blocks of size 2^( 2) =       0.001439576486
  error estimate for blocks of size 2^( 3) =       0.001502508963
  error estimate for blocks of size 2^( 4) =       0.001547689348
  error estimate for blocks of size 2^( 5) =       0.001571281418
  error estimate for blocks of size 2^( 6) =       0.001585872482
  error estimate for blocks of size 2^( 7) =       0.001594208816

      target function =                  N/A
              le_mean =     -22.327772948958
             les_mean =     502.226945171904
             stat err =       0.001574763016
             autocorr =       1.323004595624
              std dev =       1.936227913078
             le_variance =       3.748978531383


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232777294896e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327772948134       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327773101802       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327773102335       residual = 3.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+02 is 3.058965e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327772948134       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327772986590       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327772986725       residual = 3.69e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+02 is 7.654165e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327772948134       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327772957750       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327772957784       residual = 3.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+03 is 1.913964e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092267 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9672e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_001                -6.963144e-01 3 1  ON 0
ci_002                -7.040942e-01 3 1  ON 1
ci_003                -6.187683e-02 3 1  ON 2
ci_004                -6.236210e-02 3 1  ON 3
ci_005                 4.605299e-02 3 1  ON 4
ci_006                 4.617168e-02 3 1  ON 5
ci_007                 3.181796e-02 3 1  ON 6
ci_008                 3.147021e-02 3 1  ON 7
ci_009                -2.501662e-02 3 1  ON 8
ci_010                -2.553587e-02 3 1  ON 9
ci_011                -2.290004e-02 3 1  ON 10
ci_012                -2.258328e-02 3 1  ON 11
ci_013                 2.001387e-02 3 1  ON 12
ci_014                 2.020221e-02 3 1  ON 13
ci_015                 1.968986e-02 3 1  ON 14
ci_016                 2.075044e-02 3 1  ON 15
ci_017                 1.537283e-02 3 1  ON 16
ci_018                 1.572240e-02 3 1  ON 17
ci_019                 1.063979e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780643e-03 3 1  ON 20
ci_022                -9.442218e-03 3 1  ON 21
ci_023                 8.738957e-03 3 1  ON 22
ci_024                 9.500010e-03 3 1  ON 23
ci_025                 7.133423e-03 3 1  ON 24
ci_026                 8.151070e-03 3 1  ON 25
ci_027                 7.919719e-03 3 1  ON 26
ci_028                 7.855428e-03 3 1  ON 27
ci_029                -7.651558e-03 3 1  ON 28
ci_030                -7.776307e-03 3 1  ON 29
ci_031                -7.191736e-03 3 1  ON 30
ci_032                -7.559320e-03 3 1  ON 31
ci_033                 6.844954e-03 3 1  ON 32
ci_034                 6.313786e-03 3 1  ON 33
ci_035                 6.419441e-03 3 1  ON 34
ci_036                 6.973453e-03 3 1  ON 35
ci_037                 6.510027e-03 3 1  ON 36
ci_038                 5.596658e-03 3 1  ON 37
ci_039                 5.922674e-03 3 1  ON 38
ci_040                 6.139546e-03 3 1  ON 39
ci_041                 5.437592e-03 3 1  ON 40
ci_042                 5.121189e-03 3 1  ON 41
ci_043                 5.094450e-03 3 1  ON 42
ci_044                 4.427157e-03 3 1  ON 43
ci_045                 5.131659e-03 3 1  ON 44
ci_046                 5.269331e-03 3 1  ON 45
ci_047                -3.972884e-03 3 1  ON 46
ci_048                -4.392635e-03 3 1  ON 47
ci_049                 4.067214e-03 3 1  ON 48
ci_050                 3.470513e-03 3 1  ON 49
ci_051                -3.070197e-03 3 1  ON 50
ci_052                -2.185347e-03 3 1  ON 51
ci_053                -2.743369e-03 3 1  ON 52
ci_054                -3.466764e-03 3 1  ON 53
ci_055                -1.938846e-03 3 1  ON 54
ci_056                -2.008480e-03 3 1  ON 55
ci_057                -1.788365e-03 3 1  ON 56
ci_058                -1.822765e-03 3 1  ON 57
ci_059                -1.895513e-03 3 1  ON 58
ci_060                -2.084390e-03 3 1  ON 59
ci_061                -1.836839e-03 3 1  ON 60
ci_062                -1.923726e-03 3 1  ON 61
ci_063                -1.940217e-03 3 1  ON 62
ci_064                -9.368198e-04 3 1  ON 63
ci_065                -1.766399e-03 3 1  ON 64
ci_066                -1.408480e-03 3 1  ON 65
ci_067                -1.986308e-03 3 1  ON 66
ci_068                -1.520024e-03 3 1  ON 67
ci_069                 1.139361e-03 3 1  ON 68
ci_070                 1.595786e-03 3 1  ON 69
ci_071                 2.284414e-05 3 1  ON 70
ci_072                -2.367758e-04 3 1  ON 71
ci_073                 1.365089e-03 3 1  ON 72
ci_074                 8.852775e-04 3 1  ON 73
ci_075                -1.345759e-03 3 1  ON 74
ci_076                -7.302765e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -21.9529
    reference variance = 3.93514
====================================================
  Execution time = 2.3144e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7199e+00
  Total weights = 1.9498e+06
  Execution time = 4.3468e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772151062412
                                         uncertainty =       0.034344997470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772151062412
                                         uncertainty =       0.034344997470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373225372
  error estimate for blocks of size 2^( 2) =       0.001443909195
  error estimate for blocks of size 2^( 3) =       0.001507344654
  error estimate for blocks of size 2^( 4) =       0.001551189521
  error estimate for blocks of size 2^( 5) =       0.001573491590
  error estimate for blocks of size 2^( 6) =       0.001582317609
  error estimate for blocks of size 2^( 7) =       0.001590798209

      target function =                  N/A
              le_mean =     -22.328958683240
             les_mean =     502.302298017857
             stat err =       0.001574449232
             autocorr =       1.314539634109
              std dev =       1.942065018198
             le_variance =       3.771616534908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772151072140
                                         uncertainty =       0.034345001237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772151072140
                                         uncertainty =       0.034345001237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373225374
  error estimate for blocks of size 2^( 2) =       0.001443909252
  error estimate for blocks of size 2^( 3) =       0.001507344784
  error estimate for blocks of size 2^( 4) =       0.001551189730
  error estimate for blocks of size 2^( 5) =       0.001573491777
  error estimate for blocks of size 2^( 6) =       0.001582317811
  error estimate for blocks of size 2^( 7) =       0.001590798448

      target function =                  N/A
              le_mean =     -22.328958686599
             les_mean =     502.302299200763
             stat err =       0.001574449442
             autocorr =       1.314539980711
              std dev =       1.942065020147
             le_variance =       3.771616542478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772151066942
                                         uncertainty =       0.034344999353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772151066942
                                         uncertainty =       0.034344999353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373225373
  error estimate for blocks of size 2^( 2) =       0.001443909225
  error estimate for blocks of size 2^( 3) =       0.001507344718
  error estimate for blocks of size 2^( 4) =       0.001551189626
  error estimate for blocks of size 2^( 5) =       0.001573491686
  error estimate for blocks of size 2^( 6) =       0.001582317713
  error estimate for blocks of size 2^( 7) =       0.001590798332

      target function =                  N/A
              le_mean =     -22.328958684032
             les_mean =     502.302773491198
             stat err =       0.001574449339
             autocorr =       1.314539810955
              std dev =       1.942065019086
             le_variance =       3.771616538359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772151062947
                                         uncertainty =       0.034344997705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772151062947
                                         uncertainty =       0.034344997705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373225373
  error estimate for blocks of size 2^( 2) =       0.001443909199
  error estimate for blocks of size 2^( 3) =       0.001507344662
  error estimate for blocks of size 2^( 4) =       0.001551189534
  error estimate for blocks of size 2^( 5) =       0.001573491602
  error estimate for blocks of size 2^( 6) =       0.001582317622
  error estimate for blocks of size 2^( 7) =       0.001590798224

      target function =                  N/A
              le_mean =     -22.328958683432
             les_mean =     502.302298247486
             stat err =       0.001574449246
             autocorr =       1.314539655848
              std dev =       1.942065018301
             le_variance =       3.771616535308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328958683240        initial
     1.4211e+02     1.4211e+03             3.0590e-06       -22.328958686599  <--
     5.6843e+02     5.6843e+03             7.6542e-07       -22.328958684032
     2.2737e+03     2.2737e+04             1.9140e-07       -22.328958683432

*****************************************************************************
Applying the update for shift_i =   1.4211e+02     and shift_s =   1.4211e+03
*****************************************************************************

  Execution time = 4.4979e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_001                -6.963146e-01 3 1  ON 0
ci_002                -7.040942e-01 3 1  ON 1
ci_003                -6.187672e-02 3 1  ON 2
ci_004                -6.236228e-02 3 1  ON 3
ci_005                 4.605181e-02 3 1  ON 4
ci_006                 4.617244e-02 3 1  ON 5
ci_007                 3.181724e-02 3 1  ON 6
ci_008                 3.146956e-02 3 1  ON 7
ci_009                -2.501507e-02 3 1  ON 8
ci_010                -2.553474e-02 3 1  ON 9
ci_011                -2.289886e-02 3 1  ON 10
ci_012                -2.258268e-02 3 1  ON 11
ci_013                 2.001422e-02 3 1  ON 12
ci_014                 2.020309e-02 3 1  ON 13
ci_015                 1.968994e-02 3 1  ON 14
ci_016                 2.074984e-02 3 1  ON 15
ci_017                 1.537248e-02 3 1  ON 16
ci_018                 1.572224e-02 3 1  ON 17
ci_019                 1.063970e-02 3 1  ON 18
ci_020                 1.043589e-02 3 1  ON 19
ci_021                -9.782421e-03 3 1  ON 20
ci_022                -9.443501e-03 3 1  ON 21
ci_023                 8.738267e-03 3 1  ON 22
ci_024                 9.499596e-03 3 1  ON 23
ci_025                 7.134258e-03 3 1  ON 24
ci_026                 8.149081e-03 3 1  ON 25
ci_027                 7.920024e-03 3 1  ON 26
ci_028                 7.856184e-03 3 1  ON 27
ci_029                -7.651385e-03 3 1  ON 28
ci_030                -7.776538e-03 3 1  ON 29
ci_031                -7.192014e-03 3 1  ON 30
ci_032                -7.560051e-03 3 1  ON 31
ci_033                 6.844684e-03 3 1  ON 32
ci_034                 6.312446e-03 3 1  ON 33
ci_035                 6.420482e-03 3 1  ON 34
ci_036                 6.972122e-03 3 1  ON 35
ci_037                 6.510335e-03 3 1  ON 36
ci_038                 5.597536e-03 3 1  ON 37
ci_039                 5.922560e-03 3 1  ON 38
ci_040                 6.138151e-03 3 1  ON 39
ci_041                 5.437917e-03 3 1  ON 40
ci_042                 5.122685e-03 3 1  ON 41
ci_043                 5.093973e-03 3 1  ON 42
ci_044                 4.428264e-03 3 1  ON 43
ci_045                 5.130333e-03 3 1  ON 44
ci_046                 5.268675e-03 3 1  ON 45
ci_047                -3.973377e-03 3 1  ON 46
ci_048                -4.391624e-03 3 1  ON 47
ci_049                 4.067422e-03 3 1  ON 48
ci_050                 3.468220e-03 3 1  ON 49
ci_051                -3.070386e-03 3 1  ON 50
ci_052                -2.184794e-03 3 1  ON 51
ci_053                -2.743663e-03 3 1  ON 52
ci_054                -3.466434e-03 3 1  ON 53
ci_055                -1.939144e-03 3 1  ON 54
ci_056                -2.008725e-03 3 1  ON 55
ci_057                -1.788471e-03 3 1  ON 56
ci_058                -1.823852e-03 3 1  ON 57
ci_059                -1.893663e-03 3 1  ON 58
ci_060                -2.083390e-03 3 1  ON 59
ci_061                -1.836721e-03 3 1  ON 60
ci_062                -1.924315e-03 3 1  ON 61
ci_063                -1.939813e-03 3 1  ON 62
ci_064                -9.368541e-04 3 1  ON 63
ci_065                -1.765534e-03 3 1  ON 64
ci_066                -1.409804e-03 3 1  ON 65
ci_067                -1.986121e-03 3 1  ON 66
ci_068                -1.521229e-03 3 1  ON 67
ci_069                 1.139475e-03 3 1  ON 68
ci_070                 1.595511e-03 3 1  ON 69
ci_071                 2.315745e-05 3 1  ON 70
ci_072                -2.360849e-04 3 1  ON 71
ci_073                 1.364210e-03 3 1  ON 72
ci_074                 8.852905e-04 3 1  ON 73
ci_075                -1.344908e-03 3 1  ON 74
ci_076                -7.293435e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4658e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2292e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.2204
    reference variance = 4.73303
====================================================
  Execution time = 2.3792e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0266e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7484e+00
  Total weights = 1.949602387e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8405e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801257798724
                                         uncertainty =       0.062764228747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801257798724
                                         uncertainty =       0.062764228747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378527529
  error estimate for blocks of size 2^( 2) =       0.001449142252
  error estimate for blocks of size 2^( 3) =       0.001512383197
  error estimate for blocks of size 2^( 4) =       0.001554818066
  error estimate for blocks of size 2^( 5) =       0.001578945337
  error estimate for blocks of size 2^( 6) =       0.001589716674
  error estimate for blocks of size 2^( 7) =       0.001601659252

      target function =                  N/A
              le_mean =     -22.327348378867
             les_mean =     502.258838874048
             stat err =       0.001581284832
             autocorr =       1.315798307779
              std dev =       1.949563520331
             le_variance =       3.800797919805


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232734837887e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+01, overlap shift 3.5527e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327348378069       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327348801158       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327348804817       residual = 3.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+01 is 1.483818e-05

solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327348378069       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327348484289       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327348485163       residual = 3.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+02 is 3.723924e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327348378069       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327348404652       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327348404868       residual = 3.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+02 is 9.318846e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093423 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9639e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_001                -6.963138e-01 3 1  ON 0
ci_002                -7.040953e-01 3 1  ON 1
ci_003                -6.187679e-02 3 1  ON 2
ci_004                -6.236138e-02 3 1  ON 3
ci_005                 4.605046e-02 3 1  ON 4
ci_006                 4.617249e-02 3 1  ON 5
ci_007                 3.181453e-02 3 1  ON 6
ci_008                 3.147014e-02 3 1  ON 7
ci_009                -2.501495e-02 3 1  ON 8
ci_010                -2.553214e-02 3 1  ON 9
ci_011                -2.289810e-02 3 1  ON 10
ci_012                -2.258134e-02 3 1  ON 11
ci_013                 2.001320e-02 3 1  ON 12
ci_014                 2.020286e-02 3 1  ON 13
ci_015                 1.968977e-02 3 1  ON 14
ci_016                 2.074850e-02 3 1  ON 15
ci_017                 1.537287e-02 3 1  ON 16
ci_018                 1.572404e-02 3 1  ON 17
ci_019                 1.063875e-02 3 1  ON 18
ci_020                 1.043666e-02 3 1  ON 19
ci_021                -9.782752e-03 3 1  ON 20
ci_022                -9.444035e-03 3 1  ON 21
ci_023                 8.740455e-03 3 1  ON 22
ci_024                 9.499394e-03 3 1  ON 23
ci_025                 7.134153e-03 3 1  ON 24
ci_026                 8.149924e-03 3 1  ON 25
ci_027                 7.920769e-03 3 1  ON 26
ci_028                 7.858048e-03 3 1  ON 27
ci_029                -7.651351e-03 3 1  ON 28
ci_030                -7.777428e-03 3 1  ON 29
ci_031                -7.192359e-03 3 1  ON 30
ci_032                -7.561605e-03 3 1  ON 31
ci_033                 6.844581e-03 3 1  ON 32
ci_034                 6.313128e-03 3 1  ON 33
ci_035                 6.420034e-03 3 1  ON 34
ci_036                 6.970670e-03 3 1  ON 35
ci_037                 6.510656e-03 3 1  ON 36
ci_038                 5.598391e-03 3 1  ON 37
ci_039                 5.922291e-03 3 1  ON 38
ci_040                 6.137696e-03 3 1  ON 39
ci_041                 5.436566e-03 3 1  ON 40
ci_042                 5.122252e-03 3 1  ON 41
ci_043                 5.094216e-03 3 1  ON 42
ci_044                 4.431988e-03 3 1  ON 43
ci_045                 5.130960e-03 3 1  ON 44
ci_046                 5.270511e-03 3 1  ON 45
ci_047                -3.973738e-03 3 1  ON 46
ci_048                -4.392550e-03 3 1  ON 47
ci_049                 4.066597e-03 3 1  ON 48
ci_050                 3.467042e-03 3 1  ON 49
ci_051                -3.070371e-03 3 1  ON 50
ci_052                -2.184728e-03 3 1  ON 51
ci_053                -2.743524e-03 3 1  ON 52
ci_054                -3.464996e-03 3 1  ON 53
ci_055                -1.940135e-03 3 1  ON 54
ci_056                -2.008182e-03 3 1  ON 55
ci_057                -1.788673e-03 3 1  ON 56
ci_058                -1.822755e-03 3 1  ON 57
ci_059                -1.895026e-03 3 1  ON 58
ci_060                -2.081013e-03 3 1  ON 59
ci_061                -1.836773e-03 3 1  ON 60
ci_062                -1.923721e-03 3 1  ON 61
ci_063                -1.939717e-03 3 1  ON 62
ci_064                -9.377193e-04 3 1  ON 63
ci_065                -1.764945e-03 3 1  ON 64
ci_066                -1.410661e-03 3 1  ON 65
ci_067                -1.985386e-03 3 1  ON 66
ci_068                -1.521482e-03 3 1  ON 67
ci_069                 1.138966e-03 3 1  ON 68
ci_070                 1.594700e-03 3 1  ON 69
ci_071                 2.178790e-05 3 1  ON 70
ci_072                -2.379957e-04 3 1  ON 71
ci_073                 1.364902e-03 3 1  ON 72
ci_074                 8.873096e-04 3 1  ON 73
ci_075                -1.342599e-03 3 1  ON 74
ci_076                -7.299452e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.5158
    reference variance = 2.27753
====================================================
  Execution time = 2.3264e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.6947e+00
  Total weights = 1.9501e+06
  Execution time = 4.3620e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745844041738
                                         uncertainty =       0.028156302662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745844041738
                                         uncertainty =       0.028156302662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368407450
  error estimate for blocks of size 2^( 2) =       0.001440469437
  error estimate for blocks of size 2^( 3) =       0.001503074235
  error estimate for blocks of size 2^( 4) =       0.001546469013
  error estimate for blocks of size 2^( 5) =       0.001571267287
  error estimate for blocks of size 2^( 6) =       0.001583362383
  error estimate for blocks of size 2^( 7) =       0.001589362587

      target function =                  N/A
              le_mean =     -22.327308050819
             les_mean =     502.203372646257
             stat err =       0.001572615317
             autocorr =       1.320730305373
              std dev =       1.935251337322
             le_variance =       3.745197738607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745844419063
                                         uncertainty =       0.028156010782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745844419063
                                         uncertainty =       0.028156010782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368407519
  error estimate for blocks of size 2^( 2) =       0.001440469562
  error estimate for blocks of size 2^( 3) =       0.001503074584
  error estimate for blocks of size 2^( 4) =       0.001546469569
  error estimate for blocks of size 2^( 5) =       0.001571267802
  error estimate for blocks of size 2^( 6) =       0.001583363253
  error estimate for blocks of size 2^( 7) =       0.001589363948

      target function =                  N/A
              le_mean =     -22.327308119965
             les_mean =     502.203368506726
             stat err =       0.001572616143
             autocorr =       1.320731557091
              std dev =       1.935251436042
             le_variance =       3.745198120701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745844223706
                                         uncertainty =       0.028156156569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745844223706
                                         uncertainty =       0.028156156569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368407483
  error estimate for blocks of size 2^( 2) =       0.001440469499
  error estimate for blocks of size 2^( 3) =       0.001503074410
  error estimate for blocks of size 2^( 4) =       0.001546469292
  error estimate for blocks of size 2^( 5) =       0.001571267545
  error estimate for blocks of size 2^( 6) =       0.001583362818
  error estimate for blocks of size 2^( 7) =       0.001589363268

      target function =                  N/A
              le_mean =     -22.327308084824
             les_mean =     502.203367317833
             stat err =       0.001572615731
             autocorr =       1.320730934286
              std dev =       1.935251384958
             le_variance =       3.745197922983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745844063776
                                         uncertainty =       0.028156284413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745844063776
                                         uncertainty =       0.028156284413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368407454
  error estimate for blocks of size 2^( 2) =       0.001440469445
  error estimate for blocks of size 2^( 3) =       0.001503074257
  error estimate for blocks of size 2^( 4) =       0.001546469048
  error estimate for blocks of size 2^( 5) =       0.001571267319
  error estimate for blocks of size 2^( 6) =       0.001583362437
  error estimate for blocks of size 2^( 7) =       0.001589362671

      target function =                  N/A
              le_mean =     -22.327308055049
             les_mean =     502.203369798497
             stat err =       0.001572615369
             autocorr =       1.320730383685
              std dev =       1.935251343094
             le_variance =       3.745197760948


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327308050819        initial
     3.5527e+01     3.5527e+02             1.4838e-05       -22.327308119965  <--
     1.4211e+02     1.4211e+03             3.7239e-06       -22.327308084824
     5.6843e+02     5.6843e+03             9.3188e-07       -22.327308055049

*****************************************************************************
Applying the update for shift_i =   3.5527e+01     and shift_s =   3.5527e+02
*****************************************************************************

  Execution time = 4.8054e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_001                -6.963114e-01 3 1  ON 0
ci_002                -7.040987e-01 3 1  ON 1
ci_003                -6.187700e-02 3 1  ON 2
ci_004                -6.235867e-02 3 1  ON 3
ci_005                 4.604647e-02 3 1  ON 4
ci_006                 4.617266e-02 3 1  ON 5
ci_007                 3.180644e-02 3 1  ON 6
ci_008                 3.147188e-02 3 1  ON 7
ci_009                -2.501457e-02 3 1  ON 8
ci_010                -2.552440e-02 3 1  ON 9
ci_011                -2.289583e-02 3 1  ON 10
ci_012                -2.257736e-02 3 1  ON 11
ci_013                 2.001016e-02 3 1  ON 12
ci_014                 2.020215e-02 3 1  ON 13
ci_015                 1.968927e-02 3 1  ON 14
ci_016                 2.074447e-02 3 1  ON 15
ci_017                 1.537404e-02 3 1  ON 16
ci_018                 1.572942e-02 3 1  ON 17
ci_019                 1.063592e-02 3 1  ON 18
ci_020                 1.043895e-02 3 1  ON 19
ci_021                -9.783738e-03 3 1  ON 20
ci_022                -9.445633e-03 3 1  ON 21
ci_023                 8.746979e-03 3 1  ON 22
ci_024                 9.498793e-03 3 1  ON 23
ci_025                 7.133842e-03 3 1  ON 24
ci_026                 8.152441e-03 3 1  ON 25
ci_027                 7.922984e-03 3 1  ON 26
ci_028                 7.863595e-03 3 1  ON 27
ci_029                -7.651249e-03 3 1  ON 28
ci_030                -7.780074e-03 3 1  ON 29
ci_031                -7.193387e-03 3 1  ON 30
ci_032                -7.566245e-03 3 1  ON 31
ci_033                 6.844273e-03 3 1  ON 32
ci_034                 6.315163e-03 3 1  ON 33
ci_035                 6.418696e-03 3 1  ON 34
ci_036                 6.966344e-03 3 1  ON 35
ci_037                 6.511612e-03 3 1  ON 36
ci_038                 5.600942e-03 3 1  ON 37
ci_039                 5.921493e-03 3 1  ON 38
ci_040                 6.136342e-03 3 1  ON 39
ci_041                 5.432541e-03 3 1  ON 40
ci_042                 5.120962e-03 3 1  ON 41
ci_043                 5.094940e-03 3 1  ON 42
ci_044                 4.443102e-03 3 1  ON 43
ci_045                 5.132832e-03 3 1  ON 44
ci_046                 5.275990e-03 3 1  ON 45
ci_047                -3.974810e-03 3 1  ON 46
ci_048                -4.395300e-03 3 1  ON 47
ci_049                 4.064132e-03 3 1  ON 48
ci_050                 3.463525e-03 3 1  ON 49
ci_051                -3.070321e-03 3 1  ON 50
ci_052                -2.184528e-03 3 1  ON 51
ci_053                -2.743108e-03 3 1  ON 52
ci_054                -3.460699e-03 3 1  ON 53
ci_055                -1.943095e-03 3 1  ON 54
ci_056                -2.006560e-03 3 1  ON 55
ci_057                -1.789275e-03 3 1  ON 56
ci_058                -1.819480e-03 3 1  ON 57
ci_059                -1.899083e-03 3 1  ON 58
ci_060                -2.073938e-03 3 1  ON 59
ci_061                -1.836935e-03 3 1  ON 60
ci_062                -1.921949e-03 3 1  ON 61
ci_063                -1.939436e-03 3 1  ON 62
ci_064                -9.403044e-04 3 1  ON 63
ci_065                -1.763183e-03 3 1  ON 64
ci_066                -1.413212e-03 3 1  ON 65
ci_067                -1.983186e-03 3 1  ON 66
ci_068                -1.522237e-03 3 1  ON 67
ci_069                 1.137446e-03 3 1  ON 68
ci_070                 1.592282e-03 3 1  ON 69
ci_071                 1.770519e-05 3 1  ON 70
ci_072                -2.436997e-04 3 1  ON 71
ci_073                 1.366968e-03 3 1  ON 72
ci_074                 8.933193e-04 3 1  ON 73
ci_075                -1.335712e-03 3 1  ON 74
ci_076                -7.317438e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7699e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2294e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.5244
    reference variance = 2.22895
====================================================
  Execution time = 2.3844e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0325e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6634e+00
  Total weights = 1.950020513e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8658e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.712464963383
                                         uncertainty =       0.026282641760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.712464963383
                                         uncertainty =       0.026282641760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362263896
  error estimate for blocks of size 2^( 2) =       0.001433203279
  error estimate for blocks of size 2^( 3) =       0.001496203148
  error estimate for blocks of size 2^( 4) =       0.001538702328
  error estimate for blocks of size 2^( 5) =       0.001564384915
  error estimate for blocks of size 2^( 6) =       0.001573707251
  error estimate for blocks of size 2^( 7) =       0.001585344975

      target function =                  N/A
              le_mean =     -22.328582364880
             les_mean =     502.228954214782
             stat err =       0.001565534867
             autocorr =       1.320696405722
              std dev =       1.926562901293
             le_variance =       3.711644612638


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232858236488e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+00, overlap shift 8.8818e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328582364046       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328583772284       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328583865220       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328583864018       residual = 2.58e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+00 is 5.056440e-05

solving harmonic davidson linear method for identity shift 3.5527e+01, overlap shift 3.5527e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328582364046       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328582722272       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328582745473       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328582745117       residual = 2.79e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+01 is 1.296865e-05

solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328582364046       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328582453996       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328582459795       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328582459702       residual = 2.88e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+02 is 3.263295e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.094975 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9717e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_001                -6.963125e-01 3 1  ON 0
ci_002                -7.040983e-01 3 1  ON 1
ci_003                -6.187591e-02 3 1  ON 2
ci_004                -6.235844e-02 3 1  ON 3
ci_005                 4.604146e-02 3 1  ON 4
ci_006                 4.616881e-02 3 1  ON 5
ci_007                 3.180447e-02 3 1  ON 6
ci_008                 3.147349e-02 3 1  ON 7
ci_009                -2.501780e-02 3 1  ON 8
ci_010                -2.552151e-02 3 1  ON 9
ci_011                -2.288972e-02 3 1  ON 10
ci_012                -2.257216e-02 3 1  ON 11
ci_013                 2.000601e-02 3 1  ON 12
ci_014                 2.020420e-02 3 1  ON 13
ci_015                 1.968659e-02 3 1  ON 14
ci_016                 2.074983e-02 3 1  ON 15
ci_017                 1.537438e-02 3 1  ON 16
ci_018                 1.573392e-02 3 1  ON 17
ci_019                 1.063619e-02 3 1  ON 18
ci_020                 1.043980e-02 3 1  ON 19
ci_021                -9.779995e-03 3 1  ON 20
ci_022                -9.450205e-03 3 1  ON 21
ci_023                 8.747271e-03 3 1  ON 22
ci_024                 9.497555e-03 3 1  ON 23
ci_025                 7.144391e-03 3 1  ON 24
ci_026                 8.162364e-03 3 1  ON 25
ci_027                 7.930490e-03 3 1  ON 26
ci_028                 7.862637e-03 3 1  ON 27
ci_029                -7.652745e-03 3 1  ON 28
ci_030                -7.784755e-03 3 1  ON 29
ci_031                -7.200492e-03 3 1  ON 30
ci_032                -7.564005e-03 3 1  ON 31
ci_033                 6.842392e-03 3 1  ON 32
ci_034                 6.318879e-03 3 1  ON 33
ci_035                 6.425442e-03 3 1  ON 34
ci_036                 6.966355e-03 3 1  ON 35
ci_037                 6.508590e-03 3 1  ON 36
ci_038                 5.607821e-03 3 1  ON 37
ci_039                 5.911711e-03 3 1  ON 38
ci_040                 6.123374e-03 3 1  ON 39
ci_041                 5.430970e-03 3 1  ON 40
ci_042                 5.123048e-03 3 1  ON 41
ci_043                 5.090227e-03 3 1  ON 42
ci_044                 4.447890e-03 3 1  ON 43
ci_045                 5.139640e-03 3 1  ON 44
ci_046                 5.277947e-03 3 1  ON 45
ci_047                -3.977146e-03 3 1  ON 46
ci_048                -4.393915e-03 3 1  ON 47
ci_049                 4.062719e-03 3 1  ON 48
ci_050                 3.462047e-03 3 1  ON 49
ci_051                -3.073972e-03 3 1  ON 50
ci_052                -2.186690e-03 3 1  ON 51
ci_053                -2.740096e-03 3 1  ON 52
ci_054                -3.451603e-03 3 1  ON 53
ci_055                -1.940097e-03 3 1  ON 54
ci_056                -2.009276e-03 3 1  ON 55
ci_057                -1.791559e-03 3 1  ON 56
ci_058                -1.815626e-03 3 1  ON 57
ci_059                -1.900033e-03 3 1  ON 58
ci_060                -2.078184e-03 3 1  ON 59
ci_061                -1.828730e-03 3 1  ON 60
ci_062                -1.920392e-03 3 1  ON 61
ci_063                -1.936980e-03 3 1  ON 62
ci_064                -9.416142e-04 3 1  ON 63
ci_065                -1.760425e-03 3 1  ON 64
ci_066                -1.420870e-03 3 1  ON 65
ci_067                -1.978655e-03 3 1  ON 66
ci_068                -1.523508e-03 3 1  ON 67
ci_069                 1.143903e-03 3 1  ON 68
ci_070                 1.593788e-03 3 1  ON 69
ci_071                 1.994891e-05 3 1  ON 70
ci_072                -2.480507e-04 3 1  ON 71
ci_073                 1.367701e-03 3 1  ON 72
ci_074                 8.938442e-04 3 1  ON 73
ci_075                -1.323627e-03 3 1  ON 74
ci_076                -7.321748e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.3255
    reference variance = 3.06249
====================================================
  Execution time = 2.3268e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7102e+00
  Total weights = 1.9499e+06
  Execution time = 4.3436e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759085101635
                                         uncertainty =       0.030580319596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759085101635
                                         uncertainty =       0.030580319596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371023590
  error estimate for blocks of size 2^( 2) =       0.001441562913
  error estimate for blocks of size 2^( 3) =       0.001503082623
  error estimate for blocks of size 2^( 4) =       0.001544823249
  error estimate for blocks of size 2^( 5) =       0.001567366891
  error estimate for blocks of size 2^( 6) =       0.001580250705
  error estimate for blocks of size 2^( 7) =       0.001583312214

      target function =                  N/A
              le_mean =     -22.328209600718
             les_mean =     502.259116676279
             stat err =       0.001568938265
             autocorr =       1.309549308034
              std dev =       1.938951178129
             le_variance =       3.759531671166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759079563904
                                         uncertainty =       0.030580288114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759079563904
                                         uncertainty =       0.030580288114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371022360
  error estimate for blocks of size 2^( 2) =       0.001441562052
  error estimate for blocks of size 2^( 3) =       0.001503082531
  error estimate for blocks of size 2^( 4) =       0.001544823599
  error estimate for blocks of size 2^( 5) =       0.001567367853
  error estimate for blocks of size 2^( 6) =       0.001580252008
  error estimate for blocks of size 2^( 7) =       0.001583311801

      target function =                  N/A
              le_mean =     -22.328209512723
             les_mean =     502.259239603090
             stat err =       0.001568938815
             autocorr =       1.309552576809
              std dev =       1.938949438171
             le_variance =       3.759524923785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759082219171
                                         uncertainty =       0.030580301241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759082219171
                                         uncertainty =       0.030580301241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371022953
  error estimate for blocks of size 2^( 2) =       0.001441562469
  error estimate for blocks of size 2^( 3) =       0.001503082574
  error estimate for blocks of size 2^( 4) =       0.001544823442
  error estimate for blocks of size 2^( 5) =       0.001567367358
  error estimate for blocks of size 2^( 6) =       0.001580251365
  error estimate for blocks of size 2^( 7) =       0.001583312142

      target function =                  N/A
              le_mean =     -22.328209560759
             les_mean =     502.259093844499
             stat err =       0.001568938577
             autocorr =       1.309551046191
              std dev =       1.938950276726
             le_variance =       3.759528175614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759084733671
                                         uncertainty =       0.030580317186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759084733671
                                         uncertainty =       0.030580317186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371023509
  error estimate for blocks of size 2^( 2) =       0.001441562856
  error estimate for blocks of size 2^( 3) =       0.001503082617
  error estimate for blocks of size 2^( 4) =       0.001544823273
  error estimate for blocks of size 2^( 5) =       0.001567366949
  error estimate for blocks of size 2^( 6) =       0.001580250788
  error estimate for blocks of size 2^( 7) =       0.001583312209

      target function =                  N/A
              le_mean =     -22.328209595081
             les_mean =     502.259108940710
             stat err =       0.001568938305
             autocorr =       1.309549529625
              std dev =       1.938951063406
             le_variance =       3.759531226282


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328209600718        initial  <--
     8.8818e+00     8.8818e+01             5.0564e-05       -22.328209512723
     3.5527e+01     3.5527e+02             1.2969e-05       -22.328209560759
     1.4211e+02     1.4211e+03             3.2633e-06       -22.328209595081

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0864
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_001                -6.963114e-01 3 1  ON 0
ci_002                -7.040987e-01 3 1  ON 1
ci_003                -6.187700e-02 3 1  ON 2
ci_004                -6.235867e-02 3 1  ON 3
ci_005                 4.604647e-02 3 1  ON 4
ci_006                 4.617266e-02 3 1  ON 5
ci_007                 3.180644e-02 3 1  ON 6
ci_008                 3.147188e-02 3 1  ON 7
ci_009                -2.501457e-02 3 1  ON 8
ci_010                -2.552440e-02 3 1  ON 9
ci_011                -2.289583e-02 3 1  ON 10
ci_012                -2.257736e-02 3 1  ON 11
ci_013                 2.001016e-02 3 1  ON 12
ci_014                 2.020215e-02 3 1  ON 13
ci_015                 1.968927e-02 3 1  ON 14
ci_016                 2.074447e-02 3 1  ON 15
ci_017                 1.537404e-02 3 1  ON 16
ci_018                 1.572942e-02 3 1  ON 17
ci_019                 1.063592e-02 3 1  ON 18
ci_020                 1.043895e-02 3 1  ON 19
ci_021                -9.783738e-03 3 1  ON 20
ci_022                -9.445633e-03 3 1  ON 21
ci_023                 8.746979e-03 3 1  ON 22
ci_024                 9.498793e-03 3 1  ON 23
ci_025                 7.133842e-03 3 1  ON 24
ci_026                 8.152441e-03 3 1  ON 25
ci_027                 7.922984e-03 3 1  ON 26
ci_028                 7.863595e-03 3 1  ON 27
ci_029                -7.651249e-03 3 1  ON 28
ci_030                -7.780074e-03 3 1  ON 29
ci_031                -7.193387e-03 3 1  ON 30
ci_032                -7.566245e-03 3 1  ON 31
ci_033                 6.844273e-03 3 1  ON 32
ci_034                 6.315163e-03 3 1  ON 33
ci_035                 6.418696e-03 3 1  ON 34
ci_036                 6.966344e-03 3 1  ON 35
ci_037                 6.511612e-03 3 1  ON 36
ci_038                 5.600942e-03 3 1  ON 37
ci_039                 5.921493e-03 3 1  ON 38
ci_040                 6.136342e-03 3 1  ON 39
ci_041                 5.432541e-03 3 1  ON 40
ci_042                 5.120962e-03 3 1  ON 41
ci_043                 5.094940e-03 3 1  ON 42
ci_044                 4.443102e-03 3 1  ON 43
ci_045                 5.132832e-03 3 1  ON 44
ci_046                 5.275990e-03 3 1  ON 45
ci_047                -3.974810e-03 3 1  ON 46
ci_048                -4.395300e-03 3 1  ON 47
ci_049                 4.064132e-03 3 1  ON 48
ci_050                 3.463525e-03 3 1  ON 49
ci_051                -3.070321e-03 3 1  ON 50
ci_052                -2.184528e-03 3 1  ON 51
ci_053                -2.743108e-03 3 1  ON 52
ci_054                -3.460699e-03 3 1  ON 53
ci_055                -1.943095e-03 3 1  ON 54
ci_056                -2.006560e-03 3 1  ON 55
ci_057                -1.789275e-03 3 1  ON 56
ci_058                -1.819480e-03 3 1  ON 57
ci_059                -1.899083e-03 3 1  ON 58
ci_060                -2.073938e-03 3 1  ON 59
ci_061                -1.836935e-03 3 1  ON 60
ci_062                -1.921949e-03 3 1  ON 61
ci_063                -1.939436e-03 3 1  ON 62
ci_064                -9.403044e-04 3 1  ON 63
ci_065                -1.763183e-03 3 1  ON 64
ci_066                -1.413212e-03 3 1  ON 65
ci_067                -1.983186e-03 3 1  ON 66
ci_068                -1.522237e-03 3 1  ON 67
ci_069                 1.137446e-03 3 1  ON 68
ci_070                 1.592282e-03 3 1  ON 69
ci_071                 1.770519e-05 3 1  ON 70
ci_072                -2.436997e-04 3 1  ON 71
ci_073                 1.366968e-03 3 1  ON 72
ci_074                 8.933193e-04 3 1  ON 73
ci_075                -1.335712e-03 3 1  ON 74
ci_076                -7.317438e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4811e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2297e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.4649
    reference variance = 3.53332
====================================================
  Execution time = 2.3802e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0281e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7925e+00
  Total weights = 1.949900528e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8753e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846665834360
                                         uncertainty =       0.055639753962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846665834360
                                         uncertainty =       0.055639753962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386781692
  error estimate for blocks of size 2^( 2) =       0.001456959520
  error estimate for blocks of size 2^( 3) =       0.001518761585
  error estimate for blocks of size 2^( 4) =       0.001561628112
  error estimate for blocks of size 2^( 5) =       0.001585626184
  error estimate for blocks of size 2^( 6) =       0.001590501150
  error estimate for blocks of size 2^( 7) =       0.001601149350

      target function =                  N/A
              le_mean =     -22.327499914794
             les_mean =     502.309765358347
             stat err =       0.001584726199
             autocorr =       1.305846943172
              std dev =       1.961236855577
             le_variance =       3.846450003674


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232749991479e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327499913973       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327500124983       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327500123031       residual = 5.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+01 is 4.549928e-06

solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327499913973       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327499966809       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327499966323       residual = 4.96e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+02 is 1.140573e-06

solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327499913973       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327499927188       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327499927066       residual = 4.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+03 is 2.853372e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096188 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9683e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_001                -6.963114e-01 3 1  ON 0
ci_002                -7.040987e-01 3 1  ON 1
ci_003                -6.187662e-02 3 1  ON 2
ci_004                -6.235877e-02 3 1  ON 3
ci_005                 4.604663e-02 3 1  ON 4
ci_006                 4.617279e-02 3 1  ON 5
ci_007                 3.180621e-02 3 1  ON 6
ci_008                 3.147208e-02 3 1  ON 7
ci_009                -2.501480e-02 3 1  ON 8
ci_010                -2.552426e-02 3 1  ON 9
ci_011                -2.289508e-02 3 1  ON 10
ci_012                -2.257710e-02 3 1  ON 11
ci_013                 2.001042e-02 3 1  ON 12
ci_014                 2.020261e-02 3 1  ON 13
ci_015                 1.968943e-02 3 1  ON 14
ci_016                 2.074491e-02 3 1  ON 15
ci_017                 1.537364e-02 3 1  ON 16
ci_018                 1.572927e-02 3 1  ON 17
ci_019                 1.063595e-02 3 1  ON 18
ci_020                 1.043886e-02 3 1  ON 19
ci_021                -9.783416e-03 3 1  ON 20
ci_022                -9.446682e-03 3 1  ON 21
ci_023                 8.747669e-03 3 1  ON 22
ci_024                 9.498855e-03 3 1  ON 23
ci_025                 7.134078e-03 3 1  ON 24
ci_026                 8.152846e-03 3 1  ON 25
ci_027                 7.922595e-03 3 1  ON 26
ci_028                 7.863913e-03 3 1  ON 27
ci_029                -7.651508e-03 3 1  ON 28
ci_030                -7.779791e-03 3 1  ON 29
ci_031                -7.192763e-03 3 1  ON 30
ci_032                -7.566212e-03 3 1  ON 31
ci_033                 6.844529e-03 3 1  ON 32
ci_034                 6.315771e-03 3 1  ON 33
ci_035                 6.418830e-03 3 1  ON 34
ci_036                 6.965975e-03 3 1  ON 35
ci_037                 6.512061e-03 3 1  ON 36
ci_038                 5.601983e-03 3 1  ON 37
ci_039                 5.920352e-03 3 1  ON 38
ci_040                 6.136558e-03 3 1  ON 39
ci_041                 5.431698e-03 3 1  ON 40
ci_042                 5.120784e-03 3 1  ON 41
ci_043                 5.095183e-03 3 1  ON 42
ci_044                 4.443995e-03 3 1  ON 43
ci_045                 5.133144e-03 3 1  ON 44
ci_046                 5.276309e-03 3 1  ON 45
ci_047                -3.975077e-03 3 1  ON 46
ci_048                -4.395052e-03 3 1  ON 47
ci_049                 4.063033e-03 3 1  ON 48
ci_050                 3.463084e-03 3 1  ON 49
ci_051                -3.070213e-03 3 1  ON 50
ci_052                -2.185428e-03 3 1  ON 51
ci_053                -2.743449e-03 3 1  ON 52
ci_054                -3.460314e-03 3 1  ON 53
ci_055                -1.943885e-03 3 1  ON 54
ci_056                -2.005657e-03 3 1  ON 55
ci_057                -1.789524e-03 3 1  ON 56
ci_058                -1.818842e-03 3 1  ON 57
ci_059                -1.898974e-03 3 1  ON 58
ci_060                -2.074489e-03 3 1  ON 59
ci_061                -1.837286e-03 3 1  ON 60
ci_062                -1.921805e-03 3 1  ON 61
ci_063                -1.939491e-03 3 1  ON 62
ci_064                -9.405871e-04 3 1  ON 63
ci_065                -1.762858e-03 3 1  ON 64
ci_066                -1.413848e-03 3 1  ON 65
ci_067                -1.983445e-03 3 1  ON 66
ci_068                -1.522155e-03 3 1  ON 67
ci_069                 1.137814e-03 3 1  ON 68
ci_070                 1.592901e-03 3 1  ON 69
ci_071                 1.701086e-05 3 1  ON 70
ci_072                -2.438680e-04 3 1  ON 71
ci_073                 1.366736e-03 3 1  ON 72
ci_074                 8.935811e-04 3 1  ON 73
ci_075                -1.335559e-03 3 1  ON 74
ci_076                -7.322314e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.3003
    reference variance = 2.76046
====================================================
  Execution time = 2.3219e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7613e+00
  Total weights = 1.9496e+06
  Execution time = 4.3265e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815941588017
                                         uncertainty =       0.074319833300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815941588017
                                         uncertainty =       0.074319833300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381097593
  error estimate for blocks of size 2^( 2) =       0.001451390828
  error estimate for blocks of size 2^( 3) =       0.001513734169
  error estimate for blocks of size 2^( 4) =       0.001556341468
  error estimate for blocks of size 2^( 5) =       0.001581885612
  error estimate for blocks of size 2^( 6) =       0.001595741008
  error estimate for blocks of size 2^( 7) =       0.001610348767

      target function =                  N/A
              le_mean =     -22.328762662553
             les_mean =     502.334960118199
             stat err =       0.001586079214
             autocorr =       1.318867025924
              std dev =       1.953198197563
             le_variance =       3.814983198965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815942671016
                                         uncertainty =       0.074319803758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815942671016
                                         uncertainty =       0.074319803758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381097787
  error estimate for blocks of size 2^( 2) =       0.001451391001
  error estimate for blocks of size 2^( 3) =       0.001513734341
  error estimate for blocks of size 2^( 4) =       0.001556341568
  error estimate for blocks of size 2^( 5) =       0.001581885796
  error estimate for blocks of size 2^( 6) =       0.001595740937
  error estimate for blocks of size 2^( 7) =       0.001610348662

      target function =                  N/A
              le_mean =     -22.328762731853
             les_mean =     502.336059293461
             stat err =       0.001586079241
             autocorr =       1.318866699810
              std dev =       1.953198472465
             le_variance =       3.814984272838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815942128643
                                         uncertainty =       0.074319818526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815942128643
                                         uncertainty =       0.074319818526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381097690
  error estimate for blocks of size 2^( 2) =       0.001451390915
  error estimate for blocks of size 2^( 3) =       0.001513734256
  error estimate for blocks of size 2^( 4) =       0.001556341515
  error estimate for blocks of size 2^( 5) =       0.001581885697
  error estimate for blocks of size 2^( 6) =       0.001595740967
  error estimate for blocks of size 2^( 7) =       0.001610348719

      target function =                  N/A
              le_mean =     -22.328762695154
             les_mean =     502.334987304189
             stat err =       0.001586079225
             autocorr =       1.318866858748
              std dev =       1.953198334789
             le_variance =       3.814983735023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815941655470
                                         uncertainty =       0.074319831454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815941655470
                                         uncertainty =       0.074319831454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381097605
  error estimate for blocks of size 2^( 2) =       0.001451390839
  error estimate for blocks of size 2^( 3) =       0.001513734180
  error estimate for blocks of size 2^( 4) =       0.001556341474
  error estimate for blocks of size 2^( 5) =       0.001581885622
  error estimate for blocks of size 2^( 6) =       0.001595741002
  error estimate for blocks of size 2^( 7) =       0.001610348761

      target function =                  N/A
              le_mean =     -22.328762666597
             les_mean =     502.334961950406
             stat err =       0.001586079215
             autocorr =       1.318867004994
              std dev =       1.953198214685
             le_variance =       3.814983265847


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328762662553        initial
     8.8818e+01     8.8818e+02             4.5499e-06       -22.328762731853  <--
     3.5527e+02     3.5527e+03             1.1406e-06       -22.328762695154
     1.4211e+03     1.4211e+04             2.8534e-07       -22.328762666597

*****************************************************************************
Applying the update for shift_i =   8.8818e+01     and shift_s =   8.8818e+02
*****************************************************************************

  Execution time = 4.4986e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_001                -6.963113e-01 3 1  ON 0
ci_002                -7.040987e-01 3 1  ON 1
ci_003                -6.187547e-02 3 1  ON 2
ci_004                -6.235905e-02 3 1  ON 3
ci_005                 4.604713e-02 3 1  ON 4
ci_006                 4.617319e-02 3 1  ON 5
ci_007                 3.180552e-02 3 1  ON 6
ci_008                 3.147268e-02 3 1  ON 7
ci_009                -2.501548e-02 3 1  ON 8
ci_010                -2.552383e-02 3 1  ON 9
ci_011                -2.289284e-02 3 1  ON 10
ci_012                -2.257629e-02 3 1  ON 11
ci_013                 2.001119e-02 3 1  ON 12
ci_014                 2.020399e-02 3 1  ON 13
ci_015                 1.968992e-02 3 1  ON 14
ci_016                 2.074623e-02 3 1  ON 15
ci_017                 1.537246e-02 3 1  ON 16
ci_018                 1.572885e-02 3 1  ON 17
ci_019                 1.063605e-02 3 1  ON 18
ci_020                 1.043857e-02 3 1  ON 19
ci_021                -9.782450e-03 3 1  ON 20
ci_022                -9.449824e-03 3 1  ON 21
ci_023                 8.749736e-03 3 1  ON 22
ci_024                 9.499043e-03 3 1  ON 23
ci_025                 7.134786e-03 3 1  ON 24
ci_026                 8.154060e-03 3 1  ON 25
ci_027                 7.921434e-03 3 1  ON 26
ci_028                 7.864860e-03 3 1  ON 27
ci_029                -7.652284e-03 3 1  ON 28
ci_030                -7.778942e-03 3 1  ON 29
ci_031                -7.190893e-03 3 1  ON 30
ci_032                -7.566113e-03 3 1  ON 31
ci_033                 6.845297e-03 3 1  ON 32
ci_034                 6.317590e-03 3 1  ON 33
ci_035                 6.419230e-03 3 1  ON 34
ci_036                 6.964870e-03 3 1  ON 35
ci_037                 6.513406e-03 3 1  ON 36
ci_038                 5.605099e-03 3 1  ON 37
ci_039                 5.916943e-03 3 1  ON 38
ci_040                 6.137205e-03 3 1  ON 39
ci_041                 5.429176e-03 3 1  ON 40
ci_042                 5.120252e-03 3 1  ON 41
ci_043                 5.095909e-03 3 1  ON 42
ci_044                 4.446668e-03 3 1  ON 43
ci_045                 5.134079e-03 3 1  ON 44
ci_046                 5.277264e-03 3 1  ON 45
ci_047                -3.975875e-03 3 1  ON 46
ci_048                -4.394310e-03 3 1  ON 47
ci_049                 4.059743e-03 3 1  ON 48
ci_050                 3.461762e-03 3 1  ON 49
ci_051                -3.069889e-03 3 1  ON 50
ci_052                -2.188123e-03 3 1  ON 51
ci_053                -2.744472e-03 3 1  ON 52
ci_054                -3.459162e-03 3 1  ON 53
ci_055                -1.946253e-03 3 1  ON 54
ci_056                -2.002952e-03 3 1  ON 55
ci_057                -1.790269e-03 3 1  ON 56
ci_058                -1.816931e-03 3 1  ON 57
ci_059                -1.898649e-03 3 1  ON 58
ci_060                -2.076136e-03 3 1  ON 59
ci_061                -1.838339e-03 3 1  ON 60
ci_062                -1.921373e-03 3 1  ON 61
ci_063                -1.939658e-03 3 1  ON 62
ci_064                -9.414332e-04 3 1  ON 63
ci_065                -1.761886e-03 3 1  ON 64
ci_066                -1.415752e-03 3 1  ON 65
ci_067                -1.984221e-03 3 1  ON 66
ci_068                -1.521913e-03 3 1  ON 67
ci_069                 1.138917e-03 3 1  ON 68
ci_070                 1.594756e-03 3 1  ON 69
ci_071                 1.493208e-05 3 1  ON 70
ci_072                -2.443712e-04 3 1  ON 71
ci_073                 1.366043e-03 3 1  ON 72
ci_074                 8.943649e-04 3 1  ON 73
ci_075                -1.335100e-03 3 1  ON 74
ci_076                -7.336913e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4676e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2299e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -21.884
    reference variance = 4.85498
====================================================
  Execution time = 2.3812e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0336e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7468e+00
  Total weights = 1.950112979e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8137e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800254279189
                                         uncertainty =       0.057702520035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800254279189
                                         uncertainty =       0.057702520035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378474119
  error estimate for blocks of size 2^( 2) =       0.001448866551
  error estimate for blocks of size 2^( 3) =       0.001512396610
  error estimate for blocks of size 2^( 4) =       0.001553377197
  error estimate for blocks of size 2^( 5) =       0.001579583747
  error estimate for blocks of size 2^( 6) =       0.001591085298
  error estimate for blocks of size 2^( 7) =       0.001600311604

      target function =                  N/A
              le_mean =     -22.326096812836
             les_mean =     502.201360405269
             stat err =       0.001581089461
             autocorr =       1.315575128765
              std dev =       1.949487986074
             le_variance =       3.800503407848


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232609681284e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+01, overlap shift 2.2204e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326096812041       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326097665225       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326097660576       residual = 5.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+01 is 2.161534e-05

solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326096812041       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326097026627       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326097025365       residual = 5.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+01 is 5.435662e-06

solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326096812041       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326096865769       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326096865447       residual = 5.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+02 is 1.360921e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097378 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9633e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_001                -6.963122e-01 3 1  ON 0
ci_002                -7.040983e-01 3 1  ON 1
ci_003                -6.187537e-02 3 1  ON 2
ci_004                -6.235908e-02 3 1  ON 3
ci_005                 4.604559e-02 3 1  ON 4
ci_006                 4.617502e-02 3 1  ON 5
ci_007                 3.180665e-02 3 1  ON 6
ci_008                 3.147060e-02 3 1  ON 7
ci_009                -2.501645e-02 3 1  ON 8
ci_010                -2.552122e-02 3 1  ON 9
ci_011                -2.289037e-02 3 1  ON 10
ci_012                -2.257676e-02 3 1  ON 11
ci_013                 2.000908e-02 3 1  ON 12
ci_014                 2.020360e-02 3 1  ON 13
ci_015                 1.969021e-02 3 1  ON 14
ci_016                 2.074240e-02 3 1  ON 15
ci_017                 1.537326e-02 3 1  ON 16
ci_018                 1.572880e-02 3 1  ON 17
ci_019                 1.063380e-02 3 1  ON 18
ci_020                 1.043777e-02 3 1  ON 19
ci_021                -9.781814e-03 3 1  ON 20
ci_022                -9.449228e-03 3 1  ON 21
ci_023                 8.749041e-03 3 1  ON 22
ci_024                 9.499024e-03 3 1  ON 23
ci_025                 7.137307e-03 3 1  ON 24
ci_026                 8.155090e-03 3 1  ON 25
ci_027                 7.922473e-03 3 1  ON 26
ci_028                 7.864879e-03 3 1  ON 27
ci_029                -7.652278e-03 3 1  ON 28
ci_030                -7.775970e-03 3 1  ON 29
ci_031                -7.191082e-03 3 1  ON 30
ci_032                -7.564180e-03 3 1  ON 31
ci_033                 6.845743e-03 3 1  ON 32
ci_034                 6.321088e-03 3 1  ON 33
ci_035                 6.420184e-03 3 1  ON 34
ci_036                 6.962167e-03 3 1  ON 35
ci_037                 6.514537e-03 3 1  ON 36
ci_038                 5.607178e-03 3 1  ON 37
ci_039                 5.914067e-03 3 1  ON 38
ci_040                 6.138578e-03 3 1  ON 39
ci_041                 5.429940e-03 3 1  ON 40
ci_042                 5.118973e-03 3 1  ON 41
ci_043                 5.095184e-03 3 1  ON 42
ci_044                 4.450089e-03 3 1  ON 43
ci_045                 5.131249e-03 3 1  ON 44
ci_046                 5.278270e-03 3 1  ON 45
ci_047                -3.976119e-03 3 1  ON 46
ci_048                -4.394544e-03 3 1  ON 47
ci_049                 4.057787e-03 3 1  ON 48
ci_050                 3.463634e-03 3 1  ON 49
ci_051                -3.069541e-03 3 1  ON 50
ci_052                -2.192349e-03 3 1  ON 51
ci_053                -2.743879e-03 3 1  ON 52
ci_054                -3.456148e-03 3 1  ON 53
ci_055                -1.943268e-03 3 1  ON 54
ci_056                -2.002354e-03 3 1  ON 55
ci_057                -1.789876e-03 3 1  ON 56
ci_058                -1.817812e-03 3 1  ON 57
ci_059                -1.897042e-03 3 1  ON 58
ci_060                -2.077391e-03 3 1  ON 59
ci_061                -1.838706e-03 3 1  ON 60
ci_062                -1.920317e-03 3 1  ON 61
ci_063                -1.940348e-03 3 1  ON 62
ci_064                -9.415947e-04 3 1  ON 63
ci_065                -1.762376e-03 3 1  ON 64
ci_066                -1.416105e-03 3 1  ON 65
ci_067                -1.979609e-03 3 1  ON 66
ci_068                -1.523487e-03 3 1  ON 67
ci_069                 1.144352e-03 3 1  ON 68
ci_070                 1.595593e-03 3 1  ON 69
ci_071                 1.603449e-05 3 1  ON 70
ci_072                -2.475975e-04 3 1  ON 71
ci_073                 1.366386e-03 3 1  ON 72
ci_074                 8.935351e-04 3 1  ON 73
ci_075                -1.334827e-03 3 1  ON 74
ci_076                -7.325514e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.3567
    reference variance = 3.04591
====================================================
  Execution time = 2.3407e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.6717e+00
  Total weights = 1.9499e+06
  Execution time = 4.4260e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722887351990
                                         uncertainty =       0.027079836717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722887351990
                                         uncertainty =       0.027079836717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364388489
  error estimate for blocks of size 2^( 2) =       0.001435007652
  error estimate for blocks of size 2^( 3) =       0.001498928262
  error estimate for blocks of size 2^( 4) =       0.001542114490
  error estimate for blocks of size 2^( 5) =       0.001569200383
  error estimate for blocks of size 2^( 6) =       0.001579625164
  error estimate for blocks of size 2^( 7) =       0.001583781837

      target function =                  N/A
              le_mean =     -22.330634165263
             les_mean =     502.328964994565
             stat err =       0.001568680468
             autocorr =       1.321882596567
              std dev =       1.929567578092
             le_variance =       3.723231038423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722883788551
                                         uncertainty =       0.027079706960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722883788551
                                         uncertainty =       0.027079706960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364387832
  error estimate for blocks of size 2^( 2) =       0.001435007239
  error estimate for blocks of size 2^( 3) =       0.001498928005
  error estimate for blocks of size 2^( 4) =       0.001542114535
  error estimate for blocks of size 2^( 5) =       0.001569200284
  error estimate for blocks of size 2^( 6) =       0.001579625581
  error estimate for blocks of size 2^( 7) =       0.001583782046

      target function =                  N/A
              le_mean =     -22.330634287433
             les_mean =     502.330966946247
             stat err =       0.001568680611
             autocorr =       1.321884110109
              std dev =       1.929566649283
             le_variance =       3.723227454025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722885550965
                                         uncertainty =       0.027079771544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722885550965
                                         uncertainty =       0.027079771544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364388157
  error estimate for blocks of size 2^( 2) =       0.001435007431
  error estimate for blocks of size 2^( 3) =       0.001498928131
  error estimate for blocks of size 2^( 4) =       0.001542114500
  error estimate for blocks of size 2^( 5) =       0.001569200327
  error estimate for blocks of size 2^( 6) =       0.001579625413
  error estimate for blocks of size 2^( 7) =       0.001583781928

      target function =                  N/A
              le_mean =     -22.330634243089
             les_mean =     502.328982290072
             stat err =       0.001568680542
             autocorr =       1.321883363583
              std dev =       1.929567108663
             le_variance =       3.723229226835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722887125612
                                         uncertainty =       0.027079828564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722887125612
                                         uncertainty =       0.027079828564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364388447
  error estimate for blocks of size 2^( 2) =       0.001435007624
  error estimate for blocks of size 2^( 3) =       0.001498928246
  error estimate for blocks of size 2^( 4) =       0.001542114491
  error estimate for blocks of size 2^( 5) =       0.001569200376
  error estimate for blocks of size 2^( 6) =       0.001579625195
  error estimate for blocks of size 2^( 7) =       0.001583781848

      target function =                  N/A
              le_mean =     -22.330634174751
             les_mean =     502.328965816065
             stat err =       0.001568680477
             autocorr =       1.321882692475
              std dev =       1.929567519088
             le_variance =       3.723230810721


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330634165263        initial
     2.2204e+01     2.2204e+02             2.1615e-05       -22.330634287433  <--
     8.8818e+01     8.8818e+02             5.4357e-06       -22.330634243089
     3.5527e+02     3.5527e+03             1.3609e-06       -22.330634174751

*****************************************************************************
Applying the update for shift_i =   2.2204e+01     and shift_s =   2.2204e+02
*****************************************************************************

  Execution time = 4.5355e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235918e-02 3 1  ON 3
ci_005                 4.604104e-02 3 1  ON 4
ci_006                 4.618044e-02 3 1  ON 5
ci_007                 3.181000e-02 3 1  ON 6
ci_008                 3.146443e-02 3 1  ON 7
ci_009                -2.501935e-02 3 1  ON 8
ci_010                -2.551343e-02 3 1  ON 9
ci_011                -2.288301e-02 3 1  ON 10
ci_012                -2.257818e-02 3 1  ON 11
ci_013                 2.000279e-02 3 1  ON 12
ci_014                 2.020242e-02 3 1  ON 13
ci_015                 1.969106e-02 3 1  ON 14
ci_016                 2.073098e-02 3 1  ON 15
ci_017                 1.537567e-02 3 1  ON 16
ci_018                 1.572866e-02 3 1  ON 17
ci_019                 1.062708e-02 3 1  ON 18
ci_020                 1.043537e-02 3 1  ON 19
ci_021                -9.779915e-03 3 1  ON 20
ci_022                -9.447456e-03 3 1  ON 21
ci_023                 8.746976e-03 3 1  ON 22
ci_024                 9.498960e-03 3 1  ON 23
ci_025                 7.144834e-03 3 1  ON 24
ci_026                 8.158160e-03 3 1  ON 25
ci_027                 7.925557e-03 3 1  ON 26
ci_028                 7.864933e-03 3 1  ON 27
ci_029                -7.652267e-03 3 1  ON 28
ci_030                -7.767109e-03 3 1  ON 29
ci_031                -7.191657e-03 3 1  ON 30
ci_032                -7.558418e-03 3 1  ON 31
ci_033                 6.847074e-03 3 1  ON 32
ci_034                 6.331512e-03 3 1  ON 33
ci_035                 6.423003e-03 3 1  ON 34
ci_036                 6.954160e-03 3 1  ON 35
ci_037                 6.517899e-03 3 1  ON 36
ci_038                 5.613356e-03 3 1  ON 37
ci_039                 5.905550e-03 3 1  ON 38
ci_040                 6.142644e-03 3 1  ON 39
ci_041                 5.432210e-03 3 1  ON 40
ci_042                 5.115177e-03 3 1  ON 41
ci_043                 5.093027e-03 3 1  ON 42
ci_044                 4.460267e-03 3 1  ON 43
ci_045                 5.122822e-03 3 1  ON 44
ci_046                 5.281263e-03 3 1  ON 45
ci_047                -3.976845e-03 3 1  ON 46
ci_048                -4.395232e-03 3 1  ON 47
ci_049                 4.051959e-03 3 1  ON 48
ci_050                 3.469208e-03 3 1  ON 49
ci_051                -3.068514e-03 3 1  ON 50
ci_052                -2.204918e-03 3 1  ON 51
ci_053                -2.742132e-03 3 1  ON 52
ci_054                -3.447172e-03 3 1  ON 53
ci_055                -1.934384e-03 3 1  ON 54
ci_056                -2.000569e-03 3 1  ON 55
ci_057                -1.788709e-03 3 1  ON 56
ci_058                -1.820430e-03 3 1  ON 57
ci_059                -1.892270e-03 3 1  ON 58
ci_060                -2.081107e-03 3 1  ON 59
ci_061                -1.839801e-03 3 1  ON 60
ci_062                -1.917182e-03 3 1  ON 61
ci_063                -1.942411e-03 3 1  ON 62
ci_064                -9.420798e-04 3 1  ON 63
ci_065                -1.763842e-03 3 1  ON 64
ci_066                -1.417161e-03 3 1  ON 65
ci_067                -1.965885e-03 3 1  ON 66
ci_068                -1.528180e-03 3 1  ON 67
ci_069                 1.160532e-03 3 1  ON 68
ci_070                 1.598078e-03 3 1  ON 69
ci_071                 1.931719e-05 3 1  ON 70
ci_072                -2.571815e-04 3 1  ON 71
ci_073                 1.367389e-03 3 1  ON 72
ci_074                 8.910926e-04 3 1  ON 73
ci_075                -1.334013e-03 3 1  ON 74
ci_076                -7.291620e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4994e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2295e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.4212
    reference variance = 2.75438
====================================================
  Execution time = 2.4080e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0269e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7412e+00
  Total weights = 1.949865847e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9143e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793634986243
                                         uncertainty =       0.039556143949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793634986243
                                         uncertainty =       0.039556143949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377103709
  error estimate for blocks of size 2^( 2) =       0.001448367804
  error estimate for blocks of size 2^( 3) =       0.001511169900
  error estimate for blocks of size 2^( 4) =       0.001555737687
  error estimate for blocks of size 2^( 5) =       0.001579902759
  error estimate for blocks of size 2^( 6) =       0.001591857529
  error estimate for blocks of size 2^( 7) =       0.001600264279

      target function =                  N/A
              le_mean =     -22.326168504947
             les_mean =     502.199026775137
             stat err =       0.001581940563
             autocorr =       1.319614346874
              std dev =       1.947549901601
             le_variance =       3.792950619226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232616850495e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+00, overlap shift 5.5511e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326168504093       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326173079312       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326173067184       residual = 3.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+00 is 8.500769e-05

solving harmonic davidson linear method for identity shift 2.2204e+01, overlap shift 2.2204e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326168504093       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326169675889       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326169673716       residual = 3.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+01 is 2.171226e-05

solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326168504093       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326168798845       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326168798368       residual = 3.10e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+01 is 5.457707e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098670 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0001e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_001                -6.963117e-01 3 1  ON 0
ci_002                -7.040997e-01 3 1  ON 1
ci_003                -6.188620e-02 3 1  ON 2
ci_004                -6.236262e-02 3 1  ON 3
ci_005                 4.603869e-02 3 1  ON 4
ci_006                 4.618722e-02 3 1  ON 5
ci_007                 3.180162e-02 3 1  ON 6
ci_008                 3.146050e-02 3 1  ON 7
ci_009                -2.501910e-02 3 1  ON 8
ci_010                -2.549705e-02 3 1  ON 9
ci_011                -2.286882e-02 3 1  ON 10
ci_012                -2.257941e-02 3 1  ON 11
ci_013                 2.000785e-02 3 1  ON 12
ci_014                 2.019843e-02 3 1  ON 13
ci_015                 1.969594e-02 3 1  ON 14
ci_016                 2.073236e-02 3 1  ON 15
ci_017                 1.538575e-02 3 1  ON 16
ci_018                 1.572653e-02 3 1  ON 17
ci_019                 1.060901e-02 3 1  ON 18
ci_020                 1.042555e-02 3 1  ON 19
ci_021                -9.788545e-03 3 1  ON 20
ci_022                -9.448495e-03 3 1  ON 21
ci_023                 8.746514e-03 3 1  ON 22
ci_024                 9.495339e-03 3 1  ON 23
ci_025                 7.150070e-03 3 1  ON 24
ci_026                 8.160806e-03 3 1  ON 25
ci_027                 7.928789e-03 3 1  ON 26
ci_028                 7.863068e-03 3 1  ON 27
ci_029                -7.655097e-03 3 1  ON 28
ci_030                -7.760270e-03 3 1  ON 29
ci_031                -7.207340e-03 3 1  ON 30
ci_032                -7.556249e-03 3 1  ON 31
ci_033                 6.851484e-03 3 1  ON 32
ci_034                 6.332202e-03 3 1  ON 33
ci_035                 6.428785e-03 3 1  ON 34
ci_036                 6.956276e-03 3 1  ON 35
ci_037                 6.520981e-03 3 1  ON 36
ci_038                 5.629351e-03 3 1  ON 37
ci_039                 5.909851e-03 3 1  ON 38
ci_040                 6.137026e-03 3 1  ON 39
ci_041                 5.432706e-03 3 1  ON 40
ci_042                 5.108411e-03 3 1  ON 41
ci_043                 5.092248e-03 3 1  ON 42
ci_044                 4.461014e-03 3 1  ON 43
ci_045                 5.101109e-03 3 1  ON 44
ci_046                 5.281144e-03 3 1  ON 45
ci_047                -3.964209e-03 3 1  ON 46
ci_048                -4.385367e-03 3 1  ON 47
ci_049                 4.052811e-03 3 1  ON 48
ci_050                 3.463853e-03 3 1  ON 49
ci_051                -3.072862e-03 3 1  ON 50
ci_052                -2.205149e-03 3 1  ON 51
ci_053                -2.762812e-03 3 1  ON 52
ci_054                -3.438501e-03 3 1  ON 53
ci_055                -1.934730e-03 3 1  ON 54
ci_056                -2.000848e-03 3 1  ON 55
ci_057                -1.794365e-03 3 1  ON 56
ci_058                -1.833419e-03 3 1  ON 57
ci_059                -1.897057e-03 3 1  ON 58
ci_060                -2.075806e-03 3 1  ON 59
ci_061                -1.823058e-03 3 1  ON 60
ci_062                -1.909827e-03 3 1  ON 61
ci_063                -1.942944e-03 3 1  ON 62
ci_064                -9.420081e-04 3 1  ON 63
ci_065                -1.745777e-03 3 1  ON 64
ci_066                -1.412402e-03 3 1  ON 65
ci_067                -1.959636e-03 3 1  ON 66
ci_068                -1.520030e-03 3 1  ON 67
ci_069                 1.161272e-03 3 1  ON 68
ci_070                 1.600127e-03 3 1  ON 69
ci_071                 1.230093e-05 3 1  ON 70
ci_072                -2.591934e-04 3 1  ON 71
ci_073                 1.351431e-03 3 1  ON 72
ci_074                 8.838724e-04 3 1  ON 73
ci_075                -1.331703e-03 3 1  ON 74
ci_076                -7.363183e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.395
    reference variance = 3.45654
====================================================
  Execution time = 2.3444e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.8208e+00
  Total weights = 1.9499e+06
  Execution time = 4.3493e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.871806812754
                                         uncertainty =       0.072330897381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.871806812754
                                         uncertainty =       0.072330897381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001391356075
  error estimate for blocks of size 2^( 2) =       0.001460740248
  error estimate for blocks of size 2^( 3) =       0.001523021494
  error estimate for blocks of size 2^( 4) =       0.001568500069
  error estimate for blocks of size 2^( 5) =       0.001593473992
  error estimate for blocks of size 2^( 6) =       0.001608293954
  error estimate for blocks of size 2^( 7) =       0.001618295709

      target function =                  N/A
              le_mean =     -22.326265828441
             les_mean =     502.282890752133
             stat err =       0.001597140931
             autocorr =       1.317679842220
              std dev =       1.967706114303
             le_variance =       3.871867352266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.871789843357
                                         uncertainty =       0.072331490394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.871789843357
                                         uncertainty =       0.072331490394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001391353019
  error estimate for blocks of size 2^( 2) =       0.001460737964
  error estimate for blocks of size 2^( 3) =       0.001523019179
  error estimate for blocks of size 2^( 4) =       0.001568499597
  error estimate for blocks of size 2^( 5) =       0.001593474488
  error estimate for blocks of size 2^( 6) =       0.001608295895
  error estimate for blocks of size 2^( 7) =       0.001618298815

      target function =                  N/A
              le_mean =     -22.326265328948
             les_mean =     502.285312148312
             stat err =       0.001597142199
             autocorr =       1.317687722464
              std dev =       1.967701792336
             le_variance =       3.871850343561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.871797995127
                                         uncertainty =       0.072331189192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.871797995127
                                         uncertainty =       0.072331189192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001391354487
  error estimate for blocks of size 2^( 2) =       0.001460739035
  error estimate for blocks of size 2^( 3) =       0.001523020249
  error estimate for blocks of size 2^( 4) =       0.001568499743
  error estimate for blocks of size 2^( 5) =       0.001593474056
  error estimate for blocks of size 2^( 6) =       0.001608294619
  error estimate for blocks of size 2^( 7) =       0.001618297071

      target function =                  N/A
              le_mean =     -22.326265494501
             les_mean =     502.283155631047
             stat err =       0.001597141372
             autocorr =       1.317683578300
              std dev =       1.967703868623
             le_variance =       3.871858514596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.871805687955
                                         uncertainty =       0.072330933313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.871805687955
                                         uncertainty =       0.072330933313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001391355873
  error estimate for blocks of size 2^( 2) =       0.001460740090
  error estimate for blocks of size 2^( 3) =       0.001523021331
  error estimate for blocks of size 2^( 4) =       0.001568500023
  error estimate for blocks of size 2^( 5) =       0.001593473998
  error estimate for blocks of size 2^( 6) =       0.001608294039
  error estimate for blocks of size 2^( 7) =       0.001618295880

      target function =                  N/A
              le_mean =     -22.326265784534
             les_mean =     502.282904214277
             stat err =       0.001597140985
             autocorr =       1.317680315172
              std dev =       1.967705827850
             le_variance =       3.871866224953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326265828441        initial  <--
     5.5511e+00     5.5511e+01             8.5008e-05       -22.326265328948
     2.2204e+01     2.2204e+02             2.1712e-05       -22.326265494501
     8.8818e+01     8.8818e+02             5.4577e-06       -22.326265784534

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.4979
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235918e-02 3 1  ON 3
ci_005                 4.604104e-02 3 1  ON 4
ci_006                 4.618044e-02 3 1  ON 5
ci_007                 3.181000e-02 3 1  ON 6
ci_008                 3.146443e-02 3 1  ON 7
ci_009                -2.501935e-02 3 1  ON 8
ci_010                -2.551343e-02 3 1  ON 9
ci_011                -2.288301e-02 3 1  ON 10
ci_012                -2.257818e-02 3 1  ON 11
ci_013                 2.000279e-02 3 1  ON 12
ci_014                 2.020242e-02 3 1  ON 13
ci_015                 1.969106e-02 3 1  ON 14
ci_016                 2.073098e-02 3 1  ON 15
ci_017                 1.537567e-02 3 1  ON 16
ci_018                 1.572866e-02 3 1  ON 17
ci_019                 1.062708e-02 3 1  ON 18
ci_020                 1.043537e-02 3 1  ON 19
ci_021                -9.779915e-03 3 1  ON 20
ci_022                -9.447456e-03 3 1  ON 21
ci_023                 8.746976e-03 3 1  ON 22
ci_024                 9.498960e-03 3 1  ON 23
ci_025                 7.144834e-03 3 1  ON 24
ci_026                 8.158160e-03 3 1  ON 25
ci_027                 7.925557e-03 3 1  ON 26
ci_028                 7.864933e-03 3 1  ON 27
ci_029                -7.652267e-03 3 1  ON 28
ci_030                -7.767109e-03 3 1  ON 29
ci_031                -7.191657e-03 3 1  ON 30
ci_032                -7.558418e-03 3 1  ON 31
ci_033                 6.847074e-03 3 1  ON 32
ci_034                 6.331512e-03 3 1  ON 33
ci_035                 6.423003e-03 3 1  ON 34
ci_036                 6.954160e-03 3 1  ON 35
ci_037                 6.517899e-03 3 1  ON 36
ci_038                 5.613356e-03 3 1  ON 37
ci_039                 5.905550e-03 3 1  ON 38
ci_040                 6.142644e-03 3 1  ON 39
ci_041                 5.432210e-03 3 1  ON 40
ci_042                 5.115177e-03 3 1  ON 41
ci_043                 5.093027e-03 3 1  ON 42
ci_044                 4.460267e-03 3 1  ON 43
ci_045                 5.122822e-03 3 1  ON 44
ci_046                 5.281263e-03 3 1  ON 45
ci_047                -3.976845e-03 3 1  ON 46
ci_048                -4.395232e-03 3 1  ON 47
ci_049                 4.051959e-03 3 1  ON 48
ci_050                 3.469208e-03 3 1  ON 49
ci_051                -3.068514e-03 3 1  ON 50
ci_052                -2.204918e-03 3 1  ON 51
ci_053                -2.742132e-03 3 1  ON 52
ci_054                -3.447172e-03 3 1  ON 53
ci_055                -1.934384e-03 3 1  ON 54
ci_056                -2.000569e-03 3 1  ON 55
ci_057                -1.788709e-03 3 1  ON 56
ci_058                -1.820430e-03 3 1  ON 57
ci_059                -1.892270e-03 3 1  ON 58
ci_060                -2.081107e-03 3 1  ON 59
ci_061                -1.839801e-03 3 1  ON 60
ci_062                -1.917182e-03 3 1  ON 61
ci_063                -1.942411e-03 3 1  ON 62
ci_064                -9.420798e-04 3 1  ON 63
ci_065                -1.763842e-03 3 1  ON 64
ci_066                -1.417161e-03 3 1  ON 65
ci_067                -1.965885e-03 3 1  ON 66
ci_068                -1.528180e-03 3 1  ON 67
ci_069                 1.160532e-03 3 1  ON 68
ci_070                 1.598078e-03 3 1  ON 69
ci_071                 1.931719e-05 3 1  ON 70
ci_072                -2.571815e-04 3 1  ON 71
ci_073                 1.367389e-03 3 1  ON 72
ci_074                 8.910926e-04 3 1  ON 73
ci_075                -1.334013e-03 3 1  ON 74
ci_076                -7.291620e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8507e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2297e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.6201
    reference variance = 4.24536
====================================================
  Execution time = 2.3971e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0257e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7131e+00
  Total weights = 1.949869911e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8737e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766361832490
                                         uncertainty =       0.042052946692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766361832490
                                         uncertainty =       0.042052946692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372217596
  error estimate for blocks of size 2^( 2) =       0.001442872226
  error estimate for blocks of size 2^( 3) =       0.001505554421
  error estimate for blocks of size 2^( 4) =       0.001546887213
  error estimate for blocks of size 2^( 5) =       0.001571259241
  error estimate for blocks of size 2^( 6) =       0.001580460459
  error estimate for blocks of size 2^( 7) =       0.001592835507

      target function =                  N/A
              le_mean =     -22.327655454972
             les_mean =     502.237289508703
             stat err =       0.001572860605
             autocorr =       1.313815865064
              std dev =       1.940639784170
             le_variance =       3.766082771905


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232765545497e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+01, overlap shift 5.5511e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327655454137       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327655804032       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327655806103       residual = 1.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+01 is 8.235842e-06

solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327655454137       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327655541847       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327655542380       residual = 2.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+02 is 2.063891e-06

solving harmonic davidson linear method for identity shift 8.8818e+02, overlap shift 8.8818e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327655454137       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327655476079       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327655476214       residual = 2.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+02 is 5.162819e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099928 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9852e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_001                -6.963141e-01 3 1  ON 0
ci_002                -7.040973e-01 3 1  ON 1
ci_003                -6.187569e-02 3 1  ON 2
ci_004                -6.235897e-02 3 1  ON 3
ci_005                 4.604212e-02 3 1  ON 4
ci_006                 4.618075e-02 3 1  ON 5
ci_007                 3.180957e-02 3 1  ON 6
ci_008                 3.146526e-02 3 1  ON 7
ci_009                -2.501897e-02 3 1  ON 8
ci_010                -2.551448e-02 3 1  ON 9
ci_011                -2.288260e-02 3 1  ON 10
ci_012                -2.257803e-02 3 1  ON 11
ci_013                 2.000258e-02 3 1  ON 12
ci_014                 2.020302e-02 3 1  ON 13
ci_015                 1.969157e-02 3 1  ON 14
ci_016                 2.073068e-02 3 1  ON 15
ci_017                 1.537648e-02 3 1  ON 16
ci_018                 1.572845e-02 3 1  ON 17
ci_019                 1.062604e-02 3 1  ON 18
ci_020                 1.043495e-02 3 1  ON 19
ci_021                -9.780368e-03 3 1  ON 20
ci_022                -9.447569e-03 3 1  ON 21
ci_023                 8.746686e-03 3 1  ON 22
ci_024                 9.497492e-03 3 1  ON 23
ci_025                 7.145249e-03 3 1  ON 24
ci_026                 8.158374e-03 3 1  ON 25
ci_027                 7.925527e-03 3 1  ON 26
ci_028                 7.865977e-03 3 1  ON 27
ci_029                -7.652374e-03 3 1  ON 28
ci_030                -7.767865e-03 3 1  ON 29
ci_031                -7.192436e-03 3 1  ON 30
ci_032                -7.558233e-03 3 1  ON 31
ci_033                 6.847324e-03 3 1  ON 32
ci_034                 6.331999e-03 3 1  ON 33
ci_035                 6.423767e-03 3 1  ON 34
ci_036                 6.953482e-03 3 1  ON 35
ci_037                 6.517861e-03 3 1  ON 36
ci_038                 5.613042e-03 3 1  ON 37
ci_039                 5.905253e-03 3 1  ON 38
ci_040                 6.141056e-03 3 1  ON 39
ci_041                 5.432188e-03 3 1  ON 40
ci_042                 5.116288e-03 3 1  ON 41
ci_043                 5.093596e-03 3 1  ON 42
ci_044                 4.460299e-03 3 1  ON 43
ci_045                 5.123093e-03 3 1  ON 44
ci_046                 5.281403e-03 3 1  ON 45
ci_047                -3.976364e-03 3 1  ON 46
ci_048                -4.396661e-03 3 1  ON 47
ci_049                 4.051953e-03 3 1  ON 48
ci_050                 3.469271e-03 3 1  ON 49
ci_051                -3.068073e-03 3 1  ON 50
ci_052                -2.203467e-03 3 1  ON 51
ci_053                -2.742377e-03 3 1  ON 52
ci_054                -3.445108e-03 3 1  ON 53
ci_055                -1.934472e-03 3 1  ON 54
ci_056                -1.999874e-03 3 1  ON 55
ci_057                -1.790380e-03 3 1  ON 56
ci_058                -1.821111e-03 3 1  ON 57
ci_059                -1.892686e-03 3 1  ON 58
ci_060                -2.079691e-03 3 1  ON 59
ci_061                -1.841179e-03 3 1  ON 60
ci_062                -1.916663e-03 3 1  ON 61
ci_063                -1.942398e-03 3 1  ON 62
ci_064                -9.422326e-04 3 1  ON 63
ci_065                -1.765517e-03 3 1  ON 64
ci_066                -1.416473e-03 3 1  ON 65
ci_067                -1.965184e-03 3 1  ON 66
ci_068                -1.528504e-03 3 1  ON 67
ci_069                 1.160578e-03 3 1  ON 68
ci_070                 1.598830e-03 3 1  ON 69
ci_071                 1.843266e-05 3 1  ON 70
ci_072                -2.583608e-04 3 1  ON 71
ci_073                 1.367385e-03 3 1  ON 72
ci_074                 8.919599e-04 3 1  ON 73
ci_075                -1.332673e-03 3 1  ON 74
ci_076                -7.299788e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.3093
    reference variance = 4.06818
====================================================
  Execution time = 2.3310e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.8238e+00
  Total weights = 1.9497e+06
  Execution time = 4.4038e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.879667404937
                                         uncertainty =       0.106582984389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.879667404937
                                         uncertainty =       0.106582984389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001392581211
  error estimate for blocks of size 2^( 2) =       0.001462292765
  error estimate for blocks of size 2^( 3) =       0.001524721598
  error estimate for blocks of size 2^( 4) =       0.001565853931
  error estimate for blocks of size 2^( 5) =       0.001588642427
  error estimate for blocks of size 2^( 6) =       0.001604201774
  error estimate for blocks of size 2^( 7) =       0.001615586971

      target function =                  N/A
              le_mean =     -22.329634807638
             les_mean =     502.436374076385
             stat err =       0.001593571276
             autocorr =       1.309489206390
              std dev =       1.969438746006
             le_variance =       3.878688974269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.879667848143
                                         uncertainty =       0.106583020763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.879667848143
                                         uncertainty =       0.106583020763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001392581290
  error estimate for blocks of size 2^( 2) =       0.001462292760
  error estimate for blocks of size 2^( 3) =       0.001524721422
  error estimate for blocks of size 2^( 4) =       0.001565853593
  error estimate for blocks of size 2^( 5) =       0.001588641947
  error estimate for blocks of size 2^( 6) =       0.001604201113
  error estimate for blocks of size 2^( 7) =       0.001615586384

      target function =                  N/A
              le_mean =     -22.329634776171
             les_mean =     502.436376172439
             stat err =       0.001593570759
             autocorr =       1.309488210149
              std dev =       1.969438856943
             le_variance =       3.878689411239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.879667625759
                                         uncertainty =       0.106583002631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.879667625759
                                         uncertainty =       0.106583002631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001392581250
  error estimate for blocks of size 2^( 2) =       0.001462292763
  error estimate for blocks of size 2^( 3) =       0.001524721510
  error estimate for blocks of size 2^( 4) =       0.001565853761
  error estimate for blocks of size 2^( 5) =       0.001588642187
  error estimate for blocks of size 2^( 6) =       0.001604201442
  error estimate for blocks of size 2^( 7) =       0.001615586677

      target function =                  N/A
              le_mean =     -22.329634791515
             les_mean =     502.436374759185
             stat err =       0.001593571017
             autocorr =       1.309488707381
              std dev =       1.969438801275
             le_variance =       3.878689191966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.879667432401
                                         uncertainty =       0.106582986670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.879667432401
                                         uncertainty =       0.106582986670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001392581216
  error estimate for blocks of size 2^( 2) =       0.001462292765
  error estimate for blocks of size 2^( 3) =       0.001524721587
  error estimate for blocks of size 2^( 4) =       0.001565853910
  error estimate for blocks of size 2^( 5) =       0.001588642397
  error estimate for blocks of size 2^( 6) =       0.001604201732
  error estimate for blocks of size 2^( 7) =       0.001615586934

      target function =                  N/A
              le_mean =     -22.329634805582
             les_mean =     502.436374122982
             stat err =       0.001593571243
             autocorr =       1.309489144014
              std dev =       1.969438752879
             le_variance =       3.878689001343


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329634807638        initial  <--
     5.5511e+01     5.5511e+02             8.2358e-06       -22.329634776171
     2.2204e+02     2.2204e+03             2.0639e-06       -22.329634791515
     8.8818e+02     8.8818e+03             5.1628e-07       -22.329634805582

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3701
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187509e-02 3 1  ON 2
ci_004                -6.235918e-02 3 1  ON 3
ci_005                 4.604104e-02 3 1  ON 4
ci_006                 4.618044e-02 3 1  ON 5
ci_007                 3.181000e-02 3 1  ON 6
ci_008                 3.146443e-02 3 1  ON 7
ci_009                -2.501935e-02 3 1  ON 8
ci_010                -2.551343e-02 3 1  ON 9
ci_011                -2.288301e-02 3 1  ON 10
ci_012                -2.257818e-02 3 1  ON 11
ci_013                 2.000279e-02 3 1  ON 12
ci_014                 2.020242e-02 3 1  ON 13
ci_015                 1.969106e-02 3 1  ON 14
ci_016                 2.073098e-02 3 1  ON 15
ci_017                 1.537567e-02 3 1  ON 16
ci_018                 1.572866e-02 3 1  ON 17
ci_019                 1.062708e-02 3 1  ON 18
ci_020                 1.043537e-02 3 1  ON 19
ci_021                -9.779915e-03 3 1  ON 20
ci_022                -9.447456e-03 3 1  ON 21
ci_023                 8.746976e-03 3 1  ON 22
ci_024                 9.498960e-03 3 1  ON 23
ci_025                 7.144834e-03 3 1  ON 24
ci_026                 8.158160e-03 3 1  ON 25
ci_027                 7.925557e-03 3 1  ON 26
ci_028                 7.864933e-03 3 1  ON 27
ci_029                -7.652267e-03 3 1  ON 28
ci_030                -7.767109e-03 3 1  ON 29
ci_031                -7.191657e-03 3 1  ON 30
ci_032                -7.558418e-03 3 1  ON 31
ci_033                 6.847074e-03 3 1  ON 32
ci_034                 6.331512e-03 3 1  ON 33
ci_035                 6.423003e-03 3 1  ON 34
ci_036                 6.954160e-03 3 1  ON 35
ci_037                 6.517899e-03 3 1  ON 36
ci_038                 5.613356e-03 3 1  ON 37
ci_039                 5.905550e-03 3 1  ON 38
ci_040                 6.142644e-03 3 1  ON 39
ci_041                 5.432210e-03 3 1  ON 40
ci_042                 5.115177e-03 3 1  ON 41
ci_043                 5.093027e-03 3 1  ON 42
ci_044                 4.460267e-03 3 1  ON 43
ci_045                 5.122822e-03 3 1  ON 44
ci_046                 5.281263e-03 3 1  ON 45
ci_047                -3.976845e-03 3 1  ON 46
ci_048                -4.395232e-03 3 1  ON 47
ci_049                 4.051959e-03 3 1  ON 48
ci_050                 3.469208e-03 3 1  ON 49
ci_051                -3.068514e-03 3 1  ON 50
ci_052                -2.204918e-03 3 1  ON 51
ci_053                -2.742132e-03 3 1  ON 52
ci_054                -3.447172e-03 3 1  ON 53
ci_055                -1.934384e-03 3 1  ON 54
ci_056                -2.000569e-03 3 1  ON 55
ci_057                -1.788709e-03 3 1  ON 56
ci_058                -1.820430e-03 3 1  ON 57
ci_059                -1.892270e-03 3 1  ON 58
ci_060                -2.081107e-03 3 1  ON 59
ci_061                -1.839801e-03 3 1  ON 60
ci_062                -1.917182e-03 3 1  ON 61
ci_063                -1.942411e-03 3 1  ON 62
ci_064                -9.420798e-04 3 1  ON 63
ci_065                -1.763842e-03 3 1  ON 64
ci_066                -1.417161e-03 3 1  ON 65
ci_067                -1.965885e-03 3 1  ON 66
ci_068                -1.528180e-03 3 1  ON 67
ci_069                 1.160532e-03 3 1  ON 68
ci_070                 1.598078e-03 3 1  ON 69
ci_071                 1.931719e-05 3 1  ON 70
ci_072                -2.571815e-04 3 1  ON 71
ci_073                 1.367389e-03 3 1  ON 72
ci_074                 8.910926e-04 3 1  ON 73
ci_075                -1.334013e-03 3 1  ON 74
ci_076                -7.291620e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5235e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2300e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.4071
    reference variance = 2.39952
====================================================
  Execution time = 2.3903e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0328e+04
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.6926e+00
  Total weights = 1.950147600e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9430e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.744259262430
                                         uncertainty =       0.034604586461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.744259262430
                                         uncertainty =       0.034604586461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368214862
  error estimate for blocks of size 2^( 2) =       0.001439010874
  error estimate for blocks of size 2^( 3) =       0.001502117648
  error estimate for blocks of size 2^( 4) =       0.001545661061
  error estimate for blocks of size 2^( 5) =       0.001571676171
  error estimate for blocks of size 2^( 6) =       0.001580343798
  error estimate for blocks of size 2^( 7) =       0.001585293610

      target function =                  N/A
              le_mean =     -22.331353918640
             les_mean =     502.381922857244
             stat err =       0.001570743660
             autocorr =       1.317959376336
              std dev =       1.934978972402
             le_variance =       3.744143623640


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233135391864e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+02, overlap shift 5.5511e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.331353917824       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.331353952728       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.331353952666       residual = 3.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+02 is 8.786840e-07

solving harmonic davidson linear method for identity shift 2.2204e+03, overlap shift 2.2204e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.331353917824       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.331353926552       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.331353926537       residual = 3.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+03 is 2.197239e-07

solving harmonic davidson linear method for identity shift 8.8818e+03, overlap shift 8.8818e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.331353917824       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.331353920006       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.331353920002       residual = 3.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+03 is 5.493427e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101094 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9853e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040967e-01 3 1  ON 1
ci_003                -6.187507e-02 3 1  ON 2
ci_004                -6.235927e-02 3 1  ON 3
ci_005                 4.604112e-02 3 1  ON 4
ci_006                 4.618042e-02 3 1  ON 5
ci_007                 3.181015e-02 3 1  ON 6
ci_008                 3.146447e-02 3 1  ON 7
ci_009                -2.501937e-02 3 1  ON 8
ci_010                -2.551346e-02 3 1  ON 9
ci_011                -2.288305e-02 3 1  ON 10
ci_012                -2.257815e-02 3 1  ON 11
ci_013                 2.000274e-02 3 1  ON 12
ci_014                 2.020249e-02 3 1  ON 13
ci_015                 1.969115e-02 3 1  ON 14
ci_016                 2.073105e-02 3 1  ON 15
ci_017                 1.537568e-02 3 1  ON 16
ci_018                 1.572864e-02 3 1  ON 17
ci_019                 1.062706e-02 3 1  ON 18
ci_020                 1.043531e-02 3 1  ON 19
ci_021                -9.779973e-03 3 1  ON 20
ci_022                -9.447583e-03 3 1  ON 21
ci_023                 8.747005e-03 3 1  ON 22
ci_024                 9.498872e-03 3 1  ON 23
ci_025                 7.145008e-03 3 1  ON 24
ci_026                 8.158124e-03 3 1  ON 25
ci_027                 7.925519e-03 3 1  ON 26
ci_028                 7.864976e-03 3 1  ON 27
ci_029                -7.652190e-03 3 1  ON 28
ci_030                -7.767243e-03 3 1  ON 29
ci_031                -7.191607e-03 3 1  ON 30
ci_032                -7.558464e-03 3 1  ON 31
ci_033                 6.847042e-03 3 1  ON 32
ci_034                 6.331608e-03 3 1  ON 33
ci_035                 6.422926e-03 3 1  ON 34
ci_036                 6.953976e-03 3 1  ON 35
ci_037                 6.517894e-03 3 1  ON 36
ci_038                 5.613576e-03 3 1  ON 37
ci_039                 5.905511e-03 3 1  ON 38
ci_040                 6.142557e-03 3 1  ON 39
ci_041                 5.432218e-03 3 1  ON 40
ci_042                 5.115211e-03 3 1  ON 41
ci_043                 5.093053e-03 3 1  ON 42
ci_044                 4.460218e-03 3 1  ON 43
ci_045                 5.122804e-03 3 1  ON 44
ci_046                 5.281145e-03 3 1  ON 45
ci_047                -3.976892e-03 3 1  ON 46
ci_048                -4.395193e-03 3 1  ON 47
ci_049                 4.051892e-03 3 1  ON 48
ci_050                 3.469271e-03 3 1  ON 49
ci_051                -3.068512e-03 3 1  ON 50
ci_052                -2.204940e-03 3 1  ON 51
ci_053                -2.742090e-03 3 1  ON 52
ci_054                -3.447046e-03 3 1  ON 53
ci_055                -1.934297e-03 3 1  ON 54
ci_056                -2.000613e-03 3 1  ON 55
ci_057                -1.788574e-03 3 1  ON 56
ci_058                -1.820489e-03 3 1  ON 57
ci_059                -1.892231e-03 3 1  ON 58
ci_060                -2.081092e-03 3 1  ON 59
ci_061                -1.839839e-03 3 1  ON 60
ci_062                -1.917162e-03 3 1  ON 61
ci_063                -1.942403e-03 3 1  ON 62
ci_064                -9.420125e-04 3 1  ON 63
ci_065                -1.763761e-03 3 1  ON 64
ci_066                -1.417207e-03 3 1  ON 65
ci_067                -1.965784e-03 3 1  ON 66
ci_068                -1.528180e-03 3 1  ON 67
ci_069                 1.160617e-03 3 1  ON 68
ci_070                 1.598051e-03 3 1  ON 69
ci_071                 1.926112e-05 3 1  ON 70
ci_072                -2.572751e-04 3 1  ON 71
ci_073                 1.367204e-03 3 1  ON 72
ci_074                 8.911418e-04 3 1  ON 73
ci_075                -1.333990e-03 3 1  ON 74
ci_076                -7.291526e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.6463
    reference variance = 2.51198
====================================================
  Execution time = 2.3353e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7988e+00
  Total weights = 1.9497e+06
  Execution time = 4.3788e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.851530056815
                                         uncertainty =       0.076609996420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.851530056815
                                         uncertainty =       0.076609996420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387565651
  error estimate for blocks of size 2^( 2) =       0.001458080143
  error estimate for blocks of size 2^( 3) =       0.001521997897
  error estimate for blocks of size 2^( 4) =       0.001562705895
  error estimate for blocks of size 2^( 5) =       0.001590737985
  error estimate for blocks of size 2^( 6) =       0.001598510157
  error estimate for blocks of size 2^( 7) =       0.001599800812

      target function =                  N/A
              le_mean =     -22.328249999235
             les_mean =     502.349564938579
             stat err =       0.001587938712
             autocorr =       1.309665514296
              std dev =       1.962345559639
             le_variance =       3.850800095434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.851530216082
                                         uncertainty =       0.076610019281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.851530216082
                                         uncertainty =       0.076610019281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387565680
  error estimate for blocks of size 2^( 2) =       0.001458080158
  error estimate for blocks of size 2^( 3) =       0.001521997894
  error estimate for blocks of size 2^( 4) =       0.001562705888
  error estimate for blocks of size 2^( 5) =       0.001590737985
  error estimate for blocks of size 2^( 6) =       0.001598510153
  error estimate for blocks of size 2^( 7) =       0.001599800771

      target function =                  N/A
              le_mean =     -22.328250005702
             les_mean =     502.349564724420
             stat err =       0.001587938699
             autocorr =       1.309665438143
              std dev =       1.962345600401
             le_variance =       3.850800255411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.851530136456
                                         uncertainty =       0.076610007853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.851530136456
                                         uncertainty =       0.076610007853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387565666
  error estimate for blocks of size 2^( 2) =       0.001458080150
  error estimate for blocks of size 2^( 3) =       0.001521997896
  error estimate for blocks of size 2^( 4) =       0.001562705892
  error estimate for blocks of size 2^( 5) =       0.001590737985
  error estimate for blocks of size 2^( 6) =       0.001598510155
  error estimate for blocks of size 2^( 7) =       0.001599800791

      target function =                  N/A
              le_mean =     -22.328250002467
             les_mean =     502.349564829260
             stat err =       0.001587938706
             autocorr =       1.309665476209
              std dev =       1.962345580022
             le_variance =       3.850800175430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.851530066769
                                         uncertainty =       0.076609997849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.851530066769
                                         uncertainty =       0.076609997849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387565653
  error estimate for blocks of size 2^( 2) =       0.001458080144
  error estimate for blocks of size 2^( 3) =       0.001521997897
  error estimate for blocks of size 2^( 4) =       0.001562705895
  error estimate for blocks of size 2^( 5) =       0.001590737985
  error estimate for blocks of size 2^( 6) =       0.001598510157
  error estimate for blocks of size 2^( 7) =       0.001599800809

      target function =                  N/A
              le_mean =     -22.328249999639
             les_mean =     502.349564924666
             stat err =       0.001587938712
             autocorr =       1.309665509535
              std dev =       1.962345562186
             le_variance =       3.850800105433


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328249999235        initial
     5.5511e+02     5.5511e+03             8.7868e-07       -22.328250005702  <--
     2.2204e+03     2.2204e+04             2.1972e-07       -22.328250002467
     8.8818e+03     8.8818e+04             5.4934e-08       -22.328249999639

*****************************************************************************
Applying the update for shift_i =   5.5511e+02     and shift_s =   5.5511e+03
*****************************************************************************

  Execution time = 4.5364e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235953e-02 3 1  ON 3
ci_005                 4.604136e-02 3 1  ON 4
ci_006                 4.618035e-02 3 1  ON 5
ci_007                 3.181058e-02 3 1  ON 6
ci_008                 3.146458e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551354e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062703e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780147e-03 3 1  ON 20
ci_022                -9.447963e-03 3 1  ON 21
ci_023                 8.747093e-03 3 1  ON 22
ci_024                 9.498609e-03 3 1  ON 23
ci_025                 7.145530e-03 3 1  ON 24
ci_026                 8.158013e-03 3 1  ON 25
ci_027                 7.925404e-03 3 1  ON 26
ci_028                 7.865106e-03 3 1  ON 27
ci_029                -7.651961e-03 3 1  ON 28
ci_030                -7.767645e-03 3 1  ON 29
ci_031                -7.191456e-03 3 1  ON 30
ci_032                -7.558603e-03 3 1  ON 31
ci_033                 6.846948e-03 3 1  ON 32
ci_034                 6.331895e-03 3 1  ON 33
ci_035                 6.422694e-03 3 1  ON 34
ci_036                 6.953426e-03 3 1  ON 35
ci_037                 6.517879e-03 3 1  ON 36
ci_038                 5.614235e-03 3 1  ON 37
ci_039                 5.905394e-03 3 1  ON 38
ci_040                 6.142298e-03 3 1  ON 39
ci_041                 5.432239e-03 3 1  ON 40
ci_042                 5.115313e-03 3 1  ON 41
ci_043                 5.093132e-03 3 1  ON 42
ci_044                 4.460070e-03 3 1  ON 43
ci_045                 5.122752e-03 3 1  ON 44
ci_046                 5.280793e-03 3 1  ON 45
ci_047                -3.977033e-03 3 1  ON 46
ci_048                -4.395075e-03 3 1  ON 47
ci_049                 4.051691e-03 3 1  ON 48
ci_050                 3.469462e-03 3 1  ON 49
ci_051                -3.068505e-03 3 1  ON 50
ci_052                -2.205008e-03 3 1  ON 51
ci_053                -2.741966e-03 3 1  ON 52
ci_054                -3.446667e-03 3 1  ON 53
ci_055                -1.934038e-03 3 1  ON 54
ci_056                -2.000746e-03 3 1  ON 55
ci_057                -1.788169e-03 3 1  ON 56
ci_058                -1.820667e-03 3 1  ON 57
ci_059                -1.892114e-03 3 1  ON 58
ci_060                -2.081045e-03 3 1  ON 59
ci_061                -1.839953e-03 3 1  ON 60
ci_062                -1.917103e-03 3 1  ON 61
ci_063                -1.942378e-03 3 1  ON 62
ci_064                -9.418106e-04 3 1  ON 63
ci_065                -1.763519e-03 3 1  ON 64
ci_066                -1.417346e-03 3 1  ON 65
ci_067                -1.965480e-03 3 1  ON 66
ci_068                -1.528181e-03 3 1  ON 67
ci_069                 1.160873e-03 3 1  ON 68
ci_070                 1.597969e-03 3 1  ON 69
ci_071                 1.909295e-05 3 1  ON 70
ci_072                -2.575558e-04 3 1  ON 71
ci_073                 1.366647e-03 3 1  ON 72
ci_074                 8.912892e-04 3 1  ON 73
ci_075                -1.333921e-03 3 1  ON 74
ci_076                -7.291241e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5226e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2305e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.2561
    reference variance = 6.16206
====================================================
  Execution time = 2.3877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0298e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.6964e+00
  Total weights = 1.950486152e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8584e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747559837740
                                         uncertainty =       0.030567026956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747559837740
                                         uncertainty =       0.030567026956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368756422
  error estimate for blocks of size 2^( 2) =       0.001439684860
  error estimate for blocks of size 2^( 3) =       0.001500875706
  error estimate for blocks of size 2^( 4) =       0.001544720149
  error estimate for blocks of size 2^( 5) =       0.001567154518
  error estimate for blocks of size 2^( 6) =       0.001581135295
  error estimate for blocks of size 2^( 7) =       0.001587301620

      target function =                  N/A
              le_mean =     -22.326092564957
             les_mean =     502.150767062123
             stat err =       0.001570077895
             autocorr =       1.315800536923
              std dev =       1.935744866079
             le_variance =       3.747108186551


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232609256496e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+02, overlap shift 1.3878e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326092564151       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326092747081       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326092747665       residual = 2.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+02 is 3.060168e-06

solving harmonic davidson linear method for identity shift 5.5511e+02, overlap shift 5.5511e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326092564151       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326092609931       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326092610077       residual = 2.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+02 is 7.658164e-07

solving harmonic davidson linear method for identity shift 2.2204e+03, overlap shift 2.2204e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326092564151       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326092575599       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326092575636       residual = 2.13e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+03 is 1.915026e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102297 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9742e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_001                -6.963151e-01 3 1  ON 0
ci_002                -7.040963e-01 3 1  ON 1
ci_003                -6.187527e-02 3 1  ON 2
ci_004                -6.235973e-02 3 1  ON 3
ci_005                 4.604105e-02 3 1  ON 4
ci_006                 4.618021e-02 3 1  ON 5
ci_007                 3.181073e-02 3 1  ON 6
ci_008                 3.146433e-02 3 1  ON 7
ci_009                -2.501935e-02 3 1  ON 8
ci_010                -2.551312e-02 3 1  ON 9
ci_011                -2.288295e-02 3 1  ON 10
ci_012                -2.257860e-02 3 1  ON 11
ci_013                 2.000290e-02 3 1  ON 12
ci_014                 2.020276e-02 3 1  ON 13
ci_015                 1.969170e-02 3 1  ON 14
ci_016                 2.073138e-02 3 1  ON 15
ci_017                 1.537620e-02 3 1  ON 16
ci_018                 1.572821e-02 3 1  ON 17
ci_019                 1.062675e-02 3 1  ON 18
ci_020                 1.043515e-02 3 1  ON 19
ci_021                -9.780284e-03 3 1  ON 20
ci_022                -9.448086e-03 3 1  ON 21
ci_023                 8.746902e-03 3 1  ON 22
ci_024                 9.498246e-03 3 1  ON 23
ci_025                 7.145871e-03 3 1  ON 24
ci_026                 8.157921e-03 3 1  ON 25
ci_027                 7.925436e-03 3 1  ON 26
ci_028                 7.865515e-03 3 1  ON 27
ci_029                -7.652256e-03 3 1  ON 28
ci_030                -7.767379e-03 3 1  ON 29
ci_031                -7.191526e-03 3 1  ON 30
ci_032                -7.558482e-03 3 1  ON 31
ci_033                 6.846843e-03 3 1  ON 32
ci_034                 6.331981e-03 3 1  ON 33
ci_035                 6.422584e-03 3 1  ON 34
ci_036                 6.952899e-03 3 1  ON 35
ci_037                 6.518181e-03 3 1  ON 36
ci_038                 5.614022e-03 3 1  ON 37
ci_039                 5.905262e-03 3 1  ON 38
ci_040                 6.141794e-03 3 1  ON 39
ci_041                 5.431944e-03 3 1  ON 40
ci_042                 5.115166e-03 3 1  ON 41
ci_043                 5.092893e-03 3 1  ON 42
ci_044                 4.459911e-03 3 1  ON 43
ci_045                 5.122503e-03 3 1  ON 44
ci_046                 5.280448e-03 3 1  ON 45
ci_047                -3.977532e-03 3 1  ON 46
ci_048                -4.394889e-03 3 1  ON 47
ci_049                 4.051023e-03 3 1  ON 48
ci_050                 3.469527e-03 3 1  ON 49
ci_051                -3.068887e-03 3 1  ON 50
ci_052                -2.205773e-03 3 1  ON 51
ci_053                -2.741567e-03 3 1  ON 52
ci_054                -3.446055e-03 3 1  ON 53
ci_055                -1.934555e-03 3 1  ON 54
ci_056                -2.001167e-03 3 1  ON 55
ci_057                -1.788186e-03 3 1  ON 56
ci_058                -1.820623e-03 3 1  ON 57
ci_059                -1.891959e-03 3 1  ON 58
ci_060                -2.080543e-03 3 1  ON 59
ci_061                -1.840010e-03 3 1  ON 60
ci_062                -1.917191e-03 3 1  ON 61
ci_063                -1.941893e-03 3 1  ON 62
ci_064                -9.420573e-04 3 1  ON 63
ci_065                -1.763531e-03 3 1  ON 64
ci_066                -1.417443e-03 3 1  ON 65
ci_067                -1.965346e-03 3 1  ON 66
ci_068                -1.528188e-03 3 1  ON 67
ci_069                 1.160909e-03 3 1  ON 68
ci_070                 1.597702e-03 3 1  ON 69
ci_071                 1.851761e-05 3 1  ON 70
ci_072                -2.579198e-04 3 1  ON 71
ci_073                 1.366285e-03 3 1  ON 72
ci_074                 8.914365e-04 3 1  ON 73
ci_075                -1.333922e-03 3 1  ON 74
ci_076                -7.289937e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.1986
    reference variance = 3.333
====================================================
  Execution time = 2.3354e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7729e+00
  Total weights = 1.9497e+06
  Execution time = 4.3946e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823506703691
                                         uncertainty =       0.042629838877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823506703691
                                         uncertainty =       0.042629838877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382494307
  error estimate for blocks of size 2^( 2) =       0.001451803370
  error estimate for blocks of size 2^( 3) =       0.001514733401
  error estimate for blocks of size 2^( 4) =       0.001556583152
  error estimate for blocks of size 2^( 5) =       0.001579490868
  error estimate for blocks of size 2^( 6) =       0.001585497572
  error estimate for blocks of size 2^( 7) =       0.001605026114

      target function =                  N/A
              le_mean =     -22.327405048455
             les_mean =     502.285906530391
             stat err =       0.001581649426
             autocorr =       1.308861680987
              std dev =       1.955173480780
             le_variance =       3.822703339946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823500553990
                                         uncertainty =       0.042629513450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823500553990
                                         uncertainty =       0.042629513450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382493192
  error estimate for blocks of size 2^( 2) =       0.001451802347
  error estimate for blocks of size 2^( 3) =       0.001514732495
  error estimate for blocks of size 2^( 4) =       0.001556582313
  error estimate for blocks of size 2^( 5) =       0.001579490141
  error estimate for blocks of size 2^( 6) =       0.001585496686
  error estimate for blocks of size 2^( 7) =       0.001605025092

      target function =                  N/A
              le_mean =     -22.327404960192
             les_mean =     502.285879035445
             stat err =       0.001581648558
             autocorr =       1.308862355626
              std dev =       1.955171903486
             le_variance =       3.822697172183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823503619347
                                         uncertainty =       0.042629675556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823503619347
                                         uncertainty =       0.042629675556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382493748
  error estimate for blocks of size 2^( 2) =       0.001451802857
  error estimate for blocks of size 2^( 3) =       0.001514732947
  error estimate for blocks of size 2^( 4) =       0.001556582731
  error estimate for blocks of size 2^( 5) =       0.001579490503
  error estimate for blocks of size 2^( 6) =       0.001585497128
  error estimate for blocks of size 2^( 7) =       0.001605025602

      target function =                  N/A
              le_mean =     -22.327405004180
             les_mean =     502.285892704797
             stat err =       0.001581648991
             autocorr =       1.308862019342
              std dev =       1.955172689702
             le_variance =       3.822700246555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823506317433
                                         uncertainty =       0.042629818412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823506317433
                                         uncertainty =       0.042629818412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382494237
  error estimate for blocks of size 2^( 2) =       0.001451803305
  error estimate for blocks of size 2^( 3) =       0.001514733344
  error estimate for blocks of size 2^( 4) =       0.001556583099
  error estimate for blocks of size 2^( 5) =       0.001579490822
  error estimate for blocks of size 2^( 6) =       0.001585497516
  error estimate for blocks of size 2^( 7) =       0.001605026050

      target function =                  N/A
              le_mean =     -22.327405042910
             les_mean =     502.285904795191
             stat err =       0.001581649372
             autocorr =       1.308861723358
              std dev =       1.955173381712
             le_variance =       3.822702952557


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327405048455        initial  <--
     1.3878e+02     1.3878e+03             3.0602e-06       -22.327404960192
     5.5511e+02     5.5511e+03             7.6582e-07       -22.327405004180
     2.2204e+03     2.2204e+04             1.9150e-07       -22.327405042910

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4353
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235953e-02 3 1  ON 3
ci_005                 4.604136e-02 3 1  ON 4
ci_006                 4.618035e-02 3 1  ON 5
ci_007                 3.181058e-02 3 1  ON 6
ci_008                 3.146458e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551354e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062703e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780147e-03 3 1  ON 20
ci_022                -9.447963e-03 3 1  ON 21
ci_023                 8.747093e-03 3 1  ON 22
ci_024                 9.498609e-03 3 1  ON 23
ci_025                 7.145530e-03 3 1  ON 24
ci_026                 8.158013e-03 3 1  ON 25
ci_027                 7.925404e-03 3 1  ON 26
ci_028                 7.865106e-03 3 1  ON 27
ci_029                -7.651961e-03 3 1  ON 28
ci_030                -7.767645e-03 3 1  ON 29
ci_031                -7.191456e-03 3 1  ON 30
ci_032                -7.558603e-03 3 1  ON 31
ci_033                 6.846948e-03 3 1  ON 32
ci_034                 6.331895e-03 3 1  ON 33
ci_035                 6.422694e-03 3 1  ON 34
ci_036                 6.953426e-03 3 1  ON 35
ci_037                 6.517879e-03 3 1  ON 36
ci_038                 5.614235e-03 3 1  ON 37
ci_039                 5.905394e-03 3 1  ON 38
ci_040                 6.142298e-03 3 1  ON 39
ci_041                 5.432239e-03 3 1  ON 40
ci_042                 5.115313e-03 3 1  ON 41
ci_043                 5.093132e-03 3 1  ON 42
ci_044                 4.460070e-03 3 1  ON 43
ci_045                 5.122752e-03 3 1  ON 44
ci_046                 5.280793e-03 3 1  ON 45
ci_047                -3.977033e-03 3 1  ON 46
ci_048                -4.395075e-03 3 1  ON 47
ci_049                 4.051691e-03 3 1  ON 48
ci_050                 3.469462e-03 3 1  ON 49
ci_051                -3.068505e-03 3 1  ON 50
ci_052                -2.205008e-03 3 1  ON 51
ci_053                -2.741966e-03 3 1  ON 52
ci_054                -3.446667e-03 3 1  ON 53
ci_055                -1.934038e-03 3 1  ON 54
ci_056                -2.000746e-03 3 1  ON 55
ci_057                -1.788169e-03 3 1  ON 56
ci_058                -1.820667e-03 3 1  ON 57
ci_059                -1.892114e-03 3 1  ON 58
ci_060                -2.081045e-03 3 1  ON 59
ci_061                -1.839953e-03 3 1  ON 60
ci_062                -1.917103e-03 3 1  ON 61
ci_063                -1.942378e-03 3 1  ON 62
ci_064                -9.418106e-04 3 1  ON 63
ci_065                -1.763519e-03 3 1  ON 64
ci_066                -1.417346e-03 3 1  ON 65
ci_067                -1.965480e-03 3 1  ON 66
ci_068                -1.528181e-03 3 1  ON 67
ci_069                 1.160873e-03 3 1  ON 68
ci_070                 1.597969e-03 3 1  ON 69
ci_071                 1.909295e-05 3 1  ON 70
ci_072                -2.575558e-04 3 1  ON 71
ci_073                 1.366647e-03 3 1  ON 72
ci_074                 8.912892e-04 3 1  ON 73
ci_075                -1.333921e-03 3 1  ON 74
ci_076                -7.291241e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5184e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2303e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.3645
    reference variance = 2.77232
====================================================
  Execution time = 2.3832e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0315e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6292e+00
  Total weights = 1.949959381e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9148e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.680387340004
                                         uncertainty =       0.019161660021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.680387340004
                                         uncertainty =       0.019161660021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001356396979
  error estimate for blocks of size 2^( 2) =       0.001428890640
  error estimate for blocks of size 2^( 3) =       0.001493579892
  error estimate for blocks of size 2^( 4) =       0.001538291035
  error estimate for blocks of size 2^( 5) =       0.001564925366
  error estimate for blocks of size 2^( 6) =       0.001579334278
  error estimate for blocks of size 2^( 7) =       0.001592245954

      target function =                  N/A
              le_mean =     -22.330091404954
             les_mean =     502.262182107270
             stat err =       0.001568699158
             autocorr =       1.337536676198
              std dev =       1.918265694691
             le_variance =       3.679743275429


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233009140495e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+03, overlap shift 1.3878e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330091404149       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330091418258       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330091418370       residual = 3.36e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+03 is 3.338812e-07

solving harmonic davidson linear method for identity shift 5.5511e+03, overlap shift 5.5511e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330091404149       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330091407677       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330091407705       residual = 3.36e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+03 is 8.347703e-08

solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330091404149       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330091405031       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330091405038       residual = 3.36e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+04 is 2.086968e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103473 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9757e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187502e-02 3 1  ON 2
ci_004                -6.235950e-02 3 1  ON 3
ci_005                 4.604130e-02 3 1  ON 4
ci_006                 4.618037e-02 3 1  ON 5
ci_007                 3.181061e-02 3 1  ON 6
ci_008                 3.146454e-02 3 1  ON 7
ci_009                -2.501938e-02 3 1  ON 8
ci_010                -2.551355e-02 3 1  ON 9
ci_011                -2.288314e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000260e-02 3 1  ON 12
ci_014                 2.020268e-02 3 1  ON 13
ci_015                 1.969146e-02 3 1  ON 14
ci_016                 2.073131e-02 3 1  ON 15
ci_017                 1.537575e-02 3 1  ON 16
ci_018                 1.572861e-02 3 1  ON 17
ci_019                 1.062700e-02 3 1  ON 18
ci_020                 1.043511e-02 3 1  ON 19
ci_021                -9.780147e-03 3 1  ON 20
ci_022                -9.448046e-03 3 1  ON 21
ci_023                 8.747114e-03 3 1  ON 22
ci_024                 9.498589e-03 3 1  ON 23
ci_025                 7.145585e-03 3 1  ON 24
ci_026                 8.158039e-03 3 1  ON 25
ci_027                 7.925409e-03 3 1  ON 26
ci_028                 7.865133e-03 3 1  ON 27
ci_029                -7.651950e-03 3 1  ON 28
ci_030                -7.767707e-03 3 1  ON 29
ci_031                -7.191459e-03 3 1  ON 30
ci_032                -7.558659e-03 3 1  ON 31
ci_033                 6.846938e-03 3 1  ON 32
ci_034                 6.331904e-03 3 1  ON 33
ci_035                 6.422722e-03 3 1  ON 34
ci_036                 6.953388e-03 3 1  ON 35
ci_037                 6.517873e-03 3 1  ON 36
ci_038                 5.614290e-03 3 1  ON 37
ci_039                 5.905391e-03 3 1  ON 38
ci_040                 6.142264e-03 3 1  ON 39
ci_041                 5.432225e-03 3 1  ON 40
ci_042                 5.115331e-03 3 1  ON 41
ci_043                 5.093114e-03 3 1  ON 42
ci_044                 4.460048e-03 3 1  ON 43
ci_045                 5.122754e-03 3 1  ON 44
ci_046                 5.280784e-03 3 1  ON 45
ci_047                -3.977017e-03 3 1  ON 46
ci_048                -4.395071e-03 3 1  ON 47
ci_049                 4.051668e-03 3 1  ON 48
ci_050                 3.469484e-03 3 1  ON 49
ci_051                -3.068478e-03 3 1  ON 50
ci_052                -2.204997e-03 3 1  ON 51
ci_053                -2.741948e-03 3 1  ON 52
ci_054                -3.446654e-03 3 1  ON 53
ci_055                -1.934018e-03 3 1  ON 54
ci_056                -2.000771e-03 3 1  ON 55
ci_057                -1.788182e-03 3 1  ON 56
ci_058                -1.820657e-03 3 1  ON 57
ci_059                -1.892107e-03 3 1  ON 58
ci_060                -2.081010e-03 3 1  ON 59
ci_061                -1.839970e-03 3 1  ON 60
ci_062                -1.917093e-03 3 1  ON 61
ci_063                -1.942355e-03 3 1  ON 62
ci_064                -9.417987e-04 3 1  ON 63
ci_065                -1.763491e-03 3 1  ON 64
ci_066                -1.417351e-03 3 1  ON 65
ci_067                -1.965457e-03 3 1  ON 66
ci_068                -1.528190e-03 3 1  ON 67
ci_069                 1.160891e-03 3 1  ON 68
ci_070                 1.598012e-03 3 1  ON 69
ci_071                 1.903761e-05 3 1  ON 70
ci_072                -2.575546e-04 3 1  ON 71
ci_073                 1.366681e-03 3 1  ON 72
ci_074                 8.912548e-04 3 1  ON 73
ci_075                -1.333884e-03 3 1  ON 74
ci_076                -7.291548e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -21.8117
    reference variance = 4.13038
====================================================
  Execution time = 2.3465e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.6943e+00
  Total weights = 1.9496e+06
  Execution time = 4.3879e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.744819013040
                                         uncertainty =       0.031111657369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.744819013040
                                         uncertainty =       0.031111657369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368363673
  error estimate for blocks of size 2^( 2) =       0.001439731868
  error estimate for blocks of size 2^( 3) =       0.001502892921
  error estimate for blocks of size 2^( 4) =       0.001545180316
  error estimate for blocks of size 2^( 5) =       0.001571647455
  error estimate for blocks of size 2^( 6) =       0.001582482623
  error estimate for blocks of size 2^( 7) =       0.001590719529

      target function =                  N/A
              le_mean =     -22.330701328413
             les_mean =     502.354567777568
             stat err =       0.001572507481
             autocorr =       1.320633677089
              std dev =       1.935189427210
             le_variance =       3.744958119187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.744818965333
                                         uncertainty =       0.031111656737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.744818965333
                                         uncertainty =       0.031111656737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368363664
  error estimate for blocks of size 2^( 2) =       0.001439731860
  error estimate for blocks of size 2^( 3) =       0.001502892914
  error estimate for blocks of size 2^( 4) =       0.001545180310
  error estimate for blocks of size 2^( 5) =       0.001571647451
  error estimate for blocks of size 2^( 6) =       0.001582482623
  error estimate for blocks of size 2^( 7) =       0.001590719528

      target function =                  N/A
              le_mean =     -22.330701325548
             les_mean =     502.354567413936
             stat err =       0.001572507478
             autocorr =       1.320633689431
              std dev =       1.935189414838
             le_variance =       3.744958071300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.744818989181
                                         uncertainty =       0.031111657053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.744818989181
                                         uncertainty =       0.031111657053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368363669
  error estimate for blocks of size 2^( 2) =       0.001439731864
  error estimate for blocks of size 2^( 3) =       0.001502892918
  error estimate for blocks of size 2^( 4) =       0.001545180313
  error estimate for blocks of size 2^( 5) =       0.001571647453
  error estimate for blocks of size 2^( 6) =       0.001582482623
  error estimate for blocks of size 2^( 7) =       0.001590719529

      target function =                  N/A
              le_mean =     -22.330701326980
             les_mean =     502.354567594221
             stat err =       0.001572507479
             autocorr =       1.320633683261
              std dev =       1.935189421023
             le_variance =       3.744958095238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.744819010057
                                         uncertainty =       0.031111657329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.744819010057
                                         uncertainty =       0.031111657329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368363673
  error estimate for blocks of size 2^( 2) =       0.001439731868
  error estimate for blocks of size 2^( 3) =       0.001502892920
  error estimate for blocks of size 2^( 4) =       0.001545180315
  error estimate for blocks of size 2^( 5) =       0.001571647455
  error estimate for blocks of size 2^( 6) =       0.001582482623
  error estimate for blocks of size 2^( 7) =       0.001590719529

      target function =                  N/A
              le_mean =     -22.330701328234
             les_mean =     502.354567754481
             stat err =       0.001572507481
             autocorr =       1.320633677861
              std dev =       1.935189426437
             le_variance =       3.744958116193


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330701328413        initial  <--
     1.3878e+03     1.3878e+04             3.3388e-07       -22.330701325548
     5.5511e+03     5.5511e+04             8.3477e-08       -22.330701326980
     2.2204e+04     2.2204e+05             2.0870e-08       -22.330701328234

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.0252
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235953e-02 3 1  ON 3
ci_005                 4.604136e-02 3 1  ON 4
ci_006                 4.618035e-02 3 1  ON 5
ci_007                 3.181058e-02 3 1  ON 6
ci_008                 3.146458e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551354e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062703e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780147e-03 3 1  ON 20
ci_022                -9.447963e-03 3 1  ON 21
ci_023                 8.747093e-03 3 1  ON 22
ci_024                 9.498609e-03 3 1  ON 23
ci_025                 7.145530e-03 3 1  ON 24
ci_026                 8.158013e-03 3 1  ON 25
ci_027                 7.925404e-03 3 1  ON 26
ci_028                 7.865106e-03 3 1  ON 27
ci_029                -7.651961e-03 3 1  ON 28
ci_030                -7.767645e-03 3 1  ON 29
ci_031                -7.191456e-03 3 1  ON 30
ci_032                -7.558603e-03 3 1  ON 31
ci_033                 6.846948e-03 3 1  ON 32
ci_034                 6.331895e-03 3 1  ON 33
ci_035                 6.422694e-03 3 1  ON 34
ci_036                 6.953426e-03 3 1  ON 35
ci_037                 6.517879e-03 3 1  ON 36
ci_038                 5.614235e-03 3 1  ON 37
ci_039                 5.905394e-03 3 1  ON 38
ci_040                 6.142298e-03 3 1  ON 39
ci_041                 5.432239e-03 3 1  ON 40
ci_042                 5.115313e-03 3 1  ON 41
ci_043                 5.093132e-03 3 1  ON 42
ci_044                 4.460070e-03 3 1  ON 43
ci_045                 5.122752e-03 3 1  ON 44
ci_046                 5.280793e-03 3 1  ON 45
ci_047                -3.977033e-03 3 1  ON 46
ci_048                -4.395075e-03 3 1  ON 47
ci_049                 4.051691e-03 3 1  ON 48
ci_050                 3.469462e-03 3 1  ON 49
ci_051                -3.068505e-03 3 1  ON 50
ci_052                -2.205008e-03 3 1  ON 51
ci_053                -2.741966e-03 3 1  ON 52
ci_054                -3.446667e-03 3 1  ON 53
ci_055                -1.934038e-03 3 1  ON 54
ci_056                -2.000746e-03 3 1  ON 55
ci_057                -1.788169e-03 3 1  ON 56
ci_058                -1.820667e-03 3 1  ON 57
ci_059                -1.892114e-03 3 1  ON 58
ci_060                -2.081045e-03 3 1  ON 59
ci_061                -1.839953e-03 3 1  ON 60
ci_062                -1.917103e-03 3 1  ON 61
ci_063                -1.942378e-03 3 1  ON 62
ci_064                -9.418106e-04 3 1  ON 63
ci_065                -1.763519e-03 3 1  ON 64
ci_066                -1.417346e-03 3 1  ON 65
ci_067                -1.965480e-03 3 1  ON 66
ci_068                -1.528181e-03 3 1  ON 67
ci_069                 1.160873e-03 3 1  ON 68
ci_070                 1.597969e-03 3 1  ON 69
ci_071                 1.909295e-05 3 1  ON 70
ci_072                -2.575558e-04 3 1  ON 71
ci_073                 1.366647e-03 3 1  ON 72
ci_074                 8.912892e-04 3 1  ON 73
ci_075                -1.333921e-03 3 1  ON 74
ci_076                -7.291241e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7791e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2299e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.4285
    reference variance = 2.20556
====================================================
  Execution time = 2.3761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0317e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6839e+00
  Total weights = 1.950051701e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8557e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734668057714
                                         uncertainty =       0.027283059310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734668057714
                                         uncertainty =       0.027283059310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366554751
  error estimate for blocks of size 2^( 2) =       0.001438246822
  error estimate for blocks of size 2^( 3) =       0.001502503679
  error estimate for blocks of size 2^( 4) =       0.001545437970
  error estimate for blocks of size 2^( 5) =       0.001568215649
  error estimate for blocks of size 2^( 6) =       0.001574951023
  error estimate for blocks of size 2^( 7) =       0.001583432699

      target function =                  N/A
              le_mean =     -22.327855094524
             les_mean =     502.217009157356
             stat err =       0.001568009335
             autocorr =       1.316567756847
              std dev =       1.932631184312
             le_variance =       3.735063294577


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232785509452e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+04, overlap shift 1.3878e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327855093682       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327855095215       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327855095331       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327855095327       residual = 2.29e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+04 is 3.356088e-08

solving harmonic davidson linear method for identity shift 5.5511e+04, overlap shift 5.5511e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327855093682       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327855094065       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327855094094       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327855094093       residual = 2.29e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+04 is 8.390348e-09

solving harmonic davidson linear method for identity shift 2.2204e+05, overlap shift 2.2204e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327855093682       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327855093778       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327855093785       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327855093785       residual = 2.29e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+05 is 2.097595e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104983 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9624e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235953e-02 3 1  ON 3
ci_005                 4.604136e-02 3 1  ON 4
ci_006                 4.618035e-02 3 1  ON 5
ci_007                 3.181057e-02 3 1  ON 6
ci_008                 3.146458e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551354e-02 3 1  ON 9
ci_011                -2.288316e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062703e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780143e-03 3 1  ON 20
ci_022                -9.447966e-03 3 1  ON 21
ci_023                 8.747093e-03 3 1  ON 22
ci_024                 9.498613e-03 3 1  ON 23
ci_025                 7.145535e-03 3 1  ON 24
ci_026                 8.158015e-03 3 1  ON 25
ci_027                 7.925404e-03 3 1  ON 26
ci_028                 7.865109e-03 3 1  ON 27
ci_029                -7.651962e-03 3 1  ON 28
ci_030                -7.767638e-03 3 1  ON 29
ci_031                -7.191458e-03 3 1  ON 30
ci_032                -7.558605e-03 3 1  ON 31
ci_033                 6.846953e-03 3 1  ON 32
ci_034                 6.331895e-03 3 1  ON 33
ci_035                 6.422693e-03 3 1  ON 34
ci_036                 6.953423e-03 3 1  ON 35
ci_037                 6.517878e-03 3 1  ON 36
ci_038                 5.614233e-03 3 1  ON 37
ci_039                 5.905387e-03 3 1  ON 38
ci_040                 6.142291e-03 3 1  ON 39
ci_041                 5.432238e-03 3 1  ON 40
ci_042                 5.115316e-03 3 1  ON 41
ci_043                 5.093129e-03 3 1  ON 42
ci_044                 4.460073e-03 3 1  ON 43
ci_045                 5.122751e-03 3 1  ON 44
ci_046                 5.280791e-03 3 1  ON 45
ci_047                -3.977030e-03 3 1  ON 46
ci_048                -4.395067e-03 3 1  ON 47
ci_049                 4.051686e-03 3 1  ON 48
ci_050                 3.469459e-03 3 1  ON 49
ci_051                -3.068508e-03 3 1  ON 50
ci_052                -2.205009e-03 3 1  ON 51
ci_053                -2.741966e-03 3 1  ON 52
ci_054                -3.446668e-03 3 1  ON 53
ci_055                -1.934041e-03 3 1  ON 54
ci_056                -2.000748e-03 3 1  ON 55
ci_057                -1.788172e-03 3 1  ON 56
ci_058                -1.820664e-03 3 1  ON 57
ci_059                -1.892112e-03 3 1  ON 58
ci_060                -2.081046e-03 3 1  ON 59
ci_061                -1.839952e-03 3 1  ON 60
ci_062                -1.917104e-03 3 1  ON 61
ci_063                -1.942378e-03 3 1  ON 62
ci_064                -9.418134e-04 3 1  ON 63
ci_065                -1.763520e-03 3 1  ON 64
ci_066                -1.417344e-03 3 1  ON 65
ci_067                -1.965481e-03 3 1  ON 66
ci_068                -1.528181e-03 3 1  ON 67
ci_069                 1.160875e-03 3 1  ON 68
ci_070                 1.597971e-03 3 1  ON 69
ci_071                 1.908761e-05 3 1  ON 70
ci_072                -2.575550e-04 3 1  ON 71
ci_073                 1.366649e-03 3 1  ON 72
ci_074                 8.912908e-04 3 1  ON 73
ci_075                -1.333924e-03 3 1  ON 74
ci_076                -7.291198e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.307
    reference variance = 3.57136
====================================================
  Execution time = 2.3182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.8056e+00
  Total weights = 1.9497e+06
  Execution time = 4.3680e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860453699740
                                         uncertainty =       0.065387661006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860453699740
                                         uncertainty =       0.065387661006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389257068
  error estimate for blocks of size 2^( 2) =       0.001459527015
  error estimate for blocks of size 2^( 3) =       0.001523479674
  error estimate for blocks of size 2^( 4) =       0.001568914730
  error estimate for blocks of size 2^( 5) =       0.001592550981
  error estimate for blocks of size 2^( 6) =       0.001604564389
  error estimate for blocks of size 2^( 7) =       0.001611332091

      target function =                  N/A
              le_mean =     -22.326246477703
             les_mean =     502.266839596438
             stat err =       0.001594340548
             autocorr =       1.317033897673
              std dev =       1.964737621979
             le_variance =       3.860193923221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860453694238
                                         uncertainty =       0.065387661121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860453694238
                                         uncertainty =       0.065387661121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389257067
  error estimate for blocks of size 2^( 2) =       0.001459527014
  error estimate for blocks of size 2^( 3) =       0.001523479674
  error estimate for blocks of size 2^( 4) =       0.001568914730
  error estimate for blocks of size 2^( 5) =       0.001592550981
  error estimate for blocks of size 2^( 6) =       0.001604564389
  error estimate for blocks of size 2^( 7) =       0.001611332092

      target function =                  N/A
              le_mean =     -22.326246477573
             les_mean =     502.266839577019
             stat err =       0.001594340548
             autocorr =       1.317033899456
              std dev =       1.964737620547
             le_variance =       3.860193917594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860453696989
                                         uncertainty =       0.065387661064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860453696989
                                         uncertainty =       0.065387661064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389257067
  error estimate for blocks of size 2^( 2) =       0.001459527014
  error estimate for blocks of size 2^( 3) =       0.001523479674
  error estimate for blocks of size 2^( 4) =       0.001568914730
  error estimate for blocks of size 2^( 5) =       0.001592550981
  error estimate for blocks of size 2^( 6) =       0.001604564389
  error estimate for blocks of size 2^( 7) =       0.001611332092

      target function =                  N/A
              le_mean =     -22.326246477638
             les_mean =     502.266839586723
             stat err =       0.001594340548
             autocorr =       1.317033898566
              std dev =       1.964737621263
             le_variance =       3.860193920408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860453699397
                                         uncertainty =       0.065387661013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860453699397
                                         uncertainty =       0.065387661013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389257068
  error estimate for blocks of size 2^( 2) =       0.001459527015
  error estimate for blocks of size 2^( 3) =       0.001523479674
  error estimate for blocks of size 2^( 4) =       0.001568914730
  error estimate for blocks of size 2^( 5) =       0.001592550981
  error estimate for blocks of size 2^( 6) =       0.001604564389
  error estimate for blocks of size 2^( 7) =       0.001611332091

      target function =                  N/A
              le_mean =     -22.326246477695
             les_mean =     502.266839595223
             stat err =       0.001594340548
             autocorr =       1.317033897785
              std dev =       1.964737621890
             le_variance =       3.860193922869


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326246477703        initial  <--
     1.3878e+04     1.3878e+05             3.3561e-08       -22.326246477573
     5.5511e+04     5.5511e+05             8.3903e-09       -22.326246477638
     2.2204e+05     2.2204e+06             2.0976e-09       -22.326246477695

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1119
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235953e-02 3 1  ON 3
ci_005                 4.604136e-02 3 1  ON 4
ci_006                 4.618035e-02 3 1  ON 5
ci_007                 3.181058e-02 3 1  ON 6
ci_008                 3.146458e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551354e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062703e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780147e-03 3 1  ON 20
ci_022                -9.447963e-03 3 1  ON 21
ci_023                 8.747093e-03 3 1  ON 22
ci_024                 9.498609e-03 3 1  ON 23
ci_025                 7.145530e-03 3 1  ON 24
ci_026                 8.158013e-03 3 1  ON 25
ci_027                 7.925404e-03 3 1  ON 26
ci_028                 7.865106e-03 3 1  ON 27
ci_029                -7.651961e-03 3 1  ON 28
ci_030                -7.767645e-03 3 1  ON 29
ci_031                -7.191456e-03 3 1  ON 30
ci_032                -7.558603e-03 3 1  ON 31
ci_033                 6.846948e-03 3 1  ON 32
ci_034                 6.331895e-03 3 1  ON 33
ci_035                 6.422694e-03 3 1  ON 34
ci_036                 6.953426e-03 3 1  ON 35
ci_037                 6.517879e-03 3 1  ON 36
ci_038                 5.614235e-03 3 1  ON 37
ci_039                 5.905394e-03 3 1  ON 38
ci_040                 6.142298e-03 3 1  ON 39
ci_041                 5.432239e-03 3 1  ON 40
ci_042                 5.115313e-03 3 1  ON 41
ci_043                 5.093132e-03 3 1  ON 42
ci_044                 4.460070e-03 3 1  ON 43
ci_045                 5.122752e-03 3 1  ON 44
ci_046                 5.280793e-03 3 1  ON 45
ci_047                -3.977033e-03 3 1  ON 46
ci_048                -4.395075e-03 3 1  ON 47
ci_049                 4.051691e-03 3 1  ON 48
ci_050                 3.469462e-03 3 1  ON 49
ci_051                -3.068505e-03 3 1  ON 50
ci_052                -2.205008e-03 3 1  ON 51
ci_053                -2.741966e-03 3 1  ON 52
ci_054                -3.446667e-03 3 1  ON 53
ci_055                -1.934038e-03 3 1  ON 54
ci_056                -2.000746e-03 3 1  ON 55
ci_057                -1.788169e-03 3 1  ON 56
ci_058                -1.820667e-03 3 1  ON 57
ci_059                -1.892114e-03 3 1  ON 58
ci_060                -2.081045e-03 3 1  ON 59
ci_061                -1.839953e-03 3 1  ON 60
ci_062                -1.917103e-03 3 1  ON 61
ci_063                -1.942378e-03 3 1  ON 62
ci_064                -9.418106e-04 3 1  ON 63
ci_065                -1.763519e-03 3 1  ON 64
ci_066                -1.417346e-03 3 1  ON 65
ci_067                -1.965480e-03 3 1  ON 66
ci_068                -1.528181e-03 3 1  ON 67
ci_069                 1.160873e-03 3 1  ON 68
ci_070                 1.597969e-03 3 1  ON 69
ci_071                 1.909295e-05 3 1  ON 70
ci_072                -2.575558e-04 3 1  ON 71
ci_073                 1.366647e-03 3 1  ON 72
ci_074                 8.912892e-04 3 1  ON 73
ci_075                -1.333921e-03 3 1  ON 74
ci_076                -7.291241e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4743e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2301e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.4466
    reference variance = 2.16062
====================================================
  Execution time = 2.3822e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0305e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7606e+00
  Total weights = 1.950052246e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8364e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814473539612
                                         uncertainty =       0.066786832330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814473539612
                                         uncertainty =       0.066786832330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380824905
  error estimate for blocks of size 2^( 2) =       0.001452130142
  error estimate for blocks of size 2^( 3) =       0.001515992839
  error estimate for blocks of size 2^( 4) =       0.001557950469
  error estimate for blocks of size 2^( 5) =       0.001585089996
  error estimate for blocks of size 2^( 6) =       0.001594878892
  error estimate for blocks of size 2^( 7) =       0.001602649399

      target function =                  N/A
              le_mean =     -22.328949652092
             les_mean =     502.342639257218
             stat err =       0.001585142189
             autocorr =       1.317829505091
              std dev =       1.952812552374
             le_variance =       3.813476864708


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232894965209e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+05, overlap shift 1.3878e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328949651245       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328949651403       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328949651403       residual = 3.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+05 is 3.413053e-09

solving harmonic davidson linear method for identity shift 5.5511e+05, overlap shift 5.5511e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328949651245       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328949651285       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328949651285       residual = 3.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+05 is 8.532642e-10

solving harmonic davidson linear method for identity shift 2.2204e+06, overlap shift 2.2204e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328949651245       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328949651255       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328949651255       residual = 3.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+06 is 2.133161e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106175 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9665e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235953e-02 3 1  ON 3
ci_005                 4.604136e-02 3 1  ON 4
ci_006                 4.618035e-02 3 1  ON 5
ci_007                 3.181058e-02 3 1  ON 6
ci_008                 3.146458e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551354e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062703e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780147e-03 3 1  ON 20
ci_022                -9.447963e-03 3 1  ON 21
ci_023                 8.747093e-03 3 1  ON 22
ci_024                 9.498609e-03 3 1  ON 23
ci_025                 7.145530e-03 3 1  ON 24
ci_026                 8.158013e-03 3 1  ON 25
ci_027                 7.925404e-03 3 1  ON 26
ci_028                 7.865106e-03 3 1  ON 27
ci_029                -7.651961e-03 3 1  ON 28
ci_030                -7.767644e-03 3 1  ON 29
ci_031                -7.191455e-03 3 1  ON 30
ci_032                -7.558603e-03 3 1  ON 31
ci_033                 6.846948e-03 3 1  ON 32
ci_034                 6.331894e-03 3 1  ON 33
ci_035                 6.422694e-03 3 1  ON 34
ci_036                 6.953426e-03 3 1  ON 35
ci_037                 6.517879e-03 3 1  ON 36
ci_038                 5.614236e-03 3 1  ON 37
ci_039                 5.905393e-03 3 1  ON 38
ci_040                 6.142299e-03 3 1  ON 39
ci_041                 5.432239e-03 3 1  ON 40
ci_042                 5.115313e-03 3 1  ON 41
ci_043                 5.093132e-03 3 1  ON 42
ci_044                 4.460070e-03 3 1  ON 43
ci_045                 5.122751e-03 3 1  ON 44
ci_046                 5.280793e-03 3 1  ON 45
ci_047                -3.977033e-03 3 1  ON 46
ci_048                -4.395075e-03 3 1  ON 47
ci_049                 4.051691e-03 3 1  ON 48
ci_050                 3.469463e-03 3 1  ON 49
ci_051                -3.068505e-03 3 1  ON 50
ci_052                -2.205008e-03 3 1  ON 51
ci_053                -2.741966e-03 3 1  ON 52
ci_054                -3.446667e-03 3 1  ON 53
ci_055                -1.934038e-03 3 1  ON 54
ci_056                -2.000746e-03 3 1  ON 55
ci_057                -1.788170e-03 3 1  ON 56
ci_058                -1.820667e-03 3 1  ON 57
ci_059                -1.892115e-03 3 1  ON 58
ci_060                -2.081045e-03 3 1  ON 59
ci_061                -1.839953e-03 3 1  ON 60
ci_062                -1.917103e-03 3 1  ON 61
ci_063                -1.942378e-03 3 1  ON 62
ci_064                -9.418106e-04 3 1  ON 63
ci_065                -1.763518e-03 3 1  ON 64
ci_066                -1.417346e-03 3 1  ON 65
ci_067                -1.965480e-03 3 1  ON 66
ci_068                -1.528182e-03 3 1  ON 67
ci_069                 1.160873e-03 3 1  ON 68
ci_070                 1.597969e-03 3 1  ON 69
ci_071                 1.909210e-05 3 1  ON 70
ci_072                -2.575561e-04 3 1  ON 71
ci_073                 1.366647e-03 3 1  ON 72
ci_074                 8.912888e-04 3 1  ON 73
ci_075                -1.333921e-03 3 1  ON 74
ci_076                -7.291245e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.3674
    reference variance = 4.15484
====================================================
  Execution time = 2.3216e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7310e+00
  Total weights = 1.9499e+06
  Execution time = 4.3417e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780689545467
                                         uncertainty =       0.027457988282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780689545467
                                         uncertainty =       0.027457988282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374913795
  error estimate for blocks of size 2^( 2) =       0.001445417220
  error estimate for blocks of size 2^( 3) =       0.001507564480
  error estimate for blocks of size 2^( 4) =       0.001552574485
  error estimate for blocks of size 2^( 5) =       0.001576041763
  error estimate for blocks of size 2^( 6) =       0.001593124114
  error estimate for blocks of size 2^( 7) =       0.001601416791

      target function =                  N/A
              le_mean =     -22.325914185570
             les_mean =     502.177452140165
             stat err =       0.001580789288
             autocorr =       1.321895212833
              std dev =       1.944452846515
             le_variance =       3.780896872318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780689544886
                                         uncertainty =       0.027457988280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780689544886
                                         uncertainty =       0.027457988280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374913795
  error estimate for blocks of size 2^( 2) =       0.001445417219
  error estimate for blocks of size 2^( 3) =       0.001507564480
  error estimate for blocks of size 2^( 4) =       0.001552574485
  error estimate for blocks of size 2^( 5) =       0.001576041763
  error estimate for blocks of size 2^( 6) =       0.001593124114
  error estimate for blocks of size 2^( 7) =       0.001601416791

      target function =                  N/A
              le_mean =     -22.325914185581
             les_mean =     502.177452131244
             stat err =       0.001580789288
             autocorr =       1.321895213075
              std dev =       1.944452846365
             le_variance =       3.780896871738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780689545177
                                         uncertainty =       0.027457988281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780689545177
                                         uncertainty =       0.027457988281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374913795
  error estimate for blocks of size 2^( 2) =       0.001445417219
  error estimate for blocks of size 2^( 3) =       0.001507564480
  error estimate for blocks of size 2^( 4) =       0.001552574485
  error estimate for blocks of size 2^( 5) =       0.001576041763
  error estimate for blocks of size 2^( 6) =       0.001593124114
  error estimate for blocks of size 2^( 7) =       0.001601416791

      target function =                  N/A
              le_mean =     -22.325914185576
             les_mean =     502.177452135702
             stat err =       0.001580789288
             autocorr =       1.321895212955
              std dev =       1.944452846440
             le_variance =       3.780896872028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780689545431
                                         uncertainty =       0.027457988282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780689545431
                                         uncertainty =       0.027457988282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374913795
  error estimate for blocks of size 2^( 2) =       0.001445417220
  error estimate for blocks of size 2^( 3) =       0.001507564480
  error estimate for blocks of size 2^( 4) =       0.001552574485
  error estimate for blocks of size 2^( 5) =       0.001576041763
  error estimate for blocks of size 2^( 6) =       0.001593124114
  error estimate for blocks of size 2^( 7) =       0.001601416791

      target function =                  N/A
              le_mean =     -22.325914185571
             les_mean =     502.177452139607
             stat err =       0.001580789288
             autocorr =       1.321895212849
              std dev =       1.944452846505
             le_variance =       3.780896872282


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325914185570        initial
     1.3878e+05     1.3878e+06             3.4131e-09       -22.325914185581  <--
     5.5511e+05     5.5511e+06             8.5326e-10       -22.325914185576
     2.2204e+06     2.2204e+07             2.1332e-10       -22.325914185571

*****************************************************************************
Applying the update for shift_i =   1.3878e+05     and shift_s =   1.3878e+06
*****************************************************************************

  Execution time = 4.5044e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235953e-02 3 1  ON 3
ci_005                 4.604136e-02 3 1  ON 4
ci_006                 4.618035e-02 3 1  ON 5
ci_007                 3.181058e-02 3 1  ON 6
ci_008                 3.146458e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551353e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062703e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780146e-03 3 1  ON 20
ci_022                -9.447962e-03 3 1  ON 21
ci_023                 8.747094e-03 3 1  ON 22
ci_024                 9.498609e-03 3 1  ON 23
ci_025                 7.145531e-03 3 1  ON 24
ci_026                 8.158012e-03 3 1  ON 25
ci_027                 7.925404e-03 3 1  ON 26
ci_028                 7.865105e-03 3 1  ON 27
ci_029                -7.651961e-03 3 1  ON 28
ci_030                -7.767643e-03 3 1  ON 29
ci_031                -7.191455e-03 3 1  ON 30
ci_032                -7.558604e-03 3 1  ON 31
ci_033                 6.846949e-03 3 1  ON 32
ci_034                 6.331893e-03 3 1  ON 33
ci_035                 6.422695e-03 3 1  ON 34
ci_036                 6.953425e-03 3 1  ON 35
ci_037                 6.517879e-03 3 1  ON 36
ci_038                 5.614238e-03 3 1  ON 37
ci_039                 5.905392e-03 3 1  ON 38
ci_040                 6.142300e-03 3 1  ON 39
ci_041                 5.432237e-03 3 1  ON 40
ci_042                 5.115314e-03 3 1  ON 41
ci_043                 5.093132e-03 3 1  ON 42
ci_044                 4.460070e-03 3 1  ON 43
ci_045                 5.122751e-03 3 1  ON 44
ci_046                 5.280794e-03 3 1  ON 45
ci_047                -3.977033e-03 3 1  ON 46
ci_048                -4.395076e-03 3 1  ON 47
ci_049                 4.051689e-03 3 1  ON 48
ci_050                 3.469464e-03 3 1  ON 49
ci_051                -3.068504e-03 3 1  ON 50
ci_052                -2.205009e-03 3 1  ON 51
ci_053                -2.741967e-03 3 1  ON 52
ci_054                -3.446667e-03 3 1  ON 53
ci_055                -1.934039e-03 3 1  ON 54
ci_056                -2.000745e-03 3 1  ON 55
ci_057                -1.788171e-03 3 1  ON 56
ci_058                -1.820667e-03 3 1  ON 57
ci_059                -1.892116e-03 3 1  ON 58
ci_060                -2.081044e-03 3 1  ON 59
ci_061                -1.839954e-03 3 1  ON 60
ci_062                -1.917104e-03 3 1  ON 61
ci_063                -1.942377e-03 3 1  ON 62
ci_064                -9.418107e-04 3 1  ON 63
ci_065                -1.763517e-03 3 1  ON 64
ci_066                -1.417346e-03 3 1  ON 65
ci_067                -1.965479e-03 3 1  ON 66
ci_068                -1.528182e-03 3 1  ON 67
ci_069                 1.160874e-03 3 1  ON 68
ci_070                 1.597969e-03 3 1  ON 69
ci_071                 1.908954e-05 3 1  ON 70
ci_072                -2.575568e-04 3 1  ON 71
ci_073                 1.366647e-03 3 1  ON 72
ci_074                 8.912875e-04 3 1  ON 73
ci_075                -1.333921e-03 3 1  ON 74
ci_076                -7.291256e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4716e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2302e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -21.9063
    reference variance = 4.53916
====================================================
  Execution time = 2.3811e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0336e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7102e+00
  Total weights = 1.949907988e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8123e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761507658768
                                         uncertainty =       0.028076881968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761507658768
                                         uncertainty =       0.028076881968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371512217
  error estimate for blocks of size 2^( 2) =       0.001443912604
  error estimate for blocks of size 2^( 3) =       0.001508214490
  error estimate for blocks of size 2^( 4) =       0.001550596503
  error estimate for blocks of size 2^( 5) =       0.001576263593
  error estimate for blocks of size 2^( 6) =       0.001593977839
  error estimate for blocks of size 2^( 7) =       0.001604795995

      target function =                  N/A
              le_mean =     -22.325924118193
             les_mean =     502.157089224075
             stat err =       0.001581408483
             autocorr =       1.329501302818
              std dev =       1.939642211116
             le_variance =       3.762211907143


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232592411819e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+04, overlap shift 3.4694e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325924117425       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325924117996       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325924117997       residual = 4.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+04 is 1.260075e-08

solving harmonic davidson linear method for identity shift 1.3878e+05, overlap shift 1.3878e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325924117425       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325924117568       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325924117568       residual = 4.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+05 is 3.150204e-09

solving harmonic davidson linear method for identity shift 5.5511e+05, overlap shift 5.5511e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325924117425       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325924117461       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325924117461       residual = 4.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+05 is 7.875520e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107333 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9630e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235953e-02 3 1  ON 3
ci_005                 4.604135e-02 3 1  ON 4
ci_006                 4.618035e-02 3 1  ON 5
ci_007                 3.181058e-02 3 1  ON 6
ci_008                 3.146458e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551354e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062703e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780145e-03 3 1  ON 20
ci_022                -9.447963e-03 3 1  ON 21
ci_023                 8.747094e-03 3 1  ON 22
ci_024                 9.498610e-03 3 1  ON 23
ci_025                 7.145533e-03 3 1  ON 24
ci_026                 8.158013e-03 3 1  ON 25
ci_027                 7.925404e-03 3 1  ON 26
ci_028                 7.865107e-03 3 1  ON 27
ci_029                -7.651960e-03 3 1  ON 28
ci_030                -7.767642e-03 3 1  ON 29
ci_031                -7.191457e-03 3 1  ON 30
ci_032                -7.558604e-03 3 1  ON 31
ci_033                 6.846948e-03 3 1  ON 32
ci_034                 6.331894e-03 3 1  ON 33
ci_035                 6.422696e-03 3 1  ON 34
ci_036                 6.953426e-03 3 1  ON 35
ci_037                 6.517877e-03 3 1  ON 36
ci_038                 5.614237e-03 3 1  ON 37
ci_039                 5.905391e-03 3 1  ON 38
ci_040                 6.142298e-03 3 1  ON 39
ci_041                 5.432234e-03 3 1  ON 40
ci_042                 5.115315e-03 3 1  ON 41
ci_043                 5.093133e-03 3 1  ON 42
ci_044                 4.460070e-03 3 1  ON 43
ci_045                 5.122752e-03 3 1  ON 44
ci_046                 5.280793e-03 3 1  ON 45
ci_047                -3.977033e-03 3 1  ON 46
ci_048                -4.395076e-03 3 1  ON 47
ci_049                 4.051686e-03 3 1  ON 48
ci_050                 3.469466e-03 3 1  ON 49
ci_051                -3.068504e-03 3 1  ON 50
ci_052                -2.205009e-03 3 1  ON 51
ci_053                -2.741968e-03 3 1  ON 52
ci_054                -3.446668e-03 3 1  ON 53
ci_055                -1.934038e-03 3 1  ON 54
ci_056                -2.000747e-03 3 1  ON 55
ci_057                -1.788171e-03 3 1  ON 56
ci_058                -1.820667e-03 3 1  ON 57
ci_059                -1.892116e-03 3 1  ON 58
ci_060                -2.081042e-03 3 1  ON 59
ci_061                -1.839954e-03 3 1  ON 60
ci_062                -1.917105e-03 3 1  ON 61
ci_063                -1.942376e-03 3 1  ON 62
ci_064                -9.418109e-04 3 1  ON 63
ci_065                -1.763516e-03 3 1  ON 64
ci_066                -1.417348e-03 3 1  ON 65
ci_067                -1.965478e-03 3 1  ON 66
ci_068                -1.528183e-03 3 1  ON 67
ci_069                 1.160874e-03 3 1  ON 68
ci_070                 1.597970e-03 3 1  ON 69
ci_071                 1.908747e-05 3 1  ON 70
ci_072                -2.575590e-04 3 1  ON 71
ci_073                 1.366647e-03 3 1  ON 72
ci_074                 8.912887e-04 3 1  ON 73
ci_075                -1.333922e-03 3 1  ON 74
ci_076                -7.291258e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.4809
    reference variance = 2.73304
====================================================
  Execution time = 2.3189e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.8387e+00
  Total weights = 1.9500e+06
  Execution time = 4.3416e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893972911520
                                         uncertainty =       0.124543908528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893972911520
                                         uncertainty =       0.124543908528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395096318
  error estimate for blocks of size 2^( 2) =       0.001466140335
  error estimate for blocks of size 2^( 3) =       0.001529830765
  error estimate for blocks of size 2^( 4) =       0.001572419212
  error estimate for blocks of size 2^( 5) =       0.001596947434
  error estimate for blocks of size 2^( 6) =       0.001613825502
  error estimate for blocks of size 2^( 7) =       0.001623872339

      target function =                  N/A
              le_mean =     -22.325598545387
             les_mean =     502.271054281914
             stat err =       0.001601766122
             autocorr =       1.318225847078
              std dev =       1.972995701099
             le_variance =       3.892712036554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893972912591
                                         uncertainty =       0.124543908488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893972912591
                                         uncertainty =       0.124543908488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395096318
  error estimate for blocks of size 2^( 2) =       0.001466140335
  error estimate for blocks of size 2^( 3) =       0.001529830766
  error estimate for blocks of size 2^( 4) =       0.001572419213
  error estimate for blocks of size 2^( 5) =       0.001596947434
  error estimate for blocks of size 2^( 6) =       0.001613825503
  error estimate for blocks of size 2^( 7) =       0.001623872340

      target function =                  N/A
              le_mean =     -22.325598545480
             les_mean =     502.271054283207
             stat err =       0.001601766122
             autocorr =       1.318225846970
              std dev =       1.972995701377
             le_variance =       3.892712037652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893972912055
                                         uncertainty =       0.124543908508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893972912055
                                         uncertainty =       0.124543908508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395096318
  error estimate for blocks of size 2^( 2) =       0.001466140335
  error estimate for blocks of size 2^( 3) =       0.001529830766
  error estimate for blocks of size 2^( 4) =       0.001572419213
  error estimate for blocks of size 2^( 5) =       0.001596947434
  error estimate for blocks of size 2^( 6) =       0.001613825502
  error estimate for blocks of size 2^( 7) =       0.001623872339

      target function =                  N/A
              le_mean =     -22.325598545434
             les_mean =     502.271054282560
             stat err =       0.001601766122
             autocorr =       1.318225847024
              std dev =       1.972995701238
             le_variance =       3.892712037103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893972911587
                                         uncertainty =       0.124543908525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893972911587
                                         uncertainty =       0.124543908525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395096318
  error estimate for blocks of size 2^( 2) =       0.001466140335
  error estimate for blocks of size 2^( 3) =       0.001529830765
  error estimate for blocks of size 2^( 4) =       0.001572419212
  error estimate for blocks of size 2^( 5) =       0.001596947434
  error estimate for blocks of size 2^( 6) =       0.001613825502
  error estimate for blocks of size 2^( 7) =       0.001623872339

      target function =                  N/A
              le_mean =     -22.325598545393
             les_mean =     502.271054281995
             stat err =       0.001601766122
             autocorr =       1.318225847070
              std dev =       1.972995701116
             le_variance =       3.892712036623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325598545387        initial
     3.4694e+04     3.4694e+05             1.2601e-08       -22.325598545480  <--
     1.3878e+05     1.3878e+06             3.1502e-09       -22.325598545434
     5.5511e+05     5.5511e+06             7.8755e-10       -22.325598545393

*****************************************************************************
Applying the update for shift_i =   3.4694e+04     and shift_s =   3.4694e+05
*****************************************************************************

  Execution time = 4.5035e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604134e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181058e-02 3 1  ON 6
ci_008                 3.146459e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551354e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257806e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062702e-02 3 1  ON 18
ci_020                 1.043514e-02 3 1  ON 19
ci_021                -9.780141e-03 3 1  ON 20
ci_022                -9.447965e-03 3 1  ON 21
ci_023                 8.747094e-03 3 1  ON 22
ci_024                 9.498612e-03 3 1  ON 23
ci_025                 7.145537e-03 3 1  ON 24
ci_026                 8.158015e-03 3 1  ON 25
ci_027                 7.925404e-03 3 1  ON 26
ci_028                 7.865112e-03 3 1  ON 27
ci_029                -7.651958e-03 3 1  ON 28
ci_030                -7.767639e-03 3 1  ON 29
ci_031                -7.191462e-03 3 1  ON 30
ci_032                -7.558603e-03 3 1  ON 31
ci_033                 6.846947e-03 3 1  ON 32
ci_034                 6.331896e-03 3 1  ON 33
ci_035                 6.422698e-03 3 1  ON 34
ci_036                 6.953428e-03 3 1  ON 35
ci_037                 6.517872e-03 3 1  ON 36
ci_038                 5.614233e-03 3 1  ON 37
ci_039                 5.905388e-03 3 1  ON 38
ci_040                 6.142293e-03 3 1  ON 39
ci_041                 5.432226e-03 3 1  ON 40
ci_042                 5.115319e-03 3 1  ON 41
ci_043                 5.093137e-03 3 1  ON 42
ci_044                 4.460071e-03 3 1  ON 43
ci_045                 5.122754e-03 3 1  ON 44
ci_046                 5.280789e-03 3 1  ON 45
ci_047                -3.977033e-03 3 1  ON 46
ci_048                -4.395077e-03 3 1  ON 47
ci_049                 4.051679e-03 3 1  ON 48
ci_050                 3.469472e-03 3 1  ON 49
ci_051                -3.068503e-03 3 1  ON 50
ci_052                -2.205008e-03 3 1  ON 51
ci_053                -2.741971e-03 3 1  ON 52
ci_054                -3.446672e-03 3 1  ON 53
ci_055                -1.934038e-03 3 1  ON 54
ci_056                -2.000752e-03 3 1  ON 55
ci_057                -1.788169e-03 3 1  ON 56
ci_058                -1.820666e-03 3 1  ON 57
ci_059                -1.892117e-03 3 1  ON 58
ci_060                -2.081037e-03 3 1  ON 59
ci_061                -1.839954e-03 3 1  ON 60
ci_062                -1.917106e-03 3 1  ON 61
ci_063                -1.942373e-03 3 1  ON 62
ci_064                -9.418117e-04 3 1  ON 63
ci_065                -1.763515e-03 3 1  ON 64
ci_066                -1.417353e-03 3 1  ON 65
ci_067                -1.965477e-03 3 1  ON 66
ci_068                -1.528184e-03 3 1  ON 67
ci_069                 1.160874e-03 3 1  ON 68
ci_070                 1.597973e-03 3 1  ON 69
ci_071                 1.908128e-05 3 1  ON 70
ci_072                -2.575655e-04 3 1  ON 71
ci_073                 1.366646e-03 3 1  ON 72
ci_074                 8.912923e-04 3 1  ON 73
ci_075                -1.333923e-03 3 1  ON 74
ci_076                -7.291263e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4673e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2301e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.4089
    reference variance = 2.47742
====================================================
  Execution time = 2.3797e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0312e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7133e+00
  Total weights = 1.949769402e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8552e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764004637172
                                         uncertainty =       0.038506296709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764004637172
                                         uncertainty =       0.038506296709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372013370
  error estimate for blocks of size 2^( 2) =       0.001442601014
  error estimate for blocks of size 2^( 3) =       0.001504517150
  error estimate for blocks of size 2^( 4) =       0.001549115846
  error estimate for blocks of size 2^( 5) =       0.001573595367
  error estimate for blocks of size 2^( 6) =       0.001588748878
  error estimate for blocks of size 2^( 7) =       0.001601299725

      target function =                  N/A
              le_mean =     -22.329933859665
             les_mean =     502.339217196355
             stat err =       0.001578189954
             autocorr =       1.323128006211
              std dev =       1.940350960520
             le_variance =       3.764961849992


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232993385967e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+03, overlap shift 8.6736e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329933858854       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329933860491       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329933860498       residual = 5.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+03 is 5.642690e-08

solving harmonic davidson linear method for identity shift 3.4694e+04, overlap shift 3.4694e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329933858854       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329933859264       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329933859265       residual = 5.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+04 is 1.410693e-08

solving harmonic davidson linear method for identity shift 1.3878e+05, overlap shift 1.3878e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329933858854       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329933858957       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329933858957       residual = 5.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+05 is 3.526746e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108483 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9659e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187502e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604135e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181058e-02 3 1  ON 6
ci_008                 3.146459e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551353e-02 3 1  ON 9
ci_011                -2.288316e-02 3 1  ON 10
ci_012                -2.257806e-02 3 1  ON 11
ci_013                 2.000258e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969145e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537572e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062702e-02 3 1  ON 18
ci_020                 1.043514e-02 3 1  ON 19
ci_021                -9.780137e-03 3 1  ON 20
ci_022                -9.447966e-03 3 1  ON 21
ci_023                 8.747100e-03 3 1  ON 22
ci_024                 9.498618e-03 3 1  ON 23
ci_025                 7.145539e-03 3 1  ON 24
ci_026                 8.158011e-03 3 1  ON 25
ci_027                 7.925403e-03 3 1  ON 26
ci_028                 7.865110e-03 3 1  ON 27
ci_029                -7.651961e-03 3 1  ON 28
ci_030                -7.767643e-03 3 1  ON 29
ci_031                -7.191466e-03 3 1  ON 30
ci_032                -7.558594e-03 3 1  ON 31
ci_033                 6.846942e-03 3 1  ON 32
ci_034                 6.331903e-03 3 1  ON 33
ci_035                 6.422690e-03 3 1  ON 34
ci_036                 6.953432e-03 3 1  ON 35
ci_037                 6.517886e-03 3 1  ON 36
ci_038                 5.614234e-03 3 1  ON 37
ci_039                 5.905378e-03 3 1  ON 38
ci_040                 6.142292e-03 3 1  ON 39
ci_041                 5.432221e-03 3 1  ON 40
ci_042                 5.115318e-03 3 1  ON 41
ci_043                 5.093135e-03 3 1  ON 42
ci_044                 4.460075e-03 3 1  ON 43
ci_045                 5.122755e-03 3 1  ON 44
ci_046                 5.280789e-03 3 1  ON 45
ci_047                -3.977030e-03 3 1  ON 46
ci_048                -4.395077e-03 3 1  ON 47
ci_049                 4.051676e-03 3 1  ON 48
ci_050                 3.469475e-03 3 1  ON 49
ci_051                -3.068493e-03 3 1  ON 50
ci_052                -2.205011e-03 3 1  ON 51
ci_053                -2.741969e-03 3 1  ON 52
ci_054                -3.446669e-03 3 1  ON 53
ci_055                -1.934041e-03 3 1  ON 54
ci_056                -2.000753e-03 3 1  ON 55
ci_057                -1.788167e-03 3 1  ON 56
ci_058                -1.820663e-03 3 1  ON 57
ci_059                -1.892115e-03 3 1  ON 58
ci_060                -2.081034e-03 3 1  ON 59
ci_061                -1.839955e-03 3 1  ON 60
ci_062                -1.917109e-03 3 1  ON 61
ci_063                -1.942372e-03 3 1  ON 62
ci_064                -9.418150e-04 3 1  ON 63
ci_065                -1.763517e-03 3 1  ON 64
ci_066                -1.417359e-03 3 1  ON 65
ci_067                -1.965476e-03 3 1  ON 66
ci_068                -1.528184e-03 3 1  ON 67
ci_069                 1.160873e-03 3 1  ON 68
ci_070                 1.597970e-03 3 1  ON 69
ci_071                 1.907719e-05 3 1  ON 70
ci_072                -2.575742e-04 3 1  ON 71
ci_073                 1.366639e-03 3 1  ON 72
ci_074                 8.912876e-04 3 1  ON 73
ci_075                -1.333924e-03 3 1  ON 74
ci_076                -7.291254e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.4064
    reference variance = 2.3861
====================================================
  Execution time = 2.3225e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7064e+00
  Total weights = 1.9499e+06
  Execution time = 4.3473e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759690273905
                                         uncertainty =       0.031882158375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759690273905
                                         uncertainty =       0.031882158375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370920678
  error estimate for blocks of size 2^( 2) =       0.001441777121
  error estimate for blocks of size 2^( 3) =       0.001504620262
  error estimate for blocks of size 2^( 4) =       0.001547809160
  error estimate for blocks of size 2^( 5) =       0.001573166114
  error estimate for blocks of size 2^( 6) =       0.001585255348
  error estimate for blocks of size 2^( 7) =       0.001588542489

      target function =                  N/A
              le_mean =     -22.329308566823
             les_mean =     502.304372506965
             stat err =       0.001573693278
             autocorr =       1.317696904013
              std dev =       1.938805635531
             le_variance =       3.758967292365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759690275230
                                         uncertainty =       0.031882158719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759690275230
                                         uncertainty =       0.031882158719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370920678
  error estimate for blocks of size 2^( 2) =       0.001441777121
  error estimate for blocks of size 2^( 3) =       0.001504620262
  error estimate for blocks of size 2^( 4) =       0.001547809160
  error estimate for blocks of size 2^( 5) =       0.001573166114
  error estimate for blocks of size 2^( 6) =       0.001585255349
  error estimate for blocks of size 2^( 7) =       0.001588542488

      target function =                  N/A
              le_mean =     -22.329308566581
             les_mean =     502.304372527510
             stat err =       0.001573693278
             autocorr =       1.317696903323
              std dev =       1.938805635857
             le_variance =       3.758967293631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759690274568
                                         uncertainty =       0.031882158547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759690274568
                                         uncertainty =       0.031882158547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370920678
  error estimate for blocks of size 2^( 2) =       0.001441777121
  error estimate for blocks of size 2^( 3) =       0.001504620262
  error estimate for blocks of size 2^( 4) =       0.001547809160
  error estimate for blocks of size 2^( 5) =       0.001573166114
  error estimate for blocks of size 2^( 6) =       0.001585255349
  error estimate for blocks of size 2^( 7) =       0.001588542489

      target function =                  N/A
              le_mean =     -22.329308566702
             les_mean =     502.304372517221
             stat err =       0.001573693278
             autocorr =       1.317696903668
              std dev =       1.938805635694
             le_variance =       3.758967292998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759690273988
                                         uncertainty =       0.031882158396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759690273988
                                         uncertainty =       0.031882158396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370920678
  error estimate for blocks of size 2^( 2) =       0.001441777121
  error estimate for blocks of size 2^( 3) =       0.001504620262
  error estimate for blocks of size 2^( 4) =       0.001547809160
  error estimate for blocks of size 2^( 5) =       0.001573166114
  error estimate for blocks of size 2^( 6) =       0.001585255348
  error estimate for blocks of size 2^( 7) =       0.001588542489

      target function =                  N/A
              le_mean =     -22.329308566808
             les_mean =     502.304372508246
             stat err =       0.001573693278
             autocorr =       1.317696903970
              std dev =       1.938805635551
             le_variance =       3.758967292444


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329308566823        initial  <--
     8.6736e+03     8.6736e+04             5.6427e-08       -22.329308566581
     3.4694e+04     3.4694e+05             1.4107e-08       -22.329308566702
     1.3878e+05     1.3878e+06             3.5267e-09       -22.329308566808

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.9544
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604134e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181058e-02 3 1  ON 6
ci_008                 3.146459e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551354e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257806e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062702e-02 3 1  ON 18
ci_020                 1.043514e-02 3 1  ON 19
ci_021                -9.780141e-03 3 1  ON 20
ci_022                -9.447965e-03 3 1  ON 21
ci_023                 8.747094e-03 3 1  ON 22
ci_024                 9.498612e-03 3 1  ON 23
ci_025                 7.145537e-03 3 1  ON 24
ci_026                 8.158015e-03 3 1  ON 25
ci_027                 7.925404e-03 3 1  ON 26
ci_028                 7.865112e-03 3 1  ON 27
ci_029                -7.651958e-03 3 1  ON 28
ci_030                -7.767639e-03 3 1  ON 29
ci_031                -7.191462e-03 3 1  ON 30
ci_032                -7.558603e-03 3 1  ON 31
ci_033                 6.846947e-03 3 1  ON 32
ci_034                 6.331896e-03 3 1  ON 33
ci_035                 6.422698e-03 3 1  ON 34
ci_036                 6.953428e-03 3 1  ON 35
ci_037                 6.517872e-03 3 1  ON 36
ci_038                 5.614233e-03 3 1  ON 37
ci_039                 5.905388e-03 3 1  ON 38
ci_040                 6.142293e-03 3 1  ON 39
ci_041                 5.432226e-03 3 1  ON 40
ci_042                 5.115319e-03 3 1  ON 41
ci_043                 5.093137e-03 3 1  ON 42
ci_044                 4.460071e-03 3 1  ON 43
ci_045                 5.122754e-03 3 1  ON 44
ci_046                 5.280789e-03 3 1  ON 45
ci_047                -3.977033e-03 3 1  ON 46
ci_048                -4.395077e-03 3 1  ON 47
ci_049                 4.051679e-03 3 1  ON 48
ci_050                 3.469472e-03 3 1  ON 49
ci_051                -3.068503e-03 3 1  ON 50
ci_052                -2.205008e-03 3 1  ON 51
ci_053                -2.741971e-03 3 1  ON 52
ci_054                -3.446672e-03 3 1  ON 53
ci_055                -1.934038e-03 3 1  ON 54
ci_056                -2.000752e-03 3 1  ON 55
ci_057                -1.788169e-03 3 1  ON 56
ci_058                -1.820666e-03 3 1  ON 57
ci_059                -1.892117e-03 3 1  ON 58
ci_060                -2.081037e-03 3 1  ON 59
ci_061                -1.839954e-03 3 1  ON 60
ci_062                -1.917106e-03 3 1  ON 61
ci_063                -1.942373e-03 3 1  ON 62
ci_064                -9.418117e-04 3 1  ON 63
ci_065                -1.763515e-03 3 1  ON 64
ci_066                -1.417353e-03 3 1  ON 65
ci_067                -1.965477e-03 3 1  ON 66
ci_068                -1.528184e-03 3 1  ON 67
ci_069                 1.160874e-03 3 1  ON 68
ci_070                 1.597973e-03 3 1  ON 69
ci_071                 1.908128e-05 3 1  ON 70
ci_072                -2.575655e-04 3 1  ON 71
ci_073                 1.366646e-03 3 1  ON 72
ci_074                 8.912923e-04 3 1  ON 73
ci_075                -1.333923e-03 3 1  ON 74
ci_076                -7.291263e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7624e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2302e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.0963
    reference variance = 4.07067
====================================================
  Execution time = 2.3770e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0297e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.8097e+00
  Total weights = 1.949991099e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8690e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.862396369561
                                         uncertainty =       0.072831381573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.862396369561
                                         uncertainty =       0.072831381573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389573859
  error estimate for blocks of size 2^( 2) =       0.001459980968
  error estimate for blocks of size 2^( 3) =       0.001523185917
  error estimate for blocks of size 2^( 4) =       0.001564592883
  error estimate for blocks of size 2^( 5) =       0.001591736412
  error estimate for blocks of size 2^( 6) =       0.001606798036
  error estimate for blocks of size 2^( 7) =       0.001608598397

      target function =                  N/A
              le_mean =     -22.328611300352
             les_mean =     502.376578667751
             stat err =       0.001592931432
             autocorr =       1.314107496975
              std dev =       1.965185639822
             le_variance =       3.861954598963


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232861130035e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+04, overlap shift 8.6736e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328611299565       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328611299792       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328611299792       residual = 8.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+04 is 5.772013e-09

solving harmonic davidson linear method for identity shift 3.4694e+05, overlap shift 3.4694e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328611299565       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328611299622       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328611299622       residual = 8.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+05 is 1.443005e-09

solving harmonic davidson linear method for identity shift 1.3878e+06, overlap shift 1.3878e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328611299565       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328611299579       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328611299579       residual = 8.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+06 is 3.607515e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109665 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9646e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604134e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181059e-02 3 1  ON 6
ci_008                 3.146459e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551354e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257806e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062702e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780141e-03 3 1  ON 20
ci_022                -9.447965e-03 3 1  ON 21
ci_023                 8.747093e-03 3 1  ON 22
ci_024                 9.498612e-03 3 1  ON 23
ci_025                 7.145537e-03 3 1  ON 24
ci_026                 8.158016e-03 3 1  ON 25
ci_027                 7.925404e-03 3 1  ON 26
ci_028                 7.865112e-03 3 1  ON 27
ci_029                -7.651959e-03 3 1  ON 28
ci_030                -7.767640e-03 3 1  ON 29
ci_031                -7.191462e-03 3 1  ON 30
ci_032                -7.558602e-03 3 1  ON 31
ci_033                 6.846947e-03 3 1  ON 32
ci_034                 6.331896e-03 3 1  ON 33
ci_035                 6.422699e-03 3 1  ON 34
ci_036                 6.953427e-03 3 1  ON 35
ci_037                 6.517872e-03 3 1  ON 36
ci_038                 5.614235e-03 3 1  ON 37
ci_039                 5.905388e-03 3 1  ON 38
ci_040                 6.142293e-03 3 1  ON 39
ci_041                 5.432225e-03 3 1  ON 40
ci_042                 5.115319e-03 3 1  ON 41
ci_043                 5.093137e-03 3 1  ON 42
ci_044                 4.460072e-03 3 1  ON 43
ci_045                 5.122755e-03 3 1  ON 44
ci_046                 5.280789e-03 3 1  ON 45
ci_047                -3.977033e-03 3 1  ON 46
ci_048                -4.395077e-03 3 1  ON 47
ci_049                 4.051678e-03 3 1  ON 48
ci_050                 3.469472e-03 3 1  ON 49
ci_051                -3.068503e-03 3 1  ON 50
ci_052                -2.205008e-03 3 1  ON 51
ci_053                -2.741971e-03 3 1  ON 52
ci_054                -3.446672e-03 3 1  ON 53
ci_055                -1.934038e-03 3 1  ON 54
ci_056                -2.000753e-03 3 1  ON 55
ci_057                -1.788170e-03 3 1  ON 56
ci_058                -1.820666e-03 3 1  ON 57
ci_059                -1.892117e-03 3 1  ON 58
ci_060                -2.081037e-03 3 1  ON 59
ci_061                -1.839954e-03 3 1  ON 60
ci_062                -1.917106e-03 3 1  ON 61
ci_063                -1.942372e-03 3 1  ON 62
ci_064                -9.418126e-04 3 1  ON 63
ci_065                -1.763515e-03 3 1  ON 64
ci_066                -1.417352e-03 3 1  ON 65
ci_067                -1.965477e-03 3 1  ON 66
ci_068                -1.528184e-03 3 1  ON 67
ci_069                 1.160874e-03 3 1  ON 68
ci_070                 1.597973e-03 3 1  ON 69
ci_071                 1.908079e-05 3 1  ON 70
ci_072                -2.575669e-04 3 1  ON 71
ci_073                 1.366647e-03 3 1  ON 72
ci_074                 8.912925e-04 3 1  ON 73
ci_075                -1.333923e-03 3 1  ON 74
ci_076                -7.291262e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.2218
    reference variance = 2.81244
====================================================
  Execution time = 2.3203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7881e+00
  Total weights = 1.9500e+06
  Execution time = 4.3473e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841755728259
                                         uncertainty =       0.034668161452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841755728259
                                         uncertainty =       0.034668161452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385938228
  error estimate for blocks of size 2^( 2) =       0.001455181609
  error estimate for blocks of size 2^( 3) =       0.001518123803
  error estimate for blocks of size 2^( 4) =       0.001561242693
  error estimate for blocks of size 2^( 5) =       0.001583527341
  error estimate for blocks of size 2^( 6) =       0.001599022545
  error estimate for blocks of size 2^( 7) =       0.001607827950

      target function =                  N/A
              le_mean =     -22.326263783265
             les_mean =     502.250128685917
             stat err =       0.001587905132
             autocorr =       1.312687520342
              std dev =       1.960043999266
             le_variance =       3.841772479059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841755726873
                                         uncertainty =       0.034668161437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841755726873
                                         uncertainty =       0.034668161437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385938228
  error estimate for blocks of size 2^( 2) =       0.001455181608
  error estimate for blocks of size 2^( 3) =       0.001518123803
  error estimate for blocks of size 2^( 4) =       0.001561242693
  error estimate for blocks of size 2^( 5) =       0.001583527341
  error estimate for blocks of size 2^( 6) =       0.001599022545
  error estimate for blocks of size 2^( 7) =       0.001607827950

      target function =                  N/A
              le_mean =     -22.326263783260
             les_mean =     502.250128685386
             stat err =       0.001587905132
             autocorr =       1.312687520843
              std dev =       1.960043998913
             le_variance =       3.841772477675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841755727566
                                         uncertainty =       0.034668161444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841755727566
                                         uncertainty =       0.034668161444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385938228
  error estimate for blocks of size 2^( 2) =       0.001455181609
  error estimate for blocks of size 2^( 3) =       0.001518123803
  error estimate for blocks of size 2^( 4) =       0.001561242693
  error estimate for blocks of size 2^( 5) =       0.001583527341
  error estimate for blocks of size 2^( 6) =       0.001599022545
  error estimate for blocks of size 2^( 7) =       0.001607827950

      target function =                  N/A
              le_mean =     -22.326263783262
             les_mean =     502.250128685651
             stat err =       0.001587905132
             autocorr =       1.312687520592
              std dev =       1.960043999090
             le_variance =       3.841772478367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841755728172
                                         uncertainty =       0.034668161451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841755728172
                                         uncertainty =       0.034668161451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385938228
  error estimate for blocks of size 2^( 2) =       0.001455181609
  error estimate for blocks of size 2^( 3) =       0.001518123803
  error estimate for blocks of size 2^( 4) =       0.001561242693
  error estimate for blocks of size 2^( 5) =       0.001583527341
  error estimate for blocks of size 2^( 6) =       0.001599022545
  error estimate for blocks of size 2^( 7) =       0.001607827950

      target function =                  N/A
              le_mean =     -22.326263783265
             les_mean =     502.250128685884
             stat err =       0.001587905132
             autocorr =       1.312687520373
              std dev =       1.960043999244
             le_variance =       3.841772478972


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326263783265        initial  <--
     8.6736e+04     8.6736e+05             5.7720e-09       -22.326263783260
     3.4694e+05     3.4694e+06             1.4430e-09       -22.326263783262
     1.3878e+06     1.3878e+07             3.6075e-10       -22.326263783265

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0052
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604134e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181058e-02 3 1  ON 6
ci_008                 3.146459e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551354e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257806e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062702e-02 3 1  ON 18
ci_020                 1.043514e-02 3 1  ON 19
ci_021                -9.780141e-03 3 1  ON 20
ci_022                -9.447965e-03 3 1  ON 21
ci_023                 8.747094e-03 3 1  ON 22
ci_024                 9.498612e-03 3 1  ON 23
ci_025                 7.145537e-03 3 1  ON 24
ci_026                 8.158015e-03 3 1  ON 25
ci_027                 7.925404e-03 3 1  ON 26
ci_028                 7.865112e-03 3 1  ON 27
ci_029                -7.651958e-03 3 1  ON 28
ci_030                -7.767639e-03 3 1  ON 29
ci_031                -7.191462e-03 3 1  ON 30
ci_032                -7.558603e-03 3 1  ON 31
ci_033                 6.846947e-03 3 1  ON 32
ci_034                 6.331896e-03 3 1  ON 33
ci_035                 6.422698e-03 3 1  ON 34
ci_036                 6.953428e-03 3 1  ON 35
ci_037                 6.517872e-03 3 1  ON 36
ci_038                 5.614233e-03 3 1  ON 37
ci_039                 5.905388e-03 3 1  ON 38
ci_040                 6.142293e-03 3 1  ON 39
ci_041                 5.432226e-03 3 1  ON 40
ci_042                 5.115319e-03 3 1  ON 41
ci_043                 5.093137e-03 3 1  ON 42
ci_044                 4.460071e-03 3 1  ON 43
ci_045                 5.122754e-03 3 1  ON 44
ci_046                 5.280789e-03 3 1  ON 45
ci_047                -3.977033e-03 3 1  ON 46
ci_048                -4.395077e-03 3 1  ON 47
ci_049                 4.051679e-03 3 1  ON 48
ci_050                 3.469472e-03 3 1  ON 49
ci_051                -3.068503e-03 3 1  ON 50
ci_052                -2.205008e-03 3 1  ON 51
ci_053                -2.741971e-03 3 1  ON 52
ci_054                -3.446672e-03 3 1  ON 53
ci_055                -1.934038e-03 3 1  ON 54
ci_056                -2.000752e-03 3 1  ON 55
ci_057                -1.788169e-03 3 1  ON 56
ci_058                -1.820666e-03 3 1  ON 57
ci_059                -1.892117e-03 3 1  ON 58
ci_060                -2.081037e-03 3 1  ON 59
ci_061                -1.839954e-03 3 1  ON 60
ci_062                -1.917106e-03 3 1  ON 61
ci_063                -1.942373e-03 3 1  ON 62
ci_064                -9.418117e-04 3 1  ON 63
ci_065                -1.763515e-03 3 1  ON 64
ci_066                -1.417353e-03 3 1  ON 65
ci_067                -1.965477e-03 3 1  ON 66
ci_068                -1.528184e-03 3 1  ON 67
ci_069                 1.160874e-03 3 1  ON 68
ci_070                 1.597973e-03 3 1  ON 69
ci_071                 1.908128e-05 3 1  ON 70
ci_072                -2.575655e-04 3 1  ON 71
ci_073                 1.366646e-03 3 1  ON 72
ci_074                 8.912923e-04 3 1  ON 73
ci_075                -1.333923e-03 3 1  ON 74
ci_076                -7.291263e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4659e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2300e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.5886
    reference variance = 1.8292
====================================================
  Execution time = 2.3876e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0336e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7367e+00
  Total weights = 1.949916473e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8073e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789137919413
                                         uncertainty =       0.037041855563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789137919413
                                         uncertainty =       0.037041855563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376348261
  error estimate for blocks of size 2^( 2) =       0.001447462818
  error estimate for blocks of size 2^( 3) =       0.001509961221
  error estimate for blocks of size 2^( 4) =       0.001552881601
  error estimate for blocks of size 2^( 5) =       0.001580076601
  error estimate for blocks of size 2^( 6) =       0.001595978938
  error estimate for blocks of size 2^( 7) =       0.001602449651

      target function =                  N/A
              le_mean =     -22.328048231441
             les_mean =     502.278421549569
             stat err =       0.001582846698
             autocorr =       1.322577201410
              std dev =       1.946481520393
             le_variance =       3.788790309230


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232804823144e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+05, overlap shift 8.6736e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328048230656       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328048230680       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328048230680       residual = 1.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+05 is 6.677473e-10

solving harmonic davidson linear method for identity shift 3.4694e+06, overlap shift 3.4694e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328048230656       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328048230662       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328048230662       residual = 1.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+06 is 1.669369e-10

solving harmonic davidson linear method for identity shift 1.3878e+07, overlap shift 1.3878e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328048230656       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328048230657       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328048230657       residual = 1.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+07 is 4.173422e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110865 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9690e+01
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604134e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181058e-02 3 1  ON 6
ci_008                 3.146459e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551354e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257806e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062702e-02 3 1  ON 18
ci_020                 1.043514e-02 3 1  ON 19
ci_021                -9.780141e-03 3 1  ON 20
ci_022                -9.447965e-03 3 1  ON 21
ci_023                 8.747094e-03 3 1  ON 22
ci_024                 9.498612e-03 3 1  ON 23
ci_025                 7.145537e-03 3 1  ON 24
ci_026                 8.158015e-03 3 1  ON 25
ci_027                 7.925404e-03 3 1  ON 26
ci_028                 7.865112e-03 3 1  ON 27
ci_029                -7.651959e-03 3 1  ON 28
ci_030                -7.767639e-03 3 1  ON 29
ci_031                -7.191462e-03 3 1  ON 30
ci_032                -7.558603e-03 3 1  ON 31
ci_033                 6.846947e-03 3 1  ON 32
ci_034                 6.331896e-03 3 1  ON 33
ci_035                 6.422698e-03 3 1  ON 34
ci_036                 6.953428e-03 3 1  ON 35
ci_037                 6.517872e-03 3 1  ON 36
ci_038                 5.614234e-03 3 1  ON 37
ci_039                 5.905388e-03 3 1  ON 38
ci_040                 6.142293e-03 3 1  ON 39
ci_041                 5.432226e-03 3 1  ON 40
ci_042                 5.115319e-03 3 1  ON 41
ci_043                 5.093137e-03 3 1  ON 42
ci_044                 4.460071e-03 3 1  ON 43
ci_045                 5.122754e-03 3 1  ON 44
ci_046                 5.280789e-03 3 1  ON 45
ci_047                -3.977033e-03 3 1  ON 46
ci_048                -4.395077e-03 3 1  ON 47
ci_049                 4.051679e-03 3 1  ON 48
ci_050                 3.469472e-03 3 1  ON 49
ci_051                -3.068503e-03 3 1  ON 50
ci_052                -2.205008e-03 3 1  ON 51
ci_053                -2.741971e-03 3 1  ON 52
ci_054                -3.446672e-03 3 1  ON 53
ci_055                -1.934038e-03 3 1  ON 54
ci_056                -2.000752e-03 3 1  ON 55
ci_057                -1.788169e-03 3 1  ON 56
ci_058                -1.820666e-03 3 1  ON 57
ci_059                -1.892117e-03 3 1  ON 58
ci_060                -2.081037e-03 3 1  ON 59
ci_061                -1.839954e-03 3 1  ON 60
ci_062                -1.917106e-03 3 1  ON 61
ci_063                -1.942373e-03 3 1  ON 62
ci_064                -9.418118e-04 3 1  ON 63
ci_065                -1.763515e-03 3 1  ON 64
ci_066                -1.417353e-03 3 1  ON 65
ci_067                -1.965476e-03 3 1  ON 66
ci_068                -1.528184e-03 3 1  ON 67
ci_069                 1.160874e-03 3 1  ON 68
ci_070                 1.597973e-03 3 1  ON 69
ci_071                 1.908121e-05 3 1  ON 70
ci_072                -2.575655e-04 3 1  ON 71
ci_073                 1.366646e-03 3 1  ON 72
ci_074                 8.912924e-04 3 1  ON 73
ci_075                -1.333923e-03 3 1  ON 74
ci_076                -7.291263e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.1941
    reference variance = 3.61252
====================================================
  Execution time = 2.3172e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7296e+00
  Total weights = 1.9501e+06
  Execution time = 4.3224e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779119032203
                                         uncertainty =       0.033019159293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779119032203
                                         uncertainty =       0.033019159293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374667947
  error estimate for blocks of size 2^( 2) =       0.001445407404
  error estimate for blocks of size 2^( 3) =       0.001509522618
  error estimate for blocks of size 2^( 4) =       0.001553506834
  error estimate for blocks of size 2^( 5) =       0.001577452729
  error estimate for blocks of size 2^( 6) =       0.001597485971
  error estimate for blocks of size 2^( 7) =       0.001593180567

      target function =                  N/A
              le_mean =     -22.328686848437
             les_mean =     502.299901266606
             stat err =       0.001580406525
             autocorr =       1.321727771630
              std dev =       1.944105159241
             le_variance =       3.779544870187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779119032145
                                         uncertainty =       0.033019159294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779119032145
                                         uncertainty =       0.033019159294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374667947
  error estimate for blocks of size 2^( 2) =       0.001445407404
  error estimate for blocks of size 2^( 3) =       0.001509522618
  error estimate for blocks of size 2^( 4) =       0.001553506834
  error estimate for blocks of size 2^( 5) =       0.001577452729
  error estimate for blocks of size 2^( 6) =       0.001597485971
  error estimate for blocks of size 2^( 7) =       0.001593180567

      target function =                  N/A
              le_mean =     -22.328686848437
             les_mean =     502.299901266772
             stat err =       0.001580406525
             autocorr =       1.321727771676
              std dev =       1.944105159226
             le_variance =       3.779544870130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779119032174
                                         uncertainty =       0.033019159294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779119032174
                                         uncertainty =       0.033019159294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374667947
  error estimate for blocks of size 2^( 2) =       0.001445407404
  error estimate for blocks of size 2^( 3) =       0.001509522618
  error estimate for blocks of size 2^( 4) =       0.001553506834
  error estimate for blocks of size 2^( 5) =       0.001577452729
  error estimate for blocks of size 2^( 6) =       0.001597485971
  error estimate for blocks of size 2^( 7) =       0.001593180567

      target function =                  N/A
              le_mean =     -22.328686848437
             les_mean =     502.299901266689
             stat err =       0.001580406525
             autocorr =       1.321727771654
              std dev =       1.944105159234
             le_variance =       3.779544870159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779119032200
                                         uncertainty =       0.033019159293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779119032200
                                         uncertainty =       0.033019159293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374667947
  error estimate for blocks of size 2^( 2) =       0.001445407404
  error estimate for blocks of size 2^( 3) =       0.001509522618
  error estimate for blocks of size 2^( 4) =       0.001553506834
  error estimate for blocks of size 2^( 5) =       0.001577452729
  error estimate for blocks of size 2^( 6) =       0.001597485971
  error estimate for blocks of size 2^( 7) =       0.001593180567

      target function =                  N/A
              le_mean =     -22.328686848437
             les_mean =     502.299901266616
             stat err =       0.001580406525
             autocorr =       1.321727771633
              std dev =       1.944105159240
             le_variance =       3.779544870184


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328686848437        initial
     8.6736e+05     8.6736e+06             6.6775e-10       -22.328686848437  <--
     3.4694e+06     3.4694e+07             1.6694e-10       -22.328686848437
     1.3878e+07     1.3878e+08             4.1734e-11       -22.328686848437

*****************************************************************************
Applying the update for shift_i =   8.6736e+05     and shift_s =   8.6736e+06
*****************************************************************************

  Execution time = 4.4870e+01
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604134e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181058e-02 3 1  ON 6
ci_008                 3.146459e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551354e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257806e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062702e-02 3 1  ON 18
ci_020                 1.043514e-02 3 1  ON 19
ci_021                -9.780141e-03 3 1  ON 20
ci_022                -9.447965e-03 3 1  ON 21
ci_023                 8.747093e-03 3 1  ON 22
ci_024                 9.498612e-03 3 1  ON 23
ci_025                 7.145537e-03 3 1  ON 24
ci_026                 8.158015e-03 3 1  ON 25
ci_027                 7.925403e-03 3 1  ON 26
ci_028                 7.865112e-03 3 1  ON 27
ci_029                -7.651959e-03 3 1  ON 28
ci_030                -7.767639e-03 3 1  ON 29
ci_031                -7.191462e-03 3 1  ON 30
ci_032                -7.558603e-03 3 1  ON 31
ci_033                 6.846947e-03 3 1  ON 32
ci_034                 6.331896e-03 3 1  ON 33
ci_035                 6.422698e-03 3 1  ON 34
ci_036                 6.953428e-03 3 1  ON 35
ci_037                 6.517871e-03 3 1  ON 36
ci_038                 5.614234e-03 3 1  ON 37
ci_039                 5.905388e-03 3 1  ON 38
ci_040                 6.142293e-03 3 1  ON 39
ci_041                 5.432226e-03 3 1  ON 40
ci_042                 5.115319e-03 3 1  ON 41
ci_043                 5.093137e-03 3 1  ON 42
ci_044                 4.460071e-03 3 1  ON 43
ci_045                 5.122754e-03 3 1  ON 44
ci_046                 5.280789e-03 3 1  ON 45
ci_047                -3.977033e-03 3 1  ON 46
ci_048                -4.395077e-03 3 1  ON 47
ci_049                 4.051678e-03 3 1  ON 48
ci_050                 3.469472e-03 3 1  ON 49
ci_051                -3.068503e-03 3 1  ON 50
ci_052                -2.205009e-03 3 1  ON 51
ci_053                -2.741971e-03 3 1  ON 52
ci_054                -3.446672e-03 3 1  ON 53
ci_055                -1.934038e-03 3 1  ON 54
ci_056                -2.000752e-03 3 1  ON 55
ci_057                -1.788169e-03 3 1  ON 56
ci_058                -1.820667e-03 3 1  ON 57
ci_059                -1.892117e-03 3 1  ON 58
ci_060                -2.081037e-03 3 1  ON 59
ci_061                -1.839954e-03 3 1  ON 60
ci_062                -1.917106e-03 3 1  ON 61
ci_063                -1.942373e-03 3 1  ON 62
ci_064                -9.418118e-04 3 1  ON 63
ci_065                -1.763516e-03 3 1  ON 64
ci_066                -1.417353e-03 3 1  ON 65
ci_067                -1.965476e-03 3 1  ON 66
ci_068                -1.528184e-03 3 1  ON 67
ci_069                 1.160874e-03 3 1  ON 68
ci_070                 1.597973e-03 3 1  ON 69
ci_071                 1.908102e-05 3 1  ON 70
ci_072                -2.575656e-04 3 1  ON 71
ci_073                 1.366647e-03 3 1  ON 72
ci_074                 8.912926e-04 3 1  ON 73
ci_075                -1.333923e-03 3 1  ON 74
ci_076                -7.291263e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4567e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2301e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.3665
    reference variance = 2.43763
====================================================
  Execution time = 2.3805e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0349e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7221e+00
  Total weights = 1.949551753e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8184e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776669789944
                                         uncertainty =       0.036641166480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776669789944
                                         uncertainty =       0.036641166480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374003697
  error estimate for blocks of size 2^( 2) =       0.001444485063
  error estimate for blocks of size 2^( 3) =       0.001508331166
  error estimate for blocks of size 2^( 4) =       0.001551681479
  error estimate for blocks of size 2^( 5) =       0.001579512893
  error estimate for blocks of size 2^( 6) =       0.001590659012
  error estimate for blocks of size 2^( 7) =       0.001589679623

      target function =                  N/A
              le_mean =     -22.327508922309
             les_mean =     502.239734462747
             stat err =       0.001577883252
             autocorr =       1.318784791553
              std dev =       1.943165753439
             le_variance =       3.775893145338


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232750892231e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+05, overlap shift 2.1684e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327508921545       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327508921603       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327508921603       residual = 4.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+05 is 1.761579e-09

solving harmonic davidson linear method for identity shift 8.6736e+05, overlap shift 8.6736e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327508921545       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327508921560       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327508921560       residual = 4.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+05 is 4.403951e-10

solving harmonic davidson linear method for identity shift 3.4694e+06, overlap shift 3.4694e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327508921545       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327508921549       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327508921549       residual = 4.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+06 is 1.100988e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112040 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9630e+01
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604134e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181058e-02 3 1  ON 6
ci_008                 3.146459e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551354e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257806e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969145e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062702e-02 3 1  ON 18
ci_020                 1.043514e-02 3 1  ON 19
ci_021                -9.780142e-03 3 1  ON 20
ci_022                -9.447965e-03 3 1  ON 21
ci_023                 8.747093e-03 3 1  ON 22
ci_024                 9.498612e-03 3 1  ON 23
ci_025                 7.145537e-03 3 1  ON 24
ci_026                 8.158015e-03 3 1  ON 25
ci_027                 7.925403e-03 3 1  ON 26
ci_028                 7.865112e-03 3 1  ON 27
ci_029                -7.651959e-03 3 1  ON 28
ci_030                -7.767639e-03 3 1  ON 29
ci_031                -7.191462e-03 3 1  ON 30
ci_032                -7.558603e-03 3 1  ON 31
ci_033                 6.846947e-03 3 1  ON 32
ci_034                 6.331896e-03 3 1  ON 33
ci_035                 6.422698e-03 3 1  ON 34
ci_036                 6.953427e-03 3 1  ON 35
ci_037                 6.517871e-03 3 1  ON 36
ci_038                 5.614234e-03 3 1  ON 37
ci_039                 5.905388e-03 3 1  ON 38
ci_040                 6.142293e-03 3 1  ON 39
ci_041                 5.432226e-03 3 1  ON 40
ci_042                 5.115319e-03 3 1  ON 41
ci_043                 5.093137e-03 3 1  ON 42
ci_044                 4.460071e-03 3 1  ON 43
ci_045                 5.122754e-03 3 1  ON 44
ci_046                 5.280789e-03 3 1  ON 45
ci_047                -3.977033e-03 3 1  ON 46
ci_048                -4.395077e-03 3 1  ON 47
ci_049                 4.051678e-03 3 1  ON 48
ci_050                 3.469472e-03 3 1  ON 49
ci_051                -3.068503e-03 3 1  ON 50
ci_052                -2.205009e-03 3 1  ON 51
ci_053                -2.741971e-03 3 1  ON 52
ci_054                -3.446672e-03 3 1  ON 53
ci_055                -1.934038e-03 3 1  ON 54
ci_056                -2.000752e-03 3 1  ON 55
ci_057                -1.788169e-03 3 1  ON 56
ci_058                -1.820667e-03 3 1  ON 57
ci_059                -1.892117e-03 3 1  ON 58
ci_060                -2.081037e-03 3 1  ON 59
ci_061                -1.839954e-03 3 1  ON 60
ci_062                -1.917106e-03 3 1  ON 61
ci_063                -1.942372e-03 3 1  ON 62
ci_064                -9.418120e-04 3 1  ON 63
ci_065                -1.763515e-03 3 1  ON 64
ci_066                -1.417352e-03 3 1  ON 65
ci_067                -1.965476e-03 3 1  ON 66
ci_068                -1.528184e-03 3 1  ON 67
ci_069                 1.160874e-03 3 1  ON 68
ci_070                 1.597973e-03 3 1  ON 69
ci_071                 1.908092e-05 3 1  ON 70
ci_072                -2.575656e-04 3 1  ON 71
ci_073                 1.366647e-03 3 1  ON 72
ci_074                 8.912930e-04 3 1  ON 73
ci_075                -1.333923e-03 3 1  ON 74
ci_076                -7.291264e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.2642
    reference variance = 4.0344
====================================================
  Execution time = 2.3140e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7642e+00
  Total weights = 1.9498e+06
  Execution time = 4.3218e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815123540832
                                         uncertainty =       0.038483852608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815123540832
                                         uncertainty =       0.038483852608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380954102
  error estimate for blocks of size 2^( 2) =       0.001452946334
  error estimate for blocks of size 2^( 3) =       0.001514763198
  error estimate for blocks of size 2^( 4) =       0.001555311852
  error estimate for blocks of size 2^( 5) =       0.001579770152
  error estimate for blocks of size 2^( 6) =       0.001587890619
  error estimate for blocks of size 2^( 7) =       0.001593940446

      target function =                  N/A
              le_mean =     -22.325229606257
             les_mean =     502.180076551626
             stat err =       0.001579228267
             autocorr =       1.307769876159
              std dev =       1.952995266556
             le_variance =       3.814190511189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815123540485
                                         uncertainty =       0.038483852596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815123540485
                                         uncertainty =       0.038483852596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380954101
  error estimate for blocks of size 2^( 2) =       0.001452946334
  error estimate for blocks of size 2^( 3) =       0.001514763198
  error estimate for blocks of size 2^( 4) =       0.001555311852
  error estimate for blocks of size 2^( 5) =       0.001579770151
  error estimate for blocks of size 2^( 6) =       0.001587890619
  error estimate for blocks of size 2^( 7) =       0.001593940446

      target function =                  N/A
              le_mean =     -22.325229606264
             les_mean =     502.180076551968
             stat err =       0.001579228267
             autocorr =       1.307769876190
              std dev =       1.952995266468
             le_variance =       3.814190510845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815123540659
                                         uncertainty =       0.038483852602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815123540659
                                         uncertainty =       0.038483852602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380954101
  error estimate for blocks of size 2^( 2) =       0.001452946334
  error estimate for blocks of size 2^( 3) =       0.001514763198
  error estimate for blocks of size 2^( 4) =       0.001555311852
  error estimate for blocks of size 2^( 5) =       0.001579770151
  error estimate for blocks of size 2^( 6) =       0.001587890619
  error estimate for blocks of size 2^( 7) =       0.001593940446

      target function =                  N/A
              le_mean =     -22.325229606260
             les_mean =     502.180076551797
             stat err =       0.001579228267
             autocorr =       1.307769876174
              std dev =       1.952995266512
             le_variance =       3.814190511017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815123540810
                                         uncertainty =       0.038483852607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815123540810
                                         uncertainty =       0.038483852607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380954102
  error estimate for blocks of size 2^( 2) =       0.001452946334
  error estimate for blocks of size 2^( 3) =       0.001514763198
  error estimate for blocks of size 2^( 4) =       0.001555311852
  error estimate for blocks of size 2^( 5) =       0.001579770152
  error estimate for blocks of size 2^( 6) =       0.001587890619
  error estimate for blocks of size 2^( 7) =       0.001593940446

      target function =                  N/A
              le_mean =     -22.325229606257
             les_mean =     502.180076551647
             stat err =       0.001579228267
             autocorr =       1.307769876161
              std dev =       1.952995266550
             le_variance =       3.814190511168


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325229606257        initial
     2.1684e+05     2.1684e+06             1.7616e-09       -22.325229606264  <--
     8.6736e+05     8.6736e+06             4.4040e-10       -22.325229606260
     3.4694e+06     3.4694e+07             1.1010e-10       -22.325229606257

*****************************************************************************
Applying the update for shift_i =   2.1684e+05     and shift_s =   2.1684e+06
*****************************************************************************

  Execution time = 4.4849e+01
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604134e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181059e-02 3 1  ON 6
ci_008                 3.146458e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551354e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257806e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969145e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062702e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780142e-03 3 1  ON 20
ci_022                -9.447966e-03 3 1  ON 21
ci_023                 8.747094e-03 3 1  ON 22
ci_024                 9.498612e-03 3 1  ON 23
ci_025                 7.145536e-03 3 1  ON 24
ci_026                 8.158015e-03 3 1  ON 25
ci_027                 7.925403e-03 3 1  ON 26
ci_028                 7.865113e-03 3 1  ON 27
ci_029                -7.651959e-03 3 1  ON 28
ci_030                -7.767640e-03 3 1  ON 29
ci_031                -7.191462e-03 3 1  ON 30
ci_032                -7.558602e-03 3 1  ON 31
ci_033                 6.846946e-03 3 1  ON 32
ci_034                 6.331897e-03 3 1  ON 33
ci_035                 6.422698e-03 3 1  ON 34
ci_036                 6.953427e-03 3 1  ON 35
ci_037                 6.517872e-03 3 1  ON 36
ci_038                 5.614235e-03 3 1  ON 37
ci_039                 5.905389e-03 3 1  ON 38
ci_040                 6.142293e-03 3 1  ON 39
ci_041                 5.432226e-03 3 1  ON 40
ci_042                 5.115319e-03 3 1  ON 41
ci_043                 5.093138e-03 3 1  ON 42
ci_044                 4.460070e-03 3 1  ON 43
ci_045                 5.122754e-03 3 1  ON 44
ci_046                 5.280789e-03 3 1  ON 45
ci_047                -3.977034e-03 3 1  ON 46
ci_048                -4.395076e-03 3 1  ON 47
ci_049                 4.051679e-03 3 1  ON 48
ci_050                 3.469472e-03 3 1  ON 49
ci_051                -3.068504e-03 3 1  ON 50
ci_052                -2.205009e-03 3 1  ON 51
ci_053                -2.741970e-03 3 1  ON 52
ci_054                -3.446671e-03 3 1  ON 53
ci_055                -1.934038e-03 3 1  ON 54
ci_056                -2.000752e-03 3 1  ON 55
ci_057                -1.788167e-03 3 1  ON 56
ci_058                -1.820666e-03 3 1  ON 57
ci_059                -1.892117e-03 3 1  ON 58
ci_060                -2.081037e-03 3 1  ON 59
ci_061                -1.839955e-03 3 1  ON 60
ci_062                -1.917106e-03 3 1  ON 61
ci_063                -1.942371e-03 3 1  ON 62
ci_064                -9.418124e-04 3 1  ON 63
ci_065                -1.763515e-03 3 1  ON 64
ci_066                -1.417351e-03 3 1  ON 65
ci_067                -1.965476e-03 3 1  ON 66
ci_068                -1.528184e-03 3 1  ON 67
ci_069                 1.160874e-03 3 1  ON 68
ci_070                 1.597974e-03 3 1  ON 69
ci_071                 1.908060e-05 3 1  ON 70
ci_072                -2.575656e-04 3 1  ON 71
ci_073                 1.366646e-03 3 1  ON 72
ci_074                 8.912939e-04 3 1  ON 73
ci_075                -1.333924e-03 3 1  ON 74
ci_076                -7.291268e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4490e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2302e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.4728
    reference variance = 2.11804
====================================================
  Execution time = 2.3784e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0309e+04
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.7752e+00
  Total weights = 1.950019795e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8428e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830006759315
                                         uncertainty =       0.056960266778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830006759315
                                         uncertainty =       0.056960266778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383696335
  error estimate for blocks of size 2^( 2) =       0.001453099822
  error estimate for blocks of size 2^( 3) =       0.001514477478
  error estimate for blocks of size 2^( 4) =       0.001556444584
  error estimate for blocks of size 2^( 5) =       0.001582861640
  error estimate for blocks of size 2^( 6) =       0.001591997519
  error estimate for blocks of size 2^( 7) =       0.001600268327

      target function =                  N/A
              le_mean =     -22.330684740910
             les_mean =     502.434682325852
             stat err =       0.001582893018
             autocorr =       1.308644081480
              std dev =       1.956873432533
             le_variance =       3.829353630955


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233068474091e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+04, overlap shift 5.4210e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330684740111       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330684740400       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330684740400       residual = 2.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+04 is 6.970320e-09

solving harmonic davidson linear method for identity shift 2.1684e+05, overlap shift 2.1684e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330684740111       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330684740183       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330684740183       residual = 2.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+05 is 1.742586e-09

solving harmonic davidson linear method for identity shift 8.6736e+05, overlap shift 8.6736e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330684740111       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330684740129       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330684740129       residual = 2.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+05 is 4.356469e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113214 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9633e+01
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604134e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181059e-02 3 1  ON 6
ci_008                 3.146458e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551354e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257806e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969145e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062702e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780142e-03 3 1  ON 20
ci_022                -9.447968e-03 3 1  ON 21
ci_023                 8.747093e-03 3 1  ON 22
ci_024                 9.498612e-03 3 1  ON 23
ci_025                 7.145537e-03 3 1  ON 24
ci_026                 8.158014e-03 3 1  ON 25
ci_027                 7.925404e-03 3 1  ON 26
ci_028                 7.865113e-03 3 1  ON 27
ci_029                -7.651960e-03 3 1  ON 28
ci_030                -7.767640e-03 3 1  ON 29
ci_031                -7.191463e-03 3 1  ON 30
ci_032                -7.558603e-03 3 1  ON 31
ci_033                 6.846947e-03 3 1  ON 32
ci_034                 6.331898e-03 3 1  ON 33
ci_035                 6.422698e-03 3 1  ON 34
ci_036                 6.953427e-03 3 1  ON 35
ci_037                 6.517870e-03 3 1  ON 36
ci_038                 5.614236e-03 3 1  ON 37
ci_039                 5.905389e-03 3 1  ON 38
ci_040                 6.142292e-03 3 1  ON 39
ci_041                 5.432225e-03 3 1  ON 40
ci_042                 5.115318e-03 3 1  ON 41
ci_043                 5.093138e-03 3 1  ON 42
ci_044                 4.460071e-03 3 1  ON 43
ci_045                 5.122753e-03 3 1  ON 44
ci_046                 5.280790e-03 3 1  ON 45
ci_047                -3.977034e-03 3 1  ON 46
ci_048                -4.395076e-03 3 1  ON 47
ci_049                 4.051678e-03 3 1  ON 48
ci_050                 3.469472e-03 3 1  ON 49
ci_051                -3.068503e-03 3 1  ON 50
ci_052                -2.205010e-03 3 1  ON 51
ci_053                -2.741971e-03 3 1  ON 52
ci_054                -3.446670e-03 3 1  ON 53
ci_055                -1.934039e-03 3 1  ON 54
ci_056                -2.000753e-03 3 1  ON 55
ci_057                -1.788168e-03 3 1  ON 56
ci_058                -1.820666e-03 3 1  ON 57
ci_059                -1.892117e-03 3 1  ON 58
ci_060                -2.081035e-03 3 1  ON 59
ci_061                -1.839954e-03 3 1  ON 60
ci_062                -1.917106e-03 3 1  ON 61
ci_063                -1.942370e-03 3 1  ON 62
ci_064                -9.418113e-04 3 1  ON 63
ci_065                -1.763515e-03 3 1  ON 64
ci_066                -1.417351e-03 3 1  ON 65
ci_067                -1.965476e-03 3 1  ON 66
ci_068                -1.528185e-03 3 1  ON 67
ci_069                 1.160874e-03 3 1  ON 68
ci_070                 1.597974e-03 3 1  ON 69
ci_071                 1.908099e-05 3 1  ON 70
ci_072                -2.575659e-04 3 1  ON 71
ci_073                 1.366645e-03 3 1  ON 72
ci_074                 8.912940e-04 3 1  ON 73
ci_075                -1.333922e-03 3 1  ON 74
ci_076                -7.291265e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.6173
    reference variance = 2.45547
====================================================
  Execution time = 2.3165e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8588e+00
  Total weights = 1.9499e+06
  Execution time = 4.3262e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.910287464692
                                         uncertainty =       0.149575471166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.910287464692
                                         uncertainty =       0.149575471166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001398048427
  error estimate for blocks of size 2^( 2) =       0.001467119570
  error estimate for blocks of size 2^( 3) =       0.001528444764
  error estimate for blocks of size 2^( 4) =       0.001569155426
  error estimate for blocks of size 2^( 5) =       0.001590676452
  error estimate for blocks of size 2^( 6) =       0.001606979888
  error estimate for blocks of size 2^( 7) =       0.001618109448

      target function =                  N/A
              le_mean =     -22.327625383888
             les_mean =     502.381625982819
             stat err =       0.001596230304
             autocorr =       1.303606966028
              std dev =       1.977170680172
             le_variance =       3.909203898531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.910287465098
                                         uncertainty =       0.149575471205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.910287465098
                                         uncertainty =       0.149575471205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001398048427
  error estimate for blocks of size 2^( 2) =       0.001467119570
  error estimate for blocks of size 2^( 3) =       0.001528444764
  error estimate for blocks of size 2^( 4) =       0.001569155426
  error estimate for blocks of size 2^( 5) =       0.001590676452
  error estimate for blocks of size 2^( 6) =       0.001606979887
  error estimate for blocks of size 2^( 7) =       0.001618109448

      target function =                  N/A
              le_mean =     -22.327625384004
             les_mean =     502.381625984570
             stat err =       0.001596230304
             autocorr =       1.303606965600
              std dev =       1.977170680279
             le_variance =       3.909203898955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.910287464895
                                         uncertainty =       0.149575471185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.910287464895
                                         uncertainty =       0.149575471185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001398048427
  error estimate for blocks of size 2^( 2) =       0.001467119570
  error estimate for blocks of size 2^( 3) =       0.001528444764
  error estimate for blocks of size 2^( 4) =       0.001569155426
  error estimate for blocks of size 2^( 5) =       0.001590676452
  error estimate for blocks of size 2^( 6) =       0.001606979888
  error estimate for blocks of size 2^( 7) =       0.001618109448

      target function =                  N/A
              le_mean =     -22.327625383946
             les_mean =     502.381625983694
             stat err =       0.001596230304
             autocorr =       1.303606965814
              std dev =       1.977170680225
             le_variance =       3.909203898743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.910287464717
                                         uncertainty =       0.149575471168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.910287464717
                                         uncertainty =       0.149575471168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001398048427
  error estimate for blocks of size 2^( 2) =       0.001467119570
  error estimate for blocks of size 2^( 3) =       0.001528444764
  error estimate for blocks of size 2^( 4) =       0.001569155426
  error estimate for blocks of size 2^( 5) =       0.001590676452
  error estimate for blocks of size 2^( 6) =       0.001606979888
  error estimate for blocks of size 2^( 7) =       0.001618109448

      target function =                  N/A
              le_mean =     -22.327625383895
             les_mean =     502.381625982929
             stat err =       0.001596230304
             autocorr =       1.303606966001
              std dev =       1.977170680179
             le_variance =       3.909203898558


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327625383888        initial
     5.4210e+04     5.4210e+05             6.9703e-09       -22.327625384004  <--
     2.1684e+05     2.1684e+06             1.7426e-09       -22.327625383946
     8.6736e+05     8.6736e+06             4.3565e-10       -22.327625383895

*****************************************************************************
Applying the update for shift_i =   5.4210e+04     and shift_s =   5.4210e+05
*****************************************************************************

  Execution time = 4.7052e+01
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604134e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181059e-02 3 1  ON 6
ci_008                 3.146458e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551353e-02 3 1  ON 9
ci_011                -2.288316e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969145e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537572e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062702e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780144e-03 3 1  ON 20
ci_022                -9.447972e-03 3 1  ON 21
ci_023                 8.747091e-03 3 1  ON 22
ci_024                 9.498613e-03 3 1  ON 23
ci_025                 7.145539e-03 3 1  ON 24
ci_026                 8.158011e-03 3 1  ON 25
ci_027                 7.925405e-03 3 1  ON 26
ci_028                 7.865114e-03 3 1  ON 27
ci_029                -7.651965e-03 3 1  ON 28
ci_030                -7.767641e-03 3 1  ON 29
ci_031                -7.191465e-03 3 1  ON 30
ci_032                -7.558604e-03 3 1  ON 31
ci_033                 6.846948e-03 3 1  ON 32
ci_034                 6.331901e-03 3 1  ON 33
ci_035                 6.422698e-03 3 1  ON 34
ci_036                 6.953427e-03 3 1  ON 35
ci_037                 6.517867e-03 3 1  ON 36
ci_038                 5.614239e-03 3 1  ON 37
ci_039                 5.905389e-03 3 1  ON 38
ci_040                 6.142291e-03 3 1  ON 39
ci_041                 5.432224e-03 3 1  ON 40
ci_042                 5.115316e-03 3 1  ON 41
ci_043                 5.093140e-03 3 1  ON 42
ci_044                 4.460074e-03 3 1  ON 43
ci_045                 5.122752e-03 3 1  ON 44
ci_046                 5.280791e-03 3 1  ON 45
ci_047                -3.977036e-03 3 1  ON 46
ci_048                -4.395075e-03 3 1  ON 47
ci_049                 4.051677e-03 3 1  ON 48
ci_050                 3.469474e-03 3 1  ON 49
ci_051                -3.068502e-03 3 1  ON 50
ci_052                -2.205011e-03 3 1  ON 51
ci_053                -2.741972e-03 3 1  ON 52
ci_054                -3.446668e-03 3 1  ON 53
ci_055                -1.934043e-03 3 1  ON 54
ci_056                -2.000756e-03 3 1  ON 55
ci_057                -1.788168e-03 3 1  ON 56
ci_058                -1.820667e-03 3 1  ON 57
ci_059                -1.892116e-03 3 1  ON 58
ci_060                -2.081030e-03 3 1  ON 59
ci_061                -1.839953e-03 3 1  ON 60
ci_062                -1.917108e-03 3 1  ON 61
ci_063                -1.942368e-03 3 1  ON 62
ci_064                -9.418078e-04 3 1  ON 63
ci_065                -1.763515e-03 3 1  ON 64
ci_066                -1.417350e-03 3 1  ON 65
ci_067                -1.965476e-03 3 1  ON 66
ci_068                -1.528187e-03 3 1  ON 67
ci_069                 1.160873e-03 3 1  ON 68
ci_070                 1.597974e-03 3 1  ON 69
ci_071                 1.908215e-05 3 1  ON 70
ci_072                -2.575668e-04 3 1  ON 71
ci_073                 1.366640e-03 3 1  ON 72
ci_074                 8.912942e-04 3 1  ON 73
ci_075                -1.333917e-03 3 1  ON 74
ci_076                -7.291257e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6694e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2306e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.0925
    reference variance = 4.61156
====================================================
  Execution time = 2.3830e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0299e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7424e+00
  Total weights = 1.949626038e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9013e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794530638566
                                         uncertainty =       0.034204429648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794530638566
                                         uncertainty =       0.034204429648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377204596
  error estimate for blocks of size 2^( 2) =       0.001447754495
  error estimate for blocks of size 2^( 3) =       0.001510317067
  error estimate for blocks of size 2^( 4) =       0.001554504972
  error estimate for blocks of size 2^( 5) =       0.001580969665
  error estimate for blocks of size 2^( 6) =       0.001596663988
  error estimate for blocks of size 2^( 7) =       0.001608989874

      target function =                  N/A
              le_mean =     -22.330308959978
             les_mean =     502.385119675492
             stat err =       0.001585282124
             autocorr =       1.325000977483
              std dev =       1.947692579605
             le_variance =       3.793506384647


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233030895998e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+04, overlap shift 1.3553e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330308959137       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330308960433       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330308960473       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3553e+04 is 5.511374e-08

solving harmonic davidson linear method for identity shift 5.4210e+04, overlap shift 5.4210e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330308959137       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330308959461       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330308959471       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+04 is 1.377868e-08

solving harmonic davidson linear method for identity shift 2.1684e+05, overlap shift 2.1684e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330308959137       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330308959218       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330308959220       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+05 is 3.444686e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.114403 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9738e+01
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604134e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181059e-02 3 1  ON 6
ci_008                 3.146459e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551353e-02 3 1  ON 9
ci_011                -2.288316e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969146e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062702e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780147e-03 3 1  ON 20
ci_022                -9.447977e-03 3 1  ON 21
ci_023                 8.747089e-03 3 1  ON 22
ci_024                 9.498609e-03 3 1  ON 23
ci_025                 7.145548e-03 3 1  ON 24
ci_026                 8.158010e-03 3 1  ON 25
ci_027                 7.925403e-03 3 1  ON 26
ci_028                 7.865114e-03 3 1  ON 27
ci_029                -7.651967e-03 3 1  ON 28
ci_030                -7.767639e-03 3 1  ON 29
ci_031                -7.191466e-03 3 1  ON 30
ci_032                -7.558600e-03 3 1  ON 31
ci_033                 6.846952e-03 3 1  ON 32
ci_034                 6.331902e-03 3 1  ON 33
ci_035                 6.422697e-03 3 1  ON 34
ci_036                 6.953429e-03 3 1  ON 35
ci_037                 6.517864e-03 3 1  ON 36
ci_038                 5.614244e-03 3 1  ON 37
ci_039                 5.905375e-03 3 1  ON 38
ci_040                 6.142292e-03 3 1  ON 39
ci_041                 5.432221e-03 3 1  ON 40
ci_042                 5.115317e-03 3 1  ON 41
ci_043                 5.093138e-03 3 1  ON 42
ci_044                 4.460071e-03 3 1  ON 43
ci_045                 5.122744e-03 3 1  ON 44
ci_046                 5.280788e-03 3 1  ON 45
ci_047                -3.977035e-03 3 1  ON 46
ci_048                -4.395073e-03 3 1  ON 47
ci_049                 4.051676e-03 3 1  ON 48
ci_050                 3.469476e-03 3 1  ON 49
ci_051                -3.068505e-03 3 1  ON 50
ci_052                -2.205013e-03 3 1  ON 51
ci_053                -2.741973e-03 3 1  ON 52
ci_054                -3.446671e-03 3 1  ON 53
ci_055                -1.934045e-03 3 1  ON 54
ci_056                -2.000754e-03 3 1  ON 55
ci_057                -1.788168e-03 3 1  ON 56
ci_058                -1.820668e-03 3 1  ON 57
ci_059                -1.892118e-03 3 1  ON 58
ci_060                -2.081028e-03 3 1  ON 59
ci_061                -1.839951e-03 3 1  ON 60
ci_062                -1.917113e-03 3 1  ON 61
ci_063                -1.942360e-03 3 1  ON 62
ci_064                -9.418123e-04 3 1  ON 63
ci_065                -1.763515e-03 3 1  ON 64
ci_066                -1.417348e-03 3 1  ON 65
ci_067                -1.965477e-03 3 1  ON 66
ci_068                -1.528182e-03 3 1  ON 67
ci_069                 1.160873e-03 3 1  ON 68
ci_070                 1.597970e-03 3 1  ON 69
ci_071                 1.907314e-05 3 1  ON 70
ci_072                -2.575693e-04 3 1  ON 71
ci_073                 1.366638e-03 3 1  ON 72
ci_074                 8.913001e-04 3 1  ON 73
ci_075                -1.333921e-03 3 1  ON 74
ci_076                -7.291292e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.2381
    reference variance = 3.45716
====================================================
  Execution time = 2.3143e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.8071e+00
  Total weights = 1.9498e+06
  Execution time = 4.3557e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.862272126027
                                         uncertainty =       0.060195154024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.862272126027
                                         uncertainty =       0.060195154024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389467664
  error estimate for blocks of size 2^( 2) =       0.001459783339
  error estimate for blocks of size 2^( 3) =       0.001520160181
  error estimate for blocks of size 2^( 4) =       0.001564447113
  error estimate for blocks of size 2^( 5) =       0.001594924996
  error estimate for blocks of size 2^( 6) =       0.001609212965
  error estimate for blocks of size 2^( 7) =       0.001618722677

      target function =                  N/A
              le_mean =     -22.326433607948
             les_mean =     502.276739624774
             stat err =       0.001596826938
             autocorr =       1.320744504426
              std dev =       1.965035454754
             le_variance =       3.861364338440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.862272118410
                                         uncertainty =       0.060195153993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.862272118410
                                         uncertainty =       0.060195153993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389467663
  error estimate for blocks of size 2^( 2) =       0.001459783338
  error estimate for blocks of size 2^( 3) =       0.001520160182
  error estimate for blocks of size 2^( 4) =       0.001564447114
  error estimate for blocks of size 2^( 5) =       0.001594924997
  error estimate for blocks of size 2^( 6) =       0.001609212967
  error estimate for blocks of size 2^( 7) =       0.001618722678

      target function =                  N/A
              le_mean =     -22.326433607809
             les_mean =     502.276739627765
             stat err =       0.001596826939
             autocorr =       1.320744509229
              std dev =       1.965035452802
             le_variance =       3.861364330769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.862272122218
                                         uncertainty =       0.060195154008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.862272122218
                                         uncertainty =       0.060195154008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389467663
  error estimate for blocks of size 2^( 2) =       0.001459783339
  error estimate for blocks of size 2^( 3) =       0.001520160182
  error estimate for blocks of size 2^( 4) =       0.001564447114
  error estimate for blocks of size 2^( 5) =       0.001594924997
  error estimate for blocks of size 2^( 6) =       0.001609212966
  error estimate for blocks of size 2^( 7) =       0.001618722678

      target function =                  N/A
              le_mean =     -22.326433607878
             les_mean =     502.276739626263
             stat err =       0.001596826938
             autocorr =       1.320744506826
              std dev =       1.965035453778
             le_variance =       3.861364334604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.862272125551
                                         uncertainty =       0.060195154022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.862272125551
                                         uncertainty =       0.060195154022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389467664
  error estimate for blocks of size 2^( 2) =       0.001459783339
  error estimate for blocks of size 2^( 3) =       0.001520160181
  error estimate for blocks of size 2^( 4) =       0.001564447113
  error estimate for blocks of size 2^( 5) =       0.001594924996
  error estimate for blocks of size 2^( 6) =       0.001609212965
  error estimate for blocks of size 2^( 7) =       0.001618722677

      target function =                  N/A
              le_mean =     -22.326433607939
             les_mean =     502.276739624959
             stat err =       0.001596826938
             autocorr =       1.320744504725
              std dev =       1.965035454632
             le_variance =       3.861364337961


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326433607948        initial  <--
     1.3553e+04     1.3553e+05             5.5114e-08       -22.326433607809
     5.4210e+04     5.4210e+05             1.3779e-08       -22.326433607878
     2.1684e+05     2.1684e+06             3.4447e-09       -22.326433607939

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9995
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604134e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181059e-02 3 1  ON 6
ci_008                 3.146458e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551353e-02 3 1  ON 9
ci_011                -2.288316e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969145e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537572e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062702e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780144e-03 3 1  ON 20
ci_022                -9.447972e-03 3 1  ON 21
ci_023                 8.747091e-03 3 1  ON 22
ci_024                 9.498613e-03 3 1  ON 23
ci_025                 7.145539e-03 3 1  ON 24
ci_026                 8.158011e-03 3 1  ON 25
ci_027                 7.925405e-03 3 1  ON 26
ci_028                 7.865114e-03 3 1  ON 27
ci_029                -7.651965e-03 3 1  ON 28
ci_030                -7.767641e-03 3 1  ON 29
ci_031                -7.191465e-03 3 1  ON 30
ci_032                -7.558604e-03 3 1  ON 31
ci_033                 6.846948e-03 3 1  ON 32
ci_034                 6.331901e-03 3 1  ON 33
ci_035                 6.422698e-03 3 1  ON 34
ci_036                 6.953427e-03 3 1  ON 35
ci_037                 6.517867e-03 3 1  ON 36
ci_038                 5.614239e-03 3 1  ON 37
ci_039                 5.905389e-03 3 1  ON 38
ci_040                 6.142291e-03 3 1  ON 39
ci_041                 5.432224e-03 3 1  ON 40
ci_042                 5.115316e-03 3 1  ON 41
ci_043                 5.093140e-03 3 1  ON 42
ci_044                 4.460074e-03 3 1  ON 43
ci_045                 5.122752e-03 3 1  ON 44
ci_046                 5.280791e-03 3 1  ON 45
ci_047                -3.977036e-03 3 1  ON 46
ci_048                -4.395075e-03 3 1  ON 47
ci_049                 4.051677e-03 3 1  ON 48
ci_050                 3.469474e-03 3 1  ON 49
ci_051                -3.068502e-03 3 1  ON 50
ci_052                -2.205011e-03 3 1  ON 51
ci_053                -2.741972e-03 3 1  ON 52
ci_054                -3.446668e-03 3 1  ON 53
ci_055                -1.934043e-03 3 1  ON 54
ci_056                -2.000756e-03 3 1  ON 55
ci_057                -1.788168e-03 3 1  ON 56
ci_058                -1.820667e-03 3 1  ON 57
ci_059                -1.892116e-03 3 1  ON 58
ci_060                -2.081030e-03 3 1  ON 59
ci_061                -1.839953e-03 3 1  ON 60
ci_062                -1.917108e-03 3 1  ON 61
ci_063                -1.942368e-03 3 1  ON 62
ci_064                -9.418078e-04 3 1  ON 63
ci_065                -1.763515e-03 3 1  ON 64
ci_066                -1.417350e-03 3 1  ON 65
ci_067                -1.965476e-03 3 1  ON 66
ci_068                -1.528187e-03 3 1  ON 67
ci_069                 1.160873e-03 3 1  ON 68
ci_070                 1.597974e-03 3 1  ON 69
ci_071                 1.908215e-05 3 1  ON 70
ci_072                -2.575668e-04 3 1  ON 71
ci_073                 1.366640e-03 3 1  ON 72
ci_074                 8.912942e-04 3 1  ON 73
ci_075                -1.333917e-03 3 1  ON 74
ci_076                -7.291257e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4746e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2303e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -21.9368
    reference variance = 5.84746
====================================================
  Execution time = 2.3731e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0330e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7641e+00
  Total weights = 1.949902348e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8785e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814037644829
                                         uncertainty =       0.043709925550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814037644829
                                         uncertainty =       0.043709925550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381188399
  error estimate for blocks of size 2^( 2) =       0.001451901921
  error estimate for blocks of size 2^( 3) =       0.001514534027
  error estimate for blocks of size 2^( 4) =       0.001557724068
  error estimate for blocks of size 2^( 5) =       0.001583406311
  error estimate for blocks of size 2^( 6) =       0.001599706413
  error estimate for blocks of size 2^( 7) =       0.001612541784

      target function =                  N/A
              le_mean =     -22.328458415290
             les_mean =     502.324113045346
             stat err =       0.001588344644
             autocorr =       1.322463339581
              std dev =       1.953326619172
             le_variance =       3.815484881168


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232845841529e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+05, overlap shift 1.3553e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328458414469       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328458414584       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328458414586       residual = 7.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3553e+05 is 4.129719e-09

solving harmonic davidson linear method for identity shift 5.4210e+05, overlap shift 5.4210e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328458414469       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328458414498       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328458414498       residual = 7.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+05 is 1.032431e-09

solving harmonic davidson linear method for identity shift 2.1684e+06, overlap shift 2.1684e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328458414469       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328458414476       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328458414476       residual = 7.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+06 is 2.581078e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115584 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9616e+01
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604134e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181059e-02 3 1  ON 6
ci_008                 3.146459e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551353e-02 3 1  ON 9
ci_011                -2.288316e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969145e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537572e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062702e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780144e-03 3 1  ON 20
ci_022                -9.447972e-03 3 1  ON 21
ci_023                 8.747091e-03 3 1  ON 22
ci_024                 9.498613e-03 3 1  ON 23
ci_025                 7.145539e-03 3 1  ON 24
ci_026                 8.158011e-03 3 1  ON 25
ci_027                 7.925404e-03 3 1  ON 26
ci_028                 7.865115e-03 3 1  ON 27
ci_029                -7.651964e-03 3 1  ON 28
ci_030                -7.767641e-03 3 1  ON 29
ci_031                -7.191465e-03 3 1  ON 30
ci_032                -7.558604e-03 3 1  ON 31
ci_033                 6.846948e-03 3 1  ON 32
ci_034                 6.331901e-03 3 1  ON 33
ci_035                 6.422699e-03 3 1  ON 34
ci_036                 6.953427e-03 3 1  ON 35
ci_037                 6.517866e-03 3 1  ON 36
ci_038                 5.614239e-03 3 1  ON 37
ci_039                 5.905389e-03 3 1  ON 38
ci_040                 6.142290e-03 3 1  ON 39
ci_041                 5.432224e-03 3 1  ON 40
ci_042                 5.115316e-03 3 1  ON 41
ci_043                 5.093140e-03 3 1  ON 42
ci_044                 4.460074e-03 3 1  ON 43
ci_045                 5.122752e-03 3 1  ON 44
ci_046                 5.280791e-03 3 1  ON 45
ci_047                -3.977037e-03 3 1  ON 46
ci_048                -4.395075e-03 3 1  ON 47
ci_049                 4.051676e-03 3 1  ON 48
ci_050                 3.469474e-03 3 1  ON 49
ci_051                -3.068502e-03 3 1  ON 50
ci_052                -2.205012e-03 3 1  ON 51
ci_053                -2.741972e-03 3 1  ON 52
ci_054                -3.446668e-03 3 1  ON 53
ci_055                -1.934043e-03 3 1  ON 54
ci_056                -2.000756e-03 3 1  ON 55
ci_057                -1.788168e-03 3 1  ON 56
ci_058                -1.820666e-03 3 1  ON 57
ci_059                -1.892117e-03 3 1  ON 58
ci_060                -2.081031e-03 3 1  ON 59
ci_061                -1.839953e-03 3 1  ON 60
ci_062                -1.917108e-03 3 1  ON 61
ci_063                -1.942368e-03 3 1  ON 62
ci_064                -9.418080e-04 3 1  ON 63
ci_065                -1.763515e-03 3 1  ON 64
ci_066                -1.417350e-03 3 1  ON 65
ci_067                -1.965476e-03 3 1  ON 66
ci_068                -1.528187e-03 3 1  ON 67
ci_069                 1.160873e-03 3 1  ON 68
ci_070                 1.597974e-03 3 1  ON 69
ci_071                 1.908182e-05 3 1  ON 70
ci_072                -2.575668e-04 3 1  ON 71
ci_073                 1.366640e-03 3 1  ON 72
ci_074                 8.912940e-04 3 1  ON 73
ci_075                -1.333917e-03 3 1  ON 74
ci_076                -7.291258e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.4555
    reference variance = 2.50314
====================================================
  Execution time = 2.3162e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6857e+00
  Total weights = 1.9501e+06
  Execution time = 4.3613e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.736582267064
                                         uncertainty =       0.034837068972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.736582267064
                                         uncertainty =       0.034837068972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366761502
  error estimate for blocks of size 2^( 2) =       0.001437539252
  error estimate for blocks of size 2^( 3) =       0.001500259404
  error estimate for blocks of size 2^( 4) =       0.001543345515
  error estimate for blocks of size 2^( 5) =       0.001570705678
  error estimate for blocks of size 2^( 6) =       0.001584191906
  error estimate for blocks of size 2^( 7) =       0.001592012180

      target function =                  N/A
              le_mean =     -22.330471615944
             les_mean =     502.335626507157
             stat err =       0.001572563820
             autocorr =       1.323826542765
              std dev =       1.932923578753
             le_variance =       3.736193561301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.736582266563
                                         uncertainty =       0.034837068967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.736582266563
                                         uncertainty =       0.034837068967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366761502
  error estimate for blocks of size 2^( 2) =       0.001437539252
  error estimate for blocks of size 2^( 3) =       0.001500259404
  error estimate for blocks of size 2^( 4) =       0.001543345515
  error estimate for blocks of size 2^( 5) =       0.001570705678
  error estimate for blocks of size 2^( 6) =       0.001584191907
  error estimate for blocks of size 2^( 7) =       0.001592012180

      target function =                  N/A
              le_mean =     -22.330471615951
             les_mean =     502.335626505139
             stat err =       0.001572563820
             autocorr =       1.323826543184
              std dev =       1.932923578624
             le_variance =       3.736193560800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.736582266813
                                         uncertainty =       0.034837068969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.736582266813
                                         uncertainty =       0.034837068969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366761502
  error estimate for blocks of size 2^( 2) =       0.001437539252
  error estimate for blocks of size 2^( 3) =       0.001500259404
  error estimate for blocks of size 2^( 4) =       0.001543345515
  error estimate for blocks of size 2^( 5) =       0.001570705678
  error estimate for blocks of size 2^( 6) =       0.001584191907
  error estimate for blocks of size 2^( 7) =       0.001592012180

      target function =                  N/A
              le_mean =     -22.330471615948
             les_mean =     502.335626506148
             stat err =       0.001572563820
             autocorr =       1.323826542974
              std dev =       1.932923578689
             le_variance =       3.736193561050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.736582267032
                                         uncertainty =       0.034837068971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.736582267032
                                         uncertainty =       0.034837068971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366761502
  error estimate for blocks of size 2^( 2) =       0.001437539252
  error estimate for blocks of size 2^( 3) =       0.001500259404
  error estimate for blocks of size 2^( 4) =       0.001543345515
  error estimate for blocks of size 2^( 5) =       0.001570705678
  error estimate for blocks of size 2^( 6) =       0.001584191906
  error estimate for blocks of size 2^( 7) =       0.001592012180

      target function =                  N/A
              le_mean =     -22.330471615945
             les_mean =     502.335626507031
             stat err =       0.001572563820
             autocorr =       1.323826542791
              std dev =       1.932923578745
             le_variance =       3.736193561270


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330471615944        initial
     1.3553e+05     1.3553e+06             4.1297e-09       -22.330471615951  <--
     5.4210e+05     5.4210e+06             1.0324e-09       -22.330471615948
     2.1684e+06     2.1684e+07             2.5811e-10       -22.330471615945

*****************************************************************************
Applying the update for shift_i =   1.3553e+05     and shift_s =   1.3553e+06
*****************************************************************************

  Execution time = 4.5029e+01
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604134e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181059e-02 3 1  ON 6
ci_008                 3.146459e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551353e-02 3 1  ON 9
ci_011                -2.288316e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969145e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537572e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062702e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780144e-03 3 1  ON 20
ci_022                -9.447971e-03 3 1  ON 21
ci_023                 8.747090e-03 3 1  ON 22
ci_024                 9.498613e-03 3 1  ON 23
ci_025                 7.145540e-03 3 1  ON 24
ci_026                 8.158010e-03 3 1  ON 25
ci_027                 7.925403e-03 3 1  ON 26
ci_028                 7.865118e-03 3 1  ON 27
ci_029                -7.651964e-03 3 1  ON 28
ci_030                -7.767640e-03 3 1  ON 29
ci_031                -7.191465e-03 3 1  ON 30
ci_032                -7.558604e-03 3 1  ON 31
ci_033                 6.846946e-03 3 1  ON 32
ci_034                 6.331902e-03 3 1  ON 33
ci_035                 6.422702e-03 3 1  ON 34
ci_036                 6.953427e-03 3 1  ON 35
ci_037                 6.517865e-03 3 1  ON 36
ci_038                 5.614238e-03 3 1  ON 37
ci_039                 5.905389e-03 3 1  ON 38
ci_040                 6.142290e-03 3 1  ON 39
ci_041                 5.432223e-03 3 1  ON 40
ci_042                 5.115316e-03 3 1  ON 41
ci_043                 5.093141e-03 3 1  ON 42
ci_044                 4.460075e-03 3 1  ON 43
ci_045                 5.122750e-03 3 1  ON 44
ci_046                 5.280791e-03 3 1  ON 45
ci_047                -3.977038e-03 3 1  ON 46
ci_048                -4.395074e-03 3 1  ON 47
ci_049                 4.051674e-03 3 1  ON 48
ci_050                 3.469474e-03 3 1  ON 49
ci_051                -3.068502e-03 3 1  ON 50
ci_052                -2.205013e-03 3 1  ON 51
ci_053                -2.741972e-03 3 1  ON 52
ci_054                -3.446666e-03 3 1  ON 53
ci_055                -1.934044e-03 3 1  ON 54
ci_056                -2.000755e-03 3 1  ON 55
ci_057                -1.788168e-03 3 1  ON 56
ci_058                -1.820665e-03 3 1  ON 57
ci_059                -1.892117e-03 3 1  ON 58
ci_060                -2.081033e-03 3 1  ON 59
ci_061                -1.839953e-03 3 1  ON 60
ci_062                -1.917108e-03 3 1  ON 61
ci_063                -1.942368e-03 3 1  ON 62
ci_064                -9.418085e-04 3 1  ON 63
ci_065                -1.763515e-03 3 1  ON 64
ci_066                -1.417350e-03 3 1  ON 65
ci_067                -1.965474e-03 3 1  ON 66
ci_068                -1.528187e-03 3 1  ON 67
ci_069                 1.160872e-03 3 1  ON 68
ci_070                 1.597973e-03 3 1  ON 69
ci_071                 1.908084e-05 3 1  ON 70
ci_072                -2.575669e-04 3 1  ON 71
ci_073                 1.366640e-03 3 1  ON 72
ci_074                 8.912936e-04 3 1  ON 73
ci_075                -1.333917e-03 3 1  ON 74
ci_076                -7.291261e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4654e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2302e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.5033
    reference variance = 3.15
====================================================
  Execution time = 2.3842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0317e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7518e+00
  Total weights = 1.949781996e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8616e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.806108648336
                                         uncertainty =       0.054715822655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.806108648336
                                         uncertainty =       0.054715822655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379425469
  error estimate for blocks of size 2^( 2) =       0.001450115016
  error estimate for blocks of size 2^( 3) =       0.001513141788
  error estimate for blocks of size 2^( 4) =       0.001556344217
  error estimate for blocks of size 2^( 5) =       0.001580437178
  error estimate for blocks of size 2^( 6) =       0.001596036477
  error estimate for blocks of size 2^( 7) =       0.001602507153

      target function =                  N/A
              le_mean =     -22.328687455716
             les_mean =     502.322129962388
             stat err =       0.001583831256
             autocorr =       1.318321509799
              std dev =       1.950833418851
             le_variance =       3.805751028106


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232868745572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+04, overlap shift 3.3881e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328687454914       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328687455487       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328687455491       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e+04 is 1.468879e-08

solving harmonic davidson linear method for identity shift 1.3553e+05, overlap shift 1.3553e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328687454914       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328687455058       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328687455059       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3553e+05 is 3.672209e-09

solving harmonic davidson linear method for identity shift 5.4210e+05, overlap shift 5.4210e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328687454914       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328687454950       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328687454950       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+05 is 9.180531e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116727 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9710e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187502e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604134e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181059e-02 3 1  ON 6
ci_008                 3.146459e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551353e-02 3 1  ON 9
ci_011                -2.288316e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969145e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537572e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062701e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780145e-03 3 1  ON 20
ci_022                -9.447971e-03 3 1  ON 21
ci_023                 8.747091e-03 3 1  ON 22
ci_024                 9.498613e-03 3 1  ON 23
ci_025                 7.145541e-03 3 1  ON 24
ci_026                 8.158011e-03 3 1  ON 25
ci_027                 7.925403e-03 3 1  ON 26
ci_028                 7.865120e-03 3 1  ON 27
ci_029                -7.651963e-03 3 1  ON 28
ci_030                -7.767642e-03 3 1  ON 29
ci_031                -7.191464e-03 3 1  ON 30
ci_032                -7.558606e-03 3 1  ON 31
ci_033                 6.846945e-03 3 1  ON 32
ci_034                 6.331901e-03 3 1  ON 33
ci_035                 6.422701e-03 3 1  ON 34
ci_036                 6.953427e-03 3 1  ON 35
ci_037                 6.517864e-03 3 1  ON 36
ci_038                 5.614241e-03 3 1  ON 37
ci_039                 5.905387e-03 3 1  ON 38
ci_040                 6.142288e-03 3 1  ON 39
ci_041                 5.432223e-03 3 1  ON 40
ci_042                 5.115316e-03 3 1  ON 41
ci_043                 5.093141e-03 3 1  ON 42
ci_044                 4.460075e-03 3 1  ON 43
ci_045                 5.122749e-03 3 1  ON 44
ci_046                 5.280791e-03 3 1  ON 45
ci_047                -3.977036e-03 3 1  ON 46
ci_048                -4.395072e-03 3 1  ON 47
ci_049                 4.051671e-03 3 1  ON 48
ci_050                 3.469474e-03 3 1  ON 49
ci_051                -3.068503e-03 3 1  ON 50
ci_052                -2.205014e-03 3 1  ON 51
ci_053                -2.741972e-03 3 1  ON 52
ci_054                -3.446665e-03 3 1  ON 53
ci_055                -1.934048e-03 3 1  ON 54
ci_056                -2.000756e-03 3 1  ON 55
ci_057                -1.788168e-03 3 1  ON 56
ci_058                -1.820665e-03 3 1  ON 57
ci_059                -1.892119e-03 3 1  ON 58
ci_060                -2.081031e-03 3 1  ON 59
ci_061                -1.839951e-03 3 1  ON 60
ci_062                -1.917110e-03 3 1  ON 61
ci_063                -1.942367e-03 3 1  ON 62
ci_064                -9.418105e-04 3 1  ON 63
ci_065                -1.763516e-03 3 1  ON 64
ci_066                -1.417350e-03 3 1  ON 65
ci_067                -1.965474e-03 3 1  ON 66
ci_068                -1.528185e-03 3 1  ON 67
ci_069                 1.160873e-03 3 1  ON 68
ci_070                 1.597972e-03 3 1  ON 69
ci_071                 1.907879e-05 3 1  ON 70
ci_072                -2.575684e-04 3 1  ON 71
ci_073                 1.366642e-03 3 1  ON 72
ci_074                 8.912941e-04 3 1  ON 73
ci_075                -1.333916e-03 3 1  ON 74
ci_076                -7.291261e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -21.8691
    reference variance = 3.57074
====================================================
  Execution time = 2.3140e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6905e+00
  Total weights = 1.9495e+06
  Execution time = 4.3760e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741181130950
                                         uncertainty =       0.027900128656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741181130950
                                         uncertainty =       0.027900128656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367632231
  error estimate for blocks of size 2^( 2) =       0.001437444850
  error estimate for blocks of size 2^( 3) =       0.001502299482
  error estimate for blocks of size 2^( 4) =       0.001545500019
  error estimate for blocks of size 2^( 5) =       0.001573104930
  error estimate for blocks of size 2^( 6) =       0.001581381751
  error estimate for blocks of size 2^( 7) =       0.001590923778

      target function =                  N/A
              le_mean =     -22.330169509366
             les_mean =     502.326976572825
             stat err =       0.001572727619
             autocorr =       1.322416846001
              std dev =       1.934154994837
             le_variance =       3.740955544054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741181124194
                                         uncertainty =       0.027900128763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741181124194
                                         uncertainty =       0.027900128763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367632230
  error estimate for blocks of size 2^( 2) =       0.001437444849
  error estimate for blocks of size 2^( 3) =       0.001502299481
  error estimate for blocks of size 2^( 4) =       0.001545500018
  error estimate for blocks of size 2^( 5) =       0.001573104929
  error estimate for blocks of size 2^( 6) =       0.001581381750
  error estimate for blocks of size 2^( 7) =       0.001590923777

      target function =                  N/A
              le_mean =     -22.330169509417
             les_mean =     502.326976572876
             stat err =       0.001572727619
             autocorr =       1.322416847254
              std dev =       1.934154993090
             le_variance =       3.740955537294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741181127572
                                         uncertainty =       0.027900128710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741181127572
                                         uncertainty =       0.027900128710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367632230
  error estimate for blocks of size 2^( 2) =       0.001437444850
  error estimate for blocks of size 2^( 3) =       0.001502299481
  error estimate for blocks of size 2^( 4) =       0.001545500018
  error estimate for blocks of size 2^( 5) =       0.001573104929
  error estimate for blocks of size 2^( 6) =       0.001581381751
  error estimate for blocks of size 2^( 7) =       0.001590923777

      target function =                  N/A
              le_mean =     -22.330169509391
             les_mean =     502.326976572847
             stat err =       0.001572727619
             autocorr =       1.322416846627
              std dev =       1.934154993963
             le_variance =       3.740955540674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741181130528
                                         uncertainty =       0.027900128663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741181130528
                                         uncertainty =       0.027900128663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367632231
  error estimate for blocks of size 2^( 2) =       0.001437444850
  error estimate for blocks of size 2^( 3) =       0.001502299482
  error estimate for blocks of size 2^( 4) =       0.001545500019
  error estimate for blocks of size 2^( 5) =       0.001573104930
  error estimate for blocks of size 2^( 6) =       0.001581381751
  error estimate for blocks of size 2^( 7) =       0.001590923778

      target function =                  N/A
              le_mean =     -22.330169509369
             les_mean =     502.326976572828
             stat err =       0.001572727619
             autocorr =       1.322416846079
              std dev =       1.934154994728
             le_variance =       3.740955543631


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330169509366        initial
     3.3881e+04     3.3881e+05             1.4689e-08       -22.330169509417  <--
     1.3553e+05     1.3553e+06             3.6722e-09       -22.330169509391
     5.4210e+05     5.4210e+06             9.1805e-10       -22.330169509369

*****************************************************************************
Applying the update for shift_i =   3.3881e+04     and shift_s =   3.3881e+05
*****************************************************************************

  Execution time = 4.5072e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187502e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604134e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181059e-02 3 1  ON 6
ci_008                 3.146459e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551353e-02 3 1  ON 9
ci_011                -2.288316e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000257e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969145e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572858e-02 3 1  ON 17
ci_019                 1.062701e-02 3 1  ON 18
ci_020                 1.043512e-02 3 1  ON 19
ci_021                -9.780150e-03 3 1  ON 20
ci_022                -9.447971e-03 3 1  ON 21
ci_023                 8.747092e-03 3 1  ON 22
ci_024                 9.498613e-03 3 1  ON 23
ci_025                 7.145545e-03 3 1  ON 24
ci_026                 8.158014e-03 3 1  ON 25
ci_027                 7.925402e-03 3 1  ON 26
ci_028                 7.865126e-03 3 1  ON 27
ci_029                -7.651962e-03 3 1  ON 28
ci_030                -7.767647e-03 3 1  ON 29
ci_031                -7.191459e-03 3 1  ON 30
ci_032                -7.558610e-03 3 1  ON 31
ci_033                 6.846942e-03 3 1  ON 32
ci_034                 6.331897e-03 3 1  ON 33
ci_035                 6.422700e-03 3 1  ON 34
ci_036                 6.953426e-03 3 1  ON 35
ci_037                 6.517862e-03 3 1  ON 36
ci_038                 5.614248e-03 3 1  ON 37
ci_039                 5.905382e-03 3 1  ON 38
ci_040                 6.142283e-03 3 1  ON 39
ci_041                 5.432224e-03 3 1  ON 40
ci_042                 5.115317e-03 3 1  ON 41
ci_043                 5.093141e-03 3 1  ON 42
ci_044                 4.460073e-03 3 1  ON 43
ci_045                 5.122747e-03 3 1  ON 44
ci_046                 5.280790e-03 3 1  ON 45
ci_047                -3.977031e-03 3 1  ON 46
ci_048                -4.395065e-03 3 1  ON 47
ci_049                 4.051662e-03 3 1  ON 48
ci_050                 3.469475e-03 3 1  ON 49
ci_051                -3.068504e-03 3 1  ON 50
ci_052                -2.205016e-03 3 1  ON 51
ci_053                -2.741973e-03 3 1  ON 52
ci_054                -3.446662e-03 3 1  ON 53
ci_055                -1.934059e-03 3 1  ON 54
ci_056                -2.000759e-03 3 1  ON 55
ci_057                -1.788170e-03 3 1  ON 56
ci_058                -1.820662e-03 3 1  ON 57
ci_059                -1.892123e-03 3 1  ON 58
ci_060                -2.081025e-03 3 1  ON 59
ci_061                -1.839947e-03 3 1  ON 60
ci_062                -1.917117e-03 3 1  ON 61
ci_063                -1.942365e-03 3 1  ON 62
ci_064                -9.418166e-04 3 1  ON 63
ci_065                -1.763519e-03 3 1  ON 64
ci_066                -1.417350e-03 3 1  ON 65
ci_067                -1.965472e-03 3 1  ON 66
ci_068                -1.528177e-03 3 1  ON 67
ci_069                 1.160873e-03 3 1  ON 68
ci_070                 1.597971e-03 3 1  ON 69
ci_071                 1.907265e-05 3 1  ON 70
ci_072                -2.575727e-04 3 1  ON 71
ci_073                 1.366646e-03 3 1  ON 72
ci_074                 8.912959e-04 3 1  ON 73
ci_075                -1.333914e-03 3 1  ON 74
ci_076                -7.291260e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4793e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2300e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.6182
    reference variance = 2.60118
====================================================
  Execution time = 2.3740e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0311e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6912e+00
  Total weights = 1.949942225e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8607e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742874917864
                                         uncertainty =       0.026943389167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742874917864
                                         uncertainty =       0.026943389167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367955962
  error estimate for blocks of size 2^( 2) =       0.001437571444
  error estimate for blocks of size 2^( 3) =       0.001502434103
  error estimate for blocks of size 2^( 4) =       0.001547500448
  error estimate for blocks of size 2^( 5) =       0.001571593769
  error estimate for blocks of size 2^( 6) =       0.001591423524
  error estimate for blocks of size 2^( 7) =       0.001598474290

      target function =                  N/A
              le_mean =     -22.327661481620
             les_mean =     502.215661545689
             stat err =       0.001577248008
             autocorr =       1.329400206707
              std dev =       1.934612827215
             le_variance =       3.742726791225


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232766148162e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+03, overlap shift 8.4703e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327661480783       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327661483507       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327661483520       residual = 5.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+03 is 6.727450e-08

solving harmonic davidson linear method for identity shift 3.3881e+04, overlap shift 3.3881e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327661480783       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327661481464       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327661481468       residual = 5.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e+04 is 1.681884e-08

solving harmonic davidson linear method for identity shift 1.3553e+05, overlap shift 1.3553e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327661480783       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327661480954       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327661480954       residual = 5.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3553e+05 is 4.204725e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117934 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9608e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187503e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604133e-02 3 1  ON 4
ci_006                 4.618036e-02 3 1  ON 5
ci_007                 3.181058e-02 3 1  ON 6
ci_008                 3.146460e-02 3 1  ON 7
ci_009                -2.501942e-02 3 1  ON 8
ci_010                -2.551353e-02 3 1  ON 9
ci_011                -2.288316e-02 3 1  ON 10
ci_012                -2.257805e-02 3 1  ON 11
ci_013                 2.000256e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969145e-02 3 1  ON 14
ci_016                 2.073126e-02 3 1  ON 15
ci_017                 1.537572e-02 3 1  ON 16
ci_018                 1.572858e-02 3 1  ON 17
ci_019                 1.062700e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780147e-03 3 1  ON 20
ci_022                -9.447972e-03 3 1  ON 21
ci_023                 8.747097e-03 3 1  ON 22
ci_024                 9.498612e-03 3 1  ON 23
ci_025                 7.145551e-03 3 1  ON 24
ci_026                 8.158009e-03 3 1  ON 25
ci_027                 7.925399e-03 3 1  ON 26
ci_028                 7.865130e-03 3 1  ON 27
ci_029                -7.651958e-03 3 1  ON 28
ci_030                -7.767643e-03 3 1  ON 29
ci_031                -7.191469e-03 3 1  ON 30
ci_032                -7.558610e-03 3 1  ON 31
ci_033                 6.846944e-03 3 1  ON 32
ci_034                 6.331902e-03 3 1  ON 33
ci_035                 6.422699e-03 3 1  ON 34
ci_036                 6.953421e-03 3 1  ON 35
ci_037                 6.517854e-03 3 1  ON 36
ci_038                 5.614254e-03 3 1  ON 37
ci_039                 5.905377e-03 3 1  ON 38
ci_040                 6.142280e-03 3 1  ON 39
ci_041                 5.432209e-03 3 1  ON 40
ci_042                 5.115318e-03 3 1  ON 41
ci_043                 5.093142e-03 3 1  ON 42
ci_044                 4.460071e-03 3 1  ON 43
ci_045                 5.122752e-03 3 1  ON 44
ci_046                 5.280791e-03 3 1  ON 45
ci_047                -3.977037e-03 3 1  ON 46
ci_048                -4.395056e-03 3 1  ON 47
ci_049                 4.051665e-03 3 1  ON 48
ci_050                 3.469473e-03 3 1  ON 49
ci_051                -3.068487e-03 3 1  ON 50
ci_052                -2.205019e-03 3 1  ON 51
ci_053                -2.741971e-03 3 1  ON 52
ci_054                -3.446657e-03 3 1  ON 53
ci_055                -1.934053e-03 3 1  ON 54
ci_056                -2.000761e-03 3 1  ON 55
ci_057                -1.788170e-03 3 1  ON 56
ci_058                -1.820668e-03 3 1  ON 57
ci_059                -1.892128e-03 3 1  ON 58
ci_060                -2.081020e-03 3 1  ON 59
ci_061                -1.839947e-03 3 1  ON 60
ci_062                -1.917118e-03 3 1  ON 61
ci_063                -1.942354e-03 3 1  ON 62
ci_064                -9.418205e-04 3 1  ON 63
ci_065                -1.763523e-03 3 1  ON 64
ci_066                -1.417347e-03 3 1  ON 65
ci_067                -1.965464e-03 3 1  ON 66
ci_068                -1.528182e-03 3 1  ON 67
ci_069                 1.160872e-03 3 1  ON 68
ci_070                 1.597970e-03 3 1  ON 69
ci_071                 1.906439e-05 3 1  ON 70
ci_072                -2.575797e-04 3 1  ON 71
ci_073                 1.366640e-03 3 1  ON 72
ci_074                 8.912968e-04 3 1  ON 73
ci_075                -1.333907e-03 3 1  ON 74
ci_076                -7.291248e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.2776
    reference variance = 3.67857
====================================================
  Execution time = 2.3291e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.6837e+00
  Total weights = 1.9499e+06
  Execution time = 4.3673e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730051186851
                                         uncertainty =       0.029926565750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730051186851
                                         uncertainty =       0.029926565750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366530962
  error estimate for blocks of size 2^( 2) =       0.001439079881
  error estimate for blocks of size 2^( 3) =       0.001502216933
  error estimate for blocks of size 2^( 4) =       0.001545474852
  error estimate for blocks of size 2^( 5) =       0.001568228306
  error estimate for blocks of size 2^( 6) =       0.001582814428
  error estimate for blocks of size 2^( 7) =       0.001593843527

      target function =                  N/A
              le_mean =     -22.327365724570
             les_mean =     502.194937647574
             stat err =       0.001572590278
             autocorr =       1.324317814596
              std dev =       1.932597540101
             le_variance =       3.734933252003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730051176470
                                         uncertainty =       0.029926566010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730051176470
                                         uncertainty =       0.029926566010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366530960
  error estimate for blocks of size 2^( 2) =       0.001439079880
  error estimate for blocks of size 2^( 3) =       0.001502216933
  error estimate for blocks of size 2^( 4) =       0.001545474853
  error estimate for blocks of size 2^( 5) =       0.001568228308
  error estimate for blocks of size 2^( 6) =       0.001582814428
  error estimate for blocks of size 2^( 7) =       0.001593843530

      target function =                  N/A
              le_mean =     -22.327365724937
             les_mean =     502.194937664068
             stat err =       0.001572590280
             autocorr =       1.324317820532
              std dev =       1.932597537408
             le_variance =       3.734933241594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730051181661
                                         uncertainty =       0.029926565880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730051181661
                                         uncertainty =       0.029926565880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366530961
  error estimate for blocks of size 2^( 2) =       0.001439079881
  error estimate for blocks of size 2^( 3) =       0.001502216933
  error estimate for blocks of size 2^( 4) =       0.001545474852
  error estimate for blocks of size 2^( 5) =       0.001568228307
  error estimate for blocks of size 2^( 6) =       0.001582814428
  error estimate for blocks of size 2^( 7) =       0.001593843529

      target function =                  N/A
              le_mean =     -22.327365724753
             les_mean =     502.194937655807
             stat err =       0.001572590279
             autocorr =       1.324317817564
              std dev =       1.932597538754
             le_variance =       3.734933246798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730051186202
                                         uncertainty =       0.029926565767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730051186202
                                         uncertainty =       0.029926565767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366530961
  error estimate for blocks of size 2^( 2) =       0.001439079881
  error estimate for blocks of size 2^( 3) =       0.001502216933
  error estimate for blocks of size 2^( 4) =       0.001545474852
  error estimate for blocks of size 2^( 5) =       0.001568228306
  error estimate for blocks of size 2^( 6) =       0.001582814428
  error estimate for blocks of size 2^( 7) =       0.001593843528

      target function =                  N/A
              le_mean =     -22.327365724592
             les_mean =     502.194937648602
             stat err =       0.001572590278
             autocorr =       1.324317814967
              std dev =       1.932597539932
             le_variance =       3.734933251353


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327365724570        initial
     8.4703e+03     8.4703e+04             6.7274e-08       -22.327365724937  <--
     3.3881e+04     3.3881e+05             1.6819e-08       -22.327365724753
     1.3553e+05     1.3553e+06             4.2047e-09       -22.327365724592

*****************************************************************************
Applying the update for shift_i =   8.4703e+03     and shift_s =   8.4703e+04
*****************************************************************************

  Execution time = 4.6037e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_001                -6.963149e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187504e-02 3 1  ON 2
ci_004                -6.235951e-02 3 1  ON 3
ci_005                 4.604130e-02 3 1  ON 4
ci_006                 4.618033e-02 3 1  ON 5
ci_007                 3.181056e-02 3 1  ON 6
ci_008                 3.146462e-02 3 1  ON 7
ci_009                -2.501941e-02 3 1  ON 8
ci_010                -2.551353e-02 3 1  ON 9
ci_011                -2.288315e-02 3 1  ON 10
ci_012                -2.257806e-02 3 1  ON 11
ci_013                 2.000256e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969147e-02 3 1  ON 14
ci_016                 2.073125e-02 3 1  ON 15
ci_017                 1.537573e-02 3 1  ON 16
ci_018                 1.572859e-02 3 1  ON 17
ci_019                 1.062698e-02 3 1  ON 18
ci_020                 1.043513e-02 3 1  ON 19
ci_021                -9.780139e-03 3 1  ON 20
ci_022                -9.447973e-03 3 1  ON 21
ci_023                 8.747110e-03 3 1  ON 22
ci_024                 9.498608e-03 3 1  ON 23
ci_025                 7.145568e-03 3 1  ON 24
ci_026                 8.157994e-03 3 1  ON 25
ci_027                 7.925389e-03 3 1  ON 26
ci_028                 7.865140e-03 3 1  ON 27
ci_029                -7.651948e-03 3 1  ON 28
ci_030                -7.767633e-03 3 1  ON 29
ci_031                -7.191498e-03 3 1  ON 30
ci_032                -7.558612e-03 3 1  ON 31
ci_033                 6.846952e-03 3 1  ON 32
ci_034                 6.331916e-03 3 1  ON 33
ci_035                 6.422696e-03 3 1  ON 34
ci_036                 6.953407e-03 3 1  ON 35
ci_037                 6.517829e-03 3 1  ON 36
ci_038                 5.614272e-03 3 1  ON 37
ci_039                 5.905362e-03 3 1  ON 38
ci_040                 6.142272e-03 3 1  ON 39
ci_041                 5.432165e-03 3 1  ON 40
ci_042                 5.115320e-03 3 1  ON 41
ci_043                 5.093142e-03 3 1  ON 42
ci_044                 4.460066e-03 3 1  ON 43
ci_045                 5.122768e-03 3 1  ON 44
ci_046                 5.280794e-03 3 1  ON 45
ci_047                -3.977054e-03 3 1  ON 46
ci_048                -4.395028e-03 3 1  ON 47
ci_049                 4.051674e-03 3 1  ON 48
ci_050                 3.469465e-03 3 1  ON 49
ci_051                -3.068437e-03 3 1  ON 50
ci_052                -2.205026e-03 3 1  ON 51
ci_053                -2.741967e-03 3 1  ON 52
ci_054                -3.446641e-03 3 1  ON 53
ci_055                -1.934035e-03 3 1  ON 54
ci_056                -2.000769e-03 3 1  ON 55
ci_057                -1.788169e-03 3 1  ON 56
ci_058                -1.820686e-03 3 1  ON 57
ci_059                -1.892144e-03 3 1  ON 58
ci_060                -2.081007e-03 3 1  ON 59
ci_061                -1.839947e-03 3 1  ON 60
ci_062                -1.917120e-03 3 1  ON 61
ci_063                -1.942321e-03 3 1  ON 62
ci_064                -9.418322e-04 3 1  ON 63
ci_065                -1.763536e-03 3 1  ON 64
ci_066                -1.417339e-03 3 1  ON 65
ci_067                -1.965439e-03 3 1  ON 66
ci_068                -1.528194e-03 3 1  ON 67
ci_069                 1.160871e-03 3 1  ON 68
ci_070                 1.597970e-03 3 1  ON 69
ci_071                 1.903961e-05 3 1  ON 70
ci_072                -2.576010e-04 3 1  ON 71
ci_073                 1.366620e-03 3 1  ON 72
ci_074                 8.912994e-04 3 1  ON 73
ci_075                -1.333884e-03 3 1  ON 74
ci_076                -7.291211e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5652e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2302e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.5251
    reference variance = 3.11517
====================================================
  Execution time = 2.3767e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0315e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7639e+00
  Total weights = 1.949751289e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9656e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814647255958
                                         uncertainty =       0.034452594308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814647255958
                                         uncertainty =       0.034452594308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380859151
  error estimate for blocks of size 2^( 2) =       0.001451354206
  error estimate for blocks of size 2^( 3) =       0.001516079834
  error estimate for blocks of size 2^( 4) =       0.001561074224
  error estimate for blocks of size 2^( 5) =       0.001583025074
  error estimate for blocks of size 2^( 6) =       0.001592979490
  error estimate for blocks of size 2^( 7) =       0.001605457347

      target function =                  N/A
              le_mean =     -22.326497812309
             les_mean =     502.236431894569
             stat err =       0.001585634034
             autocorr =       1.318582029700
              std dev =       1.952860984660
             le_variance =       3.813666025408


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232649781231e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+03, overlap shift 2.1176e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326497811483       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326497828366       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326497828360       residual = 2.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+03 is 2.101283e-07

solving harmonic davidson linear method for identity shift 8.4703e+03, overlap shift 8.4703e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326497811483       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326497815704       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326497815702       residual = 2.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+03 is 5.253626e-08

solving harmonic davidson linear method for identity shift 3.3881e+04, overlap shift 3.3881e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326497811483       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326497812538       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326497812538       residual = 2.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e+04 is 1.313433e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119137 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9739e+01
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_001                -6.963149e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187504e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604128e-02 3 1  ON 4
ci_006                 4.618033e-02 3 1  ON 5
ci_007                 3.181056e-02 3 1  ON 6
ci_008                 3.146464e-02 3 1  ON 7
ci_009                -2.501943e-02 3 1  ON 8
ci_010                -2.551356e-02 3 1  ON 9
ci_011                -2.288313e-02 3 1  ON 10
ci_012                -2.257803e-02 3 1  ON 11
ci_013                 2.000254e-02 3 1  ON 12
ci_014                 2.020269e-02 3 1  ON 13
ci_015                 1.969147e-02 3 1  ON 14
ci_016                 2.073122e-02 3 1  ON 15
ci_017                 1.537571e-02 3 1  ON 16
ci_018                 1.572862e-02 3 1  ON 17
ci_019                 1.062696e-02 3 1  ON 18
ci_020                 1.043514e-02 3 1  ON 19
ci_021                -9.780157e-03 3 1  ON 20
ci_022                -9.447974e-03 3 1  ON 21
ci_023                 8.747101e-03 3 1  ON 22
ci_024                 9.498571e-03 3 1  ON 23
ci_025                 7.145591e-03 3 1  ON 24
ci_026                 8.158007e-03 3 1  ON 25
ci_027                 7.925432e-03 3 1  ON 26
ci_028                 7.865115e-03 3 1  ON 27
ci_029                -7.651944e-03 3 1  ON 28
ci_030                -7.767620e-03 3 1  ON 29
ci_031                -7.191482e-03 3 1  ON 30
ci_032                -7.558633e-03 3 1  ON 31
ci_033                 6.846962e-03 3 1  ON 32
ci_034                 6.331944e-03 3 1  ON 33
ci_035                 6.422686e-03 3 1  ON 34
ci_036                 6.953403e-03 3 1  ON 35
ci_037                 6.517812e-03 3 1  ON 36
ci_038                 5.614296e-03 3 1  ON 37
ci_039                 5.905335e-03 3 1  ON 38
ci_040                 6.142254e-03 3 1  ON 39
ci_041                 5.432150e-03 3 1  ON 40
ci_042                 5.115373e-03 3 1  ON 41
ci_043                 5.093143e-03 3 1  ON 42
ci_044                 4.460087e-03 3 1  ON 43
ci_045                 5.122733e-03 3 1  ON 44
ci_046                 5.280816e-03 3 1  ON 45
ci_047                -3.977028e-03 3 1  ON 46
ci_048                -4.395030e-03 3 1  ON 47
ci_049                 4.051702e-03 3 1  ON 48
ci_050                 3.469504e-03 3 1  ON 49
ci_051                -3.068396e-03 3 1  ON 50
ci_052                -2.205015e-03 3 1  ON 51
ci_053                -2.741957e-03 3 1  ON 52
ci_054                -3.446611e-03 3 1  ON 53
ci_055                -1.934037e-03 3 1  ON 54
ci_056                -2.000768e-03 3 1  ON 55
ci_057                -1.788154e-03 3 1  ON 56
ci_058                -1.820702e-03 3 1  ON 57
ci_059                -1.892144e-03 3 1  ON 58
ci_060                -2.080997e-03 3 1  ON 59
ci_061                -1.839912e-03 3 1  ON 60
ci_062                -1.917123e-03 3 1  ON 61
ci_063                -1.942277e-03 3 1  ON 62
ci_064                -9.418168e-04 3 1  ON 63
ci_065                -1.763517e-03 3 1  ON 64
ci_066                -1.417325e-03 3 1  ON 65
ci_067                -1.965388e-03 3 1  ON 66
ci_068                -1.528206e-03 3 1  ON 67
ci_069                 1.160880e-03 3 1  ON 68
ci_070                 1.597979e-03 3 1  ON 69
ci_071                 1.900649e-05 3 1  ON 70
ci_072                -2.576027e-04 3 1  ON 71
ci_073                 1.366621e-03 3 1  ON 72
ci_074                 8.913461e-04 3 1  ON 73
ci_075                -1.333859e-03 3 1  ON 74
ci_076                -7.291675e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.0311
    reference variance = 5.46713
====================================================
  Execution time = 2.3174e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7163e+00
  Total weights = 1.9499e+06
  Execution time = 4.3941e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.768095629066
                                         uncertainty =       0.035572092715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.768095629066
                                         uncertainty =       0.035572092715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372619863
  error estimate for blocks of size 2^( 2) =       0.001443128993
  error estimate for blocks of size 2^( 3) =       0.001504505157
  error estimate for blocks of size 2^( 4) =       0.001547815569
  error estimate for blocks of size 2^( 5) =       0.001571197487
  error estimate for blocks of size 2^( 6) =       0.001588264639
  error estimate for blocks of size 2^( 7) =       0.001584637925

      target function =                  N/A
              le_mean =     -22.326666522100
             les_mean =     502.196319837804
             stat err =       0.001572978905
             autocorr =       1.313243434366
              std dev =       1.941208685000
             le_variance =       3.768291158719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.768095594347
                                         uncertainty =       0.035572092017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.768095594347
                                         uncertainty =       0.035572092017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372619857
  error estimate for blocks of size 2^( 2) =       0.001443128986
  error estimate for blocks of size 2^( 3) =       0.001504505148
  error estimate for blocks of size 2^( 4) =       0.001547815559
  error estimate for blocks of size 2^( 5) =       0.001571197474
  error estimate for blocks of size 2^( 6) =       0.001588264633
  error estimate for blocks of size 2^( 7) =       0.001584637915

      target function =                  N/A
              le_mean =     -22.326666523538
             les_mean =     502.196319805158
             stat err =       0.001572978895
             autocorr =       1.313243430684
              std dev =       1.941208676036
             le_variance =       3.768291123916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.768095611704
                                         uncertainty =       0.035572092366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.768095611704
                                         uncertainty =       0.035572092366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372619860
  error estimate for blocks of size 2^( 2) =       0.001443128990
  error estimate for blocks of size 2^( 3) =       0.001504505152
  error estimate for blocks of size 2^( 4) =       0.001547815564
  error estimate for blocks of size 2^( 5) =       0.001571197480
  error estimate for blocks of size 2^( 6) =       0.001588264636
  error estimate for blocks of size 2^( 7) =       0.001584637920

      target function =                  N/A
              le_mean =     -22.326666522819
             les_mean =     502.196319821264
             stat err =       0.001572978900
             autocorr =       1.313243432526
              std dev =       1.941208680517
             le_variance =       3.768291141315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.768095626896
                                         uncertainty =       0.035572092671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.768095626896
                                         uncertainty =       0.035572092671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372619863
  error estimate for blocks of size 2^( 2) =       0.001443128993
  error estimate for blocks of size 2^( 3) =       0.001504505156
  error estimate for blocks of size 2^( 4) =       0.001547815568
  error estimate for blocks of size 2^( 5) =       0.001571197486
  error estimate for blocks of size 2^( 6) =       0.001588264638
  error estimate for blocks of size 2^( 7) =       0.001584637925

      target function =                  N/A
              le_mean =     -22.326666522190
             les_mean =     502.196319835713
             stat err =       0.001572978904
             autocorr =       1.313243434136
              std dev =       1.941208684440
             le_variance =       3.768291156543


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326666522100        initial
     2.1176e+03     2.1176e+04             2.1013e-07       -22.326666523538  <--
     8.4703e+03     8.4703e+04             5.2536e-08       -22.326666522819
     3.3881e+04     3.3881e+05             1.3134e-08       -22.326666522190

*****************************************************************************
Applying the update for shift_i =   2.1176e+03     and shift_s =   2.1176e+04
*****************************************************************************

  Execution time = 4.5215e+01
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_001                -6.963149e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187506e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604121e-02 3 1  ON 4
ci_006                 4.618033e-02 3 1  ON 5
ci_007                 3.181057e-02 3 1  ON 6
ci_008                 3.146473e-02 3 1  ON 7
ci_009                -2.501951e-02 3 1  ON 8
ci_010                -2.551365e-02 3 1  ON 9
ci_011                -2.288305e-02 3 1  ON 10
ci_012                -2.257793e-02 3 1  ON 11
ci_013                 2.000251e-02 3 1  ON 12
ci_014                 2.020262e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073114e-02 3 1  ON 15
ci_017                 1.537563e-02 3 1  ON 16
ci_018                 1.572870e-02 3 1  ON 17
ci_019                 1.062690e-02 3 1  ON 18
ci_020                 1.043517e-02 3 1  ON 19
ci_021                -9.780208e-03 3 1  ON 20
ci_022                -9.447977e-03 3 1  ON 21
ci_023                 8.747075e-03 3 1  ON 22
ci_024                 9.498462e-03 3 1  ON 23
ci_025                 7.145661e-03 3 1  ON 24
ci_026                 8.158047e-03 3 1  ON 25
ci_027                 7.925559e-03 3 1  ON 26
ci_028                 7.865040e-03 3 1  ON 27
ci_029                -7.651931e-03 3 1  ON 28
ci_030                -7.767579e-03 3 1  ON 29
ci_031                -7.191432e-03 3 1  ON 30
ci_032                -7.558698e-03 3 1  ON 31
ci_033                 6.846991e-03 3 1  ON 32
ci_034                 6.332028e-03 3 1  ON 33
ci_035                 6.422656e-03 3 1  ON 34
ci_036                 6.953394e-03 3 1  ON 35
ci_037                 6.517758e-03 3 1  ON 36
ci_038                 5.614369e-03 3 1  ON 37
ci_039                 5.905254e-03 3 1  ON 38
ci_040                 6.142201e-03 3 1  ON 39
ci_041                 5.432105e-03 3 1  ON 40
ci_042                 5.115530e-03 3 1  ON 41
ci_043                 5.093145e-03 3 1  ON 42
ci_044                 4.460151e-03 3 1  ON 43
ci_045                 5.122627e-03 3 1  ON 44
ci_046                 5.280882e-03 3 1  ON 45
ci_047                -3.976950e-03 3 1  ON 46
ci_048                -4.395037e-03 3 1  ON 47
ci_049                 4.051786e-03 3 1  ON 48
ci_050                 3.469623e-03 3 1  ON 49
ci_051                -3.068276e-03 3 1  ON 50
ci_052                -2.204983e-03 3 1  ON 51
ci_053                -2.741928e-03 3 1  ON 52
ci_054                -3.446522e-03 3 1  ON 53
ci_055                -1.934044e-03 3 1  ON 54
ci_056                -2.000765e-03 3 1  ON 55
ci_057                -1.788110e-03 3 1  ON 56
ci_058                -1.820751e-03 3 1  ON 57
ci_059                -1.892144e-03 3 1  ON 58
ci_060                -2.080968e-03 3 1  ON 59
ci_061                -1.839809e-03 3 1  ON 60
ci_062                -1.917131e-03 3 1  ON 61
ci_063                -1.942147e-03 3 1  ON 62
ci_064                -9.417705e-04 3 1  ON 63
ci_065                -1.763462e-03 3 1  ON 64
ci_066                -1.417284e-03 3 1  ON 65
ci_067                -1.965236e-03 3 1  ON 66
ci_068                -1.528243e-03 3 1  ON 67
ci_069                 1.160906e-03 3 1  ON 68
ci_070                 1.598004e-03 3 1  ON 69
ci_071                 1.890716e-05 3 1  ON 70
ci_072                -2.576079e-04 3 1  ON 71
ci_073                 1.366625e-03 3 1  ON 72
ci_074                 8.914861e-04 3 1  ON 73
ci_075                -1.333784e-03 3 1  ON 74
ci_076                -7.293068e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4965e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2302e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.7494
    reference variance = 1.53424
====================================================
  Execution time = 2.3843e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0306e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7721e+00
  Total weights = 1.950011669e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9532e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.824154349739
                                         uncertainty =       0.046515415672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.824154349739
                                         uncertainty =       0.046515415672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382599627
  error estimate for blocks of size 2^( 2) =       0.001452515897
  error estimate for blocks of size 2^( 3) =       0.001514988762
  error estimate for blocks of size 2^( 4) =       0.001557574171
  error estimate for blocks of size 2^( 5) =       0.001585503347
  error estimate for blocks of size 2^( 6) =       0.001596954055
  error estimate for blocks of size 2^( 7) =       0.001603084965

      target function =                  N/A
              le_mean =     -22.328573187247
             les_mean =     502.337285836394
             stat err =       0.001585779135
             autocorr =       1.315505073491
              std dev =       1.955322428688
             le_variance =       3.823285800131


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232857318725e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+02, overlap shift 5.2940e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328573186456       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328573219669       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328573219901       residual = 2.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+02 is 7.676391e-07

solving harmonic davidson linear method for identity shift 2.1176e+03, overlap shift 2.1176e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328573186456       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328573194761       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328573194819       residual = 2.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+03 is 1.919674e-07

solving harmonic davidson linear method for identity shift 8.4703e+03, overlap shift 8.4703e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328573186456       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328573188532       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328573188547       residual = 2.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+03 is 4.799544e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120327 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9803e+01
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187501e-02 3 1  ON 2
ci_004                -6.235948e-02 3 1  ON 3
ci_005                 4.604128e-02 3 1  ON 4
ci_006                 4.618029e-02 3 1  ON 5
ci_007                 3.181060e-02 3 1  ON 6
ci_008                 3.146473e-02 3 1  ON 7
ci_009                -2.501949e-02 3 1  ON 8
ci_010                -2.551372e-02 3 1  ON 9
ci_011                -2.288289e-02 3 1  ON 10
ci_012                -2.257788e-02 3 1  ON 11
ci_013                 2.000262e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969134e-02 3 1  ON 14
ci_016                 2.073112e-02 3 1  ON 15
ci_017                 1.537550e-02 3 1  ON 16
ci_018                 1.572879e-02 3 1  ON 17
ci_019                 1.062675e-02 3 1  ON 18
ci_020                 1.043499e-02 3 1  ON 19
ci_021                -9.780257e-03 3 1  ON 20
ci_022                -9.448086e-03 3 1  ON 21
ci_023                 8.747130e-03 3 1  ON 22
ci_024                 9.498270e-03 3 1  ON 23
ci_025                 7.145651e-03 3 1  ON 24
ci_026                 8.157970e-03 3 1  ON 25
ci_027                 7.925617e-03 3 1  ON 26
ci_028                 7.865029e-03 3 1  ON 27
ci_029                -7.651903e-03 3 1  ON 28
ci_030                -7.767660e-03 3 1  ON 29
ci_031                -7.191467e-03 3 1  ON 30
ci_032                -7.558716e-03 3 1  ON 31
ci_033                 6.846906e-03 3 1  ON 32
ci_034                 6.332087e-03 3 1  ON 33
ci_035                 6.422665e-03 3 1  ON 34
ci_036                 6.953356e-03 3 1  ON 35
ci_037                 6.517722e-03 3 1  ON 36
ci_038                 5.614502e-03 3 1  ON 37
ci_039                 5.905179e-03 3 1  ON 38
ci_040                 6.142128e-03 3 1  ON 39
ci_041                 5.432104e-03 3 1  ON 40
ci_042                 5.115570e-03 3 1  ON 41
ci_043                 5.093211e-03 3 1  ON 42
ci_044                 4.460289e-03 3 1  ON 43
ci_045                 5.122516e-03 3 1  ON 44
ci_046                 5.280882e-03 3 1  ON 45
ci_047                -3.977007e-03 3 1  ON 46
ci_048                -4.394982e-03 3 1  ON 47
ci_049                 4.051750e-03 3 1  ON 48
ci_050                 3.469731e-03 3 1  ON 49
ci_051                -3.068202e-03 3 1  ON 50
ci_052                -2.205073e-03 3 1  ON 51
ci_053                -2.741984e-03 3 1  ON 52
ci_054                -3.446490e-03 3 1  ON 53
ci_055                -1.933940e-03 3 1  ON 54
ci_056                -2.000774e-03 3 1  ON 55
ci_057                -1.788060e-03 3 1  ON 56
ci_058                -1.820776e-03 3 1  ON 57
ci_059                -1.892297e-03 3 1  ON 58
ci_060                -2.080916e-03 3 1  ON 59
ci_061                -1.839859e-03 3 1  ON 60
ci_062                -1.917141e-03 3 1  ON 61
ci_063                -1.942171e-03 3 1  ON 62
ci_064                -9.418514e-04 3 1  ON 63
ci_065                -1.763470e-03 3 1  ON 64
ci_066                -1.417211e-03 3 1  ON 65
ci_067                -1.965257e-03 3 1  ON 66
ci_068                -1.528197e-03 3 1  ON 67
ci_069                 1.160889e-03 3 1  ON 68
ci_070                 1.597952e-03 3 1  ON 69
ci_071                 1.877637e-05 3 1  ON 70
ci_072                -2.577043e-04 3 1  ON 71
ci_073                 1.366535e-03 3 1  ON 72
ci_074                 8.916027e-04 3 1  ON 73
ci_075                -1.333650e-03 3 1  ON 74
ci_076                -7.293141e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.8221
    reference variance = 1.762
====================================================
  Execution time = 2.3139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6794e+00
  Total weights = 1.9496e+06
  Execution time = 4.4135e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730335076577
                                         uncertainty =       0.036964201351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730335076577
                                         uncertainty =       0.036964201351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365512531
  error estimate for blocks of size 2^( 2) =       0.001437748784
  error estimate for blocks of size 2^( 3) =       0.001499526517
  error estimate for blocks of size 2^( 4) =       0.001543213538
  error estimate for blocks of size 2^( 5) =       0.001569523267
  error estimate for blocks of size 2^( 6) =       0.001586574307
  error estimate for blocks of size 2^( 7) =       0.001595691863

      target function =                  N/A
              le_mean =     -22.329140144094
             les_mean =     502.269877657092
             stat err =       0.001573750744
             autocorr =       1.328252118003
              std dev =       1.931157238395
             le_variance =       3.729368279407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730335068777
                                         uncertainty =       0.036964200883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730335068777
                                         uncertainty =       0.036964200883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365512529
  error estimate for blocks of size 2^( 2) =       0.001437748780
  error estimate for blocks of size 2^( 3) =       0.001499526516
  error estimate for blocks of size 2^( 4) =       0.001543213532
  error estimate for blocks of size 2^( 5) =       0.001569523259
  error estimate for blocks of size 2^( 6) =       0.001586574298
  error estimate for blocks of size 2^( 7) =       0.001595691803

      target function =                  N/A
              le_mean =     -22.329140142617
             les_mean =     502.269877745066
             stat err =       0.001573750723
             autocorr =       1.328252085985
              std dev =       1.931157236325
             le_variance =       3.729368271411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730335072660
                                         uncertainty =       0.036964201117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730335072660
                                         uncertainty =       0.036964201117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365512530
  error estimate for blocks of size 2^( 2) =       0.001437748782
  error estimate for blocks of size 2^( 3) =       0.001499526517
  error estimate for blocks of size 2^( 4) =       0.001543213535
  error estimate for blocks of size 2^( 5) =       0.001569523263
  error estimate for blocks of size 2^( 6) =       0.001586574303
  error estimate for blocks of size 2^( 7) =       0.001595691833

      target function =                  N/A
              le_mean =     -22.329140143350
             les_mean =     502.269877687227
             stat err =       0.001573750734
             autocorr =       1.328252102000
              std dev =       1.931157237356
             le_variance =       3.729368275392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730335076086
                                         uncertainty =       0.036964201321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730335076086
                                         uncertainty =       0.036964201321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365512531
  error estimate for blocks of size 2^( 2) =       0.001437748783
  error estimate for blocks of size 2^( 3) =       0.001499526517
  error estimate for blocks of size 2^( 4) =       0.001543213537
  error estimate for blocks of size 2^( 5) =       0.001569523267
  error estimate for blocks of size 2^( 6) =       0.001586574307
  error estimate for blocks of size 2^( 7) =       0.001595691859

      target function =                  N/A
              le_mean =     -22.329140144000
             les_mean =     502.269877659732
             stat err =       0.001573750743
             autocorr =       1.328252116004
              std dev =       1.931157238265
             le_variance =       3.729368278903


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329140144094        initial  <--
     5.2940e+02     5.2940e+03             7.6764e-07       -22.329140142617
     2.1176e+03     2.1176e+04             1.9197e-07       -22.329140143350
     8.4703e+03     8.4703e+04             4.7995e-08       -22.329140144000

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.2652
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_001                -6.963149e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187506e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604121e-02 3 1  ON 4
ci_006                 4.618033e-02 3 1  ON 5
ci_007                 3.181057e-02 3 1  ON 6
ci_008                 3.146473e-02 3 1  ON 7
ci_009                -2.501951e-02 3 1  ON 8
ci_010                -2.551365e-02 3 1  ON 9
ci_011                -2.288305e-02 3 1  ON 10
ci_012                -2.257793e-02 3 1  ON 11
ci_013                 2.000251e-02 3 1  ON 12
ci_014                 2.020262e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073114e-02 3 1  ON 15
ci_017                 1.537563e-02 3 1  ON 16
ci_018                 1.572870e-02 3 1  ON 17
ci_019                 1.062690e-02 3 1  ON 18
ci_020                 1.043517e-02 3 1  ON 19
ci_021                -9.780208e-03 3 1  ON 20
ci_022                -9.447977e-03 3 1  ON 21
ci_023                 8.747075e-03 3 1  ON 22
ci_024                 9.498462e-03 3 1  ON 23
ci_025                 7.145661e-03 3 1  ON 24
ci_026                 8.158047e-03 3 1  ON 25
ci_027                 7.925559e-03 3 1  ON 26
ci_028                 7.865040e-03 3 1  ON 27
ci_029                -7.651931e-03 3 1  ON 28
ci_030                -7.767579e-03 3 1  ON 29
ci_031                -7.191432e-03 3 1  ON 30
ci_032                -7.558698e-03 3 1  ON 31
ci_033                 6.846991e-03 3 1  ON 32
ci_034                 6.332028e-03 3 1  ON 33
ci_035                 6.422656e-03 3 1  ON 34
ci_036                 6.953394e-03 3 1  ON 35
ci_037                 6.517758e-03 3 1  ON 36
ci_038                 5.614369e-03 3 1  ON 37
ci_039                 5.905254e-03 3 1  ON 38
ci_040                 6.142201e-03 3 1  ON 39
ci_041                 5.432105e-03 3 1  ON 40
ci_042                 5.115530e-03 3 1  ON 41
ci_043                 5.093145e-03 3 1  ON 42
ci_044                 4.460151e-03 3 1  ON 43
ci_045                 5.122627e-03 3 1  ON 44
ci_046                 5.280882e-03 3 1  ON 45
ci_047                -3.976950e-03 3 1  ON 46
ci_048                -4.395037e-03 3 1  ON 47
ci_049                 4.051786e-03 3 1  ON 48
ci_050                 3.469623e-03 3 1  ON 49
ci_051                -3.068276e-03 3 1  ON 50
ci_052                -2.204983e-03 3 1  ON 51
ci_053                -2.741928e-03 3 1  ON 52
ci_054                -3.446522e-03 3 1  ON 53
ci_055                -1.934044e-03 3 1  ON 54
ci_056                -2.000765e-03 3 1  ON 55
ci_057                -1.788110e-03 3 1  ON 56
ci_058                -1.820751e-03 3 1  ON 57
ci_059                -1.892144e-03 3 1  ON 58
ci_060                -2.080968e-03 3 1  ON 59
ci_061                -1.839809e-03 3 1  ON 60
ci_062                -1.917131e-03 3 1  ON 61
ci_063                -1.942147e-03 3 1  ON 62
ci_064                -9.417705e-04 3 1  ON 63
ci_065                -1.763462e-03 3 1  ON 64
ci_066                -1.417284e-03 3 1  ON 65
ci_067                -1.965236e-03 3 1  ON 66
ci_068                -1.528243e-03 3 1  ON 67
ci_069                 1.160906e-03 3 1  ON 68
ci_070                 1.598004e-03 3 1  ON 69
ci_071                 1.890716e-05 3 1  ON 70
ci_072                -2.576079e-04 3 1  ON 71
ci_073                 1.366625e-03 3 1  ON 72
ci_074                 8.914861e-04 3 1  ON 73
ci_075                -1.333784e-03 3 1  ON 74
ci_076                -7.293068e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5078e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2309e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.0978
    reference variance = 4.12803
====================================================
  Execution time = 2.3838e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0339e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6770e+00
  Total weights = 1.949857088e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8871e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.726071105742
                                         uncertainty =       0.023779395981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.726071105742
                                         uncertainty =       0.023779395981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365146581
  error estimate for blocks of size 2^( 2) =       0.001435886080
  error estimate for blocks of size 2^( 3) =       0.001498639033
  error estimate for blocks of size 2^( 4) =       0.001542649056
  error estimate for blocks of size 2^( 5) =       0.001564720661
  error estimate for blocks of size 2^( 6) =       0.001579131969
  error estimate for blocks of size 2^( 7) =       0.001584033683

      target function =                  N/A
              le_mean =     -22.327723257972
             les_mean =     502.204198037834
             stat err =       0.001567633842
             autocorr =       1.318653492263
              std dev =       1.930639699243
             le_variance =       3.727369648293


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232772325797e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+03, overlap shift 5.2940e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327723257145       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327723259480       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327723259476       residual = 4.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+03 is 6.041362e-08

solving harmonic davidson linear method for identity shift 2.1176e+04, overlap shift 2.1176e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327723257145       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327723257729       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327723257728       residual = 4.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+04 is 1.510384e-08

solving harmonic davidson linear method for identity shift 8.4703e+04, overlap shift 8.4703e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327723257145       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327723257291       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327723257291       residual = 4.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+04 is 3.775987e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121501 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9732e+01
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_001                -6.963149e-01 3 1  ON 0
ci_002                -7.040966e-01 3 1  ON 1
ci_003                -6.187506e-02 3 1  ON 2
ci_004                -6.235953e-02 3 1  ON 3
ci_005                 4.604121e-02 3 1  ON 4
ci_006                 4.618033e-02 3 1  ON 5
ci_007                 3.181057e-02 3 1  ON 6
ci_008                 3.146474e-02 3 1  ON 7
ci_009                -2.501952e-02 3 1  ON 8
ci_010                -2.551366e-02 3 1  ON 9
ci_011                -2.288305e-02 3 1  ON 10
ci_012                -2.257792e-02 3 1  ON 11
ci_013                 2.000250e-02 3 1  ON 12
ci_014                 2.020262e-02 3 1  ON 13
ci_015                 1.969144e-02 3 1  ON 14
ci_016                 2.073114e-02 3 1  ON 15
ci_017                 1.537564e-02 3 1  ON 16
ci_018                 1.572870e-02 3 1  ON 17
ci_019                 1.062691e-02 3 1  ON 18
ci_020                 1.043516e-02 3 1  ON 19
ci_021                -9.780199e-03 3 1  ON 20
ci_022                -9.447981e-03 3 1  ON 21
ci_023                 8.747078e-03 3 1  ON 22
ci_024                 9.498453e-03 3 1  ON 23
ci_025                 7.145664e-03 3 1  ON 24
ci_026                 8.158047e-03 3 1  ON 25
ci_027                 7.925550e-03 3 1  ON 26
ci_028                 7.865042e-03 3 1  ON 27
ci_029                -7.651932e-03 3 1  ON 28
ci_030                -7.767575e-03 3 1  ON 29
ci_031                -7.191441e-03 3 1  ON 30
ci_032                -7.558701e-03 3 1  ON 31
ci_033                 6.846994e-03 3 1  ON 32
ci_034                 6.332035e-03 3 1  ON 33
ci_035                 6.422654e-03 3 1  ON 34
ci_036                 6.953381e-03 3 1  ON 35
ci_037                 6.517744e-03 3 1  ON 36
ci_038                 5.614375e-03 3 1  ON 37
ci_039                 5.905245e-03 3 1  ON 38
ci_040                 6.142188e-03 3 1  ON 39
ci_041                 5.432097e-03 3 1  ON 40
ci_042                 5.115518e-03 3 1  ON 41
ci_043                 5.093145e-03 3 1  ON 42
ci_044                 4.460153e-03 3 1  ON 43
ci_045                 5.122628e-03 3 1  ON 44
ci_046                 5.280886e-03 3 1  ON 45
ci_047                -3.976958e-03 3 1  ON 46
ci_048                -4.395027e-03 3 1  ON 47
ci_049                 4.051780e-03 3 1  ON 48
ci_050                 3.469622e-03 3 1  ON 49
ci_051                -3.068278e-03 3 1  ON 50
ci_052                -2.204980e-03 3 1  ON 51
ci_053                -2.741935e-03 3 1  ON 52
ci_054                -3.446512e-03 3 1  ON 53
ci_055                -1.934045e-03 3 1  ON 54
ci_056                -2.000771e-03 3 1  ON 55
ci_057                -1.788116e-03 3 1  ON 56
ci_058                -1.820758e-03 3 1  ON 57
ci_059                -1.892153e-03 3 1  ON 58
ci_060                -2.080962e-03 3 1  ON 59
ci_061                -1.839807e-03 3 1  ON 60
ci_062                -1.917132e-03 3 1  ON 61
ci_063                -1.942139e-03 3 1  ON 62
ci_064                -9.417707e-04 3 1  ON 63
ci_065                -1.763468e-03 3 1  ON 64
ci_066                -1.417271e-03 3 1  ON 65
ci_067                -1.965230e-03 3 1  ON 66
ci_068                -1.528232e-03 3 1  ON 67
ci_069                 1.160906e-03 3 1  ON 68
ci_070                 1.597997e-03 3 1  ON 69
ci_071                 1.890133e-05 3 1  ON 70
ci_072                -2.576100e-04 3 1  ON 71
ci_073                 1.366620e-03 3 1  ON 72
ci_074                 8.914825e-04 3 1  ON 73
ci_075                -1.333774e-03 3 1  ON 74
ci_076                -7.293117e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -21.9118
    reference variance = 5.37433
====================================================
  Execution time = 2.3203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7091e+00
  Total weights = 1.9498e+06
  Execution time = 4.3643e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761651995357
                                         uncertainty =       0.030087672983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761651995357
                                         uncertainty =       0.030087672983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371271365
  error estimate for blocks of size 2^( 2) =       0.001442253289
  error estimate for blocks of size 2^( 3) =       0.001507003454
  error estimate for blocks of size 2^( 4) =       0.001552774160
  error estimate for blocks of size 2^( 5) =       0.001578771101
  error estimate for blocks of size 2^( 6) =       0.001593553694
  error estimate for blocks of size 2^( 7) =       0.001600287159

      target function =                  N/A
              le_mean =     -22.327944769520
             les_mean =     502.246218246311
             stat err =       0.001581346529
             autocorr =       1.329864167973
              std dev =       1.939301590804
             le_variance =       3.760890660097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761651991478
                                         uncertainty =       0.030087672734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761651991478
                                         uncertainty =       0.030087672734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371271365
  error estimate for blocks of size 2^( 2) =       0.001442253288
  error estimate for blocks of size 2^( 3) =       0.001507003453
  error estimate for blocks of size 2^( 4) =       0.001552774158
  error estimate for blocks of size 2^( 5) =       0.001578771100
  error estimate for blocks of size 2^( 6) =       0.001593553693
  error estimate for blocks of size 2^( 7) =       0.001600287159

      target function =                  N/A
              le_mean =     -22.327944769736
             les_mean =     502.246218295231
             stat err =       0.001581346527
             autocorr =       1.329864167316
              std dev =       1.939301589775
             le_variance =       3.760890656106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761651993417
                                         uncertainty =       0.030087672859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761651993417
                                         uncertainty =       0.030087672859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371271365
  error estimate for blocks of size 2^( 2) =       0.001442253288
  error estimate for blocks of size 2^( 3) =       0.001507003453
  error estimate for blocks of size 2^( 4) =       0.001552774159
  error estimate for blocks of size 2^( 5) =       0.001578771100
  error estimate for blocks of size 2^( 6) =       0.001593553694
  error estimate for blocks of size 2^( 7) =       0.001600287159

      target function =                  N/A
              le_mean =     -22.327944769628
             les_mean =     502.246218270752
             stat err =       0.001581346528
             autocorr =       1.329864167644
              std dev =       1.939301590290
             le_variance =       3.760890658101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761651995115
                                         uncertainty =       0.030087672968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761651995115
                                         uncertainty =       0.030087672968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371271365
  error estimate for blocks of size 2^( 2) =       0.001442253289
  error estimate for blocks of size 2^( 3) =       0.001507003454
  error estimate for blocks of size 2^( 4) =       0.001552774159
  error estimate for blocks of size 2^( 5) =       0.001578771101
  error estimate for blocks of size 2^( 6) =       0.001593553694
  error estimate for blocks of size 2^( 7) =       0.001600287159

      target function =                  N/A
              le_mean =     -22.327944769534
             les_mean =     502.246218249364
             stat err =       0.001581346528
             autocorr =       1.329864167932
              std dev =       1.939301590740
             le_variance =       3.760890659847


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327944769520        initial
     5.2940e+03     5.2940e+04             6.0414e-08       -22.327944769736  <--
     2.1176e+04     2.1176e+05             1.5104e-08       -22.327944769628
     8.4703e+04     8.4703e+05             3.7760e-09       -22.327944769534

*****************************************************************************
Applying the update for shift_i =   5.2940e+03     and shift_s =   5.2940e+04
*****************************************************************************

  Execution time = 4.5110e+01
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_001                -6.963149e-01 3 1  ON 0
ci_002                -7.040966e-01 3 1  ON 1
ci_003                -6.187507e-02 3 1  ON 2
ci_004                -6.235954e-02 3 1  ON 3
ci_005                 4.604122e-02 3 1  ON 4
ci_006                 4.618033e-02 3 1  ON 5
ci_007                 3.181056e-02 3 1  ON 6
ci_008                 3.146477e-02 3 1  ON 7
ci_009                -2.501954e-02 3 1  ON 8
ci_010                -2.551371e-02 3 1  ON 9
ci_011                -2.288307e-02 3 1  ON 10
ci_012                -2.257788e-02 3 1  ON 11
ci_013                 2.000248e-02 3 1  ON 12
ci_014                 2.020261e-02 3 1  ON 13
ci_015                 1.969143e-02 3 1  ON 14
ci_016                 2.073115e-02 3 1  ON 15
ci_017                 1.537568e-02 3 1  ON 16
ci_018                 1.572870e-02 3 1  ON 17
ci_019                 1.062693e-02 3 1  ON 18
ci_020                 1.043516e-02 3 1  ON 19
ci_021                -9.780170e-03 3 1  ON 20
ci_022                -9.447992e-03 3 1  ON 21
ci_023                 8.747089e-03 3 1  ON 22
ci_024                 9.498426e-03 3 1  ON 23
ci_025                 7.145671e-03 3 1  ON 24
ci_026                 8.158048e-03 3 1  ON 25
ci_027                 7.925524e-03 3 1  ON 26
ci_028                 7.865051e-03 3 1  ON 27
ci_029                -7.651937e-03 3 1  ON 28
ci_030                -7.767564e-03 3 1  ON 29
ci_031                -7.191468e-03 3 1  ON 30
ci_032                -7.558711e-03 3 1  ON 31
ci_033                 6.847001e-03 3 1  ON 32
ci_034                 6.332054e-03 3 1  ON 33
ci_035                 6.422649e-03 3 1  ON 34
ci_036                 6.953342e-03 3 1  ON 35
ci_037                 6.517703e-03 3 1  ON 36
ci_038                 5.614394e-03 3 1  ON 37
ci_039                 5.905218e-03 3 1  ON 38
ci_040                 6.142150e-03 3 1  ON 39
ci_041                 5.432072e-03 3 1  ON 40
ci_042                 5.115482e-03 3 1  ON 41
ci_043                 5.093145e-03 3 1  ON 42
ci_044                 4.460160e-03 3 1  ON 43
ci_045                 5.122630e-03 3 1  ON 44
ci_046                 5.280896e-03 3 1  ON 45
ci_047                -3.976982e-03 3 1  ON 46
ci_048                -4.394998e-03 3 1  ON 47
ci_049                 4.051763e-03 3 1  ON 48
ci_050                 3.469619e-03 3 1  ON 49
ci_051                -3.068283e-03 3 1  ON 50
ci_052                -2.204973e-03 3 1  ON 51
ci_053                -2.741955e-03 3 1  ON 52
ci_054                -3.446481e-03 3 1  ON 53
ci_055                -1.934048e-03 3 1  ON 54
ci_056                -2.000787e-03 3 1  ON 55
ci_057                -1.788134e-03 3 1  ON 56
ci_058                -1.820777e-03 3 1  ON 57
ci_059                -1.892180e-03 3 1  ON 58
ci_060                -2.080945e-03 3 1  ON 59
ci_061                -1.839800e-03 3 1  ON 60
ci_062                -1.917134e-03 3 1  ON 61
ci_063                -1.942118e-03 3 1  ON 62
ci_064                -9.417713e-04 3 1  ON 63
ci_065                -1.763487e-03 3 1  ON 64
ci_066                -1.417234e-03 3 1  ON 65
ci_067                -1.965213e-03 3 1  ON 66
ci_068                -1.528199e-03 3 1  ON 67
ci_069                 1.160905e-03 3 1  ON 68
ci_070                 1.597977e-03 3 1  ON 69
ci_071                 1.888383e-05 3 1  ON 70
ci_072                -2.576165e-04 3 1  ON 71
ci_073                 1.366605e-03 3 1  ON 72
ci_074                 8.914719e-04 3 1  ON 73
ci_075                -1.333744e-03 3 1  ON 74
ci_076                -7.293263e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4857e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2304e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.0835
    reference variance = 2.8709
====================================================
  Execution time = 2.3775e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0318e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.8034e+00
  Total weights = 1.949387374e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9662e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.858177381732
                                         uncertainty =       0.087375755655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.858177381732
                                         uncertainty =       0.087375755655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389006674
  error estimate for blocks of size 2^( 2) =       0.001458065793
  error estimate for blocks of size 2^( 3) =       0.001519152800
  error estimate for blocks of size 2^( 4) =       0.001562638069
  error estimate for blocks of size 2^( 5) =       0.001587637336
  error estimate for blocks of size 2^( 6) =       0.001600144556
  error estimate for blocks of size 2^( 7) =       0.001602739082

      target function =                  N/A
              le_mean =     -22.327155205700
             les_mean =     502.305235608004
             stat err =       0.001588289761
             autocorr =       1.307527426754
              std dev =       1.964383505749
             le_variance =       3.858802557660


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232715520570e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+03, overlap shift 1.3235e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327155204927       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327155219918       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327155220139       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+03 is 4.401764e-07

solving harmonic davidson linear method for identity shift 5.2940e+03, overlap shift 5.2940e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327155204927       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327155208675       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327155208730       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+03 is 1.100630e-07

solving harmonic davidson linear method for identity shift 2.1176e+04, overlap shift 2.1176e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327155204927       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327155205864       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327155205878       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+04 is 2.751692e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122678 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9748e+01
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_001                -6.963149e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187507e-02 3 1  ON 2
ci_004                -6.235954e-02 3 1  ON 3
ci_005                 4.604124e-02 3 1  ON 4
ci_006                 4.618037e-02 3 1  ON 5
ci_007                 3.181057e-02 3 1  ON 6
ci_008                 3.146480e-02 3 1  ON 7
ci_009                -2.501954e-02 3 1  ON 8
ci_010                -2.551370e-02 3 1  ON 9
ci_011                -2.288306e-02 3 1  ON 10
ci_012                -2.257787e-02 3 1  ON 11
ci_013                 2.000246e-02 3 1  ON 12
ci_014                 2.020261e-02 3 1  ON 13
ci_015                 1.969148e-02 3 1  ON 14
ci_016                 2.073112e-02 3 1  ON 15
ci_017                 1.537568e-02 3 1  ON 16
ci_018                 1.572873e-02 3 1  ON 17
ci_019                 1.062690e-02 3 1  ON 18
ci_020                 1.043516e-02 3 1  ON 19
ci_021                -9.780173e-03 3 1  ON 20
ci_022                -9.448057e-03 3 1  ON 21
ci_023                 8.747142e-03 3 1  ON 22
ci_024                 9.498404e-03 3 1  ON 23
ci_025                 7.145647e-03 3 1  ON 24
ci_026                 8.158010e-03 3 1  ON 25
ci_027                 7.925567e-03 3 1  ON 26
ci_028                 7.865007e-03 3 1  ON 27
ci_029                -7.651918e-03 3 1  ON 28
ci_030                -7.767625e-03 3 1  ON 29
ci_031                -7.191423e-03 3 1  ON 30
ci_032                -7.558681e-03 3 1  ON 31
ci_033                 6.847030e-03 3 1  ON 32
ci_034                 6.332043e-03 3 1  ON 33
ci_035                 6.422704e-03 3 1  ON 34
ci_036                 6.953328e-03 3 1  ON 35
ci_037                 6.517725e-03 3 1  ON 36
ci_038                 5.614388e-03 3 1  ON 37
ci_039                 5.905164e-03 3 1  ON 38
ci_040                 6.142040e-03 3 1  ON 39
ci_041                 5.432097e-03 3 1  ON 40
ci_042                 5.115451e-03 3 1  ON 41
ci_043                 5.093120e-03 3 1  ON 42
ci_044                 4.460139e-03 3 1  ON 43
ci_045                 5.122680e-03 3 1  ON 44
ci_046                 5.280915e-03 3 1  ON 45
ci_047                -3.977008e-03 3 1  ON 46
ci_048                -4.394956e-03 3 1  ON 47
ci_049                 4.051783e-03 3 1  ON 48
ci_050                 3.469637e-03 3 1  ON 49
ci_051                -3.068286e-03 3 1  ON 50
ci_052                -2.205030e-03 3 1  ON 51
ci_053                -2.741940e-03 3 1  ON 52
ci_054                -3.446498e-03 3 1  ON 53
ci_055                -1.934046e-03 3 1  ON 54
ci_056                -2.000806e-03 3 1  ON 55
ci_057                -1.788153e-03 3 1  ON 56
ci_058                -1.820751e-03 3 1  ON 57
ci_059                -1.892195e-03 3 1  ON 58
ci_060                -2.080933e-03 3 1  ON 59
ci_061                -1.839814e-03 3 1  ON 60
ci_062                -1.917172e-03 3 1  ON 61
ci_063                -1.942038e-03 3 1  ON 62
ci_064                -9.418093e-04 3 1  ON 63
ci_065                -1.763469e-03 3 1  ON 64
ci_066                -1.417241e-03 3 1  ON 65
ci_067                -1.965164e-03 3 1  ON 66
ci_068                -1.528175e-03 3 1  ON 67
ci_069                 1.160916e-03 3 1  ON 68
ci_070                 1.597963e-03 3 1  ON 69
ci_071                 1.887263e-05 3 1  ON 70
ci_072                -2.576094e-04 3 1  ON 71
ci_073                 1.366636e-03 3 1  ON 72
ci_074                 8.915150e-04 3 1  ON 73
ci_075                -1.333723e-03 3 1  ON 74
ci_076                -7.293548e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.4543
    reference variance = 2.96791
====================================================
  Execution time = 2.3210e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.6901e+00
  Total weights = 1.9496e+06
  Execution time = 4.7958e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741736055698
                                         uncertainty =       0.023137290436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741736055698
                                         uncertainty =       0.023137290436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367785173
  error estimate for blocks of size 2^( 2) =       0.001440804685
  error estimate for blocks of size 2^( 3) =       0.001504782894
  error estimate for blocks of size 2^( 4) =       0.001549498202
  error estimate for blocks of size 2^( 5) =       0.001572478579
  error estimate for blocks of size 2^( 6) =       0.001587872245
  error estimate for blocks of size 2^( 7) =       0.001598695250

      target function =                  N/A
              le_mean =     -22.325912195542
             les_mean =     502.136418681183
             stat err =       0.001577136069
             autocorr =       1.329543480808
              std dev =       1.934371291372
             le_variance =       3.741792292882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741736088568
                                         uncertainty =       0.023137290940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741736088568
                                         uncertainty =       0.023137290940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367785179
  error estimate for blocks of size 2^( 2) =       0.001440804685
  error estimate for blocks of size 2^( 3) =       0.001504782886
  error estimate for blocks of size 2^( 4) =       0.001549498191
  error estimate for blocks of size 2^( 5) =       0.001572478571
  error estimate for blocks of size 2^( 6) =       0.001587872240
  error estimate for blocks of size 2^( 7) =       0.001598695244

      target function =                  N/A
              le_mean =     -22.325912198112
             les_mean =     502.136418514412
             stat err =       0.001577136061
             autocorr =       1.329543456689
              std dev =       1.934371299930
             le_variance =       3.741792325993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741736072131
                                         uncertainty =       0.023137290688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741736072131
                                         uncertainty =       0.023137290688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367785176
  error estimate for blocks of size 2^( 2) =       0.001440804685
  error estimate for blocks of size 2^( 3) =       0.001504782890
  error estimate for blocks of size 2^( 4) =       0.001549498196
  error estimate for blocks of size 2^( 5) =       0.001572478575
  error estimate for blocks of size 2^( 6) =       0.001587872242
  error estimate for blocks of size 2^( 7) =       0.001598695247

      target function =                  N/A
              le_mean =     -22.325912196826
             les_mean =     502.136418597391
             stat err =       0.001577136065
             autocorr =       1.329543468747
              std dev =       1.934371295650
             le_variance =       3.741792309436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741736057752
                                         uncertainty =       0.023137290468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741736057752
                                         uncertainty =       0.023137290468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367785173
  error estimate for blocks of size 2^( 2) =       0.001440804685
  error estimate for blocks of size 2^( 3) =       0.001504782894
  error estimate for blocks of size 2^( 4) =       0.001549498201
  error estimate for blocks of size 2^( 5) =       0.001572478578
  error estimate for blocks of size 2^( 6) =       0.001587872244
  error estimate for blocks of size 2^( 7) =       0.001598695250

      target function =                  N/A
              le_mean =     -22.325912195702
             les_mean =     502.136418670664
             stat err =       0.001577136068
             autocorr =       1.329543479301
              std dev =       1.934371291906
             le_variance =       3.741792294951


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325912195542        initial
     1.3235e+03     1.3235e+04             4.4018e-07       -22.325912198112  <--
     5.2940e+03     5.2940e+04             1.1006e-07       -22.325912196826
     2.1176e+04     2.1176e+05             2.7517e-08       -22.325912195702

*****************************************************************************
Applying the update for shift_i =   1.3235e+03     and shift_s =   1.3235e+04
*****************************************************************************

  Execution time = 4.6399e+01
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187507e-02 3 1  ON 2
ci_004                -6.235955e-02 3 1  ON 3
ci_005                 4.604129e-02 3 1  ON 4
ci_006                 4.618049e-02 3 1  ON 5
ci_007                 3.181061e-02 3 1  ON 6
ci_008                 3.146491e-02 3 1  ON 7
ci_009                -2.501957e-02 3 1  ON 8
ci_010                -2.551367e-02 3 1  ON 9
ci_011                -2.288302e-02 3 1  ON 10
ci_012                -2.257784e-02 3 1  ON 11
ci_013                 2.000240e-02 3 1  ON 12
ci_014                 2.020260e-02 3 1  ON 13
ci_015                 1.969160e-02 3 1  ON 14
ci_016                 2.073102e-02 3 1  ON 15
ci_017                 1.537570e-02 3 1  ON 16
ci_018                 1.572885e-02 3 1  ON 17
ci_019                 1.062681e-02 3 1  ON 18
ci_020                 1.043516e-02 3 1  ON 19
ci_021                -9.780183e-03 3 1  ON 20
ci_022                -9.448253e-03 3 1  ON 21
ci_023                 8.747301e-03 3 1  ON 22
ci_024                 9.498336e-03 3 1  ON 23
ci_025                 7.145574e-03 3 1  ON 24
ci_026                 8.157899e-03 3 1  ON 25
ci_027                 7.925698e-03 3 1  ON 26
ci_028                 7.864876e-03 3 1  ON 27
ci_029                -7.651864e-03 3 1  ON 28
ci_030                -7.767808e-03 3 1  ON 29
ci_031                -7.191288e-03 3 1  ON 30
ci_032                -7.558589e-03 3 1  ON 31
ci_033                 6.847118e-03 3 1  ON 32
ci_034                 6.332008e-03 3 1  ON 33
ci_035                 6.422869e-03 3 1  ON 34
ci_036                 6.953286e-03 3 1  ON 35
ci_037                 6.517789e-03 3 1  ON 36
ci_038                 5.614368e-03 3 1  ON 37
ci_039                 5.905004e-03 3 1  ON 38
ci_040                 6.141710e-03 3 1  ON 39
ci_041                 5.432173e-03 3 1  ON 40
ci_042                 5.115355e-03 3 1  ON 41
ci_043                 5.093045e-03 3 1  ON 42
ci_044                 4.460078e-03 3 1  ON 43
ci_045                 5.122830e-03 3 1  ON 44
ci_046                 5.280972e-03 3 1  ON 45
ci_047                -3.977086e-03 3 1  ON 46
ci_048                -4.394829e-03 3 1  ON 47
ci_049                 4.051844e-03 3 1  ON 48
ci_050                 3.469694e-03 3 1  ON 49
ci_051                -3.068294e-03 3 1  ON 50
ci_052                -2.205198e-03 3 1  ON 51
ci_053                -2.741893e-03 3 1  ON 52
ci_054                -3.446548e-03 3 1  ON 53
ci_055                -1.934039e-03 3 1  ON 54
ci_056                -2.000862e-03 3 1  ON 55
ci_057                -1.788208e-03 3 1  ON 56
ci_058                -1.820672e-03 3 1  ON 57
ci_059                -1.892241e-03 3 1  ON 58
ci_060                -2.080897e-03 3 1  ON 59
ci_061                -1.839854e-03 3 1  ON 60
ci_062                -1.917286e-03 3 1  ON 61
ci_063                -1.941799e-03 3 1  ON 62
ci_064                -9.419231e-04 3 1  ON 63
ci_065                -1.763416e-03 3 1  ON 64
ci_066                -1.417261e-03 3 1  ON 65
ci_067                -1.965018e-03 3 1  ON 66
ci_068                -1.528104e-03 3 1  ON 67
ci_069                 1.160950e-03 3 1  ON 68
ci_070                 1.597921e-03 3 1  ON 69
ci_071                 1.883903e-05 3 1  ON 70
ci_072                -2.575882e-04 3 1  ON 71
ci_073                 1.366730e-03 3 1  ON 72
ci_074                 8.916443e-04 3 1  ON 73
ci_075                -1.333660e-03 3 1  ON 74
ci_076                -7.294400e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6155e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2304e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.1757
    reference variance = 4.55545
====================================================
  Execution time = 2.3894e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0277e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.9151e+00
  Total weights = 1.949900219e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9996e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.971553714879
                                         uncertainty =       0.172809165796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.971553714879
                                         uncertainty =       0.172809165796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001408992655
  error estimate for blocks of size 2^( 2) =       0.001477800001
  error estimate for blocks of size 2^( 3) =       0.001539510638
  error estimate for blocks of size 2^( 4) =       0.001580750348
  error estimate for blocks of size 2^( 5) =       0.001604839396
  error estimate for blocks of size 2^( 6) =       0.001614500883
  error estimate for blocks of size 2^( 7) =       0.001616771951

      target function =                  N/A
              le_mean =     -22.328745054185
             les_mean =     502.487981358998
             stat err =       0.001604215644
             autocorr =       1.296307506721
              std dev =       1.992648404280
             le_variance =       3.970647663078


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232874505419e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+02, overlap shift 3.3087e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328745053367       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328745112285       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328745112425       residual = 2.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+02 is 1.108828e-06

solving harmonic davidson linear method for identity shift 1.3235e+03, overlap shift 1.3235e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328745053367       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328745068102       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328745068138       residual = 2.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+03 is 2.773228e-07

solving harmonic davidson linear method for identity shift 5.2940e+03, overlap shift 5.2940e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328745053367       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328745057051       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328745057060       residual = 2.71e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+03 is 6.933795e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123861 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9900e+01
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_001                -6.963151e-01 3 1  ON 0
ci_002                -7.040964e-01 3 1  ON 1
ci_003                -6.187492e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604119e-02 3 1  ON 4
ci_006                 4.618070e-02 3 1  ON 5
ci_007                 3.181058e-02 3 1  ON 6
ci_008                 3.146500e-02 3 1  ON 7
ci_009                -2.501963e-02 3 1  ON 8
ci_010                -2.551349e-02 3 1  ON 9
ci_011                -2.288281e-02 3 1  ON 10
ci_012                -2.257794e-02 3 1  ON 11
ci_013                 2.000223e-02 3 1  ON 12
ci_014                 2.020269e-02 3 1  ON 13
ci_015                 1.969164e-02 3 1  ON 14
ci_016                 2.073081e-02 3 1  ON 15
ci_017                 1.537580e-02 3 1  ON 16
ci_018                 1.572882e-02 3 1  ON 17
ci_019                 1.062690e-02 3 1  ON 18
ci_020                 1.043520e-02 3 1  ON 19
ci_021                -9.780031e-03 3 1  ON 20
ci_022                -9.448375e-03 3 1  ON 21
ci_023                 8.747133e-03 3 1  ON 22
ci_024                 9.498108e-03 3 1  ON 23
ci_025                 7.145655e-03 3 1  ON 24
ci_026                 8.158063e-03 3 1  ON 25
ci_027                 7.925670e-03 3 1  ON 26
ci_028                 7.864919e-03 3 1  ON 27
ci_029                -7.652040e-03 3 1  ON 28
ci_030                -7.767607e-03 3 1  ON 29
ci_031                -7.191205e-03 3 1  ON 30
ci_032                -7.558331e-03 3 1  ON 31
ci_033                 6.846898e-03 3 1  ON 32
ci_034                 6.332094e-03 3 1  ON 33
ci_035                 6.422927e-03 3 1  ON 34
ci_036                 6.953244e-03 3 1  ON 35
ci_037                 6.517692e-03 3 1  ON 36
ci_038                 5.614466e-03 3 1  ON 37
ci_039                 5.904913e-03 3 1  ON 38
ci_040                 6.141603e-03 3 1  ON 39
ci_041                 5.432084e-03 3 1  ON 40
ci_042                 5.115296e-03 3 1  ON 41
ci_043                 5.093049e-03 3 1  ON 42
ci_044                 4.460248e-03 3 1  ON 43
ci_045                 5.122895e-03 3 1  ON 44
ci_046                 5.280926e-03 3 1  ON 45
ci_047                -3.977306e-03 3 1  ON 46
ci_048                -4.394832e-03 3 1  ON 47
ci_049                 4.051962e-03 3 1  ON 48
ci_050                 3.469544e-03 3 1  ON 49
ci_051                -3.068221e-03 3 1  ON 50
ci_052                -2.205238e-03 3 1  ON 51
ci_053                -2.741855e-03 3 1  ON 52
ci_054                -3.446517e-03 3 1  ON 53
ci_055                -1.933970e-03 3 1  ON 54
ci_056                -2.000599e-03 3 1  ON 55
ci_057                -1.788118e-03 3 1  ON 56
ci_058                -1.820854e-03 3 1  ON 57
ci_059                -1.892383e-03 3 1  ON 58
ci_060                -2.080955e-03 3 1  ON 59
ci_061                -1.839900e-03 3 1  ON 60
ci_062                -1.917337e-03 3 1  ON 61
ci_063                -1.941821e-03 3 1  ON 62
ci_064                -9.420014e-04 3 1  ON 63
ci_065                -1.763304e-03 3 1  ON 64
ci_066                -1.417477e-03 3 1  ON 65
ci_067                -1.965125e-03 3 1  ON 66
ci_068                -1.528052e-03 3 1  ON 67
ci_069                 1.160928e-03 3 1  ON 68
ci_070                 1.597933e-03 3 1  ON 69
ci_071                 1.879373e-05 3 1  ON 70
ci_072                -2.578655e-04 3 1  ON 71
ci_073                 1.366750e-03 3 1  ON 72
ci_074                 8.917055e-04 3 1  ON 73
ci_075                -1.333567e-03 3 1  ON 74
ci_076                -7.294483e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.258
    reference variance = 2.69153
====================================================
  Execution time = 2.3200e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7942e+00
  Total weights = 1.9499e+06
  Execution time = 4.3841e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.847126962847
                                         uncertainty =       0.059750666573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.847126962847
                                         uncertainty =       0.059750666573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386819552
  error estimate for blocks of size 2^( 2) =       0.001458779882
  error estimate for blocks of size 2^( 3) =       0.001522620940
  error estimate for blocks of size 2^( 4) =       0.001565466691
  error estimate for blocks of size 2^( 5) =       0.001589847597
  error estimate for blocks of size 2^( 6) =       0.001602725348
  error estimate for blocks of size 2^( 7) =       0.001614251025

      target function =                  N/A
              le_mean =     -22.325492525580
             les_mean =     502.221853462433
             stat err =       0.001593072665
             autocorr =       1.319566434648
              std dev =       1.961290398760
             le_variance =       3.846660028269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.847126918116
                                         uncertainty =       0.059750662277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.847126918116
                                         uncertainty =       0.059750662277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386819543
  error estimate for blocks of size 2^( 2) =       0.001458779878
  error estimate for blocks of size 2^( 3) =       0.001522620944
  error estimate for blocks of size 2^( 4) =       0.001565466721
  error estimate for blocks of size 2^( 5) =       0.001589847642
  error estimate for blocks of size 2^( 6) =       0.001602725414
  error estimate for blocks of size 2^( 7) =       0.001614251059

      target function =                  N/A
              le_mean =     -22.325492517721
             les_mean =     502.221853001179
             stat err =       0.001593072709
             autocorr =       1.319566523110
              std dev =       1.961290386684
             le_variance =       3.846659980899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.847126940425
                                         uncertainty =       0.059750664423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.847126940425
                                         uncertainty =       0.059750664423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386819548
  error estimate for blocks of size 2^( 2) =       0.001458779880
  error estimate for blocks of size 2^( 3) =       0.001522620942
  error estimate for blocks of size 2^( 4) =       0.001565466706
  error estimate for blocks of size 2^( 5) =       0.001589847620
  error estimate for blocks of size 2^( 6) =       0.001602725381
  error estimate for blocks of size 2^( 7) =       0.001614251042

      target function =                  N/A
              le_mean =     -22.325492521644
             les_mean =     502.221853202861
             stat err =       0.001593072687
             autocorr =       1.319566478904
              std dev =       1.961290392708
             le_variance =       3.846660004528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.847126960040
                                         uncertainty =       0.059750666304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.847126960040
                                         uncertainty =       0.059750666304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386819551
  error estimate for blocks of size 2^( 2) =       0.001458779882
  error estimate for blocks of size 2^( 3) =       0.001522620940
  error estimate for blocks of size 2^( 4) =       0.001565466693
  error estimate for blocks of size 2^( 5) =       0.001589847600
  error estimate for blocks of size 2^( 6) =       0.001602725352
  error estimate for blocks of size 2^( 7) =       0.001614251027

      target function =                  N/A
              le_mean =     -22.325492525087
             les_mean =     502.221853427576
             stat err =       0.001593072668
             autocorr =       1.319566440181
              std dev =       1.961290398003
             le_variance =       3.846660025297


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325492525580        initial  <--
     3.3087e+02     3.3087e+03             1.1088e-06       -22.325492517721
     1.3235e+03     1.3235e+04             2.7732e-07       -22.325492521644
     5.2940e+03     5.2940e+04             6.9338e-08       -22.325492525087

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1710
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187507e-02 3 1  ON 2
ci_004                -6.235955e-02 3 1  ON 3
ci_005                 4.604129e-02 3 1  ON 4
ci_006                 4.618049e-02 3 1  ON 5
ci_007                 3.181061e-02 3 1  ON 6
ci_008                 3.146491e-02 3 1  ON 7
ci_009                -2.501957e-02 3 1  ON 8
ci_010                -2.551367e-02 3 1  ON 9
ci_011                -2.288302e-02 3 1  ON 10
ci_012                -2.257784e-02 3 1  ON 11
ci_013                 2.000240e-02 3 1  ON 12
ci_014                 2.020260e-02 3 1  ON 13
ci_015                 1.969160e-02 3 1  ON 14
ci_016                 2.073102e-02 3 1  ON 15
ci_017                 1.537570e-02 3 1  ON 16
ci_018                 1.572885e-02 3 1  ON 17
ci_019                 1.062681e-02 3 1  ON 18
ci_020                 1.043516e-02 3 1  ON 19
ci_021                -9.780183e-03 3 1  ON 20
ci_022                -9.448253e-03 3 1  ON 21
ci_023                 8.747301e-03 3 1  ON 22
ci_024                 9.498336e-03 3 1  ON 23
ci_025                 7.145574e-03 3 1  ON 24
ci_026                 8.157899e-03 3 1  ON 25
ci_027                 7.925698e-03 3 1  ON 26
ci_028                 7.864876e-03 3 1  ON 27
ci_029                -7.651864e-03 3 1  ON 28
ci_030                -7.767808e-03 3 1  ON 29
ci_031                -7.191288e-03 3 1  ON 30
ci_032                -7.558589e-03 3 1  ON 31
ci_033                 6.847118e-03 3 1  ON 32
ci_034                 6.332008e-03 3 1  ON 33
ci_035                 6.422869e-03 3 1  ON 34
ci_036                 6.953286e-03 3 1  ON 35
ci_037                 6.517789e-03 3 1  ON 36
ci_038                 5.614368e-03 3 1  ON 37
ci_039                 5.905004e-03 3 1  ON 38
ci_040                 6.141710e-03 3 1  ON 39
ci_041                 5.432173e-03 3 1  ON 40
ci_042                 5.115355e-03 3 1  ON 41
ci_043                 5.093045e-03 3 1  ON 42
ci_044                 4.460078e-03 3 1  ON 43
ci_045                 5.122830e-03 3 1  ON 44
ci_046                 5.280972e-03 3 1  ON 45
ci_047                -3.977086e-03 3 1  ON 46
ci_048                -4.394829e-03 3 1  ON 47
ci_049                 4.051844e-03 3 1  ON 48
ci_050                 3.469694e-03 3 1  ON 49
ci_051                -3.068294e-03 3 1  ON 50
ci_052                -2.205198e-03 3 1  ON 51
ci_053                -2.741893e-03 3 1  ON 52
ci_054                -3.446548e-03 3 1  ON 53
ci_055                -1.934039e-03 3 1  ON 54
ci_056                -2.000862e-03 3 1  ON 55
ci_057                -1.788208e-03 3 1  ON 56
ci_058                -1.820672e-03 3 1  ON 57
ci_059                -1.892241e-03 3 1  ON 58
ci_060                -2.080897e-03 3 1  ON 59
ci_061                -1.839854e-03 3 1  ON 60
ci_062                -1.917286e-03 3 1  ON 61
ci_063                -1.941799e-03 3 1  ON 62
ci_064                -9.419231e-04 3 1  ON 63
ci_065                -1.763416e-03 3 1  ON 64
ci_066                -1.417261e-03 3 1  ON 65
ci_067                -1.965018e-03 3 1  ON 66
ci_068                -1.528104e-03 3 1  ON 67
ci_069                 1.160950e-03 3 1  ON 68
ci_070                 1.597921e-03 3 1  ON 69
ci_071                 1.883903e-05 3 1  ON 70
ci_072                -2.575882e-04 3 1  ON 71
ci_073                 1.366730e-03 3 1  ON 72
ci_074                 8.916443e-04 3 1  ON 73
ci_075                -1.333660e-03 3 1  ON 74
ci_076                -7.294400e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5079e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2303e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.0283
    reference variance = 4.21743
====================================================
  Execution time = 2.3705e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0315e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7861e+00
  Total weights = 1.949955762e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9836e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.838498753476
                                         uncertainty =       0.043082122915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.838498753476
                                         uncertainty =       0.043082122915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385395131
  error estimate for blocks of size 2^( 2) =       0.001457081675
  error estimate for blocks of size 2^( 3) =       0.001519904768
  error estimate for blocks of size 2^( 4) =       0.001564015398
  error estimate for blocks of size 2^( 5) =       0.001587751341
  error estimate for blocks of size 2^( 6) =       0.001603581070
  error estimate for blocks of size 2^( 7) =       0.001613019651

      target function =                  N/A
              le_mean =     -22.326854285888
             les_mean =     502.274542325925
             stat err =       0.001592091865
             autocorr =       1.320653639756
              std dev =       1.959275931336
             le_variance =       3.838762175113


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232685428589e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+03, overlap shift 3.3087e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326854285068       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326854289762       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326854289748       residual = 1.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+03 is 1.048260e-07

solving harmonic davidson linear method for identity shift 1.3235e+04, overlap shift 1.3235e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326854285068       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326854286241       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326854286238       residual = 1.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+04 is 2.620738e-08

solving harmonic davidson linear method for identity shift 5.2940e+04, overlap shift 5.2940e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326854285068       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326854285361       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326854285360       residual = 1.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+04 is 6.551900e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125061 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9696e+01
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_001                -6.963150e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187506e-02 3 1  ON 2
ci_004                -6.235954e-02 3 1  ON 3
ci_005                 4.604129e-02 3 1  ON 4
ci_006                 4.618049e-02 3 1  ON 5
ci_007                 3.181062e-02 3 1  ON 6
ci_008                 3.146491e-02 3 1  ON 7
ci_009                -2.501957e-02 3 1  ON 8
ci_010                -2.551367e-02 3 1  ON 9
ci_011                -2.288300e-02 3 1  ON 10
ci_012                -2.257783e-02 3 1  ON 11
ci_013                 2.000241e-02 3 1  ON 12
ci_014                 2.020261e-02 3 1  ON 13
ci_015                 1.969161e-02 3 1  ON 14
ci_016                 2.073103e-02 3 1  ON 15
ci_017                 1.537572e-02 3 1  ON 16
ci_018                 1.572884e-02 3 1  ON 17
ci_019                 1.062679e-02 3 1  ON 18
ci_020                 1.043516e-02 3 1  ON 19
ci_021                -9.780175e-03 3 1  ON 20
ci_022                -9.448246e-03 3 1  ON 21
ci_023                 8.747302e-03 3 1  ON 22
ci_024                 9.498334e-03 3 1  ON 23
ci_025                 7.145594e-03 3 1  ON 24
ci_026                 8.157898e-03 3 1  ON 25
ci_027                 7.925693e-03 3 1  ON 26
ci_028                 7.864881e-03 3 1  ON 27
ci_029                -7.651881e-03 3 1  ON 28
ci_030                -7.767813e-03 3 1  ON 29
ci_031                -7.191301e-03 3 1  ON 30
ci_032                -7.558590e-03 3 1  ON 31
ci_033                 6.847114e-03 3 1  ON 32
ci_034                 6.332009e-03 3 1  ON 33
ci_035                 6.422870e-03 3 1  ON 34
ci_036                 6.953272e-03 3 1  ON 35
ci_037                 6.517800e-03 3 1  ON 36
ci_038                 5.614385e-03 3 1  ON 37
ci_039                 5.905008e-03 3 1  ON 38
ci_040                 6.141698e-03 3 1  ON 39
ci_041                 5.432180e-03 3 1  ON 40
ci_042                 5.115373e-03 3 1  ON 41
ci_043                 5.093059e-03 3 1  ON 42
ci_044                 4.460077e-03 3 1  ON 43
ci_045                 5.122832e-03 3 1  ON 44
ci_046                 5.280974e-03 3 1  ON 45
ci_047                -3.977089e-03 3 1  ON 46
ci_048                -4.394821e-03 3 1  ON 47
ci_049                 4.051836e-03 3 1  ON 48
ci_050                 3.469678e-03 3 1  ON 49
ci_051                -3.068294e-03 3 1  ON 50
ci_052                -2.205205e-03 3 1  ON 51
ci_053                -2.741882e-03 3 1  ON 52
ci_054                -3.446525e-03 3 1  ON 53
ci_055                -1.934028e-03 3 1  ON 54
ci_056                -2.000880e-03 3 1  ON 55
ci_057                -1.788210e-03 3 1  ON 56
ci_058                -1.820680e-03 3 1  ON 57
ci_059                -1.892244e-03 3 1  ON 58
ci_060                -2.080899e-03 3 1  ON 59
ci_061                -1.839834e-03 3 1  ON 60
ci_062                -1.917283e-03 3 1  ON 61
ci_063                -1.941798e-03 3 1  ON 62
ci_064                -9.419233e-04 3 1  ON 63
ci_065                -1.763413e-03 3 1  ON 64
ci_066                -1.417250e-03 3 1  ON 65
ci_067                -1.965008e-03 3 1  ON 66
ci_068                -1.528078e-03 3 1  ON 67
ci_069                 1.160956e-03 3 1  ON 68
ci_070                 1.597925e-03 3 1  ON 69
ci_071                 1.882042e-05 3 1  ON 70
ci_072                -2.575934e-04 3 1  ON 71
ci_073                 1.366717e-03 3 1  ON 72
ci_074                 8.916626e-04 3 1  ON 73
ci_075                -1.333654e-03 3 1  ON 74
ci_076                -7.294615e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.2804
    reference variance = 3.48164
====================================================
  Execution time = 2.3167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7905e+00
  Total weights = 1.9498e+06
  Execution time = 4.4016e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844572509599
                                         uncertainty =       0.081647150218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844572509599
                                         uncertainty =       0.081647150218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386382704
  error estimate for blocks of size 2^( 2) =       0.001455651603
  error estimate for blocks of size 2^( 3) =       0.001518083612
  error estimate for blocks of size 2^( 4) =       0.001559799040
  error estimate for blocks of size 2^( 5) =       0.001583334090
  error estimate for blocks of size 2^( 6) =       0.001595351716
  error estimate for blocks of size 2^( 7) =       0.001607289692

      target function =                  N/A
              le_mean =     -22.329097703935
             les_mean =     502.379078408353
             stat err =       0.001586443635
             autocorr =       1.309432240328
              std dev =       1.960672592499
             le_variance =       3.844237014975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844572504198
                                         uncertainty =       0.081647150732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844572504198
                                         uncertainty =       0.081647150732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386382703
  error estimate for blocks of size 2^( 2) =       0.001455651603
  error estimate for blocks of size 2^( 3) =       0.001518083612
  error estimate for blocks of size 2^( 4) =       0.001559799041
  error estimate for blocks of size 2^( 5) =       0.001583334090
  error estimate for blocks of size 2^( 6) =       0.001595351714
  error estimate for blocks of size 2^( 7) =       0.001607289685

      target function =                  N/A
              le_mean =     -22.329097703957
             les_mean =     502.379078319652
             stat err =       0.001586443633
             autocorr =       1.309432238901
              std dev =       1.960672591042
             le_variance =       3.844237009262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844572506898
                                         uncertainty =       0.081647150475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844572506898
                                         uncertainty =       0.081647150475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386382703
  error estimate for blocks of size 2^( 2) =       0.001455651603
  error estimate for blocks of size 2^( 3) =       0.001518083612
  error estimate for blocks of size 2^( 4) =       0.001559799041
  error estimate for blocks of size 2^( 5) =       0.001583334090
  error estimate for blocks of size 2^( 6) =       0.001595351715
  error estimate for blocks of size 2^( 7) =       0.001607289689

      target function =                  N/A
              le_mean =     -22.329097703946
             les_mean =     502.379078363960
             stat err =       0.001586443634
             autocorr =       1.309432239614
              std dev =       1.960672591770
             le_variance =       3.844237012119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844572509261
                                         uncertainty =       0.081647150250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844572509261
                                         uncertainty =       0.081647150250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386382704
  error estimate for blocks of size 2^( 2) =       0.001455651603
  error estimate for blocks of size 2^( 3) =       0.001518083612
  error estimate for blocks of size 2^( 4) =       0.001559799041
  error estimate for blocks of size 2^( 5) =       0.001583334090
  error estimate for blocks of size 2^( 6) =       0.001595351716
  error estimate for blocks of size 2^( 7) =       0.001607289692

      target function =                  N/A
              le_mean =     -22.329097703937
             les_mean =     502.379078402800
             stat err =       0.001586443634
             autocorr =       1.309432240240
              std dev =       1.960672592408
             le_variance =       3.844237014618


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329097703935        initial
     3.3087e+03     3.3087e+04             1.0483e-07       -22.329097703957  <--
     1.3235e+04     1.3235e+05             2.6207e-08       -22.329097703946
     5.2940e+04     5.2940e+05             6.5519e-09       -22.329097703937

*****************************************************************************
Applying the update for shift_i =   3.3087e+03     and shift_s =   3.3087e+04
*****************************************************************************

  Execution time = 4.5233e+01
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_001                -6.963149e-01 3 1  ON 0
ci_002                -7.040965e-01 3 1  ON 1
ci_003                -6.187501e-02 3 1  ON 2
ci_004                -6.235952e-02 3 1  ON 3
ci_005                 4.604128e-02 3 1  ON 4
ci_006                 4.618048e-02 3 1  ON 5
ci_007                 3.181063e-02 3 1  ON 6
ci_008                 3.146491e-02 3 1  ON 7
ci_009                -2.501956e-02 3 1  ON 8
ci_010                -2.551365e-02 3 1  ON 9
ci_011                -2.288292e-02 3 1  ON 10
ci_012                -2.257779e-02 3 1  ON 11
ci_013                 2.000246e-02 3 1  ON 12
ci_014                 2.020266e-02 3 1  ON 13
ci_015                 1.969165e-02 3 1  ON 14
ci_016                 2.073104e-02 3 1  ON 15
ci_017                 1.537577e-02 3 1  ON 16
ci_018                 1.572882e-02 3 1  ON 17
ci_019                 1.062672e-02 3 1  ON 18
ci_020                 1.043514e-02 3 1  ON 19
ci_021                -9.780152e-03 3 1  ON 20
ci_022                -9.448224e-03 3 1  ON 21
ci_023                 8.747306e-03 3 1  ON 22
ci_024                 9.498327e-03 3 1  ON 23
ci_025                 7.145652e-03 3 1  ON 24
ci_026                 8.157895e-03 3 1  ON 25
ci_027                 7.925681e-03 3 1  ON 26
ci_028                 7.864896e-03 3 1  ON 27
ci_029                -7.651932e-03 3 1  ON 28
ci_030                -7.767826e-03 3 1  ON 29
ci_031                -7.191337e-03 3 1  ON 30
ci_032                -7.558590e-03 3 1  ON 31
ci_033                 6.847103e-03 3 1  ON 32
ci_034                 6.332012e-03 3 1  ON 33
ci_035                 6.422873e-03 3 1  ON 34
ci_036                 6.953227e-03 3 1  ON 35
ci_037                 6.517834e-03 3 1  ON 36
ci_038                 5.614437e-03 3 1  ON 37
ci_039                 5.905020e-03 3 1  ON 38
ci_040                 6.141660e-03 3 1  ON 39
ci_041                 5.432199e-03 3 1  ON 40
ci_042                 5.115426e-03 3 1  ON 41
ci_043                 5.093100e-03 3 1  ON 42
ci_044                 4.460072e-03 3 1  ON 43
ci_045                 5.122837e-03 3 1  ON 44
ci_046                 5.280981e-03 3 1  ON 45
ci_047                -3.977097e-03 3 1  ON 46
ci_048                -4.394799e-03 3 1  ON 47
ci_049                 4.051810e-03 3 1  ON 48
ci_050                 3.469629e-03 3 1  ON 49
ci_051                -3.068293e-03 3 1  ON 50
ci_052                -2.205227e-03 3 1  ON 51
ci_053                -2.741849e-03 3 1  ON 52
ci_054                -3.446455e-03 3 1  ON 53
ci_055                -1.933994e-03 3 1  ON 54
ci_056                -2.000936e-03 3 1  ON 55
ci_057                -1.788215e-03 3 1  ON 56
ci_058                -1.820705e-03 3 1  ON 57
ci_059                -1.892255e-03 3 1  ON 58
ci_060                -2.080906e-03 3 1  ON 59
ci_061                -1.839773e-03 3 1  ON 60
ci_062                -1.917271e-03 3 1  ON 61
ci_063                -1.941796e-03 3 1  ON 62
ci_064                -9.419237e-04 3 1  ON 63
ci_065                -1.763403e-03 3 1  ON 64
ci_066                -1.417219e-03 3 1  ON 65
ci_067                -1.964977e-03 3 1  ON 66
ci_068                -1.527999e-03 3 1  ON 67
ci_069                 1.160973e-03 3 1  ON 68
ci_070                 1.597937e-03 3 1  ON 69
ci_071                 1.876458e-05 3 1  ON 70
ci_072                -2.576089e-04 3 1  ON 71
ci_073                 1.366680e-03 3 1  ON 72
ci_074                 8.917173e-04 3 1  ON 73
ci_075                -1.333635e-03 3 1  ON 74
ci_076                -7.295261e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4936e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2301e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.2949
    reference variance = 3.17166
====================================================
  Execution time = 2.3732e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0272e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6843e+00
  Total weights = 1.949781028e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9943e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.736265661890
                                         uncertainty =       0.039733418855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.736265661890
                                         uncertainty =       0.039733418855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366784293
  error estimate for blocks of size 2^( 2) =       0.001438421012
  error estimate for blocks of size 2^( 3) =       0.001502087405
  error estimate for blocks of size 2^( 4) =       0.001546399542
  error estimate for blocks of size 2^( 5) =       0.001569013411
  error estimate for blocks of size 2^( 6) =       0.001584188480
  error estimate for blocks of size 2^( 7) =       0.001593223335

      target function =                  N/A
              le_mean =     -22.329162056275
             les_mean =     502.275786731694
             stat err =       0.001573206192
             autocorr =       1.324864110680
              std dev =       1.932955810632
             le_variance =       3.736318165856


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232916205627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+02, overlap shift 8.2718e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329162055436       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329162077690       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329162077839       residual = 4.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+02 is 4.064280e-07

solving harmonic davidson linear method for identity shift 3.3087e+03, overlap shift 3.3087e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329162055436       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329162061000       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329162061038       residual = 4.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+03 is 1.016208e-07

solving harmonic davidson linear method for identity shift 1.3235e+04, overlap shift 1.3235e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329162055436       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329162056827       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329162056836       residual = 4.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+04 is 2.540605e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126259 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9733e+01
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_001                -6.963149e-01 3 1  ON 0
ci_002                -7.040966e-01 3 1  ON 1
ci_003                -6.187507e-02 3 1  ON 2
ci_004                -6.235951e-02 3 1  ON 3
ci_005                 4.604125e-02 3 1  ON 4
ci_006                 4.618043e-02 3 1  ON 5
ci_007                 3.181069e-02 3 1  ON 6
ci_008                 3.146490e-02 3 1  ON 7
ci_009                -2.501957e-02 3 1  ON 8
ci_010                -2.551359e-02 3 1  ON 9
ci_011                -2.288296e-02 3 1  ON 10
ci_012                -2.257774e-02 3 1  ON 11
ci_013                 2.000247e-02 3 1  ON 12
ci_014                 2.020265e-02 3 1  ON 13
ci_015                 1.969170e-02 3 1  ON 14
ci_016                 2.073108e-02 3 1  ON 15
ci_017                 1.537579e-02 3 1  ON 16
ci_018                 1.572881e-02 3 1  ON 17
ci_019                 1.062665e-02 3 1  ON 18
ci_020                 1.043511e-02 3 1  ON 19
ci_021                -9.780106e-03 3 1  ON 20
ci_022                -9.448230e-03 3 1  ON 21
ci_023                 8.747263e-03 3 1  ON 22
ci_024                 9.498274e-03 3 1  ON 23
ci_025                 7.145719e-03 3 1  ON 24
ci_026                 8.157882e-03 3 1  ON 25
ci_027                 7.925612e-03 3 1  ON 26
ci_028                 7.864867e-03 3 1  ON 27
ci_029                -7.651907e-03 3 1  ON 28
ci_030                -7.767813e-03 3 1  ON 29
ci_031                -7.191327e-03 3 1  ON 30
ci_032                -7.558583e-03 3 1  ON 31
ci_033                 6.847099e-03 3 1  ON 32
ci_034                 6.332003e-03 3 1  ON 33
ci_035                 6.422906e-03 3 1  ON 34
ci_036                 6.953198e-03 3 1  ON 35
ci_037                 6.517772e-03 3 1  ON 36
ci_038                 5.614525e-03 3 1  ON 37
ci_039                 5.904949e-03 3 1  ON 38
ci_040                 6.141601e-03 3 1  ON 39
ci_041                 5.432145e-03 3 1  ON 40
ci_042                 5.115507e-03 3 1  ON 41
ci_043                 5.093076e-03 3 1  ON 42
ci_044                 4.460058e-03 3 1  ON 43
ci_045                 5.122801e-03 3 1  ON 44
ci_046                 5.280981e-03 3 1  ON 45
ci_047                -3.977078e-03 3 1  ON 46
ci_048                -4.394770e-03 3 1  ON 47
ci_049                 4.051733e-03 3 1  ON 48
ci_050                 3.469635e-03 3 1  ON 49
ci_051                -3.068255e-03 3 1  ON 50
ci_052                -2.205275e-03 3 1  ON 51
ci_053                -2.741811e-03 3 1  ON 52
ci_054                -3.446466e-03 3 1  ON 53
ci_055                -1.934070e-03 3 1  ON 54
ci_056                -2.000917e-03 3 1  ON 55
ci_057                -1.788204e-03 3 1  ON 56
ci_058                -1.820774e-03 3 1  ON 57
ci_059                -1.892256e-03 3 1  ON 58
ci_060                -2.080906e-03 3 1  ON 59
ci_061                -1.839755e-03 3 1  ON 60
ci_062                -1.917208e-03 3 1  ON 61
ci_063                -1.941809e-03 3 1  ON 62
ci_064                -9.418832e-04 3 1  ON 63
ci_065                -1.763382e-03 3 1  ON 64
ci_066                -1.417216e-03 3 1  ON 65
ci_067                -1.964875e-03 3 1  ON 66
ci_068                -1.527943e-03 3 1  ON 67
ci_069                 1.160990e-03 3 1  ON 68
ci_070                 1.597937e-03 3 1  ON 69
ci_071                 1.874990e-05 3 1  ON 70
ci_072                -2.575976e-04 3 1  ON 71
ci_073                 1.366640e-03 3 1  ON 72
ci_074                 8.917805e-04 3 1  ON 73
ci_075                -1.333642e-03 3 1  ON 74
ci_076                -7.295740e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.4265
    reference variance = 2.40896
====================================================
  Execution time = 2.3168e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7409e+00
  Total weights = 1.9496e+06
  Execution time = 4.3989e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794313365328
                                         uncertainty =       0.045396796470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794313365328
                                         uncertainty =       0.045396796470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377412711
  error estimate for blocks of size 2^( 2) =       0.001447822030
  error estimate for blocks of size 2^( 3) =       0.001510600224
  error estimate for blocks of size 2^( 4) =       0.001552663304
  error estimate for blocks of size 2^( 5) =       0.001575755826
  error estimate for blocks of size 2^( 6) =       0.001585498761
  error estimate for blocks of size 2^( 7) =       0.001594734323

      target function =                  N/A
              le_mean =     -22.328995185536
             les_mean =     502.324934271924
             stat err =       0.001577163053
             autocorr =       1.311067393507
              std dev =       1.947986904170
             le_variance =       3.794652978818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794313287589
                                         uncertainty =       0.045396797202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794313287589
                                         uncertainty =       0.045396797202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377412697
  error estimate for blocks of size 2^( 2) =       0.001447822025
  error estimate for blocks of size 2^( 3) =       0.001510600225
  error estimate for blocks of size 2^( 4) =       0.001552663309
  error estimate for blocks of size 2^( 5) =       0.001575755836
  error estimate for blocks of size 2^( 6) =       0.001585498779
  error estimate for blocks of size 2^( 7) =       0.001594734353

      target function =                  N/A
              le_mean =     -22.328995190230
             les_mean =     502.324934138271
             stat err =       0.001577163069
             autocorr =       1.311067446793
              std dev =       1.947986884323
             le_variance =       3.794652901495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794313326447
                                         uncertainty =       0.045396796836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794313326447
                                         uncertainty =       0.045396796836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377412704
  error estimate for blocks of size 2^( 2) =       0.001447822028
  error estimate for blocks of size 2^( 3) =       0.001510600225
  error estimate for blocks of size 2^( 4) =       0.001552663306
  error estimate for blocks of size 2^( 5) =       0.001575755831
  error estimate for blocks of size 2^( 6) =       0.001585498770
  error estimate for blocks of size 2^( 7) =       0.001594734338

      target function =                  N/A
              le_mean =     -22.328995187883
             les_mean =     502.324934204031
             stat err =       0.001577163061
             autocorr =       1.311067420157
              std dev =       1.947986894244
             le_variance =       3.794652940145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794313360467
                                         uncertainty =       0.045396796515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794313360467
                                         uncertainty =       0.045396796515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377412710
  error estimate for blocks of size 2^( 2) =       0.001447822030
  error estimate for blocks of size 2^( 3) =       0.001510600224
  error estimate for blocks of size 2^( 4) =       0.001552663304
  error estimate for blocks of size 2^( 5) =       0.001575755827
  error estimate for blocks of size 2^( 6) =       0.001585498762
  error estimate for blocks of size 2^( 7) =       0.001594734325

      target function =                  N/A
              le_mean =     -22.328995185829
             les_mean =     502.324934263321
             stat err =       0.001577163054
             autocorr =       1.311067396839
              std dev =       1.947986902929
             le_variance =       3.794652973983


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328995185536        initial
     8.2718e+02     8.2718e+03             4.0643e-07       -22.328995190230  <--
     3.3087e+03     3.3087e+04             1.0162e-07       -22.328995187883
     1.3235e+04     1.3235e+05             2.5406e-08       -22.328995185829

*****************************************************************************
Applying the update for shift_i =   8.2718e+02     and shift_s =   8.2718e+03
*****************************************************************************

  Execution time = 4.5264e+01
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_001                -6.963147e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187528e-02 3 1  ON 2
ci_004                -6.235948e-02 3 1  ON 3
ci_005                 4.604115e-02 3 1  ON 4
ci_006                 4.618026e-02 3 1  ON 5
ci_007                 3.181087e-02 3 1  ON 6
ci_008                 3.146488e-02 3 1  ON 7
ci_009                -2.501958e-02 3 1  ON 8
ci_010                -2.551342e-02 3 1  ON 9
ci_011                -2.288307e-02 3 1  ON 10
ci_012                -2.257761e-02 3 1  ON 11
ci_013                 2.000253e-02 3 1  ON 12
ci_014                 2.020261e-02 3 1  ON 13
ci_015                 1.969185e-02 3 1  ON 14
ci_016                 2.073122e-02 3 1  ON 15
ci_017                 1.537585e-02 3 1  ON 16
ci_018                 1.572881e-02 3 1  ON 17
ci_019                 1.062643e-02 3 1  ON 18
ci_020                 1.043503e-02 3 1  ON 19
ci_021                -9.779968e-03 3 1  ON 20
ci_022                -9.448248e-03 3 1  ON 21
ci_023                 8.747134e-03 3 1  ON 22
ci_024                 9.498115e-03 3 1  ON 23
ci_025                 7.145921e-03 3 1  ON 24
ci_026                 8.157844e-03 3 1  ON 25
ci_027                 7.925406e-03 3 1  ON 26
ci_028                 7.864780e-03 3 1  ON 27
ci_029                -7.651832e-03 3 1  ON 28
ci_030                -7.767772e-03 3 1  ON 29
ci_031                -7.191297e-03 3 1  ON 30
ci_032                -7.558564e-03 3 1  ON 31
ci_033                 6.847086e-03 3 1  ON 32
ci_034                 6.331975e-03 3 1  ON 33
ci_035                 6.423005e-03 3 1  ON 34
ci_036                 6.953112e-03 3 1  ON 35
ci_037                 6.517585e-03 3 1  ON 36
ci_038                 5.614791e-03 3 1  ON 37
ci_039                 5.904737e-03 3 1  ON 38
ci_040                 6.141424e-03 3 1  ON 39
ci_041                 5.431983e-03 3 1  ON 40
ci_042                 5.115751e-03 3 1  ON 41
ci_043                 5.093004e-03 3 1  ON 42
ci_044                 4.460016e-03 3 1  ON 43
ci_045                 5.122693e-03 3 1  ON 44
ci_046                 5.280979e-03 3 1  ON 45
ci_047                -3.977022e-03 3 1  ON 46
ci_048                -4.394685e-03 3 1  ON 47
ci_049                 4.051504e-03 3 1  ON 48
ci_050                 3.469653e-03 3 1  ON 49
ci_051                -3.068140e-03 3 1  ON 50
ci_052                -2.205419e-03 3 1  ON 51
ci_053                -2.741697e-03 3 1  ON 52
ci_054                -3.446499e-03 3 1  ON 53
ci_055                -1.934297e-03 3 1  ON 54
ci_056                -2.000859e-03 3 1  ON 55
ci_057                -1.788170e-03 3 1  ON 56
ci_058                -1.820978e-03 3 1  ON 57
ci_059                -1.892259e-03 3 1  ON 58
ci_060                -2.080906e-03 3 1  ON 59
ci_061                -1.839704e-03 3 1  ON 60
ci_062                -1.917017e-03 3 1  ON 61
ci_063                -1.941850e-03 3 1  ON 62
ci_064                -9.417617e-04 3 1  ON 63
ci_065                -1.763319e-03 3 1  ON 64
ci_066                -1.417206e-03 3 1  ON 65
ci_067                -1.964571e-03 3 1  ON 66
ci_068                -1.527776e-03 3 1  ON 67
ci_069                 1.161044e-03 3 1  ON 68
ci_070                 1.597938e-03 3 1  ON 69
ci_071                 1.870586e-05 3 1  ON 70
ci_072                -2.575639e-04 3 1  ON 71
ci_073                 1.366519e-03 3 1  ON 72
ci_074                 8.919702e-04 3 1  ON 73
ci_075                -1.333663e-03 3 1  ON 74
ci_076                -7.297177e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5006e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2302e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.29
    reference variance = 2.17775
====================================================
  Execution time = 2.3874e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0316e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6873e+00
  Total weights = 1.949517760e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9735e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.736142385678
                                         uncertainty =       0.026888774829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.736142385678
                                         uncertainty =       0.026888774829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366642856
  error estimate for blocks of size 2^( 2) =       0.001438073825
  error estimate for blocks of size 2^( 3) =       0.001501152106
  error estimate for blocks of size 2^( 4) =       0.001546135955
  error estimate for blocks of size 2^( 5) =       0.001567644258
  error estimate for blocks of size 2^( 6) =       0.001579070846
  error estimate for blocks of size 2^( 7) =       0.001585113811

      target function =                  N/A
              le_mean =     -22.329693579581
             les_mean =     502.302559661802
             stat err =       0.001569491217
             autocorr =       1.318887366875
              std dev =       1.932755785840
             le_variance =       3.735544927699


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232969357958e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+02, overlap shift 2.0680e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329693578737       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329693666097       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329693666263       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+02 is 3.026672e-06

solving harmonic davidson linear method for identity shift 8.2718e+02, overlap shift 8.2718e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329693578737       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329693600592       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329693600632       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+02 is 7.570403e-07

solving harmonic davidson linear method for identity shift 3.3087e+03, overlap shift 3.3087e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329693578737       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329693584202       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329693584212       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+03 is 1.892834e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127436 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9854e+01
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040967e-01 3 1  ON 1
ci_003                -6.187548e-02 3 1  ON 2
ci_004                -6.235964e-02 3 1  ON 3
ci_005                 4.604099e-02 3 1  ON 4
ci_006                 4.618047e-02 3 1  ON 5
ci_007                 3.181066e-02 3 1  ON 6
ci_008                 3.146495e-02 3 1  ON 7
ci_009                -2.501938e-02 3 1  ON 8
ci_010                -2.551351e-02 3 1  ON 9
ci_011                -2.288292e-02 3 1  ON 10
ci_012                -2.257770e-02 3 1  ON 11
ci_013                 2.000261e-02 3 1  ON 12
ci_014                 2.020276e-02 3 1  ON 13
ci_015                 1.969179e-02 3 1  ON 14
ci_016                 2.073108e-02 3 1  ON 15
ci_017                 1.537566e-02 3 1  ON 16
ci_018                 1.572881e-02 3 1  ON 17
ci_019                 1.062619e-02 3 1  ON 18
ci_020                 1.043470e-02 3 1  ON 19
ci_021                -9.780179e-03 3 1  ON 20
ci_022                -9.448202e-03 3 1  ON 21
ci_023                 8.746989e-03 3 1  ON 22
ci_024                 9.497798e-03 3 1  ON 23
ci_025                 7.146325e-03 3 1  ON 24
ci_026                 8.157532e-03 3 1  ON 25
ci_027                 7.925490e-03 3 1  ON 26
ci_028                 7.864429e-03 3 1  ON 27
ci_029                -7.651694e-03 3 1  ON 28
ci_030                -7.767930e-03 3 1  ON 29
ci_031                -7.191705e-03 3 1  ON 30
ci_032                -7.558394e-03 3 1  ON 31
ci_033                 6.847040e-03 3 1  ON 32
ci_034                 6.332166e-03 3 1  ON 33
ci_035                 6.423007e-03 3 1  ON 34
ci_036                 6.953166e-03 3 1  ON 35
ci_037                 6.517535e-03 3 1  ON 36
ci_038                 5.615096e-03 3 1  ON 37
ci_039                 5.904671e-03 3 1  ON 38
ci_040                 6.141063e-03 3 1  ON 39
ci_041                 5.431910e-03 3 1  ON 40
ci_042                 5.115582e-03 3 1  ON 41
ci_043                 5.093167e-03 3 1  ON 42
ci_044                 4.459811e-03 3 1  ON 43
ci_045                 5.122670e-03 3 1  ON 44
ci_046                 5.281112e-03 3 1  ON 45
ci_047                -3.977102e-03 3 1  ON 46
ci_048                -4.394553e-03 3 1  ON 47
ci_049                 4.051364e-03 3 1  ON 48
ci_050                 3.469860e-03 3 1  ON 49
ci_051                -3.068081e-03 3 1  ON 50
ci_052                -2.205398e-03 3 1  ON 51
ci_053                -2.741451e-03 3 1  ON 52
ci_054                -3.446595e-03 3 1  ON 53
ci_055                -1.935055e-03 3 1  ON 54
ci_056                -2.001208e-03 3 1  ON 55
ci_057                -1.788619e-03 3 1  ON 56
ci_058                -1.821017e-03 3 1  ON 57
ci_059                -1.892362e-03 3 1  ON 58
ci_060                -2.080701e-03 3 1  ON 59
ci_061                -1.839683e-03 3 1  ON 60
ci_062                -1.916719e-03 3 1  ON 61
ci_063                -1.941532e-03 3 1  ON 62
ci_064                -9.419007e-04 3 1  ON 63
ci_065                -1.763456e-03 3 1  ON 64
ci_066                -1.417058e-03 3 1  ON 65
ci_067                -1.964484e-03 3 1  ON 66
ci_068                -1.527691e-03 3 1  ON 67
ci_069                 1.161042e-03 3 1  ON 68
ci_070                 1.597939e-03 3 1  ON 69
ci_071                 1.838246e-05 3 1  ON 70
ci_072                -2.578477e-04 3 1  ON 71
ci_073                 1.366491e-03 3 1  ON 72
ci_074                 8.920785e-04 3 1  ON 73
ci_075                -1.333538e-03 3 1  ON 74
ci_076                -7.295534e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.4179
    reference variance = 2.48397
====================================================
  Execution time = 2.3218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7932e+00
  Total weights = 1.9501e+06
  Execution time = 4.5828e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846131523534
                                         uncertainty =       0.069674506732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846131523534
                                         uncertainty =       0.069674506732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386446629
  error estimate for blocks of size 2^( 2) =       0.001454570829
  error estimate for blocks of size 2^( 3) =       0.001517062818
  error estimate for blocks of size 2^( 4) =       0.001560317904
  error estimate for blocks of size 2^( 5) =       0.001585443249
  error estimate for blocks of size 2^( 6) =       0.001599328489
  error estimate for blocks of size 2^( 7) =       0.001612771176

      target function =                  N/A
              le_mean =     -22.327029892677
             les_mean =     502.289500505252
             stat err =       0.001589465204
             autocorr =       1.314303721304
              std dev =       1.960762998087
             le_variance =       3.844591534667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846131604800
                                         uncertainty =       0.069674512568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846131604800
                                         uncertainty =       0.069674512568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386446643
  error estimate for blocks of size 2^( 2) =       0.001454570855
  error estimate for blocks of size 2^( 3) =       0.001517062854
  error estimate for blocks of size 2^( 4) =       0.001560317957
  error estimate for blocks of size 2^( 5) =       0.001585443339
  error estimate for blocks of size 2^( 6) =       0.001599328526
  error estimate for blocks of size 2^( 7) =       0.001612771109

      target function =                  N/A
              le_mean =     -22.327029887144
             les_mean =     502.289500568378
             stat err =       0.001589465233
             autocorr =       1.314303742857
              std dev =       1.960763017044
             le_variance =       3.844591609009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846131564109
                                         uncertainty =       0.069674509651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846131564109
                                         uncertainty =       0.069674509651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386446636
  error estimate for blocks of size 2^( 2) =       0.001454570842
  error estimate for blocks of size 2^( 3) =       0.001517062836
  error estimate for blocks of size 2^( 4) =       0.001560317931
  error estimate for blocks of size 2^( 5) =       0.001585443294
  error estimate for blocks of size 2^( 6) =       0.001599328507
  error estimate for blocks of size 2^( 7) =       0.001612771142

      target function =                  N/A
              le_mean =     -22.327029889895
             les_mean =     502.289500438356
             stat err =       0.001589465218
             autocorr =       1.314303732078
              std dev =       1.960763007550
             le_variance =       3.844591571777

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846131528597
                                         uncertainty =       0.069674507097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846131528597
                                         uncertainty =       0.069674507097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386446630
  error estimate for blocks of size 2^( 2) =       0.001454570831
  error estimate for blocks of size 2^( 3) =       0.001517062820
  error estimate for blocks of size 2^( 4) =       0.001560317908
  error estimate for blocks of size 2^( 5) =       0.001585443254
  error estimate for blocks of size 2^( 6) =       0.001599328491
  error estimate for blocks of size 2^( 7) =       0.001612771171

      target function =                  N/A
              le_mean =     -22.327029892328
             les_mean =     502.289500485922
             stat err =       0.001589465206
             autocorr =       1.314303722648
              std dev =       1.960762999268
             le_variance =       3.844591539297


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327029892677        initial  <--
     2.0680e+02     2.0680e+03             3.0267e-06       -22.327029887144
     8.2718e+02     8.2718e+03             7.5704e-07       -22.327029889895
     3.3087e+03     3.3087e+04             1.8928e-07       -22.327029892328

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.7530
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_001                -6.963147e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187528e-02 3 1  ON 2
ci_004                -6.235948e-02 3 1  ON 3
ci_005                 4.604115e-02 3 1  ON 4
ci_006                 4.618026e-02 3 1  ON 5
ci_007                 3.181087e-02 3 1  ON 6
ci_008                 3.146488e-02 3 1  ON 7
ci_009                -2.501958e-02 3 1  ON 8
ci_010                -2.551342e-02 3 1  ON 9
ci_011                -2.288307e-02 3 1  ON 10
ci_012                -2.257761e-02 3 1  ON 11
ci_013                 2.000253e-02 3 1  ON 12
ci_014                 2.020261e-02 3 1  ON 13
ci_015                 1.969185e-02 3 1  ON 14
ci_016                 2.073122e-02 3 1  ON 15
ci_017                 1.537585e-02 3 1  ON 16
ci_018                 1.572881e-02 3 1  ON 17
ci_019                 1.062643e-02 3 1  ON 18
ci_020                 1.043503e-02 3 1  ON 19
ci_021                -9.779968e-03 3 1  ON 20
ci_022                -9.448248e-03 3 1  ON 21
ci_023                 8.747134e-03 3 1  ON 22
ci_024                 9.498115e-03 3 1  ON 23
ci_025                 7.145921e-03 3 1  ON 24
ci_026                 8.157844e-03 3 1  ON 25
ci_027                 7.925406e-03 3 1  ON 26
ci_028                 7.864780e-03 3 1  ON 27
ci_029                -7.651832e-03 3 1  ON 28
ci_030                -7.767772e-03 3 1  ON 29
ci_031                -7.191297e-03 3 1  ON 30
ci_032                -7.558564e-03 3 1  ON 31
ci_033                 6.847086e-03 3 1  ON 32
ci_034                 6.331975e-03 3 1  ON 33
ci_035                 6.423005e-03 3 1  ON 34
ci_036                 6.953112e-03 3 1  ON 35
ci_037                 6.517585e-03 3 1  ON 36
ci_038                 5.614791e-03 3 1  ON 37
ci_039                 5.904737e-03 3 1  ON 38
ci_040                 6.141424e-03 3 1  ON 39
ci_041                 5.431983e-03 3 1  ON 40
ci_042                 5.115751e-03 3 1  ON 41
ci_043                 5.093004e-03 3 1  ON 42
ci_044                 4.460016e-03 3 1  ON 43
ci_045                 5.122693e-03 3 1  ON 44
ci_046                 5.280979e-03 3 1  ON 45
ci_047                -3.977022e-03 3 1  ON 46
ci_048                -4.394685e-03 3 1  ON 47
ci_049                 4.051504e-03 3 1  ON 48
ci_050                 3.469653e-03 3 1  ON 49
ci_051                -3.068140e-03 3 1  ON 50
ci_052                -2.205419e-03 3 1  ON 51
ci_053                -2.741697e-03 3 1  ON 52
ci_054                -3.446499e-03 3 1  ON 53
ci_055                -1.934297e-03 3 1  ON 54
ci_056                -2.000859e-03 3 1  ON 55
ci_057                -1.788170e-03 3 1  ON 56
ci_058                -1.820978e-03 3 1  ON 57
ci_059                -1.892259e-03 3 1  ON 58
ci_060                -2.080906e-03 3 1  ON 59
ci_061                -1.839704e-03 3 1  ON 60
ci_062                -1.917017e-03 3 1  ON 61
ci_063                -1.941850e-03 3 1  ON 62
ci_064                -9.417617e-04 3 1  ON 63
ci_065                -1.763319e-03 3 1  ON 64
ci_066                -1.417206e-03 3 1  ON 65
ci_067                -1.964571e-03 3 1  ON 66
ci_068                -1.527776e-03 3 1  ON 67
ci_069                 1.161044e-03 3 1  ON 68
ci_070                 1.597938e-03 3 1  ON 69
ci_071                 1.870586e-05 3 1  ON 70
ci_072                -2.575639e-04 3 1  ON 71
ci_073                 1.366519e-03 3 1  ON 72
ci_074                 8.919702e-04 3 1  ON 73
ci_075                -1.333663e-03 3 1  ON 74
ci_076                -7.297177e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5613e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2302e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.6566
    reference variance = 1.98174
====================================================
  Execution time = 2.3709e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0307e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7872e+00
  Total weights = 1.949645792e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8705e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.839239757536
                                         uncertainty =       0.046350264773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.839239757536
                                         uncertainty =       0.046350264773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385619029
  error estimate for blocks of size 2^( 2) =       0.001457675665
  error estimate for blocks of size 2^( 3) =       0.001520414364
  error estimate for blocks of size 2^( 4) =       0.001563067622
  error estimate for blocks of size 2^( 5) =       0.001585882504
  error estimate for blocks of size 2^( 6) =       0.001597077611
  error estimate for blocks of size 2^( 7) =       0.001601993512

      target function =                  N/A
              le_mean =     -22.325737339993
             les_mean =     502.225788313852
             stat err =       0.001587005312
             autocorr =       1.311804399958
              std dev =       1.959592575531
             le_variance =       3.840003062076


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232573733999e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+03, overlap shift 2.0680e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325737339191       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325737351073       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325737351020       residual = 3.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+03 is 2.312039e-07

solving harmonic davidson linear method for identity shift 8.2718e+03, overlap shift 8.2718e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325737339191       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325737342162       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325737342148       residual = 3.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+03 is 5.780733e-08

solving harmonic davidson linear method for identity shift 3.3087e+04, overlap shift 3.3087e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325737339191       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325737339934       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325737339930       residual = 3.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+04 is 1.445223e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128626 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9587e+01
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_001                -6.963147e-01 3 1  ON 0
ci_002                -7.040967e-01 3 1  ON 1
ci_003                -6.187528e-02 3 1  ON 2
ci_004                -6.235948e-02 3 1  ON 3
ci_005                 4.604120e-02 3 1  ON 4
ci_006                 4.618026e-02 3 1  ON 5
ci_007                 3.181084e-02 3 1  ON 6
ci_008                 3.146489e-02 3 1  ON 7
ci_009                -2.501958e-02 3 1  ON 8
ci_010                -2.551343e-02 3 1  ON 9
ci_011                -2.288309e-02 3 1  ON 10
ci_012                -2.257763e-02 3 1  ON 11
ci_013                 2.000253e-02 3 1  ON 12
ci_014                 2.020264e-02 3 1  ON 13
ci_015                 1.969183e-02 3 1  ON 14
ci_016                 2.073121e-02 3 1  ON 15
ci_017                 1.537590e-02 3 1  ON 16
ci_018                 1.572876e-02 3 1  ON 17
ci_019                 1.062644e-02 3 1  ON 18
ci_020                 1.043505e-02 3 1  ON 19
ci_021                -9.779991e-03 3 1  ON 20
ci_022                -9.448223e-03 3 1  ON 21
ci_023                 8.747133e-03 3 1  ON 22
ci_024                 9.498098e-03 3 1  ON 23
ci_025                 7.145949e-03 3 1  ON 24
ci_026                 8.157810e-03 3 1  ON 25
ci_027                 7.925434e-03 3 1  ON 26
ci_028                 7.864777e-03 3 1  ON 27
ci_029                -7.651820e-03 3 1  ON 28
ci_030                -7.767771e-03 3 1  ON 29
ci_031                -7.191280e-03 3 1  ON 30
ci_032                -7.558569e-03 3 1  ON 31
ci_033                 6.847110e-03 3 1  ON 32
ci_034                 6.331982e-03 3 1  ON 33
ci_035                 6.423024e-03 3 1  ON 34
ci_036                 6.953100e-03 3 1  ON 35
ci_037                 6.517598e-03 3 1  ON 36
ci_038                 5.614790e-03 3 1  ON 37
ci_039                 5.904760e-03 3 1  ON 38
ci_040                 6.141366e-03 3 1  ON 39
ci_041                 5.431999e-03 3 1  ON 40
ci_042                 5.115769e-03 3 1  ON 41
ci_043                 5.092984e-03 3 1  ON 42
ci_044                 4.460026e-03 3 1  ON 43
ci_045                 5.122724e-03 3 1  ON 44
ci_046                 5.280988e-03 3 1  ON 45
ci_047                -3.977024e-03 3 1  ON 46
ci_048                -4.394705e-03 3 1  ON 47
ci_049                 4.051476e-03 3 1  ON 48
ci_050                 3.469643e-03 3 1  ON 49
ci_051                -3.068133e-03 3 1  ON 50
ci_052                -2.205448e-03 3 1  ON 51
ci_053                -2.741676e-03 3 1  ON 52
ci_054                -3.446448e-03 3 1  ON 53
ci_055                -1.934289e-03 3 1  ON 54
ci_056                -2.000886e-03 3 1  ON 55
ci_057                -1.788176e-03 3 1  ON 56
ci_058                -1.820992e-03 3 1  ON 57
ci_059                -1.892280e-03 3 1  ON 58
ci_060                -2.080863e-03 3 1  ON 59
ci_061                -1.839706e-03 3 1  ON 60
ci_062                -1.916999e-03 3 1  ON 61
ci_063                -1.941855e-03 3 1  ON 62
ci_064                -9.417832e-04 3 1  ON 63
ci_065                -1.763279e-03 3 1  ON 64
ci_066                -1.417183e-03 3 1  ON 65
ci_067                -1.964562e-03 3 1  ON 66
ci_068                -1.527740e-03 3 1  ON 67
ci_069                 1.161058e-03 3 1  ON 68
ci_070                 1.597958e-03 3 1  ON 69
ci_071                 1.867771e-05 3 1  ON 70
ci_072                -2.575690e-04 3 1  ON 71
ci_073                 1.366517e-03 3 1  ON 72
ci_074                 8.919686e-04 3 1  ON 73
ci_075                -1.333666e-03 3 1  ON 74
ci_076                -7.297126e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.4744
    reference variance = 2.58445
====================================================
  Execution time = 2.3087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.8154e+00
  Total weights = 1.9499e+06
  Execution time = 4.3633e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.865624909662
                                         uncertainty =       0.100780205334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.865624909662
                                         uncertainty =       0.100780205334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389947696
  error estimate for blocks of size 2^( 2) =       0.001459855380
  error estimate for blocks of size 2^( 3) =       0.001521856184
  error estimate for blocks of size 2^( 4) =       0.001563819475
  error estimate for blocks of size 2^( 5) =       0.001587598879
  error estimate for blocks of size 2^( 6) =       0.001602232824
  error estimate for blocks of size 2^( 7) =       0.001612499637

      target function =                  N/A
              le_mean =     -22.329695246484
             les_mean =     502.430693944865
             stat err =       0.001591537704
             autocorr =       1.311103410009
              std dev =       1.965714333809
             le_variance =       3.864032842142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.865624925347
                                         uncertainty =       0.100780208811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.865624925347
                                         uncertainty =       0.100780208811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389947699
  error estimate for blocks of size 2^( 2) =       0.001459855377
  error estimate for blocks of size 2^( 3) =       0.001521856179
  error estimate for blocks of size 2^( 4) =       0.001563819467
  error estimate for blocks of size 2^( 5) =       0.001587598872
  error estimate for blocks of size 2^( 6) =       0.001602232812
  error estimate for blocks of size 2^( 7) =       0.001612499623

      target function =                  N/A
              le_mean =     -22.329695247272
             les_mean =     502.430694037445
             stat err =       0.001591537694
             autocorr =       1.311103388215
              std dev =       1.965714337801
             le_variance =       3.864032857835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.865624917504
                                         uncertainty =       0.100780207073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.865624917504
                                         uncertainty =       0.100780207073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389947698
  error estimate for blocks of size 2^( 2) =       0.001459855379
  error estimate for blocks of size 2^( 3) =       0.001521856181
  error estimate for blocks of size 2^( 4) =       0.001563819471
  error estimate for blocks of size 2^( 5) =       0.001587598876
  error estimate for blocks of size 2^( 6) =       0.001602232818
  error estimate for blocks of size 2^( 7) =       0.001612499630

      target function =                  N/A
              le_mean =     -22.329695246878
             les_mean =     502.430693991066
             stat err =       0.001591537699
             autocorr =       1.311103399111
              std dev =       1.965714335805
             le_variance =       3.864032849987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.865624910642
                                         uncertainty =       0.100780205552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.865624910642
                                         uncertainty =       0.100780205552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389947697
  error estimate for blocks of size 2^( 2) =       0.001459855380
  error estimate for blocks of size 2^( 3) =       0.001521856184
  error estimate for blocks of size 2^( 4) =       0.001563819474
  error estimate for blocks of size 2^( 5) =       0.001587598879
  error estimate for blocks of size 2^( 6) =       0.001602232823
  error estimate for blocks of size 2^( 7) =       0.001612499636

      target function =                  N/A
              le_mean =     -22.329695246533
             les_mean =     502.430693950630
             stat err =       0.001591537703
             autocorr =       1.311103408647
              std dev =       1.965714334058
             le_variance =       3.864032843122


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329695246484        initial
     2.0680e+03     2.0680e+04             2.3120e-07       -22.329695247272  <--
     8.2718e+03     8.2718e+04             5.7807e-08       -22.329695246878
     3.3087e+04     3.3087e+05             1.4452e-08       -22.329695246533

*****************************************************************************
Applying the update for shift_i =   2.0680e+03     and shift_s =   2.0680e+04
*****************************************************************************

  Execution time = 4.4976e+01
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040967e-01 3 1  ON 1
ci_003                -6.187526e-02 3 1  ON 2
ci_004                -6.235947e-02 3 1  ON 3
ci_005                 4.604135e-02 3 1  ON 4
ci_006                 4.618026e-02 3 1  ON 5
ci_007                 3.181077e-02 3 1  ON 6
ci_008                 3.146492e-02 3 1  ON 7
ci_009                -2.501960e-02 3 1  ON 8
ci_010                -2.551343e-02 3 1  ON 9
ci_011                -2.288317e-02 3 1  ON 10
ci_012                -2.257768e-02 3 1  ON 11
ci_013                 2.000254e-02 3 1  ON 12
ci_014                 2.020271e-02 3 1  ON 13
ci_015                 1.969179e-02 3 1  ON 14
ci_016                 2.073121e-02 3 1  ON 15
ci_017                 1.537606e-02 3 1  ON 16
ci_018                 1.572863e-02 3 1  ON 17
ci_019                 1.062647e-02 3 1  ON 18
ci_020                 1.043509e-02 3 1  ON 19
ci_021                -9.780060e-03 3 1  ON 20
ci_022                -9.448146e-03 3 1  ON 21
ci_023                 8.747132e-03 3 1  ON 22
ci_024                 9.498046e-03 3 1  ON 23
ci_025                 7.146033e-03 3 1  ON 24
ci_026                 8.157707e-03 3 1  ON 25
ci_027                 7.925516e-03 3 1  ON 26
ci_028                 7.864768e-03 3 1  ON 27
ci_029                -7.651783e-03 3 1  ON 28
ci_030                -7.767767e-03 3 1  ON 29
ci_031                -7.191226e-03 3 1  ON 30
ci_032                -7.558581e-03 3 1  ON 31
ci_033                 6.847179e-03 3 1  ON 32
ci_034                 6.332004e-03 3 1  ON 33
ci_035                 6.423080e-03 3 1  ON 34
ci_036                 6.953063e-03 3 1  ON 35
ci_037                 6.517636e-03 3 1  ON 36
ci_038                 5.614785e-03 3 1  ON 37
ci_039                 5.904828e-03 3 1  ON 38
ci_040                 6.141193e-03 3 1  ON 39
ci_041                 5.432045e-03 3 1  ON 40
ci_042                 5.115822e-03 3 1  ON 41
ci_043                 5.092924e-03 3 1  ON 42
ci_044                 4.460058e-03 3 1  ON 43
ci_045                 5.122819e-03 3 1  ON 44
ci_046                 5.281015e-03 3 1  ON 45
ci_047                -3.977031e-03 3 1  ON 46
ci_048                -4.394766e-03 3 1  ON 47
ci_049                 4.051394e-03 3 1  ON 48
ci_050                 3.469613e-03 3 1  ON 49
ci_051                -3.068113e-03 3 1  ON 50
ci_052                -2.205535e-03 3 1  ON 51
ci_053                -2.741611e-03 3 1  ON 52
ci_054                -3.446293e-03 3 1  ON 53
ci_055                -1.934263e-03 3 1  ON 54
ci_056                -2.000964e-03 3 1  ON 55
ci_057                -1.788194e-03 3 1  ON 56
ci_058                -1.821034e-03 3 1  ON 57
ci_059                -1.892345e-03 3 1  ON 58
ci_060                -2.080734e-03 3 1  ON 59
ci_061                -1.839712e-03 3 1  ON 60
ci_062                -1.916946e-03 3 1  ON 61
ci_063                -1.941872e-03 3 1  ON 62
ci_064                -9.418478e-04 3 1  ON 63
ci_065                -1.763160e-03 3 1  ON 64
ci_066                -1.417114e-03 3 1  ON 65
ci_067                -1.964536e-03 3 1  ON 66
ci_068                -1.527632e-03 3 1  ON 67
ci_069                 1.161101e-03 3 1  ON 68
ci_070                 1.598015e-03 3 1  ON 69
ci_071                 1.859327e-05 3 1  ON 70
ci_072                -2.575844e-04 3 1  ON 71
ci_073                 1.366509e-03 3 1  ON 72
ci_074                 8.919638e-04 3 1  ON 73
ci_075                -1.333675e-03 3 1  ON 74
ci_076                -7.296974e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4580e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2306e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.2228
    reference variance = 2.50139
====================================================
  Execution time = 2.3814e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0315e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7616e+00
  Total weights = 1.950312940e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9143e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813808327043
                                         uncertainty =       0.038359538655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813808327043
                                         uncertainty =       0.038359538655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380797434
  error estimate for blocks of size 2^( 2) =       0.001451808824
  error estimate for blocks of size 2^( 3) =       0.001514690917
  error estimate for blocks of size 2^( 4) =       0.001558079492
  error estimate for blocks of size 2^( 5) =       0.001582220154
  error estimate for blocks of size 2^( 6) =       0.001593479878
  error estimate for blocks of size 2^( 7) =       0.001599334585

      target function =                  N/A
              le_mean =     -22.327204882947
             les_mean =     502.265698538762
             stat err =       0.001583278527
             autocorr =       1.314784879423
              std dev =       1.952773702028
             le_variance =       3.813325131331


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232720488295e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e+02, overlap shift 5.1699e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327204882141       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327204913788       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327204913811       residual = 3.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+02 is 1.152745e-06

solving harmonic davidson linear method for identity shift 2.0680e+03, overlap shift 2.0680e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327204882141       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327204890055       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327204890061       residual = 3.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+03 is 2.882552e-07

solving harmonic davidson linear method for identity shift 8.2718e+03, overlap shift 8.2718e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327204882141       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327204884120       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327204884121       residual = 3.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+03 is 7.206812e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129834 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9735e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040967e-01 3 1  ON 1
ci_003                -6.187525e-02 3 1  ON 2
ci_004                -6.235943e-02 3 1  ON 3
ci_005                 4.604124e-02 3 1  ON 4
ci_006                 4.618029e-02 3 1  ON 5
ci_007                 3.181068e-02 3 1  ON 6
ci_008                 3.146475e-02 3 1  ON 7
ci_009                -2.501969e-02 3 1  ON 8
ci_010                -2.551337e-02 3 1  ON 9
ci_011                -2.288313e-02 3 1  ON 10
ci_012                -2.257776e-02 3 1  ON 11
ci_013                 2.000260e-02 3 1  ON 12
ci_014                 2.020276e-02 3 1  ON 13
ci_015                 1.969188e-02 3 1  ON 14
ci_016                 2.073118e-02 3 1  ON 15
ci_017                 1.537615e-02 3 1  ON 16
ci_018                 1.572853e-02 3 1  ON 17
ci_019                 1.062653e-02 3 1  ON 18
ci_020                 1.043496e-02 3 1  ON 19
ci_021                -9.780094e-03 3 1  ON 20
ci_022                -9.448299e-03 3 1  ON 21
ci_023                 8.747075e-03 3 1  ON 22
ci_024                 9.497852e-03 3 1  ON 23
ci_025                 7.146139e-03 3 1  ON 24
ci_026                 8.157717e-03 3 1  ON 25
ci_027                 7.925591e-03 3 1  ON 26
ci_028                 7.864747e-03 3 1  ON 27
ci_029                -7.651773e-03 3 1  ON 28
ci_030                -7.767721e-03 3 1  ON 29
ci_031                -7.191346e-03 3 1  ON 30
ci_032                -7.558580e-03 3 1  ON 31
ci_033                 6.847468e-03 3 1  ON 32
ci_034                 6.332102e-03 3 1  ON 33
ci_035                 6.423112e-03 3 1  ON 34
ci_036                 6.953043e-03 3 1  ON 35
ci_037                 6.517616e-03 3 1  ON 36
ci_038                 5.614917e-03 3 1  ON 37
ci_039                 5.904759e-03 3 1  ON 38
ci_040                 6.141229e-03 3 1  ON 39
ci_041                 5.432071e-03 3 1  ON 40
ci_042                 5.115934e-03 3 1  ON 41
ci_043                 5.092913e-03 3 1  ON 42
ci_044                 4.460021e-03 3 1  ON 43
ci_045                 5.122875e-03 3 1  ON 44
ci_046                 5.281035e-03 3 1  ON 45
ci_047                -3.977124e-03 3 1  ON 46
ci_048                -4.394778e-03 3 1  ON 47
ci_049                 4.051416e-03 3 1  ON 48
ci_050                 3.469598e-03 3 1  ON 49
ci_051                -3.068049e-03 3 1  ON 50
ci_052                -2.205499e-03 3 1  ON 51
ci_053                -2.741584e-03 3 1  ON 52
ci_054                -3.446231e-03 3 1  ON 53
ci_055                -1.934338e-03 3 1  ON 54
ci_056                -2.000948e-03 3 1  ON 55
ci_057                -1.788284e-03 3 1  ON 56
ci_058                -1.821221e-03 3 1  ON 57
ci_059                -1.892532e-03 3 1  ON 58
ci_060                -2.080683e-03 3 1  ON 59
ci_061                -1.839683e-03 3 1  ON 60
ci_062                -1.916905e-03 3 1  ON 61
ci_063                -1.941887e-03 3 1  ON 62
ci_064                -9.419372e-04 3 1  ON 63
ci_065                -1.763117e-03 3 1  ON 64
ci_066                -1.417066e-03 3 1  ON 65
ci_067                -1.964398e-03 3 1  ON 66
ci_068                -1.527605e-03 3 1  ON 67
ci_069                 1.161157e-03 3 1  ON 68
ci_070                 1.598126e-03 3 1  ON 69
ci_071                 1.868333e-05 3 1  ON 70
ci_072                -2.575383e-04 3 1  ON 71
ci_073                 1.366559e-03 3 1  ON 72
ci_074                 8.919540e-04 3 1  ON 73
ci_075                -1.333739e-03 3 1  ON 74
ci_076                -7.298271e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.2002
    reference variance = 4.85625
====================================================
  Execution time = 2.3148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7504e+00
  Total weights = 1.9500e+06
  Execution time = 4.3546e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804674354758
                                         uncertainty =       0.040642077540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804674354758
                                         uncertainty =       0.040642077540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378981893
  error estimate for blocks of size 2^( 2) =       0.001449693247
  error estimate for blocks of size 2^( 3) =       0.001512232634
  error estimate for blocks of size 2^( 4) =       0.001554537900
  error estimate for blocks of size 2^( 5) =       0.001578115860
  error estimate for blocks of size 2^( 6) =       0.001591664437
  error estimate for blocks of size 2^( 7) =       0.001606529943

      target function =                  N/A
              le_mean =     -22.328208653689
             les_mean =     502.299293806190
             stat err =       0.001582712035
             autocorr =       1.317306037943
              std dev =       1.950206097517
             le_variance =       3.803303822794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804674216364
                                         uncertainty =       0.040642062325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804674216364
                                         uncertainty =       0.040642062325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378981868
  error estimate for blocks of size 2^( 2) =       0.001449693226
  error estimate for blocks of size 2^( 3) =       0.001512232612
  error estimate for blocks of size 2^( 4) =       0.001554537874
  error estimate for blocks of size 2^( 5) =       0.001578115861
  error estimate for blocks of size 2^( 6) =       0.001591664455
  error estimate for blocks of size 2^( 7) =       0.001606529943

      target function =                  N/A
              le_mean =     -22.328208661930
             les_mean =     502.299290216602
             stat err =       0.001582712033
             autocorr =       1.317306082583
              std dev =       1.950206062136
             le_variance =       3.803303684791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804674285513
                                         uncertainty =       0.040642069929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804674285513
                                         uncertainty =       0.040642069929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378981880
  error estimate for blocks of size 2^( 2) =       0.001449693236
  error estimate for blocks of size 2^( 3) =       0.001512232623
  error estimate for blocks of size 2^( 4) =       0.001554537887
  error estimate for blocks of size 2^( 5) =       0.001578115860
  error estimate for blocks of size 2^( 6) =       0.001591664446
  error estimate for blocks of size 2^( 7) =       0.001606529943

      target function =                  N/A
              le_mean =     -22.328208657821
             les_mean =     502.299291004048
             stat err =       0.001582712034
             autocorr =       1.317306060302
              std dev =       1.950206079814
             le_variance =       3.803303753744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804674346100
                                         uncertainty =       0.040642076588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804674346100
                                         uncertainty =       0.040642076588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378981891
  error estimate for blocks of size 2^( 2) =       0.001449693245
  error estimate for blocks of size 2^( 3) =       0.001512232632
  error estimate for blocks of size 2^( 4) =       0.001554537898
  error estimate for blocks of size 2^( 5) =       0.001578115860
  error estimate for blocks of size 2^( 6) =       0.001591664438
  error estimate for blocks of size 2^( 7) =       0.001606529943

      target function =                  N/A
              le_mean =     -22.328208654209
             les_mean =     502.299293101706
             stat err =       0.001582712035
             autocorr =       1.317306040746
              std dev =       1.950206095304
             le_variance =       3.803303814160


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328208653689        initial
     5.1699e+02     5.1699e+03             1.1527e-06       -22.328208661930  <--
     2.0680e+03     2.0680e+04             2.8826e-07       -22.328208657821
     8.2718e+03     8.2718e+04             7.2068e-08       -22.328208654209

*****************************************************************************
Applying the update for shift_i =   5.1699e+02     and shift_s =   5.1699e+03
*****************************************************************************

  Execution time = 4.4995e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040967e-01 3 1  ON 1
ci_003                -6.187523e-02 3 1  ON 2
ci_004                -6.235929e-02 3 1  ON 3
ci_005                 4.604092e-02 3 1  ON 4
ci_006                 4.618040e-02 3 1  ON 5
ci_007                 3.181043e-02 3 1  ON 6
ci_008                 3.146423e-02 3 1  ON 7
ci_009                -2.501999e-02 3 1  ON 8
ci_010                -2.551320e-02 3 1  ON 9
ci_011                -2.288301e-02 3 1  ON 10
ci_012                -2.257802e-02 3 1  ON 11
ci_013                 2.000275e-02 3 1  ON 12
ci_014                 2.020291e-02 3 1  ON 13
ci_015                 1.969218e-02 3 1  ON 14
ci_016                 2.073112e-02 3 1  ON 15
ci_017                 1.537642e-02 3 1  ON 16
ci_018                 1.572821e-02 3 1  ON 17
ci_019                 1.062672e-02 3 1  ON 18
ci_020                 1.043458e-02 3 1  ON 19
ci_021                -9.780199e-03 3 1  ON 20
ci_022                -9.448760e-03 3 1  ON 21
ci_023                 8.746901e-03 3 1  ON 22
ci_024                 9.497271e-03 3 1  ON 23
ci_025                 7.146458e-03 3 1  ON 24
ci_026                 8.157749e-03 3 1  ON 25
ci_027                 7.925816e-03 3 1  ON 26
ci_028                 7.864682e-03 3 1  ON 27
ci_029                -7.651742e-03 3 1  ON 28
ci_030                -7.767582e-03 3 1  ON 29
ci_031                -7.191704e-03 3 1  ON 30
ci_032                -7.558577e-03 3 1  ON 31
ci_033                 6.848332e-03 3 1  ON 32
ci_034                 6.332393e-03 3 1  ON 33
ci_035                 6.423209e-03 3 1  ON 34
ci_036                 6.952984e-03 3 1  ON 35
ci_037                 6.517555e-03 3 1  ON 36
ci_038                 5.615311e-03 3 1  ON 37
ci_039                 5.904552e-03 3 1  ON 38
ci_040                 6.141339e-03 3 1  ON 39
ci_041                 5.432148e-03 3 1  ON 40
ci_042                 5.116270e-03 3 1  ON 41
ci_043                 5.092878e-03 3 1  ON 42
ci_044                 4.459908e-03 3 1  ON 43
ci_045                 5.123041e-03 3 1  ON 44
ci_046                 5.281094e-03 3 1  ON 45
ci_047                -3.977403e-03 3 1  ON 46
ci_048                -4.394815e-03 3 1  ON 47
ci_049                 4.051484e-03 3 1  ON 48
ci_050                 3.469553e-03 3 1  ON 49
ci_051                -3.067856e-03 3 1  ON 50
ci_052                -2.205390e-03 3 1  ON 51
ci_053                -2.741502e-03 3 1  ON 52
ci_054                -3.446043e-03 3 1  ON 53
ci_055                -1.934564e-03 3 1  ON 54
ci_056                -2.000899e-03 3 1  ON 55
ci_057                -1.788552e-03 3 1  ON 56
ci_058                -1.821783e-03 3 1  ON 57
ci_059                -1.893092e-03 3 1  ON 58
ci_060                -2.080531e-03 3 1  ON 59
ci_061                -1.839595e-03 3 1  ON 60
ci_062                -1.916782e-03 3 1  ON 61
ci_063                -1.941931e-03 3 1  ON 62
ci_064                -9.422055e-04 3 1  ON 63
ci_065                -1.762989e-03 3 1  ON 64
ci_066                -1.416921e-03 3 1  ON 65
ci_067                -1.963984e-03 3 1  ON 66
ci_068                -1.527524e-03 3 1  ON 67
ci_069                 1.161326e-03 3 1  ON 68
ci_070                 1.598461e-03 3 1  ON 69
ci_071                 1.895341e-05 3 1  ON 70
ci_072                -2.574003e-04 3 1  ON 71
ci_073                 1.366712e-03 3 1  ON 72
ci_074                 8.919244e-04 3 1  ON 73
ci_075                -1.333932e-03 3 1  ON 74
ci_076                -7.302161e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4737e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2304e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.4631
    reference variance = 2.36466
====================================================
  Execution time = 2.3800e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0354e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6935e+00
  Total weights = 1.949917401e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.8656e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742796798947
                                         uncertainty =       0.025864460154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742796798947
                                         uncertainty =       0.025864460154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368301157
  error estimate for blocks of size 2^( 2) =       0.001440881278
  error estimate for blocks of size 2^( 3) =       0.001504736851
  error estimate for blocks of size 2^( 4) =       0.001548314809
  error estimate for blocks of size 2^( 5) =       0.001574793497
  error estimate for blocks of size 2^( 6) =       0.001587043125
  error estimate for blocks of size 2^( 7) =       0.001602517253

      target function =                  N/A
              le_mean =     -22.327640773956
             les_mean =     502.217018421002
             stat err =       0.001578167171
             autocorr =       1.330278652103
              std dev =       1.935101013912
             le_variance =       3.744615934044


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232764077396e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+02, overlap shift 1.2925e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327640773127       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327640892017       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327640891703       residual = 4.31e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+02 is 3.779722e-06

solving harmonic davidson linear method for identity shift 5.1699e+02, overlap shift 5.1699e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327640773127       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327640802885       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327640802806       residual = 4.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+02 is 9.457673e-07

solving harmonic davidson linear method for identity shift 2.0680e+03, overlap shift 2.0680e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327640773127       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327640780569       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327640780549       residual = 4.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+03 is 2.364942e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131015 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0672e+01
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_001                -6.963146e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187542e-02 3 1  ON 2
ci_004                -6.235899e-02 3 1  ON 3
ci_005                 4.604091e-02 3 1  ON 4
ci_006                 4.618077e-02 3 1  ON 5
ci_007                 3.181072e-02 3 1  ON 6
ci_008                 3.146459e-02 3 1  ON 7
ci_009                -2.502037e-02 3 1  ON 8
ci_010                -2.551341e-02 3 1  ON 9
ci_011                -2.288254e-02 3 1  ON 10
ci_012                -2.257798e-02 3 1  ON 11
ci_013                 2.000244e-02 3 1  ON 12
ci_014                 2.020292e-02 3 1  ON 13
ci_015                 1.969235e-02 3 1  ON 14
ci_016                 2.073076e-02 3 1  ON 15
ci_017                 1.537666e-02 3 1  ON 16
ci_018                 1.572793e-02 3 1  ON 17
ci_019                 1.062673e-02 3 1  ON 18
ci_020                 1.043466e-02 3 1  ON 19
ci_021                -9.780305e-03 3 1  ON 20
ci_022                -9.449056e-03 3 1  ON 21
ci_023                 8.747000e-03 3 1  ON 22
ci_024                 9.497031e-03 3 1  ON 23
ci_025                 7.147083e-03 3 1  ON 24
ci_026                 8.157556e-03 3 1  ON 25
ci_027                 7.926295e-03 3 1  ON 26
ci_028                 7.864468e-03 3 1  ON 27
ci_029                -7.651608e-03 3 1  ON 28
ci_030                -7.768060e-03 3 1  ON 29
ci_031                -7.191998e-03 3 1  ON 30
ci_032                -7.559078e-03 3 1  ON 31
ci_033                 6.848299e-03 3 1  ON 32
ci_034                 6.333339e-03 3 1  ON 33
ci_035                 6.423620e-03 3 1  ON 34
ci_036                 6.952479e-03 3 1  ON 35
ci_037                 6.517510e-03 3 1  ON 36
ci_038                 5.615233e-03 3 1  ON 37
ci_039                 5.904067e-03 3 1  ON 38
ci_040                 6.140507e-03 3 1  ON 39
ci_041                 5.432283e-03 3 1  ON 40
ci_042                 5.116060e-03 3 1  ON 41
ci_043                 5.093032e-03 3 1  ON 42
ci_044                 4.459955e-03 3 1  ON 43
ci_045                 5.122776e-03 3 1  ON 44
ci_046                 5.281243e-03 3 1  ON 45
ci_047                -3.977284e-03 3 1  ON 46
ci_048                -4.394688e-03 3 1  ON 47
ci_049                 4.051483e-03 3 1  ON 48
ci_050                 3.469434e-03 3 1  ON 49
ci_051                -3.067983e-03 3 1  ON 50
ci_052                -2.205383e-03 3 1  ON 51
ci_053                -2.741516e-03 3 1  ON 52
ci_054                -3.446668e-03 3 1  ON 53
ci_055                -1.934538e-03 3 1  ON 54
ci_056                -2.000980e-03 3 1  ON 55
ci_057                -1.788606e-03 3 1  ON 56
ci_058                -1.821306e-03 3 1  ON 57
ci_059                -1.893554e-03 3 1  ON 58
ci_060                -2.080212e-03 3 1  ON 59
ci_061                -1.839324e-03 3 1  ON 60
ci_062                -1.916762e-03 3 1  ON 61
ci_063                -1.941827e-03 3 1  ON 62
ci_064                -9.420989e-04 3 1  ON 63
ci_065                -1.762432e-03 3 1  ON 64
ci_066                -1.417118e-03 3 1  ON 65
ci_067                -1.964042e-03 3 1  ON 66
ci_068                -1.527012e-03 3 1  ON 67
ci_069                 1.161517e-03 3 1  ON 68
ci_070                 1.598277e-03 3 1  ON 69
ci_071                 1.850362e-05 3 1  ON 70
ci_072                -2.574936e-04 3 1  ON 71
ci_073                 1.367241e-03 3 1  ON 72
ci_074                 8.916218e-04 3 1  ON 73
ci_075                -1.333781e-03 3 1  ON 74
ci_076                -7.301946e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.4799
    reference variance = 2.86568
====================================================
  Execution time = 2.3227e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7417e+00
  Total weights = 1.9499e+06
  Execution time = 4.3564e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794719587323
                                         uncertainty =       0.042369132947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794719587323
                                         uncertainty =       0.042369132947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377422020
  error estimate for blocks of size 2^( 2) =       0.001447493567
  error estimate for blocks of size 2^( 3) =       0.001510954479
  error estimate for blocks of size 2^( 4) =       0.001553579022
  error estimate for blocks of size 2^( 5) =       0.001580009689
  error estimate for blocks of size 2^( 6) =       0.001590924998
  error estimate for blocks of size 2^( 7) =       0.001599251325

      target function =                  N/A
              le_mean =     -22.328295221130
             les_mean =     502.294418687536
             stat err =       0.001580941259
             autocorr =       1.317338620380
              std dev =       1.948000069006
             le_variance =       3.794704268846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794719529648
                                         uncertainty =       0.042369135757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794719529648
                                         uncertainty =       0.042369135757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377422010
  error estimate for blocks of size 2^( 2) =       0.001447493508
  error estimate for blocks of size 2^( 3) =       0.001510954384
  error estimate for blocks of size 2^( 4) =       0.001553578931
  error estimate for blocks of size 2^( 5) =       0.001580009647
  error estimate for blocks of size 2^( 6) =       0.001590924911
  error estimate for blocks of size 2^( 7) =       0.001599251205

      target function =                  N/A
              le_mean =     -22.328295208202
             les_mean =     502.294417689850
             stat err =       0.001580941174
             autocorr =       1.317338498621
              std dev =       1.948000054261
             le_variance =       3.794704211401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794719558099
                                         uncertainty =       0.042369134345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794719558099
                                         uncertainty =       0.042369134345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377422015
  error estimate for blocks of size 2^( 2) =       0.001447493537
  error estimate for blocks of size 2^( 3) =       0.001510954431
  error estimate for blocks of size 2^( 4) =       0.001553578976
  error estimate for blocks of size 2^( 5) =       0.001580009668
  error estimate for blocks of size 2^( 6) =       0.001590924955
  error estimate for blocks of size 2^( 7) =       0.001599251265

      target function =                  N/A
              le_mean =     -22.328295214617
             les_mean =     502.294417863097
             stat err =       0.001580941216
             autocorr =       1.317338559393
              std dev =       1.948000061534
             le_variance =       3.794704239736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794719583637
                                         uncertainty =       0.042369133122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794719583637
                                         uncertainty =       0.042369133122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377422019
  error estimate for blocks of size 2^( 2) =       0.001447493563
  error estimate for blocks of size 2^( 3) =       0.001510954473
  error estimate for blocks of size 2^( 4) =       0.001553579016
  error estimate for blocks of size 2^( 5) =       0.001580009687
  error estimate for blocks of size 2^( 6) =       0.001590924993
  error estimate for blocks of size 2^( 7) =       0.001599251317

      target function =                  N/A
              le_mean =     -22.328295220313
             les_mean =     502.294418534347
             stat err =       0.001580941253
             autocorr =       1.317338612752
              std dev =       1.948000068063
             le_variance =       3.794704265173


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328295221130        initial  <--
     1.2925e+02     1.2925e+03             3.7797e-06       -22.328295208202
     5.1699e+02     5.1699e+03             9.4577e-07       -22.328295214617
     2.0680e+03     2.0680e+04             2.3649e-07       -22.328295220313

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0837
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040967e-01 3 1  ON 1
ci_003                -6.187523e-02 3 1  ON 2
ci_004                -6.235929e-02 3 1  ON 3
ci_005                 4.604092e-02 3 1  ON 4
ci_006                 4.618040e-02 3 1  ON 5
ci_007                 3.181043e-02 3 1  ON 6
ci_008                 3.146423e-02 3 1  ON 7
ci_009                -2.501999e-02 3 1  ON 8
ci_010                -2.551320e-02 3 1  ON 9
ci_011                -2.288301e-02 3 1  ON 10
ci_012                -2.257802e-02 3 1  ON 11
ci_013                 2.000275e-02 3 1  ON 12
ci_014                 2.020291e-02 3 1  ON 13
ci_015                 1.969218e-02 3 1  ON 14
ci_016                 2.073112e-02 3 1  ON 15
ci_017                 1.537642e-02 3 1  ON 16
ci_018                 1.572821e-02 3 1  ON 17
ci_019                 1.062672e-02 3 1  ON 18
ci_020                 1.043458e-02 3 1  ON 19
ci_021                -9.780199e-03 3 1  ON 20
ci_022                -9.448760e-03 3 1  ON 21
ci_023                 8.746901e-03 3 1  ON 22
ci_024                 9.497271e-03 3 1  ON 23
ci_025                 7.146458e-03 3 1  ON 24
ci_026                 8.157749e-03 3 1  ON 25
ci_027                 7.925816e-03 3 1  ON 26
ci_028                 7.864682e-03 3 1  ON 27
ci_029                -7.651742e-03 3 1  ON 28
ci_030                -7.767582e-03 3 1  ON 29
ci_031                -7.191704e-03 3 1  ON 30
ci_032                -7.558577e-03 3 1  ON 31
ci_033                 6.848332e-03 3 1  ON 32
ci_034                 6.332393e-03 3 1  ON 33
ci_035                 6.423209e-03 3 1  ON 34
ci_036                 6.952984e-03 3 1  ON 35
ci_037                 6.517555e-03 3 1  ON 36
ci_038                 5.615311e-03 3 1  ON 37
ci_039                 5.904552e-03 3 1  ON 38
ci_040                 6.141339e-03 3 1  ON 39
ci_041                 5.432148e-03 3 1  ON 40
ci_042                 5.116270e-03 3 1  ON 41
ci_043                 5.092878e-03 3 1  ON 42
ci_044                 4.459908e-03 3 1  ON 43
ci_045                 5.123041e-03 3 1  ON 44
ci_046                 5.281094e-03 3 1  ON 45
ci_047                -3.977403e-03 3 1  ON 46
ci_048                -4.394815e-03 3 1  ON 47
ci_049                 4.051484e-03 3 1  ON 48
ci_050                 3.469553e-03 3 1  ON 49
ci_051                -3.067856e-03 3 1  ON 50
ci_052                -2.205390e-03 3 1  ON 51
ci_053                -2.741502e-03 3 1  ON 52
ci_054                -3.446043e-03 3 1  ON 53
ci_055                -1.934564e-03 3 1  ON 54
ci_056                -2.000899e-03 3 1  ON 55
ci_057                -1.788552e-03 3 1  ON 56
ci_058                -1.821783e-03 3 1  ON 57
ci_059                -1.893092e-03 3 1  ON 58
ci_060                -2.080531e-03 3 1  ON 59
ci_061                -1.839595e-03 3 1  ON 60
ci_062                -1.916782e-03 3 1  ON 61
ci_063                -1.941931e-03 3 1  ON 62
ci_064                -9.422055e-04 3 1  ON 63
ci_065                -1.762989e-03 3 1  ON 64
ci_066                -1.416921e-03 3 1  ON 65
ci_067                -1.963984e-03 3 1  ON 66
ci_068                -1.527524e-03 3 1  ON 67
ci_069                 1.161326e-03 3 1  ON 68
ci_070                 1.598461e-03 3 1  ON 69
ci_071                 1.895341e-05 3 1  ON 70
ci_072                -2.574003e-04 3 1  ON 71
ci_073                 1.366712e-03 3 1  ON 72
ci_074                 8.919244e-04 3 1  ON 73
ci_075                -1.333932e-03 3 1  ON 74
ci_076                -7.302161e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5762e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2307e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.2775
    reference variance = 2.2321
====================================================
  Execution time = 2.3737e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0309e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7385e+00
  Total weights = 1.950092603e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8378e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788492455675
                                         uncertainty =       0.026527535069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788492455675
                                         uncertainty =       0.026527535069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376306901
  error estimate for blocks of size 2^( 2) =       0.001446720761
  error estimate for blocks of size 2^( 3) =       0.001507378820
  error estimate for blocks of size 2^( 4) =       0.001550637989
  error estimate for blocks of size 2^( 5) =       0.001572104226
  error estimate for blocks of size 2^( 6) =       0.001586870583
  error estimate for blocks of size 2^( 7) =       0.001593986029

      target function =                  N/A
              le_mean =     -22.328860463054
             les_mean =     502.316473239578
             stat err =       0.001575899707
             autocorr =       1.311072096054
              std dev =       1.946423027633
             le_variance =       3.788562602501


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232886046305e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+03, overlap shift 1.2925e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328860462243       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328860479250       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328860480222       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+03 is 8.027747e-07

solving harmonic davidson linear method for identity shift 5.1699e+03, overlap shift 5.1699e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328860462243       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328860466495       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328860466738       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+03 is 2.007252e-07

solving harmonic davidson linear method for identity shift 2.0680e+04, overlap shift 2.0680e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328860462243       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328860463306       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328860463367       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+04 is 5.018326e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132182 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9581e+01
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040967e-01 3 1  ON 1
ci_003                -6.187525e-02 3 1  ON 2
ci_004                -6.235931e-02 3 1  ON 3
ci_005                 4.604087e-02 3 1  ON 4
ci_006                 4.618035e-02 3 1  ON 5
ci_007                 3.181044e-02 3 1  ON 6
ci_008                 3.146408e-02 3 1  ON 7
ci_009                -2.501998e-02 3 1  ON 8
ci_010                -2.551310e-02 3 1  ON 9
ci_011                -2.288301e-02 3 1  ON 10
ci_012                -2.257806e-02 3 1  ON 11
ci_013                 2.000277e-02 3 1  ON 12
ci_014                 2.020290e-02 3 1  ON 13
ci_015                 1.969216e-02 3 1  ON 14
ci_016                 2.073113e-02 3 1  ON 15
ci_017                 1.537646e-02 3 1  ON 16
ci_018                 1.572813e-02 3 1  ON 17
ci_019                 1.062673e-02 3 1  ON 18
ci_020                 1.043452e-02 3 1  ON 19
ci_021                -9.780206e-03 3 1  ON 20
ci_022                -9.448824e-03 3 1  ON 21
ci_023                 8.746911e-03 3 1  ON 22
ci_024                 9.497223e-03 3 1  ON 23
ci_025                 7.146520e-03 3 1  ON 24
ci_026                 8.157713e-03 3 1  ON 25
ci_027                 7.925807e-03 3 1  ON 26
ci_028                 7.864748e-03 3 1  ON 27
ci_029                -7.651733e-03 3 1  ON 28
ci_030                -7.767551e-03 3 1  ON 29
ci_031                -7.191721e-03 3 1  ON 30
ci_032                -7.558552e-03 3 1  ON 31
ci_033                 6.848325e-03 3 1  ON 32
ci_034                 6.332384e-03 3 1  ON 33
ci_035                 6.423309e-03 3 1  ON 34
ci_036                 6.952937e-03 3 1  ON 35
ci_037                 6.517560e-03 3 1  ON 36
ci_038                 5.615293e-03 3 1  ON 37
ci_039                 5.904515e-03 3 1  ON 38
ci_040                 6.141324e-03 3 1  ON 39
ci_041                 5.432132e-03 3 1  ON 40
ci_042                 5.116277e-03 3 1  ON 41
ci_043                 5.092851e-03 3 1  ON 42
ci_044                 4.459943e-03 3 1  ON 43
ci_045                 5.123040e-03 3 1  ON 44
ci_046                 5.281030e-03 3 1  ON 45
ci_047                -3.977399e-03 3 1  ON 46
ci_048                -4.394614e-03 3 1  ON 47
ci_049                 4.051497e-03 3 1  ON 48
ci_050                 3.469494e-03 3 1  ON 49
ci_051                -3.067857e-03 3 1  ON 50
ci_052                -2.205453e-03 3 1  ON 51
ci_053                -2.741493e-03 3 1  ON 52
ci_054                -3.445995e-03 3 1  ON 53
ci_055                -1.934570e-03 3 1  ON 54
ci_056                -2.000905e-03 3 1  ON 55
ci_057                -1.788513e-03 3 1  ON 56
ci_058                -1.821772e-03 3 1  ON 57
ci_059                -1.893092e-03 3 1  ON 58
ci_060                -2.080533e-03 3 1  ON 59
ci_061                -1.839568e-03 3 1  ON 60
ci_062                -1.916761e-03 3 1  ON 61
ci_063                -1.941849e-03 3 1  ON 62
ci_064                -9.421952e-04 3 1  ON 63
ci_065                -1.762953e-03 3 1  ON 64
ci_066                -1.416985e-03 3 1  ON 65
ci_067                -1.964002e-03 3 1  ON 66
ci_068                -1.527540e-03 3 1  ON 67
ci_069                 1.161335e-03 3 1  ON 68
ci_070                 1.598473e-03 3 1  ON 69
ci_071                 1.891521e-05 3 1  ON 70
ci_072                -2.574307e-04 3 1  ON 71
ci_073                 1.366657e-03 3 1  ON 72
ci_074                 8.919351e-04 3 1  ON 73
ci_075                -1.333902e-03 3 1  ON 74
ci_076                -7.302454e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.5347
    reference variance = 2.16652
====================================================
  Execution time = 2.3111e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7945e+00
  Total weights = 1.9504e+06
  Execution time = 4.6924e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.842379148715
                                         uncertainty =       0.071253094032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.842379148715
                                         uncertainty =       0.071253094032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386778075
  error estimate for blocks of size 2^( 2) =       0.001456377226
  error estimate for blocks of size 2^( 3) =       0.001518227697
  error estimate for blocks of size 2^( 4) =       0.001559279191
  error estimate for blocks of size 2^( 5) =       0.001582178964
  error estimate for blocks of size 2^( 6) =       0.001592427322
  error estimate for blocks of size 2^( 7) =       0.001595704773

      target function =                  N/A
              le_mean =     -22.325721154716
             les_mean =     502.232336118898
             stat err =       0.001582397563
             autocorr =       1.302018865537
              std dev =       1.961231740628
             le_variance =       3.846429940445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.842379037865
                                         uncertainty =       0.071253095703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.842379037865
                                         uncertainty =       0.071253095703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386778055
  error estimate for blocks of size 2^( 2) =       0.001456377217
  error estimate for blocks of size 2^( 3) =       0.001518227699
  error estimate for blocks of size 2^( 4) =       0.001559279201
  error estimate for blocks of size 2^( 5) =       0.001582178961
  error estimate for blocks of size 2^( 6) =       0.001592427306
  error estimate for blocks of size 2^( 7) =       0.001595704773

      target function =                  N/A
              le_mean =     -22.325721155896
             les_mean =     502.232336679951
             stat err =       0.001582397560
             autocorr =       1.302018898692
              std dev =       1.961231712525
             le_variance =       3.846429830214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.842379093277
                                         uncertainty =       0.071253094867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.842379093277
                                         uncertainty =       0.071253094867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386778065
  error estimate for blocks of size 2^( 2) =       0.001456377221
  error estimate for blocks of size 2^( 3) =       0.001518227698
  error estimate for blocks of size 2^( 4) =       0.001559279196
  error estimate for blocks of size 2^( 5) =       0.001582178962
  error estimate for blocks of size 2^( 6) =       0.001592427314
  error estimate for blocks of size 2^( 7) =       0.001595704773

      target function =                  N/A
              le_mean =     -22.325721155305
             les_mean =     502.232336393620
             stat err =       0.001582397561
             autocorr =       1.302018882117
              std dev =       1.961231726573
             le_variance =       3.846429885317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.842379141784
                                         uncertainty =       0.071253094136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.842379141784
                                         uncertainty =       0.071253094136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386778074
  error estimate for blocks of size 2^( 2) =       0.001456377225
  error estimate for blocks of size 2^( 3) =       0.001518227697
  error estimate for blocks of size 2^( 4) =       0.001559279192
  error estimate for blocks of size 2^( 5) =       0.001582178964
  error estimate for blocks of size 2^( 6) =       0.001592427321
  error estimate for blocks of size 2^( 7) =       0.001595704773

      target function =                  N/A
              le_mean =     -22.325721154790
             les_mean =     502.232336152602
             stat err =       0.001582397562
             autocorr =       1.302018867610
              std dev =       1.961231738871
             le_variance =       3.846429933554


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325721154716        initial
     1.2925e+03     1.2925e+04             8.0277e-07       -22.325721155896  <--
     5.1699e+03     5.1699e+04             2.0073e-07       -22.325721155305
     2.0680e+04     2.0680e+05             5.0183e-08       -22.325721154790

*****************************************************************************
Applying the update for shift_i =   1.2925e+03     and shift_s =   1.2925e+04
*****************************************************************************

  Execution time = 4.5757e+01
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5345e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2308e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -21.9753
    reference variance = 3.51078
====================================================
  Execution time = 2.3822e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0320e+04
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7430e+00
  Total weights = 1.949877137e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9773e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795129651244
                                         uncertainty =       0.043653869024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795129651244
                                         uncertainty =       0.043653869024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377317163
  error estimate for blocks of size 2^( 2) =       0.001448430024
  error estimate for blocks of size 2^( 3) =       0.001509673684
  error estimate for blocks of size 2^( 4) =       0.001552328531
  error estimate for blocks of size 2^( 5) =       0.001574407007
  error estimate for blocks of size 2^( 6) =       0.001589850751
  error estimate for blocks of size 2^( 7) =       0.001590830651

      target function =                  N/A
              le_mean =     -22.325274945186
             les_mean =     502.160865573011
             stat err =       0.001576854235
             autocorr =       1.310735852760
              std dev =       1.947851776669
             le_variance =       3.794126543874


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232527494519e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+02, overlap shift 3.2312e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325274944369       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325274986763       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325274986740       residual = 3.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+02 is 1.049820e-06

solving harmonic davidson linear method for identity shift 1.2925e+03, overlap shift 1.2925e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325274944369       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325274954972       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325274954966       residual = 3.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+03 is 2.625792e-07

solving harmonic davidson linear method for identity shift 5.1699e+03, overlap shift 5.1699e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325274944369       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325274947020       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325274947018       residual = 3.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+03 is 6.565256e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133378 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9806e+01
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_001                -6.963147e-01 3 1  ON 0
ci_002                -7.040969e-01 3 1  ON 1
ci_003                -6.187517e-02 3 1  ON 2
ci_004                -6.235931e-02 3 1  ON 3
ci_005                 4.604074e-02 3 1  ON 4
ci_006                 4.618013e-02 3 1  ON 5
ci_007                 3.181048e-02 3 1  ON 6
ci_008                 3.146372e-02 3 1  ON 7
ci_009                -2.501979e-02 3 1  ON 8
ci_010                -2.551274e-02 3 1  ON 9
ci_011                -2.288295e-02 3 1  ON 10
ci_012                -2.257811e-02 3 1  ON 11
ci_013                 2.000281e-02 3 1  ON 12
ci_014                 2.020279e-02 3 1  ON 13
ci_015                 1.969222e-02 3 1  ON 14
ci_016                 2.073103e-02 3 1  ON 15
ci_017                 1.537661e-02 3 1  ON 16
ci_018                 1.572798e-02 3 1  ON 17
ci_019                 1.062681e-02 3 1  ON 18
ci_020                 1.043413e-02 3 1  ON 19
ci_021                -9.780452e-03 3 1  ON 20
ci_022                -9.449043e-03 3 1  ON 21
ci_023                 8.746924e-03 3 1  ON 22
ci_024                 9.496941e-03 3 1  ON 23
ci_025                 7.146790e-03 3 1  ON 24
ci_026                 8.157561e-03 3 1  ON 25
ci_027                 7.925803e-03 3 1  ON 26
ci_028                 7.865134e-03 3 1  ON 27
ci_029                -7.651715e-03 3 1  ON 28
ci_030                -7.767449e-03 3 1  ON 29
ci_031                -7.191922e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848300e-03 3 1  ON 32
ci_034                 6.332490e-03 3 1  ON 33
ci_035                 6.423597e-03 3 1  ON 34
ci_036                 6.952708e-03 3 1  ON 35
ci_037                 6.517639e-03 3 1  ON 36
ci_038                 5.615327e-03 3 1  ON 37
ci_039                 5.904504e-03 3 1  ON 38
ci_040                 6.141301e-03 3 1  ON 39
ci_041                 5.432079e-03 3 1  ON 40
ci_042                 5.116150e-03 3 1  ON 41
ci_043                 5.092724e-03 3 1  ON 42
ci_044                 4.460245e-03 3 1  ON 43
ci_045                 5.123036e-03 3 1  ON 44
ci_046                 5.281001e-03 3 1  ON 45
ci_047                -3.977429e-03 3 1  ON 46
ci_048                -4.394183e-03 3 1  ON 47
ci_049                 4.051382e-03 3 1  ON 48
ci_050                 3.469183e-03 3 1  ON 49
ci_051                -3.068029e-03 3 1  ON 50
ci_052                -2.205854e-03 3 1  ON 51
ci_053                -2.741684e-03 3 1  ON 52
ci_054                -3.445800e-03 3 1  ON 53
ci_055                -1.934383e-03 3 1  ON 54
ci_056                -2.000824e-03 3 1  ON 55
ci_057                -1.788408e-03 3 1  ON 56
ci_058                -1.821788e-03 3 1  ON 57
ci_059                -1.893195e-03 3 1  ON 58
ci_060                -2.080524e-03 3 1  ON 59
ci_061                -1.839445e-03 3 1  ON 60
ci_062                -1.916584e-03 3 1  ON 61
ci_063                -1.941701e-03 3 1  ON 62
ci_064                -9.422139e-04 3 1  ON 63
ci_065                -1.762786e-03 3 1  ON 64
ci_066                -1.417162e-03 3 1  ON 65
ci_067                -1.963941e-03 3 1  ON 66
ci_068                -1.527467e-03 3 1  ON 67
ci_069                 1.161381e-03 3 1  ON 68
ci_070                 1.598337e-03 3 1  ON 69
ci_071                 1.853803e-05 3 1  ON 70
ci_072                -2.575373e-04 3 1  ON 71
ci_073                 1.366313e-03 3 1  ON 72
ci_074                 8.920493e-04 3 1  ON 73
ci_075                -1.333726e-03 3 1  ON 74
ci_076                -7.301730e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.6849
    reference variance = 2.89274
====================================================
  Execution time = 2.3173e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7912e+00
  Total weights = 1.9502e+06
  Execution time = 4.4001e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.843950836644
                                         uncertainty =       0.083834916699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.843950836644
                                         uncertainty =       0.083834916699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386132971
  error estimate for blocks of size 2^( 2) =       0.001455075779
  error estimate for blocks of size 2^( 3) =       0.001517840329
  error estimate for blocks of size 2^( 4) =       0.001560407377
  error estimate for blocks of size 2^( 5) =       0.001585248361
  error estimate for blocks of size 2^( 6) =       0.001600361149
  error estimate for blocks of size 2^( 7) =       0.001608668304

      target function =                  N/A
              le_mean =     -22.330490098158
             les_mean =     502.441942016940
             stat err =       0.001588671298
             autocorr =       1.313585394562
              std dev =       1.960319410601
             le_variance =       3.842852191577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.843950681926
                                         uncertainty =       0.083834911646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.843950681926
                                         uncertainty =       0.083834911646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386132943
  error estimate for blocks of size 2^( 2) =       0.001455075761
  error estimate for blocks of size 2^( 3) =       0.001517840314
  error estimate for blocks of size 2^( 4) =       0.001560407367
  error estimate for blocks of size 2^( 5) =       0.001585248368
  error estimate for blocks of size 2^( 6) =       0.001600361134
  error estimate for blocks of size 2^( 7) =       0.001608668310

      target function =                  N/A
              le_mean =     -22.330490087712
             les_mean =     502.441937224581
             stat err =       0.001588671295
             autocorr =       1.313585442634
              std dev =       1.960319371238
             le_variance =       3.842852037252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.843950759218
                                         uncertainty =       0.083834914172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.843950759218
                                         uncertainty =       0.083834914172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386132957
  error estimate for blocks of size 2^( 2) =       0.001455075770
  error estimate for blocks of size 2^( 3) =       0.001517840322
  error estimate for blocks of size 2^( 4) =       0.001560407372
  error estimate for blocks of size 2^( 5) =       0.001585248365
  error estimate for blocks of size 2^( 6) =       0.001600361141
  error estimate for blocks of size 2^( 7) =       0.001608668307

      target function =                  N/A
              le_mean =     -22.330490092937
             les_mean =     502.441937386391
             stat err =       0.001588671296
             autocorr =       1.313585418586
              std dev =       1.960319390902
             le_variance =       3.842852114348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.843950826961
                                         uncertainty =       0.083834916383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.843950826961
                                         uncertainty =       0.083834916383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386132969
  error estimate for blocks of size 2^( 2) =       0.001455075778
  error estimate for blocks of size 2^( 3) =       0.001517840328
  error estimate for blocks of size 2^( 4) =       0.001560407377
  error estimate for blocks of size 2^( 5) =       0.001585248361
  error estimate for blocks of size 2^( 6) =       0.001600361148
  error estimate for blocks of size 2^( 7) =       0.001608668304

      target function =                  N/A
              le_mean =     -22.330490097509
             les_mean =     502.441939868771
             stat err =       0.001588671298
             autocorr =       1.313585397547
              std dev =       1.960319408137
             le_variance =       3.842852181919


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330490098158        initial  <--
     3.2312e+02     3.2312e+03             1.0498e-06       -22.330490087712
     1.2925e+03     1.2925e+04             2.6258e-07       -22.330490092937
     5.1699e+03     5.1699e+04             6.5653e-08       -22.330490097509

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.2376
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5052e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2308e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.2906
    reference variance = 4.97172
====================================================
  Execution time = 2.3773e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0331e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7097e+00
  Total weights = 1.949806909e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8860e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761986170312
                                         uncertainty =       0.031071232568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761986170312
                                         uncertainty =       0.031071232568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371399226
  error estimate for blocks of size 2^( 2) =       0.001442871149
  error estimate for blocks of size 2^( 3) =       0.001504872119
  error estimate for blocks of size 2^( 4) =       0.001549941891
  error estimate for blocks of size 2^( 5) =       0.001569961584
  error estimate for blocks of size 2^( 6) =       0.001583081834
  error estimate for blocks of size 2^( 7) =       0.001582414386

      target function =                  N/A
              le_mean =     -22.329657780263
             les_mean =     502.323325607510
             stat err =       0.001571349924
             autocorr =       1.312858794640
              std dev =       1.939482415593
             le_variance =       3.761592040396


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232965778026e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+03, overlap shift 3.2312e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329657779433       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329657783682       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329657783658       residual = 1.91e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+03 is 1.458199e-07

solving harmonic davidson linear method for identity shift 1.2925e+04, overlap shift 1.2925e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329657779433       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329657780495       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329657780489       residual = 1.91e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+04 is 3.645694e-08

solving harmonic davidson linear method for identity shift 5.1699e+04, overlap shift 5.1699e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329657779433       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329657779699       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329657779697       residual = 1.91e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+04 is 9.114357e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134555 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9666e+01
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_001                -6.963147e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618019e-02 3 1  ON 5
ci_007                 3.181047e-02 3 1  ON 6
ci_008                 3.146366e-02 3 1  ON 7
ci_009                -2.501994e-02 3 1  ON 8
ci_010                -2.551283e-02 3 1  ON 9
ci_011                -2.288297e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000281e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969212e-02 3 1  ON 14
ci_016                 2.073118e-02 3 1  ON 15
ci_017                 1.537659e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043433e-02 3 1  ON 19
ci_021                -9.780239e-03 3 1  ON 20
ci_022                -9.449033e-03 3 1  ON 21
ci_023                 8.746932e-03 3 1  ON 22
ci_024                 9.497077e-03 3 1  ON 23
ci_025                 7.146728e-03 3 1  ON 24
ci_026                 8.157608e-03 3 1  ON 25
ci_027                 7.925778e-03 3 1  ON 26
ci_028                 7.864957e-03 3 1  ON 27
ci_029                -7.651699e-03 3 1  ON 28
ci_030                -7.767447e-03 3 1  ON 29
ci_031                -7.191769e-03 3 1  ON 30
ci_032                -7.558472e-03 3 1  ON 31
ci_033                 6.848298e-03 3 1  ON 32
ci_034                 6.332367e-03 3 1  ON 33
ci_035                 6.423626e-03 3 1  ON 34
ci_036                 6.952777e-03 3 1  ON 35
ci_037                 6.517571e-03 3 1  ON 36
ci_038                 5.615239e-03 3 1  ON 37
ci_039                 5.904382e-03 3 1  ON 38
ci_040                 6.141297e-03 3 1  ON 39
ci_041                 5.432091e-03 3 1  ON 40
ci_042                 5.116260e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460056e-03 3 1  ON 43
ci_045                 5.123016e-03 3 1  ON 44
ci_046                 5.280844e-03 3 1  ON 45
ci_047                -3.977381e-03 3 1  ON 46
ci_048                -4.393990e-03 3 1  ON 47
ci_049                 4.051515e-03 3 1  ON 48
ci_050                 3.469300e-03 3 1  ON 49
ci_051                -3.067873e-03 3 1  ON 50
ci_052                -2.205656e-03 3 1  ON 51
ci_053                -2.741465e-03 3 1  ON 52
ci_054                -3.445846e-03 3 1  ON 53
ci_055                -1.934579e-03 3 1  ON 54
ci_056                -2.000920e-03 3 1  ON 55
ci_057                -1.788413e-03 3 1  ON 56
ci_058                -1.821767e-03 3 1  ON 57
ci_059                -1.893103e-03 3 1  ON 58
ci_060                -2.080549e-03 3 1  ON 59
ci_061                -1.839483e-03 3 1  ON 60
ci_062                -1.916702e-03 3 1  ON 61
ci_063                -1.941585e-03 3 1  ON 62
ci_064                -9.421655e-04 3 1  ON 63
ci_065                -1.762845e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964058e-03 3 1  ON 66
ci_068                -1.527586e-03 3 1  ON 67
ci_069                 1.161374e-03 3 1  ON 68
ci_070                 1.598533e-03 3 1  ON 69
ci_071                 1.878943e-05 3 1  ON 70
ci_072                -2.575232e-04 3 1  ON 71
ci_073                 1.366497e-03 3 1  ON 72
ci_074                 8.919840e-04 3 1  ON 73
ci_075                -1.333815e-03 3 1  ON 74
ci_076                -7.303466e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.1716
    reference variance = 3.74036
====================================================
  Execution time = 2.3148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7168e+00
  Total weights = 1.9497e+06
  Execution time = 4.3901e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767817749528
                                         uncertainty =       0.032437314171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767817749528
                                         uncertainty =       0.032437314171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372435796
  error estimate for blocks of size 2^( 2) =       0.001443334734
  error estimate for blocks of size 2^( 3) =       0.001507786855
  error estimate for blocks of size 2^( 4) =       0.001550016097
  error estimate for blocks of size 2^( 5) =       0.001573737031
  error estimate for blocks of size 2^( 6) =       0.001585939572
  error estimate for blocks of size 2^( 7) =       0.001594672978

      target function =                  N/A
              le_mean =     -22.328175897959
             les_mean =     502.264254284934
             stat err =       0.001576091419
             autocorr =       1.318799383156
              std dev =       1.940948371155
             le_variance =       3.767280579489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767817717764
                                         uncertainty =       0.032437314996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767817717764
                                         uncertainty =       0.032437314996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372435791
  error estimate for blocks of size 2^( 2) =       0.001443334731
  error estimate for blocks of size 2^( 3) =       0.001507786854
  error estimate for blocks of size 2^( 4) =       0.001550016098
  error estimate for blocks of size 2^( 5) =       0.001573737036
  error estimate for blocks of size 2^( 6) =       0.001585939579
  error estimate for blocks of size 2^( 7) =       0.001594672985

      target function =                  N/A
              le_mean =     -22.328175897537
             les_mean =     502.264254317050
             stat err =       0.001576091424
             autocorr =       1.318799402839
              std dev =       1.940948362981
             le_variance =       3.767280547759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767817733645
                                         uncertainty =       0.032437314583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767817733645
                                         uncertainty =       0.032437314583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372435793
  error estimate for blocks of size 2^( 2) =       0.001443334733
  error estimate for blocks of size 2^( 3) =       0.001507786854
  error estimate for blocks of size 2^( 4) =       0.001550016097
  error estimate for blocks of size 2^( 5) =       0.001573737034
  error estimate for blocks of size 2^( 6) =       0.001585939575
  error estimate for blocks of size 2^( 7) =       0.001594672981

      target function =                  N/A
              le_mean =     -22.328175897748
             les_mean =     502.264254300881
             stat err =       0.001576091422
             autocorr =       1.318799393000
              std dev =       1.940948367068
             le_variance =       3.767280563623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767817747543
                                         uncertainty =       0.032437314222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767817747543
                                         uncertainty =       0.032437314222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372435796
  error estimate for blocks of size 2^( 2) =       0.001443334734
  error estimate for blocks of size 2^( 3) =       0.001507786855
  error estimate for blocks of size 2^( 4) =       0.001550016097
  error estimate for blocks of size 2^( 5) =       0.001573737031
  error estimate for blocks of size 2^( 6) =       0.001585939573
  error estimate for blocks of size 2^( 7) =       0.001594672978

      target function =                  N/A
              le_mean =     -22.328175897933
             les_mean =     502.264254286915
             stat err =       0.001576091420
             autocorr =       1.318799384387
              std dev =       1.940948370644
             le_variance =       3.767280577506


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328175897959        initial  <--
     3.2312e+03     3.2312e+04             1.4582e-07       -22.328175897537
     1.2925e+04     1.2925e+05             3.6457e-08       -22.328175897748
     5.1699e+04     5.1699e+05             9.1144e-09       -22.328175897933

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.2240
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4917e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2307e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.3355
    reference variance = 2.59671
====================================================
  Execution time = 2.3841e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0266e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7776e+00
  Total weights = 1.950129916e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8910e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.829187417773
                                         uncertainty =       0.049979701222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.829187417773
                                         uncertainty =       0.049979701222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383624435
  error estimate for blocks of size 2^( 2) =       0.001455406397
  error estimate for blocks of size 2^( 3) =       0.001519878504
  error estimate for blocks of size 2^( 4) =       0.001564045756
  error estimate for blocks of size 2^( 5) =       0.001585086299
  error estimate for blocks of size 2^( 6) =       0.001600717210
  error estimate for blocks of size 2^( 7) =       0.001608882966

      target function =                  N/A
              le_mean =     -22.327617046145
             les_mean =     502.300068034938
             stat err =       0.001589683058
             autocorr =       1.320032564152
              std dev =       1.956771749197
             le_variance =       3.828955678457


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232761704614e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+04, overlap shift 3.2312e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327617045289       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327617046000       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327617046006       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327617046017       residual = 2.48e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+04 is 1.728235e-08

solving harmonic davidson linear method for identity shift 1.2925e+05, overlap shift 1.2925e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327617045289       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327617045467       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327617045469       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327617045469       residual = 2.48e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+05 is 4.320606e-09

solving harmonic davidson linear method for identity shift 5.1699e+05, overlap shift 5.1699e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327617045289       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327617045334       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327617045334       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327617045334       residual = 2.48e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+05 is 1.080153e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136054 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9739e+01
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780231e-03 3 1  ON 20
ci_022                -9.449019e-03 3 1  ON 21
ci_023                 8.746941e-03 3 1  ON 22
ci_024                 9.497079e-03 3 1  ON 23
ci_025                 7.146706e-03 3 1  ON 24
ci_026                 8.157606e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864942e-03 3 1  ON 27
ci_029                -7.651709e-03 3 1  ON 28
ci_030                -7.767455e-03 3 1  ON 29
ci_031                -7.191775e-03 3 1  ON 30
ci_032                -7.558475e-03 3 1  ON 31
ci_033                 6.848304e-03 3 1  ON 32
ci_034                 6.332359e-03 3 1  ON 33
ci_035                 6.423609e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517576e-03 3 1  ON 36
ci_038                 5.615241e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432089e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092770e-03 3 1  ON 42
ci_044                 4.460050e-03 3 1  ON 43
ci_045                 5.123034e-03 3 1  ON 44
ci_046                 5.280839e-03 3 1  ON 45
ci_047                -3.977388e-03 3 1  ON 46
ci_048                -4.394010e-03 3 1  ON 47
ci_049                 4.051535e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067859e-03 3 1  ON 50
ci_052                -2.205644e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445851e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821740e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839484e-03 3 1  ON 60
ci_062                -1.916697e-03 3 1  ON 61
ci_063                -1.941598e-03 3 1  ON 62
ci_064                -9.421652e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964055e-03 3 1  ON 66
ci_068                -1.527589e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598513e-03 3 1  ON 69
ci_071                 1.880039e-05 3 1  ON 70
ci_072                -2.575238e-04 3 1  ON 71
ci_073                 1.366491e-03 3 1  ON 72
ci_074                 8.919682e-04 3 1  ON 73
ci_075                -1.333813e-03 3 1  ON 74
ci_076                -7.303333e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.3259
    reference variance = 2.51189
====================================================
  Execution time = 2.3153e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7674e+00
  Total weights = 1.9499e+06
  Execution time = 4.3792e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820911777597
                                         uncertainty =       0.061265660952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820911777597
                                         uncertainty =       0.061265660952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382080281
  error estimate for blocks of size 2^( 2) =       0.001451371559
  error estimate for blocks of size 2^( 3) =       0.001512351492
  error estimate for blocks of size 2^( 4) =       0.001556257684
  error estimate for blocks of size 2^( 5) =       0.001582409632
  error estimate for blocks of size 2^( 6) =       0.001598633425
  error estimate for blocks of size 2^( 7) =       0.001604404788

      target function =                  N/A
              le_mean =     -22.328222124787
             les_mean =     502.316902732486
             stat err =       0.001585426382
             autocorr =       1.315908281319
              std dev =       1.954587950707
             le_variance =       3.820414057051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820911775679
                                         uncertainty =       0.061265660920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820911775679
                                         uncertainty =       0.061265660920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382080281
  error estimate for blocks of size 2^( 2) =       0.001451371559
  error estimate for blocks of size 2^( 3) =       0.001512351492
  error estimate for blocks of size 2^( 4) =       0.001556257684
  error estimate for blocks of size 2^( 5) =       0.001582409632
  error estimate for blocks of size 2^( 6) =       0.001598633424
  error estimate for blocks of size 2^( 7) =       0.001604404788

      target function =                  N/A
              le_mean =     -22.328222124726
             les_mean =     502.316902725962
             stat err =       0.001585426382
             autocorr =       1.315908282034
              std dev =       1.954587950218
             le_variance =       3.820414055138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820911776638
                                         uncertainty =       0.061265660936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820911776638
                                         uncertainty =       0.061265660936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382080281
  error estimate for blocks of size 2^( 2) =       0.001451371559
  error estimate for blocks of size 2^( 3) =       0.001512351492
  error estimate for blocks of size 2^( 4) =       0.001556257684
  error estimate for blocks of size 2^( 5) =       0.001582409632
  error estimate for blocks of size 2^( 6) =       0.001598633424
  error estimate for blocks of size 2^( 7) =       0.001604404788

      target function =                  N/A
              le_mean =     -22.328222124756
             les_mean =     502.316902729222
             stat err =       0.001585426382
             autocorr =       1.315908281677
              std dev =       1.954587950463
             le_variance =       3.820414056094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820911777477
                                         uncertainty =       0.061265660950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820911777477
                                         uncertainty =       0.061265660950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382080281
  error estimate for blocks of size 2^( 2) =       0.001451371559
  error estimate for blocks of size 2^( 3) =       0.001512351492
  error estimate for blocks of size 2^( 4) =       0.001556257684
  error estimate for blocks of size 2^( 5) =       0.001582409632
  error estimate for blocks of size 2^( 6) =       0.001598633425
  error estimate for blocks of size 2^( 7) =       0.001604404788

      target function =                  N/A
              le_mean =     -22.328222124783
             les_mean =     502.316902732078
             stat err =       0.001585426382
             autocorr =       1.315908281365
              std dev =       1.954587950677
             le_variance =       3.820414056931


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328222124787        initial  <--
     3.2312e+04     3.2312e+05             1.7282e-08       -22.328222124726
     1.2925e+05     1.2925e+06             4.3206e-09       -22.328222124756
     5.1699e+05     5.1699e+06             1.0802e-09       -22.328222124783

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1489
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4896e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2308e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.2443
    reference variance = 3.2569
====================================================
  Execution time = 2.3738e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0321e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7210e+00
  Total weights = 1.950227417e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0161e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772433358693
                                         uncertainty =       0.031073643989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772433358693
                                         uncertainty =       0.031073643989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373409505
  error estimate for blocks of size 2^( 2) =       0.001444525803
  error estimate for blocks of size 2^( 3) =       0.001508108866
  error estimate for blocks of size 2^( 4) =       0.001551664260
  error estimate for blocks of size 2^( 5) =       0.001574649851
  error estimate for blocks of size 2^( 6) =       0.001588292226
  error estimate for blocks of size 2^( 7) =       0.001594092283

      target function =                  N/A
              le_mean =     -22.327321492055
             les_mean =     502.230283385545
             stat err =       0.001577174655
             autocorr =       1.318740917180
              std dev =       1.942325424895
             le_variance =       3.772628056195


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232732149206e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+05, overlap shift 3.2312e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327321491228       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327321491287       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327321491287       residual = 2.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+05 is 1.304973e-09

solving harmonic davidson linear method for identity shift 1.2925e+06, overlap shift 1.2925e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327321491228       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327321491243       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327321491243       residual = 2.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+06 is 3.262435e-10

solving harmonic davidson linear method for identity shift 5.1699e+06, overlap shift 5.1699e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327321491228       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327321491231       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327321491231       residual = 2.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+06 is 8.156088e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137205 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9761e+01
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497080e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651709e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952795e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000921e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880033e-05 3 1  ON 70
ci_072                -2.575224e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919673e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.4098
    reference variance = 3.30648
====================================================
  Execution time = 2.3238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7997e+00
  Total weights = 1.9499e+06
  Execution time = 4.8105e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850696330477
                                         uncertainty =       0.100518412699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850696330477
                                         uncertainty =       0.100518412699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387676465
  error estimate for blocks of size 2^( 2) =       0.001458051053
  error estimate for blocks of size 2^( 3) =       0.001519504833
  error estimate for blocks of size 2^( 4) =       0.001560365664
  error estimate for blocks of size 2^( 5) =       0.001581466784
  error estimate for blocks of size 2^( 6) =       0.001593419311
  error estimate for blocks of size 2^( 7) =       0.001601640756

      target function =                  N/A
              le_mean =     -22.329434547693
             les_mean =     502.403383927785
             stat err =       0.001584223129
             autocorr =       1.303335585673
              std dev =       1.962502276920
             le_variance =       3.851415186915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850696330428
                                         uncertainty =       0.100518412697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850696330428
                                         uncertainty =       0.100518412697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387676465
  error estimate for blocks of size 2^( 2) =       0.001458051053
  error estimate for blocks of size 2^( 3) =       0.001519504833
  error estimate for blocks of size 2^( 4) =       0.001560365664
  error estimate for blocks of size 2^( 5) =       0.001581466784
  error estimate for blocks of size 2^( 6) =       0.001593419311
  error estimate for blocks of size 2^( 7) =       0.001601640756

      target function =                  N/A
              le_mean =     -22.329434547685
             les_mean =     502.403383931349
             stat err =       0.001584223129
             autocorr =       1.303335585643
              std dev =       1.962502276908
             le_variance =       3.851415186868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850696330452
                                         uncertainty =       0.100518412698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850696330452
                                         uncertainty =       0.100518412698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387676465
  error estimate for blocks of size 2^( 2) =       0.001458051053
  error estimate for blocks of size 2^( 3) =       0.001519504833
  error estimate for blocks of size 2^( 4) =       0.001560365664
  error estimate for blocks of size 2^( 5) =       0.001581466784
  error estimate for blocks of size 2^( 6) =       0.001593419311
  error estimate for blocks of size 2^( 7) =       0.001601640756

      target function =                  N/A
              le_mean =     -22.329434547689
             les_mean =     502.403383929567
             stat err =       0.001584223129
             autocorr =       1.303335585658
              std dev =       1.962502276914
             le_variance =       3.851415186892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850696330474
                                         uncertainty =       0.100518412699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850696330474
                                         uncertainty =       0.100518412699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387676465
  error estimate for blocks of size 2^( 2) =       0.001458051053
  error estimate for blocks of size 2^( 3) =       0.001519504833
  error estimate for blocks of size 2^( 4) =       0.001560365664
  error estimate for blocks of size 2^( 5) =       0.001581466784
  error estimate for blocks of size 2^( 6) =       0.001593419311
  error estimate for blocks of size 2^( 7) =       0.001601640756

      target function =                  N/A
              le_mean =     -22.329434547692
             les_mean =     502.403383928007
             stat err =       0.001584223129
             autocorr =       1.303335585671
              std dev =       1.962502276919
             le_variance =       3.851415186912


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329434547693        initial  <--
     3.2312e+05     3.2312e+06             1.3050e-09       -22.329434547685
     1.2925e+06     1.2925e+07             3.2624e-10       -22.329434547689
     5.1699e+06     5.1699e+07             8.1561e-11       -22.329434547692

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.7961
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5564e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2308e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.4498
    reference variance = 2.79289
====================================================
  Execution time = 2.3812e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0320e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.6809e+00
  Total weights = 1.949898660e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8960e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.733156089494
                                         uncertainty =       0.025925359808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.733156089494
                                         uncertainty =       0.025925359808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366189388
  error estimate for blocks of size 2^( 2) =       0.001437504733
  error estimate for blocks of size 2^( 3) =       0.001501872180
  error estimate for blocks of size 2^( 4) =       0.001547665911
  error estimate for blocks of size 2^( 5) =       0.001572874047
  error estimate for blocks of size 2^( 6) =       0.001584042160
  error estimate for blocks of size 2^( 7) =       0.001590324691

      target function =                  N/A
              le_mean =     -22.326438971252
             les_mean =     502.150789270629
             stat err =       0.001573726703
             autocorr =       1.326895779211
              std dev =       1.932114474200
             le_variance =       3.733066341412


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232643897125e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+06, overlap shift 3.2312e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326438970478       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326438970484       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326438970484       residual = 3.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+06 is 1.335070e-10

solving harmonic davidson linear method for identity shift 1.2925e+07, overlap shift 1.2925e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326438970478       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326438970480       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326438970480       residual = 3.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+07 is 3.337675e-11

solving harmonic davidson linear method for identity shift 5.1699e+07, overlap shift 5.1699e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326438970478       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326438970479       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326438970479       residual = 3.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+07 is 8.344189e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138412 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9715e+01
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421642e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.3934
    reference variance = 2.4988
====================================================
  Execution time = 2.3242e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7722e+00
  Total weights = 1.9498e+06
  Execution time = 4.3496e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823176338759
                                         uncertainty =       0.072486213848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823176338759
                                         uncertainty =       0.072486213848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382702761
  error estimate for blocks of size 2^( 2) =       0.001452992382
  error estimate for blocks of size 2^( 3) =       0.001515311545
  error estimate for blocks of size 2^( 4) =       0.001555091804
  error estimate for blocks of size 2^( 5) =       0.001577403302
  error estimate for blocks of size 2^( 6) =       0.001587995699
  error estimate for blocks of size 2^( 7) =       0.001596614802

      target function =                  N/A
              le_mean =     -22.328855780336
             les_mean =     502.350019106605
             stat err =       0.001579276402
             autocorr =       1.304543699598
              std dev =       1.955468284682
             le_variance =       3.823856212399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823176338764
                                         uncertainty =       0.072486213848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823176338764
                                         uncertainty =       0.072486213848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382702761
  error estimate for blocks of size 2^( 2) =       0.001452992382
  error estimate for blocks of size 2^( 3) =       0.001515311545
  error estimate for blocks of size 2^( 4) =       0.001555091804
  error estimate for blocks of size 2^( 5) =       0.001577403302
  error estimate for blocks of size 2^( 6) =       0.001587995699
  error estimate for blocks of size 2^( 7) =       0.001596614802

      target function =                  N/A
              le_mean =     -22.328855780336
             les_mean =     502.350019106522
             stat err =       0.001579276402
             autocorr =       1.304543699606
              std dev =       1.955468284684
             le_variance =       3.823856212404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823176338761
                                         uncertainty =       0.072486213848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823176338761
                                         uncertainty =       0.072486213848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382702761
  error estimate for blocks of size 2^( 2) =       0.001452992382
  error estimate for blocks of size 2^( 3) =       0.001515311545
  error estimate for blocks of size 2^( 4) =       0.001555091804
  error estimate for blocks of size 2^( 5) =       0.001577403302
  error estimate for blocks of size 2^( 6) =       0.001587995699
  error estimate for blocks of size 2^( 7) =       0.001596614802

      target function =                  N/A
              le_mean =     -22.328855780336
             les_mean =     502.350019106563
             stat err =       0.001579276402
             autocorr =       1.304543699602
              std dev =       1.955468284683
             le_variance =       3.823856212401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823176338759
                                         uncertainty =       0.072486213848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823176338759
                                         uncertainty =       0.072486213848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382702761
  error estimate for blocks of size 2^( 2) =       0.001452992382
  error estimate for blocks of size 2^( 3) =       0.001515311545
  error estimate for blocks of size 2^( 4) =       0.001555091804
  error estimate for blocks of size 2^( 5) =       0.001577403302
  error estimate for blocks of size 2^( 6) =       0.001587995699
  error estimate for blocks of size 2^( 7) =       0.001596614802

      target function =                  N/A
              le_mean =     -22.328855780336
             les_mean =     502.350019106599
             stat err =       0.001579276402
             autocorr =       1.304543699599
              std dev =       1.955468284682
             le_variance =       3.823856212399


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328855780336        initial  <--
     3.2312e+06     3.2312e+07             1.3351e-10       -22.328855780336
     1.2925e+07     1.2925e+08             3.3377e-11       -22.328855780336
     5.1699e+07     5.1699e+08             8.3442e-12       -22.328855780336

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0634
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4785e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2309e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.6139
    reference variance = 2.43898
====================================================
  Execution time = 2.3761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0302e+04
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.7681e+00
  Total weights = 1.949943195e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9064e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.821597709864
                                         uncertainty =       0.065765354609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.821597709864
                                         uncertainty =       0.065765354609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382249598
  error estimate for blocks of size 2^( 2) =       0.001453193529
  error estimate for blocks of size 2^( 3) =       0.001515500397
  error estimate for blocks of size 2^( 4) =       0.001559744535
  error estimate for blocks of size 2^( 5) =       0.001583013783
  error estimate for blocks of size 2^( 6) =       0.001592178060
  error estimate for blocks of size 2^( 7) =       0.001601353425

      target function =                  N/A
              le_mean =     -22.330673793817
             les_mean =     502.427071270011
             stat err =       0.001584072451
             autocorr =       1.313339896229
              std dev =       1.954827405129
             le_variance =       3.821350183842


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233067379382e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+07, overlap shift 3.2312e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330673793037       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330673793037       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330673793037       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+07 is 1.640209e-11

solving harmonic davidson linear method for identity shift 1.2925e+08, overlap shift 1.2925e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330673793037       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330673793037       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330673793037       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+08 is 4.100534e-12

solving harmonic davidson linear method for identity shift 5.1699e+08, overlap shift 5.1699e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330673793037       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330673793037       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330673793037       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+08 is 1.025134e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139592 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9674e+01
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880060e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -21.8027
    reference variance = 7.46171
====================================================
  Execution time = 2.3135e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7864e+00
  Total weights = 1.9494e+06
  Execution time = 4.3569e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837328728125
                                         uncertainty =       0.076906852470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837328728125
                                         uncertainty =       0.076906852470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385083142
  error estimate for blocks of size 2^( 2) =       0.001455178849
  error estimate for blocks of size 2^( 3) =       0.001518095255
  error estimate for blocks of size 2^( 4) =       0.001561301192
  error estimate for blocks of size 2^( 5) =       0.001586755851
  error estimate for blocks of size 2^( 6) =       0.001598290802
  error estimate for blocks of size 2^( 7) =       0.001604132169

      target function =                  N/A
              le_mean =     -22.327800011724
             les_mean =     502.317042135515
             stat err =       0.001587620004
             autocorr =       1.313836846241
              std dev =       1.958834705600
             le_variance =       3.837033403863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837328728121
                                         uncertainty =       0.076906852470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837328728121
                                         uncertainty =       0.076906852470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385083142
  error estimate for blocks of size 2^( 2) =       0.001455178849
  error estimate for blocks of size 2^( 3) =       0.001518095255
  error estimate for blocks of size 2^( 4) =       0.001561301192
  error estimate for blocks of size 2^( 5) =       0.001586755851
  error estimate for blocks of size 2^( 6) =       0.001598290802
  error estimate for blocks of size 2^( 7) =       0.001604132169

      target function =                  N/A
              le_mean =     -22.327800011724
             les_mean =     502.317042135495
             stat err =       0.001587620004
             autocorr =       1.313836846244
              std dev =       1.958834705599
             le_variance =       3.837033403859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837328728123
                                         uncertainty =       0.076906852470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837328728123
                                         uncertainty =       0.076906852470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385083142
  error estimate for blocks of size 2^( 2) =       0.001455178849
  error estimate for blocks of size 2^( 3) =       0.001518095255
  error estimate for blocks of size 2^( 4) =       0.001561301192
  error estimate for blocks of size 2^( 5) =       0.001586755851
  error estimate for blocks of size 2^( 6) =       0.001598290802
  error estimate for blocks of size 2^( 7) =       0.001604132169

      target function =                  N/A
              le_mean =     -22.327800011724
             les_mean =     502.317042135505
             stat err =       0.001587620004
             autocorr =       1.313836846243
              std dev =       1.958834705600
             le_variance =       3.837033403862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837328728125
                                         uncertainty =       0.076906852470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837328728125
                                         uncertainty =       0.076906852470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385083142
  error estimate for blocks of size 2^( 2) =       0.001455178849
  error estimate for blocks of size 2^( 3) =       0.001518095255
  error estimate for blocks of size 2^( 4) =       0.001561301192
  error estimate for blocks of size 2^( 5) =       0.001586755851
  error estimate for blocks of size 2^( 6) =       0.001598290802
  error estimate for blocks of size 2^( 7) =       0.001604132169

      target function =                  N/A
              le_mean =     -22.327800011724
             les_mean =     502.317042135514
             stat err =       0.001587620004
             autocorr =       1.313836846241
              std dev =       1.958834705600
             le_variance =       3.837033403863


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327800011724        initial  <--
     3.2312e+07     3.2312e+08             1.6402e-11       -22.327800011724
     1.2925e+08     1.2925e+09             4.1005e-12       -22.327800011724
     5.1699e+08     5.1699e+09             1.0251e-12       -22.327800011724

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0102
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4707e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2308e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.1867
    reference variance = 2.98891
====================================================
  Execution time = 2.3882e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0312e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7324e+00
  Total weights = 1.949721281e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9035e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785033447918
                                         uncertainty =       0.035739749392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785033447918
                                         uncertainty =       0.035739749392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375555079
  error estimate for blocks of size 2^( 2) =       0.001445662446
  error estimate for blocks of size 2^( 3) =       0.001509303904
  error estimate for blocks of size 2^( 4) =       0.001550716377
  error estimate for blocks of size 2^( 5) =       0.001575898371
  error estimate for blocks of size 2^( 6) =       0.001581716141
  error estimate for blocks of size 2^( 7) =       0.001590048289

      target function =                  N/A
              le_mean =     -22.329609318900
             les_mean =     502.343869199139
             stat err =       0.001574594795
             autocorr =       1.310332923206
              std dev =       1.945359773752
             le_variance =       3.784424649332


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232960931890e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+08, overlap shift 3.2312e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329609318070       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329609318070       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329609318070       residual = 5.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+08 is 1.488525e-12

solving harmonic davidson linear method for identity shift 1.2925e+09, overlap shift 1.2925e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329609318070       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329609318070       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329609318070       residual = 5.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+09 is 3.721317e-13

solving harmonic davidson linear method for identity shift 5.1699e+09, overlap shift 5.1699e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329609318070       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329609318070       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329609318070       residual = 6.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+09 is 9.300089e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140786 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9792e+01
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.3452
    reference variance = 3.27819
====================================================
  Execution time = 2.3248e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7324e+00
  Total weights = 1.9497e+06
  Execution time = 4.3687e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781959708064
                                         uncertainty =       0.042775494935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781959708064
                                         uncertainty =       0.042775494935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375510201
  error estimate for blocks of size 2^( 2) =       0.001446433271
  error estimate for blocks of size 2^( 3) =       0.001510212285
  error estimate for blocks of size 2^( 4) =       0.001554744734
  error estimate for blocks of size 2^( 5) =       0.001580063429
  error estimate for blocks of size 2^( 6) =       0.001594029769
  error estimate for blocks of size 2^( 7) =       0.001599464589

      target function =                  N/A
              le_mean =     -22.326936307211
             les_mean =     502.224489599922
             stat err =       0.001582075630
             autocorr =       1.322899494942
              std dev =       1.945296305674
             le_variance =       3.784177716869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781959708064
                                         uncertainty =       0.042775494935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781959708064
                                         uncertainty =       0.042775494935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375510201
  error estimate for blocks of size 2^( 2) =       0.001446433271
  error estimate for blocks of size 2^( 3) =       0.001510212285
  error estimate for blocks of size 2^( 4) =       0.001554744734
  error estimate for blocks of size 2^( 5) =       0.001580063429
  error estimate for blocks of size 2^( 6) =       0.001594029769
  error estimate for blocks of size 2^( 7) =       0.001599464589

      target function =                  N/A
              le_mean =     -22.326936307211
             les_mean =     502.224489599923
             stat err =       0.001582075630
             autocorr =       1.322899494941
              std dev =       1.945296305674
             le_variance =       3.784177716869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781959708064
                                         uncertainty =       0.042775494935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781959708064
                                         uncertainty =       0.042775494935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375510201
  error estimate for blocks of size 2^( 2) =       0.001446433271
  error estimate for blocks of size 2^( 3) =       0.001510212285
  error estimate for blocks of size 2^( 4) =       0.001554744734
  error estimate for blocks of size 2^( 5) =       0.001580063429
  error estimate for blocks of size 2^( 6) =       0.001594029769
  error estimate for blocks of size 2^( 7) =       0.001599464589

      target function =                  N/A
              le_mean =     -22.326936307211
             les_mean =     502.224489599923
             stat err =       0.001582075630
             autocorr =       1.322899494942
              std dev =       1.945296305674
             le_variance =       3.784177716869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781959708064
                                         uncertainty =       0.042775494935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781959708064
                                         uncertainty =       0.042775494935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375510201
  error estimate for blocks of size 2^( 2) =       0.001446433271
  error estimate for blocks of size 2^( 3) =       0.001510212285
  error estimate for blocks of size 2^( 4) =       0.001554744734
  error estimate for blocks of size 2^( 5) =       0.001580063429
  error estimate for blocks of size 2^( 6) =       0.001594029769
  error estimate for blocks of size 2^( 7) =       0.001599464589

      target function =                  N/A
              le_mean =     -22.326936307211
             les_mean =     502.224489599922
             stat err =       0.001582075630
             autocorr =       1.322899494942
              std dev =       1.945296305674
             le_variance =       3.784177716869


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326936307211        initial  <--
     3.2312e+08     3.2312e+09             1.4885e-12       -22.326936307211
     1.2925e+09     1.2925e+10             3.7213e-13       -22.326936307211
     5.1699e+09     5.1699e+10             9.3001e-14       -22.326936307211

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1537
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4952e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2307e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.3198
    reference variance = 1.66403
====================================================
  Execution time = 2.3777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0291e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.8901e+00
  Total weights = 1.949730468e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9272e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.945172243276
                                         uncertainty =       0.126643311061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.945172243276
                                         uncertainty =       0.126643311061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001404213752
  error estimate for blocks of size 2^( 2) =       0.001473313513
  error estimate for blocks of size 2^( 3) =       0.001534333084
  error estimate for blocks of size 2^( 4) =       0.001576711805
  error estimate for blocks of size 2^( 5) =       0.001602745943
  error estimate for blocks of size 2^( 6) =       0.001618222194
  error estimate for blocks of size 2^( 7) =       0.001629803067

      target function =                  N/A
              le_mean =     -22.326210704993
             les_mean =     502.349780209200
             stat err =       0.001606870752
             autocorr =       1.309469682159
              std dev =       1.985889906583
             le_variance =       3.943758721069


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232621070499e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+09, overlap shift 3.2312e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326210704175       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326210704175       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326210704175       residual = 8.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+09 is 1.241418e-13

solving harmonic davidson linear method for identity shift 1.2925e+10, overlap shift 1.2925e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326210704175       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326210704175       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326210704175       residual = 8.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+10 is 3.103544e-14

solving harmonic davidson linear method for identity shift 5.1699e+10, overlap shift 5.1699e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326210704175       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326210704175       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326210704175       residual = 8.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+10 is 7.758860e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141965 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9711e+01
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.4105
    reference variance = 3.27873
====================================================
  Execution time = 2.3161e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.8016e+00
  Total weights = 1.9498e+06
  Execution time = 4.8488e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850990764603
                                         uncertainty =       0.050135686827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850990764603
                                         uncertainty =       0.050135686827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387512635
  error estimate for blocks of size 2^( 2) =       0.001457923075
  error estimate for blocks of size 2^( 3) =       0.001519260049
  error estimate for blocks of size 2^( 4) =       0.001560983011
  error estimate for blocks of size 2^( 5) =       0.001589817112
  error estimate for blocks of size 2^( 6) =       0.001602812779
  error estimate for blocks of size 2^( 7) =       0.001615613583

      target function =                  N/A
              le_mean =     -22.327446830711
             les_mean =     502.316530940758
             stat err =       0.001592306621
             autocorr =       1.316980998966
              std dev =       1.962270581363
             le_variance =       3.850505834483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850990764603
                                         uncertainty =       0.050135686827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850990764603
                                         uncertainty =       0.050135686827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387512635
  error estimate for blocks of size 2^( 2) =       0.001457923075
  error estimate for blocks of size 2^( 3) =       0.001519260049
  error estimate for blocks of size 2^( 4) =       0.001560983011
  error estimate for blocks of size 2^( 5) =       0.001589817112
  error estimate for blocks of size 2^( 6) =       0.001602812779
  error estimate for blocks of size 2^( 7) =       0.001615613583

      target function =                  N/A
              le_mean =     -22.327446830711
             les_mean =     502.316530940758
             stat err =       0.001592306621
             autocorr =       1.316980998966
              std dev =       1.962270581363
             le_variance =       3.850505834483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850990764603
                                         uncertainty =       0.050135686827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850990764603
                                         uncertainty =       0.050135686827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387512635
  error estimate for blocks of size 2^( 2) =       0.001457923075
  error estimate for blocks of size 2^( 3) =       0.001519260049
  error estimate for blocks of size 2^( 4) =       0.001560983011
  error estimate for blocks of size 2^( 5) =       0.001589817112
  error estimate for blocks of size 2^( 6) =       0.001602812779
  error estimate for blocks of size 2^( 7) =       0.001615613583

      target function =                  N/A
              le_mean =     -22.327446830711
             les_mean =     502.316530940758
             stat err =       0.001592306621
             autocorr =       1.316980998965
              std dev =       1.962270581363
             le_variance =       3.850505834483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850990764603
                                         uncertainty =       0.050135686827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850990764603
                                         uncertainty =       0.050135686827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387512635
  error estimate for blocks of size 2^( 2) =       0.001457923075
  error estimate for blocks of size 2^( 3) =       0.001519260049
  error estimate for blocks of size 2^( 4) =       0.001560983011
  error estimate for blocks of size 2^( 5) =       0.001589817112
  error estimate for blocks of size 2^( 6) =       0.001602812779
  error estimate for blocks of size 2^( 7) =       0.001615613583

      target function =                  N/A
              le_mean =     -22.327446830711
             les_mean =     502.316530940758
             stat err =       0.001592306621
             autocorr =       1.316980998966
              std dev =       1.962270581363
             le_variance =       3.850505834483


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327446830711        initial
     3.2312e+09     3.2312e+10             1.2414e-13       -22.327446830711
     1.2925e+10     1.2925e+11             3.1035e-14       -22.327446830711  <--
     5.1699e+10     5.1699e+11             7.7589e-15       -22.327446830711

*****************************************************************************
Applying the update for shift_i =   1.2925e+10     and shift_s =   1.2925e+11
*****************************************************************************

  Execution time = 4.5782e+01
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5505e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2308e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.2514
    reference variance = 3.84479
====================================================
  Execution time = 2.3753e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0287e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6602e+00
  Total weights = 1.949444032e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8944e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.701976252418
                                         uncertainty =       0.027461509159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.701976252418
                                         uncertainty =       0.027461509159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001361896523
  error estimate for blocks of size 2^( 2) =       0.001432952968
  error estimate for blocks of size 2^( 3) =       0.001494742588
  error estimate for blocks of size 2^( 4) =       0.001541719183
  error estimate for blocks of size 2^( 5) =       0.001566136544
  error estimate for blocks of size 2^( 6) =       0.001581258346
  error estimate for blocks of size 2^( 7) =       0.001581017028

      target function =                  N/A
              le_mean =     -22.328818067198
             les_mean =     502.236280391902
             stat err =       0.001567532775
             autocorr =       1.324783888590
              std dev =       1.926043349923
             le_variance =       3.709642985781


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232881806720e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+09, overlap shift 3.2312e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328818066377       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328818066377       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328818066377       residual = 1.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+09 is 2.289156e-13

solving harmonic davidson linear method for identity shift 1.2925e+10, overlap shift 1.2925e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328818066377       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328818066377       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328818066377       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+10 is 5.728725e-14

solving harmonic davidson linear method for identity shift 5.1699e+10, overlap shift 5.1699e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328818066377       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328818066377       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328818066377       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328818066377       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+10 is 1.435560e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143245 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9654e+01
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.6198
    reference variance = 2.12874
====================================================
  Execution time = 2.3172e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7926e+00
  Total weights = 1.9497e+06
  Execution time = 4.3717e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844803720349
                                         uncertainty =       0.038180808894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844803720349
                                         uncertainty =       0.038180808894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386509003
  error estimate for blocks of size 2^( 2) =       0.001458077411
  error estimate for blocks of size 2^( 3) =       0.001520927796
  error estimate for blocks of size 2^( 4) =       0.001565438596
  error estimate for blocks of size 2^( 5) =       0.001589823944
  error estimate for blocks of size 2^( 6) =       0.001609650127
  error estimate for blocks of size 2^( 7) =       0.001623753468

      target function =                  N/A
              le_mean =     -22.327093783694
             les_mean =     502.291698451605
             stat err =       0.001597166534
             autocorr =       1.326951394574
              std dev =       1.960851209962
             le_variance =       3.844937467608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844803720349
                                         uncertainty =       0.038180808894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844803720349
                                         uncertainty =       0.038180808894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386509003
  error estimate for blocks of size 2^( 2) =       0.001458077411
  error estimate for blocks of size 2^( 3) =       0.001520927796
  error estimate for blocks of size 2^( 4) =       0.001565438596
  error estimate for blocks of size 2^( 5) =       0.001589823944
  error estimate for blocks of size 2^( 6) =       0.001609650127
  error estimate for blocks of size 2^( 7) =       0.001623753468

      target function =                  N/A
              le_mean =     -22.327093783694
             les_mean =     502.291698451605
             stat err =       0.001597166534
             autocorr =       1.326951394574
              std dev =       1.960851209962
             le_variance =       3.844937467608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844803720349
                                         uncertainty =       0.038180808894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844803720349
                                         uncertainty =       0.038180808894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386509003
  error estimate for blocks of size 2^( 2) =       0.001458077411
  error estimate for blocks of size 2^( 3) =       0.001520927796
  error estimate for blocks of size 2^( 4) =       0.001565438596
  error estimate for blocks of size 2^( 5) =       0.001589823944
  error estimate for blocks of size 2^( 6) =       0.001609650127
  error estimate for blocks of size 2^( 7) =       0.001623753468

      target function =                  N/A
              le_mean =     -22.327093783694
             les_mean =     502.291698451605
             stat err =       0.001597166534
             autocorr =       1.326951394574
              std dev =       1.960851209962
             le_variance =       3.844937467608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844803720349
                                         uncertainty =       0.038180808894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844803720349
                                         uncertainty =       0.038180808894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386509003
  error estimate for blocks of size 2^( 2) =       0.001458077411
  error estimate for blocks of size 2^( 3) =       0.001520927796
  error estimate for blocks of size 2^( 4) =       0.001565438596
  error estimate for blocks of size 2^( 5) =       0.001589823944
  error estimate for blocks of size 2^( 6) =       0.001609650127
  error estimate for blocks of size 2^( 7) =       0.001623753468

      target function =                  N/A
              le_mean =     -22.327093783694
             les_mean =     502.291698451605
             stat err =       0.001597166534
             autocorr =       1.326951394575
              std dev =       1.960851209962
             le_variance =       3.844937467608


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327093783694        initial  <--
     3.2312e+09     3.2312e+10             2.2892e-13       -22.327093783694
     1.2925e+10     1.2925e+11             5.7287e-14       -22.327093783694
     5.1699e+10     5.1699e+11             1.4356e-14       -22.327093783694

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0870
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4748e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2310e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.3172
    reference variance = 4.17452
====================================================
  Execution time = 2.3720e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0310e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7521e+00
  Total weights = 1.949979090e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8904e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804554857273
                                         uncertainty =       0.037470727261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804554857273
                                         uncertainty =       0.037470727261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378964965
  error estimate for blocks of size 2^( 2) =       0.001449152861
  error estimate for blocks of size 2^( 3) =       0.001512954518
  error estimate for blocks of size 2^( 4) =       0.001556545400
  error estimate for blocks of size 2^( 5) =       0.001580797876
  error estimate for blocks of size 2^( 6) =       0.001586029959
  error estimate for blocks of size 2^( 7) =       0.001590119833

      target function =                  N/A
              le_mean =     -22.329377682986
             les_mean =     502.353210473147
             stat err =       0.001578373267
             autocorr =       1.310125709086
              std dev =       1.950182157068
             le_variance =       3.803210445748


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232937768299e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+10, overlap shift 3.2312e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329377682179       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329377682179       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329377682179       residual = 3.71e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+10 is 9.982080e-15

solving harmonic davidson linear method for identity shift 1.2925e+11, overlap shift 1.2925e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329377682179       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329377682179       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329377682179       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+11 is 2.501107e-15

solving harmonic davidson linear method for identity shift 5.1699e+11, overlap shift 5.1699e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329377682179       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329377682179       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329377682179       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+11 is 6.252767e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144384 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9617e+01
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.5777
    reference variance = 2.14758
====================================================
  Execution time = 2.3096e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7832e+00
  Total weights = 1.9499e+06
  Execution time = 4.3510e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837322415946
                                         uncertainty =       0.083115363491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837322415946
                                         uncertainty =       0.083115363491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385061767
  error estimate for blocks of size 2^( 2) =       0.001456165853
  error estimate for blocks of size 2^( 3) =       0.001518178836
  error estimate for blocks of size 2^( 4) =       0.001562381898
  error estimate for blocks of size 2^( 5) =       0.001587086248
  error estimate for blocks of size 2^( 6) =       0.001600055272
  error estimate for blocks of size 2^( 7) =       0.001606252479

      target function =                  N/A
              le_mean =     -22.328790792237
             les_mean =     502.358136666077
             stat err =       0.001588943974
             autocorr =       1.316069686629
              std dev =       1.958804475698
             le_variance =       3.836914974013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837322415946
                                         uncertainty =       0.083115363491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837322415946
                                         uncertainty =       0.083115363491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385061767
  error estimate for blocks of size 2^( 2) =       0.001456165853
  error estimate for blocks of size 2^( 3) =       0.001518178836
  error estimate for blocks of size 2^( 4) =       0.001562381898
  error estimate for blocks of size 2^( 5) =       0.001587086248
  error estimate for blocks of size 2^( 6) =       0.001600055272
  error estimate for blocks of size 2^( 7) =       0.001606252479

      target function =                  N/A
              le_mean =     -22.328790792237
             les_mean =     502.358136666077
             stat err =       0.001588943974
             autocorr =       1.316069686629
              std dev =       1.958804475698
             le_variance =       3.836914974013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837322415946
                                         uncertainty =       0.083115363491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837322415946
                                         uncertainty =       0.083115363491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385061767
  error estimate for blocks of size 2^( 2) =       0.001456165853
  error estimate for blocks of size 2^( 3) =       0.001518178836
  error estimate for blocks of size 2^( 4) =       0.001562381898
  error estimate for blocks of size 2^( 5) =       0.001587086248
  error estimate for blocks of size 2^( 6) =       0.001600055272
  error estimate for blocks of size 2^( 7) =       0.001606252479

      target function =                  N/A
              le_mean =     -22.328790792237
             les_mean =     502.358136666077
             stat err =       0.001588943974
             autocorr =       1.316069686629
              std dev =       1.958804475698
             le_variance =       3.836914974013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837322415946
                                         uncertainty =       0.083115363491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837322415946
                                         uncertainty =       0.083115363491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385061767
  error estimate for blocks of size 2^( 2) =       0.001456165853
  error estimate for blocks of size 2^( 3) =       0.001518178836
  error estimate for blocks of size 2^( 4) =       0.001562381898
  error estimate for blocks of size 2^( 5) =       0.001587086248
  error estimate for blocks of size 2^( 6) =       0.001600055272
  error estimate for blocks of size 2^( 7) =       0.001606252479

      target function =                  N/A
              le_mean =     -22.328790792237
             les_mean =     502.358136666077
             stat err =       0.001588943974
             autocorr =       1.316069686629
              std dev =       1.958804475698
             le_variance =       3.836914974013


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328790792237        initial  <--
     3.2312e+10     3.2312e+11             9.9821e-15       -22.328790792237
     1.2925e+11     1.2925e+12             2.5011e-15       -22.328790792237
     5.1699e+11     5.1699e+12             6.2528e-16       -22.328790792237

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9228
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4547e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2311e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.4026
    reference variance = 3.0847
====================================================
  Execution time = 2.3743e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0302e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6785e+00
  Total weights = 1.950146871e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9212e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.729189587752
                                         uncertainty =       0.029314305088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.729189587752
                                         uncertainty =       0.029314305088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365441645
  error estimate for blocks of size 2^( 2) =       0.001436695577
  error estimate for blocks of size 2^( 3) =       0.001500048529
  error estimate for blocks of size 2^( 4) =       0.001541286073
  error estimate for blocks of size 2^( 5) =       0.001566673042
  error estimate for blocks of size 2^( 6) =       0.001575399104
  error estimate for blocks of size 2^( 7) =       0.001580174067

      target function =                  N/A
              le_mean =     -22.328460833991
             les_mean =     502.238632755856
             stat err =       0.001565883071
             autocorr =       1.315141157457
              std dev =       1.931056989086
             le_variance =       3.728981095096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232846083399e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+11, overlap shift 3.2312e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328460833150       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328460833150       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328460833150       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+11 is 1.355632e-15

solving harmonic davidson linear method for identity shift 1.2925e+12, overlap shift 1.2925e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328460833150       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328460833150       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328460833150       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+12 is 3.389080e-16

solving harmonic davidson linear method for identity shift 5.1699e+12, overlap shift 5.1699e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328460833150       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328460833150       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328460833150       residual = 1.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+12 is 8.456766e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145551 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9671e+01
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.3177
    reference variance = 2.7233
====================================================
  Execution time = 2.3107e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6694e+00
  Total weights = 1.9498e+06
  Execution time = 4.3541e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718544849826
                                         uncertainty =       0.024464547872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718544849826
                                         uncertainty =       0.024464547872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363464483
  error estimate for blocks of size 2^( 2) =       0.001434298121
  error estimate for blocks of size 2^( 3) =       0.001498533888
  error estimate for blocks of size 2^( 4) =       0.001543455038
  error estimate for blocks of size 2^( 5) =       0.001570477849
  error estimate for blocks of size 2^( 6) =       0.001585541381
  error estimate for blocks of size 2^( 7) =       0.001593778990

      target function =                  N/A
              le_mean =     -22.328508484714
             les_mean =     502.231667673308
             stat err =       0.001573313314
             autocorr =       1.331504924100
              std dev =       1.928260815463
             le_variance =       3.718189772450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718544849826
                                         uncertainty =       0.024464547872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718544849826
                                         uncertainty =       0.024464547872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363464483
  error estimate for blocks of size 2^( 2) =       0.001434298121
  error estimate for blocks of size 2^( 3) =       0.001498533888
  error estimate for blocks of size 2^( 4) =       0.001543455038
  error estimate for blocks of size 2^( 5) =       0.001570477849
  error estimate for blocks of size 2^( 6) =       0.001585541381
  error estimate for blocks of size 2^( 7) =       0.001593778990

      target function =                  N/A
              le_mean =     -22.328508484714
             les_mean =     502.231667673308
             stat err =       0.001573313314
             autocorr =       1.331504924100
              std dev =       1.928260815463
             le_variance =       3.718189772450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718544849826
                                         uncertainty =       0.024464547872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718544849826
                                         uncertainty =       0.024464547872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363464483
  error estimate for blocks of size 2^( 2) =       0.001434298121
  error estimate for blocks of size 2^( 3) =       0.001498533888
  error estimate for blocks of size 2^( 4) =       0.001543455038
  error estimate for blocks of size 2^( 5) =       0.001570477849
  error estimate for blocks of size 2^( 6) =       0.001585541381
  error estimate for blocks of size 2^( 7) =       0.001593778990

      target function =                  N/A
              le_mean =     -22.328508484714
             les_mean =     502.231667673308
             stat err =       0.001573313314
             autocorr =       1.331504924100
              std dev =       1.928260815463
             le_variance =       3.718189772450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718544849826
                                         uncertainty =       0.024464547872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718544849826
                                         uncertainty =       0.024464547872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363464483
  error estimate for blocks of size 2^( 2) =       0.001434298121
  error estimate for blocks of size 2^( 3) =       0.001498533888
  error estimate for blocks of size 2^( 4) =       0.001543455038
  error estimate for blocks of size 2^( 5) =       0.001570477849
  error estimate for blocks of size 2^( 6) =       0.001585541381
  error estimate for blocks of size 2^( 7) =       0.001593778990

      target function =                  N/A
              le_mean =     -22.328508484714
             les_mean =     502.231667673308
             stat err =       0.001573313314
             autocorr =       1.331504924100
              std dev =       1.928260815463
             le_variance =       3.718189772450


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328508484714        initial  <--
     3.2312e+11     3.2312e+12             1.3556e-15       -22.328508484714
     1.2925e+12     1.2925e+13             3.3891e-16       -22.328508484714
     5.1699e+12     5.1699e+13             8.4568e-17       -22.328508484714

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9409
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4619e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2312e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.6515
    reference variance = 2.13473
====================================================
  Execution time = 2.3807e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0328e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6897e+00
  Total weights = 1.949996314e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8938e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.740103306579
                                         uncertainty =       0.030466584292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.740103306579
                                         uncertainty =       0.030466584292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367399924
  error estimate for blocks of size 2^( 2) =       0.001438719307
  error estimate for blocks of size 2^( 3) =       0.001501620741
  error estimate for blocks of size 2^( 4) =       0.001545136994
  error estimate for blocks of size 2^( 5) =       0.001577435191
  error estimate for blocks of size 2^( 6) =       0.001588341305
  error estimate for blocks of size 2^( 7) =       0.001594811094

      target function =                  N/A
              le_mean =     -22.330493002732
             les_mean =     502.340570087880
             stat err =       0.001576431146
             autocorr =       1.329103834551
              std dev =       1.933826457670
             le_variance =       3.739684768383


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233049300273e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+12, overlap shift 3.2312e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330493001876       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330493001876       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330493001876       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330479777323       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.330368503910       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.326980617946       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.330358892640       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.061523980483       residual = 5.02e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -20.851722378475       residual = 3.71e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -21.286130913454       residual = 6.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -23.323536488017       residual = 2.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.677863176910       residual = 5.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -14.042381421311       residual = 1.05e+03           smallest_sin_value = 9.99e-01
davidson iteration   13 stopping due to too large eigenvalue change
davidson solver did not converge after         13 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+12 is 1.497328e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.2925e+13, overlap shift 1.2925e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330493001876       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330493001876       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330493001876       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330493001876       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329474721823       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.355479092982       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.333216158513       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -23.928060915086       residual = 7.53e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -24.873911611072       residual = 4.47e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -19.922440786517       residual = 1.06e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -21.969941058147       residual = 2.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -30.998242142164       residual = 1.02e+04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -21.813324579937       residual = 5.87e+03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -20.414834371774       residual = 5.89e+03           smallest_sin_value = 9.96e-01
davidson iteration   14 stopping due to small subspace S singular value of 8.88e-01
davidson solver did not converge after         14 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+13 is 3.743319e-17

solving harmonic davidson linear method for identity shift 5.1699e+13, overlap shift 5.1699e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330493001876       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330493001876       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330493001876       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330493001868       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.330492877636       residual = 9.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.351264807418       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.334228044047       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.606515973729       residual = 1.68e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -30.493918959318       residual = 1.41e+05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -23.463996032983       residual = 3.37e+04           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+13 is 9.358298e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9727e+01
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.088
    reference variance = 13.015
====================================================
  Execution time = 2.3130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6477e+00
  Total weights = 1.9493e+06
  Execution time = 4.7259e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.700213778490
                                         uncertainty =       0.025074022999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.700213778490
                                         uncertainty =       0.025074022999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001360147879
  error estimate for blocks of size 2^( 2) =       0.001432084335
  error estimate for blocks of size 2^( 3) =       0.001496088205
  error estimate for blocks of size 2^( 4) =       0.001540704163
  error estimate for blocks of size 2^( 5) =       0.001565576215
  error estimate for blocks of size 2^( 6) =       0.001577237461
  error estimate for blocks of size 2^( 7) =       0.001579644123

      target function =                  N/A
              le_mean =     -22.330033508099
             les_mean =     502.278126517845
             stat err =       0.001565790491
             autocorr =       1.325241554371
              std dev =       1.923570353572
             le_variance =       3.700122905143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.700213778490
                                         uncertainty =       0.025074022999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.700213778490
                                         uncertainty =       0.025074022999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001360147879
  error estimate for blocks of size 2^( 2) =       0.001432084335
  error estimate for blocks of size 2^( 3) =       0.001496088205
  error estimate for blocks of size 2^( 4) =       0.001540704163
  error estimate for blocks of size 2^( 5) =       0.001565576215
  error estimate for blocks of size 2^( 6) =       0.001577237461
  error estimate for blocks of size 2^( 7) =       0.001579644123

      target function =                  N/A
              le_mean =     -22.330033508099
             les_mean =     502.278126517845
             stat err =       0.001565790491
             autocorr =       1.325241554371
              std dev =       1.923570353572
             le_variance =       3.700122905143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.700213778490
                                         uncertainty =       0.025074022999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.700213778490
                                         uncertainty =       0.025074022999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001360147879
  error estimate for blocks of size 2^( 2) =       0.001432084335
  error estimate for blocks of size 2^( 3) =       0.001496088205
  error estimate for blocks of size 2^( 4) =       0.001540704163
  error estimate for blocks of size 2^( 5) =       0.001565576215
  error estimate for blocks of size 2^( 6) =       0.001577237461
  error estimate for blocks of size 2^( 7) =       0.001579644123

      target function =                  N/A
              le_mean =     -22.330033508099
             les_mean =     502.278126517845
             stat err =       0.001565790491
             autocorr =       1.325241554372
              std dev =       1.923570353572
             le_variance =       3.700122905142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.700213778490
                                         uncertainty =       0.025074022999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.700213778490
                                         uncertainty =       0.025074022999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001360147879
  error estimate for blocks of size 2^( 2) =       0.001432084335
  error estimate for blocks of size 2^( 3) =       0.001496088205
  error estimate for blocks of size 2^( 4) =       0.001540704163
  error estimate for blocks of size 2^( 5) =       0.001565576215
  error estimate for blocks of size 2^( 6) =       0.001577237461
  error estimate for blocks of size 2^( 7) =       0.001579644123

      target function =                  N/A
              le_mean =     -22.330033508099
             les_mean =     502.278126517845
             stat err =       0.001565790491
             autocorr =       1.325241554372
              std dev =       1.923570353572
             le_variance =       3.700122905143


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330033508099        initial  <--
     3.2312e+12     3.2312e+13             1.4973e-16       -22.330033508099
     1.2925e+13     1.2925e+14             3.7433e-17       -22.330033508099
     5.1699e+13     5.1699e+14             9.3583e-18       -22.330033508099

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6472
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5383e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2312e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.4163
    reference variance = 2.6169
====================================================
  Execution time = 2.3845e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0341e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7421e+00
  Total weights = 1.950007222e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8674e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795383536986
                                         uncertainty =       0.049811757160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795383536986
                                         uncertainty =       0.049811757160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377370331
  error estimate for blocks of size 2^( 2) =       0.001448072925
  error estimate for blocks of size 2^( 3) =       0.001509904950
  error estimate for blocks of size 2^( 4) =       0.001553070743
  error estimate for blocks of size 2^( 5) =       0.001578312537
  error estimate for blocks of size 2^( 6) =       0.001592623121
  error estimate for blocks of size 2^( 7) =       0.001601504351

      target function =                  N/A
              le_mean =     -22.329873278726
             les_mean =     502.365329468669
             stat err =       0.001581377688
             autocorr =       1.318164969900
              std dev =       1.947926968339
             le_variance =       3.794419473981


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232987327873e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+13, overlap shift 3.2312e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329873277886       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329873277886       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.74e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.2925e+14, overlap shift 1.2925e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329873277886       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329873277886       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.74e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.1699e+14, overlap shift 5.1699e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329873277886       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329873277886       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.73e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9719e+01
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.2375
    reference variance = 4.62468
====================================================
  Execution time = 2.3086e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7268e+00
  Total weights = 1.9499e+06
  Execution time = 4.3393e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780265508623
                                         uncertainty =       0.041546383176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780265508623
                                         uncertainty =       0.041546383176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374728584
  error estimate for blocks of size 2^( 2) =       0.001446355158
  error estimate for blocks of size 2^( 3) =       0.001509441891
  error estimate for blocks of size 2^( 4) =       0.001555673033
  error estimate for blocks of size 2^( 5) =       0.001583725361
  error estimate for blocks of size 2^( 6) =       0.001596064335
  error estimate for blocks of size 2^( 7) =       0.001609220455

      target function =                  N/A
              le_mean =     -22.328210551097
             les_mean =     502.275829898061
             stat err =       0.001586170796
             autocorr =       1.331269472702
              std dev =       1.944190914368
             le_variance =       3.779878311512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780265508623
                                         uncertainty =       0.041546383176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780265508623
                                         uncertainty =       0.041546383176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374728584
  error estimate for blocks of size 2^( 2) =       0.001446355158
  error estimate for blocks of size 2^( 3) =       0.001509441891
  error estimate for blocks of size 2^( 4) =       0.001555673033
  error estimate for blocks of size 2^( 5) =       0.001583725361
  error estimate for blocks of size 2^( 6) =       0.001596064335
  error estimate for blocks of size 2^( 7) =       0.001609220455

      target function =                  N/A
              le_mean =     -22.328210551097
             les_mean =     502.275829898061
             stat err =       0.001586170796
             autocorr =       1.331269472702
              std dev =       1.944190914368
             le_variance =       3.779878311512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780265508623
                                         uncertainty =       0.041546383176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780265508623
                                         uncertainty =       0.041546383176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374728584
  error estimate for blocks of size 2^( 2) =       0.001446355158
  error estimate for blocks of size 2^( 3) =       0.001509441891
  error estimate for blocks of size 2^( 4) =       0.001555673033
  error estimate for blocks of size 2^( 5) =       0.001583725361
  error estimate for blocks of size 2^( 6) =       0.001596064335
  error estimate for blocks of size 2^( 7) =       0.001609220455

      target function =                  N/A
              le_mean =     -22.328210551097
             les_mean =     502.275829898061
             stat err =       0.001586170796
             autocorr =       1.331269472702
              std dev =       1.944190914368
             le_variance =       3.779878311512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780265508623
                                         uncertainty =       0.041546383176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780265508623
                                         uncertainty =       0.041546383176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374728584
  error estimate for blocks of size 2^( 2) =       0.001446355158
  error estimate for blocks of size 2^( 3) =       0.001509441891
  error estimate for blocks of size 2^( 4) =       0.001555673033
  error estimate for blocks of size 2^( 5) =       0.001583725361
  error estimate for blocks of size 2^( 6) =       0.001596064335
  error estimate for blocks of size 2^( 7) =       0.001609220455

      target function =                  N/A
              le_mean =     -22.328210551097
             les_mean =     502.275829898061
             stat err =       0.001586170796
             autocorr =       1.331269472702
              std dev =       1.944190914368
             le_variance =       3.779878311512


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328210551097        initial  <--
     3.2312e+13     3.2312e+14             0.0000e+00       -22.328210551097
     1.2925e+14     1.2925e+15             0.0000e+00       -22.328210551097
     5.1699e+14     5.1699e+15             0.0000e+00       -22.328210551097

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8602
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4609e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2312e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.3825
    reference variance = 2.20264
====================================================
  Execution time = 2.3783e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0340e+04
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.8177e+00
  Total weights = 1.949958241e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8814e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.872279800123
                                         uncertainty =       0.091951728751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.872279800123
                                         uncertainty =       0.091951728751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001391389553
  error estimate for blocks of size 2^( 2) =       0.001461550385
  error estimate for blocks of size 2^( 3) =       0.001522916930
  error estimate for blocks of size 2^( 4) =       0.001566920954
  error estimate for blocks of size 2^( 5) =       0.001590171325
  error estimate for blocks of size 2^( 6) =       0.001605957169
  error estimate for blocks of size 2^( 7) =       0.001621423421

      target function =                  N/A
              le_mean =     -22.325206302753
             les_mean =     502.232561027364
             stat err =       0.001596118217
             autocorr =       1.315929529644
              std dev =       1.967753459290
             le_variance =       3.872053676547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232520630275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+14, overlap shift 3.2312e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325206301973       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325206301973       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325206301973       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.37e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+14 is 1.166353e-18

solving harmonic davidson linear method for identity shift 1.2925e+15, overlap shift 1.2925e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325206301973       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325206301973       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325206301973       residual = 1.46e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325206301870       residual = 5.28e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.188927794209       residual = 5.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+15 is 2.915882e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.1699e+15, overlap shift 5.1699e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325206301973       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325206301973       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325206301973       residual = 9.44e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+15 is 7.337557e-20

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168604 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9672e+01
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.2885
    reference variance = 2.9853
====================================================
  Execution time = 2.3116e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7290e+00
  Total weights = 1.9501e+06
  Execution time = 4.3294e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780816452739
                                         uncertainty =       0.070990991318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780816452739
                                         uncertainty =       0.070990991318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374763181
  error estimate for blocks of size 2^( 2) =       0.001446266285
  error estimate for blocks of size 2^( 3) =       0.001508878297
  error estimate for blocks of size 2^( 4) =       0.001554078433
  error estimate for blocks of size 2^( 5) =       0.001581464513
  error estimate for blocks of size 2^( 6) =       0.001595969645
  error estimate for blocks of size 2^( 7) =       0.001596271144

      target function =                  N/A
              le_mean =     -22.328946003377
             les_mean =     502.310845170499
             stat err =       0.001581945934
             autocorr =       1.324120434767
              std dev =       1.944239843406
             le_variance =       3.780068568687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780816452739
                                         uncertainty =       0.070990991318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780816452739
                                         uncertainty =       0.070990991318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374763181
  error estimate for blocks of size 2^( 2) =       0.001446266285
  error estimate for blocks of size 2^( 3) =       0.001508878297
  error estimate for blocks of size 2^( 4) =       0.001554078433
  error estimate for blocks of size 2^( 5) =       0.001581464513
  error estimate for blocks of size 2^( 6) =       0.001595969645
  error estimate for blocks of size 2^( 7) =       0.001596271144

      target function =                  N/A
              le_mean =     -22.328946003377
             les_mean =     502.310845170499
             stat err =       0.001581945934
             autocorr =       1.324120434767
              std dev =       1.944239843406
             le_variance =       3.780068568687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780816452739
                                         uncertainty =       0.070990991318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780816452739
                                         uncertainty =       0.070990991318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374763181
  error estimate for blocks of size 2^( 2) =       0.001446266285
  error estimate for blocks of size 2^( 3) =       0.001508878297
  error estimate for blocks of size 2^( 4) =       0.001554078433
  error estimate for blocks of size 2^( 5) =       0.001581464513
  error estimate for blocks of size 2^( 6) =       0.001595969645
  error estimate for blocks of size 2^( 7) =       0.001596271144

      target function =                  N/A
              le_mean =     -22.328946003377
             les_mean =     502.310845170499
             stat err =       0.001581945934
             autocorr =       1.324120434767
              std dev =       1.944239843406
             le_variance =       3.780068568687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780816452739
                                         uncertainty =       0.070990991318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780816452739
                                         uncertainty =       0.070990991318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374763181
  error estimate for blocks of size 2^( 2) =       0.001446266285
  error estimate for blocks of size 2^( 3) =       0.001508878297
  error estimate for blocks of size 2^( 4) =       0.001554078433
  error estimate for blocks of size 2^( 5) =       0.001581464513
  error estimate for blocks of size 2^( 6) =       0.001595969645
  error estimate for blocks of size 2^( 7) =       0.001596271144

      target function =                  N/A
              le_mean =     -22.328946003377
             les_mean =     502.310845170499
             stat err =       0.001581945934
             autocorr =       1.324120434767
              std dev =       1.944239843406
             le_variance =       3.780068568687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328946003377        initial  <--
     3.2312e+14     3.2312e+15             1.1664e-18       -22.328946003377
     1.2925e+15     1.2925e+16             2.9159e-19       -22.328946003377
     5.1699e+15     5.1699e+16             7.3376e-20       -22.328946003377

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8551
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4534e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2313e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.0293
    reference variance = 4.22679
====================================================
  Execution time = 2.3773e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0302e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7515e+00
  Total weights = 1.950167084e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8229e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.803146366954
                                         uncertainty =       0.043717035857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.803146366954
                                         uncertainty =       0.043717035857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379007162
  error estimate for blocks of size 2^( 2) =       0.001448525984
  error estimate for blocks of size 2^( 3) =       0.001511617236
  error estimate for blocks of size 2^( 4) =       0.001556502979
  error estimate for blocks of size 2^( 5) =       0.001584922151
  error estimate for blocks of size 2^( 6) =       0.001598070006
  error estimate for blocks of size 2^( 7) =       0.001606001481

      target function =                  N/A
              le_mean =     -22.328771204600
             les_mean =     502.325533295584
             stat err =       0.001586374154
             autocorr =       1.323360622909
              std dev =       1.950241833752
             le_variance =       3.803443210116


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232877120460e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+15, overlap shift 3.2312e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328771203790       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328771203790       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.99e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.2925e+16, overlap shift 1.2925e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328771203790       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328771203790       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.99e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.1699e+16, overlap shift 5.1699e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328771203790       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328771203790       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.29e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169732 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9602e+01
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.4929
    reference variance = 2.74054
====================================================
  Execution time = 2.3096e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7641e+00
  Total weights = 1.9501e+06
  Execution time = 4.3369e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814569596155
                                         uncertainty =       0.042122818166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814569596155
                                         uncertainty =       0.042122818166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381321608
  error estimate for blocks of size 2^( 2) =       0.001452398437
  error estimate for blocks of size 2^( 3) =       0.001515527815
  error estimate for blocks of size 2^( 4) =       0.001559566050
  error estimate for blocks of size 2^( 5) =       0.001581838126
  error estimate for blocks of size 2^( 6) =       0.001597268125
  error estimate for blocks of size 2^( 7) =       0.001606575983

      target function =                  N/A
              le_mean =     -22.328275828404
             les_mean =     502.315965373304
             stat err =       0.001586312071
             autocorr =       1.318826443777
              std dev =       1.953515008116
             le_variance =       3.816220886933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814569596155
                                         uncertainty =       0.042122818166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814569596155
                                         uncertainty =       0.042122818166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381321608
  error estimate for blocks of size 2^( 2) =       0.001452398437
  error estimate for blocks of size 2^( 3) =       0.001515527815
  error estimate for blocks of size 2^( 4) =       0.001559566050
  error estimate for blocks of size 2^( 5) =       0.001581838126
  error estimate for blocks of size 2^( 6) =       0.001597268125
  error estimate for blocks of size 2^( 7) =       0.001606575983

      target function =                  N/A
              le_mean =     -22.328275828404
             les_mean =     502.315965373304
             stat err =       0.001586312071
             autocorr =       1.318826443777
              std dev =       1.953515008116
             le_variance =       3.816220886933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814569596155
                                         uncertainty =       0.042122818166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814569596155
                                         uncertainty =       0.042122818166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381321608
  error estimate for blocks of size 2^( 2) =       0.001452398437
  error estimate for blocks of size 2^( 3) =       0.001515527815
  error estimate for blocks of size 2^( 4) =       0.001559566050
  error estimate for blocks of size 2^( 5) =       0.001581838126
  error estimate for blocks of size 2^( 6) =       0.001597268125
  error estimate for blocks of size 2^( 7) =       0.001606575983

      target function =                  N/A
              le_mean =     -22.328275828404
             les_mean =     502.315965373304
             stat err =       0.001586312071
             autocorr =       1.318826443777
              std dev =       1.953515008116
             le_variance =       3.816220886933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814569596155
                                         uncertainty =       0.042122818166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814569596155
                                         uncertainty =       0.042122818166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381321608
  error estimate for blocks of size 2^( 2) =       0.001452398437
  error estimate for blocks of size 2^( 3) =       0.001515527815
  error estimate for blocks of size 2^( 4) =       0.001559566050
  error estimate for blocks of size 2^( 5) =       0.001581838126
  error estimate for blocks of size 2^( 6) =       0.001597268125
  error estimate for blocks of size 2^( 7) =       0.001606575983

      target function =                  N/A
              le_mean =     -22.328275828404
             les_mean =     502.315965373304
             stat err =       0.001586312071
             autocorr =       1.318826443777
              std dev =       1.953515008116
             le_variance =       3.816220886933


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328275828404        initial  <--
     3.2312e+15     3.2312e+16             0.0000e+00       -22.328275828404
     1.2925e+16     1.2925e+17             0.0000e+00       -22.328275828404
     5.1699e+16     5.1699e+17             0.0000e+00       -22.328275828404

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8686
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4478e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2312e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.462
    reference variance = 3.62808
====================================================
  Execution time = 2.3732e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0325e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8441e+00
  Total weights = 1.950061626e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8939e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.898969142123
                                         uncertainty =       0.105283820919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.898969142123
                                         uncertainty =       0.105283820919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001396138892
  error estimate for blocks of size 2^( 2) =       0.001465608320
  error estimate for blocks of size 2^( 3) =       0.001528406523
  error estimate for blocks of size 2^( 4) =       0.001574363672
  error estimate for blocks of size 2^( 5) =       0.001594705971
  error estimate for blocks of size 2^( 6) =       0.001606344780
  error estimate for blocks of size 2^( 7) =       0.001622210500

      target function =                  N/A
              le_mean =     -22.328008703011
             les_mean =     502.384068090449
             stat err =       0.001599406231
             autocorr =       1.312382155649
              std dev =       1.974470146154
             le_variance =       3.898532358053


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232800870301e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+16, overlap shift 3.2312e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328008702196       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328008702196       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.87e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.2925e+17, overlap shift 1.2925e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328008702196       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328008702196       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.87e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.1699e+17, overlap shift 5.1699e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328008702196       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328008702196       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.87e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+17 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170902 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9633e+01
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.4445
    reference variance = 5.12717
====================================================
  Execution time = 2.3164e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7332e+00
  Total weights = 1.9498e+06
  Execution time = 4.6843e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785508855925
                                         uncertainty =       0.037606695185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785508855925
                                         uncertainty =       0.037606695185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375752961
  error estimate for blocks of size 2^( 2) =       0.001447301652
  error estimate for blocks of size 2^( 3) =       0.001511413194
  error estimate for blocks of size 2^( 4) =       0.001554669511
  error estimate for blocks of size 2^( 5) =       0.001580542498
  error estimate for blocks of size 2^( 6) =       0.001588826430
  error estimate for blocks of size 2^( 7) =       0.001590845001

      target function =                  N/A
              le_mean =     -22.328916307348
             les_mean =     502.313698031255
             stat err =       0.001578720860
             autocorr =       1.316830212672
              std dev =       1.945639625778
             le_variance =       3.785513553398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785508855925
                                         uncertainty =       0.037606695185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785508855925
                                         uncertainty =       0.037606695185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375752961
  error estimate for blocks of size 2^( 2) =       0.001447301652
  error estimate for blocks of size 2^( 3) =       0.001511413194
  error estimate for blocks of size 2^( 4) =       0.001554669511
  error estimate for blocks of size 2^( 5) =       0.001580542498
  error estimate for blocks of size 2^( 6) =       0.001588826430
  error estimate for blocks of size 2^( 7) =       0.001590845001

      target function =                  N/A
              le_mean =     -22.328916307348
             les_mean =     502.313698031255
             stat err =       0.001578720860
             autocorr =       1.316830212672
              std dev =       1.945639625778
             le_variance =       3.785513553398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785508855925
                                         uncertainty =       0.037606695185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785508855925
                                         uncertainty =       0.037606695185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375752961
  error estimate for blocks of size 2^( 2) =       0.001447301652
  error estimate for blocks of size 2^( 3) =       0.001511413194
  error estimate for blocks of size 2^( 4) =       0.001554669511
  error estimate for blocks of size 2^( 5) =       0.001580542498
  error estimate for blocks of size 2^( 6) =       0.001588826430
  error estimate for blocks of size 2^( 7) =       0.001590845001

      target function =                  N/A
              le_mean =     -22.328916307348
             les_mean =     502.313698031255
             stat err =       0.001578720860
             autocorr =       1.316830212672
              std dev =       1.945639625778
             le_variance =       3.785513553398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785508855925
                                         uncertainty =       0.037606695185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785508855925
                                         uncertainty =       0.037606695185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375752961
  error estimate for blocks of size 2^( 2) =       0.001447301652
  error estimate for blocks of size 2^( 3) =       0.001511413194
  error estimate for blocks of size 2^( 4) =       0.001554669511
  error estimate for blocks of size 2^( 5) =       0.001580542498
  error estimate for blocks of size 2^( 6) =       0.001588826430
  error estimate for blocks of size 2^( 7) =       0.001590845001

      target function =                  N/A
              le_mean =     -22.328916307348
             les_mean =     502.313698031255
             stat err =       0.001578720860
             autocorr =       1.316830212672
              std dev =       1.945639625778
             le_variance =       3.785513553398


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328916307348        initial  <--
     3.2312e+16     3.2312e+17             0.0000e+00       -22.328916307348
     1.2925e+17     1.2925e+18             0.0000e+00       -22.328916307348
     5.1699e+17     5.1699e+18             0.0000e+00       -22.328916307348

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.7319
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5372e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2314e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.3071
    reference variance = 2.77302
====================================================
  Execution time = 2.3834e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0285e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7871e+00
  Total weights = 1.950041846e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9136e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.840274931593
                                         uncertainty =       0.089439011827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.840274931593
                                         uncertainty =       0.089439011827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385594178
  error estimate for blocks of size 2^( 2) =       0.001456484413
  error estimate for blocks of size 2^( 3) =       0.001518749100
  error estimate for blocks of size 2^( 4) =       0.001562273438
  error estimate for blocks of size 2^( 5) =       0.001587646494
  error estimate for blocks of size 2^( 6) =       0.001596523736
  error estimate for blocks of size 2^( 7) =       0.001599587309

      target function =                  N/A
              le_mean =     -22.328298412578
             les_mean =     502.339997839937
             stat err =       0.001586507744
             autocorr =       1.311028983903
              std dev =       1.959557430625
             le_variance =       3.839865323919


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232829841258e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+17, overlap shift 3.2312e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328298411751       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328298411751       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328298411751       residual = 1.84e+04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+17 is 1.294879e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.2925e+18, overlap shift 1.2925e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328298411751       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328298411751       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328298411751       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+18 is 3.237198e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.1699e+18, overlap shift 5.1699e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328298411751       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328298411751       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328298411751       residual = 7.37e+04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328298411750       residual = 1.39e+04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+18 is 8.092995e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172529 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9755e+01
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.2064
    reference variance = 4.48724
====================================================
  Execution time = 2.3126e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7242e+00
  Total weights = 1.9496e+06
  Execution time = 4.3515e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777305197943
                                         uncertainty =       0.031787869352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777305197943
                                         uncertainty =       0.031787869352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374216459
  error estimate for blocks of size 2^( 2) =       0.001445107838
  error estimate for blocks of size 2^( 3) =       0.001509701130
  error estimate for blocks of size 2^( 4) =       0.001551976857
  error estimate for blocks of size 2^( 5) =       0.001577113239
  error estimate for blocks of size 2^( 6) =       0.001590706317
  error estimate for blocks of size 2^( 7) =       0.001598958891

      target function =                  N/A
              le_mean =     -22.326413069938
             les_mean =     502.192968115777
             stat err =       0.001579688826
             autocorr =       1.321395431751
              std dev =       1.943466648065
             le_variance =       3.777062612139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777305197943
                                         uncertainty =       0.031787869352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777305197943
                                         uncertainty =       0.031787869352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374216459
  error estimate for blocks of size 2^( 2) =       0.001445107838
  error estimate for blocks of size 2^( 3) =       0.001509701130
  error estimate for blocks of size 2^( 4) =       0.001551976857
  error estimate for blocks of size 2^( 5) =       0.001577113239
  error estimate for blocks of size 2^( 6) =       0.001590706317
  error estimate for blocks of size 2^( 7) =       0.001598958891

      target function =                  N/A
              le_mean =     -22.326413069938
             les_mean =     502.192968115777
             stat err =       0.001579688826
             autocorr =       1.321395431751
              std dev =       1.943466648065
             le_variance =       3.777062612139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777305197943
                                         uncertainty =       0.031787869352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777305197943
                                         uncertainty =       0.031787869352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374216459
  error estimate for blocks of size 2^( 2) =       0.001445107838
  error estimate for blocks of size 2^( 3) =       0.001509701130
  error estimate for blocks of size 2^( 4) =       0.001551976857
  error estimate for blocks of size 2^( 5) =       0.001577113239
  error estimate for blocks of size 2^( 6) =       0.001590706317
  error estimate for blocks of size 2^( 7) =       0.001598958891

      target function =                  N/A
              le_mean =     -22.326413069938
             les_mean =     502.192968115777
             stat err =       0.001579688826
             autocorr =       1.321395431751
              std dev =       1.943466648065
             le_variance =       3.777062612139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777305197943
                                         uncertainty =       0.031787869352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777305197943
                                         uncertainty =       0.031787869352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374216459
  error estimate for blocks of size 2^( 2) =       0.001445107838
  error estimate for blocks of size 2^( 3) =       0.001509701130
  error estimate for blocks of size 2^( 4) =       0.001551976857
  error estimate for blocks of size 2^( 5) =       0.001577113239
  error estimate for blocks of size 2^( 6) =       0.001590706317
  error estimate for blocks of size 2^( 7) =       0.001598958891

      target function =                  N/A
              le_mean =     -22.326413069938
             les_mean =     502.192968115777
             stat err =       0.001579688826
             autocorr =       1.321395431751
              std dev =       1.943466648065
             le_variance =       3.777062612139


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326413069938        initial  <--
     3.2312e+17     3.2312e+18             1.2949e-21       -22.326413069938
     1.2925e+18     1.2925e+19             3.2372e-22       -22.326413069938
     5.1699e+18     5.1699e+19             8.0930e-23       -22.326413069938

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9602
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4722e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2313e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.344
    reference variance = 4.92576
====================================================
  Execution time = 2.3806e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0336e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7375e+00
  Total weights = 1.950183040e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9123e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790020249092
                                         uncertainty =       0.037327143829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790020249092
                                         uncertainty =       0.037327143829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376560127
  error estimate for blocks of size 2^( 2) =       0.001447984356
  error estimate for blocks of size 2^( 3) =       0.001509297575
  error estimate for blocks of size 2^( 4) =       0.001550487125
  error estimate for blocks of size 2^( 5) =       0.001579368505
  error estimate for blocks of size 2^( 6) =       0.001593393769
  error estimate for blocks of size 2^( 7) =       0.001599652338

      target function =                  N/A
              le_mean =     -22.329110801453
             les_mean =     502.326664020022
             stat err =       0.001580725434
             autocorr =       1.318628659964
              std dev =       1.946781149062
             le_variance =       3.789956842341


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232911080145e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+18, overlap shift 3.2312e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329110800633       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329110800633       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.2925e+19, overlap shift 1.2925e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329110800633       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329110800633       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.1699e+19, overlap shift 5.1699e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329110800633       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329110800633       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173741 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9725e+01
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.3624
    reference variance = 3.36232
====================================================
  Execution time = 2.3141e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6922e+00
  Total weights = 1.9497e+06
  Execution time = 4.3536e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.740175117210
                                         uncertainty =       0.034943359887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.740175117210
                                         uncertainty =       0.034943359887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367581534
  error estimate for blocks of size 2^( 2) =       0.001439241670
  error estimate for blocks of size 2^( 3) =       0.001502448867
  error estimate for blocks of size 2^( 4) =       0.001545221529
  error estimate for blocks of size 2^( 5) =       0.001568440686
  error estimate for blocks of size 2^( 6) =       0.001582527640
  error estimate for blocks of size 2^( 7) =       0.001590519906

      target function =                  N/A
              le_mean =     -22.327686590894
             les_mean =     502.217746119978
             stat err =       0.001571677440
             autocorr =       1.320749280856
              std dev =       1.934083297411
             le_variance =       3.740678201324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.740175117210
                                         uncertainty =       0.034943359887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.740175117210
                                         uncertainty =       0.034943359887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367581534
  error estimate for blocks of size 2^( 2) =       0.001439241670
  error estimate for blocks of size 2^( 3) =       0.001502448867
  error estimate for blocks of size 2^( 4) =       0.001545221529
  error estimate for blocks of size 2^( 5) =       0.001568440686
  error estimate for blocks of size 2^( 6) =       0.001582527640
  error estimate for blocks of size 2^( 7) =       0.001590519906

      target function =                  N/A
              le_mean =     -22.327686590894
             les_mean =     502.217746119978
             stat err =       0.001571677440
             autocorr =       1.320749280856
              std dev =       1.934083297411
             le_variance =       3.740678201324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.740175117210
                                         uncertainty =       0.034943359887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.740175117210
                                         uncertainty =       0.034943359887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367581534
  error estimate for blocks of size 2^( 2) =       0.001439241670
  error estimate for blocks of size 2^( 3) =       0.001502448867
  error estimate for blocks of size 2^( 4) =       0.001545221529
  error estimate for blocks of size 2^( 5) =       0.001568440686
  error estimate for blocks of size 2^( 6) =       0.001582527640
  error estimate for blocks of size 2^( 7) =       0.001590519906

      target function =                  N/A
              le_mean =     -22.327686590894
             les_mean =     502.217746119978
             stat err =       0.001571677440
             autocorr =       1.320749280856
              std dev =       1.934083297411
             le_variance =       3.740678201324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.740175117210
                                         uncertainty =       0.034943359887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.740175117210
                                         uncertainty =       0.034943359887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367581534
  error estimate for blocks of size 2^( 2) =       0.001439241670
  error estimate for blocks of size 2^( 3) =       0.001502448867
  error estimate for blocks of size 2^( 4) =       0.001545221529
  error estimate for blocks of size 2^( 5) =       0.001568440686
  error estimate for blocks of size 2^( 6) =       0.001582527640
  error estimate for blocks of size 2^( 7) =       0.001590519906

      target function =                  N/A
              le_mean =     -22.327686590894
             les_mean =     502.217746119978
             stat err =       0.001571677440
             autocorr =       1.320749280856
              std dev =       1.934083297411
             le_variance =       3.740678201324


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327686590894        initial  <--
     3.2312e+18     3.2312e+19             0.0000e+00       -22.327686590894
     1.2925e+19     1.2925e+20             0.0000e+00       -22.327686590894
     5.1699e+19     5.1699e+20             0.0000e+00       -22.327686590894

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9937
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4738e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2313e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -21.9184
    reference variance = 5.72888
====================================================
  Execution time = 2.3723e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0301e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7019e+00
  Total weights = 1.949999011e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9059e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751699331507
                                         uncertainty =       0.030192130611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751699331507
                                         uncertainty =       0.030192130611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369579982
  error estimate for blocks of size 2^( 2) =       0.001438454850
  error estimate for blocks of size 2^( 3) =       0.001502317005
  error estimate for blocks of size 2^( 4) =       0.001546323892
  error estimate for blocks of size 2^( 5) =       0.001570027053
  error estimate for blocks of size 2^( 6) =       0.001580625206
  error estimate for blocks of size 2^( 7) =       0.001589563699

      target function =                  N/A
              le_mean =     -22.327247104677
             les_mean =     502.207858354040
             stat err =       0.001571634962
             autocorr =       1.316826518027
              std dev =       1.936909575176
             le_variance =       3.751618702407


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232724710468e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+19, overlap shift 3.2312e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327247103855       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327247103855       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.2925e+20, overlap shift 1.2925e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327247103855       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327247103855       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.1699e+20, overlap shift 5.1699e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327247103855       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327247103855       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174953 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9635e+01
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.0964
    reference variance = 3.94447
====================================================
  Execution time = 2.3137e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7769e+00
  Total weights = 1.9499e+06
  Execution time = 4.3450e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830180287269
                                         uncertainty =       0.078520895059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830180287269
                                         uncertainty =       0.078520895059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383642882
  error estimate for blocks of size 2^( 2) =       0.001454738076
  error estimate for blocks of size 2^( 3) =       0.001516671632
  error estimate for blocks of size 2^( 4) =       0.001560031195
  error estimate for blocks of size 2^( 5) =       0.001582186262
  error estimate for blocks of size 2^( 6) =       0.001592844546
  error estimate for blocks of size 2^( 7) =       0.001604964369

      target function =                  N/A
              le_mean =     -22.328302778705
             les_mean =     502.330053637013
             stat err =       0.001585006593
             autocorr =       1.312242562319
              std dev =       1.956797836632
             le_variance =       3.829057773449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830180287269
                                         uncertainty =       0.078520895059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830180287269
                                         uncertainty =       0.078520895059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383642882
  error estimate for blocks of size 2^( 2) =       0.001454738076
  error estimate for blocks of size 2^( 3) =       0.001516671632
  error estimate for blocks of size 2^( 4) =       0.001560031195
  error estimate for blocks of size 2^( 5) =       0.001582186262
  error estimate for blocks of size 2^( 6) =       0.001592844546
  error estimate for blocks of size 2^( 7) =       0.001604964369

      target function =                  N/A
              le_mean =     -22.328302778705
             les_mean =     502.330053637013
             stat err =       0.001585006593
             autocorr =       1.312242562319
              std dev =       1.956797836632
             le_variance =       3.829057773449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830180287269
                                         uncertainty =       0.078520895059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830180287269
                                         uncertainty =       0.078520895059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383642882
  error estimate for blocks of size 2^( 2) =       0.001454738076
  error estimate for blocks of size 2^( 3) =       0.001516671632
  error estimate for blocks of size 2^( 4) =       0.001560031195
  error estimate for blocks of size 2^( 5) =       0.001582186262
  error estimate for blocks of size 2^( 6) =       0.001592844546
  error estimate for blocks of size 2^( 7) =       0.001604964369

      target function =                  N/A
              le_mean =     -22.328302778705
             les_mean =     502.330053637013
             stat err =       0.001585006593
             autocorr =       1.312242562319
              std dev =       1.956797836632
             le_variance =       3.829057773449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830180287269
                                         uncertainty =       0.078520895059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830180287269
                                         uncertainty =       0.078520895059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383642882
  error estimate for blocks of size 2^( 2) =       0.001454738076
  error estimate for blocks of size 2^( 3) =       0.001516671632
  error estimate for blocks of size 2^( 4) =       0.001560031195
  error estimate for blocks of size 2^( 5) =       0.001582186262
  error estimate for blocks of size 2^( 6) =       0.001592844546
  error estimate for blocks of size 2^( 7) =       0.001604964369

      target function =                  N/A
              le_mean =     -22.328302778705
             les_mean =     502.330053637013
             stat err =       0.001585006593
             autocorr =       1.312242562319
              std dev =       1.956797836632
             le_variance =       3.829057773449


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328302778705        initial  <--
     3.2312e+19     3.2312e+20             0.0000e+00       -22.328302778705
     1.2925e+20     1.2925e+21             0.0000e+00       -22.328302778705
     5.1699e+20     5.1699e+21             0.0000e+00       -22.328302778705

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9346
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4577e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2310e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -21.8656
    reference variance = 7.31898
====================================================
  Execution time = 2.5117e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0333e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8060e+00
  Total weights = 1.949923364e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9074e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.859102799698
                                         uncertainty =       0.069707407555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.859102799698
                                         uncertainty =       0.069707407555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389163604
  error estimate for blocks of size 2^( 2) =       0.001458691733
  error estimate for blocks of size 2^( 3) =       0.001521515444
  error estimate for blocks of size 2^( 4) =       0.001564635994
  error estimate for blocks of size 2^( 5) =       0.001585723595
  error estimate for blocks of size 2^( 6) =       0.001590489606
  error estimate for blocks of size 2^( 7) =       0.001607353771

      target function =                  N/A
              le_mean =     -22.328135138025
             les_mean =     502.351603262768
             stat err =       0.001587050742
             autocorr =       1.305193289276
              std dev =       1.964605441843
             le_variance =       3.859674542120


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232813513803e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+20, overlap shift 3.2312e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328135137251       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328135137251       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328135137251       residual = 2.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+20 is 1.453429e-24

solving harmonic davidson linear method for identity shift 1.2925e+21, overlap shift 1.2925e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328135137251       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328135137251       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328135137251       residual = 2.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+21 is 3.633573e-25

solving harmonic davidson linear method for identity shift 5.1699e+21, overlap shift 5.1699e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328135137251       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328135137251       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328135137251       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+21 is 9.050299e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176245 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1031e+01
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.6675
    reference variance = 1.62176
====================================================
  Execution time = 2.3170e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7230e+00
  Total weights = 1.9497e+06
  Execution time = 4.7097e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775116080602
                                         uncertainty =       0.032507832974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775116080602
                                         uncertainty =       0.032507832974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373863537
  error estimate for blocks of size 2^( 2) =       0.001443905037
  error estimate for blocks of size 2^( 3) =       0.001507098122
  error estimate for blocks of size 2^( 4) =       0.001551344393
  error estimate for blocks of size 2^( 5) =       0.001574163341
  error estimate for blocks of size 2^( 6) =       0.001589905225
  error estimate for blocks of size 2^( 7) =       0.001601633394

      target function =                  N/A
              le_mean =     -22.326340000843
             les_mean =     502.188417083679
             stat err =       0.001579261588
             autocorr =       1.321359373852
              std dev =       1.942967533491
             le_variance =       3.775122836200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775116080602
                                         uncertainty =       0.032507832974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775116080602
                                         uncertainty =       0.032507832974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373863537
  error estimate for blocks of size 2^( 2) =       0.001443905037
  error estimate for blocks of size 2^( 3) =       0.001507098122
  error estimate for blocks of size 2^( 4) =       0.001551344393
  error estimate for blocks of size 2^( 5) =       0.001574163341
  error estimate for blocks of size 2^( 6) =       0.001589905225
  error estimate for blocks of size 2^( 7) =       0.001601633394

      target function =                  N/A
              le_mean =     -22.326340000843
             les_mean =     502.188417083679
             stat err =       0.001579261588
             autocorr =       1.321359373852
              std dev =       1.942967533491
             le_variance =       3.775122836200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775116080602
                                         uncertainty =       0.032507832974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775116080602
                                         uncertainty =       0.032507832974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373863537
  error estimate for blocks of size 2^( 2) =       0.001443905037
  error estimate for blocks of size 2^( 3) =       0.001507098122
  error estimate for blocks of size 2^( 4) =       0.001551344393
  error estimate for blocks of size 2^( 5) =       0.001574163341
  error estimate for blocks of size 2^( 6) =       0.001589905225
  error estimate for blocks of size 2^( 7) =       0.001601633394

      target function =                  N/A
              le_mean =     -22.326340000843
             les_mean =     502.188417083679
             stat err =       0.001579261588
             autocorr =       1.321359373852
              std dev =       1.942967533491
             le_variance =       3.775122836200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775116080602
                                         uncertainty =       0.032507832974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775116080602
                                         uncertainty =       0.032507832974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373863537
  error estimate for blocks of size 2^( 2) =       0.001443905037
  error estimate for blocks of size 2^( 3) =       0.001507098122
  error estimate for blocks of size 2^( 4) =       0.001551344393
  error estimate for blocks of size 2^( 5) =       0.001574163341
  error estimate for blocks of size 2^( 6) =       0.001589905225
  error estimate for blocks of size 2^( 7) =       0.001601633394

      target function =                  N/A
              le_mean =     -22.326340000843
             les_mean =     502.188417083679
             stat err =       0.001579261588
             autocorr =       1.321359373852
              std dev =       1.942967533491
             le_variance =       3.775122836200


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326340000843        initial  <--
     3.2312e+20     3.2312e+21             1.4534e-24       -22.326340000843
     1.2925e+21     1.2925e+22             3.6336e-25       -22.326340000843
     5.1699e+21     5.1699e+22             9.0503e-26       -22.326340000843

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.7588
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6797e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2310e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.1357
    reference variance = 3.2874
====================================================
  Execution time = 2.3754e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0293e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.8787e+00
  Total weights = 1.949753589e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9205e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.933812270565
                                         uncertainty =       0.131616300209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.933812270565
                                         uncertainty =       0.131616300209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001402395653
  error estimate for blocks of size 2^( 2) =       0.001471343275
  error estimate for blocks of size 2^( 3) =       0.001531936843
  error estimate for blocks of size 2^( 4) =       0.001574297491
  error estimate for blocks of size 2^( 5) =       0.001595795776
  error estimate for blocks of size 2^( 6) =       0.001608304136
  error estimate for blocks of size 2^( 7) =       0.001619828992

      target function =                  N/A
              le_mean =     -22.329752623845
             les_mean =     502.496564598522
             stat err =       0.001599556598
             autocorr =       1.300942523992
              std dev =       1.983318684328
             le_variance =       3.933553003606


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232975262384e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+21, overlap shift 3.2312e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329752623041       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329752623041       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329752623041       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+21 is 1.589340e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.2925e+22, overlap shift 1.2925e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329752623041       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329752623041       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329752624149       residual = 3.48e+03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329752623041       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+22 is 3.973351e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.1699e+22, overlap shift 5.1699e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329752623041       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329752623041       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329752623041       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+22 is 9.933377e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177887 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9682e+01
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.4333
    reference variance = 1.84651
====================================================
  Execution time = 2.3090e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7231e+00
  Total weights = 1.9500e+06
  Execution time = 4.3452e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776689427626
                                         uncertainty =       0.036499462910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776689427626
                                         uncertainty =       0.036499462910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374086988
  error estimate for blocks of size 2^( 2) =       0.001445086496
  error estimate for blocks of size 2^( 3) =       0.001507013329
  error estimate for blocks of size 2^( 4) =       0.001553597900
  error estimate for blocks of size 2^( 5) =       0.001579292580
  error estimate for blocks of size 2^( 6) =       0.001593801897
  error estimate for blocks of size 2^( 7) =       0.001603000478

      target function =                  N/A
              le_mean =     -22.328047853111
             les_mean =     502.264780748074
             stat err =       0.001582423214
             autocorr =       1.326223858069
              std dev =       1.943283546388
             le_variance =       3.776350941663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776689427626
                                         uncertainty =       0.036499462910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776689427626
                                         uncertainty =       0.036499462910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374086988
  error estimate for blocks of size 2^( 2) =       0.001445086496
  error estimate for blocks of size 2^( 3) =       0.001507013329
  error estimate for blocks of size 2^( 4) =       0.001553597900
  error estimate for blocks of size 2^( 5) =       0.001579292580
  error estimate for blocks of size 2^( 6) =       0.001593801897
  error estimate for blocks of size 2^( 7) =       0.001603000478

      target function =                  N/A
              le_mean =     -22.328047853111
             les_mean =     502.264780748074
             stat err =       0.001582423214
             autocorr =       1.326223858069
              std dev =       1.943283546388
             le_variance =       3.776350941663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776689427626
                                         uncertainty =       0.036499462910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776689427626
                                         uncertainty =       0.036499462910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374086988
  error estimate for blocks of size 2^( 2) =       0.001445086496
  error estimate for blocks of size 2^( 3) =       0.001507013329
  error estimate for blocks of size 2^( 4) =       0.001553597900
  error estimate for blocks of size 2^( 5) =       0.001579292580
  error estimate for blocks of size 2^( 6) =       0.001593801897
  error estimate for blocks of size 2^( 7) =       0.001603000478

      target function =                  N/A
              le_mean =     -22.328047853111
             les_mean =     502.264780748074
             stat err =       0.001582423214
             autocorr =       1.326223858069
              std dev =       1.943283546388
             le_variance =       3.776350941663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776689427626
                                         uncertainty =       0.036499462910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776689427626
                                         uncertainty =       0.036499462910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374086988
  error estimate for blocks of size 2^( 2) =       0.001445086496
  error estimate for blocks of size 2^( 3) =       0.001507013329
  error estimate for blocks of size 2^( 4) =       0.001553597900
  error estimate for blocks of size 2^( 5) =       0.001579292580
  error estimate for blocks of size 2^( 6) =       0.001593801897
  error estimate for blocks of size 2^( 7) =       0.001603000478

      target function =                  N/A
              le_mean =     -22.328047853111
             les_mean =     502.264780748074
             stat err =       0.001582423214
             autocorr =       1.326223858069
              std dev =       1.943283546388
             le_variance =       3.776350941663


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328047853111        initial  <--
     3.2312e+21     3.2312e+22             1.5893e-25       -22.328047853111
     1.2925e+22     1.2925e+23             3.9734e-26       -22.328047853111
     5.1699e+22     5.1699e+23             9.9334e-27       -22.328047853111

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8916
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_001                -6.963148e-01 3 1  ON 0
ci_002                -7.040968e-01 3 1  ON 1
ci_003                -6.187530e-02 3 1  ON 2
ci_004                -6.235935e-02 3 1  ON 3
ci_005                 4.604072e-02 3 1  ON 4
ci_006                 4.618020e-02 3 1  ON 5
ci_007                 3.181050e-02 3 1  ON 6
ci_008                 3.146365e-02 3 1  ON 7
ci_009                -2.501995e-02 3 1  ON 8
ci_010                -2.551280e-02 3 1  ON 9
ci_011                -2.288299e-02 3 1  ON 10
ci_012                -2.257816e-02 3 1  ON 11
ci_013                 2.000282e-02 3 1  ON 12
ci_014                 2.020289e-02 3 1  ON 13
ci_015                 1.969211e-02 3 1  ON 14
ci_016                 2.073116e-02 3 1  ON 15
ci_017                 1.537658e-02 3 1  ON 16
ci_018                 1.572789e-02 3 1  ON 17
ci_019                 1.062678e-02 3 1  ON 18
ci_020                 1.043435e-02 3 1  ON 19
ci_021                -9.780229e-03 3 1  ON 20
ci_022                -9.449016e-03 3 1  ON 21
ci_023                 8.746942e-03 3 1  ON 22
ci_024                 9.497081e-03 3 1  ON 23
ci_025                 7.146705e-03 3 1  ON 24
ci_026                 8.157605e-03 3 1  ON 25
ci_027                 7.925779e-03 3 1  ON 26
ci_028                 7.864944e-03 3 1  ON 27
ci_029                -7.651708e-03 3 1  ON 28
ci_030                -7.767457e-03 3 1  ON 29
ci_031                -7.191773e-03 3 1  ON 30
ci_032                -7.558477e-03 3 1  ON 31
ci_033                 6.848303e-03 3 1  ON 32
ci_034                 6.332356e-03 3 1  ON 33
ci_035                 6.423610e-03 3 1  ON 34
ci_036                 6.952796e-03 3 1  ON 35
ci_037                 6.517577e-03 3 1  ON 36
ci_038                 5.615240e-03 3 1  ON 37
ci_039                 5.904405e-03 3 1  ON 38
ci_040                 6.141280e-03 3 1  ON 39
ci_041                 5.432086e-03 3 1  ON 40
ci_042                 5.116297e-03 3 1  ON 41
ci_043                 5.092769e-03 3 1  ON 42
ci_044                 4.460049e-03 3 1  ON 43
ci_045                 5.123035e-03 3 1  ON 44
ci_046                 5.280840e-03 3 1  ON 45
ci_047                -3.977387e-03 3 1  ON 46
ci_048                -4.394012e-03 3 1  ON 47
ci_049                 4.051537e-03 3 1  ON 48
ci_050                 3.469315e-03 3 1  ON 49
ci_051                -3.067860e-03 3 1  ON 50
ci_052                -2.205643e-03 3 1  ON 51
ci_053                -2.741464e-03 3 1  ON 52
ci_054                -3.445850e-03 3 1  ON 53
ci_055                -1.934590e-03 3 1  ON 54
ci_056                -2.000922e-03 3 1  ON 55
ci_057                -1.788393e-03 3 1  ON 56
ci_058                -1.821741e-03 3 1  ON 57
ci_059                -1.893093e-03 3 1  ON 58
ci_060                -2.080539e-03 3 1  ON 59
ci_061                -1.839486e-03 3 1  ON 60
ci_062                -1.916699e-03 3 1  ON 61
ci_063                -1.941602e-03 3 1  ON 62
ci_064                -9.421641e-04 3 1  ON 63
ci_065                -1.762843e-03 3 1  ON 64
ci_066                -1.417179e-03 3 1  ON 65
ci_067                -1.964056e-03 3 1  ON 66
ci_068                -1.527588e-03 3 1  ON 67
ci_069                 1.161365e-03 3 1  ON 68
ci_070                 1.598511e-03 3 1  ON 69
ci_071                 1.880061e-05 3 1  ON 70
ci_072                -2.575222e-04 3 1  ON 71
ci_073                 1.366492e-03 3 1  ON 72
ci_074                 8.919672e-04 3 1  ON 73
ci_075                -1.333812e-03 3 1  ON 74
ci_076                -7.303335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4581e+01 secs
  Total Execution time = 7.5271e+03 secs

=========================================================
  A new xml input file : FORM.s099.cont.xml
