Rank =    0  Free Memory = 56929 MB
Rank =    1  Free Memory = 56921 MB
Rank =    2  Free Memory = 56920 MB
Rank =    3  Free Memory = 56920 MB
Rank =    4  Free Memory = 56920 MB
Rank =    5  Free Memory = 56920 MB
Rank =    6  Free Memory = 56920 MB
Rank =    7  Free Memory = 56920 MB
Rank =    8  Free Memory = 56920 MB
Rank =    9  Free Memory = 56920 MB
Rank =   10  Free Memory = 56920 MB
Rank =   11  Free Memory = 56920 MB
Rank =   12  Free Memory = 56920 MB
Rank =   13  Free Memory = 56920 MB
Rank =   14  Free Memory = 56920 MB
Rank =   15  Free Memory = 56910 MB
Rank =   16  Free Memory = 56903 MB
Rank =   17  Free Memory = 56902 MB
Rank =   18  Free Memory = 56902 MB
Rank =   19  Free Memory = 56902 MB
Rank =   20  Free Memory = 56902 MB
Rank =   21  Free Memory = 56902 MB
Rank =   22  Free Memory = 56902 MB
Rank =   23  Free Memory = 56902 MB
Rank =   24  Free Memory = 55304 MB
Rank =   25  Free Memory = 55304 MB
Rank =   26  Free Memory = 55304 MB
Rank =   27  Free Memory = 55304 MB
Rank =   28  Free Memory = 55304 MB
Rank =   29  Free Memory = 55304 MB
Rank =   30  Free Memory = 55304 MB
Rank =   31  Free Memory = 55304 MB
Rank =   32  Free Memory = 55304 MB
Rank =   33  Free Memory = 55304 MB
Rank =   34  Free Memory = 55304 MB
Rank =   35  Free Memory = 55304 MB
Rank =   36  Free Memory = 55304 MB
Rank =   37  Free Memory = 55304 MB
Rank =   38  Free Memory = 55304 MB
Rank =   39  Free Memory = 55304 MB
Rank =   40  Free Memory = 55304 MB
Rank =   41  Free Memory = 55304 MB
Rank =   42  Free Memory = 55304 MB
Rank =   43  Free Memory = 55304 MB
Rank =   44  Free Memory = 55304 MB
Rank =   45  Free Memory = 55304 MB
Rank =   46  Free Memory = 55304 MB
Rank =   47  Free Memory = 55304 MB
Rank =   48  Free Memory = 55929 MB
Rank =   49  Free Memory = 55929 MB
Rank =   50  Free Memory = 55929 MB
Rank =   51  Free Memory = 55929 MB
Rank =   52  Free Memory = 55929 MB
Rank =   53  Free Memory = 55929 MB
Rank =   54  Free Memory = 55929 MB
Rank =   55  Free Memory = 55929 MB
Rank =   56  Free Memory = 55929 MB
Rank =   57  Free Memory = 55929 MB
Rank =   58  Free Memory = 55929 MB
Rank =   59  Free Memory = 55929 MB
Rank =   60  Free Memory = 55929 MB
Rank =   61  Free Memory = 55929 MB
Rank =   62  Free Memory = 55929 MB
Rank =   63  Free Memory = 55929 MB
Rank =   64  Free Memory = 55929 MB
Rank =   65  Free Memory = 55929 MB
Rank =   66  Free Memory = 55929 MB
Rank =   67  Free Memory = 55929 MB
Rank =   68  Free Memory = 55929 MB
Rank =   69  Free Memory = 55929 MB
Rank =   70  Free Memory = 55929 MB
Rank =   71  Free Memory = 55929 MB
Rank =   72  Free Memory = 58236 MB
Rank =   73  Free Memory = 58236 MB
Rank =   74  Free Memory = 58236 MB
Rank =   75  Free Memory = 58236 MB
Rank =   76  Free Memory = 58236 MB
Rank =   77  Free Memory = 58236 MB
Rank =   78  Free Memory = 58236 MB
Rank =   79  Free Memory = 58236 MB
Rank =   80  Free Memory = 58236 MB
Rank =   81  Free Memory = 58236 MB
Rank =   82  Free Memory = 58236 MB
Rank =   83  Free Memory = 58236 MB
Rank =   84  Free Memory = 58236 MB
Rank =   85  Free Memory = 58236 MB
Rank =   86  Free Memory = 58236 MB
Rank =   87  Free Memory = 58236 MB
Rank =   88  Free Memory = 58236 MB
Rank =   89  Free Memory = 58236 MB
Rank =   90  Free Memory = 58236 MB
Rank =   91  Free Memory = 58231 MB
Rank =   92  Free Memory = 58229 MB
Rank =   93  Free Memory = 58229 MB
Rank =   94  Free Memory = 58229 MB
Rank =   95  Free Memory = 58229 MB
  Input file(s): opt_form_n2pistar_lmci_run001a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 96
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 96
  MPI ranks per node        = 24
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_lmci_run001a.xml

  Project = FORM
  date    = 2023-05-01 22:14:17 PDT
  host    = n0093.savio2

 Random Number
 -------------
  Offset for the random number seeds based on time: 41

  Range of prime numbers to use as seeds over processors and threads = 191-797


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0
  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 12.7057

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 10.1859

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 12.7057

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 12.7057

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 77 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 0.999973
Norm of qchem ci vector (sum of qchem_ci^2): 0
Found 24 unique up determinants.
Found 24 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 1.405

  Adding pseudopotential for O
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 1.075

  Adding pseudopotential for H1
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1e-10
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 0.001
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 0.001

  Adding pseudopotential for H2
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1e-10
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 0.001
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 0.001
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 0.2264 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAB source=e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 76
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.2599
    reference variance = 2.94807
====================================================
  Execution time = 2.4106e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0277e+04
  VMC Eavg = -2.2324e+01
  VMC Evar = 3.7954e+00
  Total weights = 1.949829228e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9462e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.849273039733
                                         uncertainty =       0.041545769004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.849273039733
                                         uncertainty =       0.041545769004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387310812
  error estimate for blocks of size 2^( 2) =       0.001457033966
  error estimate for blocks of size 2^( 3) =       0.001520002385
  error estimate for blocks of size 2^( 4) =       0.001563262210
  error estimate for blocks of size 2^( 5) =       0.001584296777
  error estimate for blocks of size 2^( 6) =       0.001591558994
  error estimate for blocks of size 2^( 7) =       0.001599683328

      target function =                  N/A
              le_mean =     -22.324401281400
             les_mean =     502.174337567400
             stat err =       0.001584700327
             autocorr =       1.304808428248
              std dev =       1.961985156441
             le_variance =       3.849385754096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.232440128140e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324401280617       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324444364421       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324445694904       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.324445655815       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.324445769116       residual = 1.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.160603e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324401280617       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324417133846       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324417254564       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.324417241495       residual = 2.10e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.837956e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324401280617       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324405773963       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324405790949       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 1.044122e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098727 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0158e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_001 -6.999420e-01                3 1 ON  0
ci_002 -7.001175e-01                3 1 ON  1
ci_003 -6.175276e-02                3 1 ON  2
ci_004 -6.179649e-02                3 1 ON  3
ci_005 4.566736e-02                 3 1 ON  4
ci_006 4.563106e-02                 3 1 ON  5
ci_007 3.195264e-02                 3 1 ON  6
ci_008 3.184251e-02                 3 1 ON  7
ci_009 -2.502781e-02                3 1 ON  8
ci_010 -2.491011e-02                3 1 ON  9
ci_011 -2.238675e-02                3 1 ON  10
ci_012 -2.239241e-02                3 1 ON  11
ci_013 2.021361e-02                 3 1 ON  12
ci_014 2.031398e-02                 3 1 ON  13
ci_015 2.032610e-02                 3 1 ON  14
ci_016 2.003217e-02                 3 1 ON  15
ci_017 1.563903e-02                 3 1 ON  16
ci_018 1.590800e-02                 3 1 ON  17
ci_019 1.001616e-02                 3 1 ON  18
ci_020 9.951090e-03                 3 1 ON  19
ci_021 -9.882615e-03                3 1 ON  20
ci_022 -9.957858e-03                3 1 ON  21
ci_023 8.667121e-03                 3 1 ON  22
ci_024 8.722742e-03                 3 1 ON  23
ci_025 8.173856e-03                 3 1 ON  24
ci_026 7.892851e-03                 3 1 ON  25
ci_027 8.004215e-03                 3 1 ON  26
ci_028 7.840482e-03                 3 1 ON  27
ci_029 -7.731206e-03                3 1 ON  28
ci_030 -7.715298e-03                3 1 ON  29
ci_031 -7.785407e-03                3 1 ON  30
ci_032 -7.784435e-03                3 1 ON  31
ci_033 7.109528e-03                 3 1 ON  32
ci_034 6.972124e-03                 3 1 ON  33
ci_035 6.582352e-03                 3 1 ON  34
ci_036 6.539588e-03                 3 1 ON  35
ci_037 6.638580e-03                 3 1 ON  36
ci_038 6.604618e-03                 3 1 ON  37
ci_039 5.827252e-03                 3 1 ON  38
ci_040 5.636188e-03                 3 1 ON  39
ci_041 4.913584e-03                 3 1 ON  40
ci_042 4.870881e-03                 3 1 ON  41
ci_043 5.334107e-03                 3 1 ON  42
ci_044 5.015123e-03                 3 1 ON  43
ci_045 5.012674e-03                 3 1 ON  44
ci_046 5.038512e-03                 3 1 ON  45
ci_047 -4.318682e-03                3 1 ON  46
ci_048 -4.329723e-03                3 1 ON  47
ci_049 3.227560e-03                 3 1 ON  48
ci_050 3.223213e-03                 3 1 ON  49
ci_051 -2.976551e-03                3 1 ON  50
ci_052 -2.834884e-03                3 1 ON  51
ci_053 -2.723701e-03                3 1 ON  52
ci_054 -2.740235e-03                3 1 ON  53
ci_055 -2.254296e-03                3 1 ON  54
ci_056 -2.103599e-03                3 1 ON  55
ci_057 -1.761859e-03                3 1 ON  56
ci_058 -1.933742e-03                3 1 ON  57
ci_059 -2.060272e-03                3 1 ON  58
ci_060 -1.846453e-03                3 1 ON  59
ci_061 -1.414624e-03                3 1 ON  60
ci_062 -1.627657e-03                3 1 ON  61
ci_063 -1.370167e-03                3 1 ON  62
ci_064 -1.307858e-03                3 1 ON  63
ci_065 -1.321166e-03                3 1 ON  64
ci_066 -1.424111e-03                3 1 ON  65
ci_067 -1.258383e-03                3 1 ON  66
ci_068 -1.431459e-03                3 1 ON  67
ci_069 1.233819e-03                 3 1 ON  68
ci_070 1.554246e-03                 3 1 ON  69
ci_071 -1.198312e-03                3 1 ON  70
ci_072 -1.095747e-03                3 1 ON  71
ci_073 1.108618e-03                 3 1 ON  72
ci_074 9.681118e-04                 3 1 ON  73
ci_075 -9.670085e-04                3 1 ON  74
ci_076 -1.130104e-03                3 1 ON  75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.0409
    reference variance = 7.17954
====================================================
  Execution time = 2.3622e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7762e+00
  Total weights = 1.9497e+06
  Execution time = 4.3608e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.828570742814
                                         uncertainty =       0.043029858526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.828570742814
                                         uncertainty =       0.043029858526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383752973
  error estimate for blocks of size 2^( 2) =       0.001454338925
  error estimate for blocks of size 2^( 3) =       0.001517494918
  error estimate for blocks of size 2^( 4) =       0.001558906811
  error estimate for blocks of size 2^( 5) =       0.001581632679
  error estimate for blocks of size 2^( 6) =       0.001589398140
  error estimate for blocks of size 2^( 7) =       0.001598717175

      target function =                  N/A
              le_mean =     -22.324570458736
             les_mean =     502.177571326989
             stat err =       0.001582163701
             autocorr =       1.307331419308
              std dev =       1.956953532517
             le_variance =       3.829667128430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.828777386925
                                         uncertainty =       0.043033187337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.828777386925
                                         uncertainty =       0.043033187337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383790188
  error estimate for blocks of size 2^( 2) =       0.001454354847
  error estimate for blocks of size 2^( 3) =       0.001517500357
  error estimate for blocks of size 2^( 4) =       0.001558888438
  error estimate for blocks of size 2^( 5) =       0.001581593633
  error estimate for blocks of size 2^( 6) =       0.001589375583
  error estimate for blocks of size 2^( 7) =       0.001598661945

      target function =                  N/A
              le_mean =     -22.324576427384
             les_mean =     502.291284078011
             stat err =       0.001582129900
             autocorr =       1.307205247253
              std dev =       1.957006162593
             le_variance =       3.829873120425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.828665889428
                                         uncertainty =       0.043032290235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.828665889428
                                         uncertainty =       0.043032290235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383770053
  error estimate for blocks of size 2^( 2) =       0.001454339891
  error estimate for blocks of size 2^( 3) =       0.001517482959
  error estimate for blocks of size 2^( 4) =       0.001558883270
  error estimate for blocks of size 2^( 5) =       0.001581592074
  error estimate for blocks of size 2^( 6) =       0.001589363657
  error estimate for blocks of size 2^( 7) =       0.001598658176

      target function =                  N/A
              le_mean =     -22.324574976451
             les_mean =     502.166505323181
             stat err =       0.001582124294
             autocorr =       1.307234024917
              std dev =       1.956977687748
             le_variance =       3.829761670344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.828572058681
                                         uncertainty =       0.043030243461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.828572058681
                                         uncertainty =       0.043030243461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383753200
  error estimate for blocks of size 2^( 2) =       0.001454337267
  error estimate for blocks of size 2^( 3) =       0.001517491054
  error estimate for blocks of size 2^( 4) =       0.001558900970
  error estimate for blocks of size 2^( 5) =       0.001581622617
  error estimate for blocks of size 2^( 6) =       0.001589397352
  error estimate for blocks of size 2^( 7) =       0.001598706046

      target function =                  N/A
              le_mean =     -22.324572016644
             les_mean =     502.163861777322
             stat err =       0.001582156746
             autocorr =       1.307319497648
              std dev =       1.956953852743
             le_variance =       3.829668381765


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.324570458736        initial
     2.5000e-01     2.5000e+00             1.1606e-03       -22.324576427384  <--
     1.0000e+00     1.0000e+01             3.8380e-04       -22.324574976451
     4.0000e+00     4.0000e+01             1.0441e-04       -22.324572016644

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.5467e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_001                -6.997042e-01 3 1  ON 0
ci_002                -7.003734e-01 3 1  ON 1
ci_003                -6.112763e-02 3 1  ON 2
ci_004                -6.130086e-02 3 1  ON 3
ci_005                 4.600698e-02 3 1  ON 4
ci_006                 4.593988e-02 3 1  ON 5
ci_007                 3.209829e-02 3 1  ON 6
ci_008                 3.178253e-02 3 1  ON 7
ci_009                -2.521526e-02 3 1  ON 8
ci_010                -2.489796e-02 3 1  ON 9
ci_011                -2.210507e-02 3 1  ON 10
ci_012                -2.209158e-02 3 1  ON 11
ci_013                 2.013307e-02 3 1  ON 12
ci_014                 2.041505e-02 3 1  ON 13
ci_015                 2.110290e-02 3 1  ON 14
ci_016                 2.022334e-02 3 1  ON 15
ci_017                 1.571856e-02 3 1  ON 16
ci_018                 1.647771e-02 3 1  ON 17
ci_019                 9.907854e-03 3 1  ON 18
ci_020                 9.749613e-03 3 1  ON 19
ci_021                -9.839987e-03 3 1  ON 20
ci_022                -1.006562e-02 3 1  ON 21
ci_023                 8.611232e-03 3 1  ON 22
ci_024                 8.762289e-03 3 1  ON 23
ci_025                 8.697144e-03 3 1  ON 24
ci_026                 7.873664e-03 3 1  ON 25
ci_027                 8.152579e-03 3 1  ON 26
ci_028                 7.770468e-03 3 1  ON 27
ci_029                -7.484790e-03 3 1  ON 28
ci_030                -7.431903e-03 3 1  ON 29
ci_031                -7.965302e-03 3 1  ON 30
ci_032                -7.971999e-03 3 1  ON 31
ci_033                 7.389867e-03 3 1  ON 32
ci_034                 7.000261e-03 3 1  ON 33
ci_035                 6.524649e-03 3 1  ON 34
ci_036                 6.449977e-03 3 1  ON 35
ci_037                 6.693284e-03 3 1  ON 36
ci_038                 6.614332e-03 3 1  ON 37
ci_039                 6.145382e-03 3 1  ON 38
ci_040                 5.693818e-03 3 1  ON 39
ci_041                 4.672800e-03 3 1  ON 40
ci_042                 4.580061e-03 3 1  ON 41
ci_043                 5.836076e-03 3 1  ON 42
ci_044                 4.973637e-03 3 1  ON 43
ci_045                 5.029133e-03 3 1  ON 44
ci_046                 5.116917e-03 3 1  ON 45
ci_047                -4.394575e-03 3 1  ON 46
ci_048                -4.410633e-03 3 1  ON 47
ci_049                 3.089094e-03 3 1  ON 48
ci_050                 3.073675e-03 3 1  ON 49
ci_051                -3.180455e-03 3 1  ON 50
ci_052                -2.763530e-03 3 1  ON 51
ci_053                -2.663864e-03 3 1  ON 52
ci_054                -2.745376e-03 3 1  ON 53
ci_055                -2.191549e-03 3 1  ON 54
ci_056                -1.753128e-03 3 1  ON 55
ci_057                -1.404756e-03 3 1  ON 56
ci_058                -1.866844e-03 3 1  ON 57
ci_059                -2.346902e-03 3 1  ON 58
ci_060                -1.821416e-03 3 1  ON 59
ci_061                -1.172406e-03 3 1  ON 60
ci_062                -1.726243e-03 3 1  ON 61
ci_063                -1.267168e-03 3 1  ON 62
ci_064                -1.074376e-03 3 1  ON 63
ci_065                -1.299820e-03 3 1  ON 64
ci_066                -1.582985e-03 3 1  ON 65
ci_067                -1.144425e-03 3 1  ON 66
ci_068                -1.648117e-03 3 1  ON 67
ci_069                 1.290869e-03 3 1  ON 68
ci_070                 2.157704e-03 3 1  ON 69
ci_071                -1.249924e-03 3 1  ON 70
ci_072                -9.806026e-04 3 1  ON 71
ci_073                 1.206909e-03 3 1  ON 72
ci_074                 8.424009e-04 3 1  ON 73
ci_075                -9.236212e-04 3 1  ON 74
ci_076                -1.338939e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5633e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2150e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.2144
    reference variance = 5.55281
====================================================
  Execution time = 2.4053e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0323e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8151e+00
  Total weights = 1.949799121e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9392e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.866911371573
                                         uncertainty =       0.069212206514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.866911371573
                                         uncertainty =       0.069212206514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001390364485
  error estimate for blocks of size 2^( 2) =       0.001461135125
  error estimate for blocks of size 2^( 3) =       0.001524566836
  error estimate for blocks of size 2^( 4) =       0.001568133931
  error estimate for blocks of size 2^( 5) =       0.001594123482
  error estimate for blocks of size 2^( 6) =       0.001607384262
  error estimate for blocks of size 2^( 7) =       0.001616975533

      target function =                  N/A
              le_mean =     -22.327970385263
             les_mean =     502.353367444087
             stat err =       0.001596654302
             autocorr =       1.318756032574
              std dev =       1.966303771389
             le_variance =       3.866350521380


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232797038526e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327970384426       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328051178270       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328055720083       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328057969700       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328058441368       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328058318795       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.328058347727       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 2.487363e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327970384426       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328016779385       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328017514565       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328017822826       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328017840741       residual = 4.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.069620e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327970384426       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327987548246       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327987570633       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.744349e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101192 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0000e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_001                -6.999670e-01 3 1  ON 0
ci_002                -7.001784e-01 3 1  ON 1
ci_003                -6.019487e-02 3 1  ON 2
ci_004                -6.112135e-02 3 1  ON 3
ci_005                 4.551819e-02 3 1  ON 4
ci_006                 4.621552e-02 3 1  ON 5
ci_007                 3.216165e-02 3 1  ON 6
ci_008                 3.186796e-02 3 1  ON 7
ci_009                -2.557726e-02 3 1  ON 8
ci_010                -2.563342e-02 3 1  ON 9
ci_011                -2.209967e-02 3 1  ON 10
ci_012                -2.278489e-02 3 1  ON 11
ci_013                 1.986727e-02 3 1  ON 12
ci_014                 2.018737e-02 3 1  ON 13
ci_015                 2.074296e-02 3 1  ON 14
ci_016                 1.982778e-02 3 1  ON 15
ci_017                 1.555583e-02 3 1  ON 16
ci_018                 1.665904e-02 3 1  ON 17
ci_019                 1.020923e-02 3 1  ON 18
ci_020                 9.685038e-03 3 1  ON 19
ci_021                -1.071148e-02 3 1  ON 20
ci_022                -9.886766e-03 3 1  ON 21
ci_023                 8.602255e-03 3 1  ON 22
ci_024                 8.644691e-03 3 1  ON 23
ci_025                 8.501173e-03 3 1  ON 24
ci_026                 8.130832e-03 3 1  ON 25
ci_027                 8.224985e-03 3 1  ON 26
ci_028                 7.586199e-03 3 1  ON 27
ci_029                -8.369924e-03 3 1  ON 28
ci_030                -7.648442e-03 3 1  ON 29
ci_031                -8.043509e-03 3 1  ON 30
ci_032                -7.599859e-03 3 1  ON 31
ci_033                 7.534709e-03 3 1  ON 32
ci_034                 6.725878e-03 3 1  ON 33
ci_035                 6.622898e-03 3 1  ON 34
ci_036                 6.790100e-03 3 1  ON 35
ci_037                 6.588765e-03 3 1  ON 36
ci_038                 6.271923e-03 3 1  ON 37
ci_039                 5.519594e-03 3 1  ON 38
ci_040                 6.338790e-03 3 1  ON 39
ci_041                 5.027873e-03 3 1  ON 40
ci_042                 4.216009e-03 3 1  ON 41
ci_043                 5.476462e-03 3 1  ON 42
ci_044                 4.295524e-03 3 1  ON 43
ci_045                 5.031633e-03 3 1  ON 44
ci_046                 5.646004e-03 3 1  ON 45
ci_047                -4.499570e-03 3 1  ON 46
ci_048                -4.269659e-03 3 1  ON 47
ci_049                 3.232872e-03 3 1  ON 48
ci_050                 2.627834e-03 3 1  ON 49
ci_051                -2.839940e-03 3 1  ON 50
ci_052                -2.956488e-03 3 1  ON 51
ci_053                -2.250758e-03 3 1  ON 52
ci_054                -3.022692e-03 3 1  ON 53
ci_055                -3.232788e-03 3 1  ON 54
ci_056                -2.399157e-03 3 1  ON 55
ci_057                -1.966569e-03 3 1  ON 56
ci_058                -1.800013e-03 3 1  ON 57
ci_059                -2.306898e-03 3 1  ON 58
ci_060                -1.747375e-03 3 1  ON 59
ci_061                -1.511788e-03 3 1  ON 60
ci_062                -1.920952e-03 3 1  ON 61
ci_063                -1.182382e-03 3 1  ON 62
ci_064                -4.871934e-04 3 1  ON 63
ci_065                -1.718734e-03 3 1  ON 64
ci_066                -1.526828e-03 3 1  ON 65
ci_067                -5.944497e-04 3 1  ON 66
ci_068                -5.784974e-04 3 1  ON 67
ci_069                 1.964282e-03 3 1  ON 68
ci_070                 1.410351e-03 3 1  ON 69
ci_071                -1.229881e-03 3 1  ON 70
ci_072                -7.890890e-04 3 1  ON 71
ci_073                 1.329686e-03 3 1  ON 72
ci_074                 1.126038e-03 3 1  ON 73
ci_075                -8.984714e-04 3 1  ON 74
ci_076                -9.466266e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.4171
    reference variance = 2.07604
====================================================
  Execution time = 2.3558e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7618e+00
  Total weights = 1.9500e+06
  Execution time = 4.3696e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813960624809
                                         uncertainty =       0.046864396026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813960624809
                                         uncertainty =       0.046864396026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380728228
  error estimate for blocks of size 2^( 2) =       0.001452259992
  error estimate for blocks of size 2^( 3) =       0.001513903071
  error estimate for blocks of size 2^( 4) =       0.001557587505
  error estimate for blocks of size 2^( 5) =       0.001581176803
  error estimate for blocks of size 2^( 6) =       0.001593366209
  error estimate for blocks of size 2^( 7) =       0.001607853050

      target function =                  N/A
              le_mean =     -22.328335460146
             les_mean =     502.377262647541
             stat err =       0.001584995892
             autocorr =       1.317770782738
              std dev =       1.952675828188
             le_variance =       3.812942889991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813982320500
                                         uncertainty =       0.046874586222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813982320500
                                         uncertainty =       0.046874586222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380732275
  error estimate for blocks of size 2^( 2) =       0.001452258842
  error estimate for blocks of size 2^( 3) =       0.001513864634
  error estimate for blocks of size 2^( 4) =       0.001557548607
  error estimate for blocks of size 2^( 5) =       0.001581126362
  error estimate for blocks of size 2^( 6) =       0.001593362303
  error estimate for blocks of size 2^( 7) =       0.001607908974

      target function =                  N/A
              le_mean =     -22.328333287132
             les_mean =     502.339338134254
             stat err =       0.001584986562
             autocorr =       1.317747543761
              std dev =       1.952681551532
             le_variance =       3.812965241695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814019963300
                                         uncertainty =       0.046876228800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814019963300
                                         uncertainty =       0.046876228800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380739117
  error estimate for blocks of size 2^( 2) =       0.001452261979
  error estimate for blocks of size 2^( 3) =       0.001513870954
  error estimate for blocks of size 2^( 4) =       0.001557577811
  error estimate for blocks of size 2^( 5) =       0.001581158039
  error estimate for blocks of size 2^( 6) =       0.001593418595
  error estimate for blocks of size 2^( 7) =       0.001608001652

      target function =                  N/A
              le_mean =     -22.328335676536
             les_mean =     502.328226828508
             stat err =       0.001585039024
             autocorr =       1.317821719297
              std dev =       1.952691227359
             le_variance =       3.813003029406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813744857040
                                         uncertainty =       0.046872309698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813744857040
                                         uncertainty =       0.046872309698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380689250
  error estimate for blocks of size 2^( 2) =       0.001452216701
  error estimate for blocks of size 2^( 3) =       0.001513833473
  error estimate for blocks of size 2^( 4) =       0.001557535356
  error estimate for blocks of size 2^( 5) =       0.001581109747
  error estimate for blocks of size 2^( 6) =       0.001593340752
  error estimate for blocks of size 2^( 7) =       0.001607898731

      target function =                  N/A
              le_mean =     -22.328317078633
             les_mean =     502.320514296593
             stat err =       0.001584971147
             autocorr =       1.317804039196
              std dev =       1.952620703528
             le_variance =       3.812727611846


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328335460146        initial
     6.2500e-02     6.2500e-01             2.4874e-03       -22.328333287132
     2.5000e-01     2.5000e+00             1.0696e-03       -22.328335676536  <--
     1.0000e+00     1.0000e+01             3.7443e-04       -22.328317078633

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.5509e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_001                -6.999670e-01 3 1  ON 0
ci_002                -7.001784e-01 3 1  ON 1
ci_003                -6.019487e-02 3 1  ON 2
ci_004                -6.112135e-02 3 1  ON 3
ci_005                 4.551819e-02 3 1  ON 4
ci_006                 4.621552e-02 3 1  ON 5
ci_007                 3.216165e-02 3 1  ON 6
ci_008                 3.186796e-02 3 1  ON 7
ci_009                -2.557726e-02 3 1  ON 8
ci_010                -2.563342e-02 3 1  ON 9
ci_011                -2.209967e-02 3 1  ON 10
ci_012                -2.278489e-02 3 1  ON 11
ci_013                 1.986727e-02 3 1  ON 12
ci_014                 2.018737e-02 3 1  ON 13
ci_015                 2.074296e-02 3 1  ON 14
ci_016                 1.982778e-02 3 1  ON 15
ci_017                 1.555583e-02 3 1  ON 16
ci_018                 1.665904e-02 3 1  ON 17
ci_019                 1.020923e-02 3 1  ON 18
ci_020                 9.685038e-03 3 1  ON 19
ci_021                -1.071148e-02 3 1  ON 20
ci_022                -9.886766e-03 3 1  ON 21
ci_023                 8.602255e-03 3 1  ON 22
ci_024                 8.644691e-03 3 1  ON 23
ci_025                 8.501173e-03 3 1  ON 24
ci_026                 8.130832e-03 3 1  ON 25
ci_027                 8.224985e-03 3 1  ON 26
ci_028                 7.586199e-03 3 1  ON 27
ci_029                -8.369924e-03 3 1  ON 28
ci_030                -7.648442e-03 3 1  ON 29
ci_031                -8.043509e-03 3 1  ON 30
ci_032                -7.599859e-03 3 1  ON 31
ci_033                 7.534709e-03 3 1  ON 32
ci_034                 6.725878e-03 3 1  ON 33
ci_035                 6.622898e-03 3 1  ON 34
ci_036                 6.790100e-03 3 1  ON 35
ci_037                 6.588765e-03 3 1  ON 36
ci_038                 6.271923e-03 3 1  ON 37
ci_039                 5.519594e-03 3 1  ON 38
ci_040                 6.338790e-03 3 1  ON 39
ci_041                 5.027873e-03 3 1  ON 40
ci_042                 4.216009e-03 3 1  ON 41
ci_043                 5.476462e-03 3 1  ON 42
ci_044                 4.295524e-03 3 1  ON 43
ci_045                 5.031633e-03 3 1  ON 44
ci_046                 5.646004e-03 3 1  ON 45
ci_047                -4.499570e-03 3 1  ON 46
ci_048                -4.269659e-03 3 1  ON 47
ci_049                 3.232872e-03 3 1  ON 48
ci_050                 2.627834e-03 3 1  ON 49
ci_051                -2.839940e-03 3 1  ON 50
ci_052                -2.956488e-03 3 1  ON 51
ci_053                -2.250758e-03 3 1  ON 52
ci_054                -3.022692e-03 3 1  ON 53
ci_055                -3.232788e-03 3 1  ON 54
ci_056                -2.399157e-03 3 1  ON 55
ci_057                -1.966569e-03 3 1  ON 56
ci_058                -1.800013e-03 3 1  ON 57
ci_059                -2.306898e-03 3 1  ON 58
ci_060                -1.747375e-03 3 1  ON 59
ci_061                -1.511788e-03 3 1  ON 60
ci_062                -1.920952e-03 3 1  ON 61
ci_063                -1.182382e-03 3 1  ON 62
ci_064                -4.871934e-04 3 1  ON 63
ci_065                -1.718734e-03 3 1  ON 64
ci_066                -1.526828e-03 3 1  ON 65
ci_067                -5.944497e-04 3 1  ON 66
ci_068                -5.784974e-04 3 1  ON 67
ci_069                 1.964282e-03 3 1  ON 68
ci_070                 1.410351e-03 3 1  ON 69
ci_071                -1.229881e-03 3 1  ON 70
ci_072                -7.890890e-04 3 1  ON 71
ci_073                 1.329686e-03 3 1  ON 72
ci_074                 1.126038e-03 3 1  ON 73
ci_075                -8.984714e-04 3 1  ON 74
ci_076                -9.466266e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5516e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2233e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -21.8762
    reference variance = 4.8553
====================================================
  Execution time = 2.4063e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0288e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7182e+00
  Total weights = 1.949698188e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9700e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.768397579380
                                         uncertainty =       0.025188140464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.768397579380
                                         uncertainty =       0.025188140464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373049650
  error estimate for blocks of size 2^( 2) =       0.001443150320
  error estimate for blocks of size 2^( 3) =       0.001504475174
  error estimate for blocks of size 2^( 4) =       0.001546966794
  error estimate for blocks of size 2^( 5) =       0.001575281358
  error estimate for blocks of size 2^( 6) =       0.001589947559
  error estimate for blocks of size 2^( 7) =       0.001601731064

      target function =                  N/A
              le_mean =     -22.328112279393
             les_mean =     502.262829567939
             stat err =       0.001578481694
             autocorr =       1.321620040874
              std dev =       1.941816505323
             le_variance =       3.770651340344


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232811227939e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328112278571       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328201423121       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328208820374       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328207088710       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328207983166       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328207779599       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.328207663509       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 1.840881e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328112278571       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328162495805       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328164141574       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328163772557       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328163846605       residual = 5.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.010503e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328112278571       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328130561113       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328130698796       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.631076e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103095 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0040e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_001                -7.002660e-01 3 1  ON 0
ci_002                -6.998547e-01 3 1  ON 1
ci_003                -6.035725e-02 3 1  ON 2
ci_004                -6.178145e-02 3 1  ON 3
ci_005                 4.534634e-02 3 1  ON 4
ci_006                 4.609160e-02 3 1  ON 5
ci_007                 3.150114e-02 3 1  ON 6
ci_008                 3.228073e-02 3 1  ON 7
ci_009                -2.544294e-02 3 1  ON 8
ci_010                -2.545456e-02 3 1  ON 9
ci_011                -2.254872e-02 3 1  ON 10
ci_012                -2.252819e-02 3 1  ON 11
ci_013                 1.989794e-02 3 1  ON 12
ci_014                 1.986963e-02 3 1  ON 13
ci_015                 2.062072e-02 3 1  ON 14
ci_016                 2.000657e-02 3 1  ON 15
ci_017                 1.601479e-02 3 1  ON 16
ci_018                 1.601362e-02 3 1  ON 17
ci_019                 9.600066e-03 3 1  ON 18
ci_020                 9.976938e-03 3 1  ON 19
ci_021                -1.095345e-02 3 1  ON 20
ci_022                -1.068490e-02 3 1  ON 21
ci_023                 8.619201e-03 3 1  ON 22
ci_024                 8.024455e-03 3 1  ON 23
ci_025                 8.211477e-03 3 1  ON 24
ci_026                 8.095557e-03 3 1  ON 25
ci_027                 8.757387e-03 3 1  ON 26
ci_028                 7.790247e-03 3 1  ON 27
ci_029                -7.461180e-03 3 1  ON 28
ci_030                -8.219466e-03 3 1  ON 29
ci_031                -8.161778e-03 3 1  ON 30
ci_032                -7.274149e-03 3 1  ON 31
ci_033                 7.348969e-03 3 1  ON 32
ci_034                 7.188132e-03 3 1  ON 33
ci_035                 6.698561e-03 3 1  ON 34
ci_036                 6.746773e-03 3 1  ON 35
ci_037                 6.557868e-03 3 1  ON 36
ci_038                 6.260845e-03 3 1  ON 37
ci_039                 5.526129e-03 3 1  ON 38
ci_040                 6.083929e-03 3 1  ON 39
ci_041                 4.847913e-03 3 1  ON 40
ci_042                 4.628053e-03 3 1  ON 41
ci_043                 5.023952e-03 3 1  ON 42
ci_044                 5.306027e-03 3 1  ON 43
ci_045                 5.500790e-03 3 1  ON 44
ci_046                 5.269002e-03 3 1  ON 45
ci_047                -4.263714e-03 3 1  ON 46
ci_048                -4.617020e-03 3 1  ON 47
ci_049                 2.898395e-03 3 1  ON 48
ci_050                 3.083077e-03 3 1  ON 49
ci_051                -2.589091e-03 3 1  ON 50
ci_052                -3.064031e-03 3 1  ON 51
ci_053                -2.054945e-03 3 1  ON 52
ci_054                -2.594240e-03 3 1  ON 53
ci_055                -2.386709e-03 3 1  ON 54
ci_056                -2.733078e-03 3 1  ON 55
ci_057                -1.502195e-03 3 1  ON 56
ci_058                -1.244938e-03 3 1  ON 57
ci_059                -2.295235e-03 3 1  ON 58
ci_060                -2.162658e-03 3 1  ON 59
ci_061                -1.040091e-03 3 1  ON 60
ci_062                -2.178869e-03 3 1  ON 61
ci_063                -1.763923e-03 3 1  ON 62
ci_064                -8.707261e-04 3 1  ON 63
ci_065                -1.826823e-03 3 1  ON 64
ci_066                -1.946595e-03 3 1  ON 65
ci_067                -8.760351e-04 3 1  ON 66
ci_068                -7.912194e-04 3 1  ON 67
ci_069                 1.518437e-03 3 1  ON 68
ci_070                 1.529600e-03 3 1  ON 69
ci_071                -1.406445e-03 3 1  ON 70
ci_072                -9.929245e-04 3 1  ON 71
ci_073                 1.321220e-03 3 1  ON 72
ci_074                 1.476076e-03 3 1  ON 73
ci_075                -9.028825e-04 3 1  ON 74
ci_076                -1.925835e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -21.9144
    reference variance = 4.69347
====================================================
  Execution time = 2.5883e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7066e+00
  Total weights = 1.9499e+06
  Execution time = 4.3628e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 9.42709e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759687169127
                                         uncertainty =       0.035940782117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759687169127
                                         uncertainty =       0.035940782117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370969600
  error estimate for blocks of size 2^( 2) =       0.001441503328
  error estimate for blocks of size 2^( 3) =       0.001504907722
  error estimate for blocks of size 2^( 4) =       0.001548932930
  error estimate for blocks of size 2^( 5) =       0.001570120290
  error estimate for blocks of size 2^( 6) =       0.001585809987
  error estimate for blocks of size 2^( 7) =       0.001592642414

      target function =                  N/A
              le_mean =     -22.329947280247
             les_mean =     502.340550878989
             stat err =       0.001574376405
             autocorr =       1.318747032942
              std dev =       1.938874822599
             le_variance =       3.759235577709

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0002634
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759196147505
                                         uncertainty =       0.035911063869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759196147505
                                         uncertainty =       0.035911063869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370880674
  error estimate for blocks of size 2^( 2) =       0.001441441355
  error estimate for blocks of size 2^( 3) =       0.001504843918
  error estimate for blocks of size 2^( 4) =       0.001548877894
  error estimate for blocks of size 2^( 5) =       0.001570004946
  error estimate for blocks of size 2^( 6) =       0.001585730910
  error estimate for blocks of size 2^( 7) =       0.001592561180

      target function =                  N/A
              le_mean =     -22.329953790607
             les_mean =     502.341461279089
             stat err =       0.001574293733
             autocorr =       1.318779614076
              std dev =       1.938749060466
             le_variance =       3.758747919459

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 9.41872e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764486007177
                                         uncertainty =       0.035864539377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764486007177
                                         uncertainty =       0.035864539377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371842872
  error estimate for blocks of size 2^( 2) =       0.001442382430
  error estimate for blocks of size 2^( 3) =       0.001505803317
  error estimate for blocks of size 2^( 4) =       0.001549879325
  error estimate for blocks of size 2^( 5) =       0.001570952926
  error estimate for blocks of size 2^( 6) =       0.001586698856
  error estimate for blocks of size 2^( 7) =       0.001593452910

      target function =                  N/A
              le_mean =     -22.329975369679
             les_mean =     503.842151559451
             stat err =       0.001575246004
             autocorr =       1.318523976125
              std dev =       1.940109835404
             le_variance =       3.764026173433

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000215125
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759212887852
                                         uncertainty =       0.035915888552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759212887852
                                         uncertainty =       0.035915888552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370883431
  error estimate for blocks of size 2^( 2) =       0.001441429305
  error estimate for blocks of size 2^( 3) =       0.001504827941
  error estimate for blocks of size 2^( 4) =       0.001548850942
  error estimate for blocks of size 2^( 5) =       0.001570019053
  error estimate for blocks of size 2^( 6) =       0.001585742927
  error estimate for blocks of size 2^( 7) =       0.001592572526

      target function =                  N/A
              le_mean =     -22.329942160489
             les_mean =     502.335605654841
             stat err =       0.001574296362
             autocorr =       1.318778715117
              std dev =       1.938752959557
             le_variance =       3.758763038191


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329947280247        initial
     6.2500e-02     6.2500e-01             1.8409e-03       -22.329953790607
     2.5000e-01     2.5000e+00             1.0105e-03       -22.329975369679  <--
     1.0000e+00     1.0000e+01             3.6311e-04       -22.329942160489

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.7763e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_001                -7.002660e-01 3 1  ON 0
ci_002                -6.998547e-01 3 1  ON 1
ci_003                -6.035725e-02 3 1  ON 2
ci_004                -6.178145e-02 3 1  ON 3
ci_005                 4.534634e-02 3 1  ON 4
ci_006                 4.609160e-02 3 1  ON 5
ci_007                 3.150114e-02 3 1  ON 6
ci_008                 3.228073e-02 3 1  ON 7
ci_009                -2.544294e-02 3 1  ON 8
ci_010                -2.545456e-02 3 1  ON 9
ci_011                -2.254872e-02 3 1  ON 10
ci_012                -2.252819e-02 3 1  ON 11
ci_013                 1.989794e-02 3 1  ON 12
ci_014                 1.986963e-02 3 1  ON 13
ci_015                 2.062072e-02 3 1  ON 14
ci_016                 2.000657e-02 3 1  ON 15
ci_017                 1.601479e-02 3 1  ON 16
ci_018                 1.601362e-02 3 1  ON 17
ci_019                 9.600066e-03 3 1  ON 18
ci_020                 9.976938e-03 3 1  ON 19
ci_021                -1.095345e-02 3 1  ON 20
ci_022                -1.068490e-02 3 1  ON 21
ci_023                 8.619201e-03 3 1  ON 22
ci_024                 8.024455e-03 3 1  ON 23
ci_025                 8.211477e-03 3 1  ON 24
ci_026                 8.095557e-03 3 1  ON 25
ci_027                 8.757387e-03 3 1  ON 26
ci_028                 7.790247e-03 3 1  ON 27
ci_029                -7.461180e-03 3 1  ON 28
ci_030                -8.219466e-03 3 1  ON 29
ci_031                -8.161778e-03 3 1  ON 30
ci_032                -7.274149e-03 3 1  ON 31
ci_033                 7.348969e-03 3 1  ON 32
ci_034                 7.188132e-03 3 1  ON 33
ci_035                 6.698561e-03 3 1  ON 34
ci_036                 6.746773e-03 3 1  ON 35
ci_037                 6.557868e-03 3 1  ON 36
ci_038                 6.260845e-03 3 1  ON 37
ci_039                 5.526129e-03 3 1  ON 38
ci_040                 6.083929e-03 3 1  ON 39
ci_041                 4.847913e-03 3 1  ON 40
ci_042                 4.628053e-03 3 1  ON 41
ci_043                 5.023952e-03 3 1  ON 42
ci_044                 5.306027e-03 3 1  ON 43
ci_045                 5.500790e-03 3 1  ON 44
ci_046                 5.269002e-03 3 1  ON 45
ci_047                -4.263714e-03 3 1  ON 46
ci_048                -4.617020e-03 3 1  ON 47
ci_049                 2.898395e-03 3 1  ON 48
ci_050                 3.083077e-03 3 1  ON 49
ci_051                -2.589091e-03 3 1  ON 50
ci_052                -3.064031e-03 3 1  ON 51
ci_053                -2.054945e-03 3 1  ON 52
ci_054                -2.594240e-03 3 1  ON 53
ci_055                -2.386709e-03 3 1  ON 54
ci_056                -2.733078e-03 3 1  ON 55
ci_057                -1.502195e-03 3 1  ON 56
ci_058                -1.244938e-03 3 1  ON 57
ci_059                -2.295235e-03 3 1  ON 58
ci_060                -2.162658e-03 3 1  ON 59
ci_061                -1.040091e-03 3 1  ON 60
ci_062                -2.178869e-03 3 1  ON 61
ci_063                -1.763923e-03 3 1  ON 62
ci_064                -8.707261e-04 3 1  ON 63
ci_065                -1.826823e-03 3 1  ON 64
ci_066                -1.946595e-03 3 1  ON 65
ci_067                -8.760351e-04 3 1  ON 66
ci_068                -7.912194e-04 3 1  ON 67
ci_069                 1.518437e-03 3 1  ON 68
ci_070                 1.529600e-03 3 1  ON 69
ci_071                -1.406445e-03 3 1  ON 70
ci_072                -9.929245e-04 3 1  ON 71
ci_073                 1.321220e-03 3 1  ON 72
ci_074                 1.476076e-03 3 1  ON 73
ci_075                -9.028825e-04 3 1  ON 74
ci_076                -1.925835e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7833e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2120e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.2013
    reference variance = 2.98527
====================================================
  Execution time = 2.4135e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0312e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7066e+00
  Total weights = 1.949775690e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8603e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757442441263
                                         uncertainty =       0.033335234965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757442441263
                                         uncertainty =       0.033335234965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370641164
  error estimate for blocks of size 2^( 2) =       0.001442062501
  error estimate for blocks of size 2^( 3) =       0.001505579685
  error estimate for blocks of size 2^( 4) =       0.001547203603
  error estimate for blocks of size 2^( 5) =       0.001573146611
  error estimate for blocks of size 2^( 6) =       0.001582692838
  error estimate for blocks of size 2^( 7) =       0.001593503773

      target function =                  N/A
              le_mean =     -22.329128738129
             les_mean =     502.296605244073
             stat err =       0.001574136706
             autocorr =       1.318977388944
              std dev =       1.938410337330
             le_variance =       3.757434635866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232912873813e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329128737320       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329193365912       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329201653415       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329203106633       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329205529226       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329205595753       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.329205688583       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 3.136189e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329128737320       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329166331543       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329168019491       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329167948970       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329168054063       residual = 9.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 8.259837e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329128737320       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329142800534       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329142975588       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.305031e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107181 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0007e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_001                -6.995424e-01 3 1  ON 0
ci_002                -7.006807e-01 3 1  ON 1
ci_003                -6.078404e-02 3 1  ON 2
ci_004                -6.170084e-02 3 1  ON 3
ci_005                 4.497649e-02 3 1  ON 4
ci_006                 4.582158e-02 3 1  ON 5
ci_007                 3.130074e-02 3 1  ON 6
ci_008                 3.164824e-02 3 1  ON 7
ci_009                -2.493156e-02 3 1  ON 8
ci_010                -2.522873e-02 3 1  ON 9
ci_011                -2.205175e-02 3 1  ON 10
ci_012                -2.197245e-02 3 1  ON 11
ci_013                 1.980570e-02 3 1  ON 12
ci_014                 2.018992e-02 3 1  ON 13
ci_015                 2.130537e-02 3 1  ON 14
ci_016                 1.976792e-02 3 1  ON 15
ci_017                 1.644354e-02 3 1  ON 16
ci_018                 1.619026e-02 3 1  ON 17
ci_019                 1.010422e-02 3 1  ON 18
ci_020                 1.000874e-02 3 1  ON 19
ci_021                -1.083162e-02 3 1  ON 20
ci_022                -1.083200e-02 3 1  ON 21
ci_023                 8.510821e-03 3 1  ON 22
ci_024                 8.090317e-03 3 1  ON 23
ci_025                 8.049789e-03 3 1  ON 24
ci_026                 8.357315e-03 3 1  ON 25
ci_027                 7.969882e-03 3 1  ON 26
ci_028                 7.479994e-03 3 1  ON 27
ci_029                -7.361177e-03 3 1  ON 28
ci_030                -7.716162e-03 3 1  ON 29
ci_031                -8.035094e-03 3 1  ON 30
ci_032                -6.933624e-03 3 1  ON 31
ci_033                 7.281407e-03 3 1  ON 32
ci_034                 7.678257e-03 3 1  ON 33
ci_035                 6.677490e-03 3 1  ON 34
ci_036                 6.864574e-03 3 1  ON 35
ci_037                 6.820676e-03 3 1  ON 36
ci_038                 5.817032e-03 3 1  ON 37
ci_039                 5.651263e-03 3 1  ON 38
ci_040                 5.824196e-03 3 1  ON 39
ci_041                 5.566721e-03 3 1  ON 40
ci_042                 4.501969e-03 3 1  ON 41
ci_043                 5.437420e-03 3 1  ON 42
ci_044                 4.957509e-03 3 1  ON 43
ci_045                 5.375750e-03 3 1  ON 44
ci_046                 4.625490e-03 3 1  ON 45
ci_047                -4.183785e-03 3 1  ON 46
ci_048                -4.488170e-03 3 1  ON 47
ci_049                 3.023269e-03 3 1  ON 48
ci_050                 3.160290e-03 3 1  ON 49
ci_051                -2.156949e-03 3 1  ON 50
ci_052                -2.327268e-03 3 1  ON 51
ci_053                -2.145124e-03 3 1  ON 52
ci_054                -2.809925e-03 3 1  ON 53
ci_055                -2.557713e-03 3 1  ON 54
ci_056                -2.133989e-03 3 1  ON 55
ci_057                -1.528163e-03 3 1  ON 56
ci_058                -1.856388e-03 3 1  ON 57
ci_059                -1.778728e-03 3 1  ON 58
ci_060                -2.741848e-03 3 1  ON 59
ci_061                -1.066767e-03 3 1  ON 60
ci_062                -1.798433e-03 3 1  ON 61
ci_063                -1.879024e-03 3 1  ON 62
ci_064                -7.197278e-04 3 1  ON 63
ci_065                -1.700519e-03 3 1  ON 64
ci_066                -1.921111e-03 3 1  ON 65
ci_067                -1.072978e-03 3 1  ON 66
ci_068                -5.490958e-04 3 1  ON 67
ci_069                 8.677930e-04 3 1  ON 68
ci_070                 1.393557e-03 3 1  ON 69
ci_071                -1.503198e-03 3 1  ON 70
ci_072                -8.823813e-04 3 1  ON 71
ci_073                 1.472174e-03 3 1  ON 72
ci_074                 1.202913e-03 3 1  ON 73
ci_075                -9.196496e-04 3 1  ON 74
ci_076                -1.708559e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.1486
    reference variance = 5.17144
====================================================
  Execution time = 2.3539e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7966e+00
  Total weights = 1.9500e+06
  Execution time = 4.3552e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.849154380009
                                         uncertainty =       0.056730294534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.849154380009
                                         uncertainty =       0.056730294534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387322411
  error estimate for blocks of size 2^( 2) =       0.001458514076
  error estimate for blocks of size 2^( 3) =       0.001522506719
  error estimate for blocks of size 2^( 4) =       0.001564394143
  error estimate for blocks of size 2^( 5) =       0.001588228309
  error estimate for blocks of size 2^( 6) =       0.001596949660
  error estimate for blocks of size 2^( 7) =       0.001597380460

      target function =                  N/A
              le_mean =     -22.325026525128
             les_mean =     502.211071813233
             stat err =       0.001586738143
             autocorr =       1.308144498489
              std dev =       1.962001560761
             le_variance =       3.849450124427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.849402398683
                                         uncertainty =       0.056743541479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.849402398683
                                         uncertainty =       0.056743541479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387366691
  error estimate for blocks of size 2^( 2) =       0.001458587415
  error estimate for blocks of size 2^( 3) =       0.001522630929
  error estimate for blocks of size 2^( 4) =       0.001564532524
  error estimate for blocks of size 2^( 5) =       0.001588409487
  error estimate for blocks of size 2^( 6) =       0.001597126137
  error estimate for blocks of size 2^( 7) =       0.001597519968

      target function =                  N/A
              le_mean =     -22.325027556408
             les_mean =     502.347833391374
             stat err =       0.001586897029
             autocorr =       1.308322972470
              std dev =       1.962064183248
             le_variance =       3.849695859185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.849767487873
                                         uncertainty =       0.056741903888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.849767487873
                                         uncertainty =       0.056741903888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387432251
  error estimate for blocks of size 2^( 2) =       0.001458657751
  error estimate for blocks of size 2^( 3) =       0.001522710365
  error estimate for blocks of size 2^( 4) =       0.001564602483
  error estimate for blocks of size 2^( 5) =       0.001588474408
  error estimate for blocks of size 2^( 6) =       0.001597191221
  error estimate for blocks of size 2^( 7) =       0.001597584540

      target function =                  N/A
              le_mean =     -22.325031133091
             les_mean =     502.206330235761
             stat err =       0.001586963163
             autocorr =       1.308308372040
              std dev =       1.962156900646
             le_variance =       3.850059702753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.849194906846
                                         uncertainty =       0.056731121142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.849194906846
                                         uncertainty =       0.056731121142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387329589
  error estimate for blocks of size 2^( 2) =       0.001458548207
  error estimate for blocks of size 2^( 3) =       0.001522551415
  error estimate for blocks of size 2^( 4) =       0.001564436866
  error estimate for blocks of size 2^( 5) =       0.001588288223
  error estimate for blocks of size 2^( 6) =       0.001596994733
  error estimate for blocks of size 2^( 7) =       0.001597396855

      target function =                  N/A
              le_mean =     -22.325015357682
             les_mean =     502.215966526921
             stat err =       0.001586779169
             autocorr =       1.308198609546
              std dev =       1.962011711451
             le_variance =       3.849489955870


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325026525128        initial
     6.2500e-02     6.2500e-01             3.1362e-03       -22.325027556408
     2.5000e-01     2.5000e+00             8.2598e-04       -22.325031133091  <--
     1.0000e+00     1.0000e+01             3.3050e-04       -22.325015357682

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.5401e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_001                -6.995424e-01 3 1  ON 0
ci_002                -7.006807e-01 3 1  ON 1
ci_003                -6.078404e-02 3 1  ON 2
ci_004                -6.170084e-02 3 1  ON 3
ci_005                 4.497649e-02 3 1  ON 4
ci_006                 4.582158e-02 3 1  ON 5
ci_007                 3.130074e-02 3 1  ON 6
ci_008                 3.164824e-02 3 1  ON 7
ci_009                -2.493156e-02 3 1  ON 8
ci_010                -2.522873e-02 3 1  ON 9
ci_011                -2.205175e-02 3 1  ON 10
ci_012                -2.197245e-02 3 1  ON 11
ci_013                 1.980570e-02 3 1  ON 12
ci_014                 2.018992e-02 3 1  ON 13
ci_015                 2.130537e-02 3 1  ON 14
ci_016                 1.976792e-02 3 1  ON 15
ci_017                 1.644354e-02 3 1  ON 16
ci_018                 1.619026e-02 3 1  ON 17
ci_019                 1.010422e-02 3 1  ON 18
ci_020                 1.000874e-02 3 1  ON 19
ci_021                -1.083162e-02 3 1  ON 20
ci_022                -1.083200e-02 3 1  ON 21
ci_023                 8.510821e-03 3 1  ON 22
ci_024                 8.090317e-03 3 1  ON 23
ci_025                 8.049789e-03 3 1  ON 24
ci_026                 8.357315e-03 3 1  ON 25
ci_027                 7.969882e-03 3 1  ON 26
ci_028                 7.479994e-03 3 1  ON 27
ci_029                -7.361177e-03 3 1  ON 28
ci_030                -7.716162e-03 3 1  ON 29
ci_031                -8.035094e-03 3 1  ON 30
ci_032                -6.933624e-03 3 1  ON 31
ci_033                 7.281407e-03 3 1  ON 32
ci_034                 7.678257e-03 3 1  ON 33
ci_035                 6.677490e-03 3 1  ON 34
ci_036                 6.864574e-03 3 1  ON 35
ci_037                 6.820676e-03 3 1  ON 36
ci_038                 5.817032e-03 3 1  ON 37
ci_039                 5.651263e-03 3 1  ON 38
ci_040                 5.824196e-03 3 1  ON 39
ci_041                 5.566721e-03 3 1  ON 40
ci_042                 4.501969e-03 3 1  ON 41
ci_043                 5.437420e-03 3 1  ON 42
ci_044                 4.957509e-03 3 1  ON 43
ci_045                 5.375750e-03 3 1  ON 44
ci_046                 4.625490e-03 3 1  ON 45
ci_047                -4.183785e-03 3 1  ON 46
ci_048                -4.488170e-03 3 1  ON 47
ci_049                 3.023269e-03 3 1  ON 48
ci_050                 3.160290e-03 3 1  ON 49
ci_051                -2.156949e-03 3 1  ON 50
ci_052                -2.327268e-03 3 1  ON 51
ci_053                -2.145124e-03 3 1  ON 52
ci_054                -2.809925e-03 3 1  ON 53
ci_055                -2.557713e-03 3 1  ON 54
ci_056                -2.133989e-03 3 1  ON 55
ci_057                -1.528163e-03 3 1  ON 56
ci_058                -1.856388e-03 3 1  ON 57
ci_059                -1.778728e-03 3 1  ON 58
ci_060                -2.741848e-03 3 1  ON 59
ci_061                -1.066767e-03 3 1  ON 60
ci_062                -1.798433e-03 3 1  ON 61
ci_063                -1.879024e-03 3 1  ON 62
ci_064                -7.197278e-04 3 1  ON 63
ci_065                -1.700519e-03 3 1  ON 64
ci_066                -1.921111e-03 3 1  ON 65
ci_067                -1.072978e-03 3 1  ON 66
ci_068                -5.490958e-04 3 1  ON 67
ci_069                 8.677930e-04 3 1  ON 68
ci_070                 1.393557e-03 3 1  ON 69
ci_071                -1.503198e-03 3 1  ON 70
ci_072                -8.823813e-04 3 1  ON 71
ci_073                 1.472174e-03 3 1  ON 72
ci_074                 1.202913e-03 3 1  ON 73
ci_075                -9.196496e-04 3 1  ON 74
ci_076                -1.708559e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5421e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2134e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.2905
    reference variance = 2.97023
====================================================
  Execution time = 2.4191e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0316e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7729e+00
  Total weights = 1.950040029e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8905e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.824563076132
                                         uncertainty =       0.048960001562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.824563076132
                                         uncertainty =       0.048960001562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382822482
  error estimate for blocks of size 2^( 2) =       0.001454403374
  error estimate for blocks of size 2^( 3) =       0.001516180022
  error estimate for blocks of size 2^( 4) =       0.001557342372
  error estimate for blocks of size 2^( 5) =       0.001585102712
  error estimate for blocks of size 2^( 6) =       0.001602808556
  error estimate for blocks of size 2^( 7) =       0.001613488740

      target function =                  N/A
              le_mean =     -22.325574659044
             les_mean =     502.204230234377
             stat err =       0.001589685595
             autocorr =       1.321568305087
              std dev =       1.955637597730
             le_variance =       3.824518413654


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232557465904e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325574658196       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325671218307       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325675773811       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325676915791       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.325677080954       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.325676889324       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.325676944351       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 1.657867e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325574658196       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325630838796       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325631807150       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325631926773       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 8.930535e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325574658196       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325595678003       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325595802562       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.689785e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0093e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_001                -6.993811e-01 3 1  ON 0
ci_002                -7.008081e-01 3 1  ON 1
ci_003                -6.123463e-02 3 1  ON 2
ci_004                -6.215689e-02 3 1  ON 3
ci_005                 4.538150e-02 3 1  ON 4
ci_006                 4.533619e-02 3 1  ON 5
ci_007                 3.089400e-02 3 1  ON 6
ci_008                 3.133777e-02 3 1  ON 7
ci_009                -2.505375e-02 3 1  ON 8
ci_010                -2.574965e-02 3 1  ON 9
ci_011                -2.202841e-02 3 1  ON 10
ci_012                -2.192742e-02 3 1  ON 11
ci_013                 1.952390e-02 3 1  ON 12
ci_014                 2.085581e-02 3 1  ON 13
ci_015                 2.097550e-02 3 1  ON 14
ci_016                 1.974145e-02 3 1  ON 15
ci_017                 1.638285e-02 3 1  ON 16
ci_018                 1.595894e-02 3 1  ON 17
ci_019                 1.013781e-02 3 1  ON 18
ci_020                 9.767438e-03 3 1  ON 19
ci_021                -1.082234e-02 3 1  ON 20
ci_022                -1.032925e-02 3 1  ON 21
ci_023                 8.641632e-03 3 1  ON 22
ci_024                 8.803964e-03 3 1  ON 23
ci_025                 8.056131e-03 3 1  ON 24
ci_026                 8.186507e-03 3 1  ON 25
ci_027                 7.677025e-03 3 1  ON 26
ci_028                 7.737630e-03 3 1  ON 27
ci_029                -7.017617e-03 3 1  ON 28
ci_030                -7.923691e-03 3 1  ON 29
ci_031                -7.229849e-03 3 1  ON 30
ci_032                -7.186102e-03 3 1  ON 31
ci_033                 6.668413e-03 3 1  ON 32
ci_034                 7.882046e-03 3 1  ON 33
ci_035                 6.727012e-03 3 1  ON 34
ci_036                 7.025489e-03 3 1  ON 35
ci_037                 6.689608e-03 3 1  ON 36
ci_038                 6.166534e-03 3 1  ON 37
ci_039                 5.627580e-03 3 1  ON 38
ci_040                 5.569748e-03 3 1  ON 39
ci_041                 5.193971e-03 3 1  ON 40
ci_042                 4.089507e-03 3 1  ON 41
ci_043                 4.714179e-03 3 1  ON 42
ci_044                 5.183988e-03 3 1  ON 43
ci_045                 5.448811e-03 3 1  ON 44
ci_046                 4.326989e-03 3 1  ON 45
ci_047                -4.164666e-03 3 1  ON 46
ci_048                -4.608023e-03 3 1  ON 47
ci_049                 2.645030e-03 3 1  ON 48
ci_050                 3.581759e-03 3 1  ON 49
ci_051                -2.783038e-03 3 1  ON 50
ci_052                -2.793770e-03 3 1  ON 51
ci_053                -2.697313e-03 3 1  ON 52
ci_054                -2.392443e-03 3 1  ON 53
ci_055                -3.324476e-03 3 1  ON 54
ci_056                -1.467457e-03 3 1  ON 55
ci_057                -1.673042e-03 3 1  ON 56
ci_058                -2.584587e-03 3 1  ON 57
ci_059                -2.213299e-03 3 1  ON 58
ci_060                -1.848794e-03 3 1  ON 59
ci_061                -1.835567e-03 3 1  ON 60
ci_062                -2.368933e-03 3 1  ON 61
ci_063                -1.412134e-03 3 1  ON 62
ci_064                 1.560735e-04 3 1  ON 63
ci_065                -1.789450e-03 3 1  ON 64
ci_066                -1.333977e-03 3 1  ON 65
ci_067                -1.175314e-03 3 1  ON 66
ci_068                -4.212098e-04 3 1  ON 67
ci_069                 1.453142e-03 3 1  ON 68
ci_070                 1.529902e-03 3 1  ON 69
ci_071                -1.291921e-03 3 1  ON 70
ci_072                -1.211330e-03 3 1  ON 71
ci_073                 1.390004e-03 3 1  ON 72
ci_074                 8.912127e-04 3 1  ON 73
ci_075                -9.205718e-04 3 1  ON 74
ci_076                -1.146178e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.3808
    reference variance = 2.13446
====================================================
  Execution time = 2.3615e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7122e+00
  Total weights = 1.9500e+06
  Execution time = 4.3386e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763038606910
                                         uncertainty =       0.027140074694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763038606910
                                         uncertainty =       0.027140074694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371600935
  error estimate for blocks of size 2^( 2) =       0.001442139832
  error estimate for blocks of size 2^( 3) =       0.001507076548
  error estimate for blocks of size 2^( 4) =       0.001548603385
  error estimate for blocks of size 2^( 5) =       0.001572949824
  error estimate for blocks of size 2^( 6) =       0.001580533432
  error estimate for blocks of size 2^( 7) =       0.001590487812

      target function =                  N/A
              le_mean =     -22.324610739398
             les_mean =     502.101986211985
             stat err =       0.001573143614
             autocorr =       1.315470757434
              std dev =       1.939767679502
             le_variance =       3.762698650440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763028024348
                                         uncertainty =       0.027149950271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763028024348
                                         uncertainty =       0.027149950271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371598522
  error estimate for blocks of size 2^( 2) =       0.001442150715
  error estimate for blocks of size 2^( 3) =       0.001507094036
  error estimate for blocks of size 2^( 4) =       0.001548671475
  error estimate for blocks of size 2^( 5) =       0.001573041346
  error estimate for blocks of size 2^( 6) =       0.001580619150
  error estimate for blocks of size 2^( 7) =       0.001590582083

      target function =                  N/A
              le_mean =     -22.324602825047
             les_mean =     502.177532797509
             stat err =       0.001573228513
             autocorr =       1.315617377641
              std dev =       1.939764266761
             le_variance =       3.762685410604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763723958304
                                         uncertainty =       0.027126475661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763723958304
                                         uncertainty =       0.027126475661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371724751
  error estimate for blocks of size 2^( 2) =       0.001442275078
  error estimate for blocks of size 2^( 3) =       0.001507232338
  error estimate for blocks of size 2^( 4) =       0.001548810019
  error estimate for blocks of size 2^( 5) =       0.001573171654
  error estimate for blocks of size 2^( 6) =       0.001580790996
  error estimate for blocks of size 2^( 7) =       0.001590679742

      target function =                  N/A
              le_mean =     -22.324623225626
             les_mean =     503.756138042719
             stat err =       0.001573363102
             autocorr =       1.315600325867
              std dev =       1.939942784737
             le_variance =       3.763378008055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762960944152
                                         uncertainty =       0.027140815963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762960944152
                                         uncertainty =       0.027140815963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371586710
  error estimate for blocks of size 2^( 2) =       0.001442130138
  error estimate for blocks of size 2^( 3) =       0.001507068986
  error estimate for blocks of size 2^( 4) =       0.001548601854
  error estimate for blocks of size 2^( 5) =       0.001572948135
  error estimate for blocks of size 2^( 6) =       0.001580535641
  error estimate for blocks of size 2^( 7) =       0.001590482188

      target function =                  N/A
              le_mean =     -22.324597376010
             les_mean =     502.103049537980
             stat err =       0.001573141954
             autocorr =       1.315495268183
              std dev =       1.939747562531
             le_variance =       3.762620606344


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.324610739398        initial
     6.2500e-02     6.2500e-01             1.6579e-03       -22.324602825047
     2.5000e-01     2.5000e+00             8.9305e-04       -22.324623225626  <--
     1.0000e+00     1.0000e+01             3.6898e-04       -22.324597376010

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.5408e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_001                -6.993811e-01 3 1  ON 0
ci_002                -7.008081e-01 3 1  ON 1
ci_003                -6.123463e-02 3 1  ON 2
ci_004                -6.215689e-02 3 1  ON 3
ci_005                 4.538150e-02 3 1  ON 4
ci_006                 4.533619e-02 3 1  ON 5
ci_007                 3.089400e-02 3 1  ON 6
ci_008                 3.133777e-02 3 1  ON 7
ci_009                -2.505375e-02 3 1  ON 8
ci_010                -2.574965e-02 3 1  ON 9
ci_011                -2.202841e-02 3 1  ON 10
ci_012                -2.192742e-02 3 1  ON 11
ci_013                 1.952390e-02 3 1  ON 12
ci_014                 2.085581e-02 3 1  ON 13
ci_015                 2.097550e-02 3 1  ON 14
ci_016                 1.974145e-02 3 1  ON 15
ci_017                 1.638285e-02 3 1  ON 16
ci_018                 1.595894e-02 3 1  ON 17
ci_019                 1.013781e-02 3 1  ON 18
ci_020                 9.767438e-03 3 1  ON 19
ci_021                -1.082234e-02 3 1  ON 20
ci_022                -1.032925e-02 3 1  ON 21
ci_023                 8.641632e-03 3 1  ON 22
ci_024                 8.803964e-03 3 1  ON 23
ci_025                 8.056131e-03 3 1  ON 24
ci_026                 8.186507e-03 3 1  ON 25
ci_027                 7.677025e-03 3 1  ON 26
ci_028                 7.737630e-03 3 1  ON 27
ci_029                -7.017617e-03 3 1  ON 28
ci_030                -7.923691e-03 3 1  ON 29
ci_031                -7.229849e-03 3 1  ON 30
ci_032                -7.186102e-03 3 1  ON 31
ci_033                 6.668413e-03 3 1  ON 32
ci_034                 7.882046e-03 3 1  ON 33
ci_035                 6.727012e-03 3 1  ON 34
ci_036                 7.025489e-03 3 1  ON 35
ci_037                 6.689608e-03 3 1  ON 36
ci_038                 6.166534e-03 3 1  ON 37
ci_039                 5.627580e-03 3 1  ON 38
ci_040                 5.569748e-03 3 1  ON 39
ci_041                 5.193971e-03 3 1  ON 40
ci_042                 4.089507e-03 3 1  ON 41
ci_043                 4.714179e-03 3 1  ON 42
ci_044                 5.183988e-03 3 1  ON 43
ci_045                 5.448811e-03 3 1  ON 44
ci_046                 4.326989e-03 3 1  ON 45
ci_047                -4.164666e-03 3 1  ON 46
ci_048                -4.608023e-03 3 1  ON 47
ci_049                 2.645030e-03 3 1  ON 48
ci_050                 3.581759e-03 3 1  ON 49
ci_051                -2.783038e-03 3 1  ON 50
ci_052                -2.793770e-03 3 1  ON 51
ci_053                -2.697313e-03 3 1  ON 52
ci_054                -2.392443e-03 3 1  ON 53
ci_055                -3.324476e-03 3 1  ON 54
ci_056                -1.467457e-03 3 1  ON 55
ci_057                -1.673042e-03 3 1  ON 56
ci_058                -2.584587e-03 3 1  ON 57
ci_059                -2.213299e-03 3 1  ON 58
ci_060                -1.848794e-03 3 1  ON 59
ci_061                -1.835567e-03 3 1  ON 60
ci_062                -2.368933e-03 3 1  ON 61
ci_063                -1.412134e-03 3 1  ON 62
ci_064                 1.560735e-04 3 1  ON 63
ci_065                -1.789450e-03 3 1  ON 64
ci_066                -1.333977e-03 3 1  ON 65
ci_067                -1.175314e-03 3 1  ON 66
ci_068                -4.212098e-04 3 1  ON 67
ci_069                 1.453142e-03 3 1  ON 68
ci_070                 1.529902e-03 3 1  ON 69
ci_071                -1.291921e-03 3 1  ON 70
ci_072                -1.211330e-03 3 1  ON 71
ci_073                 1.390004e-03 3 1  ON 72
ci_074                 8.912127e-04 3 1  ON 73
ci_075                -9.205718e-04 3 1  ON 74
ci_076                -1.146178e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5514e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2174e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.3637
    reference variance = 2.23707
====================================================
  Execution time = 2.4181e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0336e+04
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.6722e+00
  Total weights = 1.950036099e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8587e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.723422946782
                                         uncertainty =       0.021391314549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.723422946782
                                         uncertainty =       0.021391314549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364329857
  error estimate for blocks of size 2^( 2) =       0.001436880162
  error estimate for blocks of size 2^( 3) =       0.001500977955
  error estimate for blocks of size 2^( 4) =       0.001544329264
  error estimate for blocks of size 2^( 5) =       0.001571940314
  error estimate for blocks of size 2^( 6) =       0.001585115748
  error estimate for blocks of size 2^( 7) =       0.001587050661

      target function =                  N/A
              le_mean =     -22.330653952661
             les_mean =     502.330344473945
             stat err =       0.001572108997
             autocorr =       1.327781274015
              std dev =       1.929484658755
             le_variance =       3.722911048371


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233065395266e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330653951860       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330744347805       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330753585554       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330754438041       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.330755746369       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.330755541061       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.330755392499       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 1.851081e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330653951860       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330706280387       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330708292184       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330708273393       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.330708333859       residual = 6.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 9.308581e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330653951860       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330673444707       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330673612865       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.654194e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115073 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0051e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_001                -6.997799e-01 3 1  ON 0
ci_002                -7.003693e-01 3 1  ON 1
ci_003                -6.118031e-02 3 1  ON 2
ci_004                -6.190530e-02 3 1  ON 3
ci_005                 4.561332e-02 3 1  ON 4
ci_006                 4.548938e-02 3 1  ON 5
ci_007                 3.144460e-02 3 1  ON 6
ci_008                 3.196499e-02 3 1  ON 7
ci_009                -2.538285e-02 3 1  ON 8
ci_010                -2.514261e-02 3 1  ON 9
ci_011                -2.289797e-02 3 1  ON 10
ci_012                -2.207991e-02 3 1  ON 11
ci_013                 1.983890e-02 3 1  ON 12
ci_014                 2.130140e-02 3 1  ON 13
ci_015                 2.007656e-02 3 1  ON 14
ci_016                 2.020506e-02 3 1  ON 15
ci_017                 1.623892e-02 3 1  ON 16
ci_018                 1.575629e-02 3 1  ON 17
ci_019                 1.061527e-02 3 1  ON 18
ci_020                 9.699898e-03 3 1  ON 19
ci_021                -9.957808e-03 3 1  ON 20
ci_022                -1.033888e-02 3 1  ON 21
ci_023                 8.364151e-03 3 1  ON 22
ci_024                 8.406339e-03 3 1  ON 23
ci_025                 8.078887e-03 3 1  ON 24
ci_026                 8.735678e-03 3 1  ON 25
ci_027                 7.895068e-03 3 1  ON 26
ci_028                 7.581412e-03 3 1  ON 27
ci_029                -7.005213e-03 3 1  ON 28
ci_030                -7.685882e-03 3 1  ON 29
ci_031                -7.959549e-03 3 1  ON 30
ci_032                -6.571826e-03 3 1  ON 31
ci_033                 7.202733e-03 3 1  ON 32
ci_034                 7.854692e-03 3 1  ON 33
ci_035                 6.497981e-03 3 1  ON 34
ci_036                 6.677135e-03 3 1  ON 35
ci_037                 6.133492e-03 3 1  ON 36
ci_038                 5.908623e-03 3 1  ON 37
ci_039                 5.252478e-03 3 1  ON 38
ci_040                 5.655558e-03 3 1  ON 39
ci_041                 4.840025e-03 3 1  ON 40
ci_042                 5.020365e-03 3 1  ON 41
ci_043                 4.263909e-03 3 1  ON 42
ci_044                 5.869610e-03 3 1  ON 43
ci_045                 4.803854e-03 3 1  ON 44
ci_046                 4.550048e-03 3 1  ON 45
ci_047                -4.157961e-03 3 1  ON 46
ci_048                -4.199002e-03 3 1  ON 47
ci_049                 2.669145e-03 3 1  ON 48
ci_050                 3.844319e-03 3 1  ON 49
ci_051                -2.596528e-03 3 1  ON 50
ci_052                -2.176043e-03 3 1  ON 51
ci_053                -2.477325e-03 3 1  ON 52
ci_054                -2.333367e-03 3 1  ON 53
ci_055                -2.831881e-03 3 1  ON 54
ci_056                -1.491317e-03 3 1  ON 55
ci_057                -2.098428e-03 3 1  ON 56
ci_058                -2.612669e-03 3 1  ON 57
ci_059                -1.787659e-03 3 1  ON 58
ci_060                -2.012195e-03 3 1  ON 59
ci_061                -1.728031e-03 3 1  ON 60
ci_062                -2.378447e-03 3 1  ON 61
ci_063                -1.269833e-03 3 1  ON 62
ci_064                 3.211732e-05 3 1  ON 63
ci_065                -1.420155e-03 3 1  ON 64
ci_066                -8.468004e-04 3 1  ON 65
ci_067                -1.408077e-03 3 1  ON 66
ci_068                -5.363064e-04 3 1  ON 67
ci_069                 1.247127e-03 3 1  ON 68
ci_070                 1.434546e-03 3 1  ON 69
ci_071                -1.301737e-03 3 1  ON 70
ci_072                -6.933358e-04 3 1  ON 71
ci_073                 1.059435e-03 3 1  ON 72
ci_074                 1.360747e-03 3 1  ON 73
ci_075                -1.183458e-03 3 1  ON 74
ci_076                -6.981759e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.2114
    reference variance = 3.68415
====================================================
  Execution time = 2.3529e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7012e+00
  Total weights = 1.9502e+06
  Execution time = 4.3547e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0213733
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753618077052
                                         uncertainty =       0.040545710182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753618077052
                                         uncertainty =       0.040545710182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369893683
  error estimate for blocks of size 2^( 2) =       0.001441734343
  error estimate for blocks of size 2^( 3) =       0.001505026641
  error estimate for blocks of size 2^( 4) =       0.001546986388
  error estimate for blocks of size 2^( 5) =       0.001572067614
  error estimate for blocks of size 2^( 6) =       0.001582099814
  error estimate for blocks of size 2^( 7) =       0.001578969587

      target function =                  N/A
              le_mean =     -22.328236850795
             les_mean =     517.049653872534
             stat err =       0.001570030851
             autocorr =       1.313538015151
              std dev =       1.937353223010
             le_variance =       3.753337510706

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0238899
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751665759845
                                         uncertainty =       0.040484944347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751665759845
                                         uncertainty =       0.040484944347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369537812
  error estimate for blocks of size 2^( 2) =       0.001441395928
  error estimate for blocks of size 2^( 3) =       0.001504646108
  error estimate for blocks of size 2^( 4) =       0.001546588927
  error estimate for blocks of size 2^( 5) =       0.001571644168
  error estimate for blocks of size 2^( 6) =       0.001581622164
  error estimate for blocks of size 2^( 7) =       0.001578540954

      target function =                  N/A
              le_mean =     -22.328212017910
             les_mean =     502.257177618975
             stat err =       0.001569599053
             autocorr =       1.313497957044
              std dev =       1.936849936336
             le_variance =       3.751387675884

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0208731
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751775002560
                                         uncertainty =       0.040480190056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751775002560
                                         uncertainty =       0.040480190056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369557848
  error estimate for blocks of size 2^( 2) =       0.001441406012
  error estimate for blocks of size 2^( 3) =       0.001504645584
  error estimate for blocks of size 2^( 4) =       0.001546583082
  error estimate for blocks of size 2^( 5) =       0.001571644310
  error estimate for blocks of size 2^( 6) =       0.001581620269
  error estimate for blocks of size 2^( 7) =       0.001578526957

      target function =                  N/A
              le_mean =     -22.328215681731
             les_mean =     502.280604093992
             stat err =       0.001569593655
             autocorr =       1.313450489907
              std dev =       1.936878272466
             le_variance =       3.751497442352

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.1168
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751821127558
                                         uncertainty =       0.040472478883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751821127558
                                         uncertainty =       0.040472478883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369565897
  error estimate for blocks of size 2^( 2) =       0.001441442162
  error estimate for blocks of size 2^( 3) =       0.001504711134
  error estimate for blocks of size 2^( 4) =       0.001546652302
  error estimate for blocks of size 2^( 5) =       0.001571696589
  error estimate for blocks of size 2^( 6) =       0.001581630009
  error estimate for blocks of size 2^( 7) =       0.001578536381

      target function =                  N/A
              le_mean =     -22.328201644897
             les_mean =     502.250500066045
             stat err =       0.001569628820
             autocorr =       1.313493905008
              std dev =       1.936889656100
             le_variance =       3.751541539907


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328236850795        initial  <--
     6.2500e-02     6.2500e-01             1.8511e-03       -22.328212017910
     2.5000e-01     2.5000e+00             9.3086e-04       -22.328215681731
     1.0000e+00     1.0000e+01             3.6542e-04       -22.328201644897

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4212
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_001                -6.993811e-01 3 1  ON 0
ci_002                -7.008081e-01 3 1  ON 1
ci_003                -6.123463e-02 3 1  ON 2
ci_004                -6.215689e-02 3 1  ON 3
ci_005                 4.538150e-02 3 1  ON 4
ci_006                 4.533619e-02 3 1  ON 5
ci_007                 3.089400e-02 3 1  ON 6
ci_008                 3.133777e-02 3 1  ON 7
ci_009                -2.505375e-02 3 1  ON 8
ci_010                -2.574965e-02 3 1  ON 9
ci_011                -2.202841e-02 3 1  ON 10
ci_012                -2.192742e-02 3 1  ON 11
ci_013                 1.952390e-02 3 1  ON 12
ci_014                 2.085581e-02 3 1  ON 13
ci_015                 2.097550e-02 3 1  ON 14
ci_016                 1.974145e-02 3 1  ON 15
ci_017                 1.638285e-02 3 1  ON 16
ci_018                 1.595894e-02 3 1  ON 17
ci_019                 1.013781e-02 3 1  ON 18
ci_020                 9.767438e-03 3 1  ON 19
ci_021                -1.082234e-02 3 1  ON 20
ci_022                -1.032925e-02 3 1  ON 21
ci_023                 8.641632e-03 3 1  ON 22
ci_024                 8.803964e-03 3 1  ON 23
ci_025                 8.056131e-03 3 1  ON 24
ci_026                 8.186507e-03 3 1  ON 25
ci_027                 7.677025e-03 3 1  ON 26
ci_028                 7.737630e-03 3 1  ON 27
ci_029                -7.017617e-03 3 1  ON 28
ci_030                -7.923691e-03 3 1  ON 29
ci_031                -7.229849e-03 3 1  ON 30
ci_032                -7.186102e-03 3 1  ON 31
ci_033                 6.668413e-03 3 1  ON 32
ci_034                 7.882046e-03 3 1  ON 33
ci_035                 6.727012e-03 3 1  ON 34
ci_036                 7.025489e-03 3 1  ON 35
ci_037                 6.689608e-03 3 1  ON 36
ci_038                 6.166534e-03 3 1  ON 37
ci_039                 5.627580e-03 3 1  ON 38
ci_040                 5.569748e-03 3 1  ON 39
ci_041                 5.193971e-03 3 1  ON 40
ci_042                 4.089507e-03 3 1  ON 41
ci_043                 4.714179e-03 3 1  ON 42
ci_044                 5.183988e-03 3 1  ON 43
ci_045                 5.448811e-03 3 1  ON 44
ci_046                 4.326989e-03 3 1  ON 45
ci_047                -4.164666e-03 3 1  ON 46
ci_048                -4.608023e-03 3 1  ON 47
ci_049                 2.645030e-03 3 1  ON 48
ci_050                 3.581759e-03 3 1  ON 49
ci_051                -2.783038e-03 3 1  ON 50
ci_052                -2.793770e-03 3 1  ON 51
ci_053                -2.697313e-03 3 1  ON 52
ci_054                -2.392443e-03 3 1  ON 53
ci_055                -3.324476e-03 3 1  ON 54
ci_056                -1.467457e-03 3 1  ON 55
ci_057                -1.673042e-03 3 1  ON 56
ci_058                -2.584587e-03 3 1  ON 57
ci_059                -2.213299e-03 3 1  ON 58
ci_060                -1.848794e-03 3 1  ON 59
ci_061                -1.835567e-03 3 1  ON 60
ci_062                -2.368933e-03 3 1  ON 61
ci_063                -1.412134e-03 3 1  ON 62
ci_064                 1.560735e-04 3 1  ON 63
ci_065                -1.789450e-03 3 1  ON 64
ci_066                -1.333977e-03 3 1  ON 65
ci_067                -1.175314e-03 3 1  ON 66
ci_068                -4.212098e-04 3 1  ON 67
ci_069                 1.453142e-03 3 1  ON 68
ci_070                 1.529902e-03 3 1  ON 69
ci_071                -1.291921e-03 3 1  ON 70
ci_072                -1.211330e-03 3 1  ON 71
ci_073                 1.390004e-03 3 1  ON 72
ci_074                 8.912127e-04 3 1  ON 73
ci_075                -9.205718e-04 3 1  ON 74
ci_076                -1.146178e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5486e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2193e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.443
    reference variance = 2.85302
====================================================
  Execution time = 2.4340e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0304e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7543e+00
  Total weights = 1.949857172e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3601e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.808405631379
                                         uncertainty =       0.043747451767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.808405631379
                                         uncertainty =       0.043747451767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379890435
  error estimate for blocks of size 2^( 2) =       0.001449696337
  error estimate for blocks of size 2^( 3) =       0.001513209008
  error estimate for blocks of size 2^( 4) =       0.001555022915
  error estimate for blocks of size 2^( 5) =       0.001580771672
  error estimate for blocks of size 2^( 6) =       0.001598427899
  error estimate for blocks of size 2^( 7) =       0.001604860927

      target function =                  N/A
              le_mean =     -22.327551500131
             les_mean =     502.273895990690
             stat err =       0.001584770853
             autocorr =       1.318996800329
              std dev =       1.951490990312
             le_variance =       3.808317085270


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232755150013e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327551499364       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327579833742       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327580233522       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327580191913       residual = 1.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 7.140264e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327551499364       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327559959525       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327559983767       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 2.024475e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327551499364       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327553722405       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327553723962       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 5.239342e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118549 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3178e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_001                -6.994025e-01 3 1  ON 0
ci_002                -7.007862e-01 3 1  ON 1
ci_003                -6.129505e-02 3 1  ON 2
ci_004                -6.207157e-02 3 1  ON 3
ci_005                 4.537979e-02 3 1  ON 4
ci_006                 4.538344e-02 3 1  ON 5
ci_007                 3.097143e-02 3 1  ON 6
ci_008                 3.125433e-02 3 1  ON 7
ci_009                -2.506585e-02 3 1  ON 8
ci_010                -2.573870e-02 3 1  ON 9
ci_011                -2.216914e-02 3 1  ON 10
ci_012                -2.188373e-02 3 1  ON 11
ci_013                 1.954798e-02 3 1  ON 12
ci_014                 2.088372e-02 3 1  ON 13
ci_015                 2.103599e-02 3 1  ON 14
ci_016                 1.968780e-02 3 1  ON 15
ci_017                 1.643627e-02 3 1  ON 16
ci_018                 1.593225e-02 3 1  ON 17
ci_019                 1.012592e-02 3 1  ON 18
ci_020                 9.764936e-03 3 1  ON 19
ci_021                -1.061989e-02 3 1  ON 20
ci_022                -1.034415e-02 3 1  ON 21
ci_023                 8.647173e-03 3 1  ON 22
ci_024                 8.841265e-03 3 1  ON 23
ci_025                 8.023143e-03 3 1  ON 24
ci_026                 8.231552e-03 3 1  ON 25
ci_027                 7.714537e-03 3 1  ON 26
ci_028                 7.793502e-03 3 1  ON 27
ci_029                -7.001983e-03 3 1  ON 28
ci_030                -7.747711e-03 3 1  ON 29
ci_031                -7.302070e-03 3 1  ON 30
ci_032                -7.158439e-03 3 1  ON 31
ci_033                 6.763581e-03 3 1  ON 32
ci_034                 7.860589e-03 3 1  ON 33
ci_035                 6.616032e-03 3 1  ON 34
ci_036                 7.029456e-03 3 1  ON 35
ci_037                 6.642343e-03 3 1  ON 36
ci_038                 6.150213e-03 3 1  ON 37
ci_039                 5.655665e-03 3 1  ON 38
ci_040                 5.475935e-03 3 1  ON 39
ci_041                 5.233765e-03 3 1  ON 40
ci_042                 4.101474e-03 3 1  ON 41
ci_043                 4.724132e-03 3 1  ON 42
ci_044                 5.144907e-03 3 1  ON 43
ci_045                 5.307813e-03 3 1  ON 44
ci_046                 4.364047e-03 3 1  ON 45
ci_047                -4.199471e-03 3 1  ON 46
ci_048                -4.600694e-03 3 1  ON 47
ci_049                 2.677243e-03 3 1  ON 48
ci_050                 3.590842e-03 3 1  ON 49
ci_051                -2.730154e-03 3 1  ON 50
ci_052                -2.823495e-03 3 1  ON 51
ci_053                -2.659131e-03 3 1  ON 52
ci_054                -2.419740e-03 3 1  ON 53
ci_055                -3.290161e-03 3 1  ON 54
ci_056                -1.617175e-03 3 1  ON 55
ci_057                -1.613947e-03 3 1  ON 56
ci_058                -2.625827e-03 3 1  ON 57
ci_059                -2.182871e-03 3 1  ON 58
ci_060                -1.897206e-03 3 1  ON 59
ci_061                -1.802867e-03 3 1  ON 60
ci_062                -2.323786e-03 3 1  ON 61
ci_063                -1.442224e-03 3 1  ON 62
ci_064                 1.475811e-04 3 1  ON 63
ci_065                -1.682886e-03 3 1  ON 64
ci_066                -1.299937e-03 3 1  ON 65
ci_067                -1.274204e-03 3 1  ON 66
ci_068                -5.305319e-04 3 1  ON 67
ci_069                 1.430371e-03 3 1  ON 68
ci_070                 1.532904e-03 3 1  ON 69
ci_071                -1.308019e-03 3 1  ON 70
ci_072                -1.213173e-03 3 1  ON 71
ci_073                 1.457923e-03 3 1  ON 72
ci_074                 8.880009e-04 3 1  ON 73
ci_075                -8.938120e-04 3 1  ON 74
ci_076                -1.046227e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.0535
    reference variance = 3.20406
====================================================
  Execution time = 2.3816e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.8159e+00
  Total weights = 1.9500e+06
  Execution time = 4.3686e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.869357085048
                                         uncertainty =       0.097741940831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.869357085048
                                         uncertainty =       0.097741940831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001390786251
  error estimate for blocks of size 2^( 2) =       0.001461105184
  error estimate for blocks of size 2^( 3) =       0.001523914741
  error estimate for blocks of size 2^( 4) =       0.001568206273
  error estimate for blocks of size 2^( 5) =       0.001594877640
  error estimate for blocks of size 2^( 6) =       0.001607162408
  error estimate for blocks of size 2^( 7) =       0.001615848656

      target function =                  N/A
              le_mean =     -22.329022223729
             les_mean =     502.401274003080
             stat err =       0.001596523744
             autocorr =       1.317740781840
              std dev =       1.966900247709
             le_variance =       3.868696584438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.869400644075
                                         uncertainty =       0.097739521385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.869400644075
                                         uncertainty =       0.097739521385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001390794305
  error estimate for blocks of size 2^( 2) =       0.001461108052
  error estimate for blocks of size 2^( 3) =       0.001523910964
  error estimate for blocks of size 2^( 4) =       0.001568198069
  error estimate for blocks of size 2^( 5) =       0.001594887929
  error estimate for blocks of size 2^( 6) =       0.001607155818
  error estimate for blocks of size 2^( 7) =       0.001615823566

      target function =                  N/A
              le_mean =     -22.329029677489
             les_mean =     502.403323581689
             stat err =       0.001596516345
             autocorr =       1.317713304501
              std dev =       1.966911638993
             le_variance =       3.868741395607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.869380471719
                                         uncertainty =       0.097740355608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.869380471719
                                         uncertainty =       0.097740355608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001390790584
  error estimate for blocks of size 2^( 2) =       0.001461106264
  error estimate for blocks of size 2^( 3) =       0.001523911840
  error estimate for blocks of size 2^( 4) =       0.001568201074
  error estimate for blocks of size 2^( 5) =       0.001594882709
  error estimate for blocks of size 2^( 6) =       0.001607157584
  error estimate for blocks of size 2^( 7) =       0.001615833859

      target function =                  N/A
              le_mean =     -22.329025067041
             les_mean =     502.403082319347
             stat err =       0.001596518806
             autocorr =       1.317724418639
              std dev =       1.966906376281
             le_variance =       3.868720693055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.869359241102
                                         uncertainty =       0.097741731817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.869359241102
                                         uncertainty =       0.097741731817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001390786655
  error estimate for blocks of size 2^( 2) =       0.001461105197
  error estimate for blocks of size 2^( 3) =       0.001523914135
  error estimate for blocks of size 2^( 4) =       0.001568205307
  error estimate for blocks of size 2^( 5) =       0.001594878141
  error estimate for blocks of size 2^( 6) =       0.001607161623
  error estimate for blocks of size 2^( 7) =       0.001615846780

      target function =                  N/A
              le_mean =     -22.329022482758
             les_mean =     502.401075268017
             stat err =       0.001596522963
             autocorr =       1.317738725126
              std dev =       1.966900819485
             le_variance =       3.868698833690


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329022223729        initial
     6.2500e-01     6.2500e+00             7.1403e-04       -22.329029677489  <--
     2.5000e+00     2.5000e+01             2.0245e-04       -22.329025067041
     1.0000e+01     1.0000e+02             5.2393e-05       -22.329022482758

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.5687e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_001                -6.994723e-01 3 1  ON 0
ci_002                -7.007186e-01 3 1  ON 1
ci_003                -6.145407e-02 3 1  ON 2
ci_004                -6.183697e-02 3 1  ON 3
ci_005                 4.537473e-02 3 1  ON 4
ci_006                 4.548443e-02 3 1  ON 5
ci_007                 3.115184e-02 3 1  ON 6
ci_008                 3.105749e-02 3 1  ON 7
ci_009                -2.508540e-02 3 1  ON 8
ci_010                -2.570434e-02 3 1  ON 9
ci_011                -2.250676e-02 3 1  ON 10
ci_012                -2.177548e-02 3 1  ON 11
ci_013                 1.958882e-02 3 1  ON 12
ci_014                 2.095513e-02 3 1  ON 13
ci_015                 2.119495e-02 3 1  ON 14
ci_016                 1.955099e-02 3 1  ON 15
ci_017                 1.656698e-02 3 1  ON 16
ci_018                 1.585610e-02 3 1  ON 17
ci_019                 1.008647e-02 3 1  ON 18
ci_020                 9.756381e-03 3 1  ON 19
ci_021                -1.010831e-02 3 1  ON 20
ci_022                -1.037984e-02 3 1  ON 21
ci_023                 8.661019e-03 3 1  ON 22
ci_024                 8.925508e-03 3 1  ON 23
ci_025                 7.941552e-03 3 1  ON 24
ci_026                 8.342718e-03 3 1  ON 25
ci_027                 7.793146e-03 3 1  ON 26
ci_028                 7.908240e-03 3 1  ON 27
ci_029                -6.970789e-03 3 1  ON 28
ci_030                -7.331352e-03 3 1  ON 29
ci_031                -7.491671e-03 3 1  ON 30
ci_032                -7.089805e-03 3 1  ON 31
ci_033                 7.005336e-03 3 1  ON 32
ci_034                 7.806425e-03 3 1  ON 33
ci_035                 6.401541e-03 3 1  ON 34
ci_036                 7.030551e-03 3 1  ON 35
ci_037                 6.537480e-03 3 1  ON 36
ci_038                 6.115111e-03 3 1  ON 37
ci_039                 5.711204e-03 3 1  ON 38
ci_040                 5.283931e-03 3 1  ON 39
ci_041                 5.316180e-03 3 1  ON 40
ci_042                 4.127585e-03 3 1  ON 41
ci_043                 4.757051e-03 3 1  ON 42
ci_044                 5.048678e-03 3 1  ON 43
ci_045                 4.967234e-03 3 1  ON 44
ci_046                 4.458282e-03 3 1  ON 45
ci_047                -4.271766e-03 3 1  ON 46
ci_048                -4.582695e-03 3 1  ON 47
ci_049                 2.753075e-03 3 1  ON 48
ci_050                 3.612171e-03 3 1  ON 49
ci_051                -2.609629e-03 3 1  ON 50
ci_052                -2.890858e-03 3 1  ON 51
ci_053                -2.550111e-03 3 1  ON 52
ci_054                -2.484093e-03 3 1  ON 53
ci_055                -3.201048e-03 3 1  ON 54
ci_056                -1.981408e-03 3 1  ON 55
ci_057                -1.481644e-03 3 1  ON 56
ci_058                -2.723083e-03 3 1  ON 57
ci_059                -2.133778e-03 3 1  ON 58
ci_060                -1.996738e-03 3 1  ON 59
ci_061                -1.723475e-03 3 1  ON 60
ci_062                -2.222269e-03 3 1  ON 61
ci_063                -1.516956e-03 3 1  ON 62
ci_064                 1.277451e-04 3 1  ON 63
ci_065                -1.437234e-03 3 1  ON 64
ci_066                -1.234507e-03 3 1  ON 65
ci_067                -1.513150e-03 3 1  ON 66
ci_068                -7.778334e-04 3 1  ON 67
ci_069                 1.370874e-03 3 1  ON 68
ci_070                 1.530944e-03 3 1  ON 69
ci_071                -1.355206e-03 3 1  ON 70
ci_072                -1.213523e-03 3 1  ON 71
ci_073                 1.596111e-03 3 1  ON 72
ci_074                 8.842519e-04 3 1  ON 73
ci_075                -8.356782e-04 3 1  ON 74
ci_076                -8.148518e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8879e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -21.5435
    reference variance = 24.0874
====================================================
  Execution time = 2.4061e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0309e+04
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.8155e+00
  Total weights = 1.949999592e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8785e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.870605424561
                                         uncertainty =       0.089672511447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.870605424561
                                         uncertainty =       0.089672511447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001391136346
  error estimate for blocks of size 2^( 2) =       0.001462088719
  error estimate for blocks of size 2^( 3) =       0.001524513496
  error estimate for blocks of size 2^( 4) =       0.001570182012
  error estimate for blocks of size 2^( 5) =       0.001596199593
  error estimate for blocks of size 2^( 6) =       0.001606248755
  error estimate for blocks of size 2^( 7) =       0.001609636907

      target function =                  N/A
              le_mean =     -22.325306201989
             les_mean =     502.234823722812
             stat err =       0.001595566817
             autocorr =       1.315499223537
              std dev =       1.967395365676
             le_variance =       3.870644524884


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232530620199e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325306201198       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325385813895       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325389290903       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325389266618       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.325389231906       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.325389300396       residual = 6.26e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 1.646359e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325306201198       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325340221133       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325340482440       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325340468019       residual = 5.91e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 6.073683e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325306201198       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325316539260       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325316533008       residual = 8.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.725320e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122243 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9950e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_001                -6.996434e-01 3 1  ON 0
ci_002                -7.005200e-01 3 1  ON 1
ci_003                -6.143539e-02 3 1  ON 2
ci_004                -6.173671e-02 3 1  ON 3
ci_005                 4.554604e-02 3 1  ON 4
ci_006                 4.563591e-02 3 1  ON 5
ci_007                 3.126758e-02 3 1  ON 6
ci_008                 3.147036e-02 3 1  ON 7
ci_009                -2.512478e-02 3 1  ON 8
ci_010                -2.538665e-02 3 1  ON 9
ci_011                -2.258518e-02 3 1  ON 10
ci_012                -2.181593e-02 3 1  ON 11
ci_013                 2.004516e-02 3 1  ON 12
ci_014                 2.122033e-02 3 1  ON 13
ci_015                 2.058758e-02 3 1  ON 14
ci_016                 1.960067e-02 3 1  ON 15
ci_017                 1.608870e-02 3 1  ON 16
ci_018                 1.570243e-02 3 1  ON 17
ci_019                 1.013486e-02 3 1  ON 18
ci_020                 9.796404e-03 3 1  ON 19
ci_021                -9.595818e-03 3 1  ON 20
ci_022                -1.010979e-02 3 1  ON 21
ci_023                 8.485670e-03 3 1  ON 22
ci_024                 9.045931e-03 3 1  ON 23
ci_025                 7.868770e-03 3 1  ON 24
ci_026                 8.478652e-03 3 1  ON 25
ci_027                 7.494631e-03 3 1  ON 26
ci_028                 7.994535e-03 3 1  ON 27
ci_029                -7.204465e-03 3 1  ON 28
ci_030                -7.595292e-03 3 1  ON 29
ci_031                -7.737668e-03 3 1  ON 30
ci_032                -7.494285e-03 3 1  ON 31
ci_033                 6.837325e-03 3 1  ON 32
ci_034                 7.851290e-03 3 1  ON 33
ci_035                 6.416457e-03 3 1  ON 34
ci_036                 7.000801e-03 3 1  ON 35
ci_037                 6.344293e-03 3 1  ON 36
ci_038                 6.284359e-03 3 1  ON 37
ci_039                 6.060264e-03 3 1  ON 38
ci_040                 5.550620e-03 3 1  ON 39
ci_041                 5.527917e-03 3 1  ON 40
ci_042                 4.649524e-03 3 1  ON 41
ci_043                 4.894421e-03 3 1  ON 42
ci_044                 5.034278e-03 3 1  ON 43
ci_045                 4.771523e-03 3 1  ON 44
ci_046                 4.743628e-03 3 1  ON 45
ci_047                -4.235845e-03 3 1  ON 46
ci_048                -4.488487e-03 3 1  ON 47
ci_049                 3.157732e-03 3 1  ON 48
ci_050                 3.732535e-03 3 1  ON 49
ci_051                -2.651056e-03 3 1  ON 50
ci_052                -2.794112e-03 3 1  ON 51
ci_053                -2.852319e-03 3 1  ON 52
ci_054                -2.784563e-03 3 1  ON 53
ci_055                -3.284221e-03 3 1  ON 54
ci_056                -1.748928e-03 3 1  ON 55
ci_057                -1.596511e-03 3 1  ON 56
ci_058                -2.681920e-03 3 1  ON 57
ci_059                -1.846896e-03 3 1  ON 58
ci_060                -2.024925e-03 3 1  ON 59
ci_061                -1.804081e-03 3 1  ON 60
ci_062                -2.141667e-03 3 1  ON 61
ci_063                -1.674394e-03 3 1  ON 62
ci_064                -1.730327e-04 3 1  ON 63
ci_065                -1.725235e-03 3 1  ON 64
ci_066                -1.150108e-03 3 1  ON 65
ci_067                -1.484592e-03 3 1  ON 66
ci_068                -1.244058e-03 3 1  ON 67
ci_069                 1.248606e-03 3 1  ON 68
ci_070                 1.416466e-03 3 1  ON 69
ci_071                -1.447299e-03 3 1  ON 70
ci_072                -1.121136e-03 3 1  ON 71
ci_073                 1.377944e-03 3 1  ON 72
ci_074                 1.233316e-03 3 1  ON 73
ci_075                -8.710908e-04 3 1  ON 74
ci_076                -7.944810e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.5089
    reference variance = 2.5329
====================================================
  Execution time = 2.3654e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7187e+00
  Total weights = 1.9499e+06
  Execution time = 4.3898e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767716354286
                                         uncertainty =       0.027650641504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767716354286
                                         uncertainty =       0.027650641504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372427695
  error estimate for blocks of size 2^( 2) =       0.001443874908
  error estimate for blocks of size 2^( 3) =       0.001507546717
  error estimate for blocks of size 2^( 4) =       0.001550099289
  error estimate for blocks of size 2^( 5) =       0.001578490255
  error estimate for blocks of size 2^( 6) =       0.001594293855
  error estimate for blocks of size 2^( 7) =       0.001600371208

      target function =                  N/A
              le_mean =     -22.327327403535
             les_mean =     502.232480977375
             stat err =       0.001580813652
             autocorr =       1.326729570520
              std dev =       1.940936913894
             le_variance =       3.767236103718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767847041282
                                         uncertainty =       0.027651205956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767847041282
                                         uncertainty =       0.027651205956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372451648
  error estimate for blocks of size 2^( 2) =       0.001443871921
  error estimate for blocks of size 2^( 3) =       0.001507525062
  error estimate for blocks of size 2^( 4) =       0.001550046830
  error estimate for blocks of size 2^( 5) =       0.001578424756
  error estimate for blocks of size 2^( 6) =       0.001594178767
  error estimate for blocks of size 2^( 7) =       0.001600271323

      target function =                  N/A
              le_mean =     -22.327323345987
             les_mean =     502.255844407711
             stat err =       0.001580730419
             autocorr =       1.326543559892
              std dev =       1.940970788795
             le_variance =       3.767367602955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767795677571
                                         uncertainty =       0.027649228718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767795677571
                                         uncertainty =       0.027649228718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372442296
  error estimate for blocks of size 2^( 2) =       0.001443858791
  error estimate for blocks of size 2^( 3) =       0.001507506198
  error estimate for blocks of size 2^( 4) =       0.001550034034
  error estimate for blocks of size 2^( 5) =       0.001578402496
  error estimate for blocks of size 2^( 6) =       0.001594176589
  error estimate for blocks of size 2^( 7) =       0.001600264897

      target function =                  N/A
              le_mean =     -22.327322944849
             les_mean =     502.264256411334
             stat err =       0.001580719504
             autocorr =       1.326543319312
              std dev =       1.940957562603
             le_variance =       3.767316259825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767701949976
                                         uncertainty =       0.027650809756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.767701949976
                                         uncertainty =       0.027650809756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372425097
  error estimate for blocks of size 2^( 2) =       0.001443868154
  error estimate for blocks of size 2^( 3) =       0.001507536868
  error estimate for blocks of size 2^( 4) =       0.001550088096
  error estimate for blocks of size 2^( 5) =       0.001578481608
  error estimate for blocks of size 2^( 6) =       0.001594282028
  error estimate for blocks of size 2^( 7) =       0.001600359092

      target function =                  N/A
              le_mean =     -22.327323151822
             les_mean =     502.228111940013
             stat err =       0.001580802706
             autocorr =       1.326716219582
              std dev =       1.940933240304
             le_variance =       3.767221843318


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327327403535        initial  <--
     1.5625e-01     1.5625e+00             1.6464e-03       -22.327323345987
     6.2500e-01     6.2500e+00             6.0737e-04       -22.327322944849
     2.5000e+00     2.5000e+01             1.7253e-04       -22.327323151822

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5985
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_001                -6.994723e-01 3 1  ON 0
ci_002                -7.007186e-01 3 1  ON 1
ci_003                -6.145407e-02 3 1  ON 2
ci_004                -6.183697e-02 3 1  ON 3
ci_005                 4.537473e-02 3 1  ON 4
ci_006                 4.548443e-02 3 1  ON 5
ci_007                 3.115184e-02 3 1  ON 6
ci_008                 3.105749e-02 3 1  ON 7
ci_009                -2.508540e-02 3 1  ON 8
ci_010                -2.570434e-02 3 1  ON 9
ci_011                -2.250676e-02 3 1  ON 10
ci_012                -2.177548e-02 3 1  ON 11
ci_013                 1.958882e-02 3 1  ON 12
ci_014                 2.095513e-02 3 1  ON 13
ci_015                 2.119495e-02 3 1  ON 14
ci_016                 1.955099e-02 3 1  ON 15
ci_017                 1.656698e-02 3 1  ON 16
ci_018                 1.585610e-02 3 1  ON 17
ci_019                 1.008647e-02 3 1  ON 18
ci_020                 9.756381e-03 3 1  ON 19
ci_021                -1.010831e-02 3 1  ON 20
ci_022                -1.037984e-02 3 1  ON 21
ci_023                 8.661019e-03 3 1  ON 22
ci_024                 8.925508e-03 3 1  ON 23
ci_025                 7.941552e-03 3 1  ON 24
ci_026                 8.342718e-03 3 1  ON 25
ci_027                 7.793146e-03 3 1  ON 26
ci_028                 7.908240e-03 3 1  ON 27
ci_029                -6.970789e-03 3 1  ON 28
ci_030                -7.331352e-03 3 1  ON 29
ci_031                -7.491671e-03 3 1  ON 30
ci_032                -7.089805e-03 3 1  ON 31
ci_033                 7.005336e-03 3 1  ON 32
ci_034                 7.806425e-03 3 1  ON 33
ci_035                 6.401541e-03 3 1  ON 34
ci_036                 7.030551e-03 3 1  ON 35
ci_037                 6.537480e-03 3 1  ON 36
ci_038                 6.115111e-03 3 1  ON 37
ci_039                 5.711204e-03 3 1  ON 38
ci_040                 5.283931e-03 3 1  ON 39
ci_041                 5.316180e-03 3 1  ON 40
ci_042                 4.127585e-03 3 1  ON 41
ci_043                 4.757051e-03 3 1  ON 42
ci_044                 5.048678e-03 3 1  ON 43
ci_045                 4.967234e-03 3 1  ON 44
ci_046                 4.458282e-03 3 1  ON 45
ci_047                -4.271766e-03 3 1  ON 46
ci_048                -4.582695e-03 3 1  ON 47
ci_049                 2.753075e-03 3 1  ON 48
ci_050                 3.612171e-03 3 1  ON 49
ci_051                -2.609629e-03 3 1  ON 50
ci_052                -2.890858e-03 3 1  ON 51
ci_053                -2.550111e-03 3 1  ON 52
ci_054                -2.484093e-03 3 1  ON 53
ci_055                -3.201048e-03 3 1  ON 54
ci_056                -1.981408e-03 3 1  ON 55
ci_057                -1.481644e-03 3 1  ON 56
ci_058                -2.723083e-03 3 1  ON 57
ci_059                -2.133778e-03 3 1  ON 58
ci_060                -1.996738e-03 3 1  ON 59
ci_061                -1.723475e-03 3 1  ON 60
ci_062                -2.222269e-03 3 1  ON 61
ci_063                -1.516956e-03 3 1  ON 62
ci_064                 1.277451e-04 3 1  ON 63
ci_065                -1.437234e-03 3 1  ON 64
ci_066                -1.234507e-03 3 1  ON 65
ci_067                -1.513150e-03 3 1  ON 66
ci_068                -7.778334e-04 3 1  ON 67
ci_069                 1.370874e-03 3 1  ON 68
ci_070                 1.530944e-03 3 1  ON 69
ci_071                -1.355206e-03 3 1  ON 70
ci_072                -1.213523e-03 3 1  ON 71
ci_073                 1.596111e-03 3 1  ON 72
ci_074                 8.842519e-04 3 1  ON 73
ci_075                -8.356782e-04 3 1  ON 74
ci_076                -8.148518e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5559e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2179e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.4697
    reference variance = 2.53547
====================================================
  Execution time = 2.4167e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0298e+04
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.6772e+00
  Total weights = 1.950164299e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8580e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.723213594543
                                         uncertainty =       0.024651338232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.723213594543
                                         uncertainty =       0.024651338232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365347097
  error estimate for blocks of size 2^( 2) =       0.001436559993
  error estimate for blocks of size 2^( 3) =       0.001502818207
  error estimate for blocks of size 2^( 4) =       0.001547501116
  error estimate for blocks of size 2^( 5) =       0.001573897946
  error estimate for blocks of size 2^( 6) =       0.001586757020
  error estimate for blocks of size 2^( 7) =       0.001596285641

      target function =                  N/A
              le_mean =     -22.325311084845
             les_mean =     502.096667318250
             stat err =       0.001576110431
             autocorr =       1.332561139508
              std dev =       1.930923275468
             le_variance =       3.728464695744


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232531108485e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325311084020       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325320217907       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325321384478       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325321373260       residual = 8.24e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 2.888808e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325311084020       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325313645919       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325313896268       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325313894236       residual = 2.09e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 8.505491e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325311084020       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325311744632       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325311803893       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325311803391       residual = 1.91e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 2.224706e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123766 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0032e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_001                -6.994713e-01 3 1  ON 0
ci_002                -7.007125e-01 3 1  ON 1
ci_003                -6.147470e-02 3 1  ON 2
ci_004                -6.184948e-02 3 1  ON 3
ci_005                 4.540057e-02 3 1  ON 4
ci_006                 4.548800e-02 3 1  ON 5
ci_007                 3.116898e-02 3 1  ON 6
ci_008                 3.107935e-02 3 1  ON 7
ci_009                -2.511492e-02 3 1  ON 8
ci_010                -2.570689e-02 3 1  ON 9
ci_011                -2.249419e-02 3 1  ON 10
ci_012                -2.175492e-02 3 1  ON 11
ci_013                 1.958976e-02 3 1  ON 12
ci_014                 2.095175e-02 3 1  ON 13
ci_015                 2.117557e-02 3 1  ON 14
ci_016                 1.960238e-02 3 1  ON 15
ci_017                 1.658483e-02 3 1  ON 16
ci_018                 1.586179e-02 3 1  ON 17
ci_019                 1.005752e-02 3 1  ON 18
ci_020                 9.804026e-03 3 1  ON 19
ci_021                -1.009679e-02 3 1  ON 20
ci_022                -1.035099e-02 3 1  ON 21
ci_023                 8.678714e-03 3 1  ON 22
ci_024                 8.926249e-03 3 1  ON 23
ci_025                 7.933181e-03 3 1  ON 24
ci_026                 8.338473e-03 3 1  ON 25
ci_027                 7.803316e-03 3 1  ON 26
ci_028                 7.823185e-03 3 1  ON 27
ci_029                -6.966832e-03 3 1  ON 28
ci_030                -7.322409e-03 3 1  ON 29
ci_031                -7.486862e-03 3 1  ON 30
ci_032                -7.127789e-03 3 1  ON 31
ci_033                 6.986161e-03 3 1  ON 32
ci_034                 7.823421e-03 3 1  ON 33
ci_035                 6.390678e-03 3 1  ON 34
ci_036                 7.014386e-03 3 1  ON 35
ci_037                 6.547068e-03 3 1  ON 36
ci_038                 6.130329e-03 3 1  ON 37
ci_039                 5.730190e-03 3 1  ON 38
ci_040                 5.277303e-03 3 1  ON 39
ci_041                 5.281140e-03 3 1  ON 40
ci_042                 4.182740e-03 3 1  ON 41
ci_043                 4.777418e-03 3 1  ON 42
ci_044                 5.055272e-03 3 1  ON 43
ci_045                 4.926099e-03 3 1  ON 44
ci_046                 4.504824e-03 3 1  ON 45
ci_047                -4.250556e-03 3 1  ON 46
ci_048                -4.582565e-03 3 1  ON 47
ci_049                 2.755787e-03 3 1  ON 48
ci_050                 3.620457e-03 3 1  ON 49
ci_051                -2.611593e-03 3 1  ON 50
ci_052                -2.840902e-03 3 1  ON 51
ci_053                -2.532541e-03 3 1  ON 52
ci_054                -2.481035e-03 3 1  ON 53
ci_055                -3.171692e-03 3 1  ON 54
ci_056                -2.010309e-03 3 1  ON 55
ci_057                -1.527477e-03 3 1  ON 56
ci_058                -2.714008e-03 3 1  ON 57
ci_059                -2.128281e-03 3 1  ON 58
ci_060                -2.011744e-03 3 1  ON 59
ci_061                -1.772450e-03 3 1  ON 60
ci_062                -2.254141e-03 3 1  ON 61
ci_063                -1.522116e-03 3 1  ON 62
ci_064                 6.195330e-05 3 1  ON 63
ci_065                -1.470778e-03 3 1  ON 64
ci_066                -1.245553e-03 3 1  ON 65
ci_067                -1.522383e-03 3 1  ON 66
ci_068                -8.038582e-04 3 1  ON 67
ci_069                 1.336866e-03 3 1  ON 68
ci_070                 1.499216e-03 3 1  ON 69
ci_071                -1.331637e-03 3 1  ON 70
ci_072                -1.170779e-03 3 1  ON 71
ci_073                 1.561342e-03 3 1  ON 72
ci_074                 8.482857e-04 3 1  ON 73
ci_075                -8.372106e-04 3 1  ON 74
ci_076                -8.347276e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.4762
    reference variance = 1.77715
====================================================
  Execution time = 2.3580e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6836e+00
  Total weights = 1.9498e+06
  Execution time = 4.3689e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734938460649
                                         uncertainty =       0.029401229528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734938460649
                                         uncertainty =       0.029401229528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366541004
  error estimate for blocks of size 2^( 2) =       0.001437177204
  error estimate for blocks of size 2^( 3) =       0.001500252654
  error estimate for blocks of size 2^( 4) =       0.001543387822
  error estimate for blocks of size 2^( 5) =       0.001565944469
  error estimate for blocks of size 2^( 6) =       0.001582282441
  error estimate for blocks of size 2^( 7) =       0.001590452415

      target function =                  N/A
              le_mean =     -22.329994557737
             les_mean =     502.312279837115
             stat err =       0.001570516787
             autocorr =       1.320808424875
              std dev =       1.932611742348
             le_variance =       3.734988146661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734972184869
                                         uncertainty =       0.029400444908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734972184869
                                         uncertainty =       0.029400444908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366547137
  error estimate for blocks of size 2^( 2) =       0.001437179088
  error estimate for blocks of size 2^( 3) =       0.001500247995
  error estimate for blocks of size 2^( 4) =       0.001543381571
  error estimate for blocks of size 2^( 5) =       0.001565931102
  error estimate for blocks of size 2^( 6) =       0.001582275095
  error estimate for blocks of size 2^( 7) =       0.001590451646

      target function =                  N/A
              le_mean =     -22.329998397321
             les_mean =     502.312955217755
             stat err =       0.001570509854
             autocorr =       1.320784908534
              std dev =       1.932620415803
             le_variance =       3.735021671579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734953937247
                                         uncertainty =       0.029400819378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734953937247
                                         uncertainty =       0.029400819378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366543815
  error estimate for blocks of size 2^( 2) =       0.001437177702
  error estimate for blocks of size 2^( 3) =       0.001500249782
  error estimate for blocks of size 2^( 4) =       0.001543384308
  error estimate for blocks of size 2^( 5) =       0.001565936873
  error estimate for blocks of size 2^( 6) =       0.001582277725
  error estimate for blocks of size 2^( 7) =       0.001590451191

      target function =                  N/A
              le_mean =     -22.329996174494
             les_mean =     502.312413561713
             stat err =       0.001570512524
             autocorr =       1.320795822823
              std dev =       1.932615717258
             le_variance =       3.735003510594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734940132206
                                         uncertainty =       0.029401179558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734940132206
                                         uncertainty =       0.029401179558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366541307
  error estimate for blocks of size 2^( 2) =       0.001437177225
  error estimate for blocks of size 2^( 3) =       0.001500252248
  error estimate for blocks of size 2^( 4) =       0.001543387335
  error estimate for blocks of size 2^( 5) =       0.001565943444
  error estimate for blocks of size 2^( 6) =       0.001582281724
  error estimate for blocks of size 2^( 7) =       0.001590452099

      target function =                  N/A
              le_mean =     -22.329994705420
             les_mean =     502.312310996607
             stat err =       0.001570516151
             autocorr =       1.320806769463
              std dev =       1.932612170948
             le_variance =       3.734989803296


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329994557737        initial
     1.5625e+00     1.5625e+01             2.8888e-04       -22.329998397321  <--
     6.2500e+00     6.2500e+01             8.5055e-05       -22.329996174494
     2.5000e+01     2.5000e+02             2.2247e-05       -22.329994705420

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 4.5479e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_001                -6.994697e-01 3 1  ON 0
ci_002                -7.006945e-01 3 1  ON 1
ci_003                -6.153393e-02 3 1  ON 2
ci_004                -6.188622e-02 3 1  ON 3
ci_005                 4.546623e-02 3 1  ON 4
ci_006                 4.549889e-02 3 1  ON 5
ci_007                 3.121352e-02 3 1  ON 6
ci_008                 3.113768e-02 3 1  ON 7
ci_009                -2.519372e-02 3 1  ON 8
ci_010                -2.571347e-02 3 1  ON 9
ci_011                -2.245977e-02 3 1  ON 10
ci_012                -2.169879e-02 3 1  ON 11
ci_013                 1.959185e-02 3 1  ON 12
ci_014                 2.094163e-02 3 1  ON 13
ci_015                 2.112099e-02 3 1  ON 14
ci_016                 1.974620e-02 3 1  ON 15
ci_017                 1.663187e-02 3 1  ON 16
ci_018                 1.587922e-02 3 1  ON 17
ci_019                 9.977266e-03 3 1  ON 18
ci_020                 9.934212e-03 3 1  ON 19
ci_021                -1.006317e-02 3 1  ON 20
ci_022                -1.027124e-02 3 1  ON 21
ci_023                 8.725635e-03 3 1  ON 22
ci_024                 8.929581e-03 3 1  ON 23
ci_025                 7.912093e-03 3 1  ON 24
ci_026                 8.327406e-03 3 1  ON 25
ci_027                 7.830283e-03 3 1  ON 26
ci_028                 7.619359e-03 3 1  ON 27
ci_029                -6.951170e-03 3 1  ON 28
ci_030                -7.298888e-03 3 1  ON 29
ci_031                -7.475022e-03 3 1  ON 30
ci_032                -7.232561e-03 3 1  ON 31
ci_033                 6.934861e-03 3 1  ON 32
ci_034                 7.868889e-03 3 1  ON 33
ci_035                 6.364593e-03 3 1  ON 34
ci_036                 6.972920e-03 3 1  ON 35
ci_037                 6.571727e-03 3 1  ON 36
ci_038                 6.171605e-03 3 1  ON 37
ci_039                 5.779306e-03 3 1  ON 38
ci_040                 5.264572e-03 3 1  ON 39
ci_041                 5.189628e-03 3 1  ON 40
ci_042                 4.326196e-03 3 1  ON 41
ci_043                 4.830332e-03 3 1  ON 42
ci_044                 5.071868e-03 3 1  ON 43
ci_045                 4.816346e-03 3 1  ON 44
ci_046                 4.625042e-03 3 1  ON 45
ci_047                -4.198959e-03 3 1  ON 46
ci_048                -4.580584e-03 3 1  ON 47
ci_049                 2.762893e-03 3 1  ON 48
ci_050                 3.642664e-03 3 1  ON 49
ci_051                -2.618615e-03 3 1  ON 50
ci_052                -2.710711e-03 3 1  ON 51
ci_053                -2.485269e-03 3 1  ON 52
ci_054                -2.470460e-03 3 1  ON 53
ci_055                -3.090280e-03 3 1  ON 54
ci_056                -2.087491e-03 3 1  ON 55
ci_057                -1.647805e-03 3 1  ON 56
ci_058                -2.691262e-03 3 1  ON 57
ci_059                -2.112909e-03 3 1  ON 58
ci_060                -2.050025e-03 3 1  ON 59
ci_061                -1.902554e-03 3 1  ON 60
ci_062                -2.340976e-03 3 1  ON 61
ci_063                -1.536170e-03 3 1  ON 62
ci_064                -1.150390e-04 3 1  ON 63
ci_065                -1.553785e-03 3 1  ON 64
ci_066                -1.278840e-03 3 1  ON 65
ci_067                -1.550349e-03 3 1  ON 66
ci_068                -8.731216e-04 3 1  ON 67
ci_069                 1.248147e-03 3 1  ON 68
ci_070                 1.411798e-03 3 1  ON 69
ci_071                -1.267204e-03 3 1  ON 70
ci_072                -1.064930e-03 3 1  ON 71
ci_073                 1.474436e-03 3 1  ON 72
ci_074                 7.603451e-04 3 1  ON 73
ci_075                -8.403930e-04 3 1  ON 74
ci_076                -8.893640e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5519e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.0679
    reference variance = 9.32674
====================================================
  Execution time = 2.4200e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0332e+04
  VMC Eavg = -2.2332e+01
  VMC Evar = 3.6897e+00
  Total weights = 1.950228637e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8583e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.738086762021
                                         uncertainty =       0.044942541041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.738086762021
                                         uncertainty =       0.044942541041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367787276
  error estimate for blocks of size 2^( 2) =       0.001439417633
  error estimate for blocks of size 2^( 3) =       0.001502482958
  error estimate for blocks of size 2^( 4) =       0.001546217724
  error estimate for blocks of size 2^( 5) =       0.001569108748
  error estimate for blocks of size 2^( 6) =       0.001581987413
  error estimate for blocks of size 2^( 7) =       0.001586588706

      target function =                  N/A
              le_mean =     -22.331658706871
             les_mean =     502.392686205023
             stat err =       0.001570975648
             autocorr =       1.319173102090
              std dev =       1.934374264855
             le_variance =       3.741803796532


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233165870687e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.331658706085       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.331691379142       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.331691062073       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.331691112258       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 7.582625e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.331658706085       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.331669607460       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.331669617508       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 2.630333e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.331658706085       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.331661680212       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.331661705335       residual = 5.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 7.266827e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125073 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0068e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_001                -6.993575e-01 3 1  ON 0
ci_002                -7.007814e-01 3 1  ON 1
ci_003                -6.165146e-02 3 1  ON 2
ci_004                -6.181980e-02 3 1  ON 3
ci_005                 4.549086e-02 3 1  ON 4
ci_006                 4.560538e-02 3 1  ON 5
ci_007                 3.132992e-02 3 1  ON 6
ci_008                 3.123844e-02 3 1  ON 7
ci_009                -2.522227e-02 3 1  ON 8
ci_010                -2.568810e-02 3 1  ON 9
ci_011                -2.254709e-02 3 1  ON 10
ci_012                -2.188627e-02 3 1  ON 11
ci_013                 1.977172e-02 3 1  ON 12
ci_014                 2.087391e-02 3 1  ON 13
ci_015                 2.100938e-02 3 1  ON 14
ci_016                 1.965441e-02 3 1  ON 15
ci_017                 1.646894e-02 3 1  ON 16
ci_018                 1.592114e-02 3 1  ON 17
ci_019                 9.815917e-03 3 1  ON 18
ci_020                 9.847326e-03 3 1  ON 19
ci_021                -1.000668e-02 3 1  ON 20
ci_022                -1.033506e-02 3 1  ON 21
ci_023                 8.708979e-03 3 1  ON 22
ci_024                 9.048401e-03 3 1  ON 23
ci_025                 7.866437e-03 3 1  ON 24
ci_026                 8.393339e-03 3 1  ON 25
ci_027                 7.921967e-03 3 1  ON 26
ci_028                 7.841316e-03 3 1  ON 27
ci_029                -6.842447e-03 3 1  ON 28
ci_030                -7.254086e-03 3 1  ON 29
ci_031                -7.409915e-03 3 1  ON 30
ci_032                -7.222684e-03 3 1  ON 31
ci_033                 6.909337e-03 3 1  ON 32
ci_034                 7.847080e-03 3 1  ON 33
ci_035                 6.398091e-03 3 1  ON 34
ci_036                 6.803629e-03 3 1  ON 35
ci_037                 6.700977e-03 3 1  ON 36
ci_038                 6.222904e-03 3 1  ON 37
ci_039                 5.799853e-03 3 1  ON 38
ci_040                 5.244389e-03 3 1  ON 39
ci_041                 5.127017e-03 3 1  ON 40
ci_042                 4.589229e-03 3 1  ON 41
ci_043                 4.996488e-03 3 1  ON 42
ci_044                 5.182027e-03 3 1  ON 43
ci_045                 4.764602e-03 3 1  ON 44
ci_046                 4.646236e-03 3 1  ON 45
ci_047                -4.088180e-03 3 1  ON 46
ci_048                -4.492117e-03 3 1  ON 47
ci_049                 2.812020e-03 3 1  ON 48
ci_050                 3.620280e-03 3 1  ON 49
ci_051                -2.637495e-03 3 1  ON 50
ci_052                -2.784529e-03 3 1  ON 51
ci_053                -2.408345e-03 3 1  ON 52
ci_054                -2.584370e-03 3 1  ON 53
ci_055                -3.111359e-03 3 1  ON 54
ci_056                -2.056414e-03 3 1  ON 55
ci_057                -1.686492e-03 3 1  ON 56
ci_058                -2.718652e-03 3 1  ON 57
ci_059                -2.000768e-03 3 1  ON 58
ci_060                -1.965953e-03 3 1  ON 59
ci_061                -1.820641e-03 3 1  ON 60
ci_062                -2.213082e-03 3 1  ON 61
ci_063                -1.400175e-03 3 1  ON 62
ci_064                -2.664297e-04 3 1  ON 63
ci_065                -1.421935e-03 3 1  ON 64
ci_066                -1.282539e-03 3 1  ON 65
ci_067                -1.486646e-03 3 1  ON 66
ci_068                -9.704553e-04 3 1  ON 67
ci_069                 1.298998e-03 3 1  ON 68
ci_070                 1.465755e-03 3 1  ON 69
ci_071                -1.294874e-03 3 1  ON 70
ci_072                -1.021813e-03 3 1  ON 71
ci_073                 1.348121e-03 3 1  ON 72
ci_074                 8.255541e-04 3 1  ON 73
ci_075                -9.221659e-04 3 1  ON 74
ci_076                -7.736291e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -21.8756
    reference variance = 4.55147
====================================================
  Execution time = 2.2884e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6981e+00
  Total weights = 1.9497e+06
  Execution time = 4.3570e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750272833302
                                         uncertainty =       0.040054316168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750272833302
                                         uncertainty =       0.040054316168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369155019
  error estimate for blocks of size 2^( 2) =       0.001440767810
  error estimate for blocks of size 2^( 3) =       0.001503304626
  error estimate for blocks of size 2^( 4) =       0.001547805198
  error estimate for blocks of size 2^( 5) =       0.001570193415
  error estimate for blocks of size 2^( 6) =       0.001582884173
  error estimate for blocks of size 2^( 7) =       0.001595299203

      target function =                  N/A
              le_mean =     -22.329872695340
             les_mean =     502.325847254099
             stat err =       0.001574045497
             autocorr =       1.321689127370
              std dev =       1.936308576356
             le_variance =       3.749290902871

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750220532031
                                         uncertainty =       0.040058186703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750220532031
                                         uncertainty =       0.040058186703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369145300
  error estimate for blocks of size 2^( 2) =       0.001440744758
  error estimate for blocks of size 2^( 3) =       0.001503262587
  error estimate for blocks of size 2^( 4) =       0.001547754097
  error estimate for blocks of size 2^( 5) =       0.001570137311
  error estimate for blocks of size 2^( 6) =       0.001582832860
  error estimate for blocks of size 2^( 7) =       0.001595225061

      target function =                  N/A
              le_mean =     -22.329877541721
             les_mean =     502.331708800737
             stat err =       0.001573987332
             autocorr =       1.321610212857
              std dev =       1.936294831390
             le_variance =       3.749237674068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750222649353
                                         uncertainty =       0.040056886084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750222649353
                                         uncertainty =       0.040056886084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369145738
  error estimate for blocks of size 2^( 2) =       0.001440748871
  error estimate for blocks of size 2^( 3) =       0.001503271397
  error estimate for blocks of size 2^( 4) =       0.001547764241
  error estimate for blocks of size 2^( 5) =       0.001570145617
  error estimate for blocks of size 2^( 6) =       0.001582837039
  error estimate for blocks of size 2^( 7) =       0.001595243608

      target function =                  N/A
              le_mean =     -22.329873765148
             les_mean =     502.321698976820
             stat err =       0.001573997626
             autocorr =       1.321626652359
              std dev =       1.936295452084
             le_variance =       3.749240077760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750262480464
                                         uncertainty =       0.040054694138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750262480464
                                         uncertainty =       0.040054694138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369153112
  error estimate for blocks of size 2^( 2) =       0.001440764823
  error estimate for blocks of size 2^( 3) =       0.001503300295
  error estimate for blocks of size 2^( 4) =       0.001547800133
  error estimate for blocks of size 2^( 5) =       0.001570185883
  error estimate for blocks of size 2^( 6) =       0.001582875643
  error estimate for blocks of size 2^( 7) =       0.001595290058

      target function =                  N/A
              le_mean =     -22.329871884123
             les_mean =     502.326607634686
             stat err =       0.001574037929
             autocorr =       1.321680098136
              std dev =       1.936305880771
             le_variance =       3.749280463910


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329872695340        initial
     3.9062e-01     3.9062e+00             7.5826e-04       -22.329877541721  <--
     1.5625e+00     1.5625e+01             2.6303e-04       -22.329873765148
     6.2500e+00     6.2500e+01             7.2668e-05       -22.329871884123

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 4.4753e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_001                -6.990362e-01 3 1  ON 0
ci_002                -7.010591e-01 3 1  ON 1
ci_003                -6.194939e-02 3 1  ON 2
ci_004                -6.162424e-02 3 1  ON 3
ci_005                 4.551314e-02 3 1  ON 4
ci_006                 4.579294e-02 3 1  ON 5
ci_007                 3.155841e-02 3 1  ON 6
ci_008                 3.145780e-02 3 1  ON 7
ci_009                -2.524507e-02 3 1  ON 8
ci_010                -2.561300e-02 3 1  ON 9
ci_011                -2.273388e-02 3 1  ON 10
ci_012                -2.229414e-02 3 1  ON 11
ci_013                 2.016281e-02 3 1  ON 12
ci_014                 2.069974e-02 3 1  ON 13
ci_015                 2.074716e-02 3 1  ON 14
ci_016                 1.945043e-02 3 1  ON 15
ci_017                 1.610542e-02 3 1  ON 16
ci_018                 1.601967e-02 3 1  ON 17
ci_019                 9.448929e-03 3 1  ON 18
ci_020                 9.653273e-03 3 1  ON 19
ci_021                -9.874039e-03 3 1  ON 20
ci_022                -1.047616e-02 3 1  ON 21
ci_023                 8.672113e-03 3 1  ON 22
ci_024                 9.286446e-03 3 1  ON 23
ci_025                 7.784338e-03 3 1  ON 24
ci_026                 8.556922e-03 3 1  ON 25
ci_027                 8.076587e-03 3 1  ON 26
ci_028                 8.214654e-03 3 1  ON 27
ci_029                -6.619827e-03 3 1  ON 28
ci_030                -7.159725e-03 3 1  ON 29
ci_031                -7.259930e-03 3 1  ON 30
ci_032                -7.188415e-03 3 1  ON 31
ci_033                 6.850296e-03 3 1  ON 32
ci_034                 7.796855e-03 3 1  ON 33
ci_035                 6.476843e-03 3 1  ON 34
ci_036                 6.519830e-03 3 1  ON 35
ci_037                 6.976476e-03 3 1  ON 36
ci_038                 6.324851e-03 3 1  ON 37
ci_039                 5.828310e-03 3 1  ON 38
ci_040                 5.200607e-03 3 1  ON 39
ci_041                 5.009762e-03 3 1  ON 40
ci_042                 5.084458e-03 3 1  ON 41
ci_043                 5.328857e-03 3 1  ON 42
ci_044                 5.408513e-03 3 1  ON 43
ci_045                 4.661854e-03 3 1  ON 44
ci_046                 4.699657e-03 3 1  ON 45
ci_047                -3.904434e-03 3 1  ON 46
ci_048                -4.350714e-03 3 1  ON 47
ci_049                 2.914954e-03 3 1  ON 48
ci_050                 3.570423e-03 3 1  ON 49
ci_051                -2.675473e-03 3 1  ON 50
ci_052                -2.958171e-03 3 1  ON 51
ci_053                -2.229435e-03 3 1  ON 52
ci_054                -2.806492e-03 3 1  ON 53
ci_055                -3.170450e-03 3 1  ON 54
ci_056                -1.985126e-03 3 1  ON 55
ci_057                -1.758497e-03 3 1  ON 56
ci_058                -2.781574e-03 3 1  ON 57
ci_059                -1.804976e-03 3 1  ON 58
ci_060                -1.826910e-03 3 1  ON 59
ci_061                -1.664817e-03 3 1  ON 60
ci_062                -1.954680e-03 3 1  ON 61
ci_063                -1.096858e-03 3 1  ON 62
ci_064                -5.921277e-04 3 1  ON 63
ci_065                -1.160553e-03 3 1  ON 64
ci_066                -1.297627e-03 3 1  ON 65
ci_067                -1.338477e-03 3 1  ON 66
ci_068                -1.174465e-03 3 1  ON 67
ci_069                 1.393815e-03 3 1  ON 68
ci_070                 1.587904e-03 3 1  ON 69
ci_071                -1.353567e-03 3 1  ON 70
ci_072                -9.304533e-04 3 1  ON 71
ci_073                 1.130487e-03 3 1  ON 72
ci_074                 9.467460e-04 3 1  ON 73
ci_075                -1.100630e-03 3 1  ON 74
ci_076                -5.516452e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4827e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2188e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.3012
    reference variance = 4.15368
====================================================
  Execution time = 2.3611e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0335e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7463e+00
  Total weights = 1.950149270e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7742e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795707493148
                                         uncertainty =       0.046325855358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795707493148
                                         uncertainty =       0.046325855358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377602379
  error estimate for blocks of size 2^( 2) =       0.001448205711
  error estimate for blocks of size 2^( 3) =       0.001510247479
  error estimate for blocks of size 2^( 4) =       0.001553074234
  error estimate for blocks of size 2^( 5) =       0.001578859227
  error estimate for blocks of size 2^( 6) =       0.001590856102
  error estimate for blocks of size 2^( 7) =       0.001599890693

      target function =                  N/A
              le_mean =     -22.327229079448
             les_mean =     502.251481299471
             stat err =       0.001580670064
             autocorr =       1.316541909294
              std dev =       1.948255139233
             le_variance =       3.795698087549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232722907945e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327229078615       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327278281817       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327282444166       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327283947272       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327283986658       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327283891656       residual = 1.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-02 is 2.168337e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327229078615       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327252600576       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327252984297       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327253117905       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 9.028008e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327229078615       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327236696364       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327236658276       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 2.713386e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126750 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0392e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_001                -6.989785e-01 3 1  ON 0
ci_002                -7.011277e-01 3 1  ON 1
ci_003                -6.182940e-02 3 1  ON 2
ci_004                -6.094885e-02 3 1  ON 3
ci_005                 4.560937e-02 3 1  ON 4
ci_006                 4.592963e-02 3 1  ON 5
ci_007                 3.159851e-02 3 1  ON 6
ci_008                 3.130844e-02 3 1  ON 7
ci_009                -2.519091e-02 3 1  ON 8
ci_010                -2.598319e-02 3 1  ON 9
ci_011                -2.319064e-02 3 1  ON 10
ci_012                -2.219297e-02 3 1  ON 11
ci_013                 2.059434e-02 3 1  ON 12
ci_014                 2.067071e-02 3 1  ON 13
ci_015                 2.038251e-02 3 1  ON 14
ci_016                 1.997760e-02 3 1  ON 15
ci_017                 1.598047e-02 3 1  ON 16
ci_018                 1.611642e-02 3 1  ON 17
ci_019                 1.029696e-02 3 1  ON 18
ci_020                 1.055607e-02 3 1  ON 19
ci_021                -1.022110e-02 3 1  ON 20
ci_022                -1.050777e-02 3 1  ON 21
ci_023                 8.270402e-03 3 1  ON 22
ci_024                 8.978799e-03 3 1  ON 23
ci_025                 7.966446e-03 3 1  ON 24
ci_026                 8.230442e-03 3 1  ON 25
ci_027                 7.674115e-03 3 1  ON 26
ci_028                 8.176841e-03 3 1  ON 27
ci_029                -6.785637e-03 3 1  ON 28
ci_030                -7.116575e-03 3 1  ON 29
ci_031                -7.267135e-03 3 1  ON 30
ci_032                -7.192236e-03 3 1  ON 31
ci_033                 6.811396e-03 3 1  ON 32
ci_034                 7.564013e-03 3 1  ON 33
ci_035                 6.087562e-03 3 1  ON 34
ci_036                 6.152350e-03 3 1  ON 35
ci_037                 7.179591e-03 3 1  ON 36
ci_038                 6.323672e-03 3 1  ON 37
ci_039                 5.926641e-03 3 1  ON 38
ci_040                 5.148013e-03 3 1  ON 39
ci_041                 5.236745e-03 3 1  ON 40
ci_042                 5.335171e-03 3 1  ON 41
ci_043                 5.189812e-03 3 1  ON 42
ci_044                 5.494428e-03 3 1  ON 43
ci_045                 4.713585e-03 3 1  ON 44
ci_046                 4.929549e-03 3 1  ON 45
ci_047                -4.155681e-03 3 1  ON 46
ci_048                -4.281856e-03 3 1  ON 47
ci_049                 2.750871e-03 3 1  ON 48
ci_050                 3.822842e-03 3 1  ON 49
ci_051                -2.234474e-03 3 1  ON 50
ci_052                -2.924987e-03 3 1  ON 51
ci_053                -2.402720e-03 3 1  ON 52
ci_054                -3.003464e-03 3 1  ON 53
ci_055                -2.879485e-03 3 1  ON 54
ci_056                -1.885902e-03 3 1  ON 55
ci_057                -1.892536e-03 3 1  ON 56
ci_058                -2.473212e-03 3 1  ON 57
ci_059                -1.681045e-03 3 1  ON 58
ci_060                -2.036428e-03 3 1  ON 59
ci_061                -1.603117e-03 3 1  ON 60
ci_062                -1.807506e-03 3 1  ON 61
ci_063                -1.035611e-03 3 1  ON 62
ci_064                -7.466949e-04 3 1  ON 63
ci_065                -9.221035e-04 3 1  ON 64
ci_066                -1.517617e-03 3 1  ON 65
ci_067                -1.250781e-03 3 1  ON 66
ci_068                -1.380376e-03 3 1  ON 67
ci_069                 1.146217e-03 3 1  ON 68
ci_070                 1.629926e-03 3 1  ON 69
ci_071                -1.576277e-03 3 1  ON 70
ci_072                -9.578023e-04 3 1  ON 71
ci_073                 1.172426e-03 3 1  ON 72
ci_074                 1.053850e-03 3 1  ON 73
ci_075                -1.046408e-03 3 1  ON 74
ci_076                -8.671649e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.3266
    reference variance = 3.06836
====================================================
  Execution time = 2.2934e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7145e+00
  Total weights = 1.9497e+06
  Execution time = 4.4036e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762049665151
                                         uncertainty =       0.029415239232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762049665151
                                         uncertainty =       0.029415239232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371414516
  error estimate for blocks of size 2^( 2) =       0.001442424324
  error estimate for blocks of size 2^( 3) =       0.001506316481
  error estimate for blocks of size 2^( 4) =       0.001548003320
  error estimate for blocks of size 2^( 5) =       0.001572493120
  error estimate for blocks of size 2^( 6) =       0.001583906413
  error estimate for blocks of size 2^( 7) =       0.001592933889

      target function =                  N/A
              le_mean =     -22.327227495679
             les_mean =     502.236741621122
             stat err =       0.001574334185
             autocorr =       1.317820828748
              std dev =       1.939504040060
             le_variance =       3.761675921410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762537177645
                                         uncertainty =       0.029420579976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762537177645
                                         uncertainty =       0.029420579976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371503355
  error estimate for blocks of size 2^( 2) =       0.001442507521
  error estimate for blocks of size 2^( 3) =       0.001506382223
  error estimate for blocks of size 2^( 4) =       0.001548050261
  error estimate for blocks of size 2^( 5) =       0.001572526475
  error estimate for blocks of size 2^( 6) =       0.001583961035
  error estimate for blocks of size 2^( 7) =       0.001593007223

      target function =                  N/A
              le_mean =     -22.327218620377
             les_mean =     502.221406657980
             stat err =       0.001574386249
             autocorr =       1.317737262286
              std dev =       1.939629678975
             le_variance =       3.762163291561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762484978105
                                         uncertainty =       0.029423374529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762484978105
                                         uncertainty =       0.029423374529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371493873
  error estimate for blocks of size 2^( 2) =       0.001442497035
  error estimate for blocks of size 2^( 3) =       0.001506370289
  error estimate for blocks of size 2^( 4) =       0.001548039016
  error estimate for blocks of size 2^( 5) =       0.001572514339
  error estimate for blocks of size 2^( 6) =       0.001583946775
  error estimate for blocks of size 2^( 7) =       0.001592989137

      target function =                  N/A
              le_mean =     -22.327218106984
             les_mean =     502.220524719653
             stat err =       0.001574372317
             autocorr =       1.317732161316
              std dev =       1.939616269200
             le_variance =       3.762111271744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762092252361
                                         uncertainty =       0.029416222480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762092252361
                                         uncertainty =       0.029416222480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371422290
  error estimate for blocks of size 2^( 2) =       0.001442430773
  error estimate for blocks of size 2^( 3) =       0.001506321052
  error estimate for blocks of size 2^( 4) =       0.001548000740
  error estimate for blocks of size 2^( 5) =       0.001572486527
  error estimate for blocks of size 2^( 6) =       0.001583901715
  error estimate for blocks of size 2^( 7) =       0.001592943638

      target function =                  N/A
              le_mean =     -22.327223816461
             les_mean =     502.219554375323
             stat err =       0.001574333155
             autocorr =       1.317804164390
              std dev =       1.939515033472
             le_variance =       3.761718565064


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327227495679        initial  <--
     9.7656e-02     9.7656e-01             2.1683e-03       -22.327218620377
     3.9062e-01     3.9062e+00             9.0280e-04       -22.327218106984
     1.5625e+00     1.5625e+01             2.7134e-04       -22.327223816461

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9190
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_001                -6.990362e-01 3 1  ON 0
ci_002                -7.010591e-01 3 1  ON 1
ci_003                -6.194939e-02 3 1  ON 2
ci_004                -6.162424e-02 3 1  ON 3
ci_005                 4.551314e-02 3 1  ON 4
ci_006                 4.579294e-02 3 1  ON 5
ci_007                 3.155841e-02 3 1  ON 6
ci_008                 3.145780e-02 3 1  ON 7
ci_009                -2.524507e-02 3 1  ON 8
ci_010                -2.561300e-02 3 1  ON 9
ci_011                -2.273388e-02 3 1  ON 10
ci_012                -2.229414e-02 3 1  ON 11
ci_013                 2.016281e-02 3 1  ON 12
ci_014                 2.069974e-02 3 1  ON 13
ci_015                 2.074716e-02 3 1  ON 14
ci_016                 1.945043e-02 3 1  ON 15
ci_017                 1.610542e-02 3 1  ON 16
ci_018                 1.601967e-02 3 1  ON 17
ci_019                 9.448929e-03 3 1  ON 18
ci_020                 9.653273e-03 3 1  ON 19
ci_021                -9.874039e-03 3 1  ON 20
ci_022                -1.047616e-02 3 1  ON 21
ci_023                 8.672113e-03 3 1  ON 22
ci_024                 9.286446e-03 3 1  ON 23
ci_025                 7.784338e-03 3 1  ON 24
ci_026                 8.556922e-03 3 1  ON 25
ci_027                 8.076587e-03 3 1  ON 26
ci_028                 8.214654e-03 3 1  ON 27
ci_029                -6.619827e-03 3 1  ON 28
ci_030                -7.159725e-03 3 1  ON 29
ci_031                -7.259930e-03 3 1  ON 30
ci_032                -7.188415e-03 3 1  ON 31
ci_033                 6.850296e-03 3 1  ON 32
ci_034                 7.796855e-03 3 1  ON 33
ci_035                 6.476843e-03 3 1  ON 34
ci_036                 6.519830e-03 3 1  ON 35
ci_037                 6.976476e-03 3 1  ON 36
ci_038                 6.324851e-03 3 1  ON 37
ci_039                 5.828310e-03 3 1  ON 38
ci_040                 5.200607e-03 3 1  ON 39
ci_041                 5.009762e-03 3 1  ON 40
ci_042                 5.084458e-03 3 1  ON 41
ci_043                 5.328857e-03 3 1  ON 42
ci_044                 5.408513e-03 3 1  ON 43
ci_045                 4.661854e-03 3 1  ON 44
ci_046                 4.699657e-03 3 1  ON 45
ci_047                -3.904434e-03 3 1  ON 46
ci_048                -4.350714e-03 3 1  ON 47
ci_049                 2.914954e-03 3 1  ON 48
ci_050                 3.570423e-03 3 1  ON 49
ci_051                -2.675473e-03 3 1  ON 50
ci_052                -2.958171e-03 3 1  ON 51
ci_053                -2.229435e-03 3 1  ON 52
ci_054                -2.806492e-03 3 1  ON 53
ci_055                -3.170450e-03 3 1  ON 54
ci_056                -1.985126e-03 3 1  ON 55
ci_057                -1.758497e-03 3 1  ON 56
ci_058                -2.781574e-03 3 1  ON 57
ci_059                -1.804976e-03 3 1  ON 58
ci_060                -1.826910e-03 3 1  ON 59
ci_061                -1.664817e-03 3 1  ON 60
ci_062                -1.954680e-03 3 1  ON 61
ci_063                -1.096858e-03 3 1  ON 62
ci_064                -5.921277e-04 3 1  ON 63
ci_065                -1.160553e-03 3 1  ON 64
ci_066                -1.297627e-03 3 1  ON 65
ci_067                -1.338477e-03 3 1  ON 66
ci_068                -1.174465e-03 3 1  ON 67
ci_069                 1.393815e-03 3 1  ON 68
ci_070                 1.587904e-03 3 1  ON 69
ci_071                -1.353567e-03 3 1  ON 70
ci_072                -9.304533e-04 3 1  ON 71
ci_073                 1.130487e-03 3 1  ON 72
ci_074                 9.467460e-04 3 1  ON 73
ci_075                -1.100630e-03 3 1  ON 74
ci_076                -5.516452e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5318e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.153
    reference variance = 5.85108
====================================================
  Execution time = 2.3439e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0296e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7237e+00
  Total weights = 1.949988551e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8482e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774102260198
                                         uncertainty =       0.032621226396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774102260198
                                         uncertainty =       0.032621226396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373950719
  error estimate for blocks of size 2^( 2) =       0.001445191191
  error estimate for blocks of size 2^( 3) =       0.001509045981
  error estimate for blocks of size 2^( 4) =       0.001551744674
  error estimate for blocks of size 2^( 5) =       0.001575366749
  error estimate for blocks of size 2^( 6) =       0.001588436894
  error estimate for blocks of size 2^( 7) =       0.001597001366

      target function =                  N/A
              le_mean =     -22.329315417185
             les_mean =     502.322014858350
             stat err =       0.001578137421
             autocorr =       1.319311428591
              std dev =       1.943090829136
             le_variance =       3.775601970272


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232931541718e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329315416373       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329332623867       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329332598115       residual = 9.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 3.204038e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329315416373       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329320392558       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329320392768       residual = 6.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 9.832479e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329315416373       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329316711158       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329316713121       residual = 3.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+01 is 2.605337e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127950 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9294e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_001                -6.990332e-01 3 1  ON 0
ci_002                -7.010686e-01 3 1  ON 1
ci_003                -6.200456e-02 3 1  ON 2
ci_004                -6.156913e-02 3 1  ON 3
ci_005                 4.549666e-02 3 1  ON 4
ci_006                 4.575266e-02 3 1  ON 5
ci_007                 3.161448e-02 3 1  ON 6
ci_008                 3.142757e-02 3 1  ON 7
ci_009                -2.521601e-02 3 1  ON 8
ci_010                -2.554445e-02 3 1  ON 9
ci_011                -2.281071e-02 3 1  ON 10
ci_012                -2.230288e-02 3 1  ON 11
ci_013                 2.012976e-02 3 1  ON 12
ci_014                 2.064028e-02 3 1  ON 13
ci_015                 2.077350e-02 3 1  ON 14
ci_016                 1.944815e-02 3 1  ON 15
ci_017                 1.616933e-02 3 1  ON 16
ci_018                 1.601139e-02 3 1  ON 17
ci_019                 9.471910e-03 3 1  ON 18
ci_020                 9.708946e-03 3 1  ON 19
ci_021                -9.876940e-03 3 1  ON 20
ci_022                -1.047343e-02 3 1  ON 21
ci_023                 8.659394e-03 3 1  ON 22
ci_024                 9.283127e-03 3 1  ON 23
ci_025                 7.767452e-03 3 1  ON 24
ci_026                 8.504524e-03 3 1  ON 25
ci_027                 8.000480e-03 3 1  ON 26
ci_028                 8.224776e-03 3 1  ON 27
ci_029                -6.645804e-03 3 1  ON 28
ci_030                -7.178653e-03 3 1  ON 29
ci_031                -7.289399e-03 3 1  ON 30
ci_032                -7.180793e-03 3 1  ON 31
ci_033                 6.863753e-03 3 1  ON 32
ci_034                 7.725657e-03 3 1  ON 33
ci_035                 6.482429e-03 3 1  ON 34
ci_036                 6.476451e-03 3 1  ON 35
ci_037                 6.956115e-03 3 1  ON 36
ci_038                 6.320215e-03 3 1  ON 37
ci_039                 5.729986e-03 3 1  ON 38
ci_040                 5.245612e-03 3 1  ON 39
ci_041                 5.047386e-03 3 1  ON 40
ci_042                 5.133768e-03 3 1  ON 41
ci_043                 5.356002e-03 3 1  ON 42
ci_044                 5.348089e-03 3 1  ON 43
ci_045                 4.635108e-03 3 1  ON 44
ci_046                 4.673650e-03 3 1  ON 45
ci_047                -3.979175e-03 3 1  ON 46
ci_048                -4.329723e-03 3 1  ON 47
ci_049                 2.883881e-03 3 1  ON 48
ci_050                 3.565293e-03 3 1  ON 49
ci_051                -2.672002e-03 3 1  ON 50
ci_052                -2.943161e-03 3 1  ON 51
ci_053                -2.252935e-03 3 1  ON 52
ci_054                -2.808678e-03 3 1  ON 53
ci_055                -3.105874e-03 3 1  ON 54
ci_056                -1.994007e-03 3 1  ON 55
ci_057                -1.708287e-03 3 1  ON 56
ci_058                -2.695325e-03 3 1  ON 57
ci_059                -1.782100e-03 3 1  ON 58
ci_060                -1.785533e-03 3 1  ON 59
ci_061                -1.674037e-03 3 1  ON 60
ci_062                -1.917723e-03 3 1  ON 61
ci_063                -1.103861e-03 3 1  ON 62
ci_064                -5.720090e-04 3 1  ON 63
ci_065                -1.199632e-03 3 1  ON 64
ci_066                -1.270058e-03 3 1  ON 65
ci_067                -1.362229e-03 3 1  ON 66
ci_068                -1.221206e-03 3 1  ON 67
ci_069                 1.349225e-03 3 1  ON 68
ci_070                 1.582810e-03 3 1  ON 69
ci_071                -1.343059e-03 3 1  ON 70
ci_072                -8.988393e-04 3 1  ON 71
ci_073                 1.143828e-03 3 1  ON 72
ci_074                 1.031904e-03 3 1  ON 73
ci_075                -1.084217e-03 3 1  ON 74
ci_076                -5.876838e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.4492
    reference variance = 3.01454
====================================================
  Execution time = 2.2919e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7373e+00
  Total weights = 1.9499e+06
  Execution time = 4.3777e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789179383896
                                         uncertainty =       0.046189452317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789179383896
                                         uncertainty =       0.046189452317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376372172
  error estimate for blocks of size 2^( 2) =       0.001447645752
  error estimate for blocks of size 2^( 3) =       0.001511619522
  error estimate for blocks of size 2^( 4) =       0.001552355481
  error estimate for blocks of size 2^( 5) =       0.001579645248
  error estimate for blocks of size 2^( 6) =       0.001591403981
  error estimate for blocks of size 2^( 7) =       0.001598625244

      target function =                  N/A
              le_mean =     -22.327302034352
             les_mean =     502.248998703858
             stat err =       0.001580507488
             autocorr =       1.318625132335
              std dev =       1.946515336411
             le_variance =       3.788921954884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789188968944
                                         uncertainty =       0.046187903550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789188968944
                                         uncertainty =       0.046187903550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376373927
  error estimate for blocks of size 2^( 2) =       0.001447653783
  error estimate for blocks of size 2^( 3) =       0.001511634440
  error estimate for blocks of size 2^( 4) =       0.001552374676
  error estimate for blocks of size 2^( 5) =       0.001579666380
  error estimate for blocks of size 2^( 6) =       0.001591429838
  error estimate for blocks of size 2^( 7) =       0.001598662527

      target function =                  N/A
              le_mean =     -22.327303884944
             les_mean =     502.247732540561
             stat err =       0.001580533355
             autocorr =       1.318664931671
              std dev =       1.946517818219
             le_variance =       3.788931616645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789180797431
                                         uncertainty =       0.046188495566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789180797431
                                         uncertainty =       0.046188495566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376372437
  error estimate for blocks of size 2^( 2) =       0.001447650312
  error estimate for blocks of size 2^( 3) =       0.001511628762
  error estimate for blocks of size 2^( 4) =       0.001552366641
  error estimate for blocks of size 2^( 5) =       0.001579659031
  error estimate for blocks of size 2^( 6) =       0.001591420359
  error estimate for blocks of size 2^( 7) =       0.001598647248

      target function =                  N/A
              le_mean =     -22.327302660710
             les_mean =     502.245831369174
             stat err =       0.001580523320
             autocorr =       1.318651041815
              std dev =       1.946515710451
             le_variance =       3.788923411032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789178863923
                                         uncertainty =       0.046189318763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789178863923
                                         uncertainty =       0.046189318763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376372079
  error estimate for blocks of size 2^( 2) =       0.001447647044
  error estimate for blocks of size 2^( 3) =       0.001511622551
  error estimate for blocks of size 2^( 4) =       0.001552358205
  error estimate for blocks of size 2^( 5) =       0.001579651467
  error estimate for blocks of size 2^( 6) =       0.001591410322
  error estimate for blocks of size 2^( 7) =       0.001598630757

      target function =                  N/A
              le_mean =     -22.327301619873
             les_mean =     502.246267357318
             stat err =       0.001580512688
             autocorr =       1.318633987030
              std dev =       1.946515204227
             le_variance =       3.788921440285


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327302034352        initial
     9.7656e-01     9.7656e+00             3.2040e-04       -22.327303884944  <--
     3.9062e+00     3.9062e+01             9.8325e-05       -22.327302660710
     1.5625e+01     1.5625e+02             2.6053e-05       -22.327301619873

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 4.4832e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_001                -6.990248e-01 3 1  ON 0
ci_002                -7.010920e-01 3 1  ON 1
ci_003                -6.215843e-02 3 1  ON 2
ci_004                -6.141541e-02 3 1  ON 3
ci_005                 4.545980e-02 3 1  ON 4
ci_006                 4.565859e-02 3 1  ON 5
ci_007                 3.176279e-02 3 1  ON 6
ci_008                 3.135229e-02 3 1  ON 7
ci_009                -2.514235e-02 3 1  ON 8
ci_010                -2.536936e-02 3 1  ON 9
ci_011                -2.301072e-02 3 1  ON 10
ci_012                -2.232517e-02 3 1  ON 11
ci_013                 2.003746e-02 3 1  ON 12
ci_014                 2.048583e-02 3 1  ON 13
ci_015                 2.084319e-02 3 1  ON 14
ci_016                 1.943892e-02 3 1  ON 15
ci_017                 1.633701e-02 3 1  ON 16
ci_018                 1.598819e-02 3 1  ON 17
ci_019                 9.531985e-03 3 1  ON 18
ci_020                 9.858456e-03 3 1  ON 19
ci_021                -9.886252e-03 3 1  ON 20
ci_022                -1.046850e-02 3 1  ON 21
ci_023                 8.632000e-03 3 1  ON 22
ci_024                 9.274525e-03 3 1  ON 23
ci_025                 7.719114e-03 3 1  ON 24
ci_026                 8.365695e-03 3 1  ON 25
ci_027                 7.832696e-03 3 1  ON 26
ci_028                 8.247418e-03 3 1  ON 27
ci_029                -6.709705e-03 3 1  ON 28
ci_030                -7.226440e-03 3 1  ON 29
ci_031                -7.365412e-03 3 1  ON 30
ci_032                -7.162729e-03 3 1  ON 31
ci_033                 6.898126e-03 3 1  ON 32
ci_034                 7.541618e-03 3 1  ON 33
ci_035                 6.496089e-03 3 1  ON 34
ci_036                 6.372105e-03 3 1  ON 35
ci_037                 6.903935e-03 3 1  ON 36
ci_038                 6.306227e-03 3 1  ON 37
ci_039                 5.507907e-03 3 1  ON 38
ci_040                 5.349186e-03 3 1  ON 39
ci_041                 5.141260e-03 3 1  ON 40
ci_042                 5.251444e-03 3 1  ON 41
ci_043                 5.424021e-03 3 1  ON 42
ci_044                 5.202231e-03 3 1  ON 43
ci_045                 4.564336e-03 3 1  ON 44
ci_046                 4.609074e-03 3 1  ON 45
ci_047                -4.151918e-03 3 1  ON 46
ci_048                -4.277265e-03 3 1  ON 47
ci_049                 2.802744e-03 3 1  ON 48
ci_050                 3.551669e-03 3 1  ON 49
ci_051                -2.665650e-03 3 1  ON 50
ci_052                -2.903641e-03 3 1  ON 51
ci_053                -2.308798e-03 3 1  ON 52
ci_054                -2.816275e-03 3 1  ON 53
ci_055                -2.935110e-03 3 1  ON 54
ci_056                -2.014459e-03 3 1  ON 55
ci_057                -1.582782e-03 3 1  ON 56
ci_058                -2.478119e-03 3 1  ON 57
ci_059                -1.731697e-03 3 1  ON 58
ci_060                -1.691981e-03 3 1  ON 59
ci_061                -1.698153e-03 3 1  ON 60
ci_062                -1.826673e-03 3 1  ON 61
ci_063                -1.123084e-03 3 1  ON 62
ci_064                -5.208247e-04 3 1  ON 63
ci_065                -1.297817e-03 3 1  ON 64
ci_066                -1.196709e-03 3 1  ON 65
ci_067                -1.425042e-03 3 1  ON 66
ci_068                -1.340709e-03 3 1  ON 67
ci_069                 1.237891e-03 3 1  ON 68
ci_070                 1.568624e-03 3 1  ON 69
ci_071                -1.318376e-03 3 1  ON 70
ci_072                -8.180384e-04 3 1  ON 71
ci_073                 1.176192e-03 3 1  ON 72
ci_074                 1.220049e-03 3 1  ON 73
ci_075                -1.043616e-03 3 1  ON 74
ci_076                -6.739176e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4132e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.2623
    reference variance = 3.7238
====================================================
  Execution time = 2.3414e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0289e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7267e+00
  Total weights = 1.949859970e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9098e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780447922931
                                         uncertainty =       0.037094126130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780447922931
                                         uncertainty =       0.037094126130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374724040
  error estimate for blocks of size 2^( 2) =       0.001445609725
  error estimate for blocks of size 2^( 3) =       0.001507789248
  error estimate for blocks of size 2^( 4) =       0.001550363746
  error estimate for blocks of size 2^( 5) =       0.001579649379
  error estimate for blocks of size 2^( 6) =       0.001591508435
  error estimate for blocks of size 2^( 7) =       0.001598671057

      target function =                  N/A
              le_mean =     -22.328103793721
             les_mean =     502.270921875133
             stat err =       0.001580048154
             autocorr =       1.321020604192
              std dev =       1.944184487722
             le_variance =       3.779853322300


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232810379372e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328103792900       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328144020196       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328145034176       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328145052921       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328145051972       residual = 8.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 9.663299e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328103792900       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328118566980       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328118546315       residual = 8.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 2.726283e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328103792900       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328107977069       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328107958912       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 7.887985e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9333e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_001                -6.987672e-01 3 1  ON 0
ci_002                -7.012793e-01 3 1  ON 1
ci_003                -6.241740e-02 3 1  ON 2
ci_004                -6.138523e-02 3 1  ON 3
ci_005                 4.568689e-02 3 1  ON 4
ci_006                 4.571188e-02 3 1  ON 5
ci_007                 3.194631e-02 3 1  ON 6
ci_008                 3.136249e-02 3 1  ON 7
ci_009                -2.525109e-02 3 1  ON 8
ci_010                -2.542428e-02 3 1  ON 9
ci_011                -2.312987e-02 3 1  ON 10
ci_012                -2.231486e-02 3 1  ON 11
ci_013                 2.026386e-02 3 1  ON 12
ci_014                 2.030772e-02 3 1  ON 13
ci_015                 2.078291e-02 3 1  ON 14
ci_016                 1.963503e-02 3 1  ON 15
ci_017                 1.629049e-02 3 1  ON 16
ci_018                 1.582132e-02 3 1  ON 17
ci_019                 9.636489e-03 3 1  ON 18
ci_020                 9.872444e-03 3 1  ON 19
ci_021                -9.693613e-03 3 1  ON 20
ci_022                -1.042302e-02 3 1  ON 21
ci_023                 8.886527e-03 3 1  ON 22
ci_024                 9.226244e-03 3 1  ON 23
ci_025                 7.944822e-03 3 1  ON 24
ci_026                 8.423058e-03 3 1  ON 25
ci_027                 7.765092e-03 3 1  ON 26
ci_028                 8.165888e-03 3 1  ON 27
ci_029                -6.939158e-03 3 1  ON 28
ci_030                -7.426705e-03 3 1  ON 29
ci_031                -7.612134e-03 3 1  ON 30
ci_032                -7.163248e-03 3 1  ON 31
ci_033                 6.975996e-03 3 1  ON 32
ci_034                 7.559024e-03 3 1  ON 33
ci_035                 6.624990e-03 3 1  ON 34
ci_036                 6.525093e-03 3 1  ON 35
ci_037                 6.631307e-03 3 1  ON 36
ci_038                 6.201469e-03 3 1  ON 37
ci_039                 5.538399e-03 3 1  ON 38
ci_040                 5.589450e-03 3 1  ON 39
ci_041                 5.349050e-03 3 1  ON 40
ci_042                 5.201628e-03 3 1  ON 41
ci_043                 5.251875e-03 3 1  ON 42
ci_044                 5.161002e-03 3 1  ON 43
ci_045                 4.566526e-03 3 1  ON 44
ci_046                 4.842722e-03 3 1  ON 45
ci_047                -4.221746e-03 3 1  ON 46
ci_048                -4.318819e-03 3 1  ON 47
ci_049                 2.861750e-03 3 1  ON 48
ci_050                 3.512257e-03 3 1  ON 49
ci_051                -2.773745e-03 3 1  ON 50
ci_052                -2.891090e-03 3 1  ON 51
ci_053                -2.175453e-03 3 1  ON 52
ci_054                -2.655250e-03 3 1  ON 53
ci_055                -2.971060e-03 3 1  ON 54
ci_056                -2.147829e-03 3 1  ON 55
ci_057                -1.431354e-03 3 1  ON 56
ci_058                -2.459688e-03 3 1  ON 57
ci_059                -1.771255e-03 3 1  ON 58
ci_060                -1.761692e-03 3 1  ON 59
ci_061                -1.721405e-03 3 1  ON 60
ci_062                -1.874131e-03 3 1  ON 61
ci_063                -9.963054e-04 3 1  ON 62
ci_064                -6.654495e-04 3 1  ON 63
ci_065                -1.160764e-03 3 1  ON 64
ci_066                -1.185295e-03 3 1  ON 65
ci_067                -1.488911e-03 3 1  ON 66
ci_068                -1.398958e-03 3 1  ON 67
ci_069                 1.276239e-03 3 1  ON 68
ci_070                 1.506686e-03 3 1  ON 69
ci_071                -1.281967e-03 3 1  ON 70
ci_072                -7.910247e-04 3 1  ON 71
ci_073                 1.255269e-03 3 1  ON 72
ci_074                 1.302652e-03 3 1  ON 73
ci_075                -1.098749e-03 3 1  ON 74
ci_076                -8.255252e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.4998
    reference variance = 2.36769
====================================================
  Execution time = 2.2908e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7644e+00
  Total weights = 1.9495e+06
  Execution time = 4.3768e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00102119
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.817468957917
                                         uncertainty =       0.039741646583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.817468957917
                                         uncertainty =       0.039741646583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381353602
  error estimate for blocks of size 2^( 2) =       0.001451612668
  error estimate for blocks of size 2^( 3) =       0.001514580144
  error estimate for blocks of size 2^( 4) =       0.001554892783
  error estimate for blocks of size 2^( 5) =       0.001578916370
  error estimate for blocks of size 2^( 6) =       0.001591412904
  error estimate for blocks of size 2^( 7) =       0.001598198259

      target function =                  N/A
              le_mean =     -22.328011728356
             les_mean =     502.304478348585
             stat err =       0.001580855079
             autocorr =       1.309707724465
              std dev =       1.953560254464
             le_variance =       3.816397667820

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000168061
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.817731848438
                                         uncertainty =       0.039738193239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.817731848438
                                         uncertainty =       0.039738193239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381401265
  error estimate for blocks of size 2^( 2) =       0.001451639877
  error estimate for blocks of size 2^( 3) =       0.001514592247
  error estimate for blocks of size 2^( 4) =       0.001554879243
  error estimate for blocks of size 2^( 5) =       0.001578882685
  error estimate for blocks of size 2^( 6) =       0.001591360081
  error estimate for blocks of size 2^( 7) =       0.001598141503

      target function =                  N/A
              le_mean =     -22.328008903497
             les_mean =     502.313782856953
             stat err =       0.001580815878
             autocorr =       1.309552396992
              std dev =       1.953627661872
             le_variance =       3.816661041231

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00102972
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.817644166869
                                         uncertainty =       0.039740244589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.817644166869
                                         uncertainty =       0.039740244589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381385398
  error estimate for blocks of size 2^( 2) =       0.001451628279
  error estimate for blocks of size 2^( 3) =       0.001514584762
  error estimate for blocks of size 2^( 4) =       0.001554879175
  error estimate for blocks of size 2^( 5) =       0.001578889139
  error estimate for blocks of size 2^( 6) =       0.001591374558
  error estimate for blocks of size 2^( 7) =       0.001598153834

      target function =                  N/A
              le_mean =     -22.328004543184
             les_mean =     502.306752038723
             stat err =       0.001580824176
             autocorr =       1.309596231668
              std dev =       1.953605221043
             le_variance =       3.816573359685

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00286772
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.817488776639
                                         uncertainty =       0.039741565883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.817488776639
                                         uncertainty =       0.039741565883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381357203
  error estimate for blocks of size 2^( 2) =       0.001451613776
  error estimate for blocks of size 2^( 3) =       0.001514579123
  error estimate for blocks of size 2^( 4) =       0.001554888561
  error estimate for blocks of size 2^( 5) =       0.001578910326
  error estimate for blocks of size 2^( 6) =       0.001591402716
  error estimate for blocks of size 2^( 7) =       0.001598187712

      target function =                  N/A
              le_mean =     -22.328009833791
             les_mean =     502.305116458783
             stat err =       0.001580847329
             autocorr =       1.309688053463
              std dev =       1.953565347411
             le_variance =       3.816417566607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328011728356        initial  <--
     2.4414e-01     2.4414e+00             9.6633e-04       -22.328008903497
     9.7656e-01     9.7656e+00             2.7263e-04       -22.328004543184
     3.9062e+00     3.9062e+01             7.8880e-05       -22.328009833791

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7813
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_001                -6.990248e-01 3 1  ON 0
ci_002                -7.010920e-01 3 1  ON 1
ci_003                -6.215843e-02 3 1  ON 2
ci_004                -6.141541e-02 3 1  ON 3
ci_005                 4.545980e-02 3 1  ON 4
ci_006                 4.565859e-02 3 1  ON 5
ci_007                 3.176279e-02 3 1  ON 6
ci_008                 3.135229e-02 3 1  ON 7
ci_009                -2.514235e-02 3 1  ON 8
ci_010                -2.536936e-02 3 1  ON 9
ci_011                -2.301072e-02 3 1  ON 10
ci_012                -2.232517e-02 3 1  ON 11
ci_013                 2.003746e-02 3 1  ON 12
ci_014                 2.048583e-02 3 1  ON 13
ci_015                 2.084319e-02 3 1  ON 14
ci_016                 1.943892e-02 3 1  ON 15
ci_017                 1.633701e-02 3 1  ON 16
ci_018                 1.598819e-02 3 1  ON 17
ci_019                 9.531985e-03 3 1  ON 18
ci_020                 9.858456e-03 3 1  ON 19
ci_021                -9.886252e-03 3 1  ON 20
ci_022                -1.046850e-02 3 1  ON 21
ci_023                 8.632000e-03 3 1  ON 22
ci_024                 9.274525e-03 3 1  ON 23
ci_025                 7.719114e-03 3 1  ON 24
ci_026                 8.365695e-03 3 1  ON 25
ci_027                 7.832696e-03 3 1  ON 26
ci_028                 8.247418e-03 3 1  ON 27
ci_029                -6.709705e-03 3 1  ON 28
ci_030                -7.226440e-03 3 1  ON 29
ci_031                -7.365412e-03 3 1  ON 30
ci_032                -7.162729e-03 3 1  ON 31
ci_033                 6.898126e-03 3 1  ON 32
ci_034                 7.541618e-03 3 1  ON 33
ci_035                 6.496089e-03 3 1  ON 34
ci_036                 6.372105e-03 3 1  ON 35
ci_037                 6.903935e-03 3 1  ON 36
ci_038                 6.306227e-03 3 1  ON 37
ci_039                 5.507907e-03 3 1  ON 38
ci_040                 5.349186e-03 3 1  ON 39
ci_041                 5.141260e-03 3 1  ON 40
ci_042                 5.251444e-03 3 1  ON 41
ci_043                 5.424021e-03 3 1  ON 42
ci_044                 5.202231e-03 3 1  ON 43
ci_045                 4.564336e-03 3 1  ON 44
ci_046                 4.609074e-03 3 1  ON 45
ci_047                -4.151918e-03 3 1  ON 46
ci_048                -4.277265e-03 3 1  ON 47
ci_049                 2.802744e-03 3 1  ON 48
ci_050                 3.551669e-03 3 1  ON 49
ci_051                -2.665650e-03 3 1  ON 50
ci_052                -2.903641e-03 3 1  ON 51
ci_053                -2.308798e-03 3 1  ON 52
ci_054                -2.816275e-03 3 1  ON 53
ci_055                -2.935110e-03 3 1  ON 54
ci_056                -2.014459e-03 3 1  ON 55
ci_057                -1.582782e-03 3 1  ON 56
ci_058                -2.478119e-03 3 1  ON 57
ci_059                -1.731697e-03 3 1  ON 58
ci_060                -1.691981e-03 3 1  ON 59
ci_061                -1.698153e-03 3 1  ON 60
ci_062                -1.826673e-03 3 1  ON 61
ci_063                -1.123084e-03 3 1  ON 62
ci_064                -5.208247e-04 3 1  ON 63
ci_065                -1.297817e-03 3 1  ON 64
ci_066                -1.196709e-03 3 1  ON 65
ci_067                -1.425042e-03 3 1  ON 66
ci_068                -1.340709e-03 3 1  ON 67
ci_069                 1.237891e-03 3 1  ON 68
ci_070                 1.568624e-03 3 1  ON 69
ci_071                -1.318376e-03 3 1  ON 70
ci_072                -8.180384e-04 3 1  ON 71
ci_073                 1.176192e-03 3 1  ON 72
ci_074                 1.220049e-03 3 1  ON 73
ci_075                -1.043616e-03 3 1  ON 74
ci_076                -6.739176e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4128e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.0213
    reference variance = 6.47105
====================================================
  Execution time = 2.3403e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0295e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7974e+00
  Total weights = 1.949817236e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8165e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850423680221
                                         uncertainty =       0.057069889210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850423680221
                                         uncertainty =       0.057069889210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387606248
  error estimate for blocks of size 2^( 2) =       0.001458721966
  error estimate for blocks of size 2^( 3) =       0.001520964303
  error estimate for blocks of size 2^( 4) =       0.001563095968
  error estimate for blocks of size 2^( 5) =       0.001587025172
  error estimate for blocks of size 2^( 6) =       0.001601009854
  error estimate for blocks of size 2^( 7) =       0.001614132085

      target function =                  N/A
              le_mean =     -22.328213852558
             les_mean =     502.346513150829
             stat err =       0.001591315770
             autocorr =       1.315164991467
              std dev =       1.962402973096
             le_variance =       3.851025428817


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232821385256e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328213851767       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328222193883       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328222218119       residual = 4.35e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+00 is 2.000673e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328213851767       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328216061353       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328216068769       residual = 2.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+00 is 5.193372e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328213851767       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328214412503       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328214414543       residual = 2.83e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+01 is 1.317256e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133900 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9229e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_001                -6.990138e-01 3 1  ON 0
ci_002                -7.011039e-01 3 1  ON 1
ci_003                -6.218312e-02 3 1  ON 2
ci_004                -6.142259e-02 3 1  ON 3
ci_005                 4.543273e-02 3 1  ON 4
ci_006                 4.560692e-02 3 1  ON 5
ci_007                 3.178336e-02 3 1  ON 6
ci_008                 3.140423e-02 3 1  ON 7
ci_009                -2.512874e-02 3 1  ON 8
ci_010                -2.536664e-02 3 1  ON 9
ci_011                -2.298552e-02 3 1  ON 10
ci_012                -2.234834e-02 3 1  ON 11
ci_013                 2.003367e-02 3 1  ON 12
ci_014                 2.046516e-02 3 1  ON 13
ci_015                 2.081768e-02 3 1  ON 14
ci_016                 1.942232e-02 3 1  ON 15
ci_017                 1.634689e-02 3 1  ON 16
ci_018                 1.596777e-02 3 1  ON 17
ci_019                 9.527043e-03 3 1  ON 18
ci_020                 9.839382e-03 3 1  ON 19
ci_021                -9.888163e-03 3 1  ON 20
ci_022                -1.045439e-02 3 1  ON 21
ci_023                 8.640374e-03 3 1  ON 22
ci_024                 9.266841e-03 3 1  ON 23
ci_025                 7.720832e-03 3 1  ON 24
ci_026                 8.369222e-03 3 1  ON 25
ci_027                 7.813044e-03 3 1  ON 26
ci_028                 8.252529e-03 3 1  ON 27
ci_029                -6.729762e-03 3 1  ON 28
ci_030                -7.258149e-03 3 1  ON 29
ci_031                -7.370190e-03 3 1  ON 30
ci_032                -7.153838e-03 3 1  ON 31
ci_033                 6.878198e-03 3 1  ON 32
ci_034                 7.534227e-03 3 1  ON 33
ci_035                 6.502584e-03 3 1  ON 34
ci_036                 6.404452e-03 3 1  ON 35
ci_037                 6.909377e-03 3 1  ON 36
ci_038                 6.313473e-03 3 1  ON 37
ci_039                 5.528399e-03 3 1  ON 38
ci_040                 5.367042e-03 3 1  ON 39
ci_041                 5.172912e-03 3 1  ON 40
ci_042                 5.237576e-03 3 1  ON 41
ci_043                 5.416704e-03 3 1  ON 42
ci_044                 5.207581e-03 3 1  ON 43
ci_045                 4.544795e-03 3 1  ON 44
ci_046                 4.611725e-03 3 1  ON 45
ci_047                -4.178010e-03 3 1  ON 46
ci_048                -4.326240e-03 3 1  ON 47
ci_049                 2.825845e-03 3 1  ON 48
ci_050                 3.564765e-03 3 1  ON 49
ci_051                -2.642893e-03 3 1  ON 50
ci_052                -2.937778e-03 3 1  ON 51
ci_053                -2.318606e-03 3 1  ON 52
ci_054                -2.807122e-03 3 1  ON 53
ci_055                -2.916546e-03 3 1  ON 54
ci_056                -1.994624e-03 3 1  ON 55
ci_057                -1.597117e-03 3 1  ON 56
ci_058                -2.487240e-03 3 1  ON 57
ci_059                -1.720360e-03 3 1  ON 58
ci_060                -1.700553e-03 3 1  ON 59
ci_061                -1.720463e-03 3 1  ON 60
ci_062                -1.825078e-03 3 1  ON 61
ci_063                -1.139698e-03 3 1  ON 62
ci_064                -5.123081e-04 3 1  ON 63
ci_065                -1.287671e-03 3 1  ON 64
ci_066                -1.205953e-03 3 1  ON 65
ci_067                -1.436579e-03 3 1  ON 66
ci_068                -1.323130e-03 3 1  ON 67
ci_069                 1.253799e-03 3 1  ON 68
ci_070                 1.568111e-03 3 1  ON 69
ci_071                -1.313008e-03 3 1  ON 70
ci_072                -8.103787e-04 3 1  ON 71
ci_073                 1.184447e-03 3 1  ON 72
ci_074                 1.196703e-03 3 1  ON 73
ci_075                -1.027683e-03 3 1  ON 74
ci_076                -6.712109e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.1764
    reference variance = 3.50016
====================================================
  Execution time = 2.2835e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6796e+00
  Total weights = 1.9502e+06
  Execution time = 4.3703e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727985985911
                                         uncertainty =       0.028518519215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727985985911
                                         uncertainty =       0.028518519215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365071096
  error estimate for blocks of size 2^( 2) =       0.001435639318
  error estimate for blocks of size 2^( 3) =       0.001497891433
  error estimate for blocks of size 2^( 4) =       0.001542943553
  error estimate for blocks of size 2^( 5) =       0.001567958481
  error estimate for blocks of size 2^( 6) =       0.001580363664
  error estimate for blocks of size 2^( 7) =       0.001583082891

      target function =                  N/A
              le_mean =     -22.328061684919
             les_mean =     502.222128682040
             stat err =       0.001568587147
             autocorr =       1.320403790340
              std dev =       1.930532945259
             le_variance =       3.726957452730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727996171183
                                         uncertainty =       0.028518058388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727996171183
                                         uncertainty =       0.028518058388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365072959
  error estimate for blocks of size 2^( 2) =       0.001435645347
  error estimate for blocks of size 2^( 3) =       0.001497900733
  error estimate for blocks of size 2^( 4) =       0.001542952671
  error estimate for blocks of size 2^( 5) =       0.001567968097
  error estimate for blocks of size 2^( 6) =       0.001580377775
  error estimate for blocks of size 2^( 7) =       0.001583094250

      target function =                  N/A
              le_mean =     -22.328062340478
             les_mean =     502.222012296595
             stat err =       0.001568598199
             autocorr =       1.320418791644
              std dev =       1.930535580037
             le_variance =       3.726967625791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727990230153
                                         uncertainty =       0.028518305027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727990230153
                                         uncertainty =       0.028518305027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365071872
  error estimate for blocks of size 2^( 2) =       0.001435642392
  error estimate for blocks of size 2^( 3) =       0.001497896301
  error estimate for blocks of size 2^( 4) =       0.001542948418
  error estimate for blocks of size 2^( 5) =       0.001567963576
  error estimate for blocks of size 2^( 6) =       0.001580371272
  error estimate for blocks of size 2^( 7) =       0.001583089073

      target function =                  N/A
              le_mean =     -22.328061887058
             les_mean =     502.221929948399
             stat err =       0.001568593085
             autocorr =       1.320412284906
              std dev =       1.930534042708
             le_variance =       3.726961690056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727986393608
                                         uncertainty =       0.028518493838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727986393608
                                         uncertainty =       0.028518493838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365071170
  error estimate for blocks of size 2^( 2) =       0.001435639689
  error estimate for blocks of size 2^( 3) =       0.001497892026
  error estimate for blocks of size 2^( 4) =       0.001542944145
  error estimate for blocks of size 2^( 5) =       0.001567959086
  error estimate for blocks of size 2^( 6) =       0.001580364644
  error estimate for blocks of size 2^( 7) =       0.001583083695

      target function =                  N/A
              le_mean =     -22.328061688998
             les_mean =     502.221958331697
             stat err =       0.001568587892
             autocorr =       1.320404900682
              std dev =       1.930533050637
             le_variance =       3.726957859603


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328061684919        initial
     2.4414e+00     2.4414e+01             2.0007e-04       -22.328062340478  <--
     9.7656e+00     9.7656e+01             5.1934e-05       -22.328061887058
     3.9062e+01     3.9062e+02             1.3173e-05       -22.328061688998

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 4.4679e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_001                -6.989808e-01 3 1  ON 0
ci_002                -7.011385e-01 3 1  ON 1
ci_003                -6.225566e-02 3 1  ON 2
ci_004                -6.144381e-02 3 1  ON 3
ci_005                 4.535913e-02 3 1  ON 4
ci_006                 4.546680e-02 3 1  ON 5
ci_007                 3.184147e-02 3 1  ON 6
ci_008                 3.155236e-02 3 1  ON 7
ci_009                -2.509107e-02 3 1  ON 8
ci_010                -2.536051e-02 3 1  ON 9
ci_011                -2.291438e-02 3 1  ON 10
ci_012                -2.241529e-02 3 1  ON 11
ci_013                 2.002267e-02 3 1  ON 12
ci_014                 2.040730e-02 3 1  ON 13
ci_015                 2.074518e-02 3 1  ON 14
ci_016                 1.937430e-02 3 1  ON 15
ci_017                 1.637595e-02 3 1  ON 16
ci_018                 1.591038e-02 3 1  ON 17
ci_019                 9.512522e-03 3 1  ON 18
ci_020                 9.784320e-03 3 1  ON 19
ci_021                -9.894054e-03 3 1  ON 20
ci_022                -1.041490e-02 3 1  ON 21
ci_023                 8.664123e-03 3 1  ON 22
ci_024                 9.245796e-03 3 1  ON 23
ci_025                 7.725908e-03 3 1  ON 24
ci_026                 8.380184e-03 3 1  ON 25
ci_027                 7.760037e-03 3 1  ON 26
ci_028                 8.266319e-03 3 1  ON 27
ci_029                -6.786144e-03 3 1  ON 28
ci_030                -7.346949e-03 3 1  ON 29
ci_031                -7.383746e-03 3 1  ON 30
ci_032                -7.128894e-03 3 1  ON 31
ci_033                 6.821827e-03 3 1  ON 32
ci_034                 7.512962e-03 3 1  ON 33
ci_035                 6.519423e-03 3 1  ON 34
ci_036                 6.490375e-03 3 1  ON 35
ci_037                 6.924208e-03 3 1  ON 36
ci_038                 6.333133e-03 3 1  ON 37
ci_039                 5.583527e-03 3 1  ON 38
ci_040                 5.414895e-03 3 1  ON 39
ci_041                 5.259945e-03 3 1  ON 40
ci_042                 5.199695e-03 3 1  ON 41
ci_043                 5.395352e-03 3 1  ON 42
ci_044                 5.222492e-03 3 1  ON 43
ci_045                 4.490211e-03 3 1  ON 44
ci_046                 4.619404e-03 3 1  ON 45
ci_047                -4.247279e-03 3 1  ON 46
ci_048                -4.457082e-03 3 1  ON 47
ci_049                 2.890724e-03 3 1  ON 48
ci_050                 3.601380e-03 3 1  ON 49
ci_051                -2.578978e-03 3 1  ON 50
ci_052                -3.035028e-03 3 1  ON 51
ci_053                -2.347157e-03 3 1  ON 52
ci_054                -2.781001e-03 3 1  ON 53
ci_055                -2.863708e-03 3 1  ON 54
ci_056                -1.938219e-03 3 1  ON 55
ci_057                -1.637277e-03 3 1  ON 56
ci_058                -2.512506e-03 3 1  ON 57
ci_059                -1.689713e-03 3 1  ON 58
ci_060                -1.722994e-03 3 1  ON 59
ci_061                -1.782401e-03 3 1  ON 60
ci_062                -1.820935e-03 3 1  ON 61
ci_063                -1.186492e-03 3 1  ON 62
ci_064                -4.887628e-04 3 1  ON 63
ci_065                -1.259167e-03 3 1  ON 64
ci_066                -1.231396e-03 3 1  ON 65
ci_067                -1.469763e-03 3 1  ON 66
ci_068                -1.274527e-03 3 1  ON 67
ci_069                 1.298215e-03 3 1  ON 68
ci_070                 1.566977e-03 3 1  ON 69
ci_071                -1.298807e-03 3 1  ON 70
ci_072                -7.888510e-04 3 1  ON 71
ci_073                 1.206312e-03 3 1  ON 72
ci_074                 1.134360e-03 3 1  ON 73
ci_075                -9.832834e-04 3 1  ON 74
ci_076                -6.637255e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3922e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.3626
    reference variance = 3.67221
====================================================
  Execution time = 2.3451e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0295e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7386e+00
  Total weights = 1.949921744e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2639e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790892318687
                                         uncertainty =       0.046191744523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790892318687
                                         uncertainty =       0.046191744523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376685098
  error estimate for blocks of size 2^( 2) =       0.001447099660
  error estimate for blocks of size 2^( 3) =       0.001510290194
  error estimate for blocks of size 2^( 4) =       0.001554311313
  error estimate for blocks of size 2^( 5) =       0.001577117295
  error estimate for blocks of size 2^( 6) =       0.001593111589
  error estimate for blocks of size 2^( 7) =       0.001599573497

      target function =                  N/A
              le_mean =     -22.326548059300
             les_mean =     502.213317855867
             stat err =       0.001581028424
             autocorr =       1.318894730298
              std dev =       1.946957886703
             le_variance =       3.790645012595


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232654805930e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326548058481       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326569954086       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326569786839       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326569776506       residual = 1.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 5.077360e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326548058481       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326554699060       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326554668702       residual = 5.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+00 is 1.506950e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326548058481       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326549812062       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326549808053       residual = 3.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+00 is 3.953039e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136969 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1396e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_001                -6.989913e-01 3 1  ON 0
ci_002                -7.011348e-01 3 1  ON 1
ci_003                -6.235117e-02 3 1  ON 2
ci_004                -6.148936e-02 3 1  ON 3
ci_005                 4.524857e-02 3 1  ON 4
ci_006                 4.546513e-02 3 1  ON 5
ci_007                 3.178648e-02 3 1  ON 6
ci_008                 3.155240e-02 3 1  ON 7
ci_009                -2.501922e-02 3 1  ON 8
ci_010                -2.538715e-02 3 1  ON 9
ci_011                -2.286091e-02 3 1  ON 10
ci_012                -2.235705e-02 3 1  ON 11
ci_013                 2.003683e-02 3 1  ON 12
ci_014                 2.031868e-02 3 1  ON 13
ci_015                 2.075659e-02 3 1  ON 14
ci_016                 1.944233e-02 3 1  ON 15
ci_017                 1.631448e-02 3 1  ON 16
ci_018                 1.590344e-02 3 1  ON 17
ci_019                 9.470857e-03 3 1  ON 18
ci_020                 9.815167e-03 3 1  ON 19
ci_021                -9.873501e-03 3 1  ON 20
ci_022                -1.038190e-02 3 1  ON 21
ci_023                 8.687764e-03 3 1  ON 22
ci_024                 9.319531e-03 3 1  ON 23
ci_025                 7.666174e-03 3 1  ON 24
ci_026                 8.334186e-03 3 1  ON 25
ci_027                 7.821232e-03 3 1  ON 26
ci_028                 8.262560e-03 3 1  ON 27
ci_029                -6.737845e-03 3 1  ON 28
ci_030                -7.434680e-03 3 1  ON 29
ci_031                -7.465451e-03 3 1  ON 30
ci_032                -7.098949e-03 3 1  ON 31
ci_033                 6.915858e-03 3 1  ON 32
ci_034                 7.418181e-03 3 1  ON 33
ci_035                 6.479935e-03 3 1  ON 34
ci_036                 6.433486e-03 3 1  ON 35
ci_037                 6.858495e-03 3 1  ON 36
ci_038                 6.371276e-03 3 1  ON 37
ci_039                 5.492726e-03 3 1  ON 38
ci_040                 5.451407e-03 3 1  ON 39
ci_041                 5.322824e-03 3 1  ON 40
ci_042                 5.176543e-03 3 1  ON 41
ci_043                 5.317574e-03 3 1  ON 42
ci_044                 5.177888e-03 3 1  ON 43
ci_045                 4.509942e-03 3 1  ON 44
ci_046                 4.519802e-03 3 1  ON 45
ci_047                -4.152514e-03 3 1  ON 46
ci_048                -4.382343e-03 3 1  ON 47
ci_049                 2.936143e-03 3 1  ON 48
ci_050                 3.574381e-03 3 1  ON 49
ci_051                -2.729673e-03 3 1  ON 50
ci_052                -3.026433e-03 3 1  ON 51
ci_053                -2.376846e-03 3 1  ON 52
ci_054                -2.764480e-03 3 1  ON 53
ci_055                -2.790704e-03 3 1  ON 54
ci_056                -1.977321e-03 3 1  ON 55
ci_057                -1.691916e-03 3 1  ON 56
ci_058                -2.430732e-03 3 1  ON 57
ci_059                -1.737180e-03 3 1  ON 58
ci_060                -1.801869e-03 3 1  ON 59
ci_061                -1.790936e-03 3 1  ON 60
ci_062                -1.844127e-03 3 1  ON 61
ci_063                -1.246133e-03 3 1  ON 62
ci_064                -6.346927e-04 3 1  ON 63
ci_065                -1.233317e-03 3 1  ON 64
ci_066                -1.325174e-03 3 1  ON 65
ci_067                -1.446020e-03 3 1  ON 66
ci_068                -1.363141e-03 3 1  ON 67
ci_069                 1.229507e-03 3 1  ON 68
ci_070                 1.504010e-03 3 1  ON 69
ci_071                -1.213347e-03 3 1  ON 70
ci_072                -7.508394e-04 3 1  ON 71
ci_073                 1.192795e-03 3 1  ON 72
ci_074                 1.095456e-03 3 1  ON 73
ci_075                -9.201401e-04 3 1  ON 74
ci_076                -7.729158e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.3476
    reference variance = 2.92766
====================================================
  Execution time = 2.2904e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7272e+00
  Total weights = 1.9500e+06
  Execution time = 4.2988e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778174759743
                                         uncertainty =       0.026702042974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778174759743
                                         uncertainty =       0.026702042974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374315726
  error estimate for blocks of size 2^( 2) =       0.001445969153
  error estimate for blocks of size 2^( 3) =       0.001509766774
  error estimate for blocks of size 2^( 4) =       0.001552712797
  error estimate for blocks of size 2^( 5) =       0.001577555400
  error estimate for blocks of size 2^( 6) =       0.001591800832
  error estimate for blocks of size 2^( 7) =       0.001597683803

      target function =                  N/A
              le_mean =     -22.326360055590
             les_mean =     502.205829475858
             stat err =       0.001579938208
             autocorr =       1.321621732743
              std dev =       1.943607035732
             le_variance =       3.777608309345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778249745070
                                         uncertainty =       0.026722719705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778249745070
                                         uncertainty =       0.026722719705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374329311
  error estimate for blocks of size 2^( 2) =       0.001445990061
  error estimate for blocks of size 2^( 3) =       0.001509800082
  error estimate for blocks of size 2^( 4) =       0.001552759164
  error estimate for blocks of size 2^( 5) =       0.001577607291
  error estimate for blocks of size 2^( 6) =       0.001591855038
  error estimate for blocks of size 2^( 7) =       0.001597767515

      target function =                  N/A
              le_mean =     -22.326364252222
             les_mean =     502.194774272586
             stat err =       0.001579997252
             autocorr =       1.321694387038
              std dev =       1.943626247355
             le_variance =       3.777682989406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778212004654
                                         uncertainty =       0.026714047972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778212004654
                                         uncertainty =       0.026714047972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374322469
  error estimate for blocks of size 2^( 2) =       0.001445980430
  error estimate for blocks of size 2^( 3) =       0.001509785851
  error estimate for blocks of size 2^( 4) =       0.001552739600
  error estimate for blocks of size 2^( 5) =       0.001577584930
  error estimate for blocks of size 2^( 6) =       0.001591831798
  error estimate for blocks of size 2^( 7) =       0.001597734894

      target function =                  N/A
              le_mean =     -22.326361319323
             les_mean =     502.193737164967
             stat err =       0.001579972805
             autocorr =       1.321666645791
              std dev =       1.943616571729
             le_variance =       3.777645377901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778178031664
                                         uncertainty =       0.026703504115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778178031664
                                         uncertainty =       0.026703504115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374316317
  error estimate for blocks of size 2^( 2) =       0.001445970108
  error estimate for blocks of size 2^( 3) =       0.001509768523
  error estimate for blocks of size 2^( 4) =       0.001552715368
  error estimate for blocks of size 2^( 5) =       0.001577557890
  error estimate for blocks of size 2^( 6) =       0.001591803225
  error estimate for blocks of size 2^( 7) =       0.001597693493

      target function =                  N/A
              le_mean =     -22.326359535634
             les_mean =     502.193455335577
             stat err =       0.001579942494
             autocorr =       1.321627765981
              std dev =       1.943607872009
             le_variance =       3.777611560137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326360055590        initial
     6.1035e-01     6.1035e+00             5.0774e-04       -22.326364252222  <--
     2.4414e+00     2.4414e+01             1.5069e-04       -22.326361319323
     9.7656e+00     9.7656e+01             3.9530e-05       -22.326359535634

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 4.4590e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_001                -6.990130e-01 3 1  ON 0
ci_002                -7.011217e-01 3 1  ON 1
ci_003                -6.261579e-02 3 1  ON 2
ci_004                -6.161516e-02 3 1  ON 3
ci_005                 4.501667e-02 3 1  ON 4
ci_006                 4.546140e-02 3 1  ON 5
ci_007                 3.166218e-02 3 1  ON 6
ci_008                 3.154795e-02 3 1  ON 7
ci_009                -2.484603e-02 3 1  ON 8
ci_010                -2.545716e-02 3 1  ON 9
ci_011                -2.272661e-02 3 1  ON 10
ci_012                -2.221903e-02 3 1  ON 11
ci_013                 2.006710e-02 3 1  ON 12
ci_014                 2.010253e-02 3 1  ON 13
ci_015                 2.078768e-02 3 1  ON 14
ci_016                 1.962156e-02 3 1  ON 15
ci_017                 1.616134e-02 3 1  ON 16
ci_018                 1.589118e-02 3 1  ON 17
ci_019                 9.372369e-03 3 1  ON 18
ci_020                 9.894670e-03 3 1  ON 19
ci_021                -9.809210e-03 3 1  ON 20
ci_022                -1.029682e-02 3 1  ON 21
ci_023                 8.740878e-03 3 1  ON 22
ci_024                 9.488087e-03 3 1  ON 23
ci_025                 7.525072e-03 3 1  ON 24
ci_026                 8.224054e-03 3 1  ON 25
ci_027                 7.947747e-03 3 1  ON 26
ci_028                 8.253867e-03 3 1  ON 27
ci_029                -6.617133e-03 3 1  ON 28
ci_030                -7.638635e-03 3 1  ON 29
ci_031                -7.669965e-03 3 1  ON 30
ci_032                -7.029408e-03 3 1  ON 31
ci_033                 7.141403e-03 3 1  ON 32
ci_034                 7.198760e-03 3 1  ON 33
ci_035                 6.402349e-03 3 1  ON 34
ci_036                 6.318319e-03 3 1  ON 35
ci_037                 6.705622e-03 3 1  ON 36
ci_038                 6.454995e-03 3 1  ON 37
ci_039                 5.308093e-03 3 1  ON 38
ci_040                 5.523755e-03 3 1  ON 39
ci_041                 5.461694e-03 3 1  ON 40
ci_042                 5.123579e-03 3 1  ON 41
ci_043                 5.129147e-03 3 1  ON 42
ci_044                 5.074839e-03 3 1  ON 43
ci_045                 4.550122e-03 3 1  ON 44
ci_046                 4.291305e-03 3 1  ON 45
ci_047                -3.956878e-03 3 1  ON 46
ci_048                -4.235477e-03 3 1  ON 47
ci_049                 3.041944e-03 3 1  ON 48
ci_050                 3.510039e-03 3 1  ON 49
ci_051                -3.086714e-03 3 1  ON 50
ci_052                -3.003502e-03 3 1  ON 51
ci_053                -2.441680e-03 3 1  ON 52
ci_054                -2.729569e-03 3 1  ON 53
ci_055                -2.611286e-03 3 1  ON 54
ci_056                -2.070579e-03 3 1  ON 55
ci_057                -1.820416e-03 3 1  ON 56
ci_058                -2.246023e-03 3 1  ON 57
ci_059                -1.834208e-03 3 1  ON 58
ci_060                -1.958830e-03 3 1  ON 59
ci_061                -1.807981e-03 3 1  ON 60
ci_062                -1.893619e-03 3 1  ON 61
ci_063                -1.386273e-03 3 1  ON 62
ci_064                -9.849756e-04 3 1  ON 63
ci_065                -1.175988e-03 3 1  ON 64
ci_066                -1.537048e-03 3 1  ON 65
ci_067                -1.400175e-03 3 1  ON 66
ci_068                -1.573891e-03 3 1  ON 67
ci_069                 1.067916e-03 3 1  ON 68
ci_070                 1.362688e-03 3 1  ON 69
ci_071                -1.004433e-03 3 1  ON 70
ci_072                -6.643745e-04 3 1  ON 71
ci_073                 1.166828e-03 3 1  ON 72
ci_074                 1.016581e-03 3 1  ON 73
ci_075                -7.720061e-04 3 1  ON 74
ci_076                -1.018271e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6002e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.1141
    reference variance = 5.17023
====================================================
  Execution time = 2.3465e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0284e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7256e+00
  Total weights = 1.949935172e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9724e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776899796314
                                         uncertainty =       0.034179563493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776899796314
                                         uncertainty =       0.034179563493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374230013
  error estimate for blocks of size 2^( 2) =       0.001445169172
  error estimate for blocks of size 2^( 3) =       0.001505925070
  error estimate for blocks of size 2^( 4) =       0.001549696214
  error estimate for blocks of size 2^( 5) =       0.001570655487
  error estimate for blocks of size 2^( 6) =       0.001581030237
  error estimate for blocks of size 2^( 7) =       0.001585123373

      target function =                  N/A
              le_mean =     -22.330328664272
             les_mean =     502.369139093781
             stat err =       0.001571626328
             autocorr =       1.307915638375
              std dev =       1.943485817013
             le_variance =       3.777137120932


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233032866427e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330328663470       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330391451233       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330391009296       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330391441950       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.330391479884       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-01 is 1.244706e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330328663470       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330355501850       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330355244421       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330355270518       residual = 3.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 5.385750e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330328663470       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330336820462       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330336795356       residual = 5.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+00 is 1.776831e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140435 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9449e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_001                -6.991688e-01 3 1  ON 0
ci_002                -7.009511e-01 3 1  ON 1
ci_003                -6.258969e-02 3 1  ON 2
ci_004                -6.163450e-02 3 1  ON 3
ci_005                 4.544838e-02 3 1  ON 4
ci_006                 4.554269e-02 3 1  ON 5
ci_007                 3.163693e-02 3 1  ON 6
ci_008                 3.129231e-02 3 1  ON 7
ci_009                -2.530241e-02 3 1  ON 8
ci_010                -2.512074e-02 3 1  ON 9
ci_011                -2.270657e-02 3 1  ON 10
ci_012                -2.183187e-02 3 1  ON 11
ci_013                 2.007681e-02 3 1  ON 12
ci_014                 2.031103e-02 3 1  ON 13
ci_015                 2.077107e-02 3 1  ON 14
ci_016                 1.994247e-02 3 1  ON 15
ci_017                 1.576812e-02 3 1  ON 16
ci_018                 1.604369e-02 3 1  ON 17
ci_019                 9.476247e-03 3 1  ON 18
ci_020                 9.892448e-03 3 1  ON 19
ci_021                -9.893255e-03 3 1  ON 20
ci_022                -1.064299e-02 3 1  ON 21
ci_023                 8.534614e-03 3 1  ON 22
ci_024                 9.572662e-03 3 1  ON 23
ci_025                 7.046032e-03 3 1  ON 24
ci_026                 8.207776e-03 3 1  ON 25
ci_027                 7.409172e-03 3 1  ON 26
ci_028                 7.937637e-03 3 1  ON 27
ci_029                -6.799378e-03 3 1  ON 28
ci_030                -7.954040e-03 3 1  ON 29
ci_031                -7.644119e-03 3 1  ON 30
ci_032                -7.064048e-03 3 1  ON 31
ci_033                 6.679366e-03 3 1  ON 32
ci_034                 7.099482e-03 3 1  ON 33
ci_035                 6.421551e-03 3 1  ON 34
ci_036                 6.403428e-03 3 1  ON 35
ci_037                 6.555866e-03 3 1  ON 36
ci_038                 6.667060e-03 3 1  ON 37
ci_039                 5.447587e-03 3 1  ON 38
ci_040                 5.733067e-03 3 1  ON 39
ci_041                 5.283163e-03 3 1  ON 40
ci_042                 5.057064e-03 3 1  ON 41
ci_043                 5.023765e-03 3 1  ON 42
ci_044                 5.128050e-03 3 1  ON 43
ci_045                 4.342792e-03 3 1  ON 44
ci_046                 4.469125e-03 3 1  ON 45
ci_047                -4.161519e-03 3 1  ON 46
ci_048                -4.180058e-03 3 1  ON 47
ci_049                 2.828942e-03 3 1  ON 48
ci_050                 3.286814e-03 3 1  ON 49
ci_051                -3.005691e-03 3 1  ON 50
ci_052                -2.816055e-03 3 1  ON 51
ci_053                -2.629463e-03 3 1  ON 52
ci_054                -2.860702e-03 3 1  ON 53
ci_055                -2.538019e-03 3 1  ON 54
ci_056                -2.115631e-03 3 1  ON 55
ci_057                -2.281326e-03 3 1  ON 56
ci_058                -2.453887e-03 3 1  ON 57
ci_059                -1.953745e-03 3 1  ON 58
ci_060                -2.003275e-03 3 1  ON 59
ci_061                -2.037625e-03 3 1  ON 60
ci_062                -2.140960e-03 3 1  ON 61
ci_063                -1.304103e-03 3 1  ON 62
ci_064                -1.365518e-03 3 1  ON 63
ci_065                -1.462312e-03 3 1  ON 64
ci_066                -1.493993e-03 3 1  ON 65
ci_067                -9.776085e-04 3 1  ON 66
ci_068                -1.741980e-03 3 1  ON 67
ci_069                 1.132943e-03 3 1  ON 68
ci_070                 1.523899e-03 3 1  ON 69
ci_071                -9.939711e-04 3 1  ON 70
ci_072                -1.002066e-03 3 1  ON 71
ci_073                 1.290558e-03 3 1  ON 72
ci_074                 1.111410e-03 3 1  ON 73
ci_075                -5.616351e-04 3 1  ON 74
ci_076                -9.541359e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -21.7902
    reference variance = 4.82664
====================================================
  Execution time = 2.2984e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7519e+00
  Total weights = 1.9498e+06
  Execution time = 4.2948e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804000110452
                                         uncertainty =       0.053791892372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804000110452
                                         uncertainty =       0.053791892372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379117445
  error estimate for blocks of size 2^( 2) =       0.001450994185
  error estimate for blocks of size 2^( 3) =       0.001514201208
  error estimate for blocks of size 2^( 4) =       0.001556941947
  error estimate for blocks of size 2^( 5) =       0.001583300279
  error estimate for blocks of size 2^( 6) =       0.001594885481
  error estimate for blocks of size 2^( 7) =       0.001598918854

      target function =                  N/A
              le_mean =     -22.328143005814
             les_mean =     502.299892490896
             stat err =       0.001583511640
             autocorr =       1.318378209935
              std dev =       1.950397799867
             le_variance =       3.804051577728

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.270057
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804313935472
                                         uncertainty =       0.053793904389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804313935472
                                         uncertainty =       0.053793904389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379174175
  error estimate for blocks of size 2^( 2) =       0.001451039261
  error estimate for blocks of size 2^( 3) =       0.001514233765
  error estimate for blocks of size 2^( 4) =       0.001556981246
  error estimate for blocks of size 2^( 5) =       0.001583310390
  error estimate for blocks of size 2^( 6) =       0.001594904319
  error estimate for blocks of size 2^( 7) =       0.001598994939

      target function =                  N/A
              le_mean =     -22.328142389888
             les_mean =     502.304872731009
             stat err =       0.001583547723
             autocorr =       1.318329831766
              std dev =       1.950478030311
             le_variance =       3.804364546725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804284071081
                                         uncertainty =       0.053794950269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804284071081
                                         uncertainty =       0.053794950269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379168701
  error estimate for blocks of size 2^( 2) =       0.001451029876
  error estimate for blocks of size 2^( 3) =       0.001514229996
  error estimate for blocks of size 2^( 4) =       0.001556978497
  error estimate for blocks of size 2^( 5) =       0.001583312673
  error estimate for blocks of size 2^( 6) =       0.001594929978
  error estimate for blocks of size 2^( 7) =       0.001599013789

      target function =                  N/A
              le_mean =     -22.328144036920
             les_mean =     503.182211256968
             stat err =       0.001583558734
             autocorr =       1.318358631151
              std dev =       1.950470288197
             le_variance =       3.804334345141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804022976936
                                         uncertainty =       0.053792315409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.804022976936
                                         uncertainty =       0.053792315409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379121558
  error estimate for blocks of size 2^( 2) =       0.001450996379
  error estimate for blocks of size 2^( 3) =       0.001514201879
  error estimate for blocks of size 2^( 4) =       0.001556944607
  error estimate for blocks of size 2^( 5) =       0.001583300201
  error estimate for blocks of size 2^( 6) =       0.001594887123
  error estimate for blocks of size 2^( 7) =       0.001598930966

      target function =                  N/A
              le_mean =     -22.328137760325
             les_mean =     502.298108463235
             stat err =       0.001583515724
             autocorr =       1.318377145187
              std dev =       1.950403617820
             le_variance =       3.804074272404


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328143005814        initial
     1.5259e-01     1.5259e+00             1.2447e-03       -22.328142389888
     6.1035e-01     6.1035e+00             5.3857e-04       -22.328144036920  <--
     2.4414e+00     2.4414e+01             1.7768e-04       -22.328137760325

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 4.4636e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_001                -6.991688e-01 3 1  ON 0
ci_002                -7.009511e-01 3 1  ON 1
ci_003                -6.258969e-02 3 1  ON 2
ci_004                -6.163450e-02 3 1  ON 3
ci_005                 4.544838e-02 3 1  ON 4
ci_006                 4.554269e-02 3 1  ON 5
ci_007                 3.163693e-02 3 1  ON 6
ci_008                 3.129231e-02 3 1  ON 7
ci_009                -2.530241e-02 3 1  ON 8
ci_010                -2.512074e-02 3 1  ON 9
ci_011                -2.270657e-02 3 1  ON 10
ci_012                -2.183187e-02 3 1  ON 11
ci_013                 2.007681e-02 3 1  ON 12
ci_014                 2.031103e-02 3 1  ON 13
ci_015                 2.077107e-02 3 1  ON 14
ci_016                 1.994247e-02 3 1  ON 15
ci_017                 1.576812e-02 3 1  ON 16
ci_018                 1.604369e-02 3 1  ON 17
ci_019                 9.476247e-03 3 1  ON 18
ci_020                 9.892448e-03 3 1  ON 19
ci_021                -9.893255e-03 3 1  ON 20
ci_022                -1.064299e-02 3 1  ON 21
ci_023                 8.534614e-03 3 1  ON 22
ci_024                 9.572662e-03 3 1  ON 23
ci_025                 7.046032e-03 3 1  ON 24
ci_026                 8.207776e-03 3 1  ON 25
ci_027                 7.409172e-03 3 1  ON 26
ci_028                 7.937637e-03 3 1  ON 27
ci_029                -6.799378e-03 3 1  ON 28
ci_030                -7.954040e-03 3 1  ON 29
ci_031                -7.644119e-03 3 1  ON 30
ci_032                -7.064048e-03 3 1  ON 31
ci_033                 6.679366e-03 3 1  ON 32
ci_034                 7.099482e-03 3 1  ON 33
ci_035                 6.421551e-03 3 1  ON 34
ci_036                 6.403428e-03 3 1  ON 35
ci_037                 6.555866e-03 3 1  ON 36
ci_038                 6.667060e-03 3 1  ON 37
ci_039                 5.447587e-03 3 1  ON 38
ci_040                 5.733067e-03 3 1  ON 39
ci_041                 5.283163e-03 3 1  ON 40
ci_042                 5.057064e-03 3 1  ON 41
ci_043                 5.023765e-03 3 1  ON 42
ci_044                 5.128050e-03 3 1  ON 43
ci_045                 4.342792e-03 3 1  ON 44
ci_046                 4.469125e-03 3 1  ON 45
ci_047                -4.161519e-03 3 1  ON 46
ci_048                -4.180058e-03 3 1  ON 47
ci_049                 2.828942e-03 3 1  ON 48
ci_050                 3.286814e-03 3 1  ON 49
ci_051                -3.005691e-03 3 1  ON 50
ci_052                -2.816055e-03 3 1  ON 51
ci_053                -2.629463e-03 3 1  ON 52
ci_054                -2.860702e-03 3 1  ON 53
ci_055                -2.538019e-03 3 1  ON 54
ci_056                -2.115631e-03 3 1  ON 55
ci_057                -2.281326e-03 3 1  ON 56
ci_058                -2.453887e-03 3 1  ON 57
ci_059                -1.953745e-03 3 1  ON 58
ci_060                -2.003275e-03 3 1  ON 59
ci_061                -2.037625e-03 3 1  ON 60
ci_062                -2.140960e-03 3 1  ON 61
ci_063                -1.304103e-03 3 1  ON 62
ci_064                -1.365518e-03 3 1  ON 63
ci_065                -1.462312e-03 3 1  ON 64
ci_066                -1.493993e-03 3 1  ON 65
ci_067                -9.776085e-04 3 1  ON 66
ci_068                -1.741980e-03 3 1  ON 67
ci_069                 1.132943e-03 3 1  ON 68
ci_070                 1.523899e-03 3 1  ON 69
ci_071                -9.939711e-04 3 1  ON 70
ci_072                -1.002066e-03 3 1  ON 71
ci_073                 1.290558e-03 3 1  ON 72
ci_074                 1.111410e-03 3 1  ON 73
ci_075                -5.616351e-04 3 1  ON 74
ci_076                -9.541359e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4100e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7744
    reference variance = 1.30735
====================================================
  Execution time = 2.3455e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0278e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.9194e+00
  Total weights = 1.949855045e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9122e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.970436569855
                                         uncertainty =       0.149816882289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.970436569855
                                         uncertainty =       0.149816882289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001408873839
  error estimate for blocks of size 2^( 2) =       0.001477809427
  error estimate for blocks of size 2^( 3) =       0.001540693293
  error estimate for blocks of size 2^( 4) =       0.001583293572
  error estimate for blocks of size 2^( 5) =       0.001609063574
  error estimate for blocks of size 2^( 6) =       0.001617261839
  error estimate for blocks of size 2^( 7) =       0.001631605838

      target function =                  N/A
              le_mean =     -22.327887172051
             les_mean =     502.453927961462
             stat err =       0.001610306206
             autocorr =       1.306389626748
              std dev =       1.992480369875
             le_variance =       3.969978024337


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232788717205e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327887171244       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327965503619       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327967245187       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327966896152       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327967249737       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327967289619       residual = 4.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-01 is 1.502802e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327887171244       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327920055716       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327919971246       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327919923720       residual = 6.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 5.507355e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327887171244       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327897073847       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327897037324       residual = 9.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+00 is 1.715811e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144157 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9378e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_001                -6.988925e-01 3 1  ON 0
ci_002                -7.012112e-01 3 1  ON 1
ci_003                -6.247098e-02 3 1  ON 2
ci_004                -6.173462e-02 3 1  ON 3
ci_005                 4.567107e-02 3 1  ON 4
ci_006                 4.556952e-02 3 1  ON 5
ci_007                 3.169303e-02 3 1  ON 6
ci_008                 3.139557e-02 3 1  ON 7
ci_009                -2.486671e-02 3 1  ON 8
ci_010                -2.539154e-02 3 1  ON 9
ci_011                -2.236952e-02 3 1  ON 10
ci_012                -2.161549e-02 3 1  ON 11
ci_013                 1.955429e-02 3 1  ON 12
ci_014                 2.063913e-02 3 1  ON 13
ci_015                 2.024264e-02 3 1  ON 14
ci_016                 2.029497e-02 3 1  ON 15
ci_017                 1.594704e-02 3 1  ON 16
ci_018                 1.634849e-02 3 1  ON 17
ci_019                 9.815627e-03 3 1  ON 18
ci_020                 9.647754e-03 3 1  ON 19
ci_021                -9.445167e-03 3 1  ON 20
ci_022                -1.064762e-02 3 1  ON 21
ci_023                 8.357218e-03 3 1  ON 22
ci_024                 9.811262e-03 3 1  ON 23
ci_025                 7.388440e-03 3 1  ON 24
ci_026                 7.969367e-03 3 1  ON 25
ci_027                 7.528091e-03 3 1  ON 26
ci_028                 8.127384e-03 3 1  ON 27
ci_029                -6.910414e-03 3 1  ON 28
ci_030                -8.041338e-03 3 1  ON 29
ci_031                -7.843853e-03 3 1  ON 30
ci_032                -6.878252e-03 3 1  ON 31
ci_033                 6.801677e-03 3 1  ON 32
ci_034                 7.165224e-03 3 1  ON 33
ci_035                 6.476495e-03 3 1  ON 34
ci_036                 6.926420e-03 3 1  ON 35
ci_037                 6.761411e-03 3 1  ON 36
ci_038                 6.901431e-03 3 1  ON 37
ci_039                 5.735787e-03 3 1  ON 38
ci_040                 5.667526e-03 3 1  ON 39
ci_041                 5.250513e-03 3 1  ON 40
ci_042                 5.256312e-03 3 1  ON 41
ci_043                 4.803274e-03 3 1  ON 42
ci_044                 5.109643e-03 3 1  ON 43
ci_045                 4.580210e-03 3 1  ON 44
ci_046                 4.493860e-03 3 1  ON 45
ci_047                -4.146727e-03 3 1  ON 46
ci_048                -4.086952e-03 3 1  ON 47
ci_049                 3.200626e-03 3 1  ON 48
ci_050                 3.478694e-03 3 1  ON 49
ci_051                -2.906378e-03 3 1  ON 50
ci_052                -2.265320e-03 3 1  ON 51
ci_053                -2.717275e-03 3 1  ON 52
ci_054                -3.094598e-03 3 1  ON 53
ci_055                -2.613387e-03 3 1  ON 54
ci_056                -2.346223e-03 3 1  ON 55
ci_057                -2.458981e-03 3 1  ON 56
ci_058                -2.404531e-03 3 1  ON 57
ci_059                -2.184015e-03 3 1  ON 58
ci_060                -1.834806e-03 3 1  ON 59
ci_061                -2.095384e-03 3 1  ON 60
ci_062                -2.355483e-03 3 1  ON 61
ci_063                -1.308535e-03 3 1  ON 62
ci_064                -8.309765e-04 3 1  ON 63
ci_065                -1.478485e-03 3 1  ON 64
ci_066                -1.526221e-03 3 1  ON 65
ci_067                -7.432710e-04 3 1  ON 66
ci_068                -1.825842e-03 3 1  ON 67
ci_069                 1.241534e-03 3 1  ON 68
ci_070                 1.520321e-03 3 1  ON 69
ci_071                -1.137302e-03 3 1  ON 70
ci_072                -6.018134e-04 3 1  ON 71
ci_073                 1.295611e-03 3 1  ON 72
ci_074                 9.093657e-04 3 1  ON 73
ci_075                -7.568255e-04 3 1  ON 74
ci_076                -8.140497e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.4498
    reference variance = 3.45267
====================================================
  Execution time = 2.2915e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7542e+00
  Total weights = 1.9501e+06
  Execution time = 4.2917e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.806696669573
                                         uncertainty =       0.043156303568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.806696669573
                                         uncertainty =       0.043156303568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379636522
  error estimate for blocks of size 2^( 2) =       0.001451955338
  error estimate for blocks of size 2^( 3) =       0.001515951494
  error estimate for blocks of size 2^( 4) =       0.001558144165
  error estimate for blocks of size 2^( 5) =       0.001587632328
  error estimate for blocks of size 2^( 6) =       0.001602388531
  error estimate for blocks of size 2^( 7) =       0.001621888680

      target function =                  N/A
              le_mean =     -22.329051054532
             les_mean =     502.341093905797
             stat err =       0.001592513426
             autocorr =       1.332406798081
              std dev =       1.951131897664
             le_variance =       3.806915682080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807862950174
                                         uncertainty =       0.043127034752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807862950174
                                         uncertainty =       0.043127034752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379848033
  error estimate for blocks of size 2^( 2) =       0.001452154506
  error estimate for blocks of size 2^( 3) =       0.001516137598
  error estimate for blocks of size 2^( 4) =       0.001558347819
  error estimate for blocks of size 2^( 5) =       0.001587822517
  error estimate for blocks of size 2^( 6) =       0.001602599492
  error estimate for blocks of size 2^( 7) =       0.001622099588

      target function =                  N/A
              le_mean =     -22.329080247506
             les_mean =     502.742564288462
             stat err =       0.001592717354
             autocorr =       1.332339509192
              std dev =       1.951431024366
             le_variance =       3.808083042857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.809274620932
                                         uncertainty =       0.043105041838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.809274620932
                                         uncertainty =       0.043105041838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380103992
  error estimate for blocks of size 2^( 2) =       0.001452388713
  error estimate for blocks of size 2^( 3) =       0.001516365251
  error estimate for blocks of size 2^( 4) =       0.001558565032
  error estimate for blocks of size 2^( 5) =       0.001587984518
  error estimate for blocks of size 2^( 6) =       0.001602815229
  error estimate for blocks of size 2^( 7) =       0.001622319399

      target function =                  N/A
              le_mean =     -22.329099833050
             les_mean =     503.822577405536
             stat err =       0.001592921045
             autocorr =       1.332186032510
              std dev =       1.951793010289
             le_variance =       3.809495955011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.806688826758
                                         uncertainty =       0.043156728155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.806688826758
                                         uncertainty =       0.043156728155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379635095
  error estimate for blocks of size 2^( 2) =       0.001451951779
  error estimate for blocks of size 2^( 3) =       0.001515945414
  error estimate for blocks of size 2^( 4) =       0.001558136492
  error estimate for blocks of size 2^( 5) =       0.001587625274
  error estimate for blocks of size 2^( 6) =       0.001602383175
  error estimate for blocks of size 2^( 7) =       0.001621879029

      target function =                  N/A
              le_mean =     -22.329047441096
             les_mean =     502.340651179601
             stat err =       0.001592505993
             autocorr =       1.332397115698
              std dev =       1.951129879515
             le_variance =       3.806907806736


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329051054532        initial
     1.5259e-01     1.5259e+00             1.5028e-03       -22.329080247506
     6.1035e-01     6.1035e+00             5.5074e-04       -22.329099833050  <--
     2.4414e+00     2.4414e+01             1.7158e-04       -22.329047441096

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 4.4569e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_001                -6.988925e-01 3 1  ON 0
ci_002                -7.012112e-01 3 1  ON 1
ci_003                -6.247098e-02 3 1  ON 2
ci_004                -6.173462e-02 3 1  ON 3
ci_005                 4.567107e-02 3 1  ON 4
ci_006                 4.556952e-02 3 1  ON 5
ci_007                 3.169303e-02 3 1  ON 6
ci_008                 3.139557e-02 3 1  ON 7
ci_009                -2.486671e-02 3 1  ON 8
ci_010                -2.539154e-02 3 1  ON 9
ci_011                -2.236952e-02 3 1  ON 10
ci_012                -2.161549e-02 3 1  ON 11
ci_013                 1.955429e-02 3 1  ON 12
ci_014                 2.063913e-02 3 1  ON 13
ci_015                 2.024264e-02 3 1  ON 14
ci_016                 2.029497e-02 3 1  ON 15
ci_017                 1.594704e-02 3 1  ON 16
ci_018                 1.634849e-02 3 1  ON 17
ci_019                 9.815627e-03 3 1  ON 18
ci_020                 9.647754e-03 3 1  ON 19
ci_021                -9.445167e-03 3 1  ON 20
ci_022                -1.064762e-02 3 1  ON 21
ci_023                 8.357218e-03 3 1  ON 22
ci_024                 9.811262e-03 3 1  ON 23
ci_025                 7.388440e-03 3 1  ON 24
ci_026                 7.969367e-03 3 1  ON 25
ci_027                 7.528091e-03 3 1  ON 26
ci_028                 8.127384e-03 3 1  ON 27
ci_029                -6.910414e-03 3 1  ON 28
ci_030                -8.041338e-03 3 1  ON 29
ci_031                -7.843853e-03 3 1  ON 30
ci_032                -6.878252e-03 3 1  ON 31
ci_033                 6.801677e-03 3 1  ON 32
ci_034                 7.165224e-03 3 1  ON 33
ci_035                 6.476495e-03 3 1  ON 34
ci_036                 6.926420e-03 3 1  ON 35
ci_037                 6.761411e-03 3 1  ON 36
ci_038                 6.901431e-03 3 1  ON 37
ci_039                 5.735787e-03 3 1  ON 38
ci_040                 5.667526e-03 3 1  ON 39
ci_041                 5.250513e-03 3 1  ON 40
ci_042                 5.256312e-03 3 1  ON 41
ci_043                 4.803274e-03 3 1  ON 42
ci_044                 5.109643e-03 3 1  ON 43
ci_045                 4.580210e-03 3 1  ON 44
ci_046                 4.493860e-03 3 1  ON 45
ci_047                -4.146727e-03 3 1  ON 46
ci_048                -4.086952e-03 3 1  ON 47
ci_049                 3.200626e-03 3 1  ON 48
ci_050                 3.478694e-03 3 1  ON 49
ci_051                -2.906378e-03 3 1  ON 50
ci_052                -2.265320e-03 3 1  ON 51
ci_053                -2.717275e-03 3 1  ON 52
ci_054                -3.094598e-03 3 1  ON 53
ci_055                -2.613387e-03 3 1  ON 54
ci_056                -2.346223e-03 3 1  ON 55
ci_057                -2.458981e-03 3 1  ON 56
ci_058                -2.404531e-03 3 1  ON 57
ci_059                -2.184015e-03 3 1  ON 58
ci_060                -1.834806e-03 3 1  ON 59
ci_061                -2.095384e-03 3 1  ON 60
ci_062                -2.355483e-03 3 1  ON 61
ci_063                -1.308535e-03 3 1  ON 62
ci_064                -8.309765e-04 3 1  ON 63
ci_065                -1.478485e-03 3 1  ON 64
ci_066                -1.526221e-03 3 1  ON 65
ci_067                -7.432710e-04 3 1  ON 66
ci_068                -1.825842e-03 3 1  ON 67
ci_069                 1.241534e-03 3 1  ON 68
ci_070                 1.520321e-03 3 1  ON 69
ci_071                -1.137302e-03 3 1  ON 70
ci_072                -6.018134e-04 3 1  ON 71
ci_073                 1.295611e-03 3 1  ON 72
ci_074                 9.093657e-04 3 1  ON 73
ci_075                -7.568255e-04 3 1  ON 74
ci_076                -8.140497e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3964e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.5546
    reference variance = 3.44159
====================================================
  Execution time = 2.3342e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0334e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7766e+00
  Total weights = 1.949645449e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9873e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830162072055
                                         uncertainty =       0.072998409864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830162072055
                                         uncertainty =       0.072998409864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383801761
  error estimate for blocks of size 2^( 2) =       0.001454747268
  error estimate for blocks of size 2^( 3) =       0.001516927990
  error estimate for blocks of size 2^( 4) =       0.001559945217
  error estimate for blocks of size 2^( 5) =       0.001583017274
  error estimate for blocks of size 2^( 6) =       0.001597073713
  error estimate for blocks of size 2^( 7) =       0.001606938553

      target function =                  N/A
              le_mean =     -22.328043884168
             les_mean =     502.318167218521
             stat err =       0.001586743689
             autocorr =       1.314818485336
              std dev =       1.957022530093
             le_variance =       3.829937183290


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232804388417e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328043883386       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328102177804       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328104656668       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328104482654       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328104572164       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-01 is 1.442242e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328043883386       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328068702924       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328069085016       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328069072501       residual = 4.54e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 5.871699e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328043883386       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328051411379       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328051480261       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+00 is 1.746921e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147596 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9340e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_001                -6.990002e-01 3 1  ON 0
ci_002                -7.010926e-01 3 1  ON 1
ci_003                -6.267938e-02 3 1  ON 2
ci_004                -6.188934e-02 3 1  ON 3
ci_005                 4.579044e-02 3 1  ON 4
ci_006                 4.568080e-02 3 1  ON 5
ci_007                 3.157978e-02 3 1  ON 6
ci_008                 3.112660e-02 3 1  ON 7
ci_009                -2.530576e-02 3 1  ON 8
ci_010                -2.523667e-02 3 1  ON 9
ci_011                -2.238935e-02 3 1  ON 10
ci_012                -2.150135e-02 3 1  ON 11
ci_013                 1.962436e-02 3 1  ON 12
ci_014                 2.048754e-02 3 1  ON 13
ci_015                 1.999758e-02 3 1  ON 14
ci_016                 2.007086e-02 3 1  ON 15
ci_017                 1.589592e-02 3 1  ON 16
ci_018                 1.685787e-02 3 1  ON 17
ci_019                 9.734597e-03 3 1  ON 18
ci_020                 9.422782e-03 3 1  ON 19
ci_021                -9.539032e-03 3 1  ON 20
ci_022                -1.017337e-02 3 1  ON 21
ci_023                 8.638509e-03 3 1  ON 22
ci_024                 9.612012e-03 3 1  ON 23
ci_025                 7.304307e-03 3 1  ON 24
ci_026                 8.147978e-03 3 1  ON 25
ci_027                 7.739094e-03 3 1  ON 26
ci_028                 8.012225e-03 3 1  ON 27
ci_029                -7.096457e-03 3 1  ON 28
ci_030                -7.928734e-03 3 1  ON 29
ci_031                -7.417983e-03 3 1  ON 30
ci_032                -6.911285e-03 3 1  ON 31
ci_033                 6.723403e-03 3 1  ON 32
ci_034                 7.151214e-03 3 1  ON 33
ci_035                 6.637116e-03 3 1  ON 34
ci_036                 6.980090e-03 3 1  ON 35
ci_037                 6.196438e-03 3 1  ON 36
ci_038                 6.319786e-03 3 1  ON 37
ci_039                 5.508192e-03 3 1  ON 38
ci_040                 5.491334e-03 3 1  ON 39
ci_041                 5.402997e-03 3 1  ON 40
ci_042                 5.255137e-03 3 1  ON 41
ci_043                 5.088320e-03 3 1  ON 42
ci_044                 4.847010e-03 3 1  ON 43
ci_045                 4.517292e-03 3 1  ON 44
ci_046                 4.472598e-03 3 1  ON 45
ci_047                -4.073082e-03 3 1  ON 46
ci_048                -4.361851e-03 3 1  ON 47
ci_049                 3.481340e-03 3 1  ON 48
ci_050                 3.535377e-03 3 1  ON 49
ci_051                -2.844166e-03 3 1  ON 50
ci_052                -2.560971e-03 3 1  ON 51
ci_053                -2.694842e-03 3 1  ON 52
ci_054                -3.681768e-03 3 1  ON 53
ci_055                -2.427399e-03 3 1  ON 54
ci_056                -2.625713e-03 3 1  ON 55
ci_057                -2.208972e-03 3 1  ON 56
ci_058                -2.214753e-03 3 1  ON 57
ci_059                -2.111101e-03 3 1  ON 58
ci_060                -1.922358e-03 3 1  ON 59
ci_061                -1.741442e-03 3 1  ON 60
ci_062                -1.900557e-03 3 1  ON 61
ci_063                -1.409265e-03 3 1  ON 62
ci_064                -7.760590e-04 3 1  ON 63
ci_065                -1.984570e-03 3 1  ON 64
ci_066                -1.364065e-03 3 1  ON 65
ci_067                -8.707296e-04 3 1  ON 66
ci_068                -1.769342e-03 3 1  ON 67
ci_069                 9.427367e-04 3 1  ON 68
ci_070                 1.697734e-03 3 1  ON 69
ci_071                -1.200987e-03 3 1  ON 70
ci_072                -7.245273e-04 3 1  ON 71
ci_073                 1.432795e-03 3 1  ON 72
ci_074                 1.049814e-03 3 1  ON 73
ci_075                -7.316318e-04 3 1  ON 74
ci_076                -1.046903e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.017
    reference variance = 5.75404
====================================================
  Execution time = 2.2825e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7213e+00
  Total weights = 1.9498e+06
  Execution time = 4.2972e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773448041983
                                         uncertainty =       0.034480771667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773448041983
                                         uncertainty =       0.034480771667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373476424
  error estimate for blocks of size 2^( 2) =       0.001444748621
  error estimate for blocks of size 2^( 3) =       0.001507992658
  error estimate for blocks of size 2^( 4) =       0.001554692139
  error estimate for blocks of size 2^( 5) =       0.001580603057
  error estimate for blocks of size 2^( 6) =       0.001591677742
  error estimate for blocks of size 2^( 7) =       0.001603952114

      target function =                  N/A
              le_mean =     -22.328340498408
             les_mean =     502.283475883597
             stat err =       0.001582731263
             autocorr =       1.327920097551
              std dev =       1.942420063765
             le_variance =       3.772995704118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773549146634
                                         uncertainty =       0.034477899100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773549146634
                                         uncertainty =       0.034477899100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373494558
  error estimate for blocks of size 2^( 2) =       0.001444766029
  error estimate for blocks of size 2^( 3) =       0.001508006942
  error estimate for blocks of size 2^( 4) =       0.001554694205
  error estimate for blocks of size 2^( 5) =       0.001580585678
  error estimate for blocks of size 2^( 6) =       0.001591635949
  error estimate for blocks of size 2^( 7) =       0.001603967058

      target function =                  N/A
              le_mean =     -22.328349558169
             les_mean =     502.367004106868
             stat err =       0.001582720722
             autocorr =       1.327867345912
              std dev =       1.942445710189
             le_variance =       3.773095337031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773389661290
                                         uncertainty =       0.034482824762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773389661290
                                         uncertainty =       0.034482824762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373465616
  error estimate for blocks of size 2^( 2) =       0.001444735302
  error estimate for blocks of size 2^( 3) =       0.001507971571
  error estimate for blocks of size 2^( 4) =       0.001554656475
  error estimate for blocks of size 2^( 5) =       0.001580556998
  error estimate for blocks of size 2^( 6) =       0.001591633137
  error estimate for blocks of size 2^( 7) =       0.001603966202

      target function =                  N/A
              le_mean =     -22.328333450751
             les_mean =     502.277880275589
             stat err =       0.001582703203
             autocorr =       1.327893910008
              std dev =       1.942404780009
             le_variance =       3.772936329404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773410369267
                                         uncertainty =       0.034481253219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773410369267
                                         uncertainty =       0.034481253219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373469545
  error estimate for blocks of size 2^( 2) =       0.001444741731
  error estimate for blocks of size 2^( 3) =       0.001507983333
  error estimate for blocks of size 2^( 4) =       0.001554682305
  error estimate for blocks of size 2^( 5) =       0.001580594018
  error estimate for blocks of size 2^( 6) =       0.001591662911
  error estimate for blocks of size 2^( 7) =       0.001603946533

      target function =                  N/A
              le_mean =     -22.328335079772
             les_mean =     502.277757196844
             stat err =       0.001582721442
             autocorr =       1.327916918865
              std dev =       1.942410335383
             le_variance =       3.772957911003


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328340498408        initial
     1.5259e-01     1.5259e+00             1.4422e-03       -22.328349558169  <--
     6.1035e-01     6.1035e+00             5.8717e-04       -22.328333450751
     2.4414e+00     2.4414e+01             1.7469e-04       -22.328335079772

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 4.4434e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_001                -6.993623e-01 3 1  ON 0
ci_002                -7.006995e-01 3 1  ON 1
ci_003                -6.315905e-02 3 1  ON 2
ci_004                -6.225938e-02 3 1  ON 3
ci_005                 4.592610e-02 3 1  ON 4
ci_006                 4.582699e-02 3 1  ON 5
ci_007                 3.138951e-02 3 1  ON 6
ci_008                 3.076329e-02 3 1  ON 7
ci_009                -2.598082e-02 3 1  ON 8
ci_010                -2.502139e-02 3 1  ON 9
ci_011                -2.241825e-02 3 1  ON 10
ci_012                -2.126693e-02 3 1  ON 11
ci_013                 1.965523e-02 3 1  ON 12
ci_014                 2.020270e-02 3 1  ON 13
ci_015                 1.952825e-02 3 1  ON 14
ci_016                 1.969193e-02 3 1  ON 15
ci_017                 1.583092e-02 3 1  ON 16
ci_018                 1.766737e-02 3 1  ON 17
ci_019                 9.626189e-03 3 1  ON 18
ci_020                 8.968263e-03 3 1  ON 19
ci_021                -9.748862e-03 3 1  ON 20
ci_022                -9.370293e-03 3 1  ON 21
ci_023                 9.005935e-03 3 1  ON 22
ci_024                 9.346351e-03 3 1  ON 23
ci_025                 7.136473e-03 3 1  ON 24
ci_026                 8.423228e-03 3 1  ON 25
ci_027                 7.964082e-03 3 1  ON 26
ci_028                 7.905438e-03 3 1  ON 27
ci_029                -7.343659e-03 3 1  ON 28
ci_030                -7.778150e-03 3 1  ON 29
ci_031                -6.713852e-03 3 1  ON 30
ci_032                -7.008352e-03 3 1  ON 31
ci_033                 6.638471e-03 3 1  ON 32
ci_034                 7.147130e-03 3 1  ON 33
ci_035                 6.833896e-03 3 1  ON 34
ci_036                 7.020744e-03 3 1  ON 35
ci_037                 5.447040e-03 3 1  ON 36
ci_038                 5.503787e-03 3 1  ON 37
ci_039                 5.263017e-03 3 1  ON 38
ci_040                 5.323826e-03 3 1  ON 39
ci_041                 5.588902e-03 3 1  ON 40
ci_042                 5.248519e-03 3 1  ON 41
ci_043                 5.476993e-03 3 1  ON 42
ci_044                 4.489488e-03 3 1  ON 43
ci_045                 4.455627e-03 3 1  ON 44
ci_046                 4.407842e-03 3 1  ON 45
ci_047                -4.009102e-03 3 1  ON 46
ci_048                -4.607371e-03 3 1  ON 47
ci_049                 3.881899e-03 3 1  ON 48
ci_050                 3.592475e-03 3 1  ON 49
ci_051                -2.740291e-03 3 1  ON 50
ci_052                -2.965491e-03 3 1  ON 51
ci_053                -2.658299e-03 3 1  ON 52
ci_054                -4.536840e-03 3 1  ON 53
ci_055                -2.168374e-03 3 1  ON 54
ci_056                -3.102489e-03 3 1  ON 55
ci_057                -1.884072e-03 3 1  ON 56
ci_058                -1.984749e-03 3 1  ON 57
ci_059                -2.035094e-03 3 1  ON 58
ci_060                -2.010615e-03 3 1  ON 59
ci_061                -1.275026e-03 3 1  ON 60
ci_062                -1.357669e-03 3 1  ON 61
ci_063                -1.555208e-03 3 1  ON 62
ci_064                -7.118508e-04 3 1  ON 63
ci_065                -2.656366e-03 3 1  ON 64
ci_066                -1.173384e-03 3 1  ON 65
ci_067                -1.025383e-03 3 1  ON 66
ci_068                -1.635303e-03 3 1  ON 67
ci_069                 5.789454e-04 3 1  ON 68
ci_070                 1.950076e-03 3 1  ON 69
ci_071                -1.293623e-03 3 1  ON 70
ci_072                -8.494895e-04 3 1  ON 71
ci_073                 1.577203e-03 3 1  ON 72
ci_074                 1.183248e-03 3 1  ON 73
ci_075                -6.868826e-04 3 1  ON 74
ci_076                -1.349545e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3789e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2232e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.1663
    reference variance = 3.94273
====================================================
  Execution time = 2.3419e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0317e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.8093e+00
  Total weights = 1.950185207e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9879e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.863168924030
                                         uncertainty =       0.052629806255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.863168924030
                                         uncertainty =       0.052629806255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389819785
  error estimate for blocks of size 2^( 2) =       0.001461180315
  error estimate for blocks of size 2^( 3) =       0.001523933623
  error estimate for blocks of size 2^( 4) =       0.001567972423
  error estimate for blocks of size 2^( 5) =       0.001593980165
  error estimate for blocks of size 2^( 6) =       0.001608347686
  error estimate for blocks of size 2^( 7) =       0.001618121933

      target function =                  N/A
              le_mean =     -22.327044879724
             les_mean =     502.306195486216
             stat err =       0.001597105552
             autocorr =       1.320536042136
              std dev =       1.965533436742
             le_variance =       3.863321690949


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232704487972e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327044878936       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327120227932       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327127867619       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327127323265       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327127494422       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327127696212       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327127866416       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.327127780170       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-02 is 1.945867e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327044878936       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327095308457       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327098484100       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327098227850       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327098203142       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-01 is 1.258614e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327044878936       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327066588646       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327067350304       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327067332352       residual = 6.81e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 5.279776e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2058e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_001                -6.995562e-01 3 1  ON 0
ci_002                -7.003129e-01 3 1  ON 1
ci_003                -6.296944e-02 3 1  ON 2
ci_004                -6.233531e-02 3 1  ON 3
ci_005                 4.624819e-02 3 1  ON 4
ci_006                 4.575081e-02 3 1  ON 5
ci_007                 3.171828e-02 3 1  ON 6
ci_008                 3.143921e-02 3 1  ON 7
ci_009                -2.622815e-02 3 1  ON 8
ci_010                -2.495300e-02 3 1  ON 9
ci_011                -2.289140e-02 3 1  ON 10
ci_012                -2.237073e-02 3 1  ON 11
ci_013                 2.040724e-02 3 1  ON 12
ci_014                 1.999696e-02 3 1  ON 13
ci_015                 2.017459e-02 3 1  ON 14
ci_016                 2.066421e-02 3 1  ON 15
ci_017                 1.563404e-02 3 1  ON 16
ci_018                 1.728473e-02 3 1  ON 17
ci_019                 1.007029e-02 3 1  ON 18
ci_020                 9.149840e-03 3 1  ON 19
ci_021                -9.576768e-03 3 1  ON 20
ci_022                -9.239446e-03 3 1  ON 21
ci_023                 9.111261e-03 3 1  ON 22
ci_024                 9.014314e-03 3 1  ON 23
ci_025                 7.024860e-03 3 1  ON 24
ci_026                 7.714077e-03 3 1  ON 25
ci_027                 7.644653e-03 3 1  ON 26
ci_028                 7.859271e-03 3 1  ON 27
ci_029                -8.368175e-03 3 1  ON 28
ci_030                -8.492350e-03 3 1  ON 29
ci_031                -7.606978e-03 3 1  ON 30
ci_032                -6.850404e-03 3 1  ON 31
ci_033                 7.084430e-03 3 1  ON 32
ci_034                 7.128739e-03 3 1  ON 33
ci_035                 6.561505e-03 3 1  ON 34
ci_036                 6.782708e-03 3 1  ON 35
ci_037                 5.754230e-03 3 1  ON 36
ci_038                 5.931830e-03 3 1  ON 37
ci_039                 5.881280e-03 3 1  ON 38
ci_040                 5.380720e-03 3 1  ON 39
ci_041                 5.449572e-03 3 1  ON 40
ci_042                 5.540006e-03 3 1  ON 41
ci_043                 6.372964e-03 3 1  ON 42
ci_044                 4.470957e-03 3 1  ON 43
ci_045                 5.714242e-03 3 1  ON 44
ci_046                 5.051894e-03 3 1  ON 45
ci_047                -4.715012e-03 3 1  ON 46
ci_048                -4.883044e-03 3 1  ON 47
ci_049                 3.558079e-03 3 1  ON 48
ci_050                 3.745780e-03 3 1  ON 49
ci_051                -2.797487e-03 3 1  ON 50
ci_052                -2.373647e-03 3 1  ON 51
ci_053                -2.614160e-03 3 1  ON 52
ci_054                -4.352467e-03 3 1  ON 53
ci_055                -2.961315e-03 3 1  ON 54
ci_056                -2.216882e-03 3 1  ON 55
ci_057                -1.730598e-03 3 1  ON 56
ci_058                -1.708452e-03 3 1  ON 57
ci_059                -2.615916e-03 3 1  ON 58
ci_060                -1.808938e-03 3 1  ON 59
ci_061                -1.501104e-03 3 1  ON 60
ci_062                -1.910992e-03 3 1  ON 61
ci_063                -1.426900e-03 3 1  ON 62
ci_064                -1.400317e-03 3 1  ON 63
ci_065                -1.743737e-03 3 1  ON 64
ci_066                -1.200361e-03 3 1  ON 65
ci_067                -2.156928e-03 3 1  ON 66
ci_068                -1.637222e-03 3 1  ON 67
ci_069                 1.546789e-03 3 1  ON 68
ci_070                 1.623215e-03 3 1  ON 69
ci_071                -8.284704e-04 3 1  ON 70
ci_072                -7.325119e-04 3 1  ON 71
ci_073                 1.531916e-03 3 1  ON 72
ci_074                 1.296896e-03 3 1  ON 73
ci_075                -4.322743e-04 3 1  ON 74
ci_076                -1.221735e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.3548
    reference variance = 3.41561
====================================================
  Execution time = 2.3379e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7339e+00
  Total weights = 1.9500e+06
  Execution time = 4.2811e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.295283
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       5.602985006451
                                         uncertainty =       1.814041127185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       5.602985006451
                                         uncertainty =       1.814041127185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001672719764
  error estimate for blocks of size 2^( 2) =       0.001731989962
  error estimate for blocks of size 2^( 3) =       0.001784634173
  error estimate for blocks of size 2^( 4) =       0.001819687407
  error estimate for blocks of size 2^( 5) =       0.001836065025
  error estimate for blocks of size 2^( 6) =       0.001851407508
  error estimate for blocks of size 2^( 7) =       0.001861485492

      target function =                  N/A
              le_mean =     -22.329000512784
             les_mean =     963.707244105949
             stat err =       0.001842161358
             autocorr =       1.212855213434
              std dev =       2.365620825841
             le_variance =       5.596161891654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783925304425
                                         uncertainty =       0.029162510507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783925304425
                                         uncertainty =       0.029162510507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375314095
  error estimate for blocks of size 2^( 2) =       0.001446686114
  error estimate for blocks of size 2^( 3) =       0.001508876425
  error estimate for blocks of size 2^( 4) =       0.001551309484
  error estimate for blocks of size 2^( 5) =       0.001572240945
  error estimate for blocks of size 2^( 6) =       0.001589012828
  error estimate for blocks of size 2^( 7) =       0.001598831530

      target function =                  N/A
              le_mean =     -22.327960464404
             les_mean =     502.299414241559
             stat err =       0.001577848697
             autocorr =       1.316215263462
              std dev =       1.945018965691
             le_variance =       3.783098776896

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.280974
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784434039927
                                         uncertainty =       0.029137211400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784434039927
                                         uncertainty =       0.029137211400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375406358
  error estimate for blocks of size 2^( 2) =       0.001446744192
  error estimate for blocks of size 2^( 3) =       0.001508916716
  error estimate for blocks of size 2^( 4) =       0.001551351228
  error estimate for blocks of size 2^( 5) =       0.001572276156
  error estimate for blocks of size 2^( 6) =       0.001589027212
  error estimate for blocks of size 2^( 7) =       0.001598825929

      target function =                  N/A
              le_mean =     -22.328000259643
             les_mean =     502.328942864661
             stat err =       0.001577870131
             autocorr =       1.316074441410
              std dev =       1.945149446830
             le_variance =       3.783606370504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783758541859
                                         uncertainty =       0.029219530309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783758541859
                                         uncertainty =       0.029219530309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375283954
  error estimate for blocks of size 2^( 2) =       0.001446689577
  error estimate for blocks of size 2^( 3) =       0.001508915117
  error estimate for blocks of size 2^( 4) =       0.001551363973
  error estimate for blocks of size 2^( 5) =       0.001572329309
  error estimate for blocks of size 2^( 6) =       0.001589124153
  error estimate for blocks of size 2^( 7) =       0.001598956862

      target function =                  N/A
              le_mean =     -22.327950770585
             les_mean =     502.288383130964
             stat err =       0.001577943574
             autocorr =       1.316431259358
              std dev =       1.944976339189
             le_variance =       3.782932960006


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329000512784        initial  <--
     3.8147e-02     3.8147e-01             1.9459e-03       -22.327960464404
     1.5259e-01     1.5259e+00             1.2586e-03       -22.328000259643
     6.1035e-01     6.1035e+00             5.2798e-04       -22.327950770585

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0007
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_001                -6.993623e-01 3 1  ON 0
ci_002                -7.006995e-01 3 1  ON 1
ci_003                -6.315905e-02 3 1  ON 2
ci_004                -6.225938e-02 3 1  ON 3
ci_005                 4.592610e-02 3 1  ON 4
ci_006                 4.582699e-02 3 1  ON 5
ci_007                 3.138951e-02 3 1  ON 6
ci_008                 3.076329e-02 3 1  ON 7
ci_009                -2.598082e-02 3 1  ON 8
ci_010                -2.502139e-02 3 1  ON 9
ci_011                -2.241825e-02 3 1  ON 10
ci_012                -2.126693e-02 3 1  ON 11
ci_013                 1.965523e-02 3 1  ON 12
ci_014                 2.020270e-02 3 1  ON 13
ci_015                 1.952825e-02 3 1  ON 14
ci_016                 1.969193e-02 3 1  ON 15
ci_017                 1.583092e-02 3 1  ON 16
ci_018                 1.766737e-02 3 1  ON 17
ci_019                 9.626189e-03 3 1  ON 18
ci_020                 8.968263e-03 3 1  ON 19
ci_021                -9.748862e-03 3 1  ON 20
ci_022                -9.370293e-03 3 1  ON 21
ci_023                 9.005935e-03 3 1  ON 22
ci_024                 9.346351e-03 3 1  ON 23
ci_025                 7.136473e-03 3 1  ON 24
ci_026                 8.423228e-03 3 1  ON 25
ci_027                 7.964082e-03 3 1  ON 26
ci_028                 7.905438e-03 3 1  ON 27
ci_029                -7.343659e-03 3 1  ON 28
ci_030                -7.778150e-03 3 1  ON 29
ci_031                -6.713852e-03 3 1  ON 30
ci_032                -7.008352e-03 3 1  ON 31
ci_033                 6.638471e-03 3 1  ON 32
ci_034                 7.147130e-03 3 1  ON 33
ci_035                 6.833896e-03 3 1  ON 34
ci_036                 7.020744e-03 3 1  ON 35
ci_037                 5.447040e-03 3 1  ON 36
ci_038                 5.503787e-03 3 1  ON 37
ci_039                 5.263017e-03 3 1  ON 38
ci_040                 5.323826e-03 3 1  ON 39
ci_041                 5.588902e-03 3 1  ON 40
ci_042                 5.248519e-03 3 1  ON 41
ci_043                 5.476993e-03 3 1  ON 42
ci_044                 4.489488e-03 3 1  ON 43
ci_045                 4.455627e-03 3 1  ON 44
ci_046                 4.407842e-03 3 1  ON 45
ci_047                -4.009102e-03 3 1  ON 46
ci_048                -4.607371e-03 3 1  ON 47
ci_049                 3.881899e-03 3 1  ON 48
ci_050                 3.592475e-03 3 1  ON 49
ci_051                -2.740291e-03 3 1  ON 50
ci_052                -2.965491e-03 3 1  ON 51
ci_053                -2.658299e-03 3 1  ON 52
ci_054                -4.536840e-03 3 1  ON 53
ci_055                -2.168374e-03 3 1  ON 54
ci_056                -3.102489e-03 3 1  ON 55
ci_057                -1.884072e-03 3 1  ON 56
ci_058                -1.984749e-03 3 1  ON 57
ci_059                -2.035094e-03 3 1  ON 58
ci_060                -2.010615e-03 3 1  ON 59
ci_061                -1.275026e-03 3 1  ON 60
ci_062                -1.357669e-03 3 1  ON 61
ci_063                -1.555208e-03 3 1  ON 62
ci_064                -7.118508e-04 3 1  ON 63
ci_065                -2.656366e-03 3 1  ON 64
ci_066                -1.173384e-03 3 1  ON 65
ci_067                -1.025383e-03 3 1  ON 66
ci_068                -1.635303e-03 3 1  ON 67
ci_069                 5.789454e-04 3 1  ON 68
ci_070                 1.950076e-03 3 1  ON 69
ci_071                -1.293623e-03 3 1  ON 70
ci_072                -8.494895e-04 3 1  ON 71
ci_073                 1.577203e-03 3 1  ON 72
ci_074                 1.183248e-03 3 1  ON 73
ci_075                -6.868826e-04 3 1  ON 74
ci_076                -1.349545e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7074e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2234e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.2307
    reference variance = 9.42986
====================================================
  Execution time = 2.3382e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0292e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.8463e+00
  Total weights = 1.949633006e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8120e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.899500366534
                                         uncertainty =       0.066158778845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.899500366534
                                         uncertainty =       0.066158778845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001396127384
  error estimate for blocks of size 2^( 2) =       0.001465025121
  error estimate for blocks of size 2^( 3) =       0.001527115433
  error estimate for blocks of size 2^( 4) =       0.001569623117
  error estimate for blocks of size 2^( 5) =       0.001595823560
  error estimate for blocks of size 2^( 6) =       0.001608342946
  error estimate for blocks of size 2^( 7) =       0.001614314124

      target function =                  N/A
              le_mean =     -22.325743264127
             les_mean =     502.285072078146
             stat err =       0.001597025937
             autocorr =       1.308500363631
              std dev =       1.974453872315
             le_variance =       3.898468093898


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232574326413e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325743263302       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325799491081       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325799904660       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325799896355       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 8.040232e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325743263302       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325762208626       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325762204938       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 2.646642e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325743263302       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325748450602       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325748452118       residual = 4.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 7.598178e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155117 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9204e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_001                -6.994151e-01 3 1  ON 0
ci_002                -7.006518e-01 3 1  ON 1
ci_003                -6.314525e-02 3 1  ON 2
ci_004                -6.218232e-02 3 1  ON 3
ci_005                 4.585752e-02 3 1  ON 4
ci_006                 4.578016e-02 3 1  ON 5
ci_007                 3.142135e-02 3 1  ON 6
ci_008                 3.095347e-02 3 1  ON 7
ci_009                -2.581764e-02 3 1  ON 8
ci_010                -2.509287e-02 3 1  ON 9
ci_011                -2.243831e-02 3 1  ON 10
ci_012                -2.117345e-02 3 1  ON 11
ci_013                 1.967134e-02 3 1  ON 12
ci_014                 2.025823e-02 3 1  ON 13
ci_015                 1.960891e-02 3 1  ON 14
ci_016                 1.969044e-02 3 1  ON 15
ci_017                 1.584212e-02 3 1  ON 16
ci_018                 1.759107e-02 3 1  ON 17
ci_019                 9.680931e-03 3 1  ON 18
ci_020                 9.148726e-03 3 1  ON 19
ci_021                -9.670520e-03 3 1  ON 20
ci_022                -9.459240e-03 3 1  ON 21
ci_023                 8.991944e-03 3 1  ON 22
ci_024                 9.181101e-03 3 1  ON 23
ci_025                 7.378205e-03 3 1  ON 24
ci_026                 8.461080e-03 3 1  ON 25
ci_027                 8.044798e-03 3 1  ON 26
ci_028                 7.978311e-03 3 1  ON 27
ci_029                -7.326660e-03 3 1  ON 28
ci_030                -7.797949e-03 3 1  ON 29
ci_031                -6.812471e-03 3 1  ON 30
ci_032                -7.039377e-03 3 1  ON 31
ci_033                 6.693093e-03 3 1  ON 32
ci_034                 6.967942e-03 3 1  ON 33
ci_035                 6.781202e-03 3 1  ON 34
ci_036                 6.756080e-03 3 1  ON 35
ci_037                 5.411407e-03 3 1  ON 36
ci_038                 5.637517e-03 3 1  ON 37
ci_039                 5.399655e-03 3 1  ON 38
ci_040                 5.390050e-03 3 1  ON 39
ci_041                 5.639399e-03 3 1  ON 40
ci_042                 5.093499e-03 3 1  ON 41
ci_043                 5.305803e-03 3 1  ON 42
ci_044                 4.618415e-03 3 1  ON 43
ci_045                 4.719013e-03 3 1  ON 44
ci_046                 4.604584e-03 3 1  ON 45
ci_047                -3.984425e-03 3 1  ON 46
ci_048                -4.416749e-03 3 1  ON 47
ci_049                 3.944598e-03 3 1  ON 48
ci_050                 3.662445e-03 3 1  ON 49
ci_051                -2.782093e-03 3 1  ON 50
ci_052                -2.826104e-03 3 1  ON 51
ci_053                -2.749918e-03 3 1  ON 52
ci_054                -4.364694e-03 3 1  ON 53
ci_055                -2.165204e-03 3 1  ON 54
ci_056                -2.970937e-03 3 1  ON 55
ci_057                -2.023205e-03 3 1  ON 56
ci_058                -2.026278e-03 3 1  ON 57
ci_059                -1.906692e-03 3 1  ON 58
ci_060                -1.998684e-03 3 1  ON 59
ci_061                -1.419677e-03 3 1  ON 60
ci_062                -1.535729e-03 3 1  ON 61
ci_063                -1.743602e-03 3 1  ON 62
ci_064                -8.328554e-04 3 1  ON 63
ci_065                -2.502032e-03 3 1  ON 64
ci_066                -1.086378e-03 3 1  ON 65
ci_067                -1.045812e-03 3 1  ON 66
ci_068                -1.818440e-03 3 1  ON 67
ci_069                 7.050552e-04 3 1  ON 68
ci_070                 1.913777e-03 3 1  ON 69
ci_071                -1.090530e-03 3 1  ON 70
ci_072                -9.299665e-04 3 1  ON 71
ci_073                 1.405837e-03 3 1  ON 72
ci_074                 1.064670e-03 3 1  ON 73
ci_075                -7.183582e-04 3 1  ON 74
ci_076                -1.418803e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -21.9671
    reference variance = 4.05274
====================================================
  Execution time = 2.2857e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7290e+00
  Total weights = 1.9500e+06
  Execution time = 4.2940e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780731934895
                                         uncertainty =       0.043192604360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780731934895
                                         uncertainty =       0.043192604360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374928017
  error estimate for blocks of size 2^( 2) =       0.001445941914
  error estimate for blocks of size 2^( 3) =       0.001509697400
  error estimate for blocks of size 2^( 4) =       0.001553999712
  error estimate for blocks of size 2^( 5) =       0.001581385953
  error estimate for blocks of size 2^( 6) =       0.001594488875
  error estimate for blocks of size 2^( 7) =       0.001603785181

      target function =                  N/A
              le_mean =     -22.325921575982
             les_mean =     502.178031536007
             stat err =       0.001583414930
             autocorr =       1.326262676963
              std dev =       1.944472959076
             le_variance =       3.780975088576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781246422899
                                         uncertainty =       0.043166713264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781246422899
                                         uncertainty =       0.043166713264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375021328
  error estimate for blocks of size 2^( 2) =       0.001446043360
  error estimate for blocks of size 2^( 3) =       0.001509794949
  error estimate for blocks of size 2^( 4) =       0.001554098181
  error estimate for blocks of size 2^( 5) =       0.001581478922
  error estimate for blocks of size 2^( 6) =       0.001594549783
  error estimate for blocks of size 2^( 7) =       0.001603946784

      target function =                  N/A
              le_mean =     -22.325941497747
             les_mean =     502.455021473402
             stat err =       0.001583518417
             autocorr =       1.326256020397
              std dev =       1.944604923991
             le_variance =       3.781488310411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780721570369
                                         uncertainty =       0.043185993089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780721570369
                                         uncertainty =       0.043185993089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374926253
  error estimate for blocks of size 2^( 2) =       0.001445942918
  error estimate for blocks of size 2^( 3) =       0.001509697071
  error estimate for blocks of size 2^( 4) =       0.001553995616
  error estimate for blocks of size 2^( 5) =       0.001581382902
  error estimate for blocks of size 2^( 6) =       0.001594482015
  error estimate for blocks of size 2^( 7) =       0.001603811002

      target function =                  N/A
              le_mean =     -22.325922629652
             les_mean =     502.175961788860
             stat err =       0.001583417884
             autocorr =       1.326271027679
              std dev =       1.944470464565
             le_variance =       3.780965387567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780738002315
                                         uncertainty =       0.043190936574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780738002315
                                         uncertainty =       0.043190936574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374929129
  error estimate for blocks of size 2^( 2) =       0.001445943885
  error estimate for blocks of size 2^( 3) =       0.001509696307
  error estimate for blocks of size 2^( 4) =       0.001553997621
  error estimate for blocks of size 2^( 5) =       0.001581383971
  error estimate for blocks of size 2^( 6) =       0.001594487465
  error estimate for blocks of size 2^( 7) =       0.001603798281

      target function =                  N/A
              le_mean =     -22.325921773454
             les_mean =     502.269269441319
             stat err =       0.001583416834
             autocorr =       1.326263721084
              std dev =       1.944474532236
             le_variance =       3.780981206514


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325921575982        initial
     3.8147e-01     3.8147e+00             8.0402e-04       -22.325941497747  <--
     1.5259e+00     1.5259e+01             2.6466e-04       -22.325922629652
     6.1035e+00     6.1035e+01             7.5982e-05       -22.325921773454

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 4.4527e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_001                -6.995665e-01 3 1  ON 0
ci_002                -7.005169e-01 3 1  ON 1
ci_003                -6.311401e-02 3 1  ON 2
ci_004                -6.195505e-02 3 1  ON 3
ci_005                 4.574118e-02 3 1  ON 4
ci_006                 4.568344e-02 3 1  ON 5
ci_007                 3.149000e-02 3 1  ON 6
ci_008                 3.132597e-02 3 1  ON 7
ci_009                -2.546686e-02 3 1  ON 8
ci_010                -2.521510e-02 3 1  ON 9
ci_011                -2.246099e-02 3 1  ON 10
ci_012                -2.098805e-02 3 1  ON 11
ci_013                 1.968613e-02 3 1  ON 12
ci_014                 2.037942e-02 3 1  ON 13
ci_015                 1.980021e-02 3 1  ON 14
ci_016                 1.968563e-02 3 1  ON 15
ci_017                 1.586382e-02 3 1  ON 16
ci_018                 1.740891e-02 3 1  ON 17
ci_019                 9.771009e-03 3 1  ON 18
ci_020                 9.568553e-03 3 1  ON 19
ci_021                -9.491555e-03 3 1  ON 20
ci_022                -9.670720e-03 3 1  ON 21
ci_023                 8.961958e-03 3 1  ON 22
ci_024                 8.856918e-03 3 1  ON 23
ci_025                 7.918943e-03 3 1  ON 24
ci_026                 8.534222e-03 3 1  ON 25
ci_027                 8.176685e-03 3 1  ON 26
ci_028                 8.103166e-03 3 1  ON 27
ci_029                -7.291743e-03 3 1  ON 28
ci_030                -7.847153e-03 3 1  ON 29
ci_031                -7.038369e-03 3 1  ON 30
ci_032                -7.096497e-03 3 1  ON 31
ci_033                 6.776741e-03 3 1  ON 32
ci_034                 6.558233e-03 3 1  ON 33
ci_035                 6.692668e-03 3 1  ON 34
ci_036                 6.315657e-03 3 1  ON 35
ci_037                 5.343099e-03 3 1  ON 36
ci_038                 5.892010e-03 3 1  ON 37
ci_039                 5.627290e-03 3 1  ON 38
ci_040                 5.504427e-03 3 1  ON 39
ci_041                 5.735684e-03 3 1  ON 40
ci_042                 4.803574e-03 3 1  ON 41
ci_043                 4.952241e-03 3 1  ON 42
ci_044                 4.871039e-03 3 1  ON 43
ci_045                 5.259650e-03 3 1  ON 44
ci_046                 5.045220e-03 3 1  ON 45
ci_047                -3.933968e-03 3 1  ON 46
ci_048                -4.112266e-03 3 1  ON 47
ci_049                 4.072044e-03 3 1  ON 48
ci_050                 3.814288e-03 3 1  ON 49
ci_051                -2.905339e-03 3 1  ON 50
ci_052                -2.542278e-03 3 1  ON 51
ci_053                -2.935972e-03 3 1  ON 52
ci_054                -4.002530e-03 3 1  ON 53
ci_055                -2.136213e-03 3 1  ON 54
ci_056                -2.653327e-03 3 1  ON 55
ci_057                -2.308991e-03 3 1  ON 56
ci_058                -2.101007e-03 3 1  ON 57
ci_059                -1.678778e-03 3 1  ON 58
ci_060                -1.974514e-03 3 1  ON 59
ci_061                -1.727421e-03 3 1  ON 60
ci_062                -1.877437e-03 3 1  ON 61
ci_063                -2.137422e-03 3 1  ON 62
ci_064                -1.071000e-03 3 1  ON 63
ci_065                -2.197064e-03 3 1  ON 64
ci_066                -8.996194e-04 3 1  ON 65
ci_067                -1.107633e-03 3 1  ON 66
ci_068                -2.220738e-03 3 1  ON 67
ci_069                 9.537002e-04 3 1  ON 68
ci_070                 1.838145e-03 3 1  ON 69
ci_071                -6.765315e-04 3 1  ON 70
ci_072                -1.126568e-03 3 1  ON 71
ci_073                 1.100907e-03 3 1  ON 72
ci_074                 8.745334e-04 3 1  ON 73
ci_075                -7.844066e-04 3 1  ON 74
ci_076                -1.564924e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3746e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.4599
    reference variance = 2.5289
====================================================
  Execution time = 2.3464e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0348e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7777e+00
  Total weights = 1.949726581e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9120e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830716141740
                                         uncertainty =       0.046302102787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830716141740
                                         uncertainty =       0.046302102787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383962739
  error estimate for blocks of size 2^( 2) =       0.001454025856
  error estimate for blocks of size 2^( 3) =       0.001517559638
  error estimate for blocks of size 2^( 4) =       0.001560147679
  error estimate for blocks of size 2^( 5) =       0.001581153493
  error estimate for blocks of size 2^( 6) =       0.001594936393
  error estimate for blocks of size 2^( 7) =       0.001611237754

      target function =                  N/A
              le_mean =     -22.326653237050
             les_mean =     502.257095235486
             stat err =       0.001586868830
             autocorr =       1.314719982456
              std dev =       1.957250190986
             le_variance =       3.830828310115


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232665323705e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326653236228       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326731814886       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326734725438       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326735800223       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326736374170       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.326736472403       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-02 is 1.540587e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326653236228       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326691320307       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326691493755       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326691543346       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 6.599145e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326653236228       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326665676416       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326665640344       residual = 1.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 2.178397e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158798 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9387e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_001                -6.991718e-01 3 1  ON 0
ci_002                -7.008464e-01 3 1  ON 1
ci_003                -6.281567e-02 3 1  ON 2
ci_004                -6.208899e-02 3 1  ON 3
ci_005                 4.598209e-02 3 1  ON 4
ci_006                 4.608080e-02 3 1  ON 5
ci_007                 3.149055e-02 3 1  ON 6
ci_008                 3.150427e-02 3 1  ON 7
ci_009                -2.558519e-02 3 1  ON 8
ci_010                -2.527423e-02 3 1  ON 9
ci_011                -2.266109e-02 3 1  ON 10
ci_012                -2.143527e-02 3 1  ON 11
ci_013                 1.996476e-02 3 1  ON 12
ci_014                 2.015142e-02 3 1  ON 13
ci_015                 1.981668e-02 3 1  ON 14
ci_016                 1.958561e-02 3 1  ON 15
ci_017                 1.542161e-02 3 1  ON 16
ci_018                 1.679367e-02 3 1  ON 17
ci_019                 9.843244e-03 3 1  ON 18
ci_020                 9.999837e-03 3 1  ON 19
ci_021                -9.940790e-03 3 1  ON 20
ci_022                -9.645512e-03 3 1  ON 21
ci_023                 9.151792e-03 3 1  ON 22
ci_024                 8.770961e-03 3 1  ON 23
ci_025                 8.256898e-03 3 1  ON 24
ci_026                 8.475347e-03 3 1  ON 25
ci_027                 8.089417e-03 3 1  ON 26
ci_028                 8.135115e-03 3 1  ON 27
ci_029                -7.582893e-03 3 1  ON 28
ci_030                -7.940201e-03 3 1  ON 29
ci_031                -7.598525e-03 3 1  ON 30
ci_032                -7.447307e-03 3 1  ON 31
ci_033                 6.478206e-03 3 1  ON 32
ci_034                 6.745319e-03 3 1  ON 33
ci_035                 6.653645e-03 3 1  ON 34
ci_036                 6.242660e-03 3 1  ON 35
ci_037                 5.454001e-03 3 1  ON 36
ci_038                 6.371931e-03 3 1  ON 37
ci_039                 6.058218e-03 3 1  ON 38
ci_040                 5.517467e-03 3 1  ON 39
ci_041                 5.181525e-03 3 1  ON 40
ci_042                 4.921986e-03 3 1  ON 41
ci_043                 4.789265e-03 3 1  ON 42
ci_044                 5.530953e-03 3 1  ON 43
ci_045                 5.789015e-03 3 1  ON 44
ci_046                 5.080655e-03 3 1  ON 45
ci_047                -4.218185e-03 3 1  ON 46
ci_048                -4.006121e-03 3 1  ON 47
ci_049                 3.690584e-03 3 1  ON 48
ci_050                 3.377037e-03 3 1  ON 49
ci_051                -2.889453e-03 3 1  ON 50
ci_052                -2.590657e-03 3 1  ON 51
ci_053                -2.954577e-03 3 1  ON 52
ci_054                -3.399470e-03 3 1  ON 53
ci_055                -2.383476e-03 3 1  ON 54
ci_056                -2.236767e-03 3 1  ON 55
ci_057                -2.608099e-03 3 1  ON 56
ci_058                -2.264226e-03 3 1  ON 57
ci_059                -1.891264e-03 3 1  ON 58
ci_060                -1.775999e-03 3 1  ON 59
ci_061                -1.938745e-03 3 1  ON 60
ci_062                -1.728421e-03 3 1  ON 61
ci_063                -1.520242e-03 3 1  ON 62
ci_064                -1.424551e-03 3 1  ON 63
ci_065                -2.083585e-03 3 1  ON 64
ci_066                -8.275309e-04 3 1  ON 65
ci_067                -1.485800e-03 3 1  ON 66
ci_068                -1.802688e-03 3 1  ON 67
ci_069                 1.181948e-03 3 1  ON 68
ci_070                 1.760679e-03 3 1  ON 69
ci_071                -1.100201e-03 3 1  ON 70
ci_072                -1.368222e-03 3 1  ON 71
ci_073                 9.574732e-04 3 1  ON 72
ci_074                 8.503305e-04 3 1  ON 73
ci_075                -5.927126e-04 3 1  ON 74
ci_076                -9.657823e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.3108
    reference variance = 4.7219
====================================================
  Execution time = 2.2962e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7307e+00
  Total weights = 1.9500e+06
  Execution time = 4.3110e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781792306406
                                         uncertainty =       0.030941178512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781792306406
                                         uncertainty =       0.030941178512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375361118
  error estimate for blocks of size 2^( 2) =       0.001446645568
  error estimate for blocks of size 2^( 3) =       0.001508792237
  error estimate for blocks of size 2^( 4) =       0.001553343706
  error estimate for blocks of size 2^( 5) =       0.001575612144
  error estimate for blocks of size 2^( 6) =       0.001585655897
  error estimate for blocks of size 2^( 7) =       0.001588985975

      target function =                  N/A
              le_mean =     -22.329298949293
             les_mean =     502.330563968649
             stat err =       0.001575899430
             autocorr =       1.312875404571
              std dev =       1.945085466287
             le_variance =       3.783357471162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.819115214002
                                         uncertainty =       0.049973265562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.819115214002
                                         uncertainty =       0.049973265562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382104078
  error estimate for blocks of size 2^( 2) =       0.001453037206
  error estimate for blocks of size 2^( 3) =       0.001514886490
  error estimate for blocks of size 2^( 4) =       0.001559468603
  error estimate for blocks of size 2^( 5) =       0.001581234670
  error estimate for blocks of size 2^( 6) =       0.001591238696
  error estimate for blocks of size 2^( 7) =       0.001594146542

      target function =                  N/A
              le_mean =     -22.329450528201
             les_mean =     513.444740794550
             stat err =       0.001581522128
             autocorr =       1.309390087496
              std dev =       1.954621604262
             le_variance =       3.820545615849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.782022111344
                                         uncertainty =       0.030938258396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.782022111344
                                         uncertainty =       0.030938258396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375404170
  error estimate for blocks of size 2^( 2) =       0.001446663818
  error estimate for blocks of size 2^( 3) =       0.001508783981
  error estimate for blocks of size 2^( 4) =       0.001553303892
  error estimate for blocks of size 2^( 5) =       0.001575557235
  error estimate for blocks of size 2^( 6) =       0.001585586032
  error estimate for blocks of size 2^( 7) =       0.001588910902

      target function =                  N/A
              le_mean =     -22.329298735721
             les_mean =     502.333021559373
             stat err =       0.001575839515
             autocorr =       1.312693393335
              std dev =       1.945146352775
             le_variance =       3.783594333714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781804620330
                                         uncertainty =       0.030941528828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781804620330
                                         uncertainty =       0.030941528828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375363578
  error estimate for blocks of size 2^( 2) =       0.001446641810
  error estimate for blocks of size 2^( 3) =       0.001508787340
  error estimate for blocks of size 2^( 4) =       0.001553333397
  error estimate for blocks of size 2^( 5) =       0.001575598320
  error estimate for blocks of size 2^( 6) =       0.001585648046
  error estimate for blocks of size 2^( 7) =       0.001588962044

      target function =                  N/A
              le_mean =     -22.329290922016
             les_mean =     502.364730816888
             stat err =       0.001575885452
             autocorr =       1.312847416826
              std dev =       1.945088945542
             le_variance =       3.783371006071


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329298949293        initial
     9.5367e-02     9.5367e-01             1.5406e-03       -22.329450528201  <--
     3.8147e-01     3.8147e+00             6.5991e-04       -22.329298735721
     1.5259e+00     1.5259e+01             2.1784e-04       -22.329290922016

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 4.4682e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_001                -6.980260e-01 3 1  ON 0
ci_002                -7.019494e-01 3 1  ON 1
ci_003                -6.213346e-02 3 1  ON 2
ci_004                -6.236312e-02 3 1  ON 3
ci_005                 4.610850e-02 3 1  ON 4
ci_006                 4.648417e-02 3 1  ON 5
ci_007                 3.146279e-02 3 1  ON 6
ci_008                 3.173879e-02 3 1  ON 7
ci_009                -2.572759e-02 3 1  ON 8
ci_010                -2.531319e-02 3 1  ON 9
ci_011                -2.283230e-02 3 1  ON 10
ci_012                -2.208461e-02 3 1  ON 11
ci_013                 2.033436e-02 3 1  ON 12
ci_014                 1.982395e-02 3 1  ON 13
ci_015                 1.991493e-02 3 1  ON 14
ci_016                 1.947752e-02 3 1  ON 15
ci_017                 1.487285e-02 3 1  ON 16
ci_018                 1.599932e-02 3 1  ON 17
ci_019                 9.948743e-03 3 1  ON 18
ci_020                 1.060126e-02 3 1  ON 19
ci_021                -1.046045e-02 3 1  ON 20
ci_022                -9.629049e-03 3 1  ON 21
ci_023                 9.323879e-03 3 1  ON 22
ci_024                 8.695054e-03 3 1  ON 23
ci_025                 8.672722e-03 3 1  ON 24
ci_026                 8.411354e-03 3 1  ON 25
ci_027                 7.986965e-03 3 1  ON 26
ci_028                 8.156299e-03 3 1  ON 27
ci_029                -7.920570e-03 3 1  ON 28
ci_030                -8.022655e-03 3 1  ON 29
ci_031                -8.232314e-03 3 1  ON 30
ci_032                -7.904673e-03 3 1  ON 31
ci_033                 6.069719e-03 3 1  ON 32
ci_034                 6.972471e-03 3 1  ON 33
ci_035                 6.586242e-03 3 1  ON 34
ci_036                 6.229600e-03 3 1  ON 35
ci_037                 5.599197e-03 3 1  ON 36
ci_038                 6.823693e-03 3 1  ON 37
ci_039                 6.382019e-03 3 1  ON 38
ci_040                 5.523094e-03 3 1  ON 39
ci_041                 4.698520e-03 3 1  ON 40
ci_042                 5.035702e-03 3 1  ON 41
ci_043                 4.566282e-03 3 1  ON 42
ci_044                 6.228436e-03 3 1  ON 43
ci_045                 6.411230e-03 3 1  ON 44
ci_046                 5.140640e-03 3 1  ON 45
ci_047                -4.452427e-03 3 1  ON 46
ci_048                -3.925516e-03 3 1  ON 47
ci_049                 3.263847e-03 3 1  ON 48
ci_050                 2.898710e-03 3 1  ON 49
ci_051                -2.838463e-03 3 1  ON 50
ci_052                -2.637379e-03 3 1  ON 51
ci_053                -2.946269e-03 3 1  ON 52
ci_054                -2.649433e-03 3 1  ON 53
ci_055                -2.665169e-03 3 1  ON 54
ci_056                -1.734633e-03 3 1  ON 55
ci_057                -2.888238e-03 3 1  ON 56
ci_058                -2.420796e-03 3 1  ON 57
ci_059                -2.060556e-03 3 1  ON 58
ci_060                -1.639349e-03 3 1  ON 59
ci_061                -2.189442e-03 3 1  ON 60
ci_062                -1.522168e-03 3 1  ON 61
ci_063                -8.089671e-04 3 1  ON 62
ci_064                -1.852225e-03 3 1  ON 63
ci_065                -1.939983e-03 3 1  ON 64
ci_066                -7.397249e-04 3 1  ON 65
ci_067                -1.902876e-03 3 1  ON 66
ci_068                -1.372737e-03 3 1  ON 67
ci_069                 1.421086e-03 3 1  ON 68
ci_070                 1.691890e-03 3 1  ON 69
ci_071                -1.515745e-03 3 1  ON 70
ci_072                -1.652670e-03 3 1  ON 71
ci_073                 8.713659e-04 3 1  ON 72
ci_074                 8.766707e-04 3 1  ON 73
ci_075                -4.122714e-04 3 1  ON 74
ci_076                -3.893514e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4085e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2234e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.4067
    reference variance = 2.35819
====================================================
  Execution time = 2.3539e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0317e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7814e+00
  Total weights = 1.950203167e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7784e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.833720196920
                                         uncertainty =       0.097731168062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.833720196920
                                         uncertainty =       0.097731168062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001384554833
  error estimate for blocks of size 2^( 2) =       0.001455108174
  error estimate for blocks of size 2^( 3) =       0.001518169076
  error estimate for blocks of size 2^( 4) =       0.001560197344
  error estimate for blocks of size 2^( 5) =       0.001584400062
  error estimate for blocks of size 2^( 6) =       0.001598644219
  error estimate for blocks of size 2^( 7) =       0.001605944978

      target function =                  N/A
              le_mean =     -22.327551643186
             les_mean =     502.300973905564
             stat err =       0.001587296651
             autocorr =       1.314304152899
              std dev =       1.958087550862
             le_variance =       3.834106856842


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232755164319e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327551642359       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327663236067       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327672959380       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327675743241       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327677635244       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327677965770       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327678092631       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.327679059133       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.327679095717       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-02 is 3.384758e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327551642359       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327636688382       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327640690596       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327641375198       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327641546907       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327641497902       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-02 is 1.963836e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327551642359       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327595219878       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327595681617       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327595721532       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 8.749721e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164163 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9330e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_001                -6.988328e-01 3 1  ON 0
ci_002                -7.012700e-01 3 1  ON 1
ci_003                -6.346350e-02 3 1  ON 2
ci_004                -6.244766e-02 3 1  ON 3
ci_005                 4.560736e-02 3 1  ON 4
ci_006                 4.548521e-02 3 1  ON 5
ci_007                 3.143818e-02 3 1  ON 6
ci_008                 3.108639e-02 3 1  ON 7
ci_009                -2.516107e-02 3 1  ON 8
ci_010                -2.530075e-02 3 1  ON 9
ci_011                -2.298828e-02 3 1  ON 10
ci_012                -2.212474e-02 3 1  ON 11
ci_013                 1.931592e-02 3 1  ON 12
ci_014                 1.961074e-02 3 1  ON 13
ci_015                 1.947197e-02 3 1  ON 14
ci_016                 1.972624e-02 3 1  ON 15
ci_017                 1.569840e-02 3 1  ON 16
ci_018                 1.513847e-02 3 1  ON 17
ci_019                 1.088019e-02 3 1  ON 18
ci_020                 9.754672e-03 3 1  ON 19
ci_021                -1.086423e-02 3 1  ON 20
ci_022                -9.508524e-03 3 1  ON 21
ci_023                 8.278133e-03 3 1  ON 22
ci_024                 7.860637e-03 3 1  ON 23
ci_025                 9.033986e-03 3 1  ON 24
ci_026                 8.706400e-03 3 1  ON 25
ci_027                 7.753194e-03 3 1  ON 26
ci_028                 8.409076e-03 3 1  ON 27
ci_029                -8.183608e-03 3 1  ON 28
ci_030                -6.662146e-03 3 1  ON 29
ci_031                -9.046424e-03 3 1  ON 30
ci_032                -7.239968e-03 3 1  ON 31
ci_033                 6.454191e-03 3 1  ON 32
ci_034                 7.056340e-03 3 1  ON 33
ci_035                 6.235571e-03 3 1  ON 34
ci_036                 6.627716e-03 3 1  ON 35
ci_037                 6.155016e-03 3 1  ON 36
ci_038                 6.924453e-03 3 1  ON 37
ci_039                 5.143798e-03 3 1  ON 38
ci_040                 5.904926e-03 3 1  ON 39
ci_041                 4.576934e-03 3 1  ON 40
ci_042                 4.619845e-03 3 1  ON 41
ci_043                 4.294383e-03 3 1  ON 42
ci_044                 5.157251e-03 3 1  ON 43
ci_045                 5.862145e-03 3 1  ON 44
ci_046                 5.830599e-03 3 1  ON 45
ci_047                -4.357153e-03 3 1  ON 46
ci_048                -3.217276e-03 3 1  ON 47
ci_049                 3.661950e-03 3 1  ON 48
ci_050                 3.088460e-03 3 1  ON 49
ci_051                -2.755185e-03 3 1  ON 50
ci_052                -2.286964e-03 3 1  ON 51
ci_053                -2.221065e-03 3 1  ON 52
ci_054                -2.360960e-03 3 1  ON 53
ci_055                -7.013325e-04 3 1  ON 54
ci_056                -6.218753e-04 3 1  ON 55
ci_057                -2.274923e-03 3 1  ON 56
ci_058                -2.449220e-03 3 1  ON 57
ci_059                -2.426424e-03 3 1  ON 58
ci_060                -1.026248e-03 3 1  ON 59
ci_061                -2.591749e-03 3 1  ON 60
ci_062                -1.646235e-03 3 1  ON 61
ci_063                -1.441949e-03 3 1  ON 62
ci_064                -2.102660e-03 3 1  ON 63
ci_065                -1.316615e-03 3 1  ON 64
ci_066                -1.452989e-03 3 1  ON 65
ci_067                -2.038219e-03 3 1  ON 66
ci_068                -6.226234e-04 3 1  ON 67
ci_069                 6.065592e-04 3 1  ON 68
ci_070                 5.893739e-04 3 1  ON 69
ci_071                -1.270829e-03 3 1  ON 70
ci_072                -1.087969e-03 3 1  ON 71
ci_073                 1.307256e-03 3 1  ON 72
ci_074                 8.436009e-04 3 1  ON 73
ci_075                -6.757612e-04 3 1  ON 74
ci_076                -7.733756e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.4983
    reference variance = 2.47405
====================================================
  Execution time = 2.2937e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7915e+00
  Total weights = 1.9497e+06
  Execution time = 4.2974e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.848536778317
                                         uncertainty =       0.079630816096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.848536778317
                                         uncertainty =       0.079630816096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386955125
  error estimate for blocks of size 2^( 2) =       0.001457857156
  error estimate for blocks of size 2^( 3) =       0.001521506941
  error estimate for blocks of size 2^( 4) =       0.001563684120
  error estimate for blocks of size 2^( 5) =       0.001585045590
  error estimate for blocks of size 2^( 6) =       0.001596790159
  error estimate for blocks of size 2^( 7) =       0.001608992546

      target function =                  N/A
              le_mean =     -22.326277477414
             les_mean =     502.280710928689
             stat err =       0.001588628104
             autocorr =       1.311957187848
              std dev =       1.961482130432
             le_variance =       3.847412148003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.848228606316
                                         uncertainty =       0.079630087817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.848228606316
                                         uncertainty =       0.079630087817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386899835
  error estimate for blocks of size 2^( 2) =       0.001457881076
  error estimate for blocks of size 2^( 3) =       0.001521607202
  error estimate for blocks of size 2^( 4) =       0.001563806755
  error estimate for blocks of size 2^( 5) =       0.001585216809
  error estimate for blocks of size 2^( 6) =       0.001597022140
  error estimate for blocks of size 2^( 7) =       0.001609097377

      target function =                  N/A
              le_mean =     -22.326242470725
             les_mean =     502.299127350527
             stat err =       0.001588785770
             autocorr =       1.312322243475
              std dev =       1.961403937646
             le_variance =       3.847105406614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.848517066936
                                         uncertainty =       0.079623807205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.848517066936
                                         uncertainty =       0.079623807205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386951952
  error estimate for blocks of size 2^( 2) =       0.001457955027
  error estimate for blocks of size 2^( 3) =       0.001521718320
  error estimate for blocks of size 2^( 4) =       0.001563924608
  error estimate for blocks of size 2^( 5) =       0.001585382875
  error estimate for blocks of size 2^( 6) =       0.001597209620
  error estimate for blocks of size 2^( 7) =       0.001609253699

      target function =                  N/A
              le_mean =     -22.326291166624
             les_mean =     502.313389007663
             stat err =       0.001588942700
             autocorr =       1.312482858494
              std dev =       1.961477643875
             le_variance =       3.847394547420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.848268613507
                                         uncertainty =       0.079628984974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.848268613507
                                         uncertainty =       0.079628984974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386906955
  error estimate for blocks of size 2^( 2) =       0.001457842867
  error estimate for blocks of size 2^( 3) =       0.001521534907
  error estimate for blocks of size 2^( 4) =       0.001563720123
  error estimate for blocks of size 2^( 5) =       0.001585075862
  error estimate for blocks of size 2^( 6) =       0.001596849073
  error estimate for blocks of size 2^( 7) =       0.001609029251

      target function =                  N/A
              le_mean =     -22.326257489669
             les_mean =     502.268746866188
             stat err =       0.001588668577
             autocorr =       1.312115177576
              std dev =       1.961414007556
             le_variance =       3.847144909035


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326277477414        initial
     2.3842e-02     2.3842e-01             3.3848e-03       -22.326242470725
     9.5367e-02     9.5367e-01             1.9638e-03       -22.326291166624  <--
     3.8147e-01     3.8147e+00             8.7497e-04       -22.326257489669

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 4.4632e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_001                -6.988328e-01 3 1  ON 0
ci_002                -7.012700e-01 3 1  ON 1
ci_003                -6.346350e-02 3 1  ON 2
ci_004                -6.244766e-02 3 1  ON 3
ci_005                 4.560736e-02 3 1  ON 4
ci_006                 4.548521e-02 3 1  ON 5
ci_007                 3.143818e-02 3 1  ON 6
ci_008                 3.108639e-02 3 1  ON 7
ci_009                -2.516107e-02 3 1  ON 8
ci_010                -2.530075e-02 3 1  ON 9
ci_011                -2.298828e-02 3 1  ON 10
ci_012                -2.212474e-02 3 1  ON 11
ci_013                 1.931592e-02 3 1  ON 12
ci_014                 1.961074e-02 3 1  ON 13
ci_015                 1.947197e-02 3 1  ON 14
ci_016                 1.972624e-02 3 1  ON 15
ci_017                 1.569840e-02 3 1  ON 16
ci_018                 1.513847e-02 3 1  ON 17
ci_019                 1.088019e-02 3 1  ON 18
ci_020                 9.754672e-03 3 1  ON 19
ci_021                -1.086423e-02 3 1  ON 20
ci_022                -9.508524e-03 3 1  ON 21
ci_023                 8.278133e-03 3 1  ON 22
ci_024                 7.860637e-03 3 1  ON 23
ci_025                 9.033986e-03 3 1  ON 24
ci_026                 8.706400e-03 3 1  ON 25
ci_027                 7.753194e-03 3 1  ON 26
ci_028                 8.409076e-03 3 1  ON 27
ci_029                -8.183608e-03 3 1  ON 28
ci_030                -6.662146e-03 3 1  ON 29
ci_031                -9.046424e-03 3 1  ON 30
ci_032                -7.239968e-03 3 1  ON 31
ci_033                 6.454191e-03 3 1  ON 32
ci_034                 7.056340e-03 3 1  ON 33
ci_035                 6.235571e-03 3 1  ON 34
ci_036                 6.627716e-03 3 1  ON 35
ci_037                 6.155016e-03 3 1  ON 36
ci_038                 6.924453e-03 3 1  ON 37
ci_039                 5.143798e-03 3 1  ON 38
ci_040                 5.904926e-03 3 1  ON 39
ci_041                 4.576934e-03 3 1  ON 40
ci_042                 4.619845e-03 3 1  ON 41
ci_043                 4.294383e-03 3 1  ON 42
ci_044                 5.157251e-03 3 1  ON 43
ci_045                 5.862145e-03 3 1  ON 44
ci_046                 5.830599e-03 3 1  ON 45
ci_047                -4.357153e-03 3 1  ON 46
ci_048                -3.217276e-03 3 1  ON 47
ci_049                 3.661950e-03 3 1  ON 48
ci_050                 3.088460e-03 3 1  ON 49
ci_051                -2.755185e-03 3 1  ON 50
ci_052                -2.286964e-03 3 1  ON 51
ci_053                -2.221065e-03 3 1  ON 52
ci_054                -2.360960e-03 3 1  ON 53
ci_055                -7.013325e-04 3 1  ON 54
ci_056                -6.218753e-04 3 1  ON 55
ci_057                -2.274923e-03 3 1  ON 56
ci_058                -2.449220e-03 3 1  ON 57
ci_059                -2.426424e-03 3 1  ON 58
ci_060                -1.026248e-03 3 1  ON 59
ci_061                -2.591749e-03 3 1  ON 60
ci_062                -1.646235e-03 3 1  ON 61
ci_063                -1.441949e-03 3 1  ON 62
ci_064                -2.102660e-03 3 1  ON 63
ci_065                -1.316615e-03 3 1  ON 64
ci_066                -1.452989e-03 3 1  ON 65
ci_067                -2.038219e-03 3 1  ON 66
ci_068                -6.226234e-04 3 1  ON 67
ci_069                 6.065592e-04 3 1  ON 68
ci_070                 5.893739e-04 3 1  ON 69
ci_071                -1.270829e-03 3 1  ON 70
ci_072                -1.087969e-03 3 1  ON 71
ci_073                 1.307256e-03 3 1  ON 72
ci_074                 8.436009e-04 3 1  ON 73
ci_075                -6.757612e-04 3 1  ON 74
ci_076                -7.733756e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3978e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2244e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -21.8633
    reference variance = 6.03397
====================================================
  Execution time = 2.3446e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0308e+04
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.8612e+00
  Total weights = 1.950335160e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8412e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.914466429782
                                         uncertainty =       0.080096511747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.914466429782
                                         uncertainty =       0.080096511747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001398940611
  error estimate for blocks of size 2^( 2) =       0.001470288550
  error estimate for blocks of size 2^( 3) =       0.001533737700
  error estimate for blocks of size 2^( 4) =       0.001577291347
  error estimate for blocks of size 2^( 5) =       0.001604885563
  error estimate for blocks of size 2^( 6) =       0.001616716468
  error estimate for blocks of size 2^( 7) =       0.001620407451

      target function =                  N/A
              le_mean =     -22.325176009627
             les_mean =     502.274645505700
             stat err =       0.001604825207
             autocorr =       1.316003119407
              std dev =       1.978432439371
             le_variance =       3.914194917157


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232517600963e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325176008784       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325269234770       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325284183395       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325287293437       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.325286397754       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.325289234843       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.325288892586       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.325288832433       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.325288918308       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-02 is 3.149777e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325176008784       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325245664512       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325252999425       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325253839739       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.325253451186       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.325253716087       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-02 is 1.806674e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325176008784       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325210640355       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325212098528       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325212143181       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 8.611621e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168959 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9299e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_001                -6.995652e-01 3 1  ON 0
ci_002                -7.004660e-01 3 1  ON 1
ci_003                -6.377550e-02 3 1  ON 2
ci_004                -6.205230e-02 3 1  ON 3
ci_005                 4.559016e-02 3 1  ON 4
ci_006                 4.533451e-02 3 1  ON 5
ci_007                 3.160678e-02 3 1  ON 6
ci_008                 3.136722e-02 3 1  ON 7
ci_009                -2.477186e-02 3 1  ON 8
ci_010                -2.349407e-02 3 1  ON 9
ci_011                -2.214350e-02 3 1  ON 10
ci_012                -2.288349e-02 3 1  ON 11
ci_013                 2.060692e-02 3 1  ON 12
ci_014                 2.051099e-02 3 1  ON 13
ci_015                 1.996357e-02 3 1  ON 14
ci_016                 1.991536e-02 3 1  ON 15
ci_017                 1.730444e-02 3 1  ON 16
ci_018                 1.570572e-02 3 1  ON 17
ci_019                 1.024532e-02 3 1  ON 18
ci_020                 9.873513e-03 3 1  ON 19
ci_021                -1.119552e-02 3 1  ON 20
ci_022                -1.083994e-02 3 1  ON 21
ci_023                 9.181597e-03 3 1  ON 22
ci_024                 8.379562e-03 3 1  ON 23
ci_025                 7.950299e-03 3 1  ON 24
ci_026                 9.355619e-03 3 1  ON 25
ci_027                 8.060006e-03 3 1  ON 26
ci_028                 8.459950e-03 3 1  ON 27
ci_029                -7.775331e-03 3 1  ON 28
ci_030                -6.832613e-03 3 1  ON 29
ci_031                -7.750836e-03 3 1  ON 30
ci_032                -7.045959e-03 3 1  ON 31
ci_033                 7.536263e-03 3 1  ON 32
ci_034                 7.478419e-03 3 1  ON 33
ci_035                 6.092906e-03 3 1  ON 34
ci_036                 6.353287e-03 3 1  ON 35
ci_037                 6.189874e-03 3 1  ON 36
ci_038                 7.108642e-03 3 1  ON 37
ci_039                 5.231793e-03 3 1  ON 38
ci_040                 5.291996e-03 3 1  ON 39
ci_041                 5.232500e-03 3 1  ON 40
ci_042                 5.507963e-03 3 1  ON 41
ci_043                 4.421051e-03 3 1  ON 42
ci_044                 4.546197e-03 3 1  ON 43
ci_045                 5.263031e-03 3 1  ON 44
ci_046                 5.879834e-03 3 1  ON 45
ci_047                -3.770584e-03 3 1  ON 46
ci_048                -4.038659e-03 3 1  ON 47
ci_049                 3.976421e-03 3 1  ON 48
ci_050                 3.322392e-03 3 1  ON 49
ci_051                -3.041943e-03 3 1  ON 50
ci_052                -2.152925e-03 3 1  ON 51
ci_053                -3.167889e-03 3 1  ON 52
ci_054                -3.473025e-03 3 1  ON 53
ci_055                -1.690197e-03 3 1  ON 54
ci_056                -6.659276e-04 3 1  ON 55
ci_057                -2.174795e-03 3 1  ON 56
ci_058                -2.502085e-03 3 1  ON 57
ci_059                -2.633861e-03 3 1  ON 58
ci_060                -2.074648e-03 3 1  ON 59
ci_061                -2.576539e-03 3 1  ON 60
ci_062                -1.523877e-03 3 1  ON 61
ci_063                -1.079063e-03 3 1  ON 62
ci_064                -1.268309e-03 3 1  ON 63
ci_065                -8.048769e-04 3 1  ON 64
ci_066                -1.171403e-03 3 1  ON 65
ci_067                -1.209404e-03 3 1  ON 66
ci_068                -1.550398e-03 3 1  ON 67
ci_069                 1.719709e-03 3 1  ON 68
ci_070                 1.249099e-03 3 1  ON 69
ci_071                -1.753461e-03 3 1  ON 70
ci_072                -8.601019e-04 3 1  ON 71
ci_073                 1.202682e-03 3 1  ON 72
ci_074                 1.619428e-03 3 1  ON 73
ci_075                -6.174631e-04 3 1  ON 74
ci_076                -9.777257e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.4012
    reference variance = 2.76884
====================================================
  Execution time = 2.5144e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6774e+00
  Total weights = 1.9502e+06
  Execution time = 4.3115e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.178154
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.728230035454
                                         uncertainty =       0.029455694725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.728230035454
                                         uncertainty =       0.029455694725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365328247
  error estimate for blocks of size 2^( 2) =       0.001436779861
  error estimate for blocks of size 2^( 3) =       0.001502035542
  error estimate for blocks of size 2^( 4) =       0.001545694365
  error estimate for blocks of size 2^( 5) =       0.001569147094
  error estimate for blocks of size 2^( 6) =       0.001580290572
  error estimate for blocks of size 2^( 7) =       0.001587528489

      target function =                  N/A
              le_mean =     -22.328917028584
             les_mean =     502.300035647791
             stat err =       0.001570665130
             autocorr =       1.323405860483
              std dev =       1.930896618144
             le_variance =       3.728361749960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727588952565
                                         uncertainty =       0.029519692002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727588952565
                                         uncertainty =       0.029519692002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365210640
  error estimate for blocks of size 2^( 2) =       0.001436642510
  error estimate for blocks of size 2^( 3) =       0.001501883121
  error estimate for blocks of size 2^( 4) =       0.001545451388
  error estimate for blocks of size 2^( 5) =       0.001568822585
  error estimate for blocks of size 2^( 6) =       0.001579950378
  error estimate for blocks of size 2^( 7) =       0.001587270074

      target function =                  N/A
              le_mean =     -22.328910012082
             les_mean =     502.261451383756
             stat err =       0.001570373606
             autocorr =       1.323142580870
              std dev =       1.930730293500
             le_variance =       3.727719466238

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.170655
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =      12.325286561276
                                         uncertainty =       8.551828183559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =      12.325286561276
                                         uncertainty =       8.551828183559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.002482278374
  error estimate for blocks of size 2^( 2) =       0.002523047846
  error estimate for blocks of size 2^( 3) =       0.002562100380
  error estimate for blocks of size 2^( 4) =       0.002588659695
  error estimate for blocks of size 2^( 5) =       0.002603517348
  error estimate for blocks of size 2^( 6) =       0.002613492203
  error estimate for blocks of size 2^( 7) =       0.002629780682

      target function =                  N/A
              le_mean =     -22.326873069476
             les_mean =    1320.596884482345
             stat err =       0.002608862482
             autocorr =       1.104590763162
              std dev =       3.510527909124
             le_variance =      12.323806200741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727352590988
                                         uncertainty =       0.029509921781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727352590988
                                         uncertainty =       0.029509921781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365167549
  error estimate for blocks of size 2^( 2) =       0.001436613169
  error estimate for blocks of size 2^( 3) =       0.001501871081
  error estimate for blocks of size 2^( 4) =       0.001545458638
  error estimate for blocks of size 2^( 5) =       0.001568840900
  error estimate for blocks of size 2^( 6) =       0.001579980055
  error estimate for blocks of size 2^( 7) =       0.001587256815

      target function =                  N/A
              le_mean =     -22.328909432473
             les_mean =     502.260304620940
             stat err =       0.001570384102
             autocorr =       1.323243798841
              std dev =       1.930669353047
             le_variance =       3.727484150795


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328917028584        initial  <--
     2.3842e-02     2.3842e-01             3.1498e-03       -22.328910012082
     9.5367e-02     9.5367e-01             1.8067e-03       -22.326873069476
     3.8147e-01     3.8147e+00             8.6116e-04       -22.328909432473

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.8968
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_001                -6.988328e-01 3 1  ON 0
ci_002                -7.012700e-01 3 1  ON 1
ci_003                -6.346350e-02 3 1  ON 2
ci_004                -6.244766e-02 3 1  ON 3
ci_005                 4.560736e-02 3 1  ON 4
ci_006                 4.548521e-02 3 1  ON 5
ci_007                 3.143818e-02 3 1  ON 6
ci_008                 3.108639e-02 3 1  ON 7
ci_009                -2.516107e-02 3 1  ON 8
ci_010                -2.530075e-02 3 1  ON 9
ci_011                -2.298828e-02 3 1  ON 10
ci_012                -2.212474e-02 3 1  ON 11
ci_013                 1.931592e-02 3 1  ON 12
ci_014                 1.961074e-02 3 1  ON 13
ci_015                 1.947197e-02 3 1  ON 14
ci_016                 1.972624e-02 3 1  ON 15
ci_017                 1.569840e-02 3 1  ON 16
ci_018                 1.513847e-02 3 1  ON 17
ci_019                 1.088019e-02 3 1  ON 18
ci_020                 9.754672e-03 3 1  ON 19
ci_021                -1.086423e-02 3 1  ON 20
ci_022                -9.508524e-03 3 1  ON 21
ci_023                 8.278133e-03 3 1  ON 22
ci_024                 7.860637e-03 3 1  ON 23
ci_025                 9.033986e-03 3 1  ON 24
ci_026                 8.706400e-03 3 1  ON 25
ci_027                 7.753194e-03 3 1  ON 26
ci_028                 8.409076e-03 3 1  ON 27
ci_029                -8.183608e-03 3 1  ON 28
ci_030                -6.662146e-03 3 1  ON 29
ci_031                -9.046424e-03 3 1  ON 30
ci_032                -7.239968e-03 3 1  ON 31
ci_033                 6.454191e-03 3 1  ON 32
ci_034                 7.056340e-03 3 1  ON 33
ci_035                 6.235571e-03 3 1  ON 34
ci_036                 6.627716e-03 3 1  ON 35
ci_037                 6.155016e-03 3 1  ON 36
ci_038                 6.924453e-03 3 1  ON 37
ci_039                 5.143798e-03 3 1  ON 38
ci_040                 5.904926e-03 3 1  ON 39
ci_041                 4.576934e-03 3 1  ON 40
ci_042                 4.619845e-03 3 1  ON 41
ci_043                 4.294383e-03 3 1  ON 42
ci_044                 5.157251e-03 3 1  ON 43
ci_045                 5.862145e-03 3 1  ON 44
ci_046                 5.830599e-03 3 1  ON 45
ci_047                -4.357153e-03 3 1  ON 46
ci_048                -3.217276e-03 3 1  ON 47
ci_049                 3.661950e-03 3 1  ON 48
ci_050                 3.088460e-03 3 1  ON 49
ci_051                -2.755185e-03 3 1  ON 50
ci_052                -2.286964e-03 3 1  ON 51
ci_053                -2.221065e-03 3 1  ON 52
ci_054                -2.360960e-03 3 1  ON 53
ci_055                -7.013325e-04 3 1  ON 54
ci_056                -6.218753e-04 3 1  ON 55
ci_057                -2.274923e-03 3 1  ON 56
ci_058                -2.449220e-03 3 1  ON 57
ci_059                -2.426424e-03 3 1  ON 58
ci_060                -1.026248e-03 3 1  ON 59
ci_061                -2.591749e-03 3 1  ON 60
ci_062                -1.646235e-03 3 1  ON 61
ci_063                -1.441949e-03 3 1  ON 62
ci_064                -2.102660e-03 3 1  ON 63
ci_065                -1.316615e-03 3 1  ON 64
ci_066                -1.452989e-03 3 1  ON 65
ci_067                -2.038219e-03 3 1  ON 66
ci_068                -6.226234e-04 3 1  ON 67
ci_069                 6.065592e-04 3 1  ON 68
ci_070                 5.893739e-04 3 1  ON 69
ci_071                -1.270829e-03 3 1  ON 70
ci_072                -1.087969e-03 3 1  ON 71
ci_073                 1.307256e-03 3 1  ON 72
ci_074                 8.436009e-04 3 1  ON 73
ci_075                -6.757612e-04 3 1  ON 74
ci_076                -7.733756e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6211e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2239e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.4773
    reference variance = 3.01631
====================================================
  Execution time = 2.3447e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0309e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7216e+00
  Total weights = 1.950247570e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8248e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.770259525385
                                         uncertainty =       0.033081608774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.770259525385
                                         uncertainty =       0.033081608774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373116039
  error estimate for blocks of size 2^( 2) =       0.001444508394
  error estimate for blocks of size 2^( 3) =       0.001510217559
  error estimate for blocks of size 2^( 4) =       0.001550468830
  error estimate for blocks of size 2^( 5) =       0.001576577151
  error estimate for blocks of size 2^( 6) =       0.001591546924
  error estimate for blocks of size 2^( 7) =       0.001597336391

      target function =                  N/A
              le_mean =     -22.326716819935
             les_mean =     502.203893956168
             stat err =       0.001578982324
             autocorr =       1.322330625744
              std dev =       1.941910394888
             le_variance =       3.771015981776


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232671681994e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326716819108       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326775152323       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326775826226       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326775461533       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326775531707       residual = 7.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-01 is 1.082130e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326716819108       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326739047959       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326739038837       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326739010068       residual = 1.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 4.569939e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326716819108       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326723214532       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326723216128       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 1.389624e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172402 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9283e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_001                -6.987664e-01 3 1  ON 0
ci_002                -7.013016e-01 3 1  ON 1
ci_003                -6.351329e-02 3 1  ON 2
ci_004                -6.256618e-02 3 1  ON 3
ci_005                 4.541675e-02 3 1  ON 4
ci_006                 4.570019e-02 3 1  ON 5
ci_007                 3.177084e-02 3 1  ON 6
ci_008                 3.123457e-02 3 1  ON 7
ci_009                -2.500909e-02 3 1  ON 8
ci_010                -2.539489e-02 3 1  ON 9
ci_011                -2.311303e-02 3 1  ON 10
ci_012                -2.218836e-02 3 1  ON 11
ci_013                 1.947165e-02 3 1  ON 12
ci_014                 1.953911e-02 3 1  ON 13
ci_015                 1.930940e-02 3 1  ON 14
ci_016                 1.941659e-02 3 1  ON 15
ci_017                 1.568046e-02 3 1  ON 16
ci_018                 1.491601e-02 3 1  ON 17
ci_019                 1.063669e-02 3 1  ON 18
ci_020                 9.847084e-03 3 1  ON 19
ci_021                -1.060937e-02 3 1  ON 20
ci_022                -9.645504e-03 3 1  ON 21
ci_023                 8.463089e-03 3 1  ON 22
ci_024                 7.967356e-03 3 1  ON 23
ci_025                 9.044492e-03 3 1  ON 24
ci_026                 8.542517e-03 3 1  ON 25
ci_027                 7.874735e-03 3 1  ON 26
ci_028                 8.357855e-03 3 1  ON 27
ci_029                -8.071001e-03 3 1  ON 28
ci_030                -6.761378e-03 3 1  ON 29
ci_031                -9.106396e-03 3 1  ON 30
ci_032                -7.481904e-03 3 1  ON 31
ci_033                 6.601110e-03 3 1  ON 32
ci_034                 7.062336e-03 3 1  ON 33
ci_035                 6.321053e-03 3 1  ON 34
ci_036                 6.803078e-03 3 1  ON 35
ci_037                 6.107174e-03 3 1  ON 36
ci_038                 6.881573e-03 3 1  ON 37
ci_039                 5.331657e-03 3 1  ON 38
ci_040                 5.752900e-03 3 1  ON 39
ci_041                 4.764799e-03 3 1  ON 40
ci_042                 4.879307e-03 3 1  ON 41
ci_043                 4.526031e-03 3 1  ON 42
ci_044                 4.956580e-03 3 1  ON 43
ci_045                 5.859148e-03 3 1  ON 44
ci_046                 5.527608e-03 3 1  ON 45
ci_047                -4.409523e-03 3 1  ON 46
ci_048                -3.674270e-03 3 1  ON 47
ci_049                 3.947306e-03 3 1  ON 48
ci_050                 3.155507e-03 3 1  ON 49
ci_051                -2.684709e-03 3 1  ON 50
ci_052                -2.397037e-03 3 1  ON 51
ci_053                -2.148175e-03 3 1  ON 52
ci_054                -2.530891e-03 3 1  ON 53
ci_055                -7.940328e-04 3 1  ON 54
ci_056                -6.131175e-04 3 1  ON 55
ci_057                -2.390076e-03 3 1  ON 56
ci_058                -2.430060e-03 3 1  ON 57
ci_059                -2.537946e-03 3 1  ON 58
ci_060                -1.212857e-03 3 1  ON 59
ci_061                -2.514318e-03 3 1  ON 60
ci_062                -1.570091e-03 3 1  ON 61
ci_063                -1.322081e-03 3 1  ON 62
ci_064                -2.044810e-03 3 1  ON 63
ci_065                -1.111871e-03 3 1  ON 64
ci_066                -1.474565e-03 3 1  ON 65
ci_067                -2.025789e-03 3 1  ON 66
ci_068                -8.136117e-04 3 1  ON 67
ci_069                 9.218235e-04 3 1  ON 68
ci_070                 8.169521e-04 3 1  ON 69
ci_071                -1.296338e-03 3 1  ON 70
ci_072                -1.172673e-03 3 1  ON 71
ci_073                 1.141527e-03 3 1  ON 72
ci_074                 7.539358e-04 3 1  ON 73
ci_075                -5.979157e-04 3 1  ON 74
ci_076                -6.973501e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.4487
    reference variance = 2.40507
====================================================
  Execution time = 2.2950e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.7185e+00
  Total weights = 1.9498e+06
  Execution time = 4.3320e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.768924496973
                                         uncertainty =       0.029985378531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.768924496973
                                         uncertainty =       0.029985378531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372941319
  error estimate for blocks of size 2^( 2) =       0.001444199474
  error estimate for blocks of size 2^( 3) =       0.001506904493
  error estimate for blocks of size 2^( 4) =       0.001551343425
  error estimate for blocks of size 2^( 5) =       0.001574826588
  error estimate for blocks of size 2^( 6) =       0.001587921900
  error estimate for blocks of size 2^( 7) =       0.001597100435

      target function =                  N/A
              le_mean =     -22.330789367194
             les_mean =     502.383224535577
             stat err =       0.001577798087
             autocorr =       1.320683949242
              std dev =       1.941663299077
             le_variance =       3.770056366982

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.276514
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.769188201587
                                         uncertainty =       0.029986519465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.769188201587
                                         uncertainty =       0.029986519465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372989139
  error estimate for blocks of size 2^( 2) =       0.001444233870
  error estimate for blocks of size 2^( 3) =       0.001506921673
  error estimate for blocks of size 2^( 4) =       0.001551342032
  error estimate for blocks of size 2^( 5) =       0.001574813367
  error estimate for blocks of size 2^( 6) =       0.001587898954
  error estimate for blocks of size 2^( 7) =       0.001597122799

      target function =                  N/A
              le_mean =     -22.330803393906
             les_mean =     502.385207096595
             stat err =       0.001577794288
             autocorr =       1.320585594800
              std dev =       1.941730927747
             le_variance =       3.770318995768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.769119028778
                                         uncertainty =       0.029985367296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.769119028778
                                         uncertainty =       0.029985367296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372976622
  error estimate for blocks of size 2^( 2) =       0.001444226497
  error estimate for blocks of size 2^( 3) =       0.001506918731
  error estimate for blocks of size 2^( 4) =       0.001551346350
  error estimate for blocks of size 2^( 5) =       0.001574821093
  error estimate for blocks of size 2^( 6) =       0.001587907451
  error estimate for blocks of size 2^( 7) =       0.001597123350

      target function =                  N/A
              le_mean =     -22.330794384682
             les_mean =     502.412473482263
             stat err =       0.001577799561
             autocorr =       1.320618499690
              std dev =       1.941713226606
             le_variance =       3.770250254376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.768942861699
                                         uncertainty =       0.029985594484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.768942861699
                                         uncertainty =       0.029985594484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372944647
  error estimate for blocks of size 2^( 2) =       0.001444201127
  error estimate for blocks of size 2^( 3) =       0.001506904179
  error estimate for blocks of size 2^( 4) =       0.001551342129
  error estimate for blocks of size 2^( 5) =       0.001574824420
  error estimate for blocks of size 2^( 6) =       0.001587918515
  error estimate for blocks of size 2^( 7) =       0.001597102432

      target function =                  N/A
              le_mean =     -22.330787657297
             les_mean =     502.383598766323
             stat err =       0.001577796874
             autocorr =       1.320675514694
              std dev =       1.941668006710
             le_variance =       3.770074648280


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330789367194        initial
     2.3842e-01     2.3842e+00             1.0821e-03       -22.330803393906  <--
     9.5367e-01     9.5367e+00             4.5699e-04       -22.330794384682
     3.8147e+00     3.8147e+01             1.3896e-04       -22.330787657297

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 4.4687e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_001                -6.985745e-01 3 1  ON 0
ci_002                -7.014276e-01 3 1  ON 1
ci_003                -6.361679e-02 3 1  ON 2
ci_004                -6.286820e-02 3 1  ON 3
ci_005                 4.511218e-02 3 1  ON 4
ci_006                 4.602478e-02 3 1  ON 5
ci_007                 3.235446e-02 3 1  ON 6
ci_008                 3.154351e-02 3 1  ON 7
ci_009                -2.470187e-02 3 1  ON 8
ci_010                -2.557566e-02 3 1  ON 9
ci_011                -2.337198e-02 3 1  ON 10
ci_012                -2.228424e-02 3 1  ON 11
ci_013                 1.975353e-02 3 1  ON 12
ci_014                 1.940840e-02 3 1  ON 13
ci_015                 1.901766e-02 3 1  ON 14
ci_016                 1.878309e-02 3 1  ON 15
ci_017                 1.566477e-02 3 1  ON 16
ci_018                 1.451069e-02 3 1  ON 17
ci_019                 1.013672e-02 3 1  ON 18
ci_020                 1.006970e-02 3 1  ON 19
ci_021                -1.009427e-02 3 1  ON 20
ci_022                -9.912116e-03 3 1  ON 21
ci_023                 8.768622e-03 3 1  ON 22
ci_024                 8.140924e-03 3 1  ON 23
ci_025                 9.089460e-03 3 1  ON 24
ci_026                 8.227061e-03 3 1  ON 25
ci_027                 8.033793e-03 3 1  ON 26
ci_028                 8.285202e-03 3 1  ON 27
ci_029                -7.873783e-03 3 1  ON 28
ci_030                -6.955234e-03 3 1  ON 29
ci_031                -9.239940e-03 3 1  ON 30
ci_032                -7.933461e-03 3 1  ON 31
ci_033                 6.866380e-03 3 1  ON 32
ci_034                 7.107233e-03 3 1  ON 33
ci_035                 6.439224e-03 3 1  ON 34
ci_036                 7.033641e-03 3 1  ON 35
ci_037                 6.049096e-03 3 1  ON 36
ci_038                 6.801919e-03 3 1  ON 37
ci_039                 5.570689e-03 3 1  ON 38
ci_040                 5.538663e-03 3 1  ON 39
ci_041                 5.041163e-03 3 1  ON 40
ci_042                 5.265319e-03 3 1  ON 41
ci_043                 4.901734e-03 3 1  ON 42
ci_044                 4.590353e-03 3 1  ON 43
ci_045                 5.834226e-03 3 1  ON 44
ci_046                 5.010372e-03 3 1  ON 45
ci_047                -4.473531e-03 3 1  ON 46
ci_048                -4.299406e-03 3 1  ON 47
ci_049                 4.456448e-03 3 1  ON 48
ci_050                 3.278778e-03 3 1  ON 49
ci_051                -2.585843e-03 3 1  ON 50
ci_052                -2.588601e-03 3 1  ON 51
ci_053                -2.015273e-03 3 1  ON 52
ci_054                -2.828139e-03 3 1  ON 53
ci_055                -9.890186e-04 3 1  ON 54
ci_056                -5.867125e-04 3 1  ON 55
ci_057                -2.580807e-03 3 1  ON 56
ci_058                -2.405581e-03 3 1  ON 57
ci_059                -2.699533e-03 3 1  ON 58
ci_060                -1.463336e-03 3 1  ON 59
ci_061                -2.414591e-03 3 1  ON 60
ci_062                -1.429628e-03 3 1  ON 61
ci_063                -1.113594e-03 3 1  ON 62
ci_064                -1.945197e-03 3 1  ON 63
ci_065                -7.897621e-04 3 1  ON 64
ci_066                -1.524310e-03 3 1  ON 65
ci_067                -1.989455e-03 3 1  ON 66
ci_068                -1.139705e-03 3 1  ON 67
ci_069                 1.446598e-03 3 1  ON 68
ci_070                 1.213737e-03 3 1  ON 69
ci_071                -1.369601e-03 3 1  ON 70
ci_072                -1.325973e-03 3 1  ON 71
ci_073                 9.408351e-04 3 1  ON 72
ci_074                 6.437230e-04 3 1  ON 73
ci_075                -4.888994e-04 3 1  ON 74
ci_076                -5.716430e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3985e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2249e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.3928
    reference variance = 2.06659
====================================================
  Execution time = 2.3421e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0342e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6957e+00
  Total weights = 1.949968066e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8129e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.748215134398
                                         uncertainty =       0.029224284519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.748215134398
                                         uncertainty =       0.029224284519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368812089
  error estimate for blocks of size 2^( 2) =       0.001439849857
  error estimate for blocks of size 2^( 3) =       0.001503586337
  error estimate for blocks of size 2^( 4) =       0.001547134604
  error estimate for blocks of size 2^( 5) =       0.001567297382
  error estimate for blocks of size 2^( 6) =       0.001579728275
  error estimate for blocks of size 2^( 7) =       0.001587735293

      target function =                  N/A
              le_mean =     -22.327920891516
             les_mean =     502.231751297869
             stat err =       0.001570473888
             autocorr =       1.316357267582
              std dev =       1.935823593457
             le_variance =       3.747412984987


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232792089152e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327920890719       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328010353883       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328013791106       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328014707041       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328016510342       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328016703123       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.328016813220       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-02 is 2.449928e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327920890719       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327973351967       residual = 9.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327973167747       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327973105539       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327973197837       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-01 is 9.413723e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327920890719       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327940654437       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327940388351       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327940369131       residual = 1.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 3.440085e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176635 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9245e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_001                -6.979600e-01 3 1  ON 0
ci_002                -7.020206e-01 3 1  ON 1
ci_003                -6.337196e-02 3 1  ON 2
ci_004                -6.256782e-02 3 1  ON 3
ci_005                 4.529834e-02 3 1  ON 4
ci_006                 4.593982e-02 3 1  ON 5
ci_007                 3.243946e-02 3 1  ON 6
ci_008                 3.173519e-02 3 1  ON 7
ci_009                -2.511743e-02 3 1  ON 8
ci_010                -2.577504e-02 3 1  ON 9
ci_011                -2.299475e-02 3 1  ON 10
ci_012                -2.197672e-02 3 1  ON 11
ci_013                 1.966893e-02 3 1  ON 12
ci_014                 1.985923e-02 3 1  ON 13
ci_015                 1.982039e-02 3 1  ON 14
ci_016                 1.929142e-02 3 1  ON 15
ci_017                 1.586389e-02 3 1  ON 16
ci_018                 1.449445e-02 3 1  ON 17
ci_019                 1.070768e-02 3 1  ON 18
ci_020                 1.023359e-02 3 1  ON 19
ci_021                -1.046729e-02 3 1  ON 20
ci_022                -9.921075e-03 3 1  ON 21
ci_023                 7.862765e-03 3 1  ON 22
ci_024                 8.480158e-03 3 1  ON 23
ci_025                 8.299920e-03 3 1  ON 24
ci_026                 8.622527e-03 3 1  ON 25
ci_027                 7.953649e-03 3 1  ON 26
ci_028                 7.749177e-03 3 1  ON 27
ci_029                -7.326128e-03 3 1  ON 28
ci_030                -7.821288e-03 3 1  ON 29
ci_031                -9.221505e-03 3 1  ON 30
ci_032                -7.506395e-03 3 1  ON 31
ci_033                 6.642306e-03 3 1  ON 32
ci_034                 6.916404e-03 3 1  ON 33
ci_035                 6.459346e-03 3 1  ON 34
ci_036                 6.880944e-03 3 1  ON 35
ci_037                 6.960041e-03 3 1  ON 36
ci_038                 7.264928e-03 3 1  ON 37
ci_039                 5.634234e-03 3 1  ON 38
ci_040                 4.775159e-03 3 1  ON 39
ci_041                 5.135096e-03 3 1  ON 40
ci_042                 5.375898e-03 3 1  ON 41
ci_043                 5.080516e-03 3 1  ON 42
ci_044                 4.721397e-03 3 1  ON 43
ci_045                 5.888143e-03 3 1  ON 44
ci_046                 4.772767e-03 3 1  ON 45
ci_047                -4.086328e-03 3 1  ON 46
ci_048                -4.431244e-03 3 1  ON 47
ci_049                 4.867856e-03 3 1  ON 48
ci_050                 3.837550e-03 3 1  ON 49
ci_051                -2.813160e-03 3 1  ON 50
ci_052                -2.811029e-03 3 1  ON 51
ci_053                -2.620388e-03 3 1  ON 52
ci_054                -2.688881e-03 3 1  ON 53
ci_055                -1.584806e-03 3 1  ON 54
ci_056                -1.528085e-03 3 1  ON 55
ci_057                -2.538531e-03 3 1  ON 56
ci_058                -1.963255e-03 3 1  ON 57
ci_059                -2.003256e-03 3 1  ON 58
ci_060                -1.904891e-03 3 1  ON 59
ci_061                -2.532776e-03 3 1  ON 60
ci_062                -6.935940e-04 3 1  ON 61
ci_063                -7.605786e-04 3 1  ON 62
ci_064                -1.533619e-03 3 1  ON 63
ci_065                -9.462637e-04 3 1  ON 64
ci_066                -1.895150e-03 3 1  ON 65
ci_067                -1.810380e-03 3 1  ON 66
ci_068                -7.270184e-04 3 1  ON 67
ci_069                 1.430304e-03 3 1  ON 68
ci_070                 1.717942e-03 3 1  ON 69
ci_071                -1.351259e-03 3 1  ON 70
ci_072                -1.381796e-03 3 1  ON 71
ci_073                 6.636085e-04 3 1  ON 72
ci_074                 1.253991e-03 3 1  ON 73
ci_075                -9.437383e-04 3 1  ON 74
ci_076                -6.023325e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.6068
    reference variance = 2.34783
====================================================
  Execution time = 2.2976e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.9650e+00
  Total weights = 1.9498e+06
  Execution time = 4.3210e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.022369776160
                                         uncertainty =       0.234095667541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.022369776160
                                         uncertainty =       0.234095667541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001418122164
  error estimate for blocks of size 2^( 2) =       0.001488607900
  error estimate for blocks of size 2^( 3) =       0.001550352096
  error estimate for blocks of size 2^( 4) =       0.001593787825
  error estimate for blocks of size 2^( 5) =       0.001615609905
  error estimate for blocks of size 2^( 6) =       0.001629139418
  error estimate for blocks of size 2^( 7) =       0.001636156266

      target function =                  N/A
              le_mean =     -22.326193249872
             les_mean =     502.424916532678
             stat err =       0.001618673353
             autocorr =       1.302840184000
              std dev =       2.005559686124
             le_variance =       4.022269654607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.022653388095
                                         uncertainty =       0.234085613242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.022653388095
                                         uncertainty =       0.234085613242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001418172433
  error estimate for blocks of size 2^( 2) =       0.001488651181
  error estimate for blocks of size 2^( 3) =       0.001550396263
  error estimate for blocks of size 2^( 4) =       0.001593828804
  error estimate for blocks of size 2^( 5) =       0.001615638022
  error estimate for blocks of size 2^( 6) =       0.001629127446
  error estimate for blocks of size 2^( 7) =       0.001636163383

      target function =                  N/A
              le_mean =     -22.326183979131
             les_mean =     502.424233209823
             stat err =       0.001618689414
             autocorr =       1.302773675900
              std dev =       2.005630777768
             le_variance =       4.022554816731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.022741066347
                                         uncertainty =       0.234084941233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.022741066347
                                         uncertainty =       0.234084941233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001418187910
  error estimate for blocks of size 2^( 2) =       0.001488665054
  error estimate for blocks of size 2^( 3) =       0.001550409061
  error estimate for blocks of size 2^( 4) =       0.001593844078
  error estimate for blocks of size 2^( 5) =       0.001615653081
  error estimate for blocks of size 2^( 6) =       0.001629135559
  error estimate for blocks of size 2^( 7) =       0.001636154319

      target function =                  N/A
              le_mean =     -22.326196142959
             les_mean =     502.451804509742
             stat err =       0.001618696759
             autocorr =       1.302757065061
              std dev =       2.005652665568
             le_variance =       4.022642614900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.022366110166
                                         uncertainty =       0.234093872654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.022366110166
                                         uncertainty =       0.234093872654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001418121583
  error estimate for blocks of size 2^( 2) =       0.001488607106
  error estimate for blocks of size 2^( 3) =       0.001550351084
  error estimate for blocks of size 2^( 4) =       0.001593788246
  error estimate for blocks of size 2^( 5) =       0.001615611852
  error estimate for blocks of size 2^( 6) =       0.001629129670
  error estimate for blocks of size 2^( 7) =       0.001636150216

      target function =                  N/A
              le_mean =     -22.326182138899
             les_mean =     502.424763544668
             stat err =       0.001618669996
             autocorr =       1.302835847102
              std dev =       2.005558864213
             le_variance =       4.022266357823


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326193249872        initial
     5.9605e-02     5.9605e-01             2.4499e-03       -22.326183979131
     2.3842e-01     2.3842e+00             9.4137e-04       -22.326196142959  <--
     9.5367e-01     9.5367e+00             3.4401e-04       -22.326182138899

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 4.4780e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_001                -6.979600e-01 3 1  ON 0
ci_002                -7.020206e-01 3 1  ON 1
ci_003                -6.337196e-02 3 1  ON 2
ci_004                -6.256782e-02 3 1  ON 3
ci_005                 4.529834e-02 3 1  ON 4
ci_006                 4.593982e-02 3 1  ON 5
ci_007                 3.243946e-02 3 1  ON 6
ci_008                 3.173519e-02 3 1  ON 7
ci_009                -2.511743e-02 3 1  ON 8
ci_010                -2.577504e-02 3 1  ON 9
ci_011                -2.299475e-02 3 1  ON 10
ci_012                -2.197672e-02 3 1  ON 11
ci_013                 1.966893e-02 3 1  ON 12
ci_014                 1.985923e-02 3 1  ON 13
ci_015                 1.982039e-02 3 1  ON 14
ci_016                 1.929142e-02 3 1  ON 15
ci_017                 1.586389e-02 3 1  ON 16
ci_018                 1.449445e-02 3 1  ON 17
ci_019                 1.070768e-02 3 1  ON 18
ci_020                 1.023359e-02 3 1  ON 19
ci_021                -1.046729e-02 3 1  ON 20
ci_022                -9.921075e-03 3 1  ON 21
ci_023                 7.862765e-03 3 1  ON 22
ci_024                 8.480158e-03 3 1  ON 23
ci_025                 8.299920e-03 3 1  ON 24
ci_026                 8.622527e-03 3 1  ON 25
ci_027                 7.953649e-03 3 1  ON 26
ci_028                 7.749177e-03 3 1  ON 27
ci_029                -7.326128e-03 3 1  ON 28
ci_030                -7.821288e-03 3 1  ON 29
ci_031                -9.221505e-03 3 1  ON 30
ci_032                -7.506395e-03 3 1  ON 31
ci_033                 6.642306e-03 3 1  ON 32
ci_034                 6.916404e-03 3 1  ON 33
ci_035                 6.459346e-03 3 1  ON 34
ci_036                 6.880944e-03 3 1  ON 35
ci_037                 6.960041e-03 3 1  ON 36
ci_038                 7.264928e-03 3 1  ON 37
ci_039                 5.634234e-03 3 1  ON 38
ci_040                 4.775159e-03 3 1  ON 39
ci_041                 5.135096e-03 3 1  ON 40
ci_042                 5.375898e-03 3 1  ON 41
ci_043                 5.080516e-03 3 1  ON 42
ci_044                 4.721397e-03 3 1  ON 43
ci_045                 5.888143e-03 3 1  ON 44
ci_046                 4.772767e-03 3 1  ON 45
ci_047                -4.086328e-03 3 1  ON 46
ci_048                -4.431244e-03 3 1  ON 47
ci_049                 4.867856e-03 3 1  ON 48
ci_050                 3.837550e-03 3 1  ON 49
ci_051                -2.813160e-03 3 1  ON 50
ci_052                -2.811029e-03 3 1  ON 51
ci_053                -2.620388e-03 3 1  ON 52
ci_054                -2.688881e-03 3 1  ON 53
ci_055                -1.584806e-03 3 1  ON 54
ci_056                -1.528085e-03 3 1  ON 55
ci_057                -2.538531e-03 3 1  ON 56
ci_058                -1.963255e-03 3 1  ON 57
ci_059                -2.003256e-03 3 1  ON 58
ci_060                -1.904891e-03 3 1  ON 59
ci_061                -2.532776e-03 3 1  ON 60
ci_062                -6.935940e-04 3 1  ON 61
ci_063                -7.605786e-04 3 1  ON 62
ci_064                -1.533619e-03 3 1  ON 63
ci_065                -9.462637e-04 3 1  ON 64
ci_066                -1.895150e-03 3 1  ON 65
ci_067                -1.810380e-03 3 1  ON 66
ci_068                -7.270184e-04 3 1  ON 67
ci_069                 1.430304e-03 3 1  ON 68
ci_070                 1.717942e-03 3 1  ON 69
ci_071                -1.351259e-03 3 1  ON 70
ci_072                -1.381796e-03 3 1  ON 71
ci_073                 6.636085e-04 3 1  ON 72
ci_074                 1.253991e-03 3 1  ON 73
ci_075                -9.437383e-04 3 1  ON 74
ci_076                -6.023325e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4058e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2259e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.2988
    reference variance = 2.68412
====================================================
  Execution time = 2.3430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0317e+04
  VMC Eavg = -2.2323e+01
  VMC Evar = 3.7616e+00
  Total weights = 1.949978516e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8153e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814123990461
                                         uncertainty =       0.049101244248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814123990461
                                         uncertainty =       0.049101244248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380817772
  error estimate for blocks of size 2^( 2) =       0.001453116301
  error estimate for blocks of size 2^( 3) =       0.001516269493
  error estimate for blocks of size 2^( 4) =       0.001559458931
  error estimate for blocks of size 2^( 5) =       0.001583972679
  error estimate for blocks of size 2^( 6) =       0.001602162970
  error estimate for blocks of size 2^( 7) =       0.001614990552

      target function =                  N/A
              le_mean =     -22.323436208191
             les_mean =     502.097436653768
             stat err =       0.001590146283
             autocorr =       1.326176783660
              std dev =       1.952802464535
             le_variance =       3.813437465495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232343620819e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.323436207366       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.323519493582       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.323534381159       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.323534926761       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.323538642277       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.323538741011       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.323538522115       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.323538598541       residual = 1.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-02 is 3.306553e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.323436207366       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.323484968881       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.323488884023       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.323488510147       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.323488700908       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-01 is 1.222490e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.323436207366       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.323454551549       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.323455056126       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.323455011048       residual = 3.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 4.586782e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181051 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9258e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_001                -6.988262e-01 3 1  ON 0
ci_002                -7.012762e-01 3 1  ON 1
ci_003                -6.282734e-02 3 1  ON 2
ci_004                -6.255525e-02 3 1  ON 3
ci_005                 4.521079e-02 3 1  ON 4
ci_006                 4.600852e-02 3 1  ON 5
ci_007                 3.121697e-02 3 1  ON 6
ci_008                 3.178115e-02 3 1  ON 7
ci_009                -2.433928e-02 3 1  ON 8
ci_010                -2.549377e-02 3 1  ON 9
ci_011                -2.331639e-02 3 1  ON 10
ci_012                -2.211867e-02 3 1  ON 11
ci_013                 2.008279e-02 3 1  ON 12
ci_014                 1.996803e-02 3 1  ON 13
ci_015                 1.960220e-02 3 1  ON 14
ci_016                 1.898164e-02 3 1  ON 15
ci_017                 1.595199e-02 3 1  ON 16
ci_018                 1.545897e-02 3 1  ON 17
ci_019                 1.044244e-02 3 1  ON 18
ci_020                 9.984523e-03 3 1  ON 19
ci_021                -1.121196e-02 3 1  ON 20
ci_022                -1.073585e-02 3 1  ON 21
ci_023                 7.968504e-03 3 1  ON 22
ci_024                 8.168181e-03 3 1  ON 23
ci_025                 8.632649e-03 3 1  ON 24
ci_026                 8.349708e-03 3 1  ON 25
ci_027                 7.952729e-03 3 1  ON 26
ci_028                 7.441272e-03 3 1  ON 27
ci_029                -7.680678e-03 3 1  ON 28
ci_030                -7.579372e-03 3 1  ON 29
ci_031                -8.480560e-03 3 1  ON 30
ci_032                -7.713406e-03 3 1  ON 31
ci_033                 6.686901e-03 3 1  ON 32
ci_034                 6.778704e-03 3 1  ON 33
ci_035                 6.938485e-03 3 1  ON 34
ci_036                 6.405915e-03 3 1  ON 35
ci_037                 7.398363e-03 3 1  ON 36
ci_038                 6.759746e-03 3 1  ON 37
ci_039                 5.402920e-03 3 1  ON 38
ci_040                 5.359233e-03 3 1  ON 39
ci_041                 4.893847e-03 3 1  ON 40
ci_042                 5.708717e-03 3 1  ON 41
ci_043                 4.438796e-03 3 1  ON 42
ci_044                 4.211813e-03 3 1  ON 43
ci_045                 5.549765e-03 3 1  ON 44
ci_046                 4.615643e-03 3 1  ON 45
ci_047                -3.952202e-03 3 1  ON 46
ci_048                -4.287600e-03 3 1  ON 47
ci_049                 4.104818e-03 3 1  ON 48
ci_050                 4.326280e-03 3 1  ON 49
ci_051                -2.983550e-03 3 1  ON 50
ci_052                -3.386776e-03 3 1  ON 51
ci_053                -2.402613e-03 3 1  ON 52
ci_054                -3.088757e-03 3 1  ON 53
ci_055                -1.784439e-03 3 1  ON 54
ci_056                -1.278753e-03 3 1  ON 55
ci_057                -2.741864e-03 3 1  ON 56
ci_058                -2.085617e-03 3 1  ON 57
ci_059                -2.338937e-03 3 1  ON 58
ci_060                -2.262116e-03 3 1  ON 59
ci_061                -1.851821e-03 3 1  ON 60
ci_062                -7.268360e-04 3 1  ON 61
ci_063                -9.243385e-04 3 1  ON 62
ci_064                -1.250774e-03 3 1  ON 63
ci_065                -1.201413e-03 3 1  ON 64
ci_066                -1.459158e-03 3 1  ON 65
ci_067                -9.867524e-04 3 1  ON 66
ci_068                -9.169738e-04 3 1  ON 67
ci_069                 1.922634e-03 3 1  ON 68
ci_070                 1.595434e-03 3 1  ON 69
ci_071                -1.743968e-03 3 1  ON 70
ci_072                -1.329122e-03 3 1  ON 71
ci_073                 8.504656e-04 3 1  ON 72
ci_074                 1.287463e-03 3 1  ON 73
ci_075                -1.457630e-03 3 1  ON 74
ci_076                 3.570306e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.1103
    reference variance = 3.96201
====================================================
  Execution time = 2.2999e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7018e+00
  Total weights = 1.9500e+06
  Execution time = 4.3334e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.752391636737
                                         uncertainty =       0.026088358719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.752391636737
                                         uncertainty =       0.026088358719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369565593
  error estimate for blocks of size 2^( 2) =       0.001440399523
  error estimate for blocks of size 2^( 3) =       0.001502557503
  error estimate for blocks of size 2^( 4) =       0.001546359375
  error estimate for blocks of size 2^( 5) =       0.001566628189
  error estimate for blocks of size 2^( 6) =       0.001579331737
  error estimate for blocks of size 2^( 7) =       0.001584523056

      target function =                  N/A
              le_mean =     -22.330367719006
             les_mean =     502.652401764135
             stat err =       0.001569210589
             autocorr =       1.312794615790
              std dev =       1.936889225217
             le_variance =       3.751539870761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751537648711
                                         uncertainty =       0.026096925564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751537648711
                                         uncertainty =       0.026096925564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369409354
  error estimate for blocks of size 2^( 2) =       0.001440268778
  error estimate for blocks of size 2^( 3) =       0.001502441754
  error estimate for blocks of size 2^( 4) =       0.001546265461
  error estimate for blocks of size 2^( 5) =       0.001566520608
  error estimate for blocks of size 2^( 6) =       0.001579082494
  error estimate for blocks of size 2^( 7) =       0.001584217443

      target function =                  N/A
              le_mean =     -22.330326642403
             les_mean =     502.350706810929
             stat err =       0.001569021502
             autocorr =       1.312777758439
              std dev =       1.936668266710
             le_variance =       3.750683975281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.752581817238
                                         uncertainty =       0.026229893658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.752581817238
                                         uncertainty =       0.026229893658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369599588
  error estimate for blocks of size 2^( 2) =       0.001440420573
  error estimate for blocks of size 2^( 3) =       0.001502583099
  error estimate for blocks of size 2^( 4) =       0.001546414110
  error estimate for blocks of size 2^( 5) =       0.001566626526
  error estimate for blocks of size 2^( 6) =       0.001579213200
  error estimate for blocks of size 2^( 7) =       0.001584428282

      target function =                  N/A
              le_mean =     -22.330357783245
             les_mean =     502.552743404705
             stat err =       0.001569170529
             autocorr =       1.312662422040
              std dev =       1.936937302609
             le_variance =       3.751726114239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751629522520
                                         uncertainty =       0.026094806104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751629522520
                                         uncertainty =       0.026094806104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369426367
  error estimate for blocks of size 2^( 2) =       0.001440268460
  error estimate for blocks of size 2^( 3) =       0.001502439901
  error estimate for blocks of size 2^( 4) =       0.001546248070
  error estimate for blocks of size 2^( 5) =       0.001566494171
  error estimate for blocks of size 2^( 6) =       0.001579093591
  error estimate for blocks of size 2^( 7) =       0.001584248868

      target function =                  N/A
              le_mean =     -22.330322517464
             les_mean =     502.504090471037
             stat err =       0.001569021175
             autocorr =       1.312744593629
              std dev =       1.936692327104
             le_variance =       3.750777169863


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330367719006        initial  <--
     5.9605e-02     5.9605e-01             3.3066e-03       -22.330326642403
     2.3842e-01     2.3842e+00             1.2225e-03       -22.330357783245
     9.5367e-01     9.5367e+00             4.5868e-04       -22.330322517464

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8095
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_001                -6.979600e-01 3 1  ON 0
ci_002                -7.020206e-01 3 1  ON 1
ci_003                -6.337196e-02 3 1  ON 2
ci_004                -6.256782e-02 3 1  ON 3
ci_005                 4.529834e-02 3 1  ON 4
ci_006                 4.593982e-02 3 1  ON 5
ci_007                 3.243946e-02 3 1  ON 6
ci_008                 3.173519e-02 3 1  ON 7
ci_009                -2.511743e-02 3 1  ON 8
ci_010                -2.577504e-02 3 1  ON 9
ci_011                -2.299475e-02 3 1  ON 10
ci_012                -2.197672e-02 3 1  ON 11
ci_013                 1.966893e-02 3 1  ON 12
ci_014                 1.985923e-02 3 1  ON 13
ci_015                 1.982039e-02 3 1  ON 14
ci_016                 1.929142e-02 3 1  ON 15
ci_017                 1.586389e-02 3 1  ON 16
ci_018                 1.449445e-02 3 1  ON 17
ci_019                 1.070768e-02 3 1  ON 18
ci_020                 1.023359e-02 3 1  ON 19
ci_021                -1.046729e-02 3 1  ON 20
ci_022                -9.921075e-03 3 1  ON 21
ci_023                 7.862765e-03 3 1  ON 22
ci_024                 8.480158e-03 3 1  ON 23
ci_025                 8.299920e-03 3 1  ON 24
ci_026                 8.622527e-03 3 1  ON 25
ci_027                 7.953649e-03 3 1  ON 26
ci_028                 7.749177e-03 3 1  ON 27
ci_029                -7.326128e-03 3 1  ON 28
ci_030                -7.821288e-03 3 1  ON 29
ci_031                -9.221505e-03 3 1  ON 30
ci_032                -7.506395e-03 3 1  ON 31
ci_033                 6.642306e-03 3 1  ON 32
ci_034                 6.916404e-03 3 1  ON 33
ci_035                 6.459346e-03 3 1  ON 34
ci_036                 6.880944e-03 3 1  ON 35
ci_037                 6.960041e-03 3 1  ON 36
ci_038                 7.264928e-03 3 1  ON 37
ci_039                 5.634234e-03 3 1  ON 38
ci_040                 4.775159e-03 3 1  ON 39
ci_041                 5.135096e-03 3 1  ON 40
ci_042                 5.375898e-03 3 1  ON 41
ci_043                 5.080516e-03 3 1  ON 42
ci_044                 4.721397e-03 3 1  ON 43
ci_045                 5.888143e-03 3 1  ON 44
ci_046                 4.772767e-03 3 1  ON 45
ci_047                -4.086328e-03 3 1  ON 46
ci_048                -4.431244e-03 3 1  ON 47
ci_049                 4.867856e-03 3 1  ON 48
ci_050                 3.837550e-03 3 1  ON 49
ci_051                -2.813160e-03 3 1  ON 50
ci_052                -2.811029e-03 3 1  ON 51
ci_053                -2.620388e-03 3 1  ON 52
ci_054                -2.688881e-03 3 1  ON 53
ci_055                -1.584806e-03 3 1  ON 54
ci_056                -1.528085e-03 3 1  ON 55
ci_057                -2.538531e-03 3 1  ON 56
ci_058                -1.963255e-03 3 1  ON 57
ci_059                -2.003256e-03 3 1  ON 58
ci_060                -1.904891e-03 3 1  ON 59
ci_061                -2.532776e-03 3 1  ON 60
ci_062                -6.935940e-04 3 1  ON 61
ci_063                -7.605786e-04 3 1  ON 62
ci_064                -1.533619e-03 3 1  ON 63
ci_065                -9.462637e-04 3 1  ON 64
ci_066                -1.895150e-03 3 1  ON 65
ci_067                -1.810380e-03 3 1  ON 66
ci_068                -7.270184e-04 3 1  ON 67
ci_069                 1.430304e-03 3 1  ON 68
ci_070                 1.717942e-03 3 1  ON 69
ci_071                -1.351259e-03 3 1  ON 70
ci_072                -1.381796e-03 3 1  ON 71
ci_073                 6.636085e-04 3 1  ON 72
ci_074                 1.253991e-03 3 1  ON 73
ci_075                -9.437383e-04 3 1  ON 74
ci_076                -6.023325e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4083e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2257e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.1044
    reference variance = 3.11328
====================================================
  Execution time = 2.3487e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0313e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 4.3096e+00
  Total weights = 1.949976699e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8454e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.363396221886
                                         uncertainty =       0.657063182876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.363396221886
                                         uncertainty =       0.657063182876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001478915308
  error estimate for blocks of size 2^( 2) =       0.001545599037
  error estimate for blocks of size 2^( 3) =       0.001605168001
  error estimate for blocks of size 2^( 4) =       0.001650242118
  error estimate for blocks of size 2^( 5) =       0.001674193422
  error estimate for blocks of size 2^( 6) =       0.001689092605
  error estimate for blocks of size 2^( 7) =       0.001686410179

      target function =                  N/A
              le_mean =     -22.327843589122
             les_mean =     502.842225881191
             stat err =       0.001674984581
             autocorr =       1.282729310425
              std dev =       2.091535550060
             le_variance =       4.374520957163


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232784358912e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327843588279       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327865344893       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327865509656       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327865477196       residual = 4.25e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 6.098958e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327843588279       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327850119104       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327850091076       residual = 5.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 1.703872e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327843588279       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327845307236       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327845295604       residual = 1.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 4.461353e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184206 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9343e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_001                -6.979195e-01 3 1  ON 0
ci_002                -7.020489e-01 3 1  ON 1
ci_003                -6.337512e-02 3 1  ON 2
ci_004                -6.262720e-02 3 1  ON 3
ci_005                 4.542046e-02 3 1  ON 4
ci_006                 4.597315e-02 3 1  ON 5
ci_007                 3.226907e-02 3 1  ON 6
ci_008                 3.175007e-02 3 1  ON 7
ci_009                -2.517132e-02 3 1  ON 8
ci_010                -2.576767e-02 3 1  ON 9
ci_011                -2.296771e-02 3 1  ON 10
ci_012                -2.210404e-02 3 1  ON 11
ci_013                 1.969581e-02 3 1  ON 12
ci_014                 1.982387e-02 3 1  ON 13
ci_015                 1.979490e-02 3 1  ON 14
ci_016                 1.946086e-02 3 1  ON 15
ci_017                 1.576978e-02 3 1  ON 16
ci_018                 1.460780e-02 3 1  ON 17
ci_019                 1.060773e-02 3 1  ON 18
ci_020                 1.027556e-02 3 1  ON 19
ci_021                -1.041424e-02 3 1  ON 20
ci_022                -9.892241e-03 3 1  ON 21
ci_023                 7.930966e-03 3 1  ON 22
ci_024                 8.503498e-03 3 1  ON 23
ci_025                 8.187519e-03 3 1  ON 24
ci_026                 8.663797e-03 3 1  ON 25
ci_027                 7.869737e-03 3 1  ON 26
ci_028                 7.742917e-03 3 1  ON 27
ci_029                -7.328090e-03 3 1  ON 28
ci_030                -7.899066e-03 3 1  ON 29
ci_031                -9.157116e-03 3 1  ON 30
ci_032                -7.488361e-03 3 1  ON 31
ci_033                 6.735432e-03 3 1  ON 32
ci_034                 7.006460e-03 3 1  ON 33
ci_035                 6.417552e-03 3 1  ON 34
ci_036                 6.807451e-03 3 1  ON 35
ci_037                 6.833080e-03 3 1  ON 36
ci_038                 7.139232e-03 3 1  ON 37
ci_039                 5.596173e-03 3 1  ON 38
ci_040                 4.863630e-03 3 1  ON 39
ci_041                 5.175729e-03 3 1  ON 40
ci_042                 5.346160e-03 3 1  ON 41
ci_043                 5.139112e-03 3 1  ON 42
ci_044                 4.811271e-03 3 1  ON 43
ci_045                 5.830168e-03 3 1  ON 44
ci_046                 4.809781e-03 3 1  ON 45
ci_047                -4.139458e-03 3 1  ON 46
ci_048                -4.441710e-03 3 1  ON 47
ci_049                 4.756379e-03 3 1  ON 48
ci_050                 3.729778e-03 3 1  ON 49
ci_051                -2.812078e-03 3 1  ON 50
ci_052                -2.735019e-03 3 1  ON 51
ci_053                -2.647651e-03 3 1  ON 52
ci_054                -2.687472e-03 3 1  ON 53
ci_055                -1.565111e-03 3 1  ON 54
ci_056                -1.609958e-03 3 1  ON 55
ci_057                -2.505305e-03 3 1  ON 56
ci_058                -1.944691e-03 3 1  ON 57
ci_059                -2.050335e-03 3 1  ON 58
ci_060                -1.805906e-03 3 1  ON 59
ci_061                -2.548897e-03 3 1  ON 60
ci_062                -7.783174e-04 3 1  ON 61
ci_063                -7.610340e-04 3 1  ON 62
ci_064                -1.589027e-03 3 1  ON 63
ci_065                -9.708075e-04 3 1  ON 64
ci_066                -1.863067e-03 3 1  ON 65
ci_067                -1.677111e-03 3 1  ON 66
ci_068                -7.519586e-04 3 1  ON 67
ci_069                 1.434090e-03 3 1  ON 68
ci_070                 1.719136e-03 3 1  ON 69
ci_071                -1.335768e-03 3 1  ON 70
ci_072                -1.428904e-03 3 1  ON 71
ci_073                 6.460957e-04 3 1  ON 72
ci_074                 1.296000e-03 3 1  ON 73
ci_075                -9.227560e-04 3 1  ON 74
ci_076                -6.796691e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.3921
    reference variance = 2.09692
====================================================
  Execution time = 2.5212e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7771e+00
  Total weights = 1.9495e+06
  Execution time = 4.3314e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830610255320
                                         uncertainty =       0.040537352717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830610255320
                                         uncertainty =       0.040537352717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383768172
  error estimate for blocks of size 2^( 2) =       0.001454178588
  error estimate for blocks of size 2^( 3) =       0.001515473004
  error estimate for blocks of size 2^( 4) =       0.001558475598
  error estimate for blocks of size 2^( 5) =       0.001587077059
  error estimate for blocks of size 2^( 6) =       0.001599841531
  error estimate for blocks of size 2^( 7) =       0.001607780937

      target function =                  N/A
              le_mean =     -22.325237356900
             les_mean =     502.193671403355
             stat err =       0.001588293781
             autocorr =       1.317452593119
              std dev =       1.956975026736
             le_variance =       3.829751255267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830577119964
                                         uncertainty =       0.040538839883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830577119964
                                         uncertainty =       0.040538839883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383762030
  error estimate for blocks of size 2^( 2) =       0.001454165816
  error estimate for blocks of size 2^( 3) =       0.001515449742
  error estimate for blocks of size 2^( 4) =       0.001558440840
  error estimate for blocks of size 2^( 5) =       0.001587043693
  error estimate for blocks of size 2^( 6) =       0.001599808327
  error estimate for blocks of size 2^( 7) =       0.001607720646

      target function =                  N/A
              le_mean =     -22.325241780647
             les_mean =     502.196151540439
             stat err =       0.001588253377
             autocorr =       1.317397260042
              std dev =       1.956966340173
             le_variance =       3.829717256569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830583930508
                                         uncertainty =       0.040538267332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830583930508
                                         uncertainty =       0.040538267332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383763326
  error estimate for blocks of size 2^( 2) =       0.001454169517
  error estimate for blocks of size 2^( 3) =       0.001515457116
  error estimate for blocks of size 2^( 4) =       0.001558453169
  error estimate for blocks of size 2^( 5) =       0.001587054186
  error estimate for blocks of size 2^( 6) =       0.001599819017
  error estimate for blocks of size 2^( 7) =       0.001607742729

      target function =                  N/A
              le_mean =     -22.325237985416
             les_mean =     502.193435071373
             stat err =       0.001588267276
             autocorr =       1.317417848674
              std dev =       1.956968173626
             le_variance =       3.829724432584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830605628679
                                         uncertainty =       0.040537473929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830605628679
                                         uncertainty =       0.040537473929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383767324
  error estimate for blocks of size 2^( 2) =       0.001454177201
  error estimate for blocks of size 2^( 3) =       0.001515470693
  error estimate for blocks of size 2^( 4) =       0.001558472364
  error estimate for blocks of size 2^( 5) =       0.001587073841
  error estimate for blocks of size 2^( 6) =       0.001599837894
  error estimate for blocks of size 2^( 7) =       0.001607774893

      target function =                  N/A
              le_mean =     -22.325236977853
             les_mean =     502.193720995537
             stat err =       0.001588289748
             autocorr =       1.317447516076
              std dev =       1.956973828253
             le_variance =       3.829746564465


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325237356900        initial
     5.9605e-01     5.9605e+00             6.0990e-04       -22.325241780647  <--
     2.3842e+00     2.3842e+01             1.7039e-04       -22.325237985416
     9.5367e+00     9.5367e+01             4.4614e-05       -22.325236977853

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 4.7004e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_001                -6.977990e-01 3 1  ON 0
ci_002                -7.021415e-01 3 1  ON 1
ci_003                -6.338306e-02 3 1  ON 2
ci_004                -6.278269e-02 3 1  ON 3
ci_005                 4.567869e-02 3 1  ON 4
ci_006                 4.604702e-02 3 1  ON 5
ci_007                 3.186199e-02 3 1  ON 6
ci_008                 3.177912e-02 3 1  ON 7
ci_009                -2.530753e-02 3 1  ON 8
ci_010                -2.575270e-02 3 1  ON 9
ci_011                -2.289904e-02 3 1  ON 10
ci_012                -2.240823e-02 3 1  ON 11
ci_013                 1.975366e-02 3 1  ON 12
ci_014                 1.971489e-02 3 1  ON 13
ci_015                 1.972373e-02 3 1  ON 14
ci_016                 1.990131e-02 3 1  ON 15
ci_017                 1.553160e-02 3 1  ON 16
ci_018                 1.488889e-02 3 1  ON 17
ci_019                 1.036218e-02 3 1  ON 18
ci_020                 1.037256e-02 3 1  ON 19
ci_021                -1.027674e-02 3 1  ON 20
ci_022                -9.824674e-03 3 1  ON 21
ci_023                 8.082615e-03 3 1  ON 22
ci_024                 8.556286e-03 3 1  ON 23
ci_025                 7.916080e-03 3 1  ON 24
ci_026                 8.755735e-03 3 1  ON 25
ci_027                 7.696914e-03 3 1  ON 26
ci_028                 7.728346e-03 3 1  ON 27
ci_029                -7.334732e-03 3 1  ON 28
ci_030                -8.086952e-03 3 1  ON 29
ci_031                -9.002311e-03 3 1  ON 30
ci_032                -7.439355e-03 3 1  ON 31
ci_033                 6.969039e-03 3 1  ON 32
ci_034                 7.219608e-03 3 1  ON 33
ci_035                 6.332000e-03 3 1  ON 34
ci_036                 6.665006e-03 3 1  ON 35
ci_037                 6.539240e-03 3 1  ON 36
ci_038                 6.849400e-03 3 1  ON 37
ci_039                 5.517091e-03 3 1  ON 38
ci_040                 5.042589e-03 3 1  ON 39
ci_041                 5.263949e-03 3 1  ON 40
ci_042                 5.278724e-03 3 1  ON 41
ci_043                 5.272639e-03 3 1  ON 42
ci_044                 5.031934e-03 3 1  ON 43
ci_045                 5.688559e-03 3 1  ON 44
ci_046                 4.889900e-03 3 1  ON 45
ci_047                -4.244841e-03 3 1  ON 46
ci_048                -4.462723e-03 3 1  ON 47
ci_049                 4.495324e-03 3 1  ON 48
ci_050                 3.478228e-03 3 1  ON 49
ci_051                -2.798651e-03 3 1  ON 50
ci_052                -2.553809e-03 3 1  ON 51
ci_053                -2.713217e-03 3 1  ON 52
ci_054                -2.674053e-03 3 1  ON 53
ci_055                -1.522744e-03 3 1  ON 54
ci_056                -1.808422e-03 3 1  ON 55
ci_057                -2.430341e-03 3 1  ON 56
ci_058                -1.901674e-03 3 1  ON 57
ci_059                -2.146925e-03 3 1  ON 58
ci_060                -1.610685e-03 3 1  ON 59
ci_061                -2.581117e-03 3 1  ON 60
ci_062                -9.762655e-04 3 1  ON 61
ci_063                -7.592857e-04 3 1  ON 62
ci_064                -1.723045e-03 3 1  ON 63
ci_065                -1.026361e-03 3 1  ON 64
ci_066                -1.781723e-03 3 1  ON 65
ci_067                -1.367026e-03 3 1  ON 66
ci_068                -8.077979e-04 3 1  ON 67
ci_069                 1.445430e-03 3 1  ON 68
ci_070                 1.728202e-03 3 1  ON 69
ci_071                -1.296884e-03 3 1  ON 70
ci_072                -1.543371e-03 3 1  ON 71
ci_073                 6.174561e-04 3 1  ON 72
ci_074                 1.380292e-03 3 1  ON 73
ci_075                -8.756268e-04 3 1  ON 74
ci_076                -8.607810e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6362e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2256e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.5519
    reference variance = 2.35114
====================================================
  Execution time = 2.3460e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0333e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7044e+00
  Total weights = 1.949641413e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9140e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.756186680360
                                         uncertainty =       0.027426255741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.756186680360
                                         uncertainty =       0.027426255741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370411166
  error estimate for blocks of size 2^( 2) =       0.001441842525
  error estimate for blocks of size 2^( 3) =       0.001505946946
  error estimate for blocks of size 2^( 4) =       0.001548587751
  error estimate for blocks of size 2^( 5) =       0.001569863260
  error estimate for blocks of size 2^( 6) =       0.001587413954
  error estimate for blocks of size 2^( 7) =       0.001596705216

      target function =                  N/A
              le_mean =     -22.327612713387
             les_mean =     502.226734280292
             stat err =       0.001575642545
             autocorr =       1.321945713539
              std dev =       1.938085065488
             le_variance =       3.756173721069


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232761271339e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327612712592       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327646247666       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327649758701       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327650172586       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327649985303       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e-01 is 1.756932e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327612712592       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327626811194       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327627214404       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327627232488       residual = 5.25e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 5.393761e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327612712592       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327616961266       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327616969911       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 1.475313e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187612 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9385e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_001                -6.977938e-01 3 1  ON 0
ci_002                -7.022312e-01 3 1  ON 1
ci_003                -6.325401e-02 3 1  ON 2
ci_004                -6.224332e-02 3 1  ON 3
ci_005                 4.557839e-02 3 1  ON 4
ci_006                 4.577151e-02 3 1  ON 5
ci_007                 3.175054e-02 3 1  ON 6
ci_008                 3.176438e-02 3 1  ON 7
ci_009                -2.506776e-02 3 1  ON 8
ci_010                -2.551200e-02 3 1  ON 9
ci_011                -2.318731e-02 3 1  ON 10
ci_012                -2.252525e-02 3 1  ON 11
ci_013                 1.976653e-02 3 1  ON 12
ci_014                 1.977286e-02 3 1  ON 13
ci_015                 1.979050e-02 3 1  ON 14
ci_016                 2.034565e-02 3 1  ON 15
ci_017                 1.540580e-02 3 1  ON 16
ci_018                 1.496190e-02 3 1  ON 17
ci_019                 1.020234e-02 3 1  ON 18
ci_020                 1.015593e-02 3 1  ON 19
ci_021                -1.049549e-02 3 1  ON 20
ci_022                -1.020204e-02 3 1  ON 21
ci_023                 8.293692e-03 3 1  ON 22
ci_024                 8.741934e-03 3 1  ON 23
ci_025                 7.922289e-03 3 1  ON 24
ci_026                 8.719660e-03 3 1  ON 25
ci_027                 7.786581e-03 3 1  ON 26
ci_028                 7.531921e-03 3 1  ON 27
ci_029                -7.725412e-03 3 1  ON 28
ci_030                -8.029488e-03 3 1  ON 29
ci_031                -8.633684e-03 3 1  ON 30
ci_032                -7.406066e-03 3 1  ON 31
ci_033                 6.591490e-03 3 1  ON 32
ci_034                 7.013783e-03 3 1  ON 33
ci_035                 6.254361e-03 3 1  ON 34
ci_036                 6.543451e-03 3 1  ON 35
ci_037                 6.685959e-03 3 1  ON 36
ci_038                 6.792566e-03 3 1  ON 37
ci_039                 5.841031e-03 3 1  ON 38
ci_040                 5.010580e-03 3 1  ON 39
ci_041                 5.257450e-03 3 1  ON 40
ci_042                 5.226072e-03 3 1  ON 41
ci_043                 5.491048e-03 3 1  ON 42
ci_044                 5.320249e-03 3 1  ON 43
ci_045                 5.595432e-03 3 1  ON 44
ci_046                 4.991233e-03 3 1  ON 45
ci_047                -4.040910e-03 3 1  ON 46
ci_048                -4.378380e-03 3 1  ON 47
ci_049                 4.197001e-03 3 1  ON 48
ci_050                 3.256776e-03 3 1  ON 49
ci_051                -2.644366e-03 3 1  ON 50
ci_052                -2.684038e-03 3 1  ON 51
ci_053                -2.514260e-03 3 1  ON 52
ci_054                -2.543516e-03 3 1  ON 53
ci_055                -1.502560e-03 3 1  ON 54
ci_056                -1.925682e-03 3 1  ON 55
ci_057                -2.357629e-03 3 1  ON 56
ci_058                -1.697609e-03 3 1  ON 57
ci_059                -2.021643e-03 3 1  ON 58
ci_060                -1.693849e-03 3 1  ON 59
ci_061                -2.438147e-03 3 1  ON 60
ci_062                -1.210063e-03 3 1  ON 61
ci_063                -7.258491e-04 3 1  ON 62
ci_064                -1.225594e-03 3 1  ON 63
ci_065                -1.024342e-03 3 1  ON 64
ci_066                -1.623867e-03 3 1  ON 65
ci_067                -1.234507e-03 3 1  ON 66
ci_068                -8.929282e-04 3 1  ON 67
ci_069                 1.584813e-03 3 1  ON 68
ci_070                 1.650343e-03 3 1  ON 69
ci_071                -1.575722e-03 3 1  ON 70
ci_072                -1.586958e-03 3 1  ON 71
ci_073                 8.487044e-04 3 1  ON 72
ci_074                 1.190472e-03 3 1  ON 73
ci_075                -9.806483e-04 3 1  ON 74
ci_076                -9.338244e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.2579
    reference variance = 2.94069
====================================================
  Execution time = 2.2965e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6761e+00
  Total weights = 1.9501e+06
  Execution time = 4.3352e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727624435687
                                         uncertainty =       0.031001781077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727624435687
                                         uncertainty =       0.031001781077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364987353
  error estimate for blocks of size 2^( 2) =       0.001435108240
  error estimate for blocks of size 2^( 3) =       0.001498028754
  error estimate for blocks of size 2^( 4) =       0.001542428846
  error estimate for blocks of size 2^( 5) =       0.001568345828
  error estimate for blocks of size 2^( 6) =       0.001581959148
  error estimate for blocks of size 2^( 7) =       0.001598292212

      target function =                  N/A
              le_mean =     -22.329922165445
             les_mean =     502.303800965450
             stat err =       0.001572756509
             autocorr =       1.327595363169
              std dev =       1.930414513565
             le_variance =       3.726500194183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727464567390
                                         uncertainty =       0.030999907196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727464567390
                                         uncertainty =       0.030999907196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364957867
  error estimate for blocks of size 2^( 2) =       0.001435106188
  error estimate for blocks of size 2^( 3) =       0.001498049398
  error estimate for blocks of size 2^( 4) =       0.001542457930
  error estimate for blocks of size 2^( 5) =       0.001568398785
  error estimate for blocks of size 2^( 6) =       0.001582024829
  error estimate for blocks of size 2^( 7) =       0.001598374666

      target function =                  N/A
              le_mean =     -22.329934639393
             les_mean =     502.324637293487
             stat err =       0.001572814052
             autocorr =       1.327749876981
              std dev =       1.930372812298
             le_variance =       3.726339194461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727530223912
                                         uncertainty =       0.030995794856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727530223912
                                         uncertainty =       0.030995794856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364969914
  error estimate for blocks of size 2^( 2) =       0.001435113501
  error estimate for blocks of size 2^( 3) =       0.001498055570
  error estimate for blocks of size 2^( 4) =       0.001542484678
  error estimate for blocks of size 2^( 5) =       0.001568421237
  error estimate for blocks of size 2^( 6) =       0.001582057194
  error estimate for blocks of size 2^( 7) =       0.001598385402

      target function =                  N/A
              le_mean =     -22.329921478443
             les_mean =     502.388470026845
             stat err =       0.001572837128
             autocorr =       1.327765399122
              std dev =       1.930389849810
             le_variance =       3.726404972251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727587491757
                                         uncertainty =       0.031001315459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.727587491757
                                         uncertainty =       0.031001315459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364980559
  error estimate for blocks of size 2^( 2) =       0.001435105071
  error estimate for blocks of size 2^( 3) =       0.001498028662
  error estimate for blocks of size 2^( 4) =       0.001542430965
  error estimate for blocks of size 2^( 5) =       0.001568354222
  error estimate for blocks of size 2^( 6) =       0.001581970374
  error estimate for blocks of size 2^( 7) =       0.001598306131

      target function =                  N/A
              le_mean =     -22.329920555989
             les_mean =     502.301713561886
             stat err =       0.001572765423
             autocorr =       1.327623629891
              std dev =       1.930404904497
             le_variance =       3.726463095306


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329922165445        initial
     1.4901e-01     1.4901e+00             1.7569e-03       -22.329934639393  <--
     5.9605e-01     5.9605e+00             5.3938e-04       -22.329921478443
     2.3842e+00     2.3842e+01             1.4753e-04       -22.329920555989

*****************************************************************************
Applying the update for shift_i =   1.4901e-01     and shift_s =   1.4901e+00
*****************************************************************************

  Execution time = 4.4744e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_001                -6.977631e-01 3 1  ON 0
ci_002                -7.024135e-01 3 1  ON 1
ci_003                -6.295151e-02 3 1  ON 2
ci_004                -6.102576e-02 3 1  ON 3
ci_005                 4.545126e-02 3 1  ON 4
ci_006                 4.546153e-02 3 1  ON 5
ci_007                 3.161455e-02 3 1  ON 6
ci_008                 3.180221e-02 3 1  ON 7
ci_009                -2.474842e-02 3 1  ON 8
ci_010                -2.514993e-02 3 1  ON 9
ci_011                -2.367045e-02 3 1  ON 10
ci_012                -2.275949e-02 3 1  ON 11
ci_013                 1.978445e-02 3 1  ON 12
ci_014                 1.993815e-02 3 1  ON 13
ci_015                 1.988610e-02 3 1  ON 14
ci_016                 2.113075e-02 3 1  ON 15
ci_017                 1.515668e-02 3 1  ON 16
ci_018                 1.509321e-02 3 1  ON 17
ci_019                 9.950316e-03 3 1  ON 18
ci_020                 9.836311e-03 3 1  ON 19
ci_021                -1.086726e-02 3 1  ON 20
ci_022                -1.079467e-02 3 1  ON 21
ci_023                 8.543475e-03 3 1  ON 22
ci_024                 8.988822e-03 3 1  ON 23
ci_025                 7.948235e-03 3 1  ON 24
ci_026                 8.675753e-03 3 1  ON 25
ci_027                 7.858767e-03 3 1  ON 26
ci_028                 7.325447e-03 3 1  ON 27
ci_029                -8.268142e-03 3 1  ON 28
ci_030                -7.941632e-03 3 1  ON 29
ci_031                -8.019664e-03 3 1  ON 30
ci_032                -7.273186e-03 3 1  ON 31
ci_033                 6.014261e-03 3 1  ON 32
ci_034                 6.691038e-03 3 1  ON 33
ci_035                 6.186186e-03 3 1  ON 34
ci_036                 6.378679e-03 3 1  ON 35
ci_037                 6.896167e-03 3 1  ON 36
ci_038                 6.719280e-03 3 1  ON 37
ci_039                 6.170451e-03 3 1  ON 38
ci_040                 4.990655e-03 3 1  ON 39
ci_041                 5.233675e-03 3 1  ON 40
ci_042                 5.170770e-03 3 1  ON 41
ci_043                 5.875329e-03 3 1  ON 42
ci_044                 5.719354e-03 3 1  ON 43
ci_045                 5.510152e-03 3 1  ON 44
ci_046                 5.170016e-03 3 1  ON 45
ci_047                -3.828928e-03 3 1  ON 46
ci_048                -4.290556e-03 3 1  ON 47
ci_049                 3.774479e-03 3 1  ON 48
ci_050                 2.935892e-03 3 1  ON 49
ci_051                -2.367844e-03 3 1  ON 50
ci_052                -2.860336e-03 3 1  ON 51
ci_053                -2.228975e-03 3 1  ON 52
ci_054                -2.324706e-03 3 1  ON 53
ci_055                -1.450872e-03 3 1  ON 54
ci_056                -2.081068e-03 3 1  ON 55
ci_057                -2.263043e-03 3 1  ON 56
ci_058                -1.433591e-03 3 1  ON 57
ci_059                -1.907363e-03 3 1  ON 58
ci_060                -1.774016e-03 3 1  ON 59
ci_061                -2.252151e-03 3 1  ON 60
ci_062                -1.513046e-03 3 1  ON 61
ci_063                -6.801520e-04 3 1  ON 62
ci_064                -5.003746e-04 3 1  ON 63
ci_065                -9.606069e-04 3 1  ON 64
ci_066                -1.382450e-03 3 1  ON 65
ci_067                -1.040069e-03 3 1  ON 66
ci_068                -1.002359e-03 3 1  ON 67
ci_069                 1.785081e-03 3 1  ON 68
ci_070                 1.534288e-03 3 1  ON 69
ci_071                -1.964718e-03 3 1  ON 70
ci_072                -1.608022e-03 3 1  ON 71
ci_073                 1.066601e-03 3 1  ON 72
ci_074                 1.020939e-03 3 1  ON 73
ci_075                -1.120166e-03 3 1  ON 74
ci_076                -1.054703e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4145e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2262e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.377
    reference variance = 3.30219
====================================================
  Execution time = 2.3498e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0292e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.9137e+00
  Total weights = 1.950144948e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9772e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.964612912276
                                         uncertainty =       0.130886266093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.964612912276
                                         uncertainty =       0.130886266093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001408017237
  error estimate for blocks of size 2^( 2) =       0.001479119274
  error estimate for blocks of size 2^( 3) =       0.001540226106
  error estimate for blocks of size 2^( 4) =       0.001585068512
  error estimate for blocks of size 2^( 5) =       0.001611042534
  error estimate for blocks of size 2^( 6) =       0.001623925273
  error estimate for blocks of size 2^( 7) =       0.001631673268

      target function =                  N/A
              le_mean =     -22.327376396658
             les_mean =     502.425415697297
             stat err =       0.001612927397
             autocorr =       1.312241277376
              std dev =       1.991268932060
             le_variance =       3.965151959786


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232737639666e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-02, overlap shift 3.7253e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327376395853       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327484421024       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327497623248       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327497197724       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327498279227       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327497771293       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327498344046       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.327498463707       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-02 is 2.633786e-03

solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327376395853       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327450071552       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327454643318       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327454213297       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327454313356       residual = 9.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e-01 is 1.128533e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327376395853       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327408824522       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327409522417       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327409468135       residual = 3.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 5.223942e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192162 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9487e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_001                -6.971293e-01 3 1  ON 0
ci_002                -7.029114e-01 3 1  ON 1
ci_003                -6.300039e-02 3 1  ON 2
ci_004                -6.159369e-02 3 1  ON 3
ci_005                 4.549382e-02 3 1  ON 4
ci_006                 4.563354e-02 3 1  ON 5
ci_007                 3.146891e-02 3 1  ON 6
ci_008                 3.084916e-02 3 1  ON 7
ci_009                -2.532413e-02 3 1  ON 8
ci_010                -2.599357e-02 3 1  ON 9
ci_011                -2.305318e-02 3 1  ON 10
ci_012                -2.334872e-02 3 1  ON 11
ci_013                 1.955901e-02 3 1  ON 12
ci_014                 2.069031e-02 3 1  ON 13
ci_015                 2.044983e-02 3 1  ON 14
ci_016                 2.134810e-02 3 1  ON 15
ci_017                 1.546402e-02 3 1  ON 16
ci_018                 1.559082e-02 3 1  ON 17
ci_019                 9.044001e-03 3 1  ON 18
ci_020                 9.505609e-03 3 1  ON 19
ci_021                -9.977933e-03 3 1  ON 20
ci_022                -1.041823e-02 3 1  ON 21
ci_023                 9.410729e-03 3 1  ON 22
ci_024                 9.045660e-03 3 1  ON 23
ci_025                 9.019252e-03 3 1  ON 24
ci_026                 8.608967e-03 3 1  ON 25
ci_027                 8.172681e-03 3 1  ON 26
ci_028                 8.061315e-03 3 1  ON 27
ci_029                -8.100087e-03 3 1  ON 28
ci_030                -6.813099e-03 3 1  ON 29
ci_031                -8.318452e-03 3 1  ON 30
ci_032                -8.399893e-03 3 1  ON 31
ci_033                 5.185310e-03 3 1  ON 32
ci_034                 7.130873e-03 3 1  ON 33
ci_035                 6.438961e-03 3 1  ON 34
ci_036                 6.997756e-03 3 1  ON 35
ci_037                 6.662430e-03 3 1  ON 36
ci_038                 6.516204e-03 3 1  ON 37
ci_039                 6.750960e-03 3 1  ON 38
ci_040                 5.858681e-03 3 1  ON 39
ci_041                 4.816163e-03 3 1  ON 40
ci_042                 5.232285e-03 3 1  ON 41
ci_043                 5.752506e-03 3 1  ON 42
ci_044                 5.043725e-03 3 1  ON 43
ci_045                 5.301082e-03 3 1  ON 44
ci_046                 5.792834e-03 3 1  ON 45
ci_047                -4.612526e-03 3 1  ON 46
ci_048                -4.374727e-03 3 1  ON 47
ci_049                 3.156872e-03 3 1  ON 48
ci_050                 2.781465e-03 3 1  ON 49
ci_051                -2.405382e-03 3 1  ON 50
ci_052                -3.229095e-03 3 1  ON 51
ci_053                -3.302620e-03 3 1  ON 52
ci_054                -3.096429e-03 3 1  ON 53
ci_055                -2.301502e-03 3 1  ON 54
ci_056                -1.856111e-03 3 1  ON 55
ci_057                -3.026498e-03 3 1  ON 56
ci_058                -1.139392e-03 3 1  ON 57
ci_059                -1.549749e-03 3 1  ON 58
ci_060                -1.865131e-03 3 1  ON 59
ci_061                -2.504690e-03 3 1  ON 60
ci_062                -6.391189e-04 3 1  ON 61
ci_063                -7.682560e-04 3 1  ON 62
ci_064                -8.782403e-04 3 1  ON 63
ci_065                -2.058915e-03 3 1  ON 64
ci_066                -1.326507e-03 3 1  ON 65
ci_067                -3.544025e-04 3 1  ON 66
ci_068                -1.589790e-03 3 1  ON 67
ci_069                 1.863878e-03 3 1  ON 68
ci_070                 1.596397e-03 3 1  ON 69
ci_071                -8.657683e-04 3 1  ON 70
ci_072                -7.243733e-04 3 1  ON 71
ci_073                 2.115234e-03 3 1  ON 72
ci_074                 1.282809e-03 3 1  ON 73
ci_075                -6.408806e-04 3 1  ON 74
ci_076                -9.812917e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.6012
    reference variance = 1.81286
====================================================
  Execution time = 2.2946e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7905e+00
  Total weights = 1.9500e+06
  Execution time = 4.3549e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844740474684
                                         uncertainty =       0.095709961799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844740474684
                                         uncertainty =       0.095709961799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386398123
  error estimate for blocks of size 2^( 2) =       0.001456807389
  error estimate for blocks of size 2^( 3) =       0.001518797514
  error estimate for blocks of size 2^( 4) =       0.001563618286
  error estimate for blocks of size 2^( 5) =       0.001585286370
  error estimate for blocks of size 2^( 6) =       0.001598678611
  error estimate for blocks of size 2^( 7) =       0.001601435508

      target function =                  N/A
              le_mean =     -22.326971412293
             les_mean =     502.389033647886
             stat err =       0.001587254694
             autocorr =       1.310742303583
              std dev =       1.960694399112
             le_variance =       3.844322526710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.845071920663
                                         uncertainty =       0.095711000740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.845071920663
                                         uncertainty =       0.095711000740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386458180
  error estimate for blocks of size 2^( 2) =       0.001456832998
  error estimate for blocks of size 2^( 3) =       0.001518793448
  error estimate for blocks of size 2^( 4) =       0.001563574441
  error estimate for blocks of size 2^( 5) =       0.001585310620
  error estimate for blocks of size 2^( 6) =       0.001598702306
  error estimate for blocks of size 2^( 7) =       0.001601521483

      target function =                  N/A
              le_mean =     -22.326931919496
             les_mean =     502.496890860960
             stat err =       0.001587277213
             autocorr =       1.310665941928
              std dev =       1.960779332936
             le_variance =       3.844655592470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.845236311016
                                         uncertainty =       0.095713529260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.845236311016
                                         uncertainty =       0.095713529260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386487923
  error estimate for blocks of size 2^( 2) =       0.001456849459
  error estimate for blocks of size 2^( 3) =       0.001518802765
  error estimate for blocks of size 2^( 4) =       0.001563577254
  error estimate for blocks of size 2^( 5) =       0.001585240064
  error estimate for blocks of size 2^( 6) =       0.001598605981
  error estimate for blocks of size 2^( 7) =       0.001601467698

      target function =                  N/A
              le_mean =     -22.326963556761
             les_mean =     502.291768758321
             stat err =       0.001587222749
             autocorr =       1.310519769935
              std dev =       1.960821397074
             le_variance =       3.844820551222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844692804201
                                         uncertainty =       0.095711437971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844692804201
                                         uncertainty =       0.095711437971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386389567
  error estimate for blocks of size 2^( 2) =       0.001456788315
  error estimate for blocks of size 2^( 3) =       0.001518768921
  error estimate for blocks of size 2^( 4) =       0.001563584406
  error estimate for blocks of size 2^( 5) =       0.001585259434
  error estimate for blocks of size 2^( 6) =       0.001598684851
  error estimate for blocks of size 2^( 7) =       0.001601473570

      target function =                  N/A
              le_mean =     -22.326946343305
             les_mean =     502.297878929788
             stat err =       0.001587250565
             autocorr =       1.310751663559
              std dev =       1.960682298998
             le_variance =       3.844275077604


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326971412293        initial  <--
     3.7253e-02     3.7253e-01             2.6338e-03       -22.326931919496
     1.4901e-01     1.4901e+00             1.1285e-03       -22.326963556761
     5.9605e-01     5.9605e+00             5.2239e-04       -22.326946343305

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7981
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_001                -6.977631e-01 3 1  ON 0
ci_002                -7.024135e-01 3 1  ON 1
ci_003                -6.295151e-02 3 1  ON 2
ci_004                -6.102576e-02 3 1  ON 3
ci_005                 4.545126e-02 3 1  ON 4
ci_006                 4.546153e-02 3 1  ON 5
ci_007                 3.161455e-02 3 1  ON 6
ci_008                 3.180221e-02 3 1  ON 7
ci_009                -2.474842e-02 3 1  ON 8
ci_010                -2.514993e-02 3 1  ON 9
ci_011                -2.367045e-02 3 1  ON 10
ci_012                -2.275949e-02 3 1  ON 11
ci_013                 1.978445e-02 3 1  ON 12
ci_014                 1.993815e-02 3 1  ON 13
ci_015                 1.988610e-02 3 1  ON 14
ci_016                 2.113075e-02 3 1  ON 15
ci_017                 1.515668e-02 3 1  ON 16
ci_018                 1.509321e-02 3 1  ON 17
ci_019                 9.950316e-03 3 1  ON 18
ci_020                 9.836311e-03 3 1  ON 19
ci_021                -1.086726e-02 3 1  ON 20
ci_022                -1.079467e-02 3 1  ON 21
ci_023                 8.543475e-03 3 1  ON 22
ci_024                 8.988822e-03 3 1  ON 23
ci_025                 7.948235e-03 3 1  ON 24
ci_026                 8.675753e-03 3 1  ON 25
ci_027                 7.858767e-03 3 1  ON 26
ci_028                 7.325447e-03 3 1  ON 27
ci_029                -8.268142e-03 3 1  ON 28
ci_030                -7.941632e-03 3 1  ON 29
ci_031                -8.019664e-03 3 1  ON 30
ci_032                -7.273186e-03 3 1  ON 31
ci_033                 6.014261e-03 3 1  ON 32
ci_034                 6.691038e-03 3 1  ON 33
ci_035                 6.186186e-03 3 1  ON 34
ci_036                 6.378679e-03 3 1  ON 35
ci_037                 6.896167e-03 3 1  ON 36
ci_038                 6.719280e-03 3 1  ON 37
ci_039                 6.170451e-03 3 1  ON 38
ci_040                 4.990655e-03 3 1  ON 39
ci_041                 5.233675e-03 3 1  ON 40
ci_042                 5.170770e-03 3 1  ON 41
ci_043                 5.875329e-03 3 1  ON 42
ci_044                 5.719354e-03 3 1  ON 43
ci_045                 5.510152e-03 3 1  ON 44
ci_046                 5.170016e-03 3 1  ON 45
ci_047                -3.828928e-03 3 1  ON 46
ci_048                -4.290556e-03 3 1  ON 47
ci_049                 3.774479e-03 3 1  ON 48
ci_050                 2.935892e-03 3 1  ON 49
ci_051                -2.367844e-03 3 1  ON 50
ci_052                -2.860336e-03 3 1  ON 51
ci_053                -2.228975e-03 3 1  ON 52
ci_054                -2.324706e-03 3 1  ON 53
ci_055                -1.450872e-03 3 1  ON 54
ci_056                -2.081068e-03 3 1  ON 55
ci_057                -2.263043e-03 3 1  ON 56
ci_058                -1.433591e-03 3 1  ON 57
ci_059                -1.907363e-03 3 1  ON 58
ci_060                -1.774016e-03 3 1  ON 59
ci_061                -2.252151e-03 3 1  ON 60
ci_062                -1.513046e-03 3 1  ON 61
ci_063                -6.801520e-04 3 1  ON 62
ci_064                -5.003746e-04 3 1  ON 63
ci_065                -9.606069e-04 3 1  ON 64
ci_066                -1.382450e-03 3 1  ON 65
ci_067                -1.040069e-03 3 1  ON 66
ci_068                -1.002359e-03 3 1  ON 67
ci_069                 1.785081e-03 3 1  ON 68
ci_070                 1.534288e-03 3 1  ON 69
ci_071                -1.964718e-03 3 1  ON 70
ci_072                -1.608022e-03 3 1  ON 71
ci_073                 1.066601e-03 3 1  ON 72
ci_074                 1.020939e-03 3 1  ON 73
ci_075                -1.120166e-03 3 1  ON 74
ci_076                -1.054703e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4300e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2270e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.475
    reference variance = 2.28203
====================================================
  Execution time = 2.3474e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0330e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.8379e+00
  Total weights = 1.950048920e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8523e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893238073462
                                         uncertainty =       0.060469519849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893238073462
                                         uncertainty =       0.060469519849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001394998104
  error estimate for blocks of size 2^( 2) =       0.001464402041
  error estimate for blocks of size 2^( 3) =       0.001527969023
  error estimate for blocks of size 2^( 4) =       0.001567840017
  error estimate for blocks of size 2^( 5) =       0.001589030840
  error estimate for blocks of size 2^( 6) =       0.001596243719
  error estimate for blocks of size 2^( 7) =       0.001600587268

      target function =                  N/A
              le_mean =     -22.327377971454
             les_mean =     502.349740411780
             stat err =       0.001588425461
             autocorr =       1.296541567017
              std dev =       1.972856803343
             le_variance =       3.892163966496


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232737797145e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327377970631       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327411968756       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327413280500       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327413270008       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-01 is 7.285387e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327377970631       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327389375296       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327389653389       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+00 is 2.310799e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327377970631       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327381088189       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327381155811       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+00 is 6.505836e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195284 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9337e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_001                -6.977989e-01 3 1  ON 0
ci_002                -7.023475e-01 3 1  ON 1
ci_003                -6.295647e-02 3 1  ON 2
ci_004                -6.111143e-02 3 1  ON 3
ci_005                 4.544796e-02 3 1  ON 4
ci_006                 4.554129e-02 3 1  ON 5
ci_007                 3.166928e-02 3 1  ON 6
ci_008                 3.182224e-02 3 1  ON 7
ci_009                -2.489074e-02 3 1  ON 8
ci_010                -2.524897e-02 3 1  ON 9
ci_011                -2.355838e-02 3 1  ON 10
ci_012                -2.273174e-02 3 1  ON 11
ci_013                 1.986786e-02 3 1  ON 12
ci_014                 2.005325e-02 3 1  ON 13
ci_015                 2.003225e-02 3 1  ON 14
ci_016                 2.111989e-02 3 1  ON 15
ci_017                 1.515586e-02 3 1  ON 16
ci_018                 1.519092e-02 3 1  ON 17
ci_019                 9.880936e-03 3 1  ON 18
ci_020                 9.771390e-03 3 1  ON 19
ci_021                -1.072451e-02 3 1  ON 20
ci_022                -1.077813e-02 3 1  ON 21
ci_023                 8.652869e-03 3 1  ON 22
ci_024                 8.974256e-03 3 1  ON 23
ci_025                 7.964549e-03 3 1  ON 24
ci_026                 8.680968e-03 3 1  ON 25
ci_027                 7.905120e-03 3 1  ON 26
ci_028                 7.483337e-03 3 1  ON 27
ci_029                -8.078329e-03 3 1  ON 28
ci_030                -7.975920e-03 3 1  ON 29
ci_031                -8.031199e-03 3 1  ON 30
ci_032                -7.360064e-03 3 1  ON 31
ci_033                 6.101712e-03 3 1  ON 32
ci_034                 6.696701e-03 3 1  ON 33
ci_035                 6.236976e-03 3 1  ON 34
ci_036                 6.325232e-03 3 1  ON 35
ci_037                 6.828033e-03 3 1  ON 36
ci_038                 6.752003e-03 3 1  ON 37
ci_039                 5.974284e-03 3 1  ON 38
ci_040                 5.095945e-03 3 1  ON 39
ci_041                 5.153211e-03 3 1  ON 40
ci_042                 5.204728e-03 3 1  ON 41
ci_043                 5.779587e-03 3 1  ON 42
ci_044                 5.772296e-03 3 1  ON 43
ci_045                 5.398981e-03 3 1  ON 44
ci_046                 4.990521e-03 3 1  ON 45
ci_047                -4.058617e-03 3 1  ON 46
ci_048                -4.395033e-03 3 1  ON 47
ci_049                 3.867479e-03 3 1  ON 48
ci_050                 3.069039e-03 3 1  ON 49
ci_051                -2.307924e-03 3 1  ON 50
ci_052                -2.867351e-03 3 1  ON 51
ci_053                -2.195486e-03 3 1  ON 52
ci_054                -2.463802e-03 3 1  ON 53
ci_055                -1.486481e-03 3 1  ON 54
ci_056                -2.073850e-03 3 1  ON 55
ci_057                -2.202042e-03 3 1  ON 56
ci_058                -1.559193e-03 3 1  ON 57
ci_059                -1.826497e-03 3 1  ON 58
ci_060                -1.812899e-03 3 1  ON 59
ci_061                -2.192512e-03 3 1  ON 60
ci_062                -1.711613e-03 3 1  ON 61
ci_063                -4.881800e-04 3 1  ON 62
ci_064                -6.358428e-04 3 1  ON 63
ci_065                -1.191687e-03 3 1  ON 64
ci_066                -1.519149e-03 3 1  ON 65
ci_067                -9.856117e-04 3 1  ON 66
ci_068                -1.106503e-03 3 1  ON 67
ci_069                 1.821251e-03 3 1  ON 68
ci_070                 1.705365e-03 3 1  ON 69
ci_071                -1.934822e-03 3 1  ON 70
ci_072                -1.651922e-03 3 1  ON 71
ci_073                 9.803261e-04 3 1  ON 72
ci_074                 9.924958e-04 3 1  ON 73
ci_075                -1.121217e-03 3 1  ON 74
ci_076                -9.105088e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -21.9615
    reference variance = 6.3919
====================================================
  Execution time = 2.2945e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7463e+00
  Total weights = 1.9501e+06
  Execution time = 4.3478e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.291783
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796507679303
                                         uncertainty =       0.042639029940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796507679303
                                         uncertainty =       0.042639029940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377897136
  error estimate for blocks of size 2^( 2) =       0.001448219170
  error estimate for blocks of size 2^( 3) =       0.001510470010
  error estimate for blocks of size 2^( 4) =       0.001553644377
  error estimate for blocks of size 2^( 5) =       0.001582701330
  error estimate for blocks of size 2^( 6) =       0.001594921385
  error estimate for blocks of size 2^( 7) =       0.001607863707

      target function =                  N/A
              le_mean =     -22.326942345859
             les_mean =     502.248718375464
             stat err =       0.001584782700
             autocorr =       1.322835521232
              std dev =       1.948671995237
             le_variance =       3.797322545019

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0178922
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796608969439
                                         uncertainty =       0.042640481693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796608969439
                                         uncertainty =       0.042640481693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377915576
  error estimate for blocks of size 2^( 2) =       0.001448226373
  error estimate for blocks of size 2^( 3) =       0.001510466149
  error estimate for blocks of size 2^( 4) =       0.001553618429
  error estimate for blocks of size 2^( 5) =       0.001582658615
  error estimate for blocks of size 2^( 6) =       0.001594895976
  error estimate for blocks of size 2^( 7) =       0.001607831635

      target function =                  N/A
              le_mean =     -22.326941300247
             les_mean =     502.251505601108
             stat err =       0.001584751164
             autocorr =       1.322747470340
              std dev =       1.948698074443
             le_variance =       3.797424185339

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.277828
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796561871165
                                         uncertainty =       0.042640184380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796561871165
                                         uncertainty =       0.042640184380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377907015
  error estimate for blocks of size 2^( 2) =       0.001448222218
  error estimate for blocks of size 2^( 3) =       0.001510465765
  error estimate for blocks of size 2^( 4) =       0.001553625189
  error estimate for blocks of size 2^( 5) =       0.001582672466
  error estimate for blocks of size 2^( 6) =       0.001594904160
  error estimate for blocks of size 2^( 7) =       0.001607846268

      target function =                  N/A
              le_mean =     -22.326939988357
             les_mean =     502.238590465259
             stat err =       0.001584762021
             autocorr =       1.322782032840
              std dev =       1.948685965867
             le_variance =       3.797376993567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796510973969
                                         uncertainty =       0.042639232649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796510973969
                                         uncertainty =       0.042639232649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377897740
  error estimate for blocks of size 2^( 2) =       0.001448218928
  error estimate for blocks of size 2^( 3) =       0.001510467860
  error estimate for blocks of size 2^( 4) =       0.001553638529
  error estimate for blocks of size 2^( 5) =       0.001582694179
  error estimate for blocks of size 2^( 6) =       0.001594918940
  error estimate for blocks of size 2^( 7) =       0.001607863220

      target function =                  N/A
              le_mean =     -22.326940573462
             les_mean =     502.239895241537
             stat err =       0.001584778717
             autocorr =       1.322827712425
              std dev =       1.948672849989
             le_variance =       3.797325876283


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326942345859        initial  <--
     3.7253e-01     3.7253e+00             7.2854e-04       -22.326941300247
     1.4901e+00     1.4901e+01             2.3108e-04       -22.326939988357
     5.9605e+00     5.9605e+01             6.5058e-05       -22.326940573462

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7942
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_001                -6.977631e-01 3 1  ON 0
ci_002                -7.024135e-01 3 1  ON 1
ci_003                -6.295151e-02 3 1  ON 2
ci_004                -6.102576e-02 3 1  ON 3
ci_005                 4.545126e-02 3 1  ON 4
ci_006                 4.546153e-02 3 1  ON 5
ci_007                 3.161455e-02 3 1  ON 6
ci_008                 3.180221e-02 3 1  ON 7
ci_009                -2.474842e-02 3 1  ON 8
ci_010                -2.514993e-02 3 1  ON 9
ci_011                -2.367045e-02 3 1  ON 10
ci_012                -2.275949e-02 3 1  ON 11
ci_013                 1.978445e-02 3 1  ON 12
ci_014                 1.993815e-02 3 1  ON 13
ci_015                 1.988610e-02 3 1  ON 14
ci_016                 2.113075e-02 3 1  ON 15
ci_017                 1.515668e-02 3 1  ON 16
ci_018                 1.509321e-02 3 1  ON 17
ci_019                 9.950316e-03 3 1  ON 18
ci_020                 9.836311e-03 3 1  ON 19
ci_021                -1.086726e-02 3 1  ON 20
ci_022                -1.079467e-02 3 1  ON 21
ci_023                 8.543475e-03 3 1  ON 22
ci_024                 8.988822e-03 3 1  ON 23
ci_025                 7.948235e-03 3 1  ON 24
ci_026                 8.675753e-03 3 1  ON 25
ci_027                 7.858767e-03 3 1  ON 26
ci_028                 7.325447e-03 3 1  ON 27
ci_029                -8.268142e-03 3 1  ON 28
ci_030                -7.941632e-03 3 1  ON 29
ci_031                -8.019664e-03 3 1  ON 30
ci_032                -7.273186e-03 3 1  ON 31
ci_033                 6.014261e-03 3 1  ON 32
ci_034                 6.691038e-03 3 1  ON 33
ci_035                 6.186186e-03 3 1  ON 34
ci_036                 6.378679e-03 3 1  ON 35
ci_037                 6.896167e-03 3 1  ON 36
ci_038                 6.719280e-03 3 1  ON 37
ci_039                 6.170451e-03 3 1  ON 38
ci_040                 4.990655e-03 3 1  ON 39
ci_041                 5.233675e-03 3 1  ON 40
ci_042                 5.170770e-03 3 1  ON 41
ci_043                 5.875329e-03 3 1  ON 42
ci_044                 5.719354e-03 3 1  ON 43
ci_045                 5.510152e-03 3 1  ON 44
ci_046                 5.170016e-03 3 1  ON 45
ci_047                -3.828928e-03 3 1  ON 46
ci_048                -4.290556e-03 3 1  ON 47
ci_049                 3.774479e-03 3 1  ON 48
ci_050                 2.935892e-03 3 1  ON 49
ci_051                -2.367844e-03 3 1  ON 50
ci_052                -2.860336e-03 3 1  ON 51
ci_053                -2.228975e-03 3 1  ON 52
ci_054                -2.324706e-03 3 1  ON 53
ci_055                -1.450872e-03 3 1  ON 54
ci_056                -2.081068e-03 3 1  ON 55
ci_057                -2.263043e-03 3 1  ON 56
ci_058                -1.433591e-03 3 1  ON 57
ci_059                -1.907363e-03 3 1  ON 58
ci_060                -1.774016e-03 3 1  ON 59
ci_061                -2.252151e-03 3 1  ON 60
ci_062                -1.513046e-03 3 1  ON 61
ci_063                -6.801520e-04 3 1  ON 62
ci_064                -5.003746e-04 3 1  ON 63
ci_065                -9.606069e-04 3 1  ON 64
ci_066                -1.382450e-03 3 1  ON 65
ci_067                -1.040069e-03 3 1  ON 66
ci_068                -1.002359e-03 3 1  ON 67
ci_069                 1.785081e-03 3 1  ON 68
ci_070                 1.534288e-03 3 1  ON 69
ci_071                -1.964718e-03 3 1  ON 70
ci_072                -1.608022e-03 3 1  ON 71
ci_073                 1.066601e-03 3 1  ON 72
ci_074                 1.020939e-03 3 1  ON 73
ci_075                -1.120166e-03 3 1  ON 74
ci_076                -1.054703e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4147e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2268e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.052
    reference variance = 4.79182
====================================================
  Execution time = 2.3489e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0289e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8567e+00
  Total weights = 1.949955329e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8781e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.908026375025
                                         uncertainty =       0.106001085628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.908026375025
                                         uncertainty =       0.106001085628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001397664468
  error estimate for blocks of size 2^( 2) =       0.001468844264
  error estimate for blocks of size 2^( 3) =       0.001531522675
  error estimate for blocks of size 2^( 4) =       0.001576049537
  error estimate for blocks of size 2^( 5) =       0.001600900257
  error estimate for blocks of size 2^( 6) =       0.001616282586
  error estimate for blocks of size 2^( 7) =       0.001615975002

      target function =                  N/A
              le_mean =     -22.327652796583
             les_mean =     502.380812998577
             stat err =       0.001602301846
             autocorr =       1.314264620355
              std dev =       1.976627671436
             le_variance =       3.907056951488


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232765279658e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327652795776       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327656558603       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327656603370       residual = 6.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+00 is 1.148132e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327652795776       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327653773891       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327653783157       residual = 3.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+01 is 3.049887e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327652795776       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327653042760       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327653044958       residual = 2.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+01 is 7.745471e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198257 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9377e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_001                -6.977660e-01 3 1  ON 0
ci_002                -7.024091e-01 3 1  ON 1
ci_003                -6.293546e-02 3 1  ON 2
ci_004                -6.102211e-02 3 1  ON 3
ci_005                 4.544812e-02 3 1  ON 4
ci_006                 4.547024e-02 3 1  ON 5
ci_007                 3.162471e-02 3 1  ON 6
ci_008                 3.181391e-02 3 1  ON 7
ci_009                -2.476681e-02 3 1  ON 8
ci_010                -2.515954e-02 3 1  ON 9
ci_011                -2.367214e-02 3 1  ON 10
ci_012                -2.277091e-02 3 1  ON 11
ci_013                 1.979259e-02 3 1  ON 12
ci_014                 1.995658e-02 3 1  ON 13
ci_015                 1.987698e-02 3 1  ON 14
ci_016                 2.113137e-02 3 1  ON 15
ci_017                 1.515972e-02 3 1  ON 16
ci_018                 1.509638e-02 3 1  ON 17
ci_019                 9.953021e-03 3 1  ON 18
ci_020                 9.864532e-03 3 1  ON 19
ci_021                -1.086753e-02 3 1  ON 20
ci_022                -1.078635e-02 3 1  ON 21
ci_023                 8.541646e-03 3 1  ON 22
ci_024                 8.997232e-03 3 1  ON 23
ci_025                 7.957689e-03 3 1  ON 24
ci_026                 8.650269e-03 3 1  ON 25
ci_027                 7.865974e-03 3 1  ON 26
ci_028                 7.337726e-03 3 1  ON 27
ci_029                -8.261873e-03 3 1  ON 28
ci_030                -7.937942e-03 3 1  ON 29
ci_031                -8.022361e-03 3 1  ON 30
ci_032                -7.267233e-03 3 1  ON 31
ci_033                 6.016954e-03 3 1  ON 32
ci_034                 6.682091e-03 3 1  ON 33
ci_035                 6.181377e-03 3 1  ON 34
ci_036                 6.378396e-03 3 1  ON 35
ci_037                 6.903201e-03 3 1  ON 36
ci_038                 6.728914e-03 3 1  ON 37
ci_039                 6.139952e-03 3 1  ON 38
ci_040                 5.007302e-03 3 1  ON 39
ci_041                 5.214348e-03 3 1  ON 40
ci_042                 5.162748e-03 3 1  ON 41
ci_043                 5.885000e-03 3 1  ON 42
ci_044                 5.707421e-03 3 1  ON 43
ci_045                 5.508927e-03 3 1  ON 44
ci_046                 5.151806e-03 3 1  ON 45
ci_047                -3.829773e-03 3 1  ON 46
ci_048                -4.301533e-03 3 1  ON 47
ci_049                 3.775255e-03 3 1  ON 48
ci_050                 2.956995e-03 3 1  ON 49
ci_051                -2.355483e-03 3 1  ON 50
ci_052                -2.855628e-03 3 1  ON 51
ci_053                -2.226819e-03 3 1  ON 52
ci_054                -2.309925e-03 3 1  ON 53
ci_055                -1.453707e-03 3 1  ON 54
ci_056                -2.096680e-03 3 1  ON 55
ci_057                -2.263990e-03 3 1  ON 56
ci_058                -1.454231e-03 3 1  ON 57
ci_059                -1.914878e-03 3 1  ON 58
ci_060                -1.772238e-03 3 1  ON 59
ci_061                -2.256916e-03 3 1  ON 60
ci_062                -1.533379e-03 3 1  ON 61
ci_063                -6.792587e-04 3 1  ON 62
ci_064                -5.138528e-04 3 1  ON 63
ci_065                -9.631748e-04 3 1  ON 64
ci_066                -1.374603e-03 3 1  ON 65
ci_067                -1.039284e-03 3 1  ON 66
ci_068                -1.003633e-03 3 1  ON 67
ci_069                 1.777331e-03 3 1  ON 68
ci_070                 1.534590e-03 3 1  ON 69
ci_071                -1.948743e-03 3 1  ON 70
ci_072                -1.602751e-03 3 1  ON 71
ci_073                 1.063141e-03 3 1  ON 72
ci_074                 1.020076e-03 3 1  ON 73
ci_075                -1.098283e-03 3 1  ON 74
ci_076                -1.057817e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.5469
    reference variance = 3.05484
====================================================
  Execution time = 2.5186e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6744e+00
  Total weights = 1.9500e+06
  Execution time = 4.3115e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.725138687423
                                         uncertainty =       0.035020855818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.725138687423
                                         uncertainty =       0.035020855818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364623742
  error estimate for blocks of size 2^( 2) =       0.001435865915
  error estimate for blocks of size 2^( 3) =       0.001500041292
  error estimate for blocks of size 2^( 4) =       0.001541443838
  error estimate for blocks of size 2^( 5) =       0.001564174741
  error estimate for blocks of size 2^( 6) =       0.001574580742
  error estimate for blocks of size 2^( 7) =       0.001585636455

      target function =                  N/A
              le_mean =     -22.327733645679
             les_mean =     502.202115792132
             stat err =       0.001566458944
             autocorr =       1.317686776639
              std dev =       1.929900281124
             le_variance =       3.724515095081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.725147402351
                                         uncertainty =       0.035020780154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.725147402351
                                         uncertainty =       0.035020780154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364625344
  error estimate for blocks of size 2^( 2) =       0.001435865136
  error estimate for blocks of size 2^( 3) =       0.001500039455
  error estimate for blocks of size 2^( 4) =       0.001541441077
  error estimate for blocks of size 2^( 5) =       0.001564169800
  error estimate for blocks of size 2^( 6) =       0.001574571032
  error estimate for blocks of size 2^( 7) =       0.001585632622

      target function =                  N/A
              le_mean =     -22.327732434210
             les_mean =     502.202626884927
             stat err =       0.001566453633
             autocorr =       1.317674747438
              std dev =       1.929902546445
             le_variance =       3.724523838775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.725142827950
                                         uncertainty =       0.035020815098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.725142827950
                                         uncertainty =       0.035020815098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364624503
  error estimate for blocks of size 2^( 2) =       0.001435865461
  error estimate for blocks of size 2^( 3) =       0.001500040313
  error estimate for blocks of size 2^( 4) =       0.001541442390
  error estimate for blocks of size 2^( 5) =       0.001564172157
  error estimate for blocks of size 2^( 6) =       0.001574575566
  error estimate for blocks of size 2^( 7) =       0.001585634286

      target function =                  N/A
              le_mean =     -22.327732961415
             les_mean =     502.202139547152
             stat err =       0.001566456100
             autocorr =       1.317680520782
              std dev =       1.929901357698
             le_variance =       3.724519250443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.725139174258
                                         uncertainty =       0.035020850668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.725139174258
                                         uncertainty =       0.035020850668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364623832
  error estimate for blocks of size 2^( 2) =       0.001435865852
  error estimate for blocks of size 2^( 3) =       0.001500041164
  error estimate for blocks of size 2^( 4) =       0.001541443646
  error estimate for blocks of size 2^( 5) =       0.001564174410
  error estimate for blocks of size 2^( 6) =       0.001574580070
  error estimate for blocks of size 2^( 7) =       0.001585636164

      target function =                  N/A
              le_mean =     -22.327733553735
             les_mean =     502.202106007187
             stat err =       0.001566458572
             autocorr =       1.317685978261
              std dev =       1.929900407738
             le_variance =       3.724515583786


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327733645679        initial  <--
     3.7253e+00     3.7253e+01             1.1481e-04       -22.327732434210
     1.4901e+01     1.4901e+02             3.0499e-05       -22.327732961415
     5.9605e+01     5.9605e+02             7.7455e-06       -22.327733553735

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.9351
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_001                -6.977631e-01 3 1  ON 0
ci_002                -7.024135e-01 3 1  ON 1
ci_003                -6.295151e-02 3 1  ON 2
ci_004                -6.102576e-02 3 1  ON 3
ci_005                 4.545126e-02 3 1  ON 4
ci_006                 4.546153e-02 3 1  ON 5
ci_007                 3.161455e-02 3 1  ON 6
ci_008                 3.180221e-02 3 1  ON 7
ci_009                -2.474842e-02 3 1  ON 8
ci_010                -2.514993e-02 3 1  ON 9
ci_011                -2.367045e-02 3 1  ON 10
ci_012                -2.275949e-02 3 1  ON 11
ci_013                 1.978445e-02 3 1  ON 12
ci_014                 1.993815e-02 3 1  ON 13
ci_015                 1.988610e-02 3 1  ON 14
ci_016                 2.113075e-02 3 1  ON 15
ci_017                 1.515668e-02 3 1  ON 16
ci_018                 1.509321e-02 3 1  ON 17
ci_019                 9.950316e-03 3 1  ON 18
ci_020                 9.836311e-03 3 1  ON 19
ci_021                -1.086726e-02 3 1  ON 20
ci_022                -1.079467e-02 3 1  ON 21
ci_023                 8.543475e-03 3 1  ON 22
ci_024                 8.988822e-03 3 1  ON 23
ci_025                 7.948235e-03 3 1  ON 24
ci_026                 8.675753e-03 3 1  ON 25
ci_027                 7.858767e-03 3 1  ON 26
ci_028                 7.325447e-03 3 1  ON 27
ci_029                -8.268142e-03 3 1  ON 28
ci_030                -7.941632e-03 3 1  ON 29
ci_031                -8.019664e-03 3 1  ON 30
ci_032                -7.273186e-03 3 1  ON 31
ci_033                 6.014261e-03 3 1  ON 32
ci_034                 6.691038e-03 3 1  ON 33
ci_035                 6.186186e-03 3 1  ON 34
ci_036                 6.378679e-03 3 1  ON 35
ci_037                 6.896167e-03 3 1  ON 36
ci_038                 6.719280e-03 3 1  ON 37
ci_039                 6.170451e-03 3 1  ON 38
ci_040                 4.990655e-03 3 1  ON 39
ci_041                 5.233675e-03 3 1  ON 40
ci_042                 5.170770e-03 3 1  ON 41
ci_043                 5.875329e-03 3 1  ON 42
ci_044                 5.719354e-03 3 1  ON 43
ci_045                 5.510152e-03 3 1  ON 44
ci_046                 5.170016e-03 3 1  ON 45
ci_047                -3.828928e-03 3 1  ON 46
ci_048                -4.290556e-03 3 1  ON 47
ci_049                 3.774479e-03 3 1  ON 48
ci_050                 2.935892e-03 3 1  ON 49
ci_051                -2.367844e-03 3 1  ON 50
ci_052                -2.860336e-03 3 1  ON 51
ci_053                -2.228975e-03 3 1  ON 52
ci_054                -2.324706e-03 3 1  ON 53
ci_055                -1.450872e-03 3 1  ON 54
ci_056                -2.081068e-03 3 1  ON 55
ci_057                -2.263043e-03 3 1  ON 56
ci_058                -1.433591e-03 3 1  ON 57
ci_059                -1.907363e-03 3 1  ON 58
ci_060                -1.774016e-03 3 1  ON 59
ci_061                -2.252151e-03 3 1  ON 60
ci_062                -1.513046e-03 3 1  ON 61
ci_063                -6.801520e-04 3 1  ON 62
ci_064                -5.003746e-04 3 1  ON 63
ci_065                -9.606069e-04 3 1  ON 64
ci_066                -1.382450e-03 3 1  ON 65
ci_067                -1.040069e-03 3 1  ON 66
ci_068                -1.002359e-03 3 1  ON 67
ci_069                 1.785081e-03 3 1  ON 68
ci_070                 1.534288e-03 3 1  ON 69
ci_071                -1.964718e-03 3 1  ON 70
ci_072                -1.608022e-03 3 1  ON 71
ci_073                 1.066601e-03 3 1  ON 72
ci_074                 1.020939e-03 3 1  ON 73
ci_075                -1.120166e-03 3 1  ON 74
ci_076                -1.054703e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6328e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2269e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.3459
    reference variance = 3.49985
====================================================
  Execution time = 2.3452e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0308e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.8815e+00
  Total weights = 1.949905834e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8626e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.933886842887
                                         uncertainty =       0.088425842490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.933886842887
                                         uncertainty =       0.088425842490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001402267919
  error estimate for blocks of size 2^( 2) =       0.001472781437
  error estimate for blocks of size 2^( 3) =       0.001535287922
  error estimate for blocks of size 2^( 4) =       0.001579848391
  error estimate for blocks of size 2^( 5) =       0.001606282764
  error estimate for blocks of size 2^( 6) =       0.001617968522
  error estimate for blocks of size 2^( 7) =       0.001624671613

      target function =                  N/A
              le_mean =     -22.330033830819
             les_mean =     502.511952228199
             stat err =       0.001607192823
             autocorr =       1.313632764510
              std dev =       1.983138038086
             le_variance =       3.932836478104


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233003383082e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330033829974       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330034411717       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330034413903       residual = 8.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+01 is 1.987089e-05

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330033829974       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330033976003       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330033976572       residual = 8.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+02 is 4.987317e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330033829974       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330033866519       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330033866662       residual = 8.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+02 is 1.248060e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199441 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9321e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_001                -6.977627e-01 3 1  ON 0
ci_002                -7.024138e-01 3 1  ON 1
ci_003                -6.295011e-02 3 1  ON 2
ci_004                -6.102678e-02 3 1  ON 3
ci_005                 4.545185e-02 3 1  ON 4
ci_006                 4.546285e-02 3 1  ON 5
ci_007                 3.161541e-02 3 1  ON 6
ci_008                 3.180189e-02 3 1  ON 7
ci_009                -2.475055e-02 3 1  ON 8
ci_010                -2.514979e-02 3 1  ON 9
ci_011                -2.366968e-02 3 1  ON 10
ci_012                -2.275756e-02 3 1  ON 11
ci_013                 1.978554e-02 3 1  ON 12
ci_014                 1.993940e-02 3 1  ON 13
ci_015                 1.988554e-02 3 1  ON 14
ci_016                 2.113067e-02 3 1  ON 15
ci_017                 1.515796e-02 3 1  ON 16
ci_018                 1.509150e-02 3 1  ON 17
ci_019                 9.949788e-03 3 1  ON 18
ci_020                 9.836927e-03 3 1  ON 19
ci_021                -1.086635e-02 3 1  ON 20
ci_022                -1.079454e-02 3 1  ON 21
ci_023                 8.543025e-03 3 1  ON 22
ci_024                 8.989045e-03 3 1  ON 23
ci_025                 7.947792e-03 3 1  ON 24
ci_026                 8.673644e-03 3 1  ON 25
ci_027                 7.858179e-03 3 1  ON 26
ci_028                 7.327061e-03 3 1  ON 27
ci_029                -8.267615e-03 3 1  ON 28
ci_030                -7.943337e-03 3 1  ON 29
ci_031                -8.020892e-03 3 1  ON 30
ci_032                -7.271716e-03 3 1  ON 31
ci_033                 6.015039e-03 3 1  ON 32
ci_034                 6.690567e-03 3 1  ON 33
ci_035                 6.188558e-03 3 1  ON 34
ci_036                 6.379818e-03 3 1  ON 35
ci_037                 6.896788e-03 3 1  ON 36
ci_038                 6.718649e-03 3 1  ON 37
ci_039                 6.167531e-03 3 1  ON 38
ci_040                 4.992022e-03 3 1  ON 39
ci_041                 5.232995e-03 3 1  ON 40
ci_042                 5.172882e-03 3 1  ON 41
ci_043                 5.873432e-03 3 1  ON 42
ci_044                 5.718634e-03 3 1  ON 43
ci_045                 5.512129e-03 3 1  ON 44
ci_046                 5.168948e-03 3 1  ON 45
ci_047                -3.829722e-03 3 1  ON 46
ci_048                -4.289784e-03 3 1  ON 47
ci_049                 3.773063e-03 3 1  ON 48
ci_050                 2.935177e-03 3 1  ON 49
ci_051                -2.368400e-03 3 1  ON 50
ci_052                -2.861686e-03 3 1  ON 51
ci_053                -2.229284e-03 3 1  ON 52
ci_054                -2.325484e-03 3 1  ON 53
ci_055                -1.451794e-03 3 1  ON 54
ci_056                -2.081516e-03 3 1  ON 55
ci_057                -2.263706e-03 3 1  ON 56
ci_058                -1.438578e-03 3 1  ON 57
ci_059                -1.905017e-03 3 1  ON 58
ci_060                -1.773436e-03 3 1  ON 59
ci_061                -2.252419e-03 3 1  ON 60
ci_062                -1.515384e-03 3 1  ON 61
ci_063                -6.812673e-04 3 1  ON 62
ci_064                -4.989600e-04 3 1  ON 63
ci_065                -9.608109e-04 3 1  ON 64
ci_066                -1.382392e-03 3 1  ON 65
ci_067                -1.040740e-03 3 1  ON 66
ci_068                -1.003284e-03 3 1  ON 67
ci_069                 1.784262e-03 3 1  ON 68
ci_070                 1.534694e-03 3 1  ON 69
ci_071                -1.963940e-03 3 1  ON 70
ci_072                -1.607568e-03 3 1  ON 71
ci_073                 1.066566e-03 3 1  ON 72
ci_074                 1.022187e-03 3 1  ON 73
ci_075                -1.119634e-03 3 1  ON 74
ci_076                -1.055103e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.2457
    reference variance = 2.35777
====================================================
  Execution time = 2.3022e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7578e+00
  Total weights = 1.9500e+06
  Execution time = 4.3249e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812539577708
                                         uncertainty =       0.052700648636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812539577708
                                         uncertainty =       0.052700648636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380542857
  error estimate for blocks of size 2^( 2) =       0.001450663467
  error estimate for blocks of size 2^( 3) =       0.001513781713
  error estimate for blocks of size 2^( 4) =       0.001554203716
  error estimate for blocks of size 2^( 5) =       0.001579122992
  error estimate for blocks of size 2^( 6) =       0.001592738198
  error estimate for blocks of size 2^( 7) =       0.001599829017

      target function =                  N/A
              le_mean =     -22.328654427484
             les_mean =     502.326603402661
             stat err =       0.001581473481
             autocorr =       1.312272540296
              std dev =       1.952413669479
             le_variance =       3.811919136768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812540293621
                                         uncertainty =       0.052700672928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812540293621
                                         uncertainty =       0.052700672928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380542982
  error estimate for blocks of size 2^( 2) =       0.001450663510
  error estimate for blocks of size 2^( 3) =       0.001513781584
  error estimate for blocks of size 2^( 4) =       0.001554203450
  error estimate for blocks of size 2^( 5) =       0.001579122412
  error estimate for blocks of size 2^( 6) =       0.001592737391
  error estimate for blocks of size 2^( 7) =       0.001599827748

      target function =                  N/A
              le_mean =     -22.328654436306
             les_mean =     502.326602842540
             stat err =       0.001581472750
             autocorr =       1.312271089200
              std dev =       1.952413847038
             le_variance =       3.811919830107

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812539934592
                                         uncertainty =       0.052700660801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812539934592
                                         uncertainty =       0.052700660801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380542919
  error estimate for blocks of size 2^( 2) =       0.001450663488
  error estimate for blocks of size 2^( 3) =       0.001513781648
  error estimate for blocks of size 2^( 4) =       0.001554203582
  error estimate for blocks of size 2^( 5) =       0.001579122701
  error estimate for blocks of size 2^( 6) =       0.001592737793
  error estimate for blocks of size 2^( 7) =       0.001599828379

      target function =                  N/A
              le_mean =     -22.328654431144
             les_mean =     502.326602894331
             stat err =       0.001581473114
             autocorr =       1.312271811802
              std dev =       1.952413757970
             le_variance =       3.811919482310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812539622018
                                         uncertainty =       0.052700650158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812539622018
                                         uncertainty =       0.052700650158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380542865
  error estimate for blocks of size 2^( 2) =       0.001450663469
  error estimate for blocks of size 2^( 3) =       0.001513781704
  error estimate for blocks of size 2^( 4) =       0.001554203699
  error estimate for blocks of size 2^( 5) =       0.001579122956
  error estimate for blocks of size 2^( 6) =       0.001592738147
  error estimate for blocks of size 2^( 7) =       0.001599828937

      target function =                  N/A
              le_mean =     -22.328654427852
             les_mean =     502.326603315576
             stat err =       0.001581473435
             autocorr =       1.312272449184
              std dev =       1.952413680463
             le_variance =       3.811919179658


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328654427484        initial
     3.7253e+01     3.7253e+02             1.9871e-05       -22.328654436306  <--
     1.4901e+02     1.4901e+03             4.9873e-06       -22.328654431144
     5.9605e+02     5.9605e+03             1.2481e-06       -22.328654427852

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 4.4848e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_001                -6.977612e-01 3 1  ON 0
ci_002                -7.024149e-01 3 1  ON 1
ci_003                -6.294592e-02 3 1  ON 2
ci_004                -6.102981e-02 3 1  ON 3
ci_005                 4.545364e-02 3 1  ON 4
ci_006                 4.546676e-02 3 1  ON 5
ci_007                 3.161800e-02 3 1  ON 6
ci_008                 3.180095e-02 3 1  ON 7
ci_009                -2.475693e-02 3 1  ON 8
ci_010                -2.514937e-02 3 1  ON 9
ci_011                -2.366737e-02 3 1  ON 10
ci_012                -2.275180e-02 3 1  ON 11
ci_013                 1.978879e-02 3 1  ON 12
ci_014                 1.994315e-02 3 1  ON 13
ci_015                 1.988385e-02 3 1  ON 14
ci_016                 2.113044e-02 3 1  ON 15
ci_017                 1.516178e-02 3 1  ON 16
ci_018                 1.508638e-02 3 1  ON 17
ci_019                 9.948205e-03 3 1  ON 18
ci_020                 9.838775e-03 3 1  ON 19
ci_021                -1.086364e-02 3 1  ON 20
ci_022                -1.079415e-02 3 1  ON 21
ci_023                 8.541685e-03 3 1  ON 22
ci_024                 8.989709e-03 3 1  ON 23
ci_025                 7.946468e-03 3 1  ON 24
ci_026                 8.667339e-03 3 1  ON 25
ci_027                 7.856433e-03 3 1  ON 26
ci_028                 7.331858e-03 3 1  ON 27
ci_029                -8.266046e-03 3 1  ON 28
ci_030                -7.948429e-03 3 1  ON 29
ci_031                -8.024565e-03 3 1  ON 30
ci_032                -7.267325e-03 3 1  ON 31
ci_033                 6.017360e-03 3 1  ON 32
ci_034                 6.689163e-03 3 1  ON 33
ci_035                 6.195622e-03 3 1  ON 34
ci_036                 6.383210e-03 3 1  ON 35
ci_037                 6.898641e-03 3 1  ON 36
ci_038                 6.716767e-03 3 1  ON 37
ci_039                 6.158844e-03 3 1  ON 38
ci_040                 4.996087e-03 3 1  ON 39
ci_041                 5.230973e-03 3 1  ON 40
ci_042                 5.179178e-03 3 1  ON 41
ci_043                 5.867770e-03 3 1  ON 42
ci_044                 5.716487e-03 3 1  ON 43
ci_045                 5.518033e-03 3 1  ON 44
ci_046                 5.165758e-03 3 1  ON 45
ci_047                -3.832084e-03 3 1  ON 46
ci_048                -4.287484e-03 3 1  ON 47
ci_049                 3.768836e-03 3 1  ON 48
ci_050                 2.933044e-03 3 1  ON 49
ci_051                -2.370067e-03 3 1  ON 50
ci_052                -2.865718e-03 3 1  ON 51
ci_053                -2.230209e-03 3 1  ON 52
ci_054                -2.327816e-03 3 1  ON 53
ci_055                -1.454545e-03 3 1  ON 54
ci_056                -2.082854e-03 3 1  ON 55
ci_057                -2.265680e-03 3 1  ON 56
ci_058                -1.453462e-03 3 1  ON 57
ci_059                -1.898027e-03 3 1  ON 58
ci_060                -1.771711e-03 3 1  ON 59
ci_061                -2.253222e-03 3 1  ON 60
ci_062                -1.522356e-03 3 1  ON 61
ci_063                -6.845955e-04 3 1  ON 62
ci_064                -4.947324e-04 3 1  ON 63
ci_065                -9.614238e-04 3 1  ON 64
ci_066                -1.382211e-03 3 1  ON 65
ci_067                -1.042746e-03 3 1  ON 66
ci_068                -1.006043e-03 3 1  ON 67
ci_069                 1.781815e-03 3 1  ON 68
ci_070                 1.535905e-03 3 1  ON 69
ci_071                -1.961619e-03 3 1  ON 70
ci_072                -1.606210e-03 3 1  ON 71
ci_073                 1.066456e-03 3 1  ON 72
ci_074                 1.025897e-03 3 1  ON 73
ci_075                -1.118047e-03 3 1  ON 74
ci_076                -1.056294e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4177e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2270e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.0678
    reference variance = 3.81675
====================================================
  Execution time = 2.3487e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0319e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7127e+00
  Total weights = 1.950300814e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7814e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761127641767
                                         uncertainty =       0.032239455001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761127641767
                                         uncertainty =       0.032239455001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371253835
  error estimate for blocks of size 2^( 2) =       0.001440363309
  error estimate for blocks of size 2^( 3) =       0.001504132611
  error estimate for blocks of size 2^( 4) =       0.001548564120
  error estimate for blocks of size 2^( 5) =       0.001575309635
  error estimate for blocks of size 2^( 6) =       0.001591634790
  error estimate for blocks of size 2^( 7) =       0.001608440878

      target function =                  N/A
              le_mean =     -22.329431580737
             les_mean =     502.316219915237
             stat err =       0.001580987356
             autocorr =       1.329294117234
              std dev =       1.939276798630
             le_variance =       3.760794501704


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232943158074e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329431579886       residual = 5.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329433529641       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329433786368       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+00 is 7.715069e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329431579886       residual = 5.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329432075793       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329432139651       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+01 is 1.952003e-05

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329431579886       residual = 5.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329431704403       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329431720347       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+02 is 4.894767e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200661 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9275e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_001                -6.977635e-01 3 1  ON 0
ci_002                -7.024131e-01 3 1  ON 1
ci_003                -6.294204e-02 3 1  ON 2
ci_004                -6.103396e-02 3 1  ON 3
ci_005                 4.544798e-02 3 1  ON 4
ci_006                 4.547334e-02 3 1  ON 5
ci_007                 3.161089e-02 3 1  ON 6
ci_008                 3.179633e-02 3 1  ON 7
ci_009                -2.476100e-02 3 1  ON 8
ci_010                -2.514219e-02 3 1  ON 9
ci_011                -2.366538e-02 3 1  ON 10
ci_012                -2.275221e-02 3 1  ON 11
ci_013                 1.979231e-02 3 1  ON 12
ci_014                 1.994496e-02 3 1  ON 13
ci_015                 1.987723e-02 3 1  ON 14
ci_016                 2.112432e-02 3 1  ON 15
ci_017                 1.516496e-02 3 1  ON 16
ci_018                 1.508947e-02 3 1  ON 17
ci_019                 9.954855e-03 3 1  ON 18
ci_020                 9.845564e-03 3 1  ON 19
ci_021                -1.085517e-02 3 1  ON 20
ci_022                -1.079307e-02 3 1  ON 21
ci_023                 8.545765e-03 3 1  ON 22
ci_024                 8.989603e-03 3 1  ON 23
ci_025                 7.943901e-03 3 1  ON 24
ci_026                 8.662629e-03 3 1  ON 25
ci_027                 7.859020e-03 3 1  ON 26
ci_028                 7.330588e-03 3 1  ON 27
ci_029                -8.255345e-03 3 1  ON 28
ci_030                -7.942717e-03 3 1  ON 29
ci_031                -8.023517e-03 3 1  ON 30
ci_032                -7.265142e-03 3 1  ON 31
ci_033                 6.021143e-03 3 1  ON 32
ci_034                 6.708683e-03 3 1  ON 33
ci_035                 6.205311e-03 3 1  ON 34
ci_036                 6.385659e-03 3 1  ON 35
ci_037                 6.895774e-03 3 1  ON 36
ci_038                 6.714666e-03 3 1  ON 37
ci_039                 6.158863e-03 3 1  ON 38
ci_040                 5.000142e-03 3 1  ON 39
ci_041                 5.221998e-03 3 1  ON 40
ci_042                 5.183841e-03 3 1  ON 41
ci_043                 5.863776e-03 3 1  ON 42
ci_044                 5.714036e-03 3 1  ON 43
ci_045                 5.515796e-03 3 1  ON 44
ci_046                 5.167181e-03 3 1  ON 45
ci_047                -3.850532e-03 3 1  ON 46
ci_048                -4.305586e-03 3 1  ON 47
ci_049                 3.762948e-03 3 1  ON 48
ci_050                 2.931371e-03 3 1  ON 49
ci_051                -2.378213e-03 3 1  ON 50
ci_052                -2.869862e-03 3 1  ON 51
ci_053                -2.238836e-03 3 1  ON 52
ci_054                -2.330815e-03 3 1  ON 53
ci_055                -1.452401e-03 3 1  ON 54
ci_056                -2.087947e-03 3 1  ON 55
ci_057                -2.265000e-03 3 1  ON 56
ci_058                -1.458573e-03 3 1  ON 57
ci_059                -1.896501e-03 3 1  ON 58
ci_060                -1.767809e-03 3 1  ON 59
ci_061                -2.251982e-03 3 1  ON 60
ci_062                -1.523923e-03 3 1  ON 61
ci_063                -6.901173e-04 3 1  ON 62
ci_064                -4.888033e-04 3 1  ON 63
ci_065                -9.613753e-04 3 1  ON 64
ci_066                -1.387191e-03 3 1  ON 65
ci_067                -1.042900e-03 3 1  ON 66
ci_068                -1.012674e-03 3 1  ON 67
ci_069                 1.778406e-03 3 1  ON 68
ci_070                 1.530578e-03 3 1  ON 69
ci_071                -1.957561e-03 3 1  ON 70
ci_072                -1.600117e-03 3 1  ON 71
ci_073                 1.068936e-03 3 1  ON 72
ci_074                 1.025053e-03 3 1  ON 73
ci_075                -1.110028e-03 3 1  ON 74
ci_076                -1.048724e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.5559
    reference variance = 3.7545
====================================================
  Execution time = 2.2930e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7240e+00
  Total weights = 1.9499e+06
  Execution time = 4.3045e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772746621447
                                         uncertainty =       0.049923658213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772746621447
                                         uncertainty =       0.049923658213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373598587
  error estimate for blocks of size 2^( 2) =       0.001444084482
  error estimate for blocks of size 2^( 3) =       0.001506760315
  error estimate for blocks of size 2^( 4) =       0.001553143895
  error estimate for blocks of size 2^( 5) =       0.001581926218
  error estimate for blocks of size 2^( 6) =       0.001584056517
  error estimate for blocks of size 2^( 7) =       0.001587821480

      target function =                  N/A
              le_mean =     -22.329956309868
             les_mean =     502.350990763116
             stat err =       0.001576737028
             autocorr =       1.317646346891
              std dev =       1.942592831850
             le_variance =       3.773666910355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772748000300
                                         uncertainty =       0.049924056566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772748000300
                                         uncertainty =       0.049924056566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373598824
  error estimate for blocks of size 2^( 2) =       0.001444084924
  error estimate for blocks of size 2^( 3) =       0.001506761454
  error estimate for blocks of size 2^( 4) =       0.001553145571
  error estimate for blocks of size 2^( 5) =       0.001581927741
  error estimate for blocks of size 2^( 6) =       0.001584056266
  error estimate for blocks of size 2^( 7) =       0.001587823980

      target function =                  N/A
              le_mean =     -22.329956365901
             les_mean =     502.351114203884
             stat err =       0.001576738389
             autocorr =       1.317648169379
              std dev =       1.942593166236
             le_variance =       3.773668209508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772747196644
                                         uncertainty =       0.049923860796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772747196644
                                         uncertainty =       0.049923860796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373598684
  error estimate for blocks of size 2^( 2) =       0.001444084685
  error estimate for blocks of size 2^( 3) =       0.001506760877
  error estimate for blocks of size 2^( 4) =       0.001553144725
  error estimate for blocks of size 2^( 5) =       0.001581926951
  error estimate for blocks of size 2^( 6) =       0.001584056353
  error estimate for blocks of size 2^( 7) =       0.001587822744

      target function =                  N/A
              le_mean =     -22.329956314294
             les_mean =     502.350997071055
             stat err =       0.001576737693
             autocorr =       1.317647272305
              std dev =       1.942592969555
             le_variance =       3.773667445364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772746678716
                                         uncertainty =       0.049923683701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772746678716
                                         uncertainty =       0.049923683701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373598597
  error estimate for blocks of size 2^( 2) =       0.001444084505
  error estimate for blocks of size 2^( 3) =       0.001506760383
  error estimate for blocks of size 2^( 4) =       0.001553143997
  error estimate for blocks of size 2^( 5) =       0.001581926308
  error estimate for blocks of size 2^( 6) =       0.001584056493
  error estimate for blocks of size 2^( 7) =       0.001587821634

      target function =                  N/A
              le_mean =     -22.329956308156
             les_mean =     502.350990511149
             stat err =       0.001576737108
             autocorr =       1.317646462854
              std dev =       1.942592845298
             le_variance =       3.773666962603


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329956309868        initial
     9.3132e+00     9.3132e+01             7.7151e-05       -22.329956365901  <--
     3.7253e+01     3.7253e+02             1.9520e-05       -22.329956314294
     1.4901e+02     1.4901e+03             4.8948e-06       -22.329956308156

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 4.4655e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_001                -6.977702e-01 3 1  ON 0
ci_002                -7.024079e-01 3 1  ON 1
ci_003                -6.293058e-02 3 1  ON 2
ci_004                -6.104630e-02 3 1  ON 3
ci_005                 4.543148e-02 3 1  ON 4
ci_006                 4.549268e-02 3 1  ON 5
ci_007                 3.159000e-02 3 1  ON 6
ci_008                 3.178277e-02 3 1  ON 7
ci_009                -2.477315e-02 3 1  ON 8
ci_010                -2.512114e-02 3 1  ON 9
ci_011                -2.365946e-02 3 1  ON 10
ci_012                -2.275338e-02 3 1  ON 11
ci_013                 1.980265e-02 3 1  ON 12
ci_014                 1.995028e-02 3 1  ON 13
ci_015                 1.985760e-02 3 1  ON 14
ci_016                 2.110620e-02 3 1  ON 15
ci_017                 1.517436e-02 3 1  ON 16
ci_018                 1.509863e-02 3 1  ON 17
ci_019                 9.974506e-03 3 1  ON 18
ci_020                 9.865647e-03 3 1  ON 19
ci_021                -1.083025e-02 3 1  ON 20
ci_022                -1.078993e-02 3 1  ON 21
ci_023                 8.557776e-03 3 1  ON 22
ci_024                 8.989294e-03 3 1  ON 23
ci_025                 7.936299e-03 3 1  ON 24
ci_026                 8.648706e-03 3 1  ON 25
ci_027                 7.866541e-03 3 1  ON 26
ci_028                 7.326889e-03 3 1  ON 27
ci_029                -8.223820e-03 3 1  ON 28
ci_030                -7.925799e-03 3 1  ON 29
ci_031                -8.020480e-03 3 1  ON 30
ci_032                -7.258679e-03 3 1  ON 31
ci_033                 6.032324e-03 3 1  ON 32
ci_034                 6.766314e-03 3 1  ON 33
ci_035                 6.233468e-03 3 1  ON 34
ci_036                 6.392739e-03 3 1  ON 35
ci_037                 6.887340e-03 3 1  ON 36
ci_038                 6.708489e-03 3 1  ON 37
ci_039                 6.158938e-03 3 1  ON 38
ci_040                 5.011955e-03 3 1  ON 39
ci_041                 5.195712e-03 3 1  ON 40
ci_042                 5.197514e-03 3 1  ON 41
ci_043                 5.852015e-03 3 1  ON 42
ci_044                 5.706770e-03 3 1  ON 43
ci_045                 5.509171e-03 3 1  ON 44
ci_046                 5.171273e-03 3 1  ON 45
ci_047                -3.904178e-03 3 1  ON 46
ci_048                -4.358194e-03 3 1  ON 47
ci_049                 3.745607e-03 3 1  ON 48
ci_050                 2.926439e-03 3 1  ON 49
ci_051                -2.402215e-03 3 1  ON 50
ci_052                -2.882115e-03 3 1  ON 51
ci_053                -2.264225e-03 3 1  ON 52
ci_054                -2.339632e-03 3 1  ON 53
ci_055                -1.446075e-03 3 1  ON 54
ci_056                -2.102983e-03 3 1  ON 55
ci_057                -2.263024e-03 3 1  ON 56
ci_058                -1.473602e-03 3 1  ON 57
ci_059                -1.892098e-03 3 1  ON 58
ci_060                -1.756464e-03 3 1  ON 59
ci_061                -2.248342e-03 3 1  ON 60
ci_062                -1.528546e-03 3 1  ON 61
ci_063                -7.063555e-04 3 1  ON 62
ci_064                -4.713109e-04 3 1  ON 63
ci_065                -9.613145e-04 3 1  ON 64
ci_066                -1.401861e-03 3 1  ON 65
ci_067                -1.043359e-03 3 1  ON 66
ci_068                -1.032186e-03 3 1  ON 67
ci_069                 1.768356e-03 3 1  ON 68
ci_070                 1.514914e-03 3 1  ON 69
ci_071                -1.945561e-03 3 1  ON 70
ci_072                -1.582167e-03 3 1  ON 71
ci_073                 1.076154e-03 3 1  ON 72
ci_074                 1.022570e-03 3 1  ON 73
ci_075                -1.086431e-03 3 1  ON 74
ci_076                -1.026437e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3938e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2271e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.3026
    reference variance = 4.18897
====================================================
  Execution time = 2.3453e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0331e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7732e+00
  Total weights = 1.949698132e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8415e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826967312760
                                         uncertainty =       0.042779773924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826967312760
                                         uncertainty =       0.042779773924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383052032
  error estimate for blocks of size 2^( 2) =       0.001453683751
  error estimate for blocks of size 2^( 3) =       0.001516540742
  error estimate for blocks of size 2^( 4) =       0.001560098070
  error estimate for blocks of size 2^( 5) =       0.001586565016
  error estimate for blocks of size 2^( 6) =       0.001600367356
  error estimate for blocks of size 2^( 7) =       0.001609028278

      target function =                  N/A
              le_mean =     -22.327473319075
             les_mean =     502.289228885923
             stat err =       0.001589014680
             autocorr =       1.320014739443
              std dev =       1.955962235830
             le_variance =       3.825788267992


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232747331907e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327473318262       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327483457406       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327483585203       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+00 is 2.127256e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327473318262       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327476005889       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327476027431       residual = 5.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+00 is 5.576715e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327473318262       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327474000452       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327474005161       residual = 4.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+01 is 1.411465e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201890 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9301e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_001                -6.977732e-01 3 1  ON 0
ci_002                -7.024055e-01 3 1  ON 1
ci_003                -6.290542e-02 3 1  ON 2
ci_004                -6.106574e-02 3 1  ON 3
ci_005                 4.544600e-02 3 1  ON 4
ci_006                 4.548602e-02 3 1  ON 5
ci_007                 3.160895e-02 3 1  ON 6
ci_008                 3.175316e-02 3 1  ON 7
ci_009                -2.478231e-02 3 1  ON 8
ci_010                -2.512608e-02 3 1  ON 9
ci_011                -2.360369e-02 3 1  ON 10
ci_012                -2.275617e-02 3 1  ON 11
ci_013                 1.980991e-02 3 1  ON 12
ci_014                 1.997347e-02 3 1  ON 13
ci_015                 1.985176e-02 3 1  ON 14
ci_016                 2.109335e-02 3 1  ON 15
ci_017                 1.519315e-02 3 1  ON 16
ci_018                 1.511338e-02 3 1  ON 17
ci_019                 9.975412e-03 3 1  ON 18
ci_020                 9.863732e-03 3 1  ON 19
ci_021                -1.083532e-02 3 1  ON 20
ci_022                -1.076090e-02 3 1  ON 21
ci_023                 8.560971e-03 3 1  ON 22
ci_024                 8.977929e-03 3 1  ON 23
ci_025                 7.918223e-03 3 1  ON 24
ci_026                 8.660790e-03 3 1  ON 25
ci_027                 7.851285e-03 3 1  ON 26
ci_028                 7.318642e-03 3 1  ON 27
ci_029                -8.205638e-03 3 1  ON 28
ci_030                -7.945485e-03 3 1  ON 29
ci_031                -8.029026e-03 3 1  ON 30
ci_032                -7.261194e-03 3 1  ON 31
ci_033                 6.055844e-03 3 1  ON 32
ci_034                 6.760112e-03 3 1  ON 33
ci_035                 6.245092e-03 3 1  ON 34
ci_036                 6.414901e-03 3 1  ON 35
ci_037                 6.870864e-03 3 1  ON 36
ci_038                 6.733635e-03 3 1  ON 37
ci_039                 6.135083e-03 3 1  ON 38
ci_040                 5.013431e-03 3 1  ON 39
ci_041                 5.210062e-03 3 1  ON 40
ci_042                 5.202270e-03 3 1  ON 41
ci_043                 5.820735e-03 3 1  ON 42
ci_044                 5.697938e-03 3 1  ON 43
ci_045                 5.476928e-03 3 1  ON 44
ci_046                 5.197176e-03 3 1  ON 45
ci_047                -3.946707e-03 3 1  ON 46
ci_048                -4.355170e-03 3 1  ON 47
ci_049                 3.752113e-03 3 1  ON 48
ci_050                 2.937543e-03 3 1  ON 49
ci_051                -2.412706e-03 3 1  ON 50
ci_052                -2.890325e-03 3 1  ON 51
ci_053                -2.267082e-03 3 1  ON 52
ci_054                -2.365484e-03 3 1  ON 53
ci_055                -1.471095e-03 3 1  ON 54
ci_056                -2.076085e-03 3 1  ON 55
ci_057                -2.266710e-03 3 1  ON 56
ci_058                -1.519109e-03 3 1  ON 57
ci_059                -1.932978e-03 3 1  ON 58
ci_060                -1.748313e-03 3 1  ON 59
ci_061                -2.254345e-03 3 1  ON 60
ci_062                -1.558635e-03 3 1  ON 61
ci_063                -6.910398e-04 3 1  ON 62
ci_064                -4.941030e-04 3 1  ON 63
ci_065                -9.610924e-04 3 1  ON 64
ci_066                -1.416290e-03 3 1  ON 65
ci_067                -1.061930e-03 3 1  ON 66
ci_068                -1.069577e-03 3 1  ON 67
ci_069                 1.775272e-03 3 1  ON 68
ci_070                 1.509283e-03 3 1  ON 69
ci_071                -1.932808e-03 3 1  ON 70
ci_072                -1.559437e-03 3 1  ON 71
ci_073                 1.106925e-03 3 1  ON 72
ci_074                 1.047738e-03 3 1  ON 73
ci_075                -1.084928e-03 3 1  ON 74
ci_076                -1.032777e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.253
    reference variance = 2.98157
====================================================
  Execution time = 2.2898e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.8109e+00
  Total weights = 1.9497e+06
  Execution time = 4.2907e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.864764926574
                                         uncertainty =       0.058376645007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.864764926574
                                         uncertainty =       0.058376645007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001390074430
  error estimate for blocks of size 2^( 2) =       0.001461685594
  error estimate for blocks of size 2^( 3) =       0.001523242446
  error estimate for blocks of size 2^( 4) =       0.001564891048
  error estimate for blocks of size 2^( 5) =       0.001591794199
  error estimate for blocks of size 2^( 6) =       0.001603388853
  error estimate for blocks of size 2^( 7) =       0.001611204632

      target function =                  N/A
              le_mean =     -22.325357118449
             les_mean =     502.232824185893
             stat err =       0.001592819683
             autocorr =       1.312976999263
              std dev =       1.965893564979
             le_variance =       3.864737508824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.864790591906
                                         uncertainty =       0.058378021152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.864790591906
                                         uncertainty =       0.058378021152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001390079065
  error estimate for blocks of size 2^( 2) =       0.001461689415
  error estimate for blocks of size 2^( 3) =       0.001523245433
  error estimate for blocks of size 2^( 4) =       0.001564894264
  error estimate for blocks of size 2^( 5) =       0.001591795472
  error estimate for blocks of size 2^( 6) =       0.001603387945
  error estimate for blocks of size 2^( 7) =       0.001611201051

      target function =                  N/A
              le_mean =     -22.325356525250
             les_mean =     502.233047121640
             stat err =       0.001592819683
             autocorr =       1.312968242972
              std dev =       1.965900120186
             le_variance =       3.864763282546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.864777890349
                                         uncertainty =       0.058377385401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.864777890349
                                         uncertainty =       0.058377385401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001390076771
  error estimate for blocks of size 2^( 2) =       0.001461687557
  error estimate for blocks of size 2^( 3) =       0.001523244010
  error estimate for blocks of size 2^( 4) =       0.001564892808
  error estimate for blocks of size 2^( 5) =       0.001591794884
  error estimate for blocks of size 2^( 6) =       0.001603388254
  error estimate for blocks of size 2^( 7) =       0.001611202957

      target function =                  N/A
              le_mean =     -22.325356529412
             les_mean =     502.232552315860
             stat err =       0.001592819726
             autocorr =       1.312972646945
              std dev =       1.965896876388
             le_variance =       3.864750528591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.864766476091
                                         uncertainty =       0.058376739515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.864766476091
                                         uncertainty =       0.058376739515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001390074710
  error estimate for blocks of size 2^( 2) =       0.001461685821
  error estimate for blocks of size 2^( 3) =       0.001523242627
  error estimate for blocks of size 2^( 4) =       0.001564891244
  error estimate for blocks of size 2^( 5) =       0.001591794252
  error estimate for blocks of size 2^( 6) =       0.001603388709
  error estimate for blocks of size 2^( 7) =       0.001611204374

      target function =                  N/A
              le_mean =     -22.325357024024
             les_mean =     502.232525548669
             stat err =       0.001592819645
             autocorr =       1.312976407179
              std dev =       1.965893960884
             le_variance =       3.864739065440


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325357118449        initial  <--
     2.3283e+00     2.3283e+01             2.1273e-04       -22.325356525250
     9.3132e+00     9.3132e+01             5.5767e-05       -22.325356529412
     3.7253e+01     3.7253e+02             1.4115e-05       -22.325357024024

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5723
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_001                -6.977702e-01 3 1  ON 0
ci_002                -7.024079e-01 3 1  ON 1
ci_003                -6.293058e-02 3 1  ON 2
ci_004                -6.104630e-02 3 1  ON 3
ci_005                 4.543148e-02 3 1  ON 4
ci_006                 4.549268e-02 3 1  ON 5
ci_007                 3.159000e-02 3 1  ON 6
ci_008                 3.178277e-02 3 1  ON 7
ci_009                -2.477315e-02 3 1  ON 8
ci_010                -2.512114e-02 3 1  ON 9
ci_011                -2.365946e-02 3 1  ON 10
ci_012                -2.275338e-02 3 1  ON 11
ci_013                 1.980265e-02 3 1  ON 12
ci_014                 1.995028e-02 3 1  ON 13
ci_015                 1.985760e-02 3 1  ON 14
ci_016                 2.110620e-02 3 1  ON 15
ci_017                 1.517436e-02 3 1  ON 16
ci_018                 1.509863e-02 3 1  ON 17
ci_019                 9.974506e-03 3 1  ON 18
ci_020                 9.865647e-03 3 1  ON 19
ci_021                -1.083025e-02 3 1  ON 20
ci_022                -1.078993e-02 3 1  ON 21
ci_023                 8.557776e-03 3 1  ON 22
ci_024                 8.989294e-03 3 1  ON 23
ci_025                 7.936299e-03 3 1  ON 24
ci_026                 8.648706e-03 3 1  ON 25
ci_027                 7.866541e-03 3 1  ON 26
ci_028                 7.326889e-03 3 1  ON 27
ci_029                -8.223820e-03 3 1  ON 28
ci_030                -7.925799e-03 3 1  ON 29
ci_031                -8.020480e-03 3 1  ON 30
ci_032                -7.258679e-03 3 1  ON 31
ci_033                 6.032324e-03 3 1  ON 32
ci_034                 6.766314e-03 3 1  ON 33
ci_035                 6.233468e-03 3 1  ON 34
ci_036                 6.392739e-03 3 1  ON 35
ci_037                 6.887340e-03 3 1  ON 36
ci_038                 6.708489e-03 3 1  ON 37
ci_039                 6.158938e-03 3 1  ON 38
ci_040                 5.011955e-03 3 1  ON 39
ci_041                 5.195712e-03 3 1  ON 40
ci_042                 5.197514e-03 3 1  ON 41
ci_043                 5.852015e-03 3 1  ON 42
ci_044                 5.706770e-03 3 1  ON 43
ci_045                 5.509171e-03 3 1  ON 44
ci_046                 5.171273e-03 3 1  ON 45
ci_047                -3.904178e-03 3 1  ON 46
ci_048                -4.358194e-03 3 1  ON 47
ci_049                 3.745607e-03 3 1  ON 48
ci_050                 2.926439e-03 3 1  ON 49
ci_051                -2.402215e-03 3 1  ON 50
ci_052                -2.882115e-03 3 1  ON 51
ci_053                -2.264225e-03 3 1  ON 52
ci_054                -2.339632e-03 3 1  ON 53
ci_055                -1.446075e-03 3 1  ON 54
ci_056                -2.102983e-03 3 1  ON 55
ci_057                -2.263024e-03 3 1  ON 56
ci_058                -1.473602e-03 3 1  ON 57
ci_059                -1.892098e-03 3 1  ON 58
ci_060                -1.756464e-03 3 1  ON 59
ci_061                -2.248342e-03 3 1  ON 60
ci_062                -1.528546e-03 3 1  ON 61
ci_063                -7.063555e-04 3 1  ON 62
ci_064                -4.713109e-04 3 1  ON 63
ci_065                -9.613145e-04 3 1  ON 64
ci_066                -1.401861e-03 3 1  ON 65
ci_067                -1.043359e-03 3 1  ON 66
ci_068                -1.032186e-03 3 1  ON 67
ci_069                 1.768356e-03 3 1  ON 68
ci_070                 1.514914e-03 3 1  ON 69
ci_071                -1.945561e-03 3 1  ON 70
ci_072                -1.582167e-03 3 1  ON 71
ci_073                 1.076154e-03 3 1  ON 72
ci_074                 1.022570e-03 3 1  ON 73
ci_075                -1.086431e-03 3 1  ON 74
ci_076                -1.026437e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3883e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2271e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.4989
    reference variance = 2.56566
====================================================
  Execution time = 2.3498e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0323e+04
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.8573e+00
  Total weights = 1.949964372e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7764e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.911842523778
                                         uncertainty =       0.077606686495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.911842523778
                                         uncertainty =       0.077606686495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001398490526
  error estimate for blocks of size 2^( 2) =       0.001469156553
  error estimate for blocks of size 2^( 3) =       0.001533447327
  error estimate for blocks of size 2^( 4) =       0.001575916298
  error estimate for blocks of size 2^( 5) =       0.001596853126
  error estimate for blocks of size 2^( 6) =       0.001605643467
  error estimate for blocks of size 2^( 7) =       0.001611117477

      target function =                  N/A
              le_mean =     -22.325364080128
             les_mean =     502.279166903632
             stat err =       0.001597382592
             autocorr =       1.304664475486
              std dev =       1.977795913027
             le_variance =       3.911676673588


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232536408013e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325364079351       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325364822856       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325364820253       residual = 3.69e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+01 is 1.742178e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325364079351       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325364266428       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325364265648       residual = 3.91e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+01 is 4.390975e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325364079351       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325364126196       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325364125993       residual = 3.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+02 is 1.099989e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203098 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9281e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_001                -6.977689e-01 3 1  ON 0
ci_002                -7.024090e-01 3 1  ON 1
ci_003                -6.292858e-02 3 1  ON 2
ci_004                -6.104777e-02 3 1  ON 3
ci_005                 4.543343e-02 3 1  ON 4
ci_006                 4.549329e-02 3 1  ON 5
ci_007                 3.159005e-02 3 1  ON 6
ci_008                 3.178082e-02 3 1  ON 7
ci_009                -2.477460e-02 3 1  ON 8
ci_010                -2.512080e-02 3 1  ON 9
ci_011                -2.365828e-02 3 1  ON 10
ci_012                -2.275278e-02 3 1  ON 11
ci_013                 1.980512e-02 3 1  ON 12
ci_014                 1.995463e-02 3 1  ON 13
ci_015                 1.986135e-02 3 1  ON 14
ci_016                 2.110619e-02 3 1  ON 15
ci_017                 1.517306e-02 3 1  ON 16
ci_018                 1.509925e-02 3 1  ON 17
ci_019                 9.975376e-03 3 1  ON 18
ci_020                 9.865608e-03 3 1  ON 19
ci_021                -1.082717e-02 3 1  ON 20
ci_022                -1.078956e-02 3 1  ON 21
ci_023                 8.558094e-03 3 1  ON 22
ci_024                 8.989769e-03 3 1  ON 23
ci_025                 7.936286e-03 3 1  ON 24
ci_026                 8.648638e-03 3 1  ON 25
ci_027                 7.865263e-03 3 1  ON 26
ci_028                 7.330673e-03 3 1  ON 27
ci_029                -8.222678e-03 3 1  ON 28
ci_030                -7.926356e-03 3 1  ON 29
ci_031                -8.020046e-03 3 1  ON 30
ci_032                -7.257577e-03 3 1  ON 31
ci_033                 6.033683e-03 3 1  ON 32
ci_034                 6.767947e-03 3 1  ON 33
ci_035                 6.232775e-03 3 1  ON 34
ci_036                 6.393889e-03 3 1  ON 35
ci_037                 6.886130e-03 3 1  ON 36
ci_038                 6.707935e-03 3 1  ON 37
ci_039                 6.156825e-03 3 1  ON 38
ci_040                 5.016179e-03 3 1  ON 39
ci_041                 5.194865e-03 3 1  ON 40
ci_042                 5.194677e-03 3 1  ON 41
ci_043                 5.849631e-03 3 1  ON 42
ci_044                 5.704825e-03 3 1  ON 43
ci_045                 5.510503e-03 3 1  ON 44
ci_046                 5.170934e-03 3 1  ON 45
ci_047                -3.907036e-03 3 1  ON 46
ci_048                -4.357724e-03 3 1  ON 47
ci_049                 3.748968e-03 3 1  ON 48
ci_050                 2.925193e-03 3 1  ON 49
ci_051                -2.401694e-03 3 1  ON 50
ci_052                -2.882679e-03 3 1  ON 51
ci_053                -2.263750e-03 3 1  ON 52
ci_054                -2.340137e-03 3 1  ON 53
ci_055                -1.447024e-03 3 1  ON 54
ci_056                -2.102051e-03 3 1  ON 55
ci_057                -2.262591e-03 3 1  ON 56
ci_058                -1.473360e-03 3 1  ON 57
ci_059                -1.892909e-03 3 1  ON 58
ci_060                -1.760855e-03 3 1  ON 59
ci_061                -2.244434e-03 3 1  ON 60
ci_062                -1.527434e-03 3 1  ON 61
ci_063                -7.078580e-04 3 1  ON 62
ci_064                -4.736599e-04 3 1  ON 63
ci_065                -9.596913e-04 3 1  ON 64
ci_066                -1.400961e-03 3 1  ON 65
ci_067                -1.045752e-03 3 1  ON 66
ci_068                -1.031885e-03 3 1  ON 67
ci_069                 1.766373e-03 3 1  ON 68
ci_070                 1.513469e-03 3 1  ON 69
ci_071                -1.943167e-03 3 1  ON 70
ci_072                -1.581191e-03 3 1  ON 71
ci_073                 1.076426e-03 3 1  ON 72
ci_074                 1.025176e-03 3 1  ON 73
ci_075                -1.087673e-03 3 1  ON 74
ci_076                -1.025406e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.2827
    reference variance = 2.75336
====================================================
  Execution time = 2.5226e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7229e+00
  Total weights = 1.9497e+06
  Execution time = 4.3662e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776081058557
                                         uncertainty =       0.035593738028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776081058557
                                         uncertainty =       0.035593738028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373880379
  error estimate for blocks of size 2^( 2) =       0.001445423406
  error estimate for blocks of size 2^( 3) =       0.001509998082
  error estimate for blocks of size 2^( 4) =       0.001552614066
  error estimate for blocks of size 2^( 5) =       0.001575547545
  error estimate for blocks of size 2^( 6) =       0.001585165045
  error estimate for blocks of size 2^( 7) =       0.001580024763

      target function =                  N/A
              le_mean =     -22.329054223884
             les_mean =     502.309535862442
             stat err =       0.001573337855
             autocorr =       1.311433102414
              std dev =       1.942991351908
             le_variance =       3.775215393589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776082399911
                                         uncertainty =       0.035593797219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776082399911
                                         uncertainty =       0.035593797219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373880622
  error estimate for blocks of size 2^( 2) =       0.001445423366
  error estimate for blocks of size 2^( 3) =       0.001509997727
  error estimate for blocks of size 2^( 4) =       0.001552613662
  error estimate for blocks of size 2^( 5) =       0.001575546856
  error estimate for blocks of size 2^( 6) =       0.001585164829
  error estimate for blocks of size 2^( 7) =       0.001580024415

      target function =                  N/A
              le_mean =     -22.329054249709
             les_mean =     502.309543779272
             stat err =       0.001573337440
             autocorr =       1.311431947984
              std dev =       1.942991695324
             le_variance =       3.775216728099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776081726131
                                         uncertainty =       0.035593767808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776081726131
                                         uncertainty =       0.035593767808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373880500
  error estimate for blocks of size 2^( 2) =       0.001445423384
  error estimate for blocks of size 2^( 3) =       0.001509997902
  error estimate for blocks of size 2^( 4) =       0.001552613862
  error estimate for blocks of size 2^( 5) =       0.001575547197
  error estimate for blocks of size 2^( 6) =       0.001585164936
  error estimate for blocks of size 2^( 7) =       0.001580024589

      target function =                  N/A
              le_mean =     -22.329054235156
             les_mean =     502.309539453233
             stat err =       0.001573337646
             autocorr =       1.311432523586
              std dev =       1.942991522818
             le_variance =       3.775216057743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776081141316
                                         uncertainty =       0.035593741756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776081141316
                                         uncertainty =       0.035593741756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373880394
  error estimate for blocks of size 2^( 2) =       0.001445423403
  error estimate for blocks of size 2^( 3) =       0.001509998059
  error estimate for blocks of size 2^( 4) =       0.001552614040
  error estimate for blocks of size 2^( 5) =       0.001575547502
  error estimate for blocks of size 2^( 6) =       0.001585165031
  error estimate for blocks of size 2^( 7) =       0.001580024741

      target function =                  N/A
              le_mean =     -22.329054225095
             les_mean =     502.309536258533
             stat err =       0.001573337829
             autocorr =       1.311433030106
              std dev =       1.942991373095
             le_variance =       3.775215475921


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329054223884        initial
     2.3283e+01     2.3283e+02             1.7422e-05       -22.329054249709  <--
     9.3132e+01     9.3132e+02             4.3910e-06       -22.329054235156
     3.7253e+02     3.7253e+03             1.1000e-06       -22.329054225095

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 4.7045e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_001                -6.977649e-01 3 1  ON 0
ci_002                -7.024121e-01 3 1  ON 1
ci_003                -6.292261e-02 3 1  ON 2
ci_004                -6.105216e-02 3 1  ON 3
ci_005                 4.543922e-02 3 1  ON 4
ci_006                 4.549509e-02 3 1  ON 5
ci_007                 3.159020e-02 3 1  ON 6
ci_008                 3.177501e-02 3 1  ON 7
ci_009                -2.477891e-02 3 1  ON 8
ci_010                -2.511980e-02 3 1  ON 9
ci_011                -2.365475e-02 3 1  ON 10
ci_012                -2.275101e-02 3 1  ON 11
ci_013                 1.981250e-02 3 1  ON 12
ci_014                 1.996758e-02 3 1  ON 13
ci_015                 1.987253e-02 3 1  ON 14
ci_016                 2.110616e-02 3 1  ON 15
ci_017                 1.516917e-02 3 1  ON 16
ci_018                 1.510111e-02 3 1  ON 17
ci_019                 9.977961e-03 3 1  ON 18
ci_020                 9.865497e-03 3 1  ON 19
ci_021                -1.081801e-02 3 1  ON 20
ci_022                -1.078844e-02 3 1  ON 21
ci_023                 8.559039e-03 3 1  ON 22
ci_024                 8.991173e-03 3 1  ON 23
ci_025                 7.936242e-03 3 1  ON 24
ci_026                 8.648440e-03 3 1  ON 25
ci_027                 7.861482e-03 3 1  ON 26
ci_028                 7.341876e-03 3 1  ON 27
ci_029                -8.219283e-03 3 1  ON 28
ci_030                -7.928014e-03 3 1  ON 29
ci_031                -8.018766e-03 3 1  ON 30
ci_032                -7.254291e-03 3 1  ON 31
ci_033                 6.037733e-03 3 1  ON 32
ci_034                 6.772823e-03 3 1  ON 33
ci_035                 6.230714e-03 3 1  ON 34
ci_036                 6.397295e-03 3 1  ON 35
ci_037                 6.882536e-03 3 1  ON 36
ci_038                 6.706299e-03 3 1  ON 37
ci_039                 6.150566e-03 3 1  ON 38
ci_040                 5.028685e-03 3 1  ON 39
ci_041                 5.192350e-03 3 1  ON 40
ci_042                 5.186244e-03 3 1  ON 41
ci_043                 5.842538e-03 3 1  ON 42
ci_044                 5.699035e-03 3 1  ON 43
ci_045                 5.514460e-03 3 1  ON 44
ci_046                 5.169918e-03 3 1  ON 45
ci_047                -3.915501e-03 3 1  ON 46
ci_048                -4.356328e-03 3 1  ON 47
ci_049                 3.758980e-03 3 1  ON 48
ci_050                 2.921481e-03 3 1  ON 49
ci_051                -2.400150e-03 3 1  ON 50
ci_052                -2.884353e-03 3 1  ON 51
ci_053                -2.262332e-03 3 1  ON 52
ci_054                -2.341641e-03 3 1  ON 53
ci_055                -1.449854e-03 3 1  ON 54
ci_056                -2.099282e-03 3 1  ON 55
ci_057                -2.261307e-03 3 1  ON 56
ci_058                -1.472641e-03 3 1  ON 57
ci_059                -1.895320e-03 3 1  ON 58
ci_060                -1.773886e-03 3 1  ON 59
ci_061                -2.232806e-03 3 1  ON 60
ci_062                -1.524125e-03 3 1  ON 61
ci_063                -7.123259e-04 3 1  ON 62
ci_064                -4.806450e-04 3 1  ON 63
ci_065                -9.548663e-04 3 1  ON 64
ci_066                -1.398280e-03 3 1  ON 65
ci_067                -1.052880e-03 3 1  ON 66
ci_068                -1.030987e-03 3 1  ON 67
ci_069                 1.760468e-03 3 1  ON 68
ci_070                 1.509167e-03 3 1  ON 69
ci_071                -1.936046e-03 3 1  ON 70
ci_072                -1.578282e-03 3 1  ON 71
ci_073                 1.077229e-03 3 1  ON 72
ci_074                 1.032904e-03 3 1  ON 73
ci_075                -1.091365e-03 3 1  ON 74
ci_076                -1.022331e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6334e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2275e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -21.6204
    reference variance = 30.7459
====================================================
  Execution time = 2.3624e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0269e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6724e+00
  Total weights = 1.949538910e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8188e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.724729451434
                                         uncertainty =       0.023764657000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.724729451434
                                         uncertainty =       0.023764657000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364527517
  error estimate for blocks of size 2^( 2) =       0.001435685064
  error estimate for blocks of size 2^( 3) =       0.001498479507
  error estimate for blocks of size 2^( 4) =       0.001545488458
  error estimate for blocks of size 2^( 5) =       0.001571493100
  error estimate for blocks of size 2^( 6) =       0.001587566895
  error estimate for blocks of size 2^( 7) =       0.001601217627

      target function =                  N/A
              le_mean =     -22.328999371262
             les_mean =     502.256567220564
             stat err =       0.001576441520
             autocorr =       1.334722966410
              std dev =       1.929764195873
             le_variance =       3.723989851674


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232899937126e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328999370457       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329002216388       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329002181096       residual = 6.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+00 is 8.382990e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328999370457       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329000099075       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329000089340       residual = 6.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+01 is 2.172744e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328999370457       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328999553715       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328999551224       residual = 6.81e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+01 is 5.482294e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204288 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9450e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_001                -6.977609e-01 3 1  ON 0
ci_002                -7.024166e-01 3 1  ON 1
ci_003                -6.290930e-02 3 1  ON 2
ci_004                -6.105109e-02 3 1  ON 3
ci_005                 4.544340e-02 3 1  ON 4
ci_006                 4.550599e-02 3 1  ON 5
ci_007                 3.159137e-02 3 1  ON 6
ci_008                 3.177769e-02 3 1  ON 7
ci_009                -2.477339e-02 3 1  ON 8
ci_010                -2.511631e-02 3 1  ON 9
ci_011                -2.364981e-02 3 1  ON 10
ci_012                -2.274165e-02 3 1  ON 11
ci_013                 1.982527e-02 3 1  ON 12
ci_014                 1.996963e-02 3 1  ON 13
ci_015                 1.986611e-02 3 1  ON 14
ci_016                 2.110343e-02 3 1  ON 15
ci_017                 1.516725e-02 3 1  ON 16
ci_018                 1.510397e-02 3 1  ON 17
ci_019                 9.970670e-03 3 1  ON 18
ci_020                 9.869915e-03 3 1  ON 19
ci_021                -1.080454e-02 3 1  ON 20
ci_022                -1.079733e-02 3 1  ON 21
ci_023                 8.558536e-03 3 1  ON 22
ci_024                 8.981767e-03 3 1  ON 23
ci_025                 7.928711e-03 3 1  ON 24
ci_026                 8.657631e-03 3 1  ON 25
ci_027                 7.883209e-03 3 1  ON 26
ci_028                 7.354099e-03 3 1  ON 27
ci_029                -8.227741e-03 3 1  ON 28
ci_030                -7.919972e-03 3 1  ON 29
ci_031                -8.012835e-03 3 1  ON 30
ci_032                -7.252698e-03 3 1  ON 31
ci_033                 6.050076e-03 3 1  ON 32
ci_034                 6.775980e-03 3 1  ON 33
ci_035                 6.235546e-03 3 1  ON 34
ci_036                 6.391052e-03 3 1  ON 35
ci_037                 6.888048e-03 3 1  ON 36
ci_038                 6.712501e-03 3 1  ON 37
ci_039                 6.152141e-03 3 1  ON 38
ci_040                 5.034118e-03 3 1  ON 39
ci_041                 5.188039e-03 3 1  ON 40
ci_042                 5.179153e-03 3 1  ON 41
ci_043                 5.844251e-03 3 1  ON 42
ci_044                 5.699577e-03 3 1  ON 43
ci_045                 5.516174e-03 3 1  ON 44
ci_046                 5.161322e-03 3 1  ON 45
ci_047                -3.910369e-03 3 1  ON 46
ci_048                -4.360482e-03 3 1  ON 47
ci_049                 3.762441e-03 3 1  ON 48
ci_050                 2.922118e-03 3 1  ON 49
ci_051                -2.397868e-03 3 1  ON 50
ci_052                -2.887403e-03 3 1  ON 51
ci_053                -2.260609e-03 3 1  ON 52
ci_054                -2.337611e-03 3 1  ON 53
ci_055                -1.458730e-03 3 1  ON 54
ci_056                -2.106602e-03 3 1  ON 55
ci_057                -2.268624e-03 3 1  ON 56
ci_058                -1.472649e-03 3 1  ON 57
ci_059                -1.894626e-03 3 1  ON 58
ci_060                -1.780905e-03 3 1  ON 59
ci_061                -2.236032e-03 3 1  ON 60
ci_062                -1.527297e-03 3 1  ON 61
ci_063                -7.241520e-04 3 1  ON 62
ci_064                -4.817949e-04 3 1  ON 63
ci_065                -9.532309e-04 3 1  ON 64
ci_066                -1.404659e-03 3 1  ON 65
ci_067                -1.058541e-03 3 1  ON 66
ci_068                -1.030556e-03 3 1  ON 67
ci_069                 1.759198e-03 3 1  ON 68
ci_070                 1.497934e-03 3 1  ON 69
ci_071                -1.934503e-03 3 1  ON 70
ci_072                -1.586790e-03 3 1  ON 71
ci_073                 1.071740e-03 3 1  ON 72
ci_074                 1.030099e-03 3 1  ON 73
ci_075                -1.083024e-03 3 1  ON 74
ci_076                -1.027723e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.4205
    reference variance = 3.20105
====================================================
  Execution time = 2.2910e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7272e+00
  Total weights = 1.9498e+06
  Execution time = 4.3758e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779172619117
                                         uncertainty =       0.039219542057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779172619117
                                         uncertainty =       0.039219542057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374530617
  error estimate for blocks of size 2^( 2) =       0.001444887598
  error estimate for blocks of size 2^( 3) =       0.001508256600
  error estimate for blocks of size 2^( 4) =       0.001551632756
  error estimate for blocks of size 2^( 5) =       0.001577539730
  error estimate for blocks of size 2^( 6) =       0.001590822415
  error estimate for blocks of size 2^( 7) =       0.001596392544

      target function =                  N/A
              le_mean =     -22.327950268807
             les_mean =     502.264583065153
             stat err =       0.001579096861
             autocorr =       1.319801764268
              std dev =       1.943910942577
             le_variance =       3.778789752672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779167555484
                                         uncertainty =       0.039219399764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779167555484
                                         uncertainty =       0.039219399764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374529661
  error estimate for blocks of size 2^( 2) =       0.001444886087
  error estimate for blocks of size 2^( 3) =       0.001508254385
  error estimate for blocks of size 2^( 4) =       0.001551630026
  error estimate for blocks of size 2^( 5) =       0.001577536476
  error estimate for blocks of size 2^( 6) =       0.001590819800
  error estimate for blocks of size 2^( 7) =       0.001596389749

      target function =                  N/A
              le_mean =     -22.327951007409
             les_mean =     502.267224120518
             stat err =       0.001579094013
             autocorr =       1.319798838549
              std dev =       1.943909590595
             le_variance =       3.778784496406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779169924803
                                         uncertainty =       0.039219470367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779169924803
                                         uncertainty =       0.039219470367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374530109
  error estimate for blocks of size 2^( 2) =       0.001444886797
  error estimate for blocks of size 2^( 3) =       0.001508255431
  error estimate for blocks of size 2^( 4) =       0.001551631363
  error estimate for blocks of size 2^( 5) =       0.001577538097
  error estimate for blocks of size 2^( 6) =       0.001590821032
  error estimate for blocks of size 2^( 7) =       0.001596390836

      target function =                  N/A
              le_mean =     -22.327950574462
             les_mean =     502.267185890061
             stat err =       0.001579095332
             autocorr =       1.319800182774
              std dev =       1.943910224057
             le_variance =       3.778786959194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779172267035
                                         uncertainty =       0.039219533073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779172267035
                                         uncertainty =       0.039219533073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374530551
  error estimate for blocks of size 2^( 2) =       0.001444887493
  error estimate for blocks of size 2^( 3) =       0.001508256448
  error estimate for blocks of size 2^( 4) =       0.001551632571
  error estimate for blocks of size 2^( 5) =       0.001577539510
  error estimate for blocks of size 2^( 6) =       0.001590822226
  error estimate for blocks of size 2^( 7) =       0.001596392329

      target function =                  N/A
              le_mean =     -22.327950307107
             les_mean =     502.264585163941
             stat err =       0.001579096659
             autocorr =       1.319801553230
              std dev =       1.943910848806
             le_variance =       3.778789388106


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327950268807        initial
     5.8208e+00     5.8208e+01             8.3830e-05       -22.327951007409  <--
     2.3283e+01     2.3283e+02             2.1727e-05       -22.327950574462
     9.3132e+01     9.3132e+02             5.4823e-06       -22.327950307107

*****************************************************************************
Applying the update for shift_i =   5.8208e+00     and shift_s =   5.8208e+01
*****************************************************************************

  Execution time = 4.4760e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_001                -6.977488e-01 3 1  ON 0
ci_002                -7.024299e-01 3 1  ON 1
ci_003                -6.286978e-02 3 1  ON 2
ci_004                -6.104794e-02 3 1  ON 3
ci_005                 4.545535e-02 3 1  ON 4
ci_006                 4.553738e-02 3 1  ON 5
ci_007                 3.159470e-02 3 1  ON 6
ci_008                 3.178565e-02 3 1  ON 7
ci_009                -2.475738e-02 3 1  ON 8
ci_010                -2.510605e-02 3 1  ON 9
ci_011                -2.363530e-02 3 1  ON 10
ci_012                -2.271434e-02 3 1  ON 11
ci_013                 1.986267e-02 3 1  ON 12
ci_014                 1.997575e-02 3 1  ON 13
ci_015                 1.984722e-02 3 1  ON 14
ci_016                 2.109548e-02 3 1  ON 15
ci_017                 1.516173e-02 3 1  ON 16
ci_018                 1.511237e-02 3 1  ON 17
ci_019                 9.949234e-03 3 1  ON 18
ci_020                 9.882942e-03 3 1  ON 19
ci_021                -1.076497e-02 3 1  ON 20
ci_022                -1.082346e-02 3 1  ON 21
ci_023                 8.556973e-03 3 1  ON 22
ci_024                 8.954375e-03 3 1  ON 23
ci_025                 7.906729e-03 3 1  ON 24
ci_026                 8.684510e-03 3 1  ON 25
ci_027                 7.945312e-03 3 1  ON 26
ci_028                 7.389040e-03 3 1  ON 27
ci_029                -8.252398e-03 3 1  ON 28
ci_030                -7.896382e-03 3 1  ON 29
ci_031                -7.995554e-03 3 1  ON 30
ci_032                -7.248036e-03 3 1  ON 31
ci_033                 6.086131e-03 3 1  ON 32
ci_034                 6.785282e-03 3 1  ON 33
ci_035                 6.249217e-03 3 1  ON 34
ci_036                 6.373145e-03 3 1  ON 35
ci_037                 6.904192e-03 3 1  ON 36
ci_038                 6.730579e-03 3 1  ON 37
ci_039                 6.156515e-03 3 1  ON 38
ci_040                 5.049680e-03 3 1  ON 39
ci_041                 5.175550e-03 3 1  ON 40
ci_042                 5.158620e-03 3 1  ON 41
ci_043                 5.849043e-03 3 1  ON 42
ci_044                 5.701113e-03 3 1  ON 43
ci_045                 5.521004e-03 3 1  ON 44
ci_046                 5.136301e-03 3 1  ON 45
ci_047                -3.895640e-03 3 1  ON 46
ci_048                -4.372436e-03 3 1  ON 47
ci_049                 3.772542e-03 3 1  ON 48
ci_050                 2.924012e-03 3 1  ON 49
ci_051                -2.391211e-03 3 1  ON 50
ci_052                -2.896249e-03 3 1  ON 51
ci_053                -2.255541e-03 3 1  ON 52
ci_054                -2.325888e-03 3 1  ON 53
ci_055                -1.484678e-03 3 1  ON 54
ci_056                -2.128039e-03 3 1  ON 55
ci_057                -2.289854e-03 3 1  ON 56
ci_058                -1.472634e-03 3 1  ON 57
ci_059                -1.892653e-03 3 1  ON 58
ci_060                -1.800958e-03 3 1  ON 59
ci_061                -2.245284e-03 3 1  ON 60
ci_062                -1.536439e-03 3 1  ON 61
ci_063                -7.585460e-04 3 1  ON 62
ci_064                -4.851800e-04 3 1  ON 63
ci_065                -9.483864e-04 3 1  ON 64
ci_066                -1.423166e-03 3 1  ON 65
ci_067                -1.074987e-03 3 1  ON 66
ci_068                -1.029265e-03 3 1  ON 67
ci_069                 1.755488e-03 3 1  ON 68
ci_070                 1.465234e-03 3 1  ON 69
ci_071                -1.930048e-03 3 1  ON 70
ci_072                -1.611518e-03 3 1  ON 71
ci_073                 1.056188e-03 3 1  ON 72
ci_074                 1.022141e-03 3 1  ON 73
ci_075                -1.058860e-03 3 1  ON 74
ci_076                -1.043347e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4218e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2268e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.4617
    reference variance = 2.91376
====================================================
  Execution time = 2.3472e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0344e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8505e+00
  Total weights = 1.949762234e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9169e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.905329685288
                                         uncertainty =       0.167311586475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.905329685288
                                         uncertainty =       0.167311586475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001397415365
  error estimate for blocks of size 2^( 2) =       0.001467797537
  error estimate for blocks of size 2^( 3) =       0.001528995586
  error estimate for blocks of size 2^( 4) =       0.001572261985
  error estimate for blocks of size 2^( 5) =       0.001596476597
  error estimate for blocks of size 2^( 6) =       0.001609986511
  error estimate for blocks of size 2^( 7) =       0.001623202102

      target function =                  N/A
              le_mean =     -22.327537806177
             les_mean =     502.369400443184
             stat err =       0.001600481799
             autocorr =       1.311748120982
              std dev =       1.976275381285
             le_variance =       3.905664382671


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232753780618e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327537805353       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327553394072       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327553435101       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+00 is 3.102467e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327537805353       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327542060515       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327542060510       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+00 is 8.321985e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327537805353       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327538894147       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327538893617       residual = 1.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+01 is 2.119214e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205476 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9395e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_001                -6.977695e-01 3 1  ON 0
ci_002                -7.024107e-01 3 1  ON 1
ci_003                -6.286389e-02 3 1  ON 2
ci_004                -6.102440e-02 3 1  ON 3
ci_005                 4.546237e-02 3 1  ON 4
ci_006                 4.556368e-02 3 1  ON 5
ci_007                 3.159163e-02 3 1  ON 6
ci_008                 3.171157e-02 3 1  ON 7
ci_009                -2.477637e-02 3 1  ON 8
ci_010                -2.508956e-02 3 1  ON 9
ci_011                -2.361537e-02 3 1  ON 10
ci_012                -2.269508e-02 3 1  ON 11
ci_013                 1.984150e-02 3 1  ON 12
ci_014                 2.001756e-02 3 1  ON 13
ci_015                 1.988497e-02 3 1  ON 14
ci_016                 2.111046e-02 3 1  ON 15
ci_017                 1.519964e-02 3 1  ON 16
ci_018                 1.511505e-02 3 1  ON 17
ci_019                 9.954349e-03 3 1  ON 18
ci_020                 9.891726e-03 3 1  ON 19
ci_021                -1.075717e-02 3 1  ON 20
ci_022                -1.082685e-02 3 1  ON 21
ci_023                 8.508845e-03 3 1  ON 22
ci_024                 8.931606e-03 3 1  ON 23
ci_025                 7.989949e-03 3 1  ON 24
ci_026                 8.630874e-03 3 1  ON 25
ci_027                 7.960517e-03 3 1  ON 26
ci_028                 7.418005e-03 3 1  ON 27
ci_029                -8.205200e-03 3 1  ON 28
ci_030                -7.902946e-03 3 1  ON 29
ci_031                -8.016859e-03 3 1  ON 30
ci_032                -7.237472e-03 3 1  ON 31
ci_033                 6.131001e-03 3 1  ON 32
ci_034                 6.834313e-03 3 1  ON 33
ci_035                 6.273718e-03 3 1  ON 34
ci_036                 6.355267e-03 3 1  ON 35
ci_037                 6.898798e-03 3 1  ON 36
ci_038                 6.700413e-03 3 1  ON 37
ci_039                 6.184668e-03 3 1  ON 38
ci_040                 5.081276e-03 3 1  ON 39
ci_041                 5.188907e-03 3 1  ON 40
ci_042                 5.171271e-03 3 1  ON 41
ci_043                 5.784155e-03 3 1  ON 42
ci_044                 5.696887e-03 3 1  ON 43
ci_045                 5.537882e-03 3 1  ON 44
ci_046                 5.118285e-03 3 1  ON 45
ci_047                -3.934698e-03 3 1  ON 46
ci_048                -4.366520e-03 3 1  ON 47
ci_049                 3.797190e-03 3 1  ON 48
ci_050                 2.980626e-03 3 1  ON 49
ci_051                -2.371756e-03 3 1  ON 50
ci_052                -2.866920e-03 3 1  ON 51
ci_053                -2.274669e-03 3 1  ON 52
ci_054                -2.337177e-03 3 1  ON 53
ci_055                -1.544981e-03 3 1  ON 54
ci_056                -2.124199e-03 3 1  ON 55
ci_057                -2.231472e-03 3 1  ON 56
ci_058                -1.442908e-03 3 1  ON 57
ci_059                -1.913142e-03 3 1  ON 58
ci_060                -1.797032e-03 3 1  ON 59
ci_061                -2.213800e-03 3 1  ON 60
ci_062                -1.596534e-03 3 1  ON 61
ci_063                -7.554850e-04 3 1  ON 62
ci_064                -5.213800e-04 3 1  ON 63
ci_065                -9.763811e-04 3 1  ON 64
ci_066                -1.406125e-03 3 1  ON 65
ci_067                -1.087386e-03 3 1  ON 66
ci_068                -1.027906e-03 3 1  ON 67
ci_069                 1.731516e-03 3 1  ON 68
ci_070                 1.477416e-03 3 1  ON 69
ci_071                -1.934020e-03 3 1  ON 70
ci_072                -1.583885e-03 3 1  ON 71
ci_073                 1.037552e-03 3 1  ON 72
ci_074                 1.069374e-03 3 1  ON 73
ci_075                -1.057863e-03 3 1  ON 74
ci_076                -1.046822e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.3118
    reference variance = 2.69278
====================================================
  Execution time = 2.3584e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7387e+00
  Total weights = 1.9499e+06
  Execution time = 4.3605e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790763215986
                                         uncertainty =       0.033938581839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790763215986
                                         uncertainty =       0.033938581839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376524302
  error estimate for blocks of size 2^( 2) =       0.001447464438
  error estimate for blocks of size 2^( 3) =       0.001509980873
  error estimate for blocks of size 2^( 4) =       0.001555535750
  error estimate for blocks of size 2^( 5) =       0.001583170640
  error estimate for blocks of size 2^( 6) =       0.001593896153
  error estimate for blocks of size 2^( 7) =       0.001605460991

      target function =                  N/A
              le_mean =     -22.327400982901
             les_mean =     502.253931920571
             stat err =       0.001584515883
             autocorr =       1.325029135484
              std dev =       1.946730483474
             le_variance =       3.789759575285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790766563328
                                         uncertainty =       0.033939156621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790766563328
                                         uncertainty =       0.033939156621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376524969
  error estimate for blocks of size 2^( 2) =       0.001447462340
  error estimate for blocks of size 2^( 3) =       0.001509978186
  error estimate for blocks of size 2^( 4) =       0.001555529956
  error estimate for blocks of size 2^( 5) =       0.001583168825
  error estimate for blocks of size 2^( 6) =       0.001593898415
  error estimate for blocks of size 2^( 7) =       0.001605470138

      target function =                  N/A
              le_mean =     -22.327401084031
             les_mean =     502.251740433520
             stat err =       0.001584516834
             autocorr =       1.325029440375
              std dev =       1.946731427044
             le_variance =       3.789763249041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790763729376
                                         uncertainty =       0.033938913085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790763729376
                                         uncertainty =       0.033938913085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376524427
  error estimate for blocks of size 2^( 2) =       0.001447463000
  error estimate for blocks of size 2^( 3) =       0.001509978855
  error estimate for blocks of size 2^( 4) =       0.001555532094
  error estimate for blocks of size 2^( 5) =       0.001583169182
  error estimate for blocks of size 2^( 6) =       0.001593897478
  error estimate for blocks of size 2^( 7) =       0.001605465699

      target function =                  N/A
              le_mean =     -22.327400611993
             les_mean =     502.252229560421
             stat err =       0.001584516113
             autocorr =       1.325029278744
              std dev =       1.946730660513
             le_variance =       3.789760264582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790763011068
                                         uncertainty =       0.033938630017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790763011068
                                         uncertainty =       0.033938630017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376524269
  error estimate for blocks of size 2^( 2) =       0.001447464164
  error estimate for blocks of size 2^( 3) =       0.001509980414
  error estimate for blocks of size 2^( 4) =       0.001555535082
  error estimate for blocks of size 2^( 5) =       0.001583170123
  error estimate for blocks of size 2^( 6) =       0.001593896101
  error estimate for blocks of size 2^( 7) =       0.001605461697

      target function =                  N/A
              le_mean =     -22.327400971572
             les_mean =     502.251577776136
             stat err =       0.001584515751
             autocorr =       1.325028977302
              std dev =       1.946730436683
             le_variance =       3.789759393108


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327400982901        initial
     1.4552e+00     1.4552e+01             3.1025e-04       -22.327401084031  <--
     5.8208e+00     5.8208e+01             8.3220e-05       -22.327400611993
     2.3283e+01     2.3283e+02             2.1192e-05       -22.327400971572

*****************************************************************************
Applying the update for shift_i =   1.4552e+00     and shift_s =   1.4552e+01
*****************************************************************************

  Execution time = 4.5373e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_001                -6.978314e-01 3 1  ON 0
ci_002                -7.023536e-01 3 1  ON 1
ci_003                -6.284837e-02 3 1  ON 2
ci_004                -6.095731e-02 3 1  ON 3
ci_005                 4.548215e-02 3 1  ON 4
ci_006                 4.563193e-02 3 1  ON 5
ci_007                 3.158328e-02 3 1  ON 6
ci_008                 3.150950e-02 3 1  ON 7
ci_009                -2.482912e-02 3 1  ON 8
ci_010                -2.504690e-02 3 1  ON 9
ci_011                -2.355935e-02 3 1  ON 10
ci_012                -2.264037e-02 3 1  ON 11
ci_013                 1.978499e-02 3 1  ON 12
ci_014                 2.013054e-02 3 1  ON 13
ci_015                 1.998949e-02 3 1  ON 14
ci_016                 2.115123e-02 3 1  ON 15
ci_017                 1.530219e-02 3 1  ON 16
ci_018                 1.512322e-02 3 1  ON 17
ci_019                 9.964642e-03 3 1  ON 18
ci_020                 9.917624e-03 3 1  ON 19
ci_021                -1.073499e-02 3 1  ON 20
ci_022                -1.083629e-02 3 1  ON 21
ci_023                 8.381605e-03 3 1  ON 22
ci_024                 8.870013e-03 3 1  ON 23
ci_025                 8.216976e-03 3 1  ON 24
ci_026                 8.484102e-03 3 1  ON 25
ci_027                 7.999237e-03 3 1  ON 26
ci_028                 7.490474e-03 3 1  ON 27
ci_029                -8.079222e-03 3 1  ON 28
ci_030                -7.920736e-03 3 1  ON 29
ci_031                -8.077254e-03 3 1  ON 30
ci_032                -7.209135e-03 3 1  ON 31
ci_033                 6.252065e-03 3 1  ON 32
ci_034                 6.969018e-03 3 1  ON 33
ci_035                 6.332921e-03 3 1  ON 34
ci_036                 6.310063e-03 3 1  ON 35
ci_037                 6.885959e-03 3 1  ON 36
ci_038                 6.620577e-03 3 1  ON 37
ci_039                 6.254561e-03 3 1  ON 38
ci_040                 5.159576e-03 3 1  ON 39
ci_041                 5.222617e-03 3 1  ON 40
ci_042                 5.203015e-03 3 1  ON 41
ci_043                 5.613183e-03 3 1  ON 42
ci_044                 5.688045e-03 3 1  ON 43
ci_045                 5.580926e-03 3 1  ON 44
ci_046                 5.068909e-03 3 1  ON 45
ci_047                -4.032559e-03 3 1  ON 46
ci_048                -4.350151e-03 3 1  ON 47
ci_049                 3.863909e-03 3 1  ON 48
ci_050                 3.133236e-03 3 1  ON 49
ci_051                -2.320077e-03 3 1  ON 50
ci_052                -2.786318e-03 3 1  ON 51
ci_053                -2.327878e-03 3 1  ON 52
ci_054                -2.368435e-03 3 1  ON 53
ci_055                -1.707680e-03 3 1  ON 54
ci_056                -2.115227e-03 3 1  ON 55
ci_057                -2.077704e-03 3 1  ON 56
ci_058                -1.364691e-03 3 1  ON 57
ci_059                -1.963273e-03 3 1  ON 58
ci_060                -1.788355e-03 3 1  ON 59
ci_061                -2.129456e-03 3 1  ON 60
ci_062                -1.750473e-03 3 1  ON 61
ci_063                -7.482178e-04 3 1  ON 62
ci_064                -6.166526e-04 3 1  ON 63
ci_065                -1.053194e-03 3 1  ON 64
ci_066                -1.360245e-03 3 1  ON 65
ci_067                -1.121079e-03 3 1  ON 66
ci_068                -1.023896e-03 3 1  ON 67
ci_069                 1.666466e-03 3 1  ON 68
ci_070                 1.509835e-03 3 1  ON 69
ci_071                -1.944527e-03 3 1  ON 70
ci_072                -1.510152e-03 3 1  ON 71
ci_073                 9.885392e-04 3 1  ON 72
ci_074                 1.185537e-03 3 1  ON 73
ci_075                -1.052557e-03 3 1  ON 74
ci_076                -1.054476e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4776e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2271e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.5982
    reference variance = 2.21563
====================================================
  Execution time = 2.3485e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0333e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8621e+00
  Total weights = 1.949885005e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8368e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.917781038574
                                         uncertainty =       0.113405734202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.917781038574
                                         uncertainty =       0.113405734202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001399456583
  error estimate for blocks of size 2^( 2) =       0.001469707822
  error estimate for blocks of size 2^( 3) =       0.001531094101
  error estimate for blocks of size 2^( 4) =       0.001575033147
  error estimate for blocks of size 2^( 5) =       0.001598875660
  error estimate for blocks of size 2^( 6) =       0.001610486577
  error estimate for blocks of size 2^( 7) =       0.001617074765

      target function =                  N/A
              le_mean =     -22.327540067651
             les_mean =     502.381183086354
             stat err =       0.001600367537
             autocorr =       1.307737591717
              std dev =       1.979162145075
             le_variance =       3.917082796497


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232754006765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327540066847       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327572520231       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327573872284       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327573922138       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e-01 is 1.054271e-03

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327540066847       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327551474133       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327551570604       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+00 is 3.970765e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327540066847       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327543240815       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327543239871       residual = 2.89e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+00 is 1.134771e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206815 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9329e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_001                -6.978031e-01 3 1  ON 0
ci_002                -7.023536e-01 3 1  ON 1
ci_003                -6.297731e-02 3 1  ON 2
ci_004                -6.095014e-02 3 1  ON 3
ci_005                 4.561716e-02 3 1  ON 4
ci_006                 4.566463e-02 3 1  ON 5
ci_007                 3.160000e-02 3 1  ON 6
ci_008                 3.160138e-02 3 1  ON 7
ci_009                -2.480191e-02 3 1  ON 8
ci_010                -2.500906e-02 3 1  ON 9
ci_011                -2.342685e-02 3 1  ON 10
ci_012                -2.264762e-02 3 1  ON 11
ci_013                 1.973924e-02 3 1  ON 12
ci_014                 2.022725e-02 3 1  ON 13
ci_015                 1.988495e-02 3 1  ON 14
ci_016                 2.113726e-02 3 1  ON 15
ci_017                 1.534229e-02 3 1  ON 16
ci_018                 1.514103e-02 3 1  ON 17
ci_019                 9.985053e-03 3 1  ON 18
ci_020                 9.916515e-03 3 1  ON 19
ci_021                -1.076096e-02 3 1  ON 20
ci_022                -1.091663e-02 3 1  ON 21
ci_023                 8.412248e-03 3 1  ON 22
ci_024                 8.881405e-03 3 1  ON 23
ci_025                 8.188669e-03 3 1  ON 24
ci_026                 8.501537e-03 3 1  ON 25
ci_027                 8.089915e-03 3 1  ON 26
ci_028                 7.704886e-03 3 1  ON 27
ci_029                -8.037598e-03 3 1  ON 28
ci_030                -7.874818e-03 3 1  ON 29
ci_031                -8.105314e-03 3 1  ON 30
ci_032                -7.352635e-03 3 1  ON 31
ci_033                 6.162983e-03 3 1  ON 32
ci_034                 6.942660e-03 3 1  ON 33
ci_035                 6.357344e-03 3 1  ON 34
ci_036                 6.462253e-03 3 1  ON 35
ci_037                 6.799167e-03 3 1  ON 36
ci_038                 6.525362e-03 3 1  ON 37
ci_039                 6.310914e-03 3 1  ON 38
ci_040                 5.556653e-03 3 1  ON 39
ci_041                 5.324140e-03 3 1  ON 40
ci_042                 5.092873e-03 3 1  ON 41
ci_043                 5.598412e-03 3 1  ON 42
ci_044                 5.529207e-03 3 1  ON 43
ci_045                 5.631268e-03 3 1  ON 44
ci_046                 5.106140e-03 3 1  ON 45
ci_047                -3.936952e-03 3 1  ON 46
ci_048                -4.253981e-03 3 1  ON 47
ci_049                 3.824363e-03 3 1  ON 48
ci_050                 3.378547e-03 3 1  ON 49
ci_051                -2.283897e-03 3 1  ON 50
ci_052                -2.718499e-03 3 1  ON 51
ci_053                -2.315655e-03 3 1  ON 52
ci_054                -2.492892e-03 3 1  ON 53
ci_055                -1.899766e-03 3 1  ON 54
ci_056                -2.308074e-03 3 1  ON 55
ci_057                -2.078453e-03 3 1  ON 56
ci_058                -1.424600e-03 3 1  ON 57
ci_059                -2.153949e-03 3 1  ON 58
ci_060                -1.713088e-03 3 1  ON 59
ci_061                -2.151865e-03 3 1  ON 60
ci_062                -1.754895e-03 3 1  ON 61
ci_063                -8.427615e-04 3 1  ON 62
ci_064                -7.404799e-04 3 1  ON 63
ci_065                -1.001406e-03 3 1  ON 64
ci_066                -1.253054e-03 3 1  ON 65
ci_067                -1.182982e-03 3 1  ON 66
ci_068                -1.043204e-03 3 1  ON 67
ci_069                 1.665372e-03 3 1  ON 68
ci_070                 1.393082e-03 3 1  ON 69
ci_071                -1.834186e-03 3 1  ON 70
ci_072                -1.406646e-03 3 1  ON 71
ci_073                 1.057044e-03 3 1  ON 72
ci_074                 1.346559e-03 3 1  ON 73
ci_075                -8.744348e-04 3 1  ON 74
ci_076                -1.132717e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.3486
    reference variance = 2.12748
====================================================
  Execution time = 2.2907e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7457e+00
  Total weights = 1.9499e+06
  Execution time = 4.3568e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0353838
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.791780213900
                                         uncertainty =       0.058443954335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.791780213900
                                         uncertainty =       0.058443954335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377654191
  error estimate for blocks of size 2^( 2) =       0.001448359127
  error estimate for blocks of size 2^( 3) =       0.001510594964
  error estimate for blocks of size 2^( 4) =       0.001554508889
  error estimate for blocks of size 2^( 5) =       0.001576158329
  error estimate for blocks of size 2^( 6) =       0.001590027764
  error estimate for blocks of size 2^( 7) =       0.001605125658

      target function =                  N/A
              le_mean =     -22.328076699290
             les_mean =     502.288974979036
             stat err =       0.001581455160
             autocorr =       1.317750924187
              std dev =       1.948328414131
             le_variance =       3.795983609311

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00191622
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.791889717141
                                         uncertainty =       0.058444448327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.791889717141
                                         uncertainty =       0.058444448327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377674116
  error estimate for blocks of size 2^( 2) =       0.001448368704
  error estimate for blocks of size 2^( 3) =       0.001510590303
  error estimate for blocks of size 2^( 4) =       0.001554486596
  error estimate for blocks of size 2^( 5) =       0.001576117684
  error estimate for blocks of size 2^( 6) =       0.001589992132
  error estimate for blocks of size 2^( 7) =       0.001605095900

      target function =                  N/A
              le_mean =     -22.328085093094
             les_mean =     502.327701088670
             stat err =       0.001581423078
             autocorr =       1.317659345357
              std dev =       1.948356592821
             le_variance =       3.796093412790

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0363887
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.791829869471
                                         uncertainty =       0.058444491171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.791829869471
                                         uncertainty =       0.058444491171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377663255
  error estimate for blocks of size 2^( 2) =       0.001448360876
  error estimate for blocks of size 2^( 3) =       0.001510586628
  error estimate for blocks of size 2^( 4) =       0.001554488957
  error estimate for blocks of size 2^( 5) =       0.001576121692
  error estimate for blocks of size 2^( 6) =       0.001589994786
  error estimate for blocks of size 2^( 7) =       0.001605094343

      target function =                  N/A
              le_mean =     -22.328076602068
             les_mean =     502.292312960436
             stat err =       0.001581424945
             autocorr =       1.317683232127
              std dev =       1.948341232697
             le_variance =       3.796033559027

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.117559
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.791800286968
                                         uncertainty =       0.058443428703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.791800286968
                                         uncertainty =       0.058443428703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377657838
  error estimate for blocks of size 2^( 2) =       0.001448363092
  error estimate for blocks of size 2^( 3) =       0.001510597816
  error estimate for blocks of size 2^( 4) =       0.001554508714
  error estimate for blocks of size 2^( 5) =       0.001576152185
  error estimate for blocks of size 2^( 6) =       0.001590030710
  error estimate for blocks of size 2^( 7) =       0.001605123293

      target function =                  N/A
              le_mean =     -22.328075289406
             les_mean =     502.386676238864
             stat err =       0.001581453725
             autocorr =       1.317741557630
              std dev =       1.948333571318
             le_variance =       3.796003705125


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328076699290        initial
     3.6380e-01     3.6380e+00             1.0543e-03       -22.328085093094  <--
     1.4552e+00     1.4552e+01             3.9708e-04       -22.328076602068
     5.8208e+00     5.8208e+01             1.1348e-04       -22.328075289406

*****************************************************************************
Applying the update for shift_i =   3.6380e-01     and shift_s =   3.6380e+00
*****************************************************************************

  Execution time = 4.4754e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_001                -6.977307e-01 3 1  ON 0
ci_002                -7.023714e-01 3 1  ON 1
ci_003                -6.332042e-02 3 1  ON 2
ci_004                -6.094317e-02 3 1  ON 3
ci_005                 4.585543e-02 3 1  ON 4
ci_006                 4.571486e-02 3 1  ON 5
ci_007                 3.161835e-02 3 1  ON 6
ci_008                 3.178275e-02 3 1  ON 7
ci_009                -2.472342e-02 3 1  ON 8
ci_010                -2.491438e-02 3 1  ON 9
ci_011                -2.315173e-02 3 1  ON 10
ci_012                -2.262546e-02 3 1  ON 11
ci_013                 1.963927e-02 3 1  ON 12
ci_014                 2.041975e-02 3 1  ON 13
ci_015                 1.963786e-02 3 1  ON 14
ci_016                 2.109447e-02 3 1  ON 15
ci_017                 1.542740e-02 3 1  ON 16
ci_018                 1.518694e-02 3 1  ON 17
ci_019                 1.004589e-02 3 1  ON 18
ci_020                 9.919845e-03 3 1  ON 19
ci_021                -1.081201e-02 3 1  ON 20
ci_022                -1.108601e-02 3 1  ON 21
ci_023                 8.464289e-03 3 1  ON 22
ci_024                 8.895574e-03 3 1  ON 23
ci_025                 8.128206e-03 3 1  ON 24
ci_026                 8.547689e-03 3 1  ON 25
ci_027                 8.233900e-03 3 1  ON 26
ci_028                 8.054790e-03 3 1  ON 27
ci_029                -7.951337e-03 3 1  ON 28
ci_030                -7.783517e-03 3 1  ON 29
ci_031                -8.160480e-03 3 1  ON 30
ci_032                -7.663299e-03 3 1  ON 31
ci_033                 5.969991e-03 3 1  ON 32
ci_034                 6.884045e-03 3 1  ON 33
ci_035                 6.402861e-03 3 1  ON 34
ci_036                 6.722958e-03 3 1  ON 35
ci_037                 6.621356e-03 3 1  ON 36
ci_038                 6.344683e-03 3 1  ON 37
ci_039                 6.396146e-03 3 1  ON 38
ci_040                 6.213847e-03 3 1  ON 39
ci_041                 5.507929e-03 3 1  ON 40
ci_042                 4.885561e-03 3 1  ON 41
ci_043                 5.549106e-03 3 1  ON 42
ci_044                 5.230967e-03 3 1  ON 43
ci_045                 5.739587e-03 3 1  ON 44
ci_046                 5.182792e-03 3 1  ON 45
ci_047                -3.780426e-03 3 1  ON 46
ci_048                -4.091222e-03 3 1  ON 47
ci_049                 3.739849e-03 3 1  ON 48
ci_050                 3.895399e-03 3 1  ON 49
ci_051                -2.219721e-03 3 1  ON 50
ci_052                -2.596423e-03 3 1  ON 51
ci_053                -2.299476e-03 3 1  ON 52
ci_054                -2.740690e-03 3 1  ON 53
ci_055                -2.322120e-03 3 1  ON 54
ci_056                -2.730171e-03 3 1  ON 55
ci_057                -2.085032e-03 3 1  ON 56
ci_058                -1.544977e-03 3 1  ON 57
ci_059                -2.470734e-03 3 1  ON 58
ci_060                -1.590452e-03 3 1  ON 59
ci_061                -2.187835e-03 3 1  ON 60
ci_062                -1.753521e-03 3 1  ON 61
ci_063                -1.036690e-03 3 1  ON 62
ci_064                -9.881987e-04 3 1  ON 63
ci_065                -9.078659e-04 3 1  ON 64
ci_066                -1.045028e-03 3 1  ON 65
ci_067                -1.289522e-03 3 1  ON 66
ci_068                -1.066296e-03 3 1  ON 67
ci_069                 1.658661e-03 3 1  ON 68
ci_070                 1.160512e-03 3 1  ON 69
ci_071                -1.620979e-03 3 1  ON 70
ci_072                -1.209407e-03 3 1  ON 71
ci_073                 1.178847e-03 3 1  ON 72
ci_074                 1.608278e-03 3 1  ON 73
ci_075                -5.217162e-04 3 1  ON 74
ci_076                -1.279730e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4095e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2276e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.3693
    reference variance = 3.87727
====================================================
  Execution time = 2.3439e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0310e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7096e+00
  Total weights = 1.949766889e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8266e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758484750899
                                         uncertainty =       0.067583459236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758484750899
                                         uncertainty =       0.067583459236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371232253
  error estimate for blocks of size 2^( 2) =       0.001440865614
  error estimate for blocks of size 2^( 3) =       0.001502356744
  error estimate for blocks of size 2^( 4) =       0.001543464406
  error estimate for blocks of size 2^( 5) =       0.001569328463
  error estimate for blocks of size 2^( 6) =       0.001582037745
  error estimate for blocks of size 2^( 7) =       0.001592031765

      target function =                  N/A
              le_mean =     -22.330098131394
             les_mean =     502.342888804874
             stat err =       0.001571715595
             autocorr =       1.313789798184
              std dev =       1.939246276047
             le_variance =       3.760676119164


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233009813139e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-02, overlap shift 9.0949e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330098130575       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330124522198       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330126280070       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330125640386       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.330125600314       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.330125671161       residual = 1.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e-02 is 2.267950e-03

solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330098130575       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330111377314       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330112086482       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330112006541       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e-01 is 1.090451e-03

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330098130575       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330102557534       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330102843912       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+00 is 3.578915e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210421 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9277e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_001                -6.977865e-01 3 1  ON 0
ci_002                -7.023029e-01 3 1  ON 1
ci_003                -6.348977e-02 3 1  ON 2
ci_004                -6.151134e-02 3 1  ON 3
ci_005                 4.606181e-02 3 1  ON 4
ci_006                 4.592687e-02 3 1  ON 5
ci_007                 3.114445e-02 3 1  ON 6
ci_008                 3.171524e-02 3 1  ON 7
ci_009                -2.492980e-02 3 1  ON 8
ci_010                -2.494191e-02 3 1  ON 9
ci_011                -2.255334e-02 3 1  ON 10
ci_012                -2.248600e-02 3 1  ON 11
ci_013                 1.978398e-02 3 1  ON 12
ci_014                 1.965939e-02 3 1  ON 13
ci_015                 1.968955e-02 3 1  ON 14
ci_016                 2.160939e-02 3 1  ON 15
ci_017                 1.534930e-02 3 1  ON 16
ci_018                 1.531637e-02 3 1  ON 17
ci_019                 9.837438e-03 3 1  ON 18
ci_020                 1.001123e-02 3 1  ON 19
ci_021                -1.065613e-02 3 1  ON 20
ci_022                -1.071545e-02 3 1  ON 21
ci_023                 8.452761e-03 3 1  ON 22
ci_024                 8.868379e-03 3 1  ON 23
ci_025                 7.736494e-03 3 1  ON 24
ci_026                 8.406542e-03 3 1  ON 25
ci_027                 7.861245e-03 3 1  ON 26
ci_028                 7.815929e-03 3 1  ON 27
ci_029                -7.936633e-03 3 1  ON 28
ci_030                -7.321809e-03 3 1  ON 29
ci_031                -8.401100e-03 3 1  ON 30
ci_032                -7.858315e-03 3 1  ON 31
ci_033                 6.587566e-03 3 1  ON 32
ci_034                 6.739445e-03 3 1  ON 33
ci_035                 6.592298e-03 3 1  ON 34
ci_036                 6.128901e-03 3 1  ON 35
ci_037                 6.833243e-03 3 1  ON 36
ci_038                 5.254233e-03 3 1  ON 37
ci_039                 6.246624e-03 3 1  ON 38
ci_040                 5.950980e-03 3 1  ON 39
ci_041                 5.634970e-03 3 1  ON 40
ci_042                 5.035029e-03 3 1  ON 41
ci_043                 5.289691e-03 3 1  ON 42
ci_044                 5.021864e-03 3 1  ON 43
ci_045                 5.751802e-03 3 1  ON 44
ci_046                 4.891197e-03 3 1  ON 45
ci_047                -3.588464e-03 3 1  ON 46
ci_048                -3.963744e-03 3 1  ON 47
ci_049                 3.344084e-03 3 1  ON 48
ci_050                 3.861048e-03 3 1  ON 49
ci_051                -2.729465e-03 3 1  ON 50
ci_052                -2.967546e-03 3 1  ON 51
ci_053                -2.511967e-03 3 1  ON 52
ci_054                -2.929823e-03 3 1  ON 53
ci_055                -2.386023e-03 3 1  ON 54
ci_056                -3.097109e-03 3 1  ON 55
ci_057                -1.709103e-03 3 1  ON 56
ci_058                -1.528908e-03 3 1  ON 57
ci_059                -2.110096e-03 3 1  ON 58
ci_060                -1.516348e-03 3 1  ON 59
ci_061                -2.247316e-03 3 1  ON 60
ci_062                -1.467479e-03 3 1  ON 61
ci_063                -1.104784e-03 3 1  ON 62
ci_064                -7.702559e-04 3 1  ON 63
ci_065                -8.996415e-04 3 1  ON 64
ci_066                -1.443878e-03 3 1  ON 65
ci_067                -1.647175e-03 3 1  ON 66
ci_068                -1.327430e-03 3 1  ON 67
ci_069                 2.079754e-03 3 1  ON 68
ci_070                 1.266621e-03 3 1  ON 69
ci_071                -1.316506e-03 3 1  ON 70
ci_072                -1.105587e-03 3 1  ON 71
ci_073                 1.688692e-03 3 1  ON 72
ci_074                 1.557651e-03 3 1  ON 73
ci_075                -5.839621e-04 3 1  ON 74
ci_076                -1.141997e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.3706
    reference variance = 4.99079
====================================================
  Execution time = 2.5134e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7436e+00
  Total weights = 1.9497e+06
  Execution time = 4.3156e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796629405050
                                         uncertainty =       0.047052708783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796629405050
                                         uncertainty =       0.047052708783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377694153
  error estimate for blocks of size 2^( 2) =       0.001448701957
  error estimate for blocks of size 2^( 3) =       0.001509791583
  error estimate for blocks of size 2^( 4) =       0.001553064140
  error estimate for blocks of size 2^( 5) =       0.001577202665
  error estimate for blocks of size 2^( 6) =       0.001587185578
  error estimate for blocks of size 2^( 7) =       0.001602322155

      target function =                  N/A
              le_mean =     -22.328796573454
             les_mean =     502.321708668274
             stat err =       0.001579943635
             autocorr =       1.315156865705
              std dev =       1.948384929450
             le_variance =       3.796203833309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796451801428
                                         uncertainty =       0.047035026552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796451801428
                                         uncertainty =       0.047035026552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377661947
  error estimate for blocks of size 2^( 2) =       0.001448665742
  error estimate for blocks of size 2^( 3) =       0.001509761999
  error estimate for blocks of size 2^( 4) =       0.001553037803
  error estimate for blocks of size 2^( 5) =       0.001577170096
  error estimate for blocks of size 2^( 6) =       0.001587143123
  error estimate for blocks of size 2^( 7) =       0.001602280736

      target function =                  N/A
              le_mean =     -22.328807995576
             les_mean =     502.320816969296
             stat err =       0.001579907940
             autocorr =       1.315158928999
              std dev =       1.948339382112
             le_variance =       3.796026347890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796481487440
                                         uncertainty =       0.047035053760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796481487440
                                         uncertainty =       0.047035053760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377667307
  error estimate for blocks of size 2^( 2) =       0.001448704889
  error estimate for blocks of size 2^( 3) =       0.001509801907
  error estimate for blocks of size 2^( 4) =       0.001553071385
  error estimate for blocks of size 2^( 5) =       0.001577207938
  error estimate for blocks of size 2^( 6) =       0.001587191023
  error estimate for blocks of size 2^( 7) =       0.001602323520

      target function =                  N/A
              le_mean =     -22.328801951160
             les_mean =     502.330040857569
             stat err =       0.001579948467
             autocorr =       1.315216167663
              std dev =       1.948346962296
             le_variance =       3.796055885487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796576147510
                                         uncertainty =       0.047051136075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796576147510
                                         uncertainty =       0.047051136075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377684482
  error estimate for blocks of size 2^( 2) =       0.001448694644
  error estimate for blocks of size 2^( 3) =       0.001509782821
  error estimate for blocks of size 2^( 4) =       0.001553055358
  error estimate for blocks of size 2^( 5) =       0.001577181712
  error estimate for blocks of size 2^( 6) =       0.001587160851
  error estimate for blocks of size 2^( 7) =       0.001602295706

      target function =                  N/A
              le_mean =     -22.328791922773
             les_mean =     502.327491758784
             stat err =       0.001579923407
             autocorr =       1.315141654131
              std dev =       1.948371252315
             le_variance =       3.796150536846


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328796573454        initial
     9.0949e-02     9.0949e-01             2.2680e-03       -22.328807995576  <--
     3.6380e-01     3.6380e+00             1.0905e-03       -22.328801951160
     1.4552e+00     1.4552e+01             3.5789e-04       -22.328791922773

*****************************************************************************
Applying the update for shift_i =   9.0949e-02     and shift_s =   9.0949e-01
*****************************************************************************

  Execution time = 4.6933e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_001                -6.978695e-01 3 1  ON 0
ci_002                -7.021459e-01 3 1  ON 1
ci_003                -6.384334e-02 3 1  ON 2
ci_004                -6.274140e-02 3 1  ON 3
ci_005                 4.626367e-02 3 1  ON 4
ci_006                 4.611382e-02 3 1  ON 5
ci_007                 3.063309e-02 3 1  ON 6
ci_008                 3.166142e-02 3 1  ON 7
ci_009                -2.521527e-02 3 1  ON 8
ci_010                -2.492447e-02 3 1  ON 9
ci_011                -2.180367e-02 3 1  ON 10
ci_012                -2.225749e-02 3 1  ON 11
ci_013                 1.996569e-02 3 1  ON 12
ci_014                 1.855442e-02 3 1  ON 13
ci_015                 1.975595e-02 3 1  ON 14
ci_016                 2.236048e-02 3 1  ON 15
ci_017                 1.516432e-02 3 1  ON 16
ci_018                 1.544840e-02 3 1  ON 17
ci_019                 9.565452e-03 3 1  ON 18
ci_020                 1.006590e-02 3 1  ON 19
ci_021                -1.034406e-02 3 1  ON 20
ci_022                -1.019580e-02 3 1  ON 21
ci_023                 8.441802e-03 3 1  ON 22
ci_024                 8.858682e-03 3 1  ON 23
ci_025                 7.348466e-03 3 1  ON 24
ci_026                 8.201219e-03 3 1  ON 25
ci_027                 7.608409e-03 3 1  ON 26
ci_028                 7.676506e-03 3 1  ON 27
ci_029                -7.965989e-03 3 1  ON 28
ci_030                -6.780117e-03 3 1  ON 29
ci_031                -8.741935e-03 3 1  ON 30
ci_032                -8.136893e-03 3 1  ON 31
ci_033                 7.330516e-03 3 1  ON 32
ci_034                 6.596073e-03 3 1  ON 33
ci_035                 6.736083e-03 3 1  ON 34
ci_036                 5.719309e-03 3 1  ON 35
ci_037                 7.031736e-03 3 1  ON 36
ci_038                 4.076733e-03 3 1  ON 37
ci_039                 6.138134e-03 3 1  ON 38
ci_040                 5.762256e-03 3 1  ON 39
ci_041                 5.760648e-03 3 1  ON 40
ci_042                 5.177954e-03 3 1  ON 41
ci_043                 4.997276e-03 3 1  ON 42
ci_044                 4.762438e-03 3 1  ON 43
ci_045                 5.723037e-03 3 1  ON 44
ci_046                 4.615969e-03 3 1  ON 45
ci_047                -3.434697e-03 3 1  ON 46
ci_048                -3.884287e-03 3 1  ON 47
ci_049                 2.919402e-03 3 1  ON 48
ci_050                 3.825759e-03 3 1  ON 49
ci_051                -3.278610e-03 3 1  ON 50
ci_052                -3.406746e-03 3 1  ON 51
ci_053                -2.806944e-03 3 1  ON 52
ci_054                -3.158611e-03 3 1  ON 53
ci_055                -2.500662e-03 3 1  ON 54
ci_056                -3.542566e-03 3 1  ON 55
ci_057                -1.341109e-03 3 1  ON 56
ci_058                -1.506471e-03 3 1  ON 57
ci_059                -1.853590e-03 3 1  ON 58
ci_060                -1.476535e-03 3 1  ON 59
ci_061                -2.296358e-03 3 1  ON 60
ci_062                -1.223398e-03 3 1  ON 61
ci_063                -1.140985e-03 3 1  ON 62
ci_064                -6.047927e-04 3 1  ON 63
ci_065                -9.233942e-04 3 1  ON 64
ci_066                -1.910282e-03 3 1  ON 65
ci_067                -1.998416e-03 3 1  ON 66
ci_068                -1.579734e-03 3 1  ON 67
ci_069                 2.477458e-03 3 1  ON 68
ci_070                 1.364705e-03 3 1  ON 69
ci_071                -9.464327e-04 3 1  ON 70
ci_072                -9.369499e-04 3 1  ON 71
ci_073                 2.020832e-03 3 1  ON 72
ci_074                 1.514004e-03 3 1  ON 73
ci_075                -6.133133e-04 3 1  ON 74
ci_076                -9.789537e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6226e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2279e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.2396
    reference variance = 9.16179
====================================================
  Execution time = 2.3483e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0311e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7370e+00
  Total weights = 1.949891415e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7883e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788217270266
                                         uncertainty =       0.043132570937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788217270266
                                         uncertainty =       0.043132570937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376143082
  error estimate for blocks of size 2^( 2) =       0.001447120069
  error estimate for blocks of size 2^( 3) =       0.001509686808
  error estimate for blocks of size 2^( 4) =       0.001556355735
  error estimate for blocks of size 2^( 5) =       0.001581679450
  error estimate for blocks of size 2^( 6) =       0.001594964432
  error estimate for blocks of size 2^( 7) =       0.001607086928

      target function =                  N/A
              le_mean =     -22.327614822957
             les_mean =     502.259412940330
             stat err =       0.001585021636
             autocorr =       1.326609817818
              std dev =       1.946191349347
             le_variance =       3.787660768275


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232761482296e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-02, overlap shift 2.2737e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327614822146       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327710972548       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327712349193       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327711222078       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327710045496       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327710300502       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327710388597       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.327710040461       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.327710072741       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e-02 is 3.535677e-03

solving harmonic davidson linear method for identity shift 9.0949e-02, overlap shift 9.0949e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327614822146       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327688330267       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327688161820       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327687630725       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327687359406       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327687429142       residual = 2.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e-02 is 2.629025e-03

solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327614822146       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327652674495       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327652281616       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327652219607       residual = 1.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e-01 is 1.307302e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.215234 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9283e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_001                -6.974908e-01 3 1  ON 0
ci_002                -7.023791e-01 3 1  ON 1
ci_003                -6.317582e-02 3 1  ON 2
ci_004                -6.323906e-02 3 1  ON 3
ci_005                 4.665987e-02 3 1  ON 4
ci_006                 4.657620e-02 3 1  ON 5
ci_007                 3.254333e-02 3 1  ON 6
ci_008                 3.117653e-02 3 1  ON 7
ci_009                -2.527584e-02 3 1  ON 8
ci_010                -2.381112e-02 3 1  ON 9
ci_011                -2.129551e-02 3 1  ON 10
ci_012                -2.235947e-02 3 1  ON 11
ci_013                 2.091760e-02 3 1  ON 12
ci_014                 1.862490e-02 3 1  ON 13
ci_015                 1.968688e-02 3 1  ON 14
ci_016                 2.333885e-02 3 1  ON 15
ci_017                 1.485031e-02 3 1  ON 16
ci_018                 1.565140e-02 3 1  ON 17
ci_019                 1.032279e-02 3 1  ON 18
ci_020                 1.065563e-02 3 1  ON 19
ci_021                -1.024490e-02 3 1  ON 20
ci_022                -9.865299e-03 3 1  ON 21
ci_023                 8.898454e-03 3 1  ON 22
ci_024                 9.296952e-03 3 1  ON 23
ci_025                 7.811266e-03 3 1  ON 24
ci_026                 8.288923e-03 3 1  ON 25
ci_027                 7.207196e-03 3 1  ON 26
ci_028                 8.177269e-03 3 1  ON 27
ci_029                -7.572661e-03 3 1  ON 28
ci_030                -7.840141e-03 3 1  ON 29
ci_031                -8.034726e-03 3 1  ON 30
ci_032                -7.657905e-03 3 1  ON 31
ci_033                 6.648297e-03 3 1  ON 32
ci_034                 7.223784e-03 3 1  ON 33
ci_035                 6.138971e-03 3 1  ON 34
ci_036                 6.621894e-03 3 1  ON 35
ci_037                 7.544478e-03 3 1  ON 36
ci_038                 6.705758e-03 3 1  ON 37
ci_039                 5.934252e-03 3 1  ON 38
ci_040                 5.905060e-03 3 1  ON 39
ci_041                 5.421672e-03 3 1  ON 40
ci_042                 5.208455e-03 3 1  ON 41
ci_043                 4.819813e-03 3 1  ON 42
ci_044                 5.244275e-03 3 1  ON 43
ci_045                 5.735191e-03 3 1  ON 44
ci_046                 4.179176e-03 3 1  ON 45
ci_047                -3.853323e-03 3 1  ON 46
ci_048                -3.926012e-03 3 1  ON 47
ci_049                 3.474708e-03 3 1  ON 48
ci_050                 4.013872e-03 3 1  ON 49
ci_051                -3.390347e-03 3 1  ON 50
ci_052                -2.414034e-03 3 1  ON 51
ci_053                -3.007637e-03 3 1  ON 52
ci_054                -3.012189e-03 3 1  ON 53
ci_055                -2.572686e-03 3 1  ON 54
ci_056                -3.133072e-03 3 1  ON 55
ci_057                -2.289376e-03 3 1  ON 56
ci_058                -1.594707e-03 3 1  ON 57
ci_059                -1.480429e-03 3 1  ON 58
ci_060                -2.306887e-03 3 1  ON 59
ci_061                -2.065603e-03 3 1  ON 60
ci_062                -1.714005e-03 3 1  ON 61
ci_063                -1.107288e-03 3 1  ON 62
ci_064                -1.335098e-03 3 1  ON 63
ci_065                -1.439812e-03 3 1  ON 64
ci_066                -9.796389e-04 3 1  ON 65
ci_067                -1.375436e-03 3 1  ON 66
ci_068                -3.084063e-03 3 1  ON 67
ci_069                 1.089045e-03 3 1  ON 68
ci_070                 1.258231e-03 3 1  ON 69
ci_071                -1.463571e-03 3 1  ON 70
ci_072                -1.249896e-03 3 1  ON 71
ci_073                 1.508166e-03 3 1  ON 72
ci_074                 9.671357e-04 3 1  ON 73
ci_075                -1.506130e-04 3 1  ON 74
ci_076                -1.686582e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.0728
    reference variance = 3.13457
====================================================
  Execution time = 2.2900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7114e+00
  Total weights = 1.9500e+06
  Execution time = 4.2965e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774359882490
                                         uncertainty =       0.025541836136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774359882490
                                         uncertainty =       0.025541836136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373586905
  error estimate for blocks of size 2^( 2) =       0.001444538752
  error estimate for blocks of size 2^( 3) =       0.001507419402
  error estimate for blocks of size 2^( 4) =       0.001551589721
  error estimate for blocks of size 2^( 5) =       0.001572858907
  error estimate for blocks of size 2^( 6) =       0.001586825818
  error estimate for blocks of size 2^( 7) =       0.001603317962

      target function =                  N/A
              le_mean =     -22.328748443684
             les_mean =     505.225454650141
             stat err =       0.001578648102
             autocorr =       1.320864839682
              std dev =       1.942576310955
             le_variance =       3.773602723884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762156963563
                                         uncertainty =       0.024208961484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762156963563
                                         uncertainty =       0.024208961484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371362457
  error estimate for blocks of size 2^( 2) =       0.001442389166
  error estimate for blocks of size 2^( 3) =       0.001505374847
  error estimate for blocks of size 2^( 4) =       0.001549672430
  error estimate for blocks of size 2^( 5) =       0.001570931447
  error estimate for blocks of size 2^( 6) =       0.001584937093
  error estimate for blocks of size 2^( 7) =       0.001600980548

      target function =                  N/A
              le_mean =     -22.328796769998
             les_mean =     502.291771334261
             stat err =       0.001576630380
             autocorr =       1.321768110403
              std dev =       1.939430415252
             le_variance =       3.761390335605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763011974903
                                         uncertainty =       0.024193305024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763011974903
                                         uncertainty =       0.024193305024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371518094
  error estimate for blocks of size 2^( 2) =       0.001442514605
  error estimate for blocks of size 2^( 3) =       0.001505470649
  error estimate for blocks of size 2^( 4) =       0.001549749459
  error estimate for blocks of size 2^( 5) =       0.001570987450
  error estimate for blocks of size 2^( 6) =       0.001584935774
  error estimate for blocks of size 2^( 7) =       0.001600966451

      target function =                  N/A
              le_mean =     -22.328850531610
             les_mean =     502.556601214760
             stat err =       0.001576659783
             autocorr =       1.321517433556
              std dev =       1.939650523924
             le_variance =       3.762244154960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762005150800
                                         uncertainty =       0.024197975995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762005150800
                                         uncertainty =       0.024197975995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371334892
  error estimate for blocks of size 2^( 2) =       0.001442383621
  error estimate for blocks of size 2^( 3) =       0.001505380653
  error estimate for blocks of size 2^( 4) =       0.001549699866
  error estimate for blocks of size 2^( 5) =       0.001570960082
  error estimate for blocks of size 2^( 6) =       0.001584985544
  error estimate for blocks of size 2^( 7) =       0.001600940721

      target function =                  N/A
              le_mean =     -22.328794250670
             les_mean =     502.379760149183
             stat err =       0.001576646553
             autocorr =       1.321848368104
              std dev =       1.939391431910
             le_variance =       3.761239126164


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328748443684        initial
     2.2737e-02     2.2737e-01             3.5357e-03       -22.328796769998
     9.0949e-02     9.0949e-01             2.6290e-03       -22.328850531610  <--
     3.6380e-01     3.6380e+00             1.3073e-03       -22.328794250670

*****************************************************************************
Applying the update for shift_i =   9.0949e-02     and shift_s =   9.0949e-01
*****************************************************************************

  Execution time = 4.4558e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_001                -6.974908e-01 3 1  ON 0
ci_002                -7.023791e-01 3 1  ON 1
ci_003                -6.317582e-02 3 1  ON 2
ci_004                -6.323906e-02 3 1  ON 3
ci_005                 4.665987e-02 3 1  ON 4
ci_006                 4.657620e-02 3 1  ON 5
ci_007                 3.254333e-02 3 1  ON 6
ci_008                 3.117653e-02 3 1  ON 7
ci_009                -2.527584e-02 3 1  ON 8
ci_010                -2.381112e-02 3 1  ON 9
ci_011                -2.129551e-02 3 1  ON 10
ci_012                -2.235947e-02 3 1  ON 11
ci_013                 2.091760e-02 3 1  ON 12
ci_014                 1.862490e-02 3 1  ON 13
ci_015                 1.968688e-02 3 1  ON 14
ci_016                 2.333885e-02 3 1  ON 15
ci_017                 1.485031e-02 3 1  ON 16
ci_018                 1.565140e-02 3 1  ON 17
ci_019                 1.032279e-02 3 1  ON 18
ci_020                 1.065563e-02 3 1  ON 19
ci_021                -1.024490e-02 3 1  ON 20
ci_022                -9.865299e-03 3 1  ON 21
ci_023                 8.898454e-03 3 1  ON 22
ci_024                 9.296952e-03 3 1  ON 23
ci_025                 7.811266e-03 3 1  ON 24
ci_026                 8.288923e-03 3 1  ON 25
ci_027                 7.207196e-03 3 1  ON 26
ci_028                 8.177269e-03 3 1  ON 27
ci_029                -7.572661e-03 3 1  ON 28
ci_030                -7.840141e-03 3 1  ON 29
ci_031                -8.034726e-03 3 1  ON 30
ci_032                -7.657905e-03 3 1  ON 31
ci_033                 6.648297e-03 3 1  ON 32
ci_034                 7.223784e-03 3 1  ON 33
ci_035                 6.138971e-03 3 1  ON 34
ci_036                 6.621894e-03 3 1  ON 35
ci_037                 7.544478e-03 3 1  ON 36
ci_038                 6.705758e-03 3 1  ON 37
ci_039                 5.934252e-03 3 1  ON 38
ci_040                 5.905060e-03 3 1  ON 39
ci_041                 5.421672e-03 3 1  ON 40
ci_042                 5.208455e-03 3 1  ON 41
ci_043                 4.819813e-03 3 1  ON 42
ci_044                 5.244275e-03 3 1  ON 43
ci_045                 5.735191e-03 3 1  ON 44
ci_046                 4.179176e-03 3 1  ON 45
ci_047                -3.853323e-03 3 1  ON 46
ci_048                -3.926012e-03 3 1  ON 47
ci_049                 3.474708e-03 3 1  ON 48
ci_050                 4.013872e-03 3 1  ON 49
ci_051                -3.390347e-03 3 1  ON 50
ci_052                -2.414034e-03 3 1  ON 51
ci_053                -3.007637e-03 3 1  ON 52
ci_054                -3.012189e-03 3 1  ON 53
ci_055                -2.572686e-03 3 1  ON 54
ci_056                -3.133072e-03 3 1  ON 55
ci_057                -2.289376e-03 3 1  ON 56
ci_058                -1.594707e-03 3 1  ON 57
ci_059                -1.480429e-03 3 1  ON 58
ci_060                -2.306887e-03 3 1  ON 59
ci_061                -2.065603e-03 3 1  ON 60
ci_062                -1.714005e-03 3 1  ON 61
ci_063                -1.107288e-03 3 1  ON 62
ci_064                -1.335098e-03 3 1  ON 63
ci_065                -1.439812e-03 3 1  ON 64
ci_066                -9.796389e-04 3 1  ON 65
ci_067                -1.375436e-03 3 1  ON 66
ci_068                -3.084063e-03 3 1  ON 67
ci_069                 1.089045e-03 3 1  ON 68
ci_070                 1.258231e-03 3 1  ON 69
ci_071                -1.463571e-03 3 1  ON 70
ci_072                -1.249896e-03 3 1  ON 71
ci_073                 1.508166e-03 3 1  ON 72
ci_074                 9.671357e-04 3 1  ON 73
ci_075                -1.506130e-04 3 1  ON 74
ci_076                -1.686582e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3857e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2275e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.6056
    reference variance = 2.78358
====================================================
  Execution time = 2.3424e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0321e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7326e+00
  Total weights = 1.949863017e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8109e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783584907657
                                         uncertainty =       0.038303273061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783584907657
                                         uncertainty =       0.038303273061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375339167
  error estimate for blocks of size 2^( 2) =       0.001446291107
  error estimate for blocks of size 2^( 3) =       0.001509279988
  error estimate for blocks of size 2^( 4) =       0.001554332922
  error estimate for blocks of size 2^( 5) =       0.001576940498
  error estimate for blocks of size 2^( 6) =       0.001596157654
  error estimate for blocks of size 2^( 7) =       0.001602676875

      target function =                  N/A
              le_mean =     -22.329942628163
             les_mean =     502.358927284045
             stat err =       0.001582526987
             autocorr =       1.323983667031
              std dev =       1.945054423454
             le_variance =       3.783236710199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232994262816e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-02, overlap shift 2.2737e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329942627353       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330085176151       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330102421635       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330103225891       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.330103472349       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.330104759224       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.330106531974       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.330106399184       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.330106350699       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.330106324317       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e-02 is 2.836211e-03

solving harmonic davidson linear method for identity shift 9.0949e-02, overlap shift 9.0949e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329942627353       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330054187211       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330063063905       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330063025906       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.330062994679       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.330063131182       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e-02 is 1.985802e-03

solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329942627353       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330002298176       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330004149125       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330004072082       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e-01 is 9.078856e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220325 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9247e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_001                -6.970004e-01 3 1  ON 0
ci_002                -7.029180e-01 3 1  ON 1
ci_003                -6.300318e-02 3 1  ON 2
ci_004                -6.257149e-02 3 1  ON 3
ci_005                 4.525342e-02 3 1  ON 4
ci_006                 4.697827e-02 3 1  ON 5
ci_007                 3.227834e-02 3 1  ON 6
ci_008                 3.162224e-02 3 1  ON 7
ci_009                -2.542452e-02 3 1  ON 8
ci_010                -2.526871e-02 3 1  ON 9
ci_011                -2.158826e-02 3 1  ON 10
ci_012                -2.279053e-02 3 1  ON 11
ci_013                 2.111021e-02 3 1  ON 12
ci_014                 1.898632e-02 3 1  ON 13
ci_015                 2.041999e-02 3 1  ON 14
ci_016                 2.278573e-02 3 1  ON 15
ci_017                 1.542124e-02 3 1  ON 16
ci_018                 1.534022e-02 3 1  ON 17
ci_019                 9.746080e-03 3 1  ON 18
ci_020                 1.044232e-02 3 1  ON 19
ci_021                -9.888016e-03 3 1  ON 20
ci_022                -1.100991e-02 3 1  ON 21
ci_023                 8.127662e-03 3 1  ON 22
ci_024                 8.569737e-03 3 1  ON 23
ci_025                 8.197993e-03 3 1  ON 24
ci_026                 7.883743e-03 3 1  ON 25
ci_027                 8.008821e-03 3 1  ON 26
ci_028                 8.123643e-03 3 1  ON 27
ci_029                -9.394527e-03 3 1  ON 28
ci_030                -6.960780e-03 3 1  ON 29
ci_031                -8.161027e-03 3 1  ON 30
ci_032                -7.402796e-03 3 1  ON 31
ci_033                 7.749640e-03 3 1  ON 32
ci_034                 7.659748e-03 3 1  ON 33
ci_035                 7.070963e-03 3 1  ON 34
ci_036                 5.934786e-03 3 1  ON 35
ci_037                 7.033564e-03 3 1  ON 36
ci_038                 6.782948e-03 3 1  ON 37
ci_039                 5.047482e-03 3 1  ON 38
ci_040                 5.779820e-03 3 1  ON 39
ci_041                 5.233945e-03 3 1  ON 40
ci_042                 5.343483e-03 3 1  ON 41
ci_043                 3.771503e-03 3 1  ON 42
ci_044                 5.484631e-03 3 1  ON 43
ci_045                 5.751142e-03 3 1  ON 44
ci_046                 4.462055e-03 3 1  ON 45
ci_047                -4.053675e-03 3 1  ON 46
ci_048                -4.641699e-03 3 1  ON 47
ci_049                 5.154039e-03 3 1  ON 48
ci_050                 4.234611e-03 3 1  ON 49
ci_051                -2.013972e-03 3 1  ON 50
ci_052                -1.404083e-03 3 1  ON 51
ci_053                -2.532891e-03 3 1  ON 52
ci_054                -3.354881e-03 3 1  ON 53
ci_055                -3.122339e-03 3 1  ON 54
ci_056                -1.147269e-03 3 1  ON 55
ci_057                -2.345274e-03 3 1  ON 56
ci_058                -2.777369e-03 3 1  ON 57
ci_059                -1.435770e-03 3 1  ON 58
ci_060                -1.367873e-03 3 1  ON 59
ci_061                -1.602379e-03 3 1  ON 60
ci_062                -2.118321e-03 3 1  ON 61
ci_063                -5.094436e-04 3 1  ON 62
ci_064                -1.544259e-04 3 1  ON 63
ci_065                -1.775595e-03 3 1  ON 64
ci_066                -6.554859e-04 3 1  ON 65
ci_067                 2.326812e-04 3 1  ON 66
ci_068                -2.895230e-03 3 1  ON 67
ci_069                 2.099462e-03 3 1  ON 68
ci_070                 1.194926e-03 3 1  ON 69
ci_071                -5.767868e-05 3 1  ON 70
ci_072                -2.195329e-03 3 1  ON 71
ci_073                 1.975700e-03 3 1  ON 72
ci_074                 1.038928e-03 3 1  ON 73
ci_075                -9.178554e-04 3 1  ON 74
ci_076                -5.897938e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.2567
    reference variance = 3.2135
====================================================
  Execution time = 2.2899e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7386e+00
  Total weights = 1.9497e+06
  Execution time = 4.3204e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0525296
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.957025935668
                                         uncertainty =       0.167857884555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.957025935668
                                         uncertainty =       0.167857884555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001406762552
  error estimate for blocks of size 2^( 2) =       0.001475407038
  error estimate for blocks of size 2^( 3) =       0.001538095246
  error estimate for blocks of size 2^( 4) =       0.001581204303
  error estimate for blocks of size 2^( 5) =       0.001604402362
  error estimate for blocks of size 2^( 6) =       0.001620772910
  error estimate for blocks of size 2^( 7) =       0.001638143783

      target function =                  N/A
              le_mean =     -22.325971284422
             les_mean =     512.202419940092
             stat err =       0.001611130840
             autocorr =       1.311656221603
              std dev =       1.989494511800
             le_variance =       3.958088412484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.055996220605
                                         uncertainty =       0.263874178848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.055996220605
                                         uncertainty =       0.263874178848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001424244419
  error estimate for blocks of size 2^( 2) =       0.001491796772
  error estimate for blocks of size 2^( 3) =       0.001553330629
  error estimate for blocks of size 2^( 4) =       0.001595640619
  error estimate for blocks of size 2^( 5) =       0.001619757706
  error estimate for blocks of size 2^( 6) =       0.001634959558
  error estimate for blocks of size 2^( 7) =       0.001646822635

      target function =                  N/A
              le_mean =     -22.325821979606
             les_mean =     624.348884885242
             stat err =       0.001624295129
             autocorr =       1.300651157246
              std dev =       2.014217999530
             le_variance =       4.057074149629

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0542186
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796671370107
                                         uncertainty =       0.035819269544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796671370107
                                         uncertainty =       0.035819269544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377967980
  error estimate for blocks of size 2^( 2) =       0.001447752731
  error estimate for blocks of size 2^( 3) =       0.001511164099
  error estimate for blocks of size 2^( 4) =       0.001554945261
  error estimate for blocks of size 2^( 5) =       0.001579529679
  error estimate for blocks of size 2^( 6) =       0.001595378291
  error estimate for blocks of size 2^( 7) =       0.001610577939

      target function =                  N/A
              le_mean =     -22.326230508981
             les_mean =     502.546773073327
             stat err =       0.001585107793
             autocorr =       1.323242222398
              std dev =       1.948772185864
             le_variance =       3.797713032395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789895883941
                                         uncertainty =       0.035320755383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789895883941
                                         uncertainty =       0.035320755383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376739981
  error estimate for blocks of size 2^( 2) =       0.001446602056
  error estimate for blocks of size 2^( 3) =       0.001510057125
  error estimate for blocks of size 2^( 4) =       0.001553724491
  error estimate for blocks of size 2^( 5) =       0.001578433479
  error estimate for blocks of size 2^( 6) =       0.001594679775
  error estimate for blocks of size 2^( 7) =       0.001609550759

      target function =                  N/A
              le_mean =     -22.326192154146
             les_mean =     502.396691137931
             stat err =       0.001584097126
             autocorr =       1.323913963221
              std dev =       1.947035505162
             le_variance =       3.790947258360


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325971284422        initial
     2.2737e-02     2.2737e-01             2.8362e-03       -22.325821979606
     9.0949e-02     9.0949e-01             1.9858e-03       -22.326230508981  <--
     3.6380e-01     3.6380e+00             9.0789e-04       -22.326192154146

*****************************************************************************
Applying the update for shift_i =   9.0949e-02     and shift_s =   9.0949e-01
*****************************************************************************

  Execution time = 4.4721e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_001                -6.970004e-01 3 1  ON 0
ci_002                -7.029180e-01 3 1  ON 1
ci_003                -6.300318e-02 3 1  ON 2
ci_004                -6.257149e-02 3 1  ON 3
ci_005                 4.525342e-02 3 1  ON 4
ci_006                 4.697827e-02 3 1  ON 5
ci_007                 3.227834e-02 3 1  ON 6
ci_008                 3.162224e-02 3 1  ON 7
ci_009                -2.542452e-02 3 1  ON 8
ci_010                -2.526871e-02 3 1  ON 9
ci_011                -2.158826e-02 3 1  ON 10
ci_012                -2.279053e-02 3 1  ON 11
ci_013                 2.111021e-02 3 1  ON 12
ci_014                 1.898632e-02 3 1  ON 13
ci_015                 2.041999e-02 3 1  ON 14
ci_016                 2.278573e-02 3 1  ON 15
ci_017                 1.542124e-02 3 1  ON 16
ci_018                 1.534022e-02 3 1  ON 17
ci_019                 9.746080e-03 3 1  ON 18
ci_020                 1.044232e-02 3 1  ON 19
ci_021                -9.888016e-03 3 1  ON 20
ci_022                -1.100991e-02 3 1  ON 21
ci_023                 8.127662e-03 3 1  ON 22
ci_024                 8.569737e-03 3 1  ON 23
ci_025                 8.197993e-03 3 1  ON 24
ci_026                 7.883743e-03 3 1  ON 25
ci_027                 8.008821e-03 3 1  ON 26
ci_028                 8.123643e-03 3 1  ON 27
ci_029                -9.394527e-03 3 1  ON 28
ci_030                -6.960780e-03 3 1  ON 29
ci_031                -8.161027e-03 3 1  ON 30
ci_032                -7.402796e-03 3 1  ON 31
ci_033                 7.749640e-03 3 1  ON 32
ci_034                 7.659748e-03 3 1  ON 33
ci_035                 7.070963e-03 3 1  ON 34
ci_036                 5.934786e-03 3 1  ON 35
ci_037                 7.033564e-03 3 1  ON 36
ci_038                 6.782948e-03 3 1  ON 37
ci_039                 5.047482e-03 3 1  ON 38
ci_040                 5.779820e-03 3 1  ON 39
ci_041                 5.233945e-03 3 1  ON 40
ci_042                 5.343483e-03 3 1  ON 41
ci_043                 3.771503e-03 3 1  ON 42
ci_044                 5.484631e-03 3 1  ON 43
ci_045                 5.751142e-03 3 1  ON 44
ci_046                 4.462055e-03 3 1  ON 45
ci_047                -4.053675e-03 3 1  ON 46
ci_048                -4.641699e-03 3 1  ON 47
ci_049                 5.154039e-03 3 1  ON 48
ci_050                 4.234611e-03 3 1  ON 49
ci_051                -2.013972e-03 3 1  ON 50
ci_052                -1.404083e-03 3 1  ON 51
ci_053                -2.532891e-03 3 1  ON 52
ci_054                -3.354881e-03 3 1  ON 53
ci_055                -3.122339e-03 3 1  ON 54
ci_056                -1.147269e-03 3 1  ON 55
ci_057                -2.345274e-03 3 1  ON 56
ci_058                -2.777369e-03 3 1  ON 57
ci_059                -1.435770e-03 3 1  ON 58
ci_060                -1.367873e-03 3 1  ON 59
ci_061                -1.602379e-03 3 1  ON 60
ci_062                -2.118321e-03 3 1  ON 61
ci_063                -5.094436e-04 3 1  ON 62
ci_064                -1.544259e-04 3 1  ON 63
ci_065                -1.775595e-03 3 1  ON 64
ci_066                -6.554859e-04 3 1  ON 65
ci_067                 2.326812e-04 3 1  ON 66
ci_068                -2.895230e-03 3 1  ON 67
ci_069                 2.099462e-03 3 1  ON 68
ci_070                 1.194926e-03 3 1  ON 69
ci_071                -5.767868e-05 3 1  ON 70
ci_072                -2.195329e-03 3 1  ON 71
ci_073                 1.975700e-03 3 1  ON 72
ci_074                 1.038928e-03 3 1  ON 73
ci_075                -9.178554e-04 3 1  ON 74
ci_076                -5.897938e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3984e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2279e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.2729
    reference variance = 3.59575
====================================================
  Execution time = 2.3427e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0324e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7133e+00
  Total weights = 1.949833758e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8115e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764742580631
                                         uncertainty =       0.059576127050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764742580631
                                         uncertainty =       0.059576127050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371805172
  error estimate for blocks of size 2^( 2) =       0.001442948866
  error estimate for blocks of size 2^( 3) =       0.001507503326
  error estimate for blocks of size 2^( 4) =       0.001550340041
  error estimate for blocks of size 2^( 5) =       0.001577843161
  error estimate for blocks of size 2^( 6) =       0.001592509530
  error estimate for blocks of size 2^( 7) =       0.001600312615

      target function =                  N/A
              le_mean =     -22.328543765882
             les_mean =     502.277194275520
             stat err =       0.001580251337
             autocorr =       1.326989421848
              std dev =       1.940056519422
             le_variance =       3.763819298553


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232854376588e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-02, overlap shift 2.2737e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328543765083       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328681637734       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328691552138       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328694611174       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328696338809       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328697177926       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.328697616168       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.328697655159       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.328697861390       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e-02 is 2.925277e-03

solving harmonic davidson linear method for identity shift 9.0949e-02, overlap shift 9.0949e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328543765083       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328649944526       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328654209255       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328655056498       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328655270669       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328655278983       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e-02 is 1.934055e-03

solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328543765083       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328599080835       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328599652720       residual = 8.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328599705810       residual = 2.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e-01 is 9.142417e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.225207 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9250e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_001                -6.965729e-01 3 1  ON 0
ci_002                -7.036862e-01 3 1  ON 1
ci_003                -6.172986e-02 3 1  ON 2
ci_004                -6.226355e-02 3 1  ON 3
ci_005                 4.466208e-02 3 1  ON 4
ci_006                 4.581500e-02 3 1  ON 5
ci_007                 3.093528e-02 3 1  ON 6
ci_008                 3.125238e-02 3 1  ON 7
ci_009                -2.630956e-02 3 1  ON 8
ci_010                -2.489129e-02 3 1  ON 9
ci_011                -2.190851e-02 3 1  ON 10
ci_012                -2.342147e-02 3 1  ON 11
ci_013                 2.094862e-02 3 1  ON 12
ci_014                 1.871332e-02 3 1  ON 13
ci_015                 2.029321e-02 3 1  ON 14
ci_016                 2.281828e-02 3 1  ON 15
ci_017                 1.476211e-02 3 1  ON 16
ci_018                 1.622059e-02 3 1  ON 17
ci_019                 8.908024e-03 3 1  ON 18
ci_020                 1.062684e-02 3 1  ON 19
ci_021                -9.169862e-03 3 1  ON 20
ci_022                -1.122819e-02 3 1  ON 21
ci_023                 9.566447e-03 3 1  ON 22
ci_024                 8.502261e-03 3 1  ON 23
ci_025                 8.864252e-03 3 1  ON 24
ci_026                 8.774889e-03 3 1  ON 25
ci_027                 7.116587e-03 3 1  ON 26
ci_028                 7.942766e-03 3 1  ON 27
ci_029                -8.876766e-03 3 1  ON 28
ci_030                -6.195065e-03 3 1  ON 29
ci_031                -7.593241e-03 3 1  ON 30
ci_032                -7.102949e-03 3 1  ON 31
ci_033                 8.562045e-03 3 1  ON 32
ci_034                 7.388913e-03 3 1  ON 33
ci_035                 6.274406e-03 3 1  ON 34
ci_036                 6.704809e-03 3 1  ON 35
ci_037                 5.662180e-03 3 1  ON 36
ci_038                 5.473718e-03 3 1  ON 37
ci_039                 5.808519e-03 3 1  ON 38
ci_040                 6.106859e-03 3 1  ON 39
ci_041                 5.215763e-03 3 1  ON 40
ci_042                 5.806201e-03 3 1  ON 41
ci_043                 5.018325e-03 3 1  ON 42
ci_044                 5.002212e-03 3 1  ON 43
ci_045                 4.473565e-03 3 1  ON 44
ci_046                 4.439345e-03 3 1  ON 45
ci_047                -3.762108e-03 3 1  ON 46
ci_048                -4.812240e-03 3 1  ON 47
ci_049                 3.955982e-03 3 1  ON 48
ci_050                 4.329257e-03 3 1  ON 49
ci_051                -2.402411e-03 3 1  ON 50
ci_052                -2.165681e-03 3 1  ON 51
ci_053                -2.200792e-03 3 1  ON 52
ci_054                -3.467144e-03 3 1  ON 53
ci_055                -2.720604e-03 3 1  ON 54
ci_056                -1.750866e-03 3 1  ON 55
ci_057                -1.988628e-03 3 1  ON 56
ci_058                -2.546454e-03 3 1  ON 57
ci_059                -1.878851e-03 3 1  ON 58
ci_060                -7.338472e-04 3 1  ON 59
ci_061                -1.589779e-03 3 1  ON 60
ci_062                -1.899253e-03 3 1  ON 61
ci_063                -1.446938e-03 3 1  ON 62
ci_064                -2.088481e-03 3 1  ON 63
ci_065                -1.932376e-03 3 1  ON 64
ci_066                -1.431184e-03 3 1  ON 65
ci_067                -8.413988e-04 3 1  ON 66
ci_068                -2.496658e-03 3 1  ON 67
ci_069                 1.381286e-03 3 1  ON 68
ci_070                 1.427736e-03 3 1  ON 69
ci_071                -9.929218e-04 3 1  ON 70
ci_072                -2.739400e-03 3 1  ON 71
ci_073                 1.614760e-03 3 1  ON 72
ci_074                 1.197379e-03 3 1  ON 73
ci_075                -8.320747e-04 3 1  ON 74
ci_076                -1.295729e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.1287
    reference variance = 6.73497
====================================================
  Execution time = 2.2883e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7263e+00
  Total weights = 1.9498e+06
  Execution time = 4.2993e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779682586165
                                         uncertainty =       0.031659926793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779682586165
                                         uncertainty =       0.031659926793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374591483
  error estimate for blocks of size 2^( 2) =       0.001445717087
  error estimate for blocks of size 2^( 3) =       0.001509001182
  error estimate for blocks of size 2^( 4) =       0.001553896159
  error estimate for blocks of size 2^( 5) =       0.001579858253
  error estimate for blocks of size 2^( 6) =       0.001593360604
  error estimate for blocks of size 2^( 7) =       0.001597669797

      target function =                  N/A
              le_mean =     -22.325784952733
             les_mean =     502.178010938692
             stat err =       0.001581196203
             autocorr =       1.323196149601
              std dev =       1.943997020654
             le_variance =       3.779124416312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779298972085
                                         uncertainty =       0.031646263315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779298972085
                                         uncertainty =       0.031646263315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374521995
  error estimate for blocks of size 2^( 2) =       0.001445716395
  error estimate for blocks of size 2^( 3) =       0.001509057579
  error estimate for blocks of size 2^( 4) =       0.001554000231
  error estimate for blocks of size 2^( 5) =       0.001579937137
  error estimate for blocks of size 2^( 6) =       0.001593405955
  error estimate for blocks of size 2^( 7) =       0.001597634804

      target function =                  N/A
              le_mean =     -22.325748587986
             les_mean =     502.168407870074
             stat err =       0.001581244532
             autocorr =       1.323410833503
              std dev =       1.943898749368
             le_variance =       3.778742347796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779582867688
                                         uncertainty =       0.031642597886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779582867688
                                         uncertainty =       0.031642597886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374573692
  error estimate for blocks of size 2^( 2) =       0.001445790338
  error estimate for blocks of size 2^( 3) =       0.001509175188
  error estimate for blocks of size 2^( 4) =       0.001554167591
  error estimate for blocks of size 2^( 5) =       0.001580081043
  error estimate for blocks of size 2^( 6) =       0.001593531466
  error estimate for blocks of size 2^( 7) =       0.001597734818

      target function =                  N/A
              le_mean =     -22.325815865717
             les_mean =     502.194050037180
             stat err =       0.001581378729
             autocorr =       1.323535914827
              std dev =       1.943971860350
             le_variance =       3.779026593833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779276356905
                                         uncertainty =       0.031659688812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779276356905
                                         uncertainty =       0.031659688812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374517784
  error estimate for blocks of size 2^( 2) =       0.001445673736
  error estimate for blocks of size 2^( 3) =       0.001508979293
  error estimate for blocks of size 2^( 4) =       0.001553896789
  error estimate for blocks of size 2^( 5) =       0.001579857608
  error estimate for blocks of size 2^( 6) =       0.001593355589
  error estimate for blocks of size 2^( 7) =       0.001597630119

      target function =                  N/A
              le_mean =     -22.325744988515
             les_mean =     502.166912595674
             stat err =       0.001581185026
             autocorr =       1.323319338473
              std dev =       1.943892794098
             le_variance =       3.778719194946


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325784952733        initial
     2.2737e-02     2.2737e-01             2.9253e-03       -22.325748587986
     9.0949e-02     9.0949e-01             1.9341e-03       -22.325815865717  <--
     3.6380e-01     3.6380e+00             9.1424e-04       -22.325744988515

*****************************************************************************
Applying the update for shift_i =   9.0949e-02     and shift_s =   9.0949e-01
*****************************************************************************

  Execution time = 4.4568e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_001                -6.965729e-01 3 1  ON 0
ci_002                -7.036862e-01 3 1  ON 1
ci_003                -6.172986e-02 3 1  ON 2
ci_004                -6.226355e-02 3 1  ON 3
ci_005                 4.466208e-02 3 1  ON 4
ci_006                 4.581500e-02 3 1  ON 5
ci_007                 3.093528e-02 3 1  ON 6
ci_008                 3.125238e-02 3 1  ON 7
ci_009                -2.630956e-02 3 1  ON 8
ci_010                -2.489129e-02 3 1  ON 9
ci_011                -2.190851e-02 3 1  ON 10
ci_012                -2.342147e-02 3 1  ON 11
ci_013                 2.094862e-02 3 1  ON 12
ci_014                 1.871332e-02 3 1  ON 13
ci_015                 2.029321e-02 3 1  ON 14
ci_016                 2.281828e-02 3 1  ON 15
ci_017                 1.476211e-02 3 1  ON 16
ci_018                 1.622059e-02 3 1  ON 17
ci_019                 8.908024e-03 3 1  ON 18
ci_020                 1.062684e-02 3 1  ON 19
ci_021                -9.169862e-03 3 1  ON 20
ci_022                -1.122819e-02 3 1  ON 21
ci_023                 9.566447e-03 3 1  ON 22
ci_024                 8.502261e-03 3 1  ON 23
ci_025                 8.864252e-03 3 1  ON 24
ci_026                 8.774889e-03 3 1  ON 25
ci_027                 7.116587e-03 3 1  ON 26
ci_028                 7.942766e-03 3 1  ON 27
ci_029                -8.876766e-03 3 1  ON 28
ci_030                -6.195065e-03 3 1  ON 29
ci_031                -7.593241e-03 3 1  ON 30
ci_032                -7.102949e-03 3 1  ON 31
ci_033                 8.562045e-03 3 1  ON 32
ci_034                 7.388913e-03 3 1  ON 33
ci_035                 6.274406e-03 3 1  ON 34
ci_036                 6.704809e-03 3 1  ON 35
ci_037                 5.662180e-03 3 1  ON 36
ci_038                 5.473718e-03 3 1  ON 37
ci_039                 5.808519e-03 3 1  ON 38
ci_040                 6.106859e-03 3 1  ON 39
ci_041                 5.215763e-03 3 1  ON 40
ci_042                 5.806201e-03 3 1  ON 41
ci_043                 5.018325e-03 3 1  ON 42
ci_044                 5.002212e-03 3 1  ON 43
ci_045                 4.473565e-03 3 1  ON 44
ci_046                 4.439345e-03 3 1  ON 45
ci_047                -3.762108e-03 3 1  ON 46
ci_048                -4.812240e-03 3 1  ON 47
ci_049                 3.955982e-03 3 1  ON 48
ci_050                 4.329257e-03 3 1  ON 49
ci_051                -2.402411e-03 3 1  ON 50
ci_052                -2.165681e-03 3 1  ON 51
ci_053                -2.200792e-03 3 1  ON 52
ci_054                -3.467144e-03 3 1  ON 53
ci_055                -2.720604e-03 3 1  ON 54
ci_056                -1.750866e-03 3 1  ON 55
ci_057                -1.988628e-03 3 1  ON 56
ci_058                -2.546454e-03 3 1  ON 57
ci_059                -1.878851e-03 3 1  ON 58
ci_060                -7.338472e-04 3 1  ON 59
ci_061                -1.589779e-03 3 1  ON 60
ci_062                -1.899253e-03 3 1  ON 61
ci_063                -1.446938e-03 3 1  ON 62
ci_064                -2.088481e-03 3 1  ON 63
ci_065                -1.932376e-03 3 1  ON 64
ci_066                -1.431184e-03 3 1  ON 65
ci_067                -8.413988e-04 3 1  ON 66
ci_068                -2.496658e-03 3 1  ON 67
ci_069                 1.381286e-03 3 1  ON 68
ci_070                 1.427736e-03 3 1  ON 69
ci_071                -9.929218e-04 3 1  ON 70
ci_072                -2.739400e-03 3 1  ON 71
ci_073                 1.614760e-03 3 1  ON 72
ci_074                 1.197379e-03 3 1  ON 73
ci_075                -8.320747e-04 3 1  ON 74
ci_076                -1.295729e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3836e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2277e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.3085
    reference variance = 2.72023
====================================================
  Execution time = 2.3430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0289e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7617e+00
  Total weights = 1.950148866e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8122e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813924075633
                                         uncertainty =       0.045691086689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813924075633
                                         uncertainty =       0.045691086689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380860620
  error estimate for blocks of size 2^( 2) =       0.001450863233
  error estimate for blocks of size 2^( 3) =       0.001513767750
  error estimate for blocks of size 2^( 4) =       0.001556848019
  error estimate for blocks of size 2^( 5) =       0.001580444280
  error estimate for blocks of size 2^( 6) =       0.001587265657
  error estimate for blocks of size 2^( 7) =       0.001596281583

      target function =                  N/A
              le_mean =     -22.330096803108
             les_mean =     502.394962627176
             stat err =       0.001580209885
             autocorr =       1.309573442956
              std dev =       1.952863062074
             le_variance =       3.813674139214


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233009680311e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-02, overlap shift 2.2737e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330096802304       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330227141592       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330238804478       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330242168343       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.330244465894       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.330247189729       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.330247618107       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.330247948939       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.330247898101       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e-02 is 4.567630e-03

solving harmonic davidson linear method for identity shift 9.0949e-02, overlap shift 9.0949e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330096802304       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330196832207       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330201271413       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330202130772       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.330202352878       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.330202447447       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e-02 is 2.100360e-03

solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330096802304       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330148626130       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330148871890       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330148939813       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e-01 is 9.701902e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230023 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9254e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_001                -6.976779e-01 3 1  ON 0
ci_002                -7.026930e-01 3 1  ON 1
ci_003                -6.163090e-02 3 1  ON 2
ci_004                -6.270867e-02 3 1  ON 3
ci_005                 4.594148e-02 3 1  ON 4
ci_006                 4.432505e-02 3 1  ON 5
ci_007                 3.136219e-02 3 1  ON 6
ci_008                 3.141618e-02 3 1  ON 7
ci_009                -2.566135e-02 3 1  ON 8
ci_010                -2.483790e-02 3 1  ON 9
ci_011                -2.250121e-02 3 1  ON 10
ci_012                -2.326153e-02 3 1  ON 11
ci_013                 1.884826e-02 3 1  ON 12
ci_014                 1.937658e-02 3 1  ON 13
ci_015                 1.997360e-02 3 1  ON 14
ci_016                 2.144660e-02 3 1  ON 15
ci_017                 1.516849e-02 3 1  ON 16
ci_018                 1.552577e-02 3 1  ON 17
ci_019                 1.033666e-02 3 1  ON 18
ci_020                 1.095743e-02 3 1  ON 19
ci_021                -1.039439e-02 3 1  ON 20
ci_022                -1.032938e-02 3 1  ON 21
ci_023                 8.878999e-03 3 1  ON 22
ci_024                 8.947738e-03 3 1  ON 23
ci_025                 7.755901e-03 3 1  ON 24
ci_026                 8.550415e-03 3 1  ON 25
ci_027                 7.912479e-03 3 1  ON 26
ci_028                 7.377727e-03 3 1  ON 27
ci_029                -8.169741e-03 3 1  ON 28
ci_030                -7.347090e-03 3 1  ON 29
ci_031                -6.067786e-03 3 1  ON 30
ci_032                -7.310141e-03 3 1  ON 31
ci_033                 7.968517e-03 3 1  ON 32
ci_034                 8.023767e-03 3 1  ON 33
ci_035                 6.544934e-03 3 1  ON 34
ci_036                 6.719397e-03 3 1  ON 35
ci_037                 5.701592e-03 3 1  ON 36
ci_038                 6.344410e-03 3 1  ON 37
ci_039                 5.074352e-03 3 1  ON 38
ci_040                 5.795714e-03 3 1  ON 39
ci_041                 5.760751e-03 3 1  ON 40
ci_042                 4.984151e-03 3 1  ON 41
ci_043                 5.664259e-03 3 1  ON 42
ci_044                 4.967681e-03 3 1  ON 43
ci_045                 4.403305e-03 3 1  ON 44
ci_046                 5.282731e-03 3 1  ON 45
ci_047                -4.243083e-03 3 1  ON 46
ci_048                -3.295626e-03 3 1  ON 47
ci_049                 4.566299e-03 3 1  ON 48
ci_050                 3.386491e-03 3 1  ON 49
ci_051                -2.842016e-03 3 1  ON 50
ci_052                -1.869130e-03 3 1  ON 51
ci_053                -2.616941e-03 3 1  ON 52
ci_054                -2.954308e-03 3 1  ON 53
ci_055                -2.716576e-03 3 1  ON 54
ci_056                -2.400980e-03 3 1  ON 55
ci_057                -2.604710e-03 3 1  ON 56
ci_058                -1.845265e-03 3 1  ON 57
ci_059                -1.154216e-03 3 1  ON 58
ci_060                -1.671233e-03 3 1  ON 59
ci_061                -1.980827e-03 3 1  ON 60
ci_062                -7.319680e-04 3 1  ON 61
ci_063                -1.223387e-03 3 1  ON 62
ci_064                -2.028460e-03 3 1  ON 63
ci_065                -1.854716e-03 3 1  ON 64
ci_066                -8.996332e-04 3 1  ON 65
ci_067                -6.744301e-04 3 1  ON 66
ci_068                -1.645907e-03 3 1  ON 67
ci_069                 1.221793e-03 3 1  ON 68
ci_070                 3.152294e-04 3 1  ON 69
ci_071                -2.168552e-03 3 1  ON 70
ci_072                -2.345373e-03 3 1  ON 71
ci_073                 1.294363e-03 3 1  ON 72
ci_074                 1.310997e-03 3 1  ON 73
ci_075                -5.467909e-04 3 1  ON 74
ci_076                -1.286740e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.2911
    reference variance = 2.93671
====================================================
  Execution time = 2.5216e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6900e+00
  Total weights = 1.9501e+06
  Execution time = 4.3130e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0401854
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.743056342343
                                         uncertainty =       0.034570679656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.743056342343
                                         uncertainty =       0.034570679656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368017393
  error estimate for blocks of size 2^( 2) =       0.001439590760
  error estimate for blocks of size 2^( 3) =       0.001502259602
  error estimate for blocks of size 2^( 4) =       0.001545120088
  error estimate for blocks of size 2^( 5) =       0.001571860321
  error estimate for blocks of size 2^( 6) =       0.001581569637
  error estimate for blocks of size 2^( 7) =       0.001592578471

      target function =                  N/A
              le_mean =     -22.330070402031
             les_mean =     502.369491204093
             stat err =       0.001572782129
             autocorr =       1.321763921436
              std dev =       1.934699705817
             le_variance =       3.743062951690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742454635361
                                         uncertainty =       0.034587365681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742454635361
                                         uncertainty =       0.034587365681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367907443
  error estimate for blocks of size 2^( 2) =       0.001439516854
  error estimate for blocks of size 2^( 3) =       0.001502244201
  error estimate for blocks of size 2^( 4) =       0.001545140573
  error estimate for blocks of size 2^( 5) =       0.001571875773
  error estimate for blocks of size 2^( 6) =       0.001581652596
  error estimate for blocks of size 2^( 7) =       0.001592658710

      target function =                  N/A
              le_mean =     -22.330018895359
             les_mean =     502.322391717829
             stat err =       0.001572831913
             autocorr =       1.322060103029
              std dev =       1.934544210465
             le_variance =       3.742461302246

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0390654
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742897753960
                                         uncertainty =       0.034581272205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742897753960
                                         uncertainty =       0.034581272205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367988224
  error estimate for blocks of size 2^( 2) =       0.001439604923
  error estimate for blocks of size 2^( 3) =       0.001502348598
  error estimate for blocks of size 2^( 4) =       0.001545250281
  error estimate for blocks of size 2^( 5) =       0.001571956843
  error estimate for blocks of size 2^( 6) =       0.001581726364
  error estimate for blocks of size 2^( 7) =       0.001592751710

      target function =                  N/A
              le_mean =     -22.330085362092
             les_mean =     502.378193038089
             stat err =       0.001572921299
             autocorr =       1.322054226953
              std dev =       1.934658453108
             le_variance =       3.742903330181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742462223198
                                         uncertainty =       0.034586491515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742462223198
                                         uncertainty =       0.034586491515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367908945
  error estimate for blocks of size 2^( 2) =       0.001439502680
  error estimate for blocks of size 2^( 3) =       0.001502203476
  error estimate for blocks of size 2^( 4) =       0.001545068696
  error estimate for blocks of size 2^( 5) =       0.001571803970
  error estimate for blocks of size 2^( 6) =       0.001581564110
  error estimate for blocks of size 2^( 7) =       0.001592578182

      target function =                  N/A
              le_mean =     -22.330034900766
             les_mean =     502.326989451383
             stat err =       0.001572753740
             autocorr =       1.321925784629
              std dev =       1.934546334808
             le_variance =       3.742469521520


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330070402031        initial
     2.2737e-02     2.2737e-01             4.5676e-03       -22.330018895359
     9.0949e-02     9.0949e-01             2.1004e-03       -22.330085362092  <--
     3.6380e-01     3.6380e+00             9.7019e-04       -22.330034900766

*****************************************************************************
Applying the update for shift_i =   9.0949e-02     and shift_s =   9.0949e-01
*****************************************************************************

  Execution time = 4.6995e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_001                -6.976779e-01 3 1  ON 0
ci_002                -7.026930e-01 3 1  ON 1
ci_003                -6.163090e-02 3 1  ON 2
ci_004                -6.270867e-02 3 1  ON 3
ci_005                 4.594148e-02 3 1  ON 4
ci_006                 4.432505e-02 3 1  ON 5
ci_007                 3.136219e-02 3 1  ON 6
ci_008                 3.141618e-02 3 1  ON 7
ci_009                -2.566135e-02 3 1  ON 8
ci_010                -2.483790e-02 3 1  ON 9
ci_011                -2.250121e-02 3 1  ON 10
ci_012                -2.326153e-02 3 1  ON 11
ci_013                 1.884826e-02 3 1  ON 12
ci_014                 1.937658e-02 3 1  ON 13
ci_015                 1.997360e-02 3 1  ON 14
ci_016                 2.144660e-02 3 1  ON 15
ci_017                 1.516849e-02 3 1  ON 16
ci_018                 1.552577e-02 3 1  ON 17
ci_019                 1.033666e-02 3 1  ON 18
ci_020                 1.095743e-02 3 1  ON 19
ci_021                -1.039439e-02 3 1  ON 20
ci_022                -1.032938e-02 3 1  ON 21
ci_023                 8.878999e-03 3 1  ON 22
ci_024                 8.947738e-03 3 1  ON 23
ci_025                 7.755901e-03 3 1  ON 24
ci_026                 8.550415e-03 3 1  ON 25
ci_027                 7.912479e-03 3 1  ON 26
ci_028                 7.377727e-03 3 1  ON 27
ci_029                -8.169741e-03 3 1  ON 28
ci_030                -7.347090e-03 3 1  ON 29
ci_031                -6.067786e-03 3 1  ON 30
ci_032                -7.310141e-03 3 1  ON 31
ci_033                 7.968517e-03 3 1  ON 32
ci_034                 8.023767e-03 3 1  ON 33
ci_035                 6.544934e-03 3 1  ON 34
ci_036                 6.719397e-03 3 1  ON 35
ci_037                 5.701592e-03 3 1  ON 36
ci_038                 6.344410e-03 3 1  ON 37
ci_039                 5.074352e-03 3 1  ON 38
ci_040                 5.795714e-03 3 1  ON 39
ci_041                 5.760751e-03 3 1  ON 40
ci_042                 4.984151e-03 3 1  ON 41
ci_043                 5.664259e-03 3 1  ON 42
ci_044                 4.967681e-03 3 1  ON 43
ci_045                 4.403305e-03 3 1  ON 44
ci_046                 5.282731e-03 3 1  ON 45
ci_047                -4.243083e-03 3 1  ON 46
ci_048                -3.295626e-03 3 1  ON 47
ci_049                 4.566299e-03 3 1  ON 48
ci_050                 3.386491e-03 3 1  ON 49
ci_051                -2.842016e-03 3 1  ON 50
ci_052                -1.869130e-03 3 1  ON 51
ci_053                -2.616941e-03 3 1  ON 52
ci_054                -2.954308e-03 3 1  ON 53
ci_055                -2.716576e-03 3 1  ON 54
ci_056                -2.400980e-03 3 1  ON 55
ci_057                -2.604710e-03 3 1  ON 56
ci_058                -1.845265e-03 3 1  ON 57
ci_059                -1.154216e-03 3 1  ON 58
ci_060                -1.671233e-03 3 1  ON 59
ci_061                -1.980827e-03 3 1  ON 60
ci_062                -7.319680e-04 3 1  ON 61
ci_063                -1.223387e-03 3 1  ON 62
ci_064                -2.028460e-03 3 1  ON 63
ci_065                -1.854716e-03 3 1  ON 64
ci_066                -8.996332e-04 3 1  ON 65
ci_067                -6.744301e-04 3 1  ON 66
ci_068                -1.645907e-03 3 1  ON 67
ci_069                 1.221793e-03 3 1  ON 68
ci_070                 3.152294e-04 3 1  ON 69
ci_071                -2.168552e-03 3 1  ON 70
ci_072                -2.345373e-03 3 1  ON 71
ci_073                 1.294363e-03 3 1  ON 72
ci_074                 1.310997e-03 3 1  ON 73
ci_075                -5.467909e-04 3 1  ON 74
ci_076                -1.286740e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6265e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2278e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.421
    reference variance = 4.40712
====================================================
  Execution time = 2.3488e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0303e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7365e+00
  Total weights = 1.949901706e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9114e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789480856053
                                         uncertainty =       0.027601031697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789480856053
                                         uncertainty =       0.027601031697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376362921
  error estimate for blocks of size 2^( 2) =       0.001448794514
  error estimate for blocks of size 2^( 3) =       0.001514234709
  error estimate for blocks of size 2^( 4) =       0.001559717960
  error estimate for blocks of size 2^( 5) =       0.001584500596
  error estimate for blocks of size 2^( 6) =       0.001592941825
  error estimate for blocks of size 2^( 7) =       0.001598979115

      target function =                  N/A
              le_mean =     -22.327541923660
             les_mean =     502.255651961336
             stat err =       0.001584034874
             autocorr =       1.324535335895
              std dev =       1.946502253075
             le_variance =       3.788871021226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232754192366e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-02, overlap shift 2.2737e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327541922866       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327672086034       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327688774628       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327692929001       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327696153437       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327696875309       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327697555290       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.327699367253       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.327699731729       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e-02 is 3.455514e-03

solving harmonic davidson linear method for identity shift 9.0949e-02, overlap shift 9.0949e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327541922866       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327639995430       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327647592216       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327648580628       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327649055892       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327649000110       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e-02 is 1.775899e-03

solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327541922866       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327591300059       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327592602856       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327592636707       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e-01 is 8.078896e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9412e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_001                -6.985479e-01 3 1  ON 0
ci_002                -7.019262e-01 3 1  ON 1
ci_003                -6.038274e-02 3 1  ON 2
ci_004                -6.195645e-02 3 1  ON 3
ci_005                 4.558143e-02 3 1  ON 4
ci_006                 4.516740e-02 3 1  ON 5
ci_007                 3.134966e-02 3 1  ON 6
ci_008                 3.274739e-02 3 1  ON 7
ci_009                -2.609849e-02 3 1  ON 8
ci_010                -2.483286e-02 3 1  ON 9
ci_011                -2.203416e-02 3 1  ON 10
ci_012                -2.265947e-02 3 1  ON 11
ci_013                 1.939870e-02 3 1  ON 12
ci_014                 2.024042e-02 3 1  ON 13
ci_015                 2.048409e-02 3 1  ON 14
ci_016                 2.039103e-02 3 1  ON 15
ci_017                 1.553261e-02 3 1  ON 16
ci_018                 1.615256e-02 3 1  ON 17
ci_019                 8.560759e-03 3 1  ON 18
ci_020                 1.016838e-02 3 1  ON 19
ci_021                -1.007620e-02 3 1  ON 20
ci_022                -1.045034e-02 3 1  ON 21
ci_023                 8.515934e-03 3 1  ON 22
ci_024                 8.994975e-03 3 1  ON 23
ci_025                 8.833236e-03 3 1  ON 24
ci_026                 7.798478e-03 3 1  ON 25
ci_027                 8.319264e-03 3 1  ON 26
ci_028                 8.000314e-03 3 1  ON 27
ci_029                -8.359866e-03 3 1  ON 28
ci_030                -7.593326e-03 3 1  ON 29
ci_031                -7.470510e-03 3 1  ON 30
ci_032                -7.010866e-03 3 1  ON 31
ci_033                 7.129189e-03 3 1  ON 32
ci_034                 7.089765e-03 3 1  ON 33
ci_035                 6.724889e-03 3 1  ON 34
ci_036                 7.168324e-03 3 1  ON 35
ci_037                 6.288151e-03 3 1  ON 36
ci_038                 6.629249e-03 3 1  ON 37
ci_039                 5.861212e-03 3 1  ON 38
ci_040                 5.710117e-03 3 1  ON 39
ci_041                 6.356353e-03 3 1  ON 40
ci_042                 4.698932e-03 3 1  ON 41
ci_043                 5.453743e-03 3 1  ON 42
ci_044                 5.996770e-03 3 1  ON 43
ci_045                 4.172549e-03 3 1  ON 44
ci_046                 5.602433e-03 3 1  ON 45
ci_047                -4.873730e-03 3 1  ON 46
ci_048                -3.757136e-03 3 1  ON 47
ci_049                 2.911673e-03 3 1  ON 48
ci_050                 3.305284e-03 3 1  ON 49
ci_051                -2.547210e-03 3 1  ON 50
ci_052                -1.922283e-03 3 1  ON 51
ci_053                -2.944165e-03 3 1  ON 52
ci_054                -1.476278e-03 3 1  ON 53
ci_055                -1.940622e-03 3 1  ON 54
ci_056                -3.208411e-03 3 1  ON 55
ci_057                -2.527873e-03 3 1  ON 56
ci_058                -2.043781e-03 3 1  ON 57
ci_059                -1.055863e-03 3 1  ON 58
ci_060                -1.443419e-03 3 1  ON 59
ci_061                -6.971925e-04 3 1  ON 60
ci_062                -2.265731e-03 3 1  ON 61
ci_063                -8.743789e-04 3 1  ON 62
ci_064                -1.355744e-03 3 1  ON 63
ci_065                -1.782635e-03 3 1  ON 64
ci_066                -1.995460e-03 3 1  ON 65
ci_067                -1.547032e-03 3 1  ON 66
ci_068                -1.001224e-03 3 1  ON 67
ci_069                 1.274006e-03 3 1  ON 68
ci_070                 1.090985e-03 3 1  ON 69
ci_071                -1.707285e-03 3 1  ON 70
ci_072                -1.503204e-03 3 1  ON 71
ci_073                 9.303578e-04 3 1  ON 72
ci_074                 5.502305e-04 3 1  ON 73
ci_075                -5.931334e-04 3 1  ON 74
ci_076                -1.027198e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.4879
    reference variance = 2.63856
====================================================
  Execution time = 2.2863e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7048e+00
  Total weights = 1.9499e+06
  Execution time = 4.3018e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755806185244
                                         uncertainty =       0.045240887617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755806185244
                                         uncertainty =       0.045240887617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370542800
  error estimate for blocks of size 2^( 2) =       0.001441568809
  error estimate for blocks of size 2^( 3) =       0.001505707459
  error estimate for blocks of size 2^( 4) =       0.001547713278
  error estimate for blocks of size 2^( 5) =       0.001571590602
  error estimate for blocks of size 2^( 6) =       0.001581941196
  error estimate for blocks of size 2^( 7) =       0.001589280173

      target function =                  N/A
              le_mean =     -22.327132214005
             les_mean =     502.229384647118
             stat err =       0.001572631312
             autocorr =       1.316644813104
              std dev =       1.938271226482
             le_variance =       3.756895347407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755638064627
                                         uncertainty =       0.045257117224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755638064627
                                         uncertainty =       0.045257117224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370512149
  error estimate for blocks of size 2^( 2) =       0.001441534389
  error estimate for blocks of size 2^( 3) =       0.001505653406
  error estimate for blocks of size 2^( 4) =       0.001547640556
  error estimate for blocks of size 2^( 5) =       0.001571555892
  error estimate for blocks of size 2^( 6) =       0.001581902192
  error estimate for blocks of size 2^( 7) =       0.001589199178

      target function =                  N/A
              le_mean =     -22.327112054625
             les_mean =     502.206691166613
             stat err =       0.001572574454
             autocorr =       1.316608496700
              std dev =       1.938227879684
             le_variance =       3.756727313586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.756339129029
                                         uncertainty =       0.045204224373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.756339129029
                                         uncertainty =       0.045204224373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370639704
  error estimate for blocks of size 2^( 2) =       0.001441651115
  error estimate for blocks of size 2^( 3) =       0.001505749378
  error estimate for blocks of size 2^( 4) =       0.001547722606
  error estimate for blocks of size 2^( 5) =       0.001571638792
  error estimate for blocks of size 2^( 6) =       0.001581954955
  error estimate for blocks of size 2^( 7) =       0.001589304486

      target function =                  N/A
              le_mean =     -22.327182528349
             les_mean =     502.261279576330
             stat err =       0.001572655210
             autocorr =       1.316498654635
              std dev =       1.938408272536
             le_variance =       3.757426631034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755469552823
                                         uncertainty =       0.045234478509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755469552823
                                         uncertainty =       0.045234478509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370481406
  error estimate for blocks of size 2^( 2) =       0.001441503707
  error estimate for blocks of size 2^( 3) =       0.001505636545
  error estimate for blocks of size 2^( 4) =       0.001547645830
  error estimate for blocks of size 2^( 5) =       0.001571567324
  error estimate for blocks of size 2^( 6) =       0.001581922373
  error estimate for blocks of size 2^( 7) =       0.001589235524

      target function =                  N/A
              le_mean =     -22.327109608352
             les_mean =     502.225589121580
             stat err =       0.001572592763
             autocorr =       1.316698225932
              std dev =       1.938184400850
             le_variance =       3.756558771700


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327132214005        initial
     2.2737e-02     2.2737e-01             3.4555e-03       -22.327112054625
     9.0949e-02     9.0949e-01             1.7759e-03       -22.327182528349  <--
     3.6380e-01     3.6380e+00             8.0789e-04       -22.327109608352

*****************************************************************************
Applying the update for shift_i =   9.0949e-02     and shift_s =   9.0949e-01
*****************************************************************************

  Execution time = 4.4593e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_001                -6.985479e-01 3 1  ON 0
ci_002                -7.019262e-01 3 1  ON 1
ci_003                -6.038274e-02 3 1  ON 2
ci_004                -6.195645e-02 3 1  ON 3
ci_005                 4.558143e-02 3 1  ON 4
ci_006                 4.516740e-02 3 1  ON 5
ci_007                 3.134966e-02 3 1  ON 6
ci_008                 3.274739e-02 3 1  ON 7
ci_009                -2.609849e-02 3 1  ON 8
ci_010                -2.483286e-02 3 1  ON 9
ci_011                -2.203416e-02 3 1  ON 10
ci_012                -2.265947e-02 3 1  ON 11
ci_013                 1.939870e-02 3 1  ON 12
ci_014                 2.024042e-02 3 1  ON 13
ci_015                 2.048409e-02 3 1  ON 14
ci_016                 2.039103e-02 3 1  ON 15
ci_017                 1.553261e-02 3 1  ON 16
ci_018                 1.615256e-02 3 1  ON 17
ci_019                 8.560759e-03 3 1  ON 18
ci_020                 1.016838e-02 3 1  ON 19
ci_021                -1.007620e-02 3 1  ON 20
ci_022                -1.045034e-02 3 1  ON 21
ci_023                 8.515934e-03 3 1  ON 22
ci_024                 8.994975e-03 3 1  ON 23
ci_025                 8.833236e-03 3 1  ON 24
ci_026                 7.798478e-03 3 1  ON 25
ci_027                 8.319264e-03 3 1  ON 26
ci_028                 8.000314e-03 3 1  ON 27
ci_029                -8.359866e-03 3 1  ON 28
ci_030                -7.593326e-03 3 1  ON 29
ci_031                -7.470510e-03 3 1  ON 30
ci_032                -7.010866e-03 3 1  ON 31
ci_033                 7.129189e-03 3 1  ON 32
ci_034                 7.089765e-03 3 1  ON 33
ci_035                 6.724889e-03 3 1  ON 34
ci_036                 7.168324e-03 3 1  ON 35
ci_037                 6.288151e-03 3 1  ON 36
ci_038                 6.629249e-03 3 1  ON 37
ci_039                 5.861212e-03 3 1  ON 38
ci_040                 5.710117e-03 3 1  ON 39
ci_041                 6.356353e-03 3 1  ON 40
ci_042                 4.698932e-03 3 1  ON 41
ci_043                 5.453743e-03 3 1  ON 42
ci_044                 5.996770e-03 3 1  ON 43
ci_045                 4.172549e-03 3 1  ON 44
ci_046                 5.602433e-03 3 1  ON 45
ci_047                -4.873730e-03 3 1  ON 46
ci_048                -3.757136e-03 3 1  ON 47
ci_049                 2.911673e-03 3 1  ON 48
ci_050                 3.305284e-03 3 1  ON 49
ci_051                -2.547210e-03 3 1  ON 50
ci_052                -1.922283e-03 3 1  ON 51
ci_053                -2.944165e-03 3 1  ON 52
ci_054                -1.476278e-03 3 1  ON 53
ci_055                -1.940622e-03 3 1  ON 54
ci_056                -3.208411e-03 3 1  ON 55
ci_057                -2.527873e-03 3 1  ON 56
ci_058                -2.043781e-03 3 1  ON 57
ci_059                -1.055863e-03 3 1  ON 58
ci_060                -1.443419e-03 3 1  ON 59
ci_061                -6.971925e-04 3 1  ON 60
ci_062                -2.265731e-03 3 1  ON 61
ci_063                -8.743789e-04 3 1  ON 62
ci_064                -1.355744e-03 3 1  ON 63
ci_065                -1.782635e-03 3 1  ON 64
ci_066                -1.995460e-03 3 1  ON 65
ci_067                -1.547032e-03 3 1  ON 66
ci_068                -1.001224e-03 3 1  ON 67
ci_069                 1.274006e-03 3 1  ON 68
ci_070                 1.090985e-03 3 1  ON 69
ci_071                -1.707285e-03 3 1  ON 70
ci_072                -1.503204e-03 3 1  ON 71
ci_073                 9.303578e-04 3 1  ON 72
ci_074                 5.502305e-04 3 1  ON 73
ci_075                -5.931334e-04 3 1  ON 74
ci_076                -1.027198e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4021e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2282e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.4028
    reference variance = 2.80728
====================================================
  Execution time = 2.3394e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0316e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7455e+00
  Total weights = 1.950073967e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9319e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795439763318
                                         uncertainty =       0.033075195419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795439763318
                                         uncertainty =       0.033075195419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377636064
  error estimate for blocks of size 2^( 2) =       0.001449705262
  error estimate for blocks of size 2^( 3) =       0.001512242467
  error estimate for blocks of size 2^( 4) =       0.001555571855
  error estimate for blocks of size 2^( 5) =       0.001578249929
  error estimate for blocks of size 2^( 6) =       0.001587759659
  error estimate for blocks of size 2^( 7) =       0.001596510046

      target function =                  N/A
              le_mean =     -22.327010152114
             les_mean =     502.240835967618
             stat err =       0.001579522872
             autocorr =       1.314567320104
              std dev =       1.948302777453
             le_variance =       3.795883712631


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232701015211e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-02, overlap shift 2.2737e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327010151319       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327122812494       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327128937904       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327130817535       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327131723473       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327131524864       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327131497570       residual = 1.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e-02 is 2.660587e-03

solving harmonic davidson linear method for identity shift 9.0949e-02, overlap shift 9.0949e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327010151319       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327095359940       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327097746318       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327098274787       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327098489905       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327098430551       residual = 9.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e-02 is 1.870162e-03

solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327010151319       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327053301122       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327053464040       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327053478641       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e-01 is 9.005330e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239050 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9339e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_001                -6.984925e-01 3 1  ON 0
ci_002                -7.018563e-01 3 1  ON 1
ci_003                -6.086135e-02 3 1  ON 2
ci_004                -6.320054e-02 3 1  ON 3
ci_005                 4.582341e-02 3 1  ON 4
ci_006                 4.624684e-02 3 1  ON 5
ci_007                 3.112303e-02 3 1  ON 6
ci_008                 3.207850e-02 3 1  ON 7
ci_009                -2.532815e-02 3 1  ON 8
ci_010                -2.458343e-02 3 1  ON 9
ci_011                -2.278129e-02 3 1  ON 10
ci_012                -2.232760e-02 3 1  ON 11
ci_013                 1.993341e-02 3 1  ON 12
ci_014                 1.928356e-02 3 1  ON 13
ci_015                 1.927431e-02 3 1  ON 14
ci_016                 2.013542e-02 3 1  ON 15
ci_017                 1.518963e-02 3 1  ON 16
ci_018                 1.603945e-02 3 1  ON 17
ci_019                 1.015477e-02 3 1  ON 18
ci_020                 1.132090e-02 3 1  ON 19
ci_021                -8.966253e-03 3 1  ON 20
ci_022                -9.441191e-03 3 1  ON 21
ci_023                 9.147071e-03 3 1  ON 22
ci_024                 8.986392e-03 3 1  ON 23
ci_025                 8.652892e-03 3 1  ON 24
ci_026                 8.696310e-03 3 1  ON 25
ci_027                 8.016282e-03 3 1  ON 26
ci_028                 7.867702e-03 3 1  ON 27
ci_029                -8.794337e-03 3 1  ON 28
ci_030                -7.696613e-03 3 1  ON 29
ci_031                -8.163233e-03 3 1  ON 30
ci_032                -8.552830e-03 3 1  ON 31
ci_033                 7.246732e-03 3 1  ON 32
ci_034                 7.272340e-03 3 1  ON 33
ci_035                 6.394403e-03 3 1  ON 34
ci_036                 6.405760e-03 3 1  ON 35
ci_037                 5.831325e-03 3 1  ON 36
ci_038                 7.726537e-03 3 1  ON 37
ci_039                 5.888077e-03 3 1  ON 38
ci_040                 6.106064e-03 3 1  ON 39
ci_041                 4.839847e-03 3 1  ON 40
ci_042                 4.521475e-03 3 1  ON 41
ci_043                 5.355934e-03 3 1  ON 42
ci_044                 4.952958e-03 3 1  ON 43
ci_045                 4.853666e-03 3 1  ON 44
ci_046                 5.684189e-03 3 1  ON 45
ci_047                -4.643576e-03 3 1  ON 46
ci_048                -3.279683e-03 3 1  ON 47
ci_049                 3.700668e-03 3 1  ON 48
ci_050                 2.686037e-03 3 1  ON 49
ci_051                -2.200834e-03 3 1  ON 50
ci_052                -1.964217e-03 3 1  ON 51
ci_053                -1.733799e-03 3 1  ON 52
ci_054                -1.833418e-03 3 1  ON 53
ci_055                -3.810784e-03 3 1  ON 54
ci_056                -2.194584e-03 3 1  ON 55
ci_057                -2.326552e-03 3 1  ON 56
ci_058                -1.640085e-03 3 1  ON 57
ci_059                -9.461426e-04 3 1  ON 58
ci_060                -1.095852e-03 3 1  ON 59
ci_061                -2.312579e-03 3 1  ON 60
ci_062                -2.384230e-03 3 1  ON 61
ci_063                -2.709233e-03 3 1  ON 62
ci_064                -1.176043e-03 3 1  ON 63
ci_065                -1.845658e-03 3 1  ON 64
ci_066                -2.153874e-03 3 1  ON 65
ci_067                -2.009858e-03 3 1  ON 66
ci_068                -7.171943e-04 3 1  ON 67
ci_069                 1.334813e-03 3 1  ON 68
ci_070                 1.760640e-03 3 1  ON 69
ci_071                -7.198790e-04 3 1  ON 70
ci_072                -1.545439e-03 3 1  ON 71
ci_073                 4.266501e-04 3 1  ON 72
ci_074                 7.037243e-04 3 1  ON 73
ci_075                -2.287012e-03 3 1  ON 74
ci_076                -1.733760e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.151
    reference variance = 3.19269
====================================================
  Execution time = 2.2843e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7077e+00
  Total weights = 1.9497e+06
  Execution time = 4.3200e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.2511
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762633772764
                                         uncertainty =       0.027992477310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762633772764
                                         uncertainty =       0.027992477310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371555150
  error estimate for blocks of size 2^( 2) =       0.001443097759
  error estimate for blocks of size 2^( 3) =       0.001507534913
  error estimate for blocks of size 2^( 4) =       0.001555225213
  error estimate for blocks of size 2^( 5) =       0.001583387335
  error estimate for blocks of size 2^( 6) =       0.001592470476
  error estimate for blocks of size 2^( 7) =       0.001597510852

      target function =                  N/A
              le_mean =     -22.327353493957
             les_mean =     502.275761077931
             stat err =       0.001582148469
             autocorr =       1.330662506419
              std dev =       1.939702929484
             le_variance =       3.762447454650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760201868324
                                         uncertainty =       0.028090002288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760201868324
                                         uncertainty =       0.028090002288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371113849
  error estimate for blocks of size 2^( 2) =       0.001442662017
  error estimate for blocks of size 2^( 3) =       0.001507097984
  error estimate for blocks of size 2^( 4) =       0.001554780478
  error estimate for blocks of size 2^( 5) =       0.001583219903
  error estimate for blocks of size 2^( 6) =       0.001592320494
  error estimate for blocks of size 2^( 7) =       0.001597084093

      target function =                  N/A
              le_mean =     -22.327266599144
             les_mean =     502.219990905355
             stat err =       0.001581851242
             autocorr =       1.331018969552
              std dev =       1.939078824718
             le_variance =       3.760026688471

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.266579
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763978586835
                                         uncertainty =       0.027940660420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763978586835
                                         uncertainty =       0.027940660420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371802167
  error estimate for blocks of size 2^( 2) =       0.001443291938
  error estimate for blocks of size 2^( 3) =       0.001507711943
  error estimate for blocks of size 2^( 4) =       0.001555374668
  error estimate for blocks of size 2^( 5) =       0.001584085542
  error estimate for blocks of size 2^( 6) =       0.001593402388
  error estimate for blocks of size 2^( 7) =       0.001598086891

      target function =                  N/A
              le_mean =     -22.327280964315
             les_mean =     502.573117396962
             stat err =       0.001582737372
             autocorr =       1.331173749985
              std dev =       1.940052269992
             le_variance =       3.763802810300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759902962319
                                         uncertainty =       0.028102066422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759902962319
                                         uncertainty =       0.028102066422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371059386
  error estimate for blocks of size 2^( 2) =       0.001442621133
  error estimate for blocks of size 2^( 3) =       0.001507065088
  error estimate for blocks of size 2^( 4) =       0.001554749271
  error estimate for blocks of size 2^( 5) =       0.001583162158
  error estimate for blocks of size 2^( 6) =       0.001592224271
  error estimate for blocks of size 2^( 7) =       0.001597059809

      target function =                  N/A
              le_mean =     -22.327267919798
             les_mean =     502.249142446965
             stat err =       0.001581798877
             autocorr =       1.331036587907
              std dev =       1.939001801504
             le_variance =       3.759727986236


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327353493957        initial  <--
     2.2737e-02     2.2737e-01             2.6606e-03       -22.327266599144
     9.0949e-02     9.0949e-01             1.8702e-03       -22.327280964315
     3.6380e-01     3.6380e+00             9.0053e-04       -22.327267919798

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6188
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_001                -6.985479e-01 3 1  ON 0
ci_002                -7.019262e-01 3 1  ON 1
ci_003                -6.038274e-02 3 1  ON 2
ci_004                -6.195645e-02 3 1  ON 3
ci_005                 4.558143e-02 3 1  ON 4
ci_006                 4.516740e-02 3 1  ON 5
ci_007                 3.134966e-02 3 1  ON 6
ci_008                 3.274739e-02 3 1  ON 7
ci_009                -2.609849e-02 3 1  ON 8
ci_010                -2.483286e-02 3 1  ON 9
ci_011                -2.203416e-02 3 1  ON 10
ci_012                -2.265947e-02 3 1  ON 11
ci_013                 1.939870e-02 3 1  ON 12
ci_014                 2.024042e-02 3 1  ON 13
ci_015                 2.048409e-02 3 1  ON 14
ci_016                 2.039103e-02 3 1  ON 15
ci_017                 1.553261e-02 3 1  ON 16
ci_018                 1.615256e-02 3 1  ON 17
ci_019                 8.560759e-03 3 1  ON 18
ci_020                 1.016838e-02 3 1  ON 19
ci_021                -1.007620e-02 3 1  ON 20
ci_022                -1.045034e-02 3 1  ON 21
ci_023                 8.515934e-03 3 1  ON 22
ci_024                 8.994975e-03 3 1  ON 23
ci_025                 8.833236e-03 3 1  ON 24
ci_026                 7.798478e-03 3 1  ON 25
ci_027                 8.319264e-03 3 1  ON 26
ci_028                 8.000314e-03 3 1  ON 27
ci_029                -8.359866e-03 3 1  ON 28
ci_030                -7.593326e-03 3 1  ON 29
ci_031                -7.470510e-03 3 1  ON 30
ci_032                -7.010866e-03 3 1  ON 31
ci_033                 7.129189e-03 3 1  ON 32
ci_034                 7.089765e-03 3 1  ON 33
ci_035                 6.724889e-03 3 1  ON 34
ci_036                 7.168324e-03 3 1  ON 35
ci_037                 6.288151e-03 3 1  ON 36
ci_038                 6.629249e-03 3 1  ON 37
ci_039                 5.861212e-03 3 1  ON 38
ci_040                 5.710117e-03 3 1  ON 39
ci_041                 6.356353e-03 3 1  ON 40
ci_042                 4.698932e-03 3 1  ON 41
ci_043                 5.453743e-03 3 1  ON 42
ci_044                 5.996770e-03 3 1  ON 43
ci_045                 4.172549e-03 3 1  ON 44
ci_046                 5.602433e-03 3 1  ON 45
ci_047                -4.873730e-03 3 1  ON 46
ci_048                -3.757136e-03 3 1  ON 47
ci_049                 2.911673e-03 3 1  ON 48
ci_050                 3.305284e-03 3 1  ON 49
ci_051                -2.547210e-03 3 1  ON 50
ci_052                -1.922283e-03 3 1  ON 51
ci_053                -2.944165e-03 3 1  ON 52
ci_054                -1.476278e-03 3 1  ON 53
ci_055                -1.940622e-03 3 1  ON 54
ci_056                -3.208411e-03 3 1  ON 55
ci_057                -2.527873e-03 3 1  ON 56
ci_058                -2.043781e-03 3 1  ON 57
ci_059                -1.055863e-03 3 1  ON 58
ci_060                -1.443419e-03 3 1  ON 59
ci_061                -6.971925e-04 3 1  ON 60
ci_062                -2.265731e-03 3 1  ON 61
ci_063                -8.743789e-04 3 1  ON 62
ci_064                -1.355744e-03 3 1  ON 63
ci_065                -1.782635e-03 3 1  ON 64
ci_066                -1.995460e-03 3 1  ON 65
ci_067                -1.547032e-03 3 1  ON 66
ci_068                -1.001224e-03 3 1  ON 67
ci_069                 1.274006e-03 3 1  ON 68
ci_070                 1.090985e-03 3 1  ON 69
ci_071                -1.707285e-03 3 1  ON 70
ci_072                -1.503204e-03 3 1  ON 71
ci_073                 9.303578e-04 3 1  ON 72
ci_074                 5.502305e-04 3 1  ON 73
ci_075                -5.931334e-04 3 1  ON 74
ci_076                -1.027198e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3976e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2282e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.641
    reference variance = 1.7064
====================================================
  Execution time = 2.3410e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0333e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7120e+00
  Total weights = 1.950052010e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8955e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762602835873
                                         uncertainty =       0.033922094434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762602835873
                                         uncertainty =       0.033922094434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371705030
  error estimate for blocks of size 2^( 2) =       0.001442184570
  error estimate for blocks of size 2^( 3) =       0.001503513961
  error estimate for blocks of size 2^( 4) =       0.001549773273
  error estimate for blocks of size 2^( 5) =       0.001576138503
  error estimate for blocks of size 2^( 6) =       0.001589106666
  error estimate for blocks of size 2^( 7) =       0.001587350578

      target function =                  N/A
              le_mean =     -22.325556932351
             les_mean =     502.142505125143
             stat err =       0.001575592255
             autocorr =       1.319368807463
              std dev =       1.939914894941
             le_variance =       3.763269799616


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232555693235e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-01, overlap shift 2.2737e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325556931526       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325591538533       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325592902709       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325593013879       residual = 7.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e-01 is 1.109720e-03

solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325556931526       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325570195796       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325570391803       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e-01 is 4.233027e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325556931526       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325560757528       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325560792258       residual = 6.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+00 is 1.217366e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.242120 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9315e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_001                -6.985062e-01 3 1  ON 0
ci_002                -7.019669e-01 3 1  ON 1
ci_003                -6.048741e-02 3 1  ON 2
ci_004                -6.199637e-02 3 1  ON 3
ci_005                 4.553904e-02 3 1  ON 4
ci_006                 4.530505e-02 3 1  ON 5
ci_007                 3.115225e-02 3 1  ON 6
ci_008                 3.275039e-02 3 1  ON 7
ci_009                -2.613883e-02 3 1  ON 8
ci_010                -2.475334e-02 3 1  ON 9
ci_011                -2.228300e-02 3 1  ON 10
ci_012                -2.273489e-02 3 1  ON 11
ci_013                 1.921636e-02 3 1  ON 12
ci_014                 2.016907e-02 3 1  ON 13
ci_015                 2.025800e-02 3 1  ON 14
ci_016                 2.050492e-02 3 1  ON 15
ci_017                 1.558249e-02 3 1  ON 16
ci_018                 1.601035e-02 3 1  ON 17
ci_019                 8.649251e-03 3 1  ON 18
ci_020                 1.016007e-02 3 1  ON 19
ci_021                -1.001588e-02 3 1  ON 20
ci_022                -1.041457e-02 3 1  ON 21
ci_023                 8.481111e-03 3 1  ON 22
ci_024                 8.990428e-03 3 1  ON 23
ci_025                 8.609428e-03 3 1  ON 24
ci_026                 7.993889e-03 3 1  ON 25
ci_027                 8.363677e-03 3 1  ON 26
ci_028                 7.846396e-03 3 1  ON 27
ci_029                -8.394694e-03 3 1  ON 28
ci_030                -7.430340e-03 3 1  ON 29
ci_031                -7.433662e-03 3 1  ON 30
ci_032                -7.019405e-03 3 1  ON 31
ci_033                 7.099599e-03 3 1  ON 32
ci_034                 7.048302e-03 3 1  ON 33
ci_035                 6.811930e-03 3 1  ON 34
ci_036                 7.147576e-03 3 1  ON 35
ci_037                 6.230285e-03 3 1  ON 36
ci_038                 6.710858e-03 3 1  ON 37
ci_039                 5.768603e-03 3 1  ON 38
ci_040                 5.790084e-03 3 1  ON 39
ci_041                 6.274989e-03 3 1  ON 40
ci_042                 4.877062e-03 3 1  ON 41
ci_043                 5.353743e-03 3 1  ON 42
ci_044                 5.826634e-03 3 1  ON 43
ci_045                 4.246338e-03 3 1  ON 44
ci_046                 5.605886e-03 3 1  ON 45
ci_047                -4.892938e-03 3 1  ON 46
ci_048                -3.909228e-03 3 1  ON 47
ci_049                 2.842733e-03 3 1  ON 48
ci_050                 3.333924e-03 3 1  ON 49
ci_051                -2.561445e-03 3 1  ON 50
ci_052                -2.076066e-03 3 1  ON 51
ci_053                -2.878843e-03 3 1  ON 52
ci_054                -1.536809e-03 3 1  ON 53
ci_055                -1.980980e-03 3 1  ON 54
ci_056                -3.324351e-03 3 1  ON 55
ci_057                -2.292422e-03 3 1  ON 56
ci_058                -2.157782e-03 3 1  ON 57
ci_059                -1.115755e-03 3 1  ON 58
ci_060                -1.509870e-03 3 1  ON 59
ci_061                -9.289263e-04 3 1  ON 60
ci_062                -1.842428e-03 3 1  ON 61
ci_063                -9.407650e-04 3 1  ON 62
ci_064                -1.363200e-03 3 1  ON 63
ci_065                -1.854894e-03 3 1  ON 64
ci_066                -1.892663e-03 3 1  ON 65
ci_067                -1.472243e-03 3 1  ON 66
ci_068                -8.369444e-04 3 1  ON 67
ci_069                 1.429342e-03 3 1  ON 68
ci_070                 9.669362e-04 3 1  ON 69
ci_071                -1.657019e-03 3 1  ON 70
ci_072                -1.519509e-03 3 1  ON 71
ci_073                 7.100057e-04 3 1  ON 72
ci_074                 6.661424e-04 3 1  ON 73
ci_075                -6.340351e-04 3 1  ON 74
ci_076                -1.307081e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.165
    reference variance = 6.41715
====================================================
  Execution time = 2.2843e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6958e+00
  Total weights = 1.9496e+06
  Execution time = 4.3285e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747796278829
                                         uncertainty =       0.025319298022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747796278829
                                         uncertainty =       0.025319298022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368802348
  error estimate for blocks of size 2^( 2) =       0.001441037352
  error estimate for blocks of size 2^( 3) =       0.001504117380
  error estimate for blocks of size 2^( 4) =       0.001549267018
  error estimate for blocks of size 2^( 5) =       0.001575407746
  error estimate for blocks of size 2^( 6) =       0.001584262645
  error estimate for blocks of size 2^( 7) =       0.001592390251

      target function =                  N/A
              le_mean =     -22.328546739735
             les_mean =     502.260338671286
             stat err =       0.001575331915
             autocorr =       1.324532625525
              std dev =       1.935809816790
             le_variance =       3.747359646781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747736137679
                                         uncertainty =       0.025323222375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747736137679
                                         uncertainty =       0.025323222375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368791301
  error estimate for blocks of size 2^( 2) =       0.001441034086
  error estimate for blocks of size 2^( 3) =       0.001504111793
  error estimate for blocks of size 2^( 4) =       0.001549250747
  error estimate for blocks of size 2^( 5) =       0.001575409599
  error estimate for blocks of size 2^( 6) =       0.001584266047
  error estimate for blocks of size 2^( 7) =       0.001592354215

      target function =                  N/A
              le_mean =     -22.328554397797
             les_mean =     502.275287688439
             stat err =       0.001575320152
             autocorr =       1.324534223974
              std dev =       1.935794194003
             le_variance =       3.747299161534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747740452562
                                         uncertainty =       0.025322556339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747740452562
                                         uncertainty =       0.025322556339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368792112
  error estimate for blocks of size 2^( 2) =       0.001441032768
  error estimate for blocks of size 2^( 3) =       0.001504111067
  error estimate for blocks of size 2^( 4) =       0.001549250711
  error estimate for blocks of size 2^( 5) =       0.001575404965
  error estimate for blocks of size 2^( 6) =       0.001584257450
  error estimate for blocks of size 2^( 7) =       0.001592350090

      target function =                  N/A
              le_mean =     -22.328547607638
             les_mean =     502.260063946881
             stat err =       0.001575315804
             autocorr =       1.324525342692
              std dev =       1.935795340725
             le_variance =       3.747303601172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747784211859
                                         uncertainty =       0.025319826099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747784211859
                                         uncertainty =       0.025319826099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368800139
  error estimate for blocks of size 2^( 2) =       0.001441035895
  error estimate for blocks of size 2^( 3) =       0.001504116149
  error estimate for blocks of size 2^( 4) =       0.001549264658
  error estimate for blocks of size 2^( 5) =       0.001575407402
  error estimate for blocks of size 2^( 6) =       0.001584262835
  error estimate for blocks of size 2^( 7) =       0.001592386257

      target function =                  N/A
              le_mean =     -22.328546436798
             les_mean =     502.261308734681
             stat err =       0.001575330288
             autocorr =       1.324534165021
              std dev =       1.935806692641
             le_variance =       3.747347551274


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328546739735        initial
     2.2737e-01     2.2737e+00             1.1097e-03       -22.328554397797  <--
     9.0949e-01     9.0949e+00             4.2330e-04       -22.328547607638
     3.6380e+00     3.6380e+01             1.2174e-04       -22.328546436798

*****************************************************************************
Applying the update for shift_i =   2.2737e-01     and shift_s =   2.2737e+00
*****************************************************************************

  Execution time = 4.4625e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_001                -6.983750e-01 3 1  ON 0
ci_002                -7.020878e-01 3 1  ON 1
ci_003                -6.074691e-02 3 1  ON 2
ci_004                -6.209378e-02 3 1  ON 3
ci_005                 4.548579e-02 3 1  ON 4
ci_006                 4.550830e-02 3 1  ON 5
ci_007                 3.081253e-02 3 1  ON 6
ci_008                 3.278136e-02 3 1  ON 7
ci_009                -2.622125e-02 3 1  ON 8
ci_010                -2.459943e-02 3 1  ON 9
ci_011                -2.274454e-02 3 1  ON 10
ci_012                -2.285078e-02 3 1  ON 11
ci_013                 1.885438e-02 3 1  ON 12
ci_014                 2.004133e-02 3 1  ON 13
ci_015                 1.980769e-02 3 1  ON 14
ci_016                 2.072970e-02 3 1  ON 15
ci_017                 1.567940e-02 3 1  ON 16
ci_018                 1.574514e-02 3 1  ON 17
ci_019                 8.844449e-03 3 1  ON 18
ci_020                 1.011762e-02 3 1  ON 19
ci_021                -9.904915e-03 3 1  ON 20
ci_022                -1.034996e-02 3 1  ON 21
ci_023                 8.428171e-03 3 1  ON 22
ci_024                 8.980552e-03 3 1  ON 23
ci_025                 8.177596e-03 3 1  ON 24
ci_026                 8.378161e-03 3 1  ON 25
ci_027                 8.428412e-03 3 1  ON 26
ci_028                 7.640507e-03 3 1  ON 27
ci_029                -8.461374e-03 3 1  ON 28
ci_030                -7.146196e-03 3 1  ON 29
ci_031                -7.381263e-03 3 1  ON 30
ci_032                -7.070944e-03 3 1  ON 31
ci_033                 7.038033e-03 3 1  ON 32
ci_034                 6.979723e-03 3 1  ON 33
ci_035                 6.932121e-03 3 1  ON 34
ci_036                 7.113819e-03 3 1  ON 35
ci_037                 6.106628e-03 3 1  ON 36
ci_038                 6.845985e-03 3 1  ON 37
ci_039                 5.640778e-03 3 1  ON 38
ci_040                 5.883427e-03 3 1  ON 39
ci_041                 6.157782e-03 3 1  ON 40
ci_042                 5.135470e-03 3 1  ON 41
ci_043                 5.219737e-03 3 1  ON 42
ci_044                 5.600557e-03 3 1  ON 43
ci_045                 4.382660e-03 3 1  ON 44
ci_046                 5.615092e-03 3 1  ON 45
ci_047                -4.902540e-03 3 1  ON 46
ci_048                -4.107725e-03 3 1  ON 47
ci_049                 2.729170e-03 3 1  ON 48
ci_050                 3.376937e-03 3 1  ON 49
ci_051                -2.570892e-03 3 1  ON 50
ci_052                -2.343742e-03 3 1  ON 51
ci_053                -2.762883e-03 3 1  ON 52
ci_054                -1.654070e-03 3 1  ON 53
ci_055                -2.101099e-03 3 1  ON 54
ci_056                -3.536965e-03 3 1  ON 55
ci_057                -1.919405e-03 3 1  ON 56
ci_058                -2.354380e-03 3 1  ON 57
ci_059                -1.186933e-03 3 1  ON 58
ci_060                -1.606549e-03 3 1  ON 59
ci_061                -1.286740e-03 3 1  ON 60
ci_062                -1.156010e-03 3 1  ON 61
ci_063                -1.055318e-03 3 1  ON 62
ci_064                -1.388697e-03 3 1  ON 63
ci_065                -1.975819e-03 3 1  ON 64
ci_066                -1.716100e-03 3 1  ON 65
ci_067                -1.325539e-03 3 1  ON 66
ci_068                -5.482579e-04 3 1  ON 67
ci_069                 1.684158e-03 3 1  ON 68
ci_070                 7.474861e-04 3 1  ON 69
ci_071                -1.571717e-03 3 1  ON 70
ci_072                -1.525130e-03 3 1  ON 71
ci_073                 4.221535e-04 3 1  ON 72
ci_074                 8.093440e-04 3 1  ON 73
ci_075                -6.926816e-04 3 1  ON 74
ci_076                -1.754460e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3955e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2284e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.2937
    reference variance = 3.35279
====================================================
  Execution time = 2.3391e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0314e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.6960e+00
  Total weights = 1.949977547e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8880e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747746818785
                                         uncertainty =       0.030854813844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747746818785
                                         uncertainty =       0.030854813844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368965054
  error estimate for blocks of size 2^( 2) =       0.001438748405
  error estimate for blocks of size 2^( 3) =       0.001501860098
  error estimate for blocks of size 2^( 4) =       0.001545851954
  error estimate for blocks of size 2^( 5) =       0.001572166497
  error estimate for blocks of size 2^( 6) =       0.001582179652
  error estimate for blocks of size 2^( 7) =       0.001591411265

      target function =                  N/A
              le_mean =     -22.326048318553
             les_mean =     502.148410075761
             stat err =       0.001572902342
             autocorr =       1.320136365277
              std dev =       1.936039921244
             le_variance =       3.748250576649


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232604831855e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e-02, overlap shift 5.6843e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326048317733       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326149455024       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326149810505       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326152032801       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326150774615       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.326152092449       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.326151970389       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e-02 is 2.339772e-03

solving harmonic davidson linear method for identity shift 2.2737e-01, overlap shift 2.2737e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326048317733       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326108378132       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326107048171       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326107413504       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326107256080       residual = 1.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e-01 is 1.229073e-03

solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326048317733       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326071201139       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326070622846       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326070643270       residual = 2.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e-01 is 4.239628e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246254 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9290e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_001                -6.979336e-01 3 1  ON 0
ci_002                -7.025428e-01 3 1  ON 1
ci_003                -6.082608e-02 3 1  ON 2
ci_004                -6.216791e-02 3 1  ON 3
ci_005                 4.590792e-02 3 1  ON 4
ci_006                 4.548027e-02 3 1  ON 5
ci_007                 3.147873e-02 3 1  ON 6
ci_008                 3.198548e-02 3 1  ON 7
ci_009                -2.499218e-02 3 1  ON 8
ci_010                -2.468601e-02 3 1  ON 9
ci_011                -2.269424e-02 3 1  ON 10
ci_012                -2.221078e-02 3 1  ON 11
ci_013                 1.979016e-02 3 1  ON 12
ci_014                 2.042529e-02 3 1  ON 13
ci_015                 1.939700e-02 3 1  ON 14
ci_016                 2.010659e-02 3 1  ON 15
ci_017                 1.599392e-02 3 1  ON 16
ci_018                 1.564853e-02 3 1  ON 17
ci_019                 8.374162e-03 3 1  ON 18
ci_020                 9.714828e-03 3 1  ON 19
ci_021                -1.037930e-02 3 1  ON 20
ci_022                -1.056701e-02 3 1  ON 21
ci_023                 8.690444e-03 3 1  ON 22
ci_024                 9.312864e-03 3 1  ON 23
ci_025                 7.947461e-03 3 1  ON 24
ci_026                 8.418748e-03 3 1  ON 25
ci_027                 7.899467e-03 3 1  ON 26
ci_028                 7.812307e-03 3 1  ON 27
ci_029                -8.110053e-03 3 1  ON 28
ci_030                -7.806382e-03 3 1  ON 29
ci_031                -7.605765e-03 3 1  ON 30
ci_032                -6.545778e-03 3 1  ON 31
ci_033                 7.561818e-03 3 1  ON 32
ci_034                 6.732347e-03 3 1  ON 33
ci_035                 6.767331e-03 3 1  ON 34
ci_036                 7.224028e-03 3 1  ON 35
ci_037                 6.126367e-03 3 1  ON 36
ci_038                 6.824128e-03 3 1  ON 37
ci_039                 5.929269e-03 3 1  ON 38
ci_040                 6.092001e-03 3 1  ON 39
ci_041                 6.097829e-03 3 1  ON 40
ci_042                 5.632656e-03 3 1  ON 41
ci_043                 5.188300e-03 3 1  ON 42
ci_044                 5.501007e-03 3 1  ON 43
ci_045                 4.420496e-03 3 1  ON 44
ci_046                 5.564589e-03 3 1  ON 45
ci_047                -4.131242e-03 3 1  ON 46
ci_048                -4.050597e-03 3 1  ON 47
ci_049                 2.981749e-03 3 1  ON 48
ci_050                 3.821859e-03 3 1  ON 49
ci_051                -2.693792e-03 3 1  ON 50
ci_052                -1.851346e-03 3 1  ON 51
ci_053                -2.748675e-03 3 1  ON 52
ci_054                -2.661769e-03 3 1  ON 53
ci_055                -2.086219e-03 3 1  ON 54
ci_056                -3.798641e-03 3 1  ON 55
ci_057                -2.069622e-03 3 1  ON 56
ci_058                -2.582939e-03 3 1  ON 57
ci_059                -1.350378e-03 3 1  ON 58
ci_060                -2.302004e-03 3 1  ON 59
ci_061                -1.317084e-03 3 1  ON 60
ci_062                -1.626883e-03 3 1  ON 61
ci_063                -1.043800e-03 3 1  ON 62
ci_064                -1.246562e-03 3 1  ON 63
ci_065                -1.286452e-03 3 1  ON 64
ci_066                -9.977629e-04 3 1  ON 65
ci_067                -1.173613e-03 3 1  ON 66
ci_068                -1.501171e-03 3 1  ON 67
ci_069                 1.691094e-03 3 1  ON 68
ci_070                 1.236751e-03 3 1  ON 69
ci_071                -1.521111e-03 3 1  ON 70
ci_072                -1.313503e-03 3 1  ON 71
ci_073                 9.535857e-04 3 1  ON 72
ci_074                 9.475907e-04 3 1  ON 73
ci_075                -1.433392e-03 3 1  ON 74
ci_076                -1.508307e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.5602
    reference variance = 2.68113
====================================================
  Execution time = 2.5196e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7069e+00
  Total weights = 1.9499e+06
  Execution time = 4.3125e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759575129783
                                         uncertainty =       0.032341985033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759575129783
                                         uncertainty =       0.032341985033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370855736
  error estimate for blocks of size 2^( 2) =       0.001441485412
  error estimate for blocks of size 2^( 3) =       0.001504342021
  error estimate for blocks of size 2^( 4) =       0.001546970633
  error estimate for blocks of size 2^( 5) =       0.001568997581
  error estimate for blocks of size 2^( 6) =       0.001578878781
  error estimate for blocks of size 2^( 7) =       0.001582013141

      target function =                  N/A
              le_mean =     -22.326792770079
             les_mean =     502.208157486683
             stat err =       0.001569215034
             autocorr =       1.310332199934
              std dev =       1.938713792298
             le_variance =       3.758611168448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759649760032
                                         uncertainty =       0.032337044638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759649760032
                                         uncertainty =       0.032337044638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370869064
  error estimate for blocks of size 2^( 2) =       0.001441496848
  error estimate for blocks of size 2^( 3) =       0.001504363435
  error estimate for blocks of size 2^( 4) =       0.001546985245
  error estimate for blocks of size 2^( 5) =       0.001568981283
  error estimate for blocks of size 2^( 6) =       0.001578888077
  error estimate for blocks of size 2^( 7) =       0.001582108823

      target function =                  N/A
              le_mean =     -22.326766724980
             les_mean =     502.194081794969
             stat err =       0.001569240857
             autocorr =       1.310349845698
              std dev =       1.938732641859
             le_variance =       3.758684256608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759730197192
                                         uncertainty =       0.032336044981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759730197192
                                         uncertainty =       0.032336044981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370883611
  error estimate for blocks of size 2^( 2) =       0.001441508747
  error estimate for blocks of size 2^( 3) =       0.001504369805
  error estimate for blocks of size 2^( 4) =       0.001546990708
  error estimate for blocks of size 2^( 5) =       0.001568979367
  error estimate for blocks of size 2^( 6) =       0.001578886870
  error estimate for blocks of size 2^( 7) =       0.001582124448

      target function =                  N/A
              le_mean =     -22.326773414353
             les_mean =     502.195714183870
             stat err =       0.001569245348
             autocorr =       1.310329538075
              std dev =       1.938753214073
             le_variance =       3.758764025080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759661052227
                                         uncertainty =       0.032337118334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759661052227
                                         uncertainty =       0.032337118334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370871278
  error estimate for blocks of size 2^( 2) =       0.001441509015
  error estimate for blocks of size 2^( 3) =       0.001504334833
  error estimate for blocks of size 2^( 4) =       0.001546947275
  error estimate for blocks of size 2^( 5) =       0.001568991228
  error estimate for blocks of size 2^( 6) =       0.001578954941
  error estimate for blocks of size 2^( 7) =       0.001582088351

      target function =                  N/A
              le_mean =     -22.326772215841
             les_mean =     502.792618368732
             stat err =       0.001569245449
             autocorr =       1.310353281936
              std dev =       1.938735772717
             le_variance =       3.758696396412


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326792770079        initial  <--
     5.6843e-02     5.6843e-01             2.3398e-03       -22.326766724980
     2.2737e-01     2.2737e+00             1.2291e-03       -22.326773414353
     9.0949e-01     9.0949e+00             4.2396e-04       -22.326772215841

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.9325
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_001                -6.983750e-01 3 1  ON 0
ci_002                -7.020878e-01 3 1  ON 1
ci_003                -6.074691e-02 3 1  ON 2
ci_004                -6.209378e-02 3 1  ON 3
ci_005                 4.548579e-02 3 1  ON 4
ci_006                 4.550830e-02 3 1  ON 5
ci_007                 3.081253e-02 3 1  ON 6
ci_008                 3.278136e-02 3 1  ON 7
ci_009                -2.622125e-02 3 1  ON 8
ci_010                -2.459943e-02 3 1  ON 9
ci_011                -2.274454e-02 3 1  ON 10
ci_012                -2.285078e-02 3 1  ON 11
ci_013                 1.885438e-02 3 1  ON 12
ci_014                 2.004133e-02 3 1  ON 13
ci_015                 1.980769e-02 3 1  ON 14
ci_016                 2.072970e-02 3 1  ON 15
ci_017                 1.567940e-02 3 1  ON 16
ci_018                 1.574514e-02 3 1  ON 17
ci_019                 8.844449e-03 3 1  ON 18
ci_020                 1.011762e-02 3 1  ON 19
ci_021                -9.904915e-03 3 1  ON 20
ci_022                -1.034996e-02 3 1  ON 21
ci_023                 8.428171e-03 3 1  ON 22
ci_024                 8.980552e-03 3 1  ON 23
ci_025                 8.177596e-03 3 1  ON 24
ci_026                 8.378161e-03 3 1  ON 25
ci_027                 8.428412e-03 3 1  ON 26
ci_028                 7.640507e-03 3 1  ON 27
ci_029                -8.461374e-03 3 1  ON 28
ci_030                -7.146196e-03 3 1  ON 29
ci_031                -7.381263e-03 3 1  ON 30
ci_032                -7.070944e-03 3 1  ON 31
ci_033                 7.038033e-03 3 1  ON 32
ci_034                 6.979723e-03 3 1  ON 33
ci_035                 6.932121e-03 3 1  ON 34
ci_036                 7.113819e-03 3 1  ON 35
ci_037                 6.106628e-03 3 1  ON 36
ci_038                 6.845985e-03 3 1  ON 37
ci_039                 5.640778e-03 3 1  ON 38
ci_040                 5.883427e-03 3 1  ON 39
ci_041                 6.157782e-03 3 1  ON 40
ci_042                 5.135470e-03 3 1  ON 41
ci_043                 5.219737e-03 3 1  ON 42
ci_044                 5.600557e-03 3 1  ON 43
ci_045                 4.382660e-03 3 1  ON 44
ci_046                 5.615092e-03 3 1  ON 45
ci_047                -4.902540e-03 3 1  ON 46
ci_048                -4.107725e-03 3 1  ON 47
ci_049                 2.729170e-03 3 1  ON 48
ci_050                 3.376937e-03 3 1  ON 49
ci_051                -2.570892e-03 3 1  ON 50
ci_052                -2.343742e-03 3 1  ON 51
ci_053                -2.762883e-03 3 1  ON 52
ci_054                -1.654070e-03 3 1  ON 53
ci_055                -2.101099e-03 3 1  ON 54
ci_056                -3.536965e-03 3 1  ON 55
ci_057                -1.919405e-03 3 1  ON 56
ci_058                -2.354380e-03 3 1  ON 57
ci_059                -1.186933e-03 3 1  ON 58
ci_060                -1.606549e-03 3 1  ON 59
ci_061                -1.286740e-03 3 1  ON 60
ci_062                -1.156010e-03 3 1  ON 61
ci_063                -1.055318e-03 3 1  ON 62
ci_064                -1.388697e-03 3 1  ON 63
ci_065                -1.975819e-03 3 1  ON 64
ci_066                -1.716100e-03 3 1  ON 65
ci_067                -1.325539e-03 3 1  ON 66
ci_068                -5.482579e-04 3 1  ON 67
ci_069                 1.684158e-03 3 1  ON 68
ci_070                 7.474861e-04 3 1  ON 69
ci_071                -1.571717e-03 3 1  ON 70
ci_072                -1.525130e-03 3 1  ON 71
ci_073                 4.221535e-04 3 1  ON 72
ci_074                 8.093440e-04 3 1  ON 73
ci_075                -6.926816e-04 3 1  ON 74
ci_076                -1.754460e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6238e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2287e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.5119
    reference variance = 2.07081
====================================================
  Execution time = 2.3386e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0306e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7530e+00
  Total weights = 1.950057983e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8982e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.806505608990
                                         uncertainty =       0.043777958873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.806505608990
                                         uncertainty =       0.043777958873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379386275
  error estimate for blocks of size 2^( 2) =       0.001449648752
  error estimate for blocks of size 2^( 3) =       0.001513903433
  error estimate for blocks of size 2^( 4) =       0.001557285773
  error estimate for blocks of size 2^( 5) =       0.001577130531
  error estimate for blocks of size 2^( 6) =       0.001587873801
  error estimate for blocks of size 2^( 7) =       0.001599739662

      target function =                  N/A
              le_mean =     -22.328797013765
             les_mean =     502.328131227117
             stat err =       0.001580507442
             autocorr =       1.312868684518
              std dev =       1.950777989045
             le_variance =       3.805534762541


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232879701376e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e-01, overlap shift 5.6843e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328797012944       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328819860912       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328819744488       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328819746619       residual = 4.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e-01 is 6.520878e-04

solving harmonic davidson linear method for identity shift 2.2737e+00, overlap shift 2.2737e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328797012944       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328804041094       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328804007451       residual = 7.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+00 is 1.942969e-04

solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328797012944       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328798877382       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328798870794       residual = 2.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+00 is 5.097608e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249619 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9295e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_001                -6.983274e-01 3 1  ON 0
ci_002                -7.021432e-01 3 1  ON 1
ci_003                -6.068003e-02 3 1  ON 2
ci_004                -6.205899e-02 3 1  ON 3
ci_005                 4.546467e-02 3 1  ON 4
ci_006                 4.543959e-02 3 1  ON 5
ci_007                 3.086918e-02 3 1  ON 6
ci_008                 3.268307e-02 3 1  ON 7
ci_009                -2.615547e-02 3 1  ON 8
ci_010                -2.463551e-02 3 1  ON 9
ci_011                -2.273596e-02 3 1  ON 10
ci_012                -2.292916e-02 3 1  ON 11
ci_013                 1.904868e-02 3 1  ON 12
ci_014                 2.003994e-02 3 1  ON 13
ci_015                 1.984432e-02 3 1  ON 14
ci_016                 2.084059e-02 3 1  ON 15
ci_017                 1.572824e-02 3 1  ON 16
ci_018                 1.575926e-02 3 1  ON 17
ci_019                 8.826075e-03 3 1  ON 18
ci_020                 1.007908e-02 3 1  ON 19
ci_021                -9.891277e-03 3 1  ON 20
ci_022                -1.026596e-02 3 1  ON 21
ci_023                 8.350325e-03 3 1  ON 22
ci_024                 9.026004e-03 3 1  ON 23
ci_025                 8.178504e-03 3 1  ON 24
ci_026                 8.417380e-03 3 1  ON 25
ci_027                 8.356627e-03 3 1  ON 26
ci_028                 7.686763e-03 3 1  ON 27
ci_029                -8.384956e-03 3 1  ON 28
ci_030                -7.127024e-03 3 1  ON 29
ci_031                -7.411318e-03 3 1  ON 30
ci_032                -7.043625e-03 3 1  ON 31
ci_033                 7.162402e-03 3 1  ON 32
ci_034                 6.962486e-03 3 1  ON 33
ci_035                 6.992772e-03 3 1  ON 34
ci_036                 7.000084e-03 3 1  ON 35
ci_037                 6.114681e-03 3 1  ON 36
ci_038                 6.856259e-03 3 1  ON 37
ci_039                 5.651453e-03 3 1  ON 38
ci_040                 5.892982e-03 3 1  ON 39
ci_041                 6.028475e-03 3 1  ON 40
ci_042                 5.140047e-03 3 1  ON 41
ci_043                 5.206693e-03 3 1  ON 42
ci_044                 5.630262e-03 3 1  ON 43
ci_045                 4.442836e-03 3 1  ON 44
ci_046                 5.595681e-03 3 1  ON 45
ci_047                -4.859320e-03 3 1  ON 46
ci_048                -4.135174e-03 3 1  ON 47
ci_049                 2.766636e-03 3 1  ON 48
ci_050                 3.378375e-03 3 1  ON 49
ci_051                -2.545848e-03 3 1  ON 50
ci_052                -2.293569e-03 3 1  ON 51
ci_053                -2.690127e-03 3 1  ON 52
ci_054                -1.704985e-03 3 1  ON 53
ci_055                -2.165509e-03 3 1  ON 54
ci_056                -3.468820e-03 3 1  ON 55
ci_057                -2.103353e-03 3 1  ON 56
ci_058                -2.404408e-03 3 1  ON 57
ci_059                -1.302566e-03 3 1  ON 58
ci_060                -1.632065e-03 3 1  ON 59
ci_061                -1.336964e-03 3 1  ON 60
ci_062                -1.217670e-03 3 1  ON 61
ci_063                -1.157830e-03 3 1  ON 62
ci_064                -1.459820e-03 3 1  ON 63
ci_065                -1.945699e-03 3 1  ON 64
ci_066                -1.680531e-03 3 1  ON 65
ci_067                -1.295856e-03 3 1  ON 66
ci_068                -6.324853e-04 3 1  ON 67
ci_069                 1.722985e-03 3 1  ON 68
ci_070                 6.896202e-04 3 1  ON 69
ci_071                -1.519885e-03 3 1  ON 70
ci_072                -1.389522e-03 3 1  ON 71
ci_073                 4.631229e-04 3 1  ON 72
ci_074                 8.770955e-04 3 1  ON 73
ci_075                -6.495744e-04 3 1  ON 74
ci_076                -1.659636e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.2119
    reference variance = 2.8008
====================================================
  Execution time = 2.2823e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2324e+01
  VMC Evar = 3.7288e+00
  Total weights = 1.9496e+06
  Execution time = 4.3277e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785024410188
                                         uncertainty =       0.036685212860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785024410188
                                         uncertainty =       0.036685212860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375520091
  error estimate for blocks of size 2^( 2) =       0.001446530776
  error estimate for blocks of size 2^( 3) =       0.001512030616
  error estimate for blocks of size 2^( 4) =       0.001554967226
  error estimate for blocks of size 2^( 5) =       0.001578399778
  error estimate for blocks of size 2^( 6) =       0.001597686884
  error estimate for blocks of size 2^( 7) =       0.001602124150

      target function =                  N/A
              le_mean =     -22.324465900072
             les_mean =     516.684079389487
             stat err =       0.001583294510
             autocorr =       1.324919631878
              std dev =       1.945310292242
             le_variance =       3.784232133103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781649588064
                                         uncertainty =       0.036753577190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781649588064
                                         uncertainty =       0.036753577190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374908003
  error estimate for blocks of size 2^( 2) =       0.001445938898
  error estimate for blocks of size 2^( 3) =       0.001511439889
  error estimate for blocks of size 2^( 4) =       0.001554383209
  error estimate for blocks of size 2^( 5) =       0.001577689971
  error estimate for blocks of size 2^( 6) =       0.001597040599
  error estimate for blocks of size 2^( 7) =       0.001601550954

      target function =                  N/A
              le_mean =     -22.324429193083
             les_mean =     502.109925922799
             stat err =       0.001582666183
             autocorr =       1.325047252453
              std dev =       1.944444655215
             le_variance =       3.780865017196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781630029551
                                         uncertainty =       0.036755002004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781630029551
                                         uncertainty =       0.036755002004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374904434
  error estimate for blocks of size 2^( 2) =       0.001445935269
  error estimate for blocks of size 2^( 3) =       0.001511435298
  error estimate for blocks of size 2^( 4) =       0.001554377950
  error estimate for blocks of size 2^( 5) =       0.001577687808
  error estimate for blocks of size 2^( 6) =       0.001597042206
  error estimate for blocks of size 2^( 7) =       0.001601548638

      target function =                  N/A
              le_mean =     -22.324426238137
             les_mean =     502.108861203631
             stat err =       0.001582664150
             autocorr =       1.325050727913
              std dev =       1.944439607802
             le_variance =       3.780845388391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781617627029
                                         uncertainty =       0.036757091595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781617627029
                                         uncertainty =       0.036757091595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374902169
  error estimate for blocks of size 2^( 2) =       0.001445932888
  error estimate for blocks of size 2^( 3) =       0.001511431892
  error estimate for blocks of size 2^( 4) =       0.001554373378
  error estimate for blocks of size 2^( 5) =       0.001577689390
  error estimate for blocks of size 2^( 6) =       0.001597048086
  error estimate for blocks of size 2^( 7) =       0.001601547813

      target function =                  N/A
              le_mean =     -22.324424839793
             les_mean =     502.108908751048
             stat err =       0.001582664667
             autocorr =       1.325055959027
              std dev =       1.944436404153
             le_variance =       3.780832929796


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.324465900072        initial  <--
     5.6843e-01     5.6843e+00             6.5209e-04       -22.324429193083
     2.2737e+00     2.2737e+01             1.9430e-04       -22.324426238137
     9.0949e+00     9.0949e+01             5.0976e-05       -22.324424839793

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6448
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_001                -6.983750e-01 3 1  ON 0
ci_002                -7.020878e-01 3 1  ON 1
ci_003                -6.074691e-02 3 1  ON 2
ci_004                -6.209378e-02 3 1  ON 3
ci_005                 4.548579e-02 3 1  ON 4
ci_006                 4.550830e-02 3 1  ON 5
ci_007                 3.081253e-02 3 1  ON 6
ci_008                 3.278136e-02 3 1  ON 7
ci_009                -2.622125e-02 3 1  ON 8
ci_010                -2.459943e-02 3 1  ON 9
ci_011                -2.274454e-02 3 1  ON 10
ci_012                -2.285078e-02 3 1  ON 11
ci_013                 1.885438e-02 3 1  ON 12
ci_014                 2.004133e-02 3 1  ON 13
ci_015                 1.980769e-02 3 1  ON 14
ci_016                 2.072970e-02 3 1  ON 15
ci_017                 1.567940e-02 3 1  ON 16
ci_018                 1.574514e-02 3 1  ON 17
ci_019                 8.844449e-03 3 1  ON 18
ci_020                 1.011762e-02 3 1  ON 19
ci_021                -9.904915e-03 3 1  ON 20
ci_022                -1.034996e-02 3 1  ON 21
ci_023                 8.428171e-03 3 1  ON 22
ci_024                 8.980552e-03 3 1  ON 23
ci_025                 8.177596e-03 3 1  ON 24
ci_026                 8.378161e-03 3 1  ON 25
ci_027                 8.428412e-03 3 1  ON 26
ci_028                 7.640507e-03 3 1  ON 27
ci_029                -8.461374e-03 3 1  ON 28
ci_030                -7.146196e-03 3 1  ON 29
ci_031                -7.381263e-03 3 1  ON 30
ci_032                -7.070944e-03 3 1  ON 31
ci_033                 7.038033e-03 3 1  ON 32
ci_034                 6.979723e-03 3 1  ON 33
ci_035                 6.932121e-03 3 1  ON 34
ci_036                 7.113819e-03 3 1  ON 35
ci_037                 6.106628e-03 3 1  ON 36
ci_038                 6.845985e-03 3 1  ON 37
ci_039                 5.640778e-03 3 1  ON 38
ci_040                 5.883427e-03 3 1  ON 39
ci_041                 6.157782e-03 3 1  ON 40
ci_042                 5.135470e-03 3 1  ON 41
ci_043                 5.219737e-03 3 1  ON 42
ci_044                 5.600557e-03 3 1  ON 43
ci_045                 4.382660e-03 3 1  ON 44
ci_046                 5.615092e-03 3 1  ON 45
ci_047                -4.902540e-03 3 1  ON 46
ci_048                -4.107725e-03 3 1  ON 47
ci_049                 2.729170e-03 3 1  ON 48
ci_050                 3.376937e-03 3 1  ON 49
ci_051                -2.570892e-03 3 1  ON 50
ci_052                -2.343742e-03 3 1  ON 51
ci_053                -2.762883e-03 3 1  ON 52
ci_054                -1.654070e-03 3 1  ON 53
ci_055                -2.101099e-03 3 1  ON 54
ci_056                -3.536965e-03 3 1  ON 55
ci_057                -1.919405e-03 3 1  ON 56
ci_058                -2.354380e-03 3 1  ON 57
ci_059                -1.186933e-03 3 1  ON 58
ci_060                -1.606549e-03 3 1  ON 59
ci_061                -1.286740e-03 3 1  ON 60
ci_062                -1.156010e-03 3 1  ON 61
ci_063                -1.055318e-03 3 1  ON 62
ci_064                -1.388697e-03 3 1  ON 63
ci_065                -1.975819e-03 3 1  ON 64
ci_066                -1.716100e-03 3 1  ON 65
ci_067                -1.325539e-03 3 1  ON 66
ci_068                -5.482579e-04 3 1  ON 67
ci_069                 1.684158e-03 3 1  ON 68
ci_070                 7.474861e-04 3 1  ON 69
ci_071                -1.571717e-03 3 1  ON 70
ci_072                -1.525130e-03 3 1  ON 71
ci_073                 4.221535e-04 3 1  ON 72
ci_074                 8.093440e-04 3 1  ON 73
ci_075                -6.926816e-04 3 1  ON 74
ci_076                -1.754460e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3954e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2289e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.1542
    reference variance = 4.08454
====================================================
  Execution time = 2.3366e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0280e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7527e+00
  Total weights = 1.949821667e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8858e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807532611388
                                         uncertainty =       0.077757440159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807532611388
                                         uncertainty =       0.077757440159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379630834
  error estimate for blocks of size 2^( 2) =       0.001451883710
  error estimate for blocks of size 2^( 3) =       0.001514212794
  error estimate for blocks of size 2^( 4) =       0.001558844424
  error estimate for blocks of size 2^( 5) =       0.001585652064
  error estimate for blocks of size 2^( 6) =       0.001598002424
  error estimate for blocks of size 2^( 7) =       0.001600974862

      target function =                  N/A
              le_mean =     -22.329602015631
             les_mean =     502.363802094448
             stat err =       0.001585868443
             autocorr =       1.321321587819
              std dev =       1.951123853695
             le_variance =       3.806884292458


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232960201563e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329602014810       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329605672037       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329605690090       residual = 2.35e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+00 is 6.546118e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329602014810       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329602952499       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329602957603       residual = 2.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+01 is 1.693490e-05

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329602014810       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329602250741       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329602252062       residual = 2.31e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+01 is 4.270869e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.252530 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9264e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_001                -6.983786e-01 3 1  ON 0
ci_002                -7.020828e-01 3 1  ON 1
ci_003                -6.075180e-02 3 1  ON 2
ci_004                -6.208675e-02 3 1  ON 3
ci_005                 4.548456e-02 3 1  ON 4
ci_006                 4.552523e-02 3 1  ON 5
ci_007                 3.082405e-02 3 1  ON 6
ci_008                 3.278359e-02 3 1  ON 7
ci_009                -2.621995e-02 3 1  ON 8
ci_010                -2.459796e-02 3 1  ON 9
ci_011                -2.274308e-02 3 1  ON 10
ci_012                -2.285476e-02 3 1  ON 11
ci_013                 1.885790e-02 3 1  ON 12
ci_014                 2.003553e-02 3 1  ON 13
ci_015                 1.980841e-02 3 1  ON 14
ci_016                 2.073601e-02 3 1  ON 15
ci_017                 1.568309e-02 3 1  ON 16
ci_018                 1.574900e-02 3 1  ON 17
ci_019                 8.847733e-03 3 1  ON 18
ci_020                 1.011085e-02 3 1  ON 19
ci_021                -9.897029e-03 3 1  ON 20
ci_022                -1.035002e-02 3 1  ON 21
ci_023                 8.431452e-03 3 1  ON 22
ci_024                 8.974063e-03 3 1  ON 23
ci_025                 8.174101e-03 3 1  ON 24
ci_026                 8.387742e-03 3 1  ON 25
ci_027                 8.426717e-03 3 1  ON 26
ci_028                 7.649265e-03 3 1  ON 27
ci_029                -8.451146e-03 3 1  ON 28
ci_030                -7.155366e-03 3 1  ON 29
ci_031                -7.387017e-03 3 1  ON 30
ci_032                -7.073415e-03 3 1  ON 31
ci_033                 7.044050e-03 3 1  ON 32
ci_034                 6.968444e-03 3 1  ON 33
ci_035                 6.924240e-03 3 1  ON 34
ci_036                 7.103735e-03 3 1  ON 35
ci_037                 6.109592e-03 3 1  ON 36
ci_038                 6.833254e-03 3 1  ON 37
ci_039                 5.638543e-03 3 1  ON 38
ci_040                 5.879939e-03 3 1  ON 39
ci_041                 6.150915e-03 3 1  ON 40
ci_042                 5.138813e-03 3 1  ON 41
ci_043                 5.218520e-03 3 1  ON 42
ci_044                 5.608985e-03 3 1  ON 43
ci_045                 4.376122e-03 3 1  ON 44
ci_046                 5.614785e-03 3 1  ON 45
ci_047                -4.887347e-03 3 1  ON 46
ci_048                -4.116546e-03 3 1  ON 47
ci_049                 2.724372e-03 3 1  ON 48
ci_050                 3.385591e-03 3 1  ON 49
ci_051                -2.574375e-03 3 1  ON 50
ci_052                -2.332031e-03 3 1  ON 51
ci_053                -2.764676e-03 3 1  ON 52
ci_054                -1.668101e-03 3 1  ON 53
ci_055                -2.093550e-03 3 1  ON 54
ci_056                -3.535167e-03 3 1  ON 55
ci_057                -1.928457e-03 3 1  ON 56
ci_058                -2.351525e-03 3 1  ON 57
ci_059                -1.199383e-03 3 1  ON 58
ci_060                -1.612276e-03 3 1  ON 59
ci_061                -1.293828e-03 3 1  ON 60
ci_062                -1.165324e-03 3 1  ON 61
ci_063                -1.064287e-03 3 1  ON 62
ci_064                -1.387339e-03 3 1  ON 63
ci_065                -1.972592e-03 3 1  ON 64
ci_066                -1.721937e-03 3 1  ON 65
ci_067                -1.317288e-03 3 1  ON 66
ci_068                -5.589446e-04 3 1  ON 67
ci_069                 1.678188e-03 3 1  ON 68
ci_070                 7.483257e-04 3 1  ON 69
ci_071                -1.560607e-03 3 1  ON 70
ci_072                -1.526341e-03 3 1  ON 71
ci_073                 4.240396e-04 3 1  ON 72
ci_074                 8.165654e-04 3 1  ON 73
ci_075                -6.878404e-04 3 1  ON 74
ci_076                -1.751991e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.5972
    reference variance = 2.67388
====================================================
  Execution time = 2.2809e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7019e+00
  Total weights = 1.9500e+06
  Execution time = 4.3253e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753522299203
                                         uncertainty =       0.024302802197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753522299203
                                         uncertainty =       0.024302802197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369947950
  error estimate for blocks of size 2^( 2) =       0.001441210010
  error estimate for blocks of size 2^( 3) =       0.001504381111
  error estimate for blocks of size 2^( 4) =       0.001547004268
  error estimate for blocks of size 2^( 5) =       0.001573182679
  error estimate for blocks of size 2^( 6) =       0.001584802917
  error estimate for blocks of size 2^( 7) =       0.001587925985

      target function =                  N/A
              le_mean =     -22.327680066835
             les_mean =     502.227276945548
             stat err =       0.001573228962
             autocorr =       1.318790262813
              std dev =       1.937429969321
             le_variance =       3.753634886024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753526525934
                                         uncertainty =       0.024302736813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753526525934
                                         uncertainty =       0.024302736813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369949394
  error estimate for blocks of size 2^( 2) =       0.001441209883
  error estimate for blocks of size 2^( 3) =       0.001504379378
  error estimate for blocks of size 2^( 4) =       0.001547001577
  error estimate for blocks of size 2^( 5) =       0.001573179276
  error estimate for blocks of size 2^( 6) =       0.001584796685
  error estimate for blocks of size 2^( 7) =       0.001587917124

      target function =                  N/A
              le_mean =     -22.327679590142
             les_mean =     502.227299646657
             stat err =       0.001573223666
             autocorr =       1.318778604411
              std dev =       1.937432010346
             le_variance =       3.753642794714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753524307675
                                         uncertainty =       0.024302767142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753524307675
                                         uncertainty =       0.024302767142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369948661
  error estimate for blocks of size 2^( 2) =       0.001441209916
  error estimate for blocks of size 2^( 3) =       0.001504380185
  error estimate for blocks of size 2^( 4) =       0.001547002840
  error estimate for blocks of size 2^( 5) =       0.001573180856
  error estimate for blocks of size 2^( 6) =       0.001584799621
  error estimate for blocks of size 2^( 7) =       0.001587921330

      target function =                  N/A
              le_mean =     -22.327679777239
             les_mean =     502.227160655527
             stat err =       0.001573226162
             autocorr =       1.318784199134
              std dev =       1.937430974827
             le_variance =       3.753638782219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753522536895
                                         uncertainty =       0.024302797669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753522536895
                                         uncertainty =       0.024302797669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369948037
  error estimate for blocks of size 2^( 2) =       0.001441209996
  error estimate for blocks of size 2^( 3) =       0.001504380995
  error estimate for blocks of size 2^( 4) =       0.001547004091
  error estimate for blocks of size 2^( 5) =       0.001573182450
  error estimate for blocks of size 2^( 6) =       0.001584802507
  error estimate for blocks of size 2^( 7) =       0.001587925393

      target function =                  N/A
              le_mean =     -22.327680028654
             les_mean =     502.227175460317
             stat err =       0.001573228610
             autocorr =       1.318789505856
              std dev =       1.937430091694
             le_variance =       3.753635360201


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327680066835        initial  <--
     5.6843e+00     5.6843e+01             6.5461e-05       -22.327679590142
     2.2737e+01     2.2737e+02             1.6935e-05       -22.327679777239
     9.0949e+01     9.0949e+02             4.2709e-06       -22.327680028654

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5931
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_001                -6.983750e-01 3 1  ON 0
ci_002                -7.020878e-01 3 1  ON 1
ci_003                -6.074691e-02 3 1  ON 2
ci_004                -6.209378e-02 3 1  ON 3
ci_005                 4.548579e-02 3 1  ON 4
ci_006                 4.550830e-02 3 1  ON 5
ci_007                 3.081253e-02 3 1  ON 6
ci_008                 3.278136e-02 3 1  ON 7
ci_009                -2.622125e-02 3 1  ON 8
ci_010                -2.459943e-02 3 1  ON 9
ci_011                -2.274454e-02 3 1  ON 10
ci_012                -2.285078e-02 3 1  ON 11
ci_013                 1.885438e-02 3 1  ON 12
ci_014                 2.004133e-02 3 1  ON 13
ci_015                 1.980769e-02 3 1  ON 14
ci_016                 2.072970e-02 3 1  ON 15
ci_017                 1.567940e-02 3 1  ON 16
ci_018                 1.574514e-02 3 1  ON 17
ci_019                 8.844449e-03 3 1  ON 18
ci_020                 1.011762e-02 3 1  ON 19
ci_021                -9.904915e-03 3 1  ON 20
ci_022                -1.034996e-02 3 1  ON 21
ci_023                 8.428171e-03 3 1  ON 22
ci_024                 8.980552e-03 3 1  ON 23
ci_025                 8.177596e-03 3 1  ON 24
ci_026                 8.378161e-03 3 1  ON 25
ci_027                 8.428412e-03 3 1  ON 26
ci_028                 7.640507e-03 3 1  ON 27
ci_029                -8.461374e-03 3 1  ON 28
ci_030                -7.146196e-03 3 1  ON 29
ci_031                -7.381263e-03 3 1  ON 30
ci_032                -7.070944e-03 3 1  ON 31
ci_033                 7.038033e-03 3 1  ON 32
ci_034                 6.979723e-03 3 1  ON 33
ci_035                 6.932121e-03 3 1  ON 34
ci_036                 7.113819e-03 3 1  ON 35
ci_037                 6.106628e-03 3 1  ON 36
ci_038                 6.845985e-03 3 1  ON 37
ci_039                 5.640778e-03 3 1  ON 38
ci_040                 5.883427e-03 3 1  ON 39
ci_041                 6.157782e-03 3 1  ON 40
ci_042                 5.135470e-03 3 1  ON 41
ci_043                 5.219737e-03 3 1  ON 42
ci_044                 5.600557e-03 3 1  ON 43
ci_045                 4.382660e-03 3 1  ON 44
ci_046                 5.615092e-03 3 1  ON 45
ci_047                -4.902540e-03 3 1  ON 46
ci_048                -4.107725e-03 3 1  ON 47
ci_049                 2.729170e-03 3 1  ON 48
ci_050                 3.376937e-03 3 1  ON 49
ci_051                -2.570892e-03 3 1  ON 50
ci_052                -2.343742e-03 3 1  ON 51
ci_053                -2.762883e-03 3 1  ON 52
ci_054                -1.654070e-03 3 1  ON 53
ci_055                -2.101099e-03 3 1  ON 54
ci_056                -3.536965e-03 3 1  ON 55
ci_057                -1.919405e-03 3 1  ON 56
ci_058                -2.354380e-03 3 1  ON 57
ci_059                -1.186933e-03 3 1  ON 58
ci_060                -1.606549e-03 3 1  ON 59
ci_061                -1.286740e-03 3 1  ON 60
ci_062                -1.156010e-03 3 1  ON 61
ci_063                -1.055318e-03 3 1  ON 62
ci_064                -1.388697e-03 3 1  ON 63
ci_065                -1.975819e-03 3 1  ON 64
ci_066                -1.716100e-03 3 1  ON 65
ci_067                -1.325539e-03 3 1  ON 66
ci_068                -5.482579e-04 3 1  ON 67
ci_069                 1.684158e-03 3 1  ON 68
ci_070                 7.474861e-04 3 1  ON 69
ci_071                -1.571717e-03 3 1  ON 70
ci_072                -1.525130e-03 3 1  ON 71
ci_073                 4.221535e-04 3 1  ON 72
ci_074                 8.093440e-04 3 1  ON 73
ci_075                -6.926816e-04 3 1  ON 74
ci_076                -1.754460e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3873e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2291e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.2867
    reference variance = 2.4432
====================================================
  Execution time = 2.3415e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0302e+04
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7448e+00
  Total weights = 1.949782977e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8852e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797037389635
                                         uncertainty =       0.034034938933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797037389635
                                         uncertainty =       0.034034938933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377820246
  error estimate for blocks of size 2^( 2) =       0.001448433010
  error estimate for blocks of size 2^( 3) =       0.001509406606
  error estimate for blocks of size 2^( 4) =       0.001552179194
  error estimate for blocks of size 2^( 5) =       0.001571904794
  error estimate for blocks of size 2^( 6) =       0.001582873051
  error estimate for blocks of size 2^( 7) =       0.001590370742

      target function =                  N/A
              le_mean =     -22.324926796976
             les_mean =     502.147160109662
             stat err =       0.001574331945
             autocorr =       1.305592034667
              std dev =       1.948563254556
             le_variance =       3.796898757008


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232492679698e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324926796177       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324927225266       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324927224484       residual = 2.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+01 is 7.380101e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324926796177       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324926903696       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324926903496       residual = 2.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+02 is 1.849447e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324926796177       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324926823072       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324926823022       residual = 2.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+02 is 4.626390e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255512 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9310e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_001                -6.983738e-01 3 1  ON 0
ci_002                -7.020890e-01 3 1  ON 1
ci_003                -6.074654e-02 3 1  ON 2
ci_004                -6.209351e-02 3 1  ON 3
ci_005                 4.548651e-02 3 1  ON 4
ci_006                 4.550882e-02 3 1  ON 5
ci_007                 3.081330e-02 3 1  ON 6
ci_008                 3.278015e-02 3 1  ON 7
ci_009                -2.622111e-02 3 1  ON 8
ci_010                -2.459954e-02 3 1  ON 9
ci_011                -2.274437e-02 3 1  ON 10
ci_012                -2.285210e-02 3 1  ON 11
ci_013                 1.885513e-02 3 1  ON 12
ci_014                 2.004142e-02 3 1  ON 13
ci_015                 1.980775e-02 3 1  ON 14
ci_016                 2.072973e-02 3 1  ON 15
ci_017                 1.567963e-02 3 1  ON 16
ci_018                 1.574470e-02 3 1  ON 17
ci_019                 8.844540e-03 3 1  ON 18
ci_020                 1.011656e-02 3 1  ON 19
ci_021                -9.903175e-03 3 1  ON 20
ci_022                -1.035017e-02 3 1  ON 21
ci_023                 8.429240e-03 3 1  ON 22
ci_024                 8.979972e-03 3 1  ON 23
ci_025                 8.177575e-03 3 1  ON 24
ci_026                 8.377700e-03 3 1  ON 25
ci_027                 8.429135e-03 3 1  ON 26
ci_028                 7.640810e-03 3 1  ON 27
ci_029                -8.459869e-03 3 1  ON 28
ci_030                -7.147046e-03 3 1  ON 29
ci_031                -7.381520e-03 3 1  ON 30
ci_032                -7.071000e-03 3 1  ON 31
ci_033                 7.037412e-03 3 1  ON 32
ci_034                 6.979539e-03 3 1  ON 33
ci_035                 6.931965e-03 3 1  ON 34
ci_036                 7.113307e-03 3 1  ON 35
ci_037                 6.107752e-03 3 1  ON 36
ci_038                 6.847240e-03 3 1  ON 37
ci_039                 5.640857e-03 3 1  ON 38
ci_040                 5.883256e-03 3 1  ON 39
ci_041                 6.157959e-03 3 1  ON 40
ci_042                 5.134979e-03 3 1  ON 41
ci_043                 5.220184e-03 3 1  ON 42
ci_044                 5.599899e-03 3 1  ON 43
ci_045                 4.383012e-03 3 1  ON 44
ci_046                 5.614818e-03 3 1  ON 45
ci_047                -4.900747e-03 3 1  ON 46
ci_048                -4.108512e-03 3 1  ON 47
ci_049                 2.728990e-03 3 1  ON 48
ci_050                 3.376710e-03 3 1  ON 49
ci_051                -2.571820e-03 3 1  ON 50
ci_052                -2.344239e-03 3 1  ON 51
ci_053                -2.763894e-03 3 1  ON 52
ci_054                -1.655920e-03 3 1  ON 53
ci_055                -2.100399e-03 3 1  ON 54
ci_056                -3.535699e-03 3 1  ON 55
ci_057                -1.918914e-03 3 1  ON 56
ci_058                -2.353758e-03 3 1  ON 57
ci_059                -1.188293e-03 3 1  ON 58
ci_060                -1.606126e-03 3 1  ON 59
ci_061                -1.286539e-03 3 1  ON 60
ci_062                -1.156899e-03 3 1  ON 61
ci_063                -1.054520e-03 3 1  ON 62
ci_064                -1.388128e-03 3 1  ON 63
ci_065                -1.975095e-03 3 1  ON 64
ci_066                -1.715390e-03 3 1  ON 65
ci_067                -1.326875e-03 3 1  ON 66
ci_068                -5.480807e-04 3 1  ON 67
ci_069                 1.683060e-03 3 1  ON 68
ci_070                 7.480658e-04 3 1  ON 69
ci_071                -1.570619e-03 3 1  ON 70
ci_072                -1.525640e-03 3 1  ON 71
ci_073                 4.229119e-04 3 1  ON 72
ci_074                 8.094846e-04 3 1  ON 73
ci_075                -6.927900e-04 3 1  ON 74
ci_076                -1.753541e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.0761
    reference variance = 4.42781
====================================================
  Execution time = 2.2888e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6987e+00
  Total weights = 1.9501e+06
  Execution time = 4.3002e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750454589521
                                         uncertainty =       0.024970415727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750454589521
                                         uncertainty =       0.024970415727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369353299
  error estimate for blocks of size 2^( 2) =       0.001440768792
  error estimate for blocks of size 2^( 3) =       0.001504882231
  error estimate for blocks of size 2^( 4) =       0.001547236509
  error estimate for blocks of size 2^( 5) =       0.001573832179
  error estimate for blocks of size 2^( 6) =       0.001591495387
  error estimate for blocks of size 2^( 7) =       0.001603906459

      target function =                  N/A
              le_mean =     -22.328567306665
             les_mean =     502.263630663759
             stat err =       0.001579117633
             autocorr =       1.329835559854
              std dev =       1.936588991145
             le_variance =       3.750376920625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750454632100
                                         uncertainty =       0.024970380461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750454632100
                                         uncertainty =       0.024970380461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369353308
  error estimate for blocks of size 2^( 2) =       0.001440768668
  error estimate for blocks of size 2^( 3) =       0.001504881981
  error estimate for blocks of size 2^( 4) =       0.001547236218
  error estimate for blocks of size 2^( 5) =       0.001573832174
  error estimate for blocks of size 2^( 6) =       0.001591495371
  error estimate for blocks of size 2^( 7) =       0.001603906419

      target function =                  N/A
              le_mean =     -22.328567381092
             les_mean =     502.263637805081
             stat err =       0.001579117546
             autocorr =       1.329835393344
              std dev =       1.936589004498
             le_variance =       3.750376972344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750454608988
                                         uncertainty =       0.024970398040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750454608988
                                         uncertainty =       0.024970398040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369353303
  error estimate for blocks of size 2^( 2) =       0.001440768730
  error estimate for blocks of size 2^( 3) =       0.001504882105
  error estimate for blocks of size 2^( 4) =       0.001547236363
  error estimate for blocks of size 2^( 5) =       0.001573832176
  error estimate for blocks of size 2^( 6) =       0.001591495378
  error estimate for blocks of size 2^( 7) =       0.001603906439

      target function =                  N/A
              le_mean =     -22.328567343652
             les_mean =     502.263634167449
             stat err =       0.001579117589
             autocorr =       1.329835476352
              std dev =       1.936588997357
             le_variance =       3.750376944684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750454591790
                                         uncertainty =       0.024970413514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750454591790
                                         uncertainty =       0.024970413514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369353299
  error estimate for blocks of size 2^( 2) =       0.001440768784
  error estimate for blocks of size 2^( 3) =       0.001504882215
  error estimate for blocks of size 2^( 4) =       0.001547236491
  error estimate for blocks of size 2^( 5) =       0.001573832179
  error estimate for blocks of size 2^( 6) =       0.001591495386
  error estimate for blocks of size 2^( 7) =       0.001603906457

      target function =                  N/A
              le_mean =     -22.328567311257
             les_mean =     502.263631094085
             stat err =       0.001579117628
             autocorr =       1.329835549420
              std dev =       1.936588991879
             le_variance =       3.750376923468


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328567306665        initial
     5.6843e+01     5.6843e+02             7.3801e-06       -22.328567381092  <--
     2.2737e+02     2.2737e+03             1.8494e-06       -22.328567343652
     9.0949e+02     9.0949e+03             4.6264e-07       -22.328567311257

*****************************************************************************
Applying the update for shift_i =   5.6843e+01     and shift_s =   5.6843e+02
*****************************************************************************

  Execution time = 4.4601e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376323e-03 3 1  ON 25
ci_027                 8.431296e-03 3 1  ON 26
ci_028                 7.641714e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111777e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597931e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574599e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661450e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351898e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330873e-03 3 1  ON 66
ci_068                -5.475508e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498006e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251778e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931144e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3929e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2289e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.4046
    reference variance = 2.86933
====================================================
  Execution time = 2.3416e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0322e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.6805e+00
  Total weights = 1.949412540e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9133e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732108737593
                                         uncertainty =       0.026195613526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732108737593
                                         uncertainty =       0.026195613526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366233347
  error estimate for blocks of size 2^( 2) =       0.001438866067
  error estimate for blocks of size 2^( 3) =       0.001501620629
  error estimate for blocks of size 2^( 4) =       0.001547207310
  error estimate for blocks of size 2^( 5) =       0.001572113145
  error estimate for blocks of size 2^( 6) =       0.001585410592
  error estimate for blocks of size 2^( 7) =       0.001589417969

      target function =                  N/A
              le_mean =     -22.326594900030
             les_mean =     502.157353977030
             stat err =       0.001573537254
             autocorr =       1.326490964980
              std dev =       1.932176642679
             le_variance =       3.733306578513


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232659490003e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326594899244       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326596498843       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326596498001       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+01 is 3.712150e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326594899244       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326595303192       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326595302570       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+01 is 9.412331e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326594899244       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326595000487       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326595000306       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+02 is 2.361482e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258393 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9340e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_001                -6.983684e-01 3 1  ON 0
ci_002                -7.020951e-01 3 1  ON 1
ci_003                -6.074581e-02 3 1  ON 2
ci_004                -6.209080e-02 3 1  ON 3
ci_005                 4.548837e-02 3 1  ON 4
ci_006                 4.551463e-02 3 1  ON 5
ci_007                 3.081253e-02 3 1  ON 6
ci_008                 3.277504e-02 3 1  ON 7
ci_009                -2.621837e-02 3 1  ON 8
ci_010                -2.460145e-02 3 1  ON 9
ci_011                -2.273986e-02 3 1  ON 10
ci_012                -2.285361e-02 3 1  ON 11
ci_013                 1.886006e-02 3 1  ON 12
ci_014                 2.004014e-02 3 1  ON 13
ci_015                 1.981163e-02 3 1  ON 14
ci_016                 2.072730e-02 3 1  ON 15
ci_017                 1.568142e-02 3 1  ON 16
ci_018                 1.574462e-02 3 1  ON 17
ci_019                 8.843986e-03 3 1  ON 18
ci_020                 1.010891e-02 3 1  ON 19
ci_021                -9.893316e-03 3 1  ON 20
ci_022                -1.034291e-02 3 1  ON 21
ci_023                 8.432237e-03 3 1  ON 22
ci_024                 8.975252e-03 3 1  ON 23
ci_025                 8.183398e-03 3 1  ON 24
ci_026                 8.372250e-03 3 1  ON 25
ci_027                 8.425919e-03 3 1  ON 26
ci_028                 7.642196e-03 3 1  ON 27
ci_029                -8.455969e-03 3 1  ON 28
ci_030                -7.149036e-03 3 1  ON 29
ci_031                -7.377364e-03 3 1  ON 30
ci_032                -7.071285e-03 3 1  ON 31
ci_033                 7.033035e-03 3 1  ON 32
ci_034                 6.977354e-03 3 1  ON 33
ci_035                 6.935351e-03 3 1  ON 34
ci_036                 7.108390e-03 3 1  ON 35
ci_037                 6.107664e-03 3 1  ON 36
ci_038                 6.847723e-03 3 1  ON 37
ci_039                 5.635844e-03 3 1  ON 38
ci_040                 5.883064e-03 3 1  ON 39
ci_041                 6.154879e-03 3 1  ON 40
ci_042                 5.134722e-03 3 1  ON 41
ci_043                 5.221791e-03 3 1  ON 42
ci_044                 5.600634e-03 3 1  ON 43
ci_045                 4.388365e-03 3 1  ON 44
ci_046                 5.611845e-03 3 1  ON 45
ci_047                -4.885985e-03 3 1  ON 46
ci_048                -4.112084e-03 3 1  ON 47
ci_049                 2.728770e-03 3 1  ON 48
ci_050                 3.379715e-03 3 1  ON 49
ci_051                -2.575245e-03 3 1  ON 50
ci_052                -2.349859e-03 3 1  ON 51
ci_053                -2.771261e-03 3 1  ON 52
ci_054                -1.658620e-03 3 1  ON 53
ci_055                -2.101251e-03 3 1  ON 54
ci_056                -3.527716e-03 3 1  ON 55
ci_057                -1.914603e-03 3 1  ON 56
ci_058                -2.351318e-03 3 1  ON 57
ci_059                -1.199643e-03 3 1  ON 58
ci_060                -1.605122e-03 3 1  ON 59
ci_061                -1.286356e-03 3 1  ON 60
ci_062                -1.162054e-03 3 1  ON 61
ci_063                -1.055511e-03 3 1  ON 62
ci_064                -1.385281e-03 3 1  ON 63
ci_065                -1.968600e-03 3 1  ON 64
ci_066                -1.710069e-03 3 1  ON 65
ci_067                -1.330108e-03 3 1  ON 66
ci_068                -5.511486e-04 3 1  ON 67
ci_069                 1.678189e-03 3 1  ON 68
ci_070                 7.488948e-04 3 1  ON 69
ci_071                -1.561787e-03 3 1  ON 70
ci_072                -1.523246e-03 3 1  ON 71
ci_073                 4.254640e-04 3 1  ON 72
ci_074                 8.113955e-04 3 1  ON 73
ci_075                -6.967021e-04 3 1  ON 74
ci_076                -1.747299e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.3919
    reference variance = 2.51621
====================================================
  Execution time = 2.5182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.8402e+00
  Total weights = 1.9502e+06
  Execution time = 4.3260e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.895423567282
                                         uncertainty =       0.065472899260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.895423567282
                                         uncertainty =       0.065472899260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395337864
  error estimate for blocks of size 2^( 2) =       0.001466029248
  error estimate for blocks of size 2^( 3) =       0.001528951156
  error estimate for blocks of size 2^( 4) =       0.001573616915
  error estimate for blocks of size 2^( 5) =       0.001597766650
  error estimate for blocks of size 2^( 6) =       0.001604594635
  error estimate for blocks of size 2^( 7) =       0.001617997105

      target function =                  N/A
              le_mean =     -22.327113541722
             les_mean =     502.340188180245
             stat err =       0.001598493826
             autocorr =       1.312390770236
              std dev =       1.973337304281
             le_variance =       3.894060116468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.895416041290
                                         uncertainty =       0.065472936452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.895416041290
                                         uncertainty =       0.065472936452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395336524
  error estimate for blocks of size 2^( 2) =       0.001466027703
  error estimate for blocks of size 2^( 3) =       0.001528949921
  error estimate for blocks of size 2^( 4) =       0.001573615770
  error estimate for blocks of size 2^( 5) =       0.001597765956
  error estimate for blocks of size 2^( 6) =       0.001604593664
  error estimate for blocks of size 2^( 7) =       0.001617994856

      target function =                  N/A
              le_mean =     -22.327113533841
             les_mean =     502.345977544034
             stat err =       0.001598492562
             autocorr =       1.312391215080
              std dev =       1.973335408810
             le_variance =       3.894052635665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.895419737583
                                         uncertainty =       0.065472917438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.895419737583
                                         uncertainty =       0.065472917438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395337182
  error estimate for blocks of size 2^( 2) =       0.001466028462
  error estimate for blocks of size 2^( 3) =       0.001528950527
  error estimate for blocks of size 2^( 4) =       0.001573616328
  error estimate for blocks of size 2^( 5) =       0.001597766290
  error estimate for blocks of size 2^( 6) =       0.001604594143
  error estimate for blocks of size 2^( 7) =       0.001617995975

      target function =                  N/A
              le_mean =     -22.327113529736
             les_mean =     502.340202787910
             stat err =       0.001598493184
             autocorr =       1.312390998994
              std dev =       1.973336339714
             le_variance =       3.894056309635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.895423084311
                                         uncertainty =       0.065472901526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.895423084311
                                         uncertainty =       0.065472901526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395337778
  error estimate for blocks of size 2^( 2) =       0.001466029149
  error estimate for blocks of size 2^( 3) =       0.001528951076
  error estimate for blocks of size 2^( 4) =       0.001573616841
  error estimate for blocks of size 2^( 5) =       0.001597766604
  error estimate for blocks of size 2^( 6) =       0.001604594573
  error estimate for blocks of size 2^( 7) =       0.001617996963

      target function =                  N/A
              le_mean =     -22.327113539625
             les_mean =     502.340188551234
             stat err =       0.001598493745
             autocorr =       1.312390799306
              std dev =       1.973337182634
             le_variance =       3.894059636366


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327113541722        initial  <--
     1.4211e+01     1.4211e+02             3.7121e-05       -22.327113533841
     5.6843e+01     5.6843e+02             9.4123e-06       -22.327113529736
     2.2737e+02     2.2737e+03             2.3615e-06       -22.327113539625

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.9456
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376323e-03 3 1  ON 25
ci_027                 8.431296e-03 3 1  ON 26
ci_028                 7.641714e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111777e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597931e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574599e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661450e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351898e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330873e-03 3 1  ON 66
ci_068                -5.475508e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498006e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251778e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931144e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6299e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2291e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.6678
    reference variance = 2.43596
====================================================
  Execution time = 2.3529e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0325e+04
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.6893e+00
  Total weights = 1.949793785e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8636e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.740401549488
                                         uncertainty =       0.026777583212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.740401549488
                                         uncertainty =       0.026777583212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367458942
  error estimate for blocks of size 2^( 2) =       0.001438792801
  error estimate for blocks of size 2^( 3) =       0.001501165598
  error estimate for blocks of size 2^( 4) =       0.001546865701
  error estimate for blocks of size 2^( 5) =       0.001568168626
  error estimate for blocks of size 2^( 6) =       0.001577352591
  error estimate for blocks of size 2^( 7) =       0.001584004237

      target function =                  N/A
              le_mean =     -22.324967757580
             les_mean =     502.093459835896
             stat err =       0.001569097789
             autocorr =       1.316653293103
              std dev =       1.933909924150
             le_variance =       3.740007594725


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232496775758e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324967756756       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324967920906       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324967924524       residual = 7.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+02 is 3.740770e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324967756756       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324967797832       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324967798740       residual = 7.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+02 is 9.357842e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324967756756       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324967767028       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324967767255       residual = 7.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+03 is 2.339831e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259666 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9399e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_001                -6.983699e-01 3 1  ON 0
ci_002                -7.020928e-01 3 1  ON 1
ci_003                -6.074518e-02 3 1  ON 2
ci_004                -6.209250e-02 3 1  ON 3
ci_005                 4.548861e-02 3 1  ON 4
ci_006                 4.551022e-02 3 1  ON 5
ci_007                 3.081596e-02 3 1  ON 6
ci_008                 3.277658e-02 3 1  ON 7
ci_009                -2.622094e-02 3 1  ON 8
ci_010                -2.460005e-02 3 1  ON 9
ci_011                -2.274375e-02 3 1  ON 10
ci_012                -2.285587e-02 3 1  ON 11
ci_013                 1.885753e-02 3 1  ON 12
ci_014                 2.004154e-02 3 1  ON 13
ci_015                 1.980886e-02 3 1  ON 14
ci_016                 2.072895e-02 3 1  ON 15
ci_017                 1.568032e-02 3 1  ON 16
ci_018                 1.574383e-02 3 1  ON 17
ci_019                 8.845097e-03 3 1  ON 18
ci_020                 1.011341e-02 3 1  ON 19
ci_021                -9.898163e-03 3 1  ON 20
ci_022                -1.035025e-02 3 1  ON 21
ci_023                 8.432623e-03 3 1  ON 22
ci_024                 8.977748e-03 3 1  ON 23
ci_025                 8.178034e-03 3 1  ON 24
ci_026                 8.376044e-03 3 1  ON 25
ci_027                 8.430810e-03 3 1  ON 26
ci_028                 7.641402e-03 3 1  ON 27
ci_029                -8.454944e-03 3 1  ON 28
ci_030                -7.149497e-03 3 1  ON 29
ci_031                -7.382915e-03 3 1  ON 30
ci_032                -7.071321e-03 3 1  ON 31
ci_033                 7.035373e-03 3 1  ON 32
ci_034                 6.979019e-03 3 1  ON 33
ci_035                 6.931622e-03 3 1  ON 34
ci_036                 7.111828e-03 3 1  ON 35
ci_037                 6.110939e-03 3 1  ON 36
ci_038                 6.850748e-03 3 1  ON 37
ci_039                 5.640716e-03 3 1  ON 38
ci_040                 5.882739e-03 3 1  ON 39
ci_041                 6.157742e-03 3 1  ON 40
ci_042                 5.133489e-03 3 1  ON 41
ci_043                 5.221525e-03 3 1  ON 42
ci_044                 5.597816e-03 3 1  ON 43
ci_045                 4.383697e-03 3 1  ON 44
ci_046                 5.613651e-03 3 1  ON 45
ci_047                -4.895718e-03 3 1  ON 46
ci_048                -4.110611e-03 3 1  ON 47
ci_049                 2.728932e-03 3 1  ON 48
ci_050                 3.376536e-03 3 1  ON 49
ci_051                -2.574528e-03 3 1  ON 50
ci_052                -2.345840e-03 3 1  ON 51
ci_053                -2.766744e-03 3 1  ON 52
ci_054                -1.661560e-03 3 1  ON 53
ci_055                -2.098180e-03 3 1  ON 54
ci_056                -3.531506e-03 3 1  ON 55
ci_057                -1.916842e-03 3 1  ON 56
ci_058                -2.352147e-03 3 1  ON 57
ci_059                -1.192368e-03 3 1  ON 58
ci_060                -1.604690e-03 3 1  ON 59
ci_061                -1.286069e-03 3 1  ON 60
ci_062                -1.159989e-03 3 1  ON 61
ci_063                -1.052366e-03 3 1  ON 62
ci_064                -1.386198e-03 3 1  ON 63
ci_065                -1.972578e-03 3 1  ON 64
ci_066                -1.713232e-03 3 1  ON 65
ci_067                -1.330955e-03 3 1  ON 66
ci_068                -5.478934e-04 3 1  ON 67
ci_069                 1.679946e-03 3 1  ON 68
ci_070                 7.504956e-04 3 1  ON 69
ci_071                -1.567405e-03 3 1  ON 70
ci_072                -1.527372e-03 3 1  ON 71
ci_073                 4.253763e-04 3 1  ON 72
ci_074                 8.104511e-04 3 1  ON 73
ci_075                -6.930235e-04 3 1  ON 74
ci_076                -1.750497e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.2177
    reference variance = 6.54369
====================================================
  Execution time = 2.2791e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.7652e+00
  Total weights = 1.9499e+06
  Execution time = 4.3164e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.818013381778
                                         uncertainty =       0.069442825012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.818013381778
                                         uncertainty =       0.069442825012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381408327
  error estimate for blocks of size 2^( 2) =       0.001452123842
  error estimate for blocks of size 2^( 3) =       0.001513502695
  error estimate for blocks of size 2^( 4) =       0.001553920815
  error estimate for blocks of size 2^( 5) =       0.001575276435
  error estimate for blocks of size 2^( 6) =       0.001586807978
  error estimate for blocks of size 2^( 7) =       0.001595119345

      target function =                  N/A
              le_mean =     -22.330947368100
             les_mean =     502.436364794896
             stat err =       0.001577781143
             autocorr =       1.304515920200
              std dev =       1.953637648464
             le_variance =       3.816700061495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.818013450963
                                         uncertainty =       0.069442814815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.818013450963
                                         uncertainty =       0.069442814815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381408340
  error estimate for blocks of size 2^( 2) =       0.001452123858
  error estimate for blocks of size 2^( 3) =       0.001513502682
  error estimate for blocks of size 2^( 4) =       0.001553920780
  error estimate for blocks of size 2^( 5) =       0.001575276389
  error estimate for blocks of size 2^( 6) =       0.001586807911
  error estimate for blocks of size 2^( 7) =       0.001595119393

      target function =                  N/A
              le_mean =     -22.330947355288
             les_mean =     502.436368665871
             stat err =       0.001577781118
             autocorr =       1.304515854675
              std dev =       1.953637666580
             le_variance =       3.816700132281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.818013416177
                                         uncertainty =       0.069442819914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.818013416177
                                         uncertainty =       0.069442819914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381408333
  error estimate for blocks of size 2^( 2) =       0.001452123850
  error estimate for blocks of size 2^( 3) =       0.001513502688
  error estimate for blocks of size 2^( 4) =       0.001553920798
  error estimate for blocks of size 2^( 5) =       0.001575276412
  error estimate for blocks of size 2^( 6) =       0.001586807944
  error estimate for blocks of size 2^( 7) =       0.001595119369

      target function =                  N/A
              le_mean =     -22.330947361646
             les_mean =     502.436366655924
             stat err =       0.001577781131
             autocorr =       1.304515887406
              std dev =       1.953637657473
             le_variance =       3.816700096695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.818013386052
                                         uncertainty =       0.069442824375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.818013386052
                                         uncertainty =       0.069442824375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381408328
  error estimate for blocks of size 2^( 2) =       0.001452123843
  error estimate for blocks of size 2^( 3) =       0.001513502694
  error estimate for blocks of size 2^( 4) =       0.001553920813
  error estimate for blocks of size 2^( 5) =       0.001575276432
  error estimate for blocks of size 2^( 6) =       0.001586807974
  error estimate for blocks of size 2^( 7) =       0.001595119348

      target function =                  N/A
              le_mean =     -22.330947367288
             les_mean =     502.436365019923
             stat err =       0.001577781142
             autocorr =       1.304515916099
              std dev =       1.953637649583
             le_variance =       3.816700065869


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330947368100        initial  <--
     1.4211e+02     1.4211e+03             3.7408e-06       -22.330947355288
     5.6843e+02     5.6843e+03             9.3578e-07       -22.330947361646
     2.2737e+03     2.2737e+04             2.3398e-07       -22.330947367288

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5121
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376323e-03 3 1  ON 25
ci_027                 8.431296e-03 3 1  ON 26
ci_028                 7.641714e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111777e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597931e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574599e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661450e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351898e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330873e-03 3 1  ON 66
ci_068                -5.475508e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498006e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251778e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931144e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3921e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2294e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.1526
    reference variance = 2.80868
====================================================
  Execution time = 2.3318e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0312e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7920e+00
  Total weights = 1.949927430e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8361e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.843463972175
                                         uncertainty =       0.040189520483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.843463972175
                                         uncertainty =       0.040189520483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386247468
  error estimate for blocks of size 2^( 2) =       0.001456551914
  error estimate for blocks of size 2^( 3) =       0.001518810939
  error estimate for blocks of size 2^( 4) =       0.001562061331
  error estimate for blocks of size 2^( 5) =       0.001589120162
  error estimate for blocks of size 2^( 6) =       0.001601306927
  error estimate for blocks of size 2^( 7) =       0.001614817549

      target function =                  N/A
              le_mean =     -22.327530332301
             les_mean =     502.310583625610
             stat err =       0.001591826492
             autocorr =       1.318590446285
              std dev =       1.960481336601
             le_variance =       3.843487071162


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232753033230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327530331480       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327530346088       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327530346119       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+03 is 3.460438e-07

solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327530331480       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327530335132       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327530335140       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+03 is 8.651606e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327530331480       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327530332393       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327530332395       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+04 is 2.162934e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.260864 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9161e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074542e-02 3 1  ON 2
ci_004                -6.209265e-02 3 1  ON 3
ci_005                 4.548868e-02 3 1  ON 4
ci_006                 4.551043e-02 3 1  ON 5
ci_007                 3.081562e-02 3 1  ON 6
ci_008                 3.277651e-02 3 1  ON 7
ci_009                -2.622063e-02 3 1  ON 8
ci_010                -2.459986e-02 3 1  ON 9
ci_011                -2.274388e-02 3 1  ON 10
ci_012                -2.285605e-02 3 1  ON 11
ci_013                 1.885740e-02 3 1  ON 12
ci_014                 2.004173e-02 3 1  ON 13
ci_015                 1.980796e-02 3 1  ON 14
ci_016                 2.072972e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574341e-02 3 1  ON 17
ci_019                 8.844876e-03 3 1  ON 18
ci_020                 1.011335e-02 3 1  ON 19
ci_021                -9.897978e-03 3 1  ON 20
ci_022                -1.035076e-02 3 1  ON 21
ci_023                 8.432476e-03 3 1  ON 22
ci_024                 8.978228e-03 3 1  ON 23
ci_025                 8.177537e-03 3 1  ON 24
ci_026                 8.376296e-03 3 1  ON 25
ci_027                 8.431313e-03 3 1  ON 26
ci_028                 7.641709e-03 3 1  ON 27
ci_029                -8.455353e-03 3 1  ON 28
ci_030                -7.149575e-03 3 1  ON 29
ci_031                -7.382307e-03 3 1  ON 30
ci_032                -7.071207e-03 3 1  ON 31
ci_033                 7.035596e-03 3 1  ON 32
ci_034                 6.978984e-03 3 1  ON 33
ci_035                 6.931498e-03 3 1  ON 34
ci_036                 7.111733e-03 3 1  ON 35
ci_037                 6.111131e-03 3 1  ON 36
ci_038                 6.850988e-03 3 1  ON 37
ci_039                 5.641062e-03 3 1  ON 38
ci_040                 5.882761e-03 3 1  ON 39
ci_041                 6.158437e-03 3 1  ON 40
ci_042                 5.133533e-03 3 1  ON 41
ci_043                 5.221496e-03 3 1  ON 42
ci_044                 5.597968e-03 3 1  ON 43
ci_045                 4.384124e-03 3 1  ON 44
ci_046                 5.614011e-03 3 1  ON 45
ci_047                -4.895361e-03 3 1  ON 46
ci_048                -4.110869e-03 3 1  ON 47
ci_049                 2.728456e-03 3 1  ON 48
ci_050                 3.376007e-03 3 1  ON 49
ci_051                -2.574615e-03 3 1  ON 50
ci_052                -2.345715e-03 3 1  ON 51
ci_053                -2.766918e-03 3 1  ON 52
ci_054                -1.661499e-03 3 1  ON 53
ci_055                -2.098287e-03 3 1  ON 54
ci_056                -3.531883e-03 3 1  ON 55
ci_057                -1.917486e-03 3 1  ON 56
ci_058                -2.351896e-03 3 1  ON 57
ci_059                -1.192408e-03 3 1  ON 58
ci_060                -1.604837e-03 3 1  ON 59
ci_061                -1.285937e-03 3 1  ON 60
ci_062                -1.159521e-03 3 1  ON 61
ci_063                -1.052161e-03 3 1  ON 62
ci_064                -1.386401e-03 3 1  ON 63
ci_065                -1.972877e-03 3 1  ON 64
ci_066                -1.713195e-03 3 1  ON 65
ci_067                -1.330792e-03 3 1  ON 66
ci_068                -5.475882e-04 3 1  ON 67
ci_069                 1.679792e-03 3 1  ON 68
ci_070                 7.498026e-04 3 1  ON 69
ci_071                -1.567312e-03 3 1  ON 70
ci_072                -1.527105e-03 3 1  ON 71
ci_073                 4.252071e-04 3 1  ON 72
ci_074                 8.099376e-04 3 1  ON 73
ci_075                -6.930668e-04 3 1  ON 74
ci_076                -1.750740e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.3282
    reference variance = 3.75892
====================================================
  Execution time = 2.2816e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7491e+00
  Total weights = 1.9502e+06
  Execution time = 4.3290e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801948823627
                                         uncertainty =       0.043360611239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801948823627
                                         uncertainty =       0.043360611239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378691127
  error estimate for blocks of size 2^( 2) =       0.001450274217
  error estimate for blocks of size 2^( 3) =       0.001514179701
  error estimate for blocks of size 2^( 4) =       0.001557297914
  error estimate for blocks of size 2^( 5) =       0.001582833186
  error estimate for blocks of size 2^( 6) =       0.001594910907
  error estimate for blocks of size 2^( 7) =       0.001600169512

      target function =                  N/A
              le_mean =     -22.328763777546
             les_mean =     502.322754850084
             stat err =       0.001583802880
             autocorr =       1.319678967857
              std dev =       1.949794886448
             le_variance =       3.801700099220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801948808592
                                         uncertainty =       0.043360611556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801948808592
                                         uncertainty =       0.043360611556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378691124
  error estimate for blocks of size 2^( 2) =       0.001450274210
  error estimate for blocks of size 2^( 3) =       0.001514179687
  error estimate for blocks of size 2^( 4) =       0.001557297899
  error estimate for blocks of size 2^( 5) =       0.001582833171
  error estimate for blocks of size 2^( 6) =       0.001594910878
  error estimate for blocks of size 2^( 7) =       0.001600169482

      target function =                  N/A
              le_mean =     -22.328763774118
             les_mean =     502.322754943668
             stat err =       0.001583802858
             autocorr =       1.319678936319
              std dev =       1.949794882555
             le_variance =       3.801700084038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801948816106
                                         uncertainty =       0.043360611398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801948816106
                                         uncertainty =       0.043360611398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378691126
  error estimate for blocks of size 2^( 2) =       0.001450274214
  error estimate for blocks of size 2^( 3) =       0.001514179694
  error estimate for blocks of size 2^( 4) =       0.001557297907
  error estimate for blocks of size 2^( 5) =       0.001582833179
  error estimate for blocks of size 2^( 6) =       0.001594910892
  error estimate for blocks of size 2^( 7) =       0.001600169497

      target function =                  N/A
              le_mean =     -22.328763775831
             les_mean =     502.322754894089
             stat err =       0.001583802869
             autocorr =       1.319678952088
              std dev =       1.949794884501
             le_variance =       3.801700091625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801948822687
                                         uncertainty =       0.043360611259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801948822687
                                         uncertainty =       0.043360611259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378691127
  error estimate for blocks of size 2^( 2) =       0.001450274217
  error estimate for blocks of size 2^( 3) =       0.001514179700
  error estimate for blocks of size 2^( 4) =       0.001557297913
  error estimate for blocks of size 2^( 5) =       0.001582833186
  error estimate for blocks of size 2^( 6) =       0.001594910905
  error estimate for blocks of size 2^( 7) =       0.001600169510

      target function =                  N/A
              le_mean =     -22.328763777332
             les_mean =     502.322754855252
             stat err =       0.001583802878
             autocorr =       1.319678965885
              std dev =       1.949794886205
             le_variance =       3.801700098270


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328763777546        initial  <--
     1.4211e+03     1.4211e+04             3.4604e-07       -22.328763774118
     5.6843e+03     5.6843e+04             8.6516e-08       -22.328763775831
     2.2737e+04     2.2737e+05             2.1629e-08       -22.328763777332

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5999
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376323e-03 3 1  ON 25
ci_027                 8.431296e-03 3 1  ON 26
ci_028                 7.641714e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111777e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597931e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574599e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661450e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351898e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330873e-03 3 1  ON 66
ci_068                -5.475508e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498006e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251778e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931144e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3770e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2293e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.4867
    reference variance = 2.54059
====================================================
  Execution time = 2.3351e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0273e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7775e+00
  Total weights = 1.949848185e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8594e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.829058608126
                                         uncertainty =       0.067437007986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.829058608126
                                         uncertainty =       0.067437007986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383742103
  error estimate for blocks of size 2^( 2) =       0.001455194464
  error estimate for blocks of size 2^( 3) =       0.001518162097
  error estimate for blocks of size 2^( 4) =       0.001562543176
  error estimate for blocks of size 2^( 5) =       0.001587053941
  error estimate for blocks of size 2^( 6) =       0.001598588494
  error estimate for blocks of size 2^( 7) =       0.001599938553

      target function =                  N/A
              le_mean =     -22.328553509805
             les_mean =     502.341846826362
             stat err =       0.001587031041
             autocorr =       1.315408160271
              std dev =       1.956938159330
             le_variance =       3.829606959441


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232855350980e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+04, overlap shift 1.4211e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328553508918       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328553511167       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328553511159       residual = 5.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+04 is 3.805987e-08

solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328553508918       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328553509480       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328553509478       residual = 5.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+04 is 9.515049e-09

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328553508918       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328553509059       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328553509058       residual = 5.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+05 is 2.378767e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262125 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9218e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074542e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081561e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072981e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844819e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897965e-03 3 1  ON 20
ci_022                -1.035080e-02 3 1  ON 21
ci_023                 8.432432e-03 3 1  ON 22
ci_024                 8.978241e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376327e-03 3 1  ON 25
ci_027                 8.431289e-03 3 1  ON 26
ci_028                 7.641719e-03 3 1  ON 27
ci_029                -8.455368e-03 3 1  ON 28
ci_030                -7.149590e-03 3 1  ON 29
ci_031                -7.382295e-03 3 1  ON 30
ci_032                -7.071166e-03 3 1  ON 31
ci_033                 7.035557e-03 3 1  ON 32
ci_034                 6.978986e-03 3 1  ON 33
ci_035                 6.931501e-03 3 1  ON 34
ci_036                 7.111771e-03 3 1  ON 35
ci_037                 6.111117e-03 3 1  ON 36
ci_038                 6.850993e-03 3 1  ON 37
ci_039                 5.641093e-03 3 1  ON 38
ci_040                 5.882744e-03 3 1  ON 39
ci_041                 6.158483e-03 3 1  ON 40
ci_042                 5.133512e-03 3 1  ON 41
ci_043                 5.221514e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384070e-03 3 1  ON 44
ci_046                 5.613999e-03 3 1  ON 45
ci_047                -4.895388e-03 3 1  ON 46
ci_048                -4.110865e-03 3 1  ON 47
ci_049                 2.728460e-03 3 1  ON 48
ci_050                 3.376035e-03 3 1  ON 49
ci_051                -2.574597e-03 3 1  ON 50
ci_052                -2.345730e-03 3 1  ON 51
ci_053                -2.766918e-03 3 1  ON 52
ci_054                -1.661455e-03 3 1  ON 53
ci_055                -2.098304e-03 3 1  ON 54
ci_056                -3.531911e-03 3 1  ON 55
ci_057                -1.917445e-03 3 1  ON 56
ci_058                -2.351896e-03 3 1  ON 57
ci_059                -1.192360e-03 3 1  ON 58
ci_060                -1.604859e-03 3 1  ON 59
ci_061                -1.285935e-03 3 1  ON 60
ci_062                -1.159560e-03 3 1  ON 61
ci_063                -1.052136e-03 3 1  ON 62
ci_064                -1.386428e-03 3 1  ON 63
ci_065                -1.972933e-03 3 1  ON 64
ci_066                -1.713263e-03 3 1  ON 65
ci_067                -1.330875e-03 3 1  ON 66
ci_068                -5.475532e-04 3 1  ON 67
ci_069                 1.679771e-03 3 1  ON 68
ci_070                 7.498030e-04 3 1  ON 69
ci_071                -1.567330e-03 3 1  ON 70
ci_072                -1.527152e-03 3 1  ON 71
ci_073                 4.251844e-04 3 1  ON 72
ci_074                 8.099045e-04 3 1  ON 73
ci_075                -6.931144e-04 3 1  ON 74
ci_076                -1.750790e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.1287
    reference variance = 2.97592
====================================================
  Execution time = 2.2855e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7630e+00
  Total weights = 1.9498e+06
  Execution time = 4.3198e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814227334906
                                         uncertainty =       0.034390942685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814227334906
                                         uncertainty =       0.034390942685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380992887
  error estimate for blocks of size 2^( 2) =       0.001451597611
  error estimate for blocks of size 2^( 3) =       0.001512721374
  error estimate for blocks of size 2^( 4) =       0.001556749634
  error estimate for blocks of size 2^( 5) =       0.001579311522
  error estimate for blocks of size 2^( 6) =       0.001591570328
  error estimate for blocks of size 2^( 7) =       0.001596816803

      target function =                  N/A
              le_mean =     -22.327393471139
             les_mean =     502.275524787873
             stat err =       0.001581112072
             autocorr =       1.310818087486
              std dev =       1.953050118730
             le_variance =       3.814404766272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814227342777
                                         uncertainty =       0.034390942685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814227342777
                                         uncertainty =       0.034390942685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380992889
  error estimate for blocks of size 2^( 2) =       0.001451597611
  error estimate for blocks of size 2^( 3) =       0.001512721374
  error estimate for blocks of size 2^( 4) =       0.001556749632
  error estimate for blocks of size 2^( 5) =       0.001579311519
  error estimate for blocks of size 2^( 6) =       0.001591570327
  error estimate for blocks of size 2^( 7) =       0.001596816803

      target function =                  N/A
              le_mean =     -22.327393470992
             les_mean =     502.275524796705
             stat err =       0.001581112070
             autocorr =       1.310818082156
              std dev =       1.953050120759
             le_variance =       3.814404774198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814227338842
                                         uncertainty =       0.034390942685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814227338842
                                         uncertainty =       0.034390942685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380992888
  error estimate for blocks of size 2^( 2) =       0.001451597611
  error estimate for blocks of size 2^( 3) =       0.001512721374
  error estimate for blocks of size 2^( 4) =       0.001556749633
  error estimate for blocks of size 2^( 5) =       0.001579311521
  error estimate for blocks of size 2^( 6) =       0.001591570327
  error estimate for blocks of size 2^( 7) =       0.001596816803

      target function =                  N/A
              le_mean =     -22.327393471065
             les_mean =     502.275524792287
             stat err =       0.001581112071
             autocorr =       1.310818084821
              std dev =       1.953050119745
             le_variance =       3.814404770235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814227335398
                                         uncertainty =       0.034390942685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814227335398
                                         uncertainty =       0.034390942685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380992887
  error estimate for blocks of size 2^( 2) =       0.001451597611
  error estimate for blocks of size 2^( 3) =       0.001512721374
  error estimate for blocks of size 2^( 4) =       0.001556749633
  error estimate for blocks of size 2^( 5) =       0.001579311522
  error estimate for blocks of size 2^( 6) =       0.001591570328
  error estimate for blocks of size 2^( 7) =       0.001596816803

      target function =                  N/A
              le_mean =     -22.327393471130
             les_mean =     502.275524788425
             stat err =       0.001581112072
             autocorr =       1.310818087153
              std dev =       1.953050118857
             le_variance =       3.814404766767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327393471139        initial  <--
     1.4211e+04     1.4211e+05             3.8060e-08       -22.327393470992
     5.6843e+04     5.6843e+05             9.5150e-09       -22.327393471065
     2.2737e+05     2.2737e+06             2.3788e-09       -22.327393471130

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6091
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376323e-03 3 1  ON 25
ci_027                 8.431296e-03 3 1  ON 26
ci_028                 7.641714e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111777e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597931e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574599e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661450e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351898e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330873e-03 3 1  ON 66
ci_068                -5.475508e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498006e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251778e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931144e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3835e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2293e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.3694
    reference variance = 2.27526
====================================================
  Execution time = 2.3358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0352e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8893e+00
  Total weights = 1.949877424e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8624e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.941899547931
                                         uncertainty =       0.145784038426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.941899547931
                                         uncertainty =       0.145784038426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001403754837
  error estimate for blocks of size 2^( 2) =       0.001472468917
  error estimate for blocks of size 2^( 3) =       0.001534489785
  error estimate for blocks of size 2^( 4) =       0.001578285485
  error estimate for blocks of size 2^( 5) =       0.001600720778
  error estimate for blocks of size 2^( 6) =       0.001613021465
  error estimate for blocks of size 2^( 7) =       0.001622989109

      target function =                  N/A
              le_mean =     -22.327746154525
             les_mean =     502.417583324846
             stat err =       0.001603754209
             autocorr =       1.305248152691
              std dev =       1.985240891320
             le_variance =       3.941181396567


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232774615452e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+05, overlap shift 1.4211e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327746153713       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327746153843       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327746153844       residual = 1.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+05 is 2.902354e-09

solving harmonic davidson linear method for identity shift 5.6843e+05, overlap shift 5.6843e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327746153713       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327746153745       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327746153746       residual = 1.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+05 is 7.255893e-10

solving harmonic davidson linear method for identity shift 2.2737e+06, overlap shift 2.2737e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327746153713       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327746153721       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327746153721       residual = 1.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+06 is 1.813974e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.263323 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9227e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641714e-03 3 1  ON 27
ci_029                -8.455368e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111116e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597931e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531911e-03 3 1  ON 55
ci_057                -1.917447e-03 3 1  ON 56
ci_058                -2.351898e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285938e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972929e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330873e-03 3 1  ON 66
ci_068                -5.475505e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498008e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251785e-04 3 1  ON 72
ci_074                 8.099033e-04 3 1  ON 73
ci_075                -6.931141e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.2683
    reference variance = 4.37915
====================================================
  Execution time = 2.5156e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7263e+00
  Total weights = 1.9498e+06
  Execution time = 4.3112e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780469988705
                                         uncertainty =       0.026666112127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780469988705
                                         uncertainty =       0.026666112127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374665300
  error estimate for blocks of size 2^( 2) =       0.001444559342
  error estimate for blocks of size 2^( 3) =       0.001507587868
  error estimate for blocks of size 2^( 4) =       0.001548446494
  error estimate for blocks of size 2^( 5) =       0.001574881226
  error estimate for blocks of size 2^( 6) =       0.001588500460
  error estimate for blocks of size 2^( 7) =       0.001597131939

      target function =                  N/A
              le_mean =     -22.327004418355
             les_mean =     502.221379424861
             stat err =       0.001577240030
             autocorr =       1.316441731607
              std dev =       1.944101416151
             le_variance =       3.779530316281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780469988785
                                         uncertainty =       0.026666112126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780469988785
                                         uncertainty =       0.026666112126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374665300
  error estimate for blocks of size 2^( 2) =       0.001444559342
  error estimate for blocks of size 2^( 3) =       0.001507587868
  error estimate for blocks of size 2^( 4) =       0.001548446494
  error estimate for blocks of size 2^( 5) =       0.001574881226
  error estimate for blocks of size 2^( 6) =       0.001588500460
  error estimate for blocks of size 2^( 7) =       0.001597131939

      target function =                  N/A
              le_mean =     -22.327004418351
             les_mean =     502.221379424044
             stat err =       0.001577240030
             autocorr =       1.316441731512
              std dev =       1.944101416172
             le_variance =       3.779530316362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780469988745
                                         uncertainty =       0.026666112126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780469988745
                                         uncertainty =       0.026666112126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374665300
  error estimate for blocks of size 2^( 2) =       0.001444559342
  error estimate for blocks of size 2^( 3) =       0.001507587868
  error estimate for blocks of size 2^( 4) =       0.001548446494
  error estimate for blocks of size 2^( 5) =       0.001574881226
  error estimate for blocks of size 2^( 6) =       0.001588500460
  error estimate for blocks of size 2^( 7) =       0.001597131939

      target function =                  N/A
              le_mean =     -22.327004418353
             les_mean =     502.221379424453
             stat err =       0.001577240030
             autocorr =       1.316441731560
              std dev =       1.944101416162
             le_variance =       3.779530316322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780469988710
                                         uncertainty =       0.026666112127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780469988710
                                         uncertainty =       0.026666112127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374665300
  error estimate for blocks of size 2^( 2) =       0.001444559342
  error estimate for blocks of size 2^( 3) =       0.001507587868
  error estimate for blocks of size 2^( 4) =       0.001548446494
  error estimate for blocks of size 2^( 5) =       0.001574881226
  error estimate for blocks of size 2^( 6) =       0.001588500460
  error estimate for blocks of size 2^( 7) =       0.001597131939

      target function =                  N/A
              le_mean =     -22.327004418355
             les_mean =     502.221379424810
             stat err =       0.001577240030
             autocorr =       1.316441731601
              std dev =       1.944101416153
             le_variance =       3.779530316286


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327004418355        initial  <--
     1.4211e+05     1.4211e+06             2.9024e-09       -22.327004418351
     5.6843e+05     5.6843e+06             7.2559e-10       -22.327004418353
     2.2737e+06     2.2737e+07             1.8140e-10       -22.327004418355

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.8284
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376323e-03 3 1  ON 25
ci_027                 8.431296e-03 3 1  ON 26
ci_028                 7.641714e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111777e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597931e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574599e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661450e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351898e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330873e-03 3 1  ON 66
ci_068                -5.475508e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498006e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251778e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931144e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6065e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2293e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.3823
    reference variance = 2.7717
====================================================
  Execution time = 2.3372e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0276e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 4.0139e+00
  Total weights = 1.949939251e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8283e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.072757146938
                                         uncertainty =       0.311891253297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.072757146938
                                         uncertainty =       0.311891253297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001427017221
  error estimate for blocks of size 2^( 2) =       0.001495500136
  error estimate for blocks of size 2^( 3) =       0.001558564960
  error estimate for blocks of size 2^( 4) =       0.001597187864
  error estimate for blocks of size 2^( 5) =       0.001619770333
  error estimate for blocks of size 2^( 6) =       0.001631787400
  error estimate for blocks of size 2^( 7) =       0.001642898532

      target function =                  N/A
              le_mean =     -22.325838459930
             les_mean =     502.456939647105
             stat err =       0.001622911032
             autocorr =       1.293394461896
              std dev =       2.018139396467
             le_variance =       4.072886623573


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232583845993e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325838459126       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325838459144       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325838459144       residual = 8.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+06 is 2.760980e-10

solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325838459126       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325838459131       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325838459131       residual = 8.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+06 is 6.902451e-11

solving harmonic davidson linear method for identity shift 2.2737e+07, overlap shift 2.2737e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325838459126       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325838459127       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325838459127       residual = 8.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+07 is 1.725613e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264532 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9207e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376323e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641714e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111777e-03 3 1  ON 35
ci_037                 6.111116e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597931e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574599e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351898e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330873e-03 3 1  ON 66
ci_068                -5.475509e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498006e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251778e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931144e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.2517
    reference variance = 2.556
====================================================
  Execution time = 2.2844e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7741e+00
  Total weights = 1.9504e+06
  Execution time = 4.3045e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826476239613
                                         uncertainty =       0.057188716529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826476239613
                                         uncertainty =       0.057188716529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383136607
  error estimate for blocks of size 2^( 2) =       0.001453845524
  error estimate for blocks of size 2^( 3) =       0.001515680768
  error estimate for blocks of size 2^( 4) =       0.001560212342
  error estimate for blocks of size 2^( 5) =       0.001587176100
  error estimate for blocks of size 2^( 6) =       0.001598310068
  error estimate for blocks of size 2^( 7) =       0.001608801021

      target function =                  N/A
              le_mean =     -22.327428719573
             les_mean =     502.288176993633
             stat err =       0.001588624883
             autocorr =       1.319205854677
              std dev =       1.956081844177
             le_variance =       3.826256181117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826476239538
                                         uncertainty =       0.057188716531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826476239538
                                         uncertainty =       0.057188716531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383136607
  error estimate for blocks of size 2^( 2) =       0.001453845524
  error estimate for blocks of size 2^( 3) =       0.001515680768
  error estimate for blocks of size 2^( 4) =       0.001560212342
  error estimate for blocks of size 2^( 5) =       0.001587176100
  error estimate for blocks of size 2^( 6) =       0.001598310068
  error estimate for blocks of size 2^( 7) =       0.001608801021

      target function =                  N/A
              le_mean =     -22.327428719574
             les_mean =     502.288176992438
             stat err =       0.001588624883
             autocorr =       1.319205854675
              std dev =       1.956081844157
             le_variance =       3.826256181041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826476239575
                                         uncertainty =       0.057188716530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826476239575
                                         uncertainty =       0.057188716530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383136607
  error estimate for blocks of size 2^( 2) =       0.001453845524
  error estimate for blocks of size 2^( 3) =       0.001515680768
  error estimate for blocks of size 2^( 4) =       0.001560212342
  error estimate for blocks of size 2^( 5) =       0.001587176100
  error estimate for blocks of size 2^( 6) =       0.001598310068
  error estimate for blocks of size 2^( 7) =       0.001608801021

      target function =                  N/A
              le_mean =     -22.327428719573
             les_mean =     502.288176993036
             stat err =       0.001588624883
             autocorr =       1.319205854677
              std dev =       1.956081844167
             le_variance =       3.826256181079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826476239609
                                         uncertainty =       0.057188716529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826476239609
                                         uncertainty =       0.057188716529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383136607
  error estimate for blocks of size 2^( 2) =       0.001453845524
  error estimate for blocks of size 2^( 3) =       0.001515680768
  error estimate for blocks of size 2^( 4) =       0.001560212342
  error estimate for blocks of size 2^( 5) =       0.001587176100
  error estimate for blocks of size 2^( 6) =       0.001598310068
  error estimate for blocks of size 2^( 7) =       0.001608801021

      target function =                  N/A
              le_mean =     -22.327428719573
             les_mean =     502.288176993559
             stat err =       0.001588624883
             autocorr =       1.319205854678
              std dev =       1.956081844175
             le_variance =       3.826256181113


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327428719573        initial
     1.4211e+06     1.4211e+07             2.7610e-10       -22.327428719574  <--
     5.6843e+06     5.6843e+07             6.9025e-11       -22.327428719573
     2.2737e+07     2.2737e+08             1.7256e-11       -22.327428719573

*****************************************************************************
Applying the update for shift_i =   1.4211e+06     and shift_s =   1.4211e+07
*****************************************************************************

  Execution time = 4.4561e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111116e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351898e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475509e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527161e-03 3 1  ON 71
ci_073                 4.251779e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931144e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3776e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2294e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.2978
    reference variance = 4.0939
====================================================
  Execution time = 2.3342e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0338e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7683e+00
  Total weights = 1.949912933e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7738e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820654537160
                                         uncertainty =       0.046360009511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820654537160
                                         uncertainty =       0.046360009511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382055433
  error estimate for blocks of size 2^( 2) =       0.001452868875
  error estimate for blocks of size 2^( 3) =       0.001516582879
  error estimate for blocks of size 2^( 4) =       0.001560510220
  error estimate for blocks of size 2^( 5) =       0.001585286197
  error estimate for blocks of size 2^( 6) =       0.001603214956
  error estimate for blocks of size 2^( 7) =       0.001616750439

      target function =                  N/A
              le_mean =     -22.328802714463
             les_mean =     502.343733211413
             stat err =       0.001591440453
             autocorr =       1.325958285191
              std dev =       1.954552809667
             le_variance =       3.820276685776


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232880271446e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328802713646       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328802713731       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328802713731       residual = 3.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+05 is 1.208185e-09

solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328802713646       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328802713667       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328802713667       residual = 3.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+06 is 3.020463e-10

solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328802713646       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328802713651       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328802713651       residual = 3.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+06 is 7.551159e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9123e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111116e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597931e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345722e-03 3 1  ON 51
ci_053                -2.766918e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972929e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330873e-03 3 1  ON 66
ci_068                -5.475509e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498008e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527161e-03 3 1  ON 71
ci_073                 4.251780e-04 3 1  ON 72
ci_074                 8.099033e-04 3 1  ON 73
ci_075                -6.931144e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.3199
    reference variance = 4.19048
====================================================
  Execution time = 2.2828e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.8273e+00
  Total weights = 1.9497e+06
  Execution time = 4.2991e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.882192666937
                                         uncertainty =       0.101249703657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.882192666937
                                         uncertainty =       0.101249703657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001393237629
  error estimate for blocks of size 2^( 2) =       0.001463871244
  error estimate for blocks of size 2^( 3) =       0.001525991434
  error estimate for blocks of size 2^( 4) =       0.001569102195
  error estimate for blocks of size 2^( 5) =       0.001594341936
  error estimate for blocks of size 2^( 6) =       0.001603910443
  error estimate for blocks of size 2^( 7) =       0.001614823720

      target function =                  N/A
              le_mean =     -22.326224227222
             les_mean =     502.287627777211
             stat err =       0.001595544573
             autocorr =       1.311497573823
              std dev =       1.970367075592
             le_variance =       3.882346412578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.882192666937
                                         uncertainty =       0.101249703653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.882192666937
                                         uncertainty =       0.101249703653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001393237629
  error estimate for blocks of size 2^( 2) =       0.001463871244
  error estimate for blocks of size 2^( 3) =       0.001525991434
  error estimate for blocks of size 2^( 4) =       0.001569102195
  error estimate for blocks of size 2^( 5) =       0.001594341936
  error estimate for blocks of size 2^( 6) =       0.001603910443
  error estimate for blocks of size 2^( 7) =       0.001614823720

      target function =                  N/A
              le_mean =     -22.326224227222
             les_mean =     502.287627777699
             stat err =       0.001595544573
             autocorr =       1.311497573551
              std dev =       1.970367075594
             le_variance =       3.882346412585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.882192666937
                                         uncertainty =       0.101249703655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.882192666937
                                         uncertainty =       0.101249703655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001393237629
  error estimate for blocks of size 2^( 2) =       0.001463871244
  error estimate for blocks of size 2^( 3) =       0.001525991434
  error estimate for blocks of size 2^( 4) =       0.001569102195
  error estimate for blocks of size 2^( 5) =       0.001594341936
  error estimate for blocks of size 2^( 6) =       0.001603910443
  error estimate for blocks of size 2^( 7) =       0.001614823720

      target function =                  N/A
              le_mean =     -22.326224227222
             les_mean =     502.287627777455
             stat err =       0.001595544573
             autocorr =       1.311497573688
              std dev =       1.970367075593
             le_variance =       3.882346412581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.882192666937
                                         uncertainty =       0.101249703657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.882192666937
                                         uncertainty =       0.101249703657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001393237629
  error estimate for blocks of size 2^( 2) =       0.001463871244
  error estimate for blocks of size 2^( 3) =       0.001525991434
  error estimate for blocks of size 2^( 4) =       0.001569102195
  error estimate for blocks of size 2^( 5) =       0.001594341936
  error estimate for blocks of size 2^( 6) =       0.001603910443
  error estimate for blocks of size 2^( 7) =       0.001614823720

      target function =                  N/A
              le_mean =     -22.326224227222
             les_mean =     502.287627777242
             stat err =       0.001595544573
             autocorr =       1.311497573807
              std dev =       1.970367075592
             le_variance =       3.882346412578


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326224227222        initial  <--
     3.5527e+05     3.5527e+06             1.2082e-09       -22.326224227222
     1.4211e+06     1.4211e+07             3.0205e-10       -22.326224227222
     5.6843e+06     5.6843e+07             7.5512e-11       -22.326224227222

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.4749
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111116e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351898e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475509e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527161e-03 3 1  ON 71
ci_073                 4.251779e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931144e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3607e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2294e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.5349
    reference variance = 1.95656
====================================================
  Execution time = 2.3414e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0338e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.8631e+00
  Total weights = 1.950097304e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7966e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.915536004318
                                         uncertainty =       0.141140882622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.915536004318
                                         uncertainty =       0.141140882622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001399404503
  error estimate for blocks of size 2^( 2) =       0.001468798644
  error estimate for blocks of size 2^( 3) =       0.001529943602
  error estimate for blocks of size 2^( 4) =       0.001571976634
  error estimate for blocks of size 2^( 5) =       0.001596549901
  error estimate for blocks of size 2^( 6) =       0.001611086791
  error estimate for blocks of size 2^( 7) =       0.001620170009

      target function =                  N/A
              le_mean =     -22.328640465958
             les_mean =     502.431306762619
             stat err =       0.001599945834
             autocorr =       1.307145780647
              std dev =       1.979088492381
             le_variance =       3.916791260674


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232864046596e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328640465130       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328640465136       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328640465136       residual = 2.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+06 is 1.489962e-10

solving harmonic davidson linear method for identity shift 1.4211e+07, overlap shift 1.4211e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328640465130       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328640465131       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328640465131       residual = 2.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+07 is 3.724905e-11

solving harmonic davidson linear method for identity shift 5.6843e+07, overlap shift 5.6843e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328640465130       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328640465130       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328640465130       residual = 2.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+07 is 9.312263e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.266931 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9217e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111116e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351898e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475509e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527161e-03 3 1  ON 71
ci_073                 4.251779e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931144e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.4621
    reference variance = 2.40911
====================================================
  Execution time = 2.2878e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6796e+00
  Total weights = 1.9499e+06
  Execution time = 4.2894e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732013775747
                                         uncertainty =       0.026616664406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732013775747
                                         uncertainty =       0.026616664406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365794614
  error estimate for blocks of size 2^( 2) =       0.001437789701
  error estimate for blocks of size 2^( 3) =       0.001500550613
  error estimate for blocks of size 2^( 4) =       0.001545796715
  error estimate for blocks of size 2^( 5) =       0.001572713704
  error estimate for blocks of size 2^( 6) =       0.001587387083
  error estimate for blocks of size 2^( 7) =       0.001587654694

      target function =                  N/A
              le_mean =     -22.329703912317
             les_mean =     502.295233011384
             stat err =       0.001573388049
             autocorr =       1.327091607370
              std dev =       1.931556170578
             le_variance =       3.730909240096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732013775722
                                         uncertainty =       0.026616664406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732013775722
                                         uncertainty =       0.026616664406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365794614
  error estimate for blocks of size 2^( 2) =       0.001437789701
  error estimate for blocks of size 2^( 3) =       0.001500550613
  error estimate for blocks of size 2^( 4) =       0.001545796715
  error estimate for blocks of size 2^( 5) =       0.001572713704
  error estimate for blocks of size 2^( 6) =       0.001587387083
  error estimate for blocks of size 2^( 7) =       0.001587654694

      target function =                  N/A
              le_mean =     -22.329703912318
             les_mean =     502.295233011239
             stat err =       0.001573388049
             autocorr =       1.327091607364
              std dev =       1.931556170571
             le_variance =       3.730909240070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732013775735
                                         uncertainty =       0.026616664406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732013775735
                                         uncertainty =       0.026616664406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365794614
  error estimate for blocks of size 2^( 2) =       0.001437789701
  error estimate for blocks of size 2^( 3) =       0.001500550613
  error estimate for blocks of size 2^( 4) =       0.001545796715
  error estimate for blocks of size 2^( 5) =       0.001572713704
  error estimate for blocks of size 2^( 6) =       0.001587387083
  error estimate for blocks of size 2^( 7) =       0.001587654694

      target function =                  N/A
              le_mean =     -22.329703912318
             les_mean =     502.295233011312
             stat err =       0.001573388049
             autocorr =       1.327091607367
              std dev =       1.931556170574
             le_variance =       3.730909240083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732013775746
                                         uncertainty =       0.026616664406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732013775746
                                         uncertainty =       0.026616664406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365794614
  error estimate for blocks of size 2^( 2) =       0.001437789701
  error estimate for blocks of size 2^( 3) =       0.001500550613
  error estimate for blocks of size 2^( 4) =       0.001545796715
  error estimate for blocks of size 2^( 5) =       0.001572713704
  error estimate for blocks of size 2^( 6) =       0.001587387083
  error estimate for blocks of size 2^( 7) =       0.001587654694

      target function =                  N/A
              le_mean =     -22.329703912317
             les_mean =     502.295233011375
             stat err =       0.001573388049
             autocorr =       1.327091607370
              std dev =       1.931556170577
             le_variance =       3.730909240094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329703912317        initial
     3.5527e+06     3.5527e+07             1.4900e-10       -22.329703912318  <--
     1.4211e+07     1.4211e+08             3.7249e-11       -22.329703912318
     5.6843e+07     5.6843e+08             9.3123e-12       -22.329703912317

*****************************************************************************
Applying the update for shift_i =   3.5527e+06     and shift_s =   3.5527e+07
*****************************************************************************

  Execution time = 4.4491e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251780e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3716e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2298e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.5514
    reference variance = 2.1022
====================================================
  Execution time = 2.3400e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0318e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.9729e+00
  Total weights = 1.949779357e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8154e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.030293542419
                                         uncertainty =       0.170044070597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.030293542419
                                         uncertainty =       0.170044070597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001419272230
  error estimate for blocks of size 2^( 2) =       0.001487206048
  error estimate for blocks of size 2^( 3) =       0.001548820170
  error estimate for blocks of size 2^( 4) =       0.001588895892
  error estimate for blocks of size 2^( 5) =       0.001613911717
  error estimate for blocks of size 2^( 6) =       0.001623117100
  error estimate for blocks of size 2^( 7) =       0.001633403263

      target function =                  N/A
              le_mean =     -22.327266127564
             les_mean =     502.479737812228
             stat err =       0.001614831993
             autocorr =       1.294563266547
              std dev =       2.007186150453
             le_variance =       4.028796242570


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232726612756e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+05, overlap shift 8.8818e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327266126719       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327266126740       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327266126740       residual = 2.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+05 is 4.639913e-10

solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327266126719       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327266126724       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327266126724       residual = 2.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+06 is 1.159979e-10

solving harmonic davidson linear method for identity shift 1.4211e+07, overlap shift 1.4211e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327266126719       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327266126720       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327266126720       residual = 2.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+07 is 2.899947e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268131 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9222e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597931e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475511e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498008e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931146e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -21.9062
    reference variance = 17.3279
====================================================
  Execution time = 2.4998e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6678e+00
  Total weights = 1.9498e+06
  Execution time = 4.3072e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719815537614
                                         uncertainty =       0.025729897295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719815537614
                                         uncertainty =       0.025729897295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363703695
  error estimate for blocks of size 2^( 2) =       0.001434045971
  error estimate for blocks of size 2^( 3) =       0.001498116299
  error estimate for blocks of size 2^( 4) =       0.001541974876
  error estimate for blocks of size 2^( 5) =       0.001568984423
  error estimate for blocks of size 2^( 6) =       0.001579932293
  error estimate for blocks of size 2^( 7) =       0.001585540508

      target function =                  N/A
              le_mean =     -22.328367671440
             les_mean =     502.223776055672
             stat err =       0.001569108025
             autocorr =       1.323931918166
              std dev =       1.928599117741
             le_variance =       3.719494556951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719815537661
                                         uncertainty =       0.025729897293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719815537661
                                         uncertainty =       0.025729897293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363703695
  error estimate for blocks of size 2^( 2) =       0.001434045971
  error estimate for blocks of size 2^( 3) =       0.001498116299
  error estimate for blocks of size 2^( 4) =       0.001541974876
  error estimate for blocks of size 2^( 5) =       0.001568984423
  error estimate for blocks of size 2^( 6) =       0.001579932293
  error estimate for blocks of size 2^( 7) =       0.001585540508

      target function =                  N/A
              le_mean =     -22.328367671440
             les_mean =     502.223776056085
             stat err =       0.001569108025
             autocorr =       1.323931918105
              std dev =       1.928599117754
             le_variance =       3.719494557000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719815537637
                                         uncertainty =       0.025729897294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719815537637
                                         uncertainty =       0.025729897294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363703695
  error estimate for blocks of size 2^( 2) =       0.001434045971
  error estimate for blocks of size 2^( 3) =       0.001498116299
  error estimate for blocks of size 2^( 4) =       0.001541974876
  error estimate for blocks of size 2^( 5) =       0.001568984423
  error estimate for blocks of size 2^( 6) =       0.001579932293
  error estimate for blocks of size 2^( 7) =       0.001585540508

      target function =                  N/A
              le_mean =     -22.328367671440
             les_mean =     502.223776055878
             stat err =       0.001569108025
             autocorr =       1.323931918137
              std dev =       1.928599117747
             le_variance =       3.719494556976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719815537617
                                         uncertainty =       0.025729897294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719815537617
                                         uncertainty =       0.025729897294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363703695
  error estimate for blocks of size 2^( 2) =       0.001434045971
  error estimate for blocks of size 2^( 3) =       0.001498116299
  error estimate for blocks of size 2^( 4) =       0.001541974876
  error estimate for blocks of size 2^( 5) =       0.001568984423
  error estimate for blocks of size 2^( 6) =       0.001579932293
  error estimate for blocks of size 2^( 7) =       0.001585540508

      target function =                  N/A
              le_mean =     -22.328367671440
             les_mean =     502.223776055697
             stat err =       0.001569108025
             autocorr =       1.323931918162
              std dev =       1.928599117742
             le_variance =       3.719494556954


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328367671440        initial  <--
     8.8818e+05     8.8818e+06             4.6399e-10       -22.328367671440
     3.5527e+06     3.5527e+07             1.1600e-10       -22.328367671440
     1.4211e+07     1.4211e+08             2.8999e-11       -22.328367671440

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.6631
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251780e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5905e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2296e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.5986
    reference variance = 2.42377
====================================================
  Execution time = 2.3410e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0306e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8035e+00
  Total weights = 1.949862154e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8593e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.856160549176
                                         uncertainty =       0.084600208721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.856160549176
                                         uncertainty =       0.084600208721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001388579330
  error estimate for blocks of size 2^( 2) =       0.001458643080
  error estimate for blocks of size 2^( 3) =       0.001519812704
  error estimate for blocks of size 2^( 4) =       0.001561534331
  error estimate for blocks of size 2^( 5) =       0.001585609547
  error estimate for blocks of size 2^( 6) =       0.001598691453
  error estimate for blocks of size 2^( 7) =       0.001610797583

      target function =                  N/A
              le_mean =     -22.328202641018
             les_mean =     502.352161824021
             stat err =       0.001589158228
             autocorr =       1.309763517692
              std dev =       1.963779140863
             le_variance =       3.856428514087


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232820264102e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+06, overlap shift 8.8818e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328202640201       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328202640204       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328202640204       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+06 is 5.852580e-11

solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328202640201       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328202640202       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328202640202       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+07 is 1.463144e-11

solving harmonic davidson linear method for identity shift 1.4211e+08, overlap shift 1.4211e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328202640201       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328202640202       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328202640202       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+08 is 3.657862e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.269359 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9276e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251780e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.313
    reference variance = 3.72478
====================================================
  Execution time = 2.2845e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.7264e+00
  Total weights = 1.9499e+06
  Execution time = 4.3016e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777529549972
                                         uncertainty =       0.040353526117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777529549972
                                         uncertainty =       0.040353526117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374425949
  error estimate for blocks of size 2^( 2) =       0.001444881074
  error estimate for blocks of size 2^( 3) =       0.001507781550
  error estimate for blocks of size 2^( 4) =       0.001552344023
  error estimate for blocks of size 2^( 5) =       0.001577020932
  error estimate for blocks of size 2^( 6) =       0.001586368055
  error estimate for blocks of size 2^( 7) =       0.001590946081

      target function =                  N/A
              le_mean =     -22.330930381703
             les_mean =     502.396804091041
             stat err =       0.001576669773
             autocorr =       1.315948190363
              std dev =       1.943762917018
             le_variance =       3.778214277573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777529549966
                                         uncertainty =       0.040353526117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777529549966
                                         uncertainty =       0.040353526117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374425949
  error estimate for blocks of size 2^( 2) =       0.001444881074
  error estimate for blocks of size 2^( 3) =       0.001507781550
  error estimate for blocks of size 2^( 4) =       0.001552344023
  error estimate for blocks of size 2^( 5) =       0.001577020932
  error estimate for blocks of size 2^( 6) =       0.001586368055
  error estimate for blocks of size 2^( 7) =       0.001590946081

      target function =                  N/A
              le_mean =     -22.330930381703
             les_mean =     502.396804091354
             stat err =       0.001576669773
             autocorr =       1.315948190361
              std dev =       1.943762917016
             le_variance =       3.778214277568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777529549969
                                         uncertainty =       0.040353526117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777529549969
                                         uncertainty =       0.040353526117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374425949
  error estimate for blocks of size 2^( 2) =       0.001444881074
  error estimate for blocks of size 2^( 3) =       0.001507781550
  error estimate for blocks of size 2^( 4) =       0.001552344023
  error estimate for blocks of size 2^( 5) =       0.001577020932
  error estimate for blocks of size 2^( 6) =       0.001586368055
  error estimate for blocks of size 2^( 7) =       0.001590946081

      target function =                  N/A
              le_mean =     -22.330930381703
             les_mean =     502.396804091198
             stat err =       0.001576669773
             autocorr =       1.315948190362
              std dev =       1.943762917017
             le_variance =       3.778214277570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777529549971
                                         uncertainty =       0.040353526117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777529549971
                                         uncertainty =       0.040353526117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374425949
  error estimate for blocks of size 2^( 2) =       0.001444881074
  error estimate for blocks of size 2^( 3) =       0.001507781550
  error estimate for blocks of size 2^( 4) =       0.001552344023
  error estimate for blocks of size 2^( 5) =       0.001577020932
  error estimate for blocks of size 2^( 6) =       0.001586368055
  error estimate for blocks of size 2^( 7) =       0.001590946081

      target function =                  N/A
              le_mean =     -22.330930381703
             les_mean =     502.396804091061
             stat err =       0.001576669773
             autocorr =       1.315948190363
              std dev =       1.943762917018
             le_variance =       3.778214277573


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330930381703        initial
     8.8818e+06     8.8818e+07             5.8526e-11       -22.330930381703  <--
     3.5527e+07     3.5527e+08             1.4631e-11       -22.330930381703
     1.4211e+08     1.4211e+09             3.6579e-12       -22.330930381703

*****************************************************************************
Applying the update for shift_i =   8.8818e+06     and shift_s =   8.8818e+07
*****************************************************************************

  Execution time = 4.4496e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2299e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.5284
    reference variance = 2.39562
====================================================
  Execution time = 2.3374e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0318e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7769e+00
  Total weights = 1.950018137e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7972e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.829998169922
                                         uncertainty =       0.034935903210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.829998169922
                                         uncertainty =       0.034935903210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383675051
  error estimate for blocks of size 2^( 2) =       0.001453180034
  error estimate for blocks of size 2^( 3) =       0.001516948701
  error estimate for blocks of size 2^( 4) =       0.001560536012
  error estimate for blocks of size 2^( 5) =       0.001585350377
  error estimate for blocks of size 2^( 6) =       0.001594605232
  error estimate for blocks of size 2^( 7) =       0.001601318878

      target function =                  N/A
              le_mean =     -22.326687193588
             les_mean =     502.257892572582
             stat err =       0.001585452625
             autocorr =       1.312920162478
              std dev =       1.956843332422
             le_variance =       3.829235827646


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232668719359e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+06, overlap shift 2.2204e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326687192733       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326687192744       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326687192744       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+06 is 2.278721e-10

solving harmonic davidson linear method for identity shift 8.8818e+06, overlap shift 8.8818e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326687192733       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326687192735       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326687192735       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+06 is 5.696802e-11

solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326687192733       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326687192733       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326687192733       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+07 is 1.424201e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270553 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9178e+01
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895396e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.5142
    reference variance = 2.63561
====================================================
  Execution time = 2.2844e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.8847e+00
  Total weights = 1.9500e+06
  Execution time = 4.3068e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.940130577094
                                         uncertainty =       0.120546505744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.940130577094
                                         uncertainty =       0.120546505744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001403584741
  error estimate for blocks of size 2^( 2) =       0.001472193770
  error estimate for blocks of size 2^( 3) =       0.001532192711
  error estimate for blocks of size 2^( 4) =       0.001573789259
  error estimate for blocks of size 2^( 5) =       0.001598626933
  error estimate for blocks of size 2^( 6) =       0.001608946321
  error estimate for blocks of size 2^( 7) =       0.001611270740

      target function =                  N/A
              le_mean =     -22.328652397268
             les_mean =     502.453451739973
             stat err =       0.001598158313
             autocorr =       1.296469547523
              std dev =       1.985000335923
             le_variance =       3.940226333613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.940130577102
                                         uncertainty =       0.120546505744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.940130577102
                                         uncertainty =       0.120546505744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001403584741
  error estimate for blocks of size 2^( 2) =       0.001472193770
  error estimate for blocks of size 2^( 3) =       0.001532192711
  error estimate for blocks of size 2^( 4) =       0.001573789259
  error estimate for blocks of size 2^( 5) =       0.001598626933
  error estimate for blocks of size 2^( 6) =       0.001608946321
  error estimate for blocks of size 2^( 7) =       0.001611270740

      target function =                  N/A
              le_mean =     -22.328652397267
             les_mean =     502.453451738920
             stat err =       0.001598158313
             autocorr =       1.296469547507
              std dev =       1.985000335925
             le_variance =       3.940226333621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.940130577098
                                         uncertainty =       0.120546505744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.940130577098
                                         uncertainty =       0.120546505744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001403584741
  error estimate for blocks of size 2^( 2) =       0.001472193770
  error estimate for blocks of size 2^( 3) =       0.001532192711
  error estimate for blocks of size 2^( 4) =       0.001573789259
  error estimate for blocks of size 2^( 5) =       0.001598626933
  error estimate for blocks of size 2^( 6) =       0.001608946321
  error estimate for blocks of size 2^( 7) =       0.001611270740

      target function =                  N/A
              le_mean =     -22.328652397267
             les_mean =     502.453451739447
             stat err =       0.001598158313
             autocorr =       1.296469547515
              std dev =       1.985000335924
             le_variance =       3.940226333617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.940130577094
                                         uncertainty =       0.120546505744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.940130577094
                                         uncertainty =       0.120546505744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001403584741
  error estimate for blocks of size 2^( 2) =       0.001472193770
  error estimate for blocks of size 2^( 3) =       0.001532192711
  error estimate for blocks of size 2^( 4) =       0.001573789259
  error estimate for blocks of size 2^( 5) =       0.001598626933
  error estimate for blocks of size 2^( 6) =       0.001608946321
  error estimate for blocks of size 2^( 7) =       0.001611270740

      target function =                  N/A
              le_mean =     -22.328652397267
             les_mean =     502.453451739908
             stat err =       0.001598158313
             autocorr =       1.296469547522
              std dev =       1.985000335923
             le_variance =       3.940226333614


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328652397268        initial  <--
     2.2204e+06     2.2204e+07             2.2787e-10       -22.328652397267
     8.8818e+06     8.8818e+07             5.6968e-11       -22.328652397267
     3.5527e+07     3.5527e+08             1.4242e-11       -22.328652397267

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5360
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3722e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2303e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.1676
    reference variance = 3.46941
====================================================
  Execution time = 2.3404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0271e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7529e+00
  Total weights = 1.949740385e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8297e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.803565445447
                                         uncertainty =       0.046224477925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.803565445447
                                         uncertainty =       0.046224477925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379119944
  error estimate for blocks of size 2^( 2) =       0.001451196447
  error estimate for blocks of size 2^( 3) =       0.001513650029
  error estimate for blocks of size 2^( 4) =       0.001555363548
  error estimate for blocks of size 2^( 5) =       0.001582441421
  error estimate for blocks of size 2^( 6) =       0.001593661612
  error estimate for blocks of size 2^( 7) =       0.001597073696

      target function =                  N/A
              le_mean =     -22.329592046760
             les_mean =     502.363552072918
             stat err =       0.001582135069
             autocorr =       1.316082262521
              std dev =       1.950401335113
             le_variance =       3.804065368010


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232959204676e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+07, overlap shift 2.2204e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329592045931       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329592045932       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329592045932       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+07 is 1.699608e-11

solving harmonic davidson linear method for identity shift 8.8818e+07, overlap shift 8.8818e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329592045931       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329592045932       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329592045932       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+07 is 4.249020e-12

solving harmonic davidson linear method for identity shift 3.5527e+08, overlap shift 3.5527e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329592045931       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329592045932       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329592045932       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+08 is 1.062255e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9240e+01
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.3601
    reference variance = 2.40272
====================================================
  Execution time = 2.2901e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7720e+00
  Total weights = 1.9496e+06
  Execution time = 4.3065e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813555072943
                                         uncertainty =       0.080470088700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813555072943
                                         uncertainty =       0.080470088700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380818637
  error estimate for blocks of size 2^( 2) =       0.001451006466
  error estimate for blocks of size 2^( 3) =       0.001514236595
  error estimate for blocks of size 2^( 4) =       0.001558499114
  error estimate for blocks of size 2^( 5) =       0.001582868969
  error estimate for blocks of size 2^( 6) =       0.001596523638
  error estimate for blocks of size 2^( 7) =       0.001600904857

      target function =                  N/A
              le_mean =     -22.328878818243
             les_mean =     502.350841469127
             stat err =       0.001584699145
             autocorr =       1.317104903988
              std dev =       1.952803687689
             le_variance =       3.813442242654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813555072943
                                         uncertainty =       0.080470088700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813555072943
                                         uncertainty =       0.080470088700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380818637
  error estimate for blocks of size 2^( 2) =       0.001451006466
  error estimate for blocks of size 2^( 3) =       0.001514236595
  error estimate for blocks of size 2^( 4) =       0.001558499114
  error estimate for blocks of size 2^( 5) =       0.001582868969
  error estimate for blocks of size 2^( 6) =       0.001596523638
  error estimate for blocks of size 2^( 7) =       0.001600904857

      target function =                  N/A
              le_mean =     -22.328878818243
             les_mean =     502.350841469693
             stat err =       0.001584699145
             autocorr =       1.317104903988
              std dev =       1.952803687689
             le_variance =       3.813442242653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813555072943
                                         uncertainty =       0.080470088700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813555072943
                                         uncertainty =       0.080470088700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380818637
  error estimate for blocks of size 2^( 2) =       0.001451006466
  error estimate for blocks of size 2^( 3) =       0.001514236595
  error estimate for blocks of size 2^( 4) =       0.001558499114
  error estimate for blocks of size 2^( 5) =       0.001582868969
  error estimate for blocks of size 2^( 6) =       0.001596523638
  error estimate for blocks of size 2^( 7) =       0.001600904857

      target function =                  N/A
              le_mean =     -22.328878818243
             les_mean =     502.350841469410
             stat err =       0.001584699145
             autocorr =       1.317104903987
              std dev =       1.952803687689
             le_variance =       3.813442242653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813555072943
                                         uncertainty =       0.080470088700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813555072943
                                         uncertainty =       0.080470088700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380818637
  error estimate for blocks of size 2^( 2) =       0.001451006466
  error estimate for blocks of size 2^( 3) =       0.001514236595
  error estimate for blocks of size 2^( 4) =       0.001558499114
  error estimate for blocks of size 2^( 5) =       0.001582868969
  error estimate for blocks of size 2^( 6) =       0.001596523638
  error estimate for blocks of size 2^( 7) =       0.001600904857

      target function =                  N/A
              le_mean =     -22.328878818243
             les_mean =     502.350841469163
             stat err =       0.001584699145
             autocorr =       1.317104903988
              std dev =       1.952803687689
             le_variance =       3.813442242654


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328878818243        initial  <--
     2.2204e+07     2.2204e+08             1.6996e-11       -22.328878818243
     8.8818e+07     8.8818e+08             4.2490e-12       -22.328878818243
     3.5527e+08     3.5527e+09             1.0623e-12       -22.328878818243

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5319
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2302e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.5534
    reference variance = 2.59149
====================================================
  Execution time = 2.3398e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0306e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7554e+00
  Total weights = 1.950081674e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7905e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.808669960222
                                         uncertainty =       0.052977362488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.808669960222
                                         uncertainty =       0.052977362488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379847624
  error estimate for blocks of size 2^( 2) =       0.001451684920
  error estimate for blocks of size 2^( 3) =       0.001515246749
  error estimate for blocks of size 2^( 4) =       0.001559849968
  error estimate for blocks of size 2^( 5) =       0.001583649656
  error estimate for blocks of size 2^( 6) =       0.001597654947
  error estimate for blocks of size 2^( 7) =       0.001604988980

      target function =                  N/A
              le_mean =     -22.326229749754
             les_mean =     502.215923800800
             stat err =       0.001586535888
             autocorr =       1.322018523602
              std dev =       1.951430446473
             le_variance =       3.808080787421


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232622974975e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+08, overlap shift 2.2204e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326229748956       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326229748956       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326229748956       residual = 2.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+08 is 2.044804e-12

solving harmonic davidson linear method for identity shift 8.8818e+08, overlap shift 8.8818e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326229748956       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326229748956       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326229748956       residual = 2.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+08 is 5.112002e-13

solving harmonic davidson linear method for identity shift 3.5527e+09, overlap shift 3.5527e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326229748956       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326229748956       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326229748956       residual = 2.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+09 is 1.277899e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.272961 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9195e+01
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.3876
    reference variance = 2.84072
====================================================
  Execution time = 2.5202e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7265e+00
  Total weights = 1.9501e+06
  Execution time = 4.3718e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778056836059
                                         uncertainty =       0.043438310438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778056836059
                                         uncertainty =       0.043438310438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374428308
  error estimate for blocks of size 2^( 2) =       0.001445470042
  error estimate for blocks of size 2^( 3) =       0.001510037982
  error estimate for blocks of size 2^( 4) =       0.001551959397
  error estimate for blocks of size 2^( 5) =       0.001574956442
  error estimate for blocks of size 2^( 6) =       0.001588252272
  error estimate for blocks of size 2^( 7) =       0.001599358327

      target function =                  N/A
              le_mean =     -22.330102183282
             les_mean =     502.359986287783
             stat err =       0.001578631609
             autocorr =       1.319220544969
              std dev =       1.943766253470
             le_variance =       3.778227248131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778056836059
                                         uncertainty =       0.043438310438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778056836059
                                         uncertainty =       0.043438310438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374428308
  error estimate for blocks of size 2^( 2) =       0.001445470042
  error estimate for blocks of size 2^( 3) =       0.001510037982
  error estimate for blocks of size 2^( 4) =       0.001551959397
  error estimate for blocks of size 2^( 5) =       0.001574956442
  error estimate for blocks of size 2^( 6) =       0.001588252272
  error estimate for blocks of size 2^( 7) =       0.001599358327

      target function =                  N/A
              le_mean =     -22.330102183282
             les_mean =     502.359986287782
             stat err =       0.001578631609
             autocorr =       1.319220544970
              std dev =       1.943766253470
             le_variance =       3.778227248131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778056836059
                                         uncertainty =       0.043438310438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778056836059
                                         uncertainty =       0.043438310438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374428308
  error estimate for blocks of size 2^( 2) =       0.001445470042
  error estimate for blocks of size 2^( 3) =       0.001510037982
  error estimate for blocks of size 2^( 4) =       0.001551959397
  error estimate for blocks of size 2^( 5) =       0.001574956442
  error estimate for blocks of size 2^( 6) =       0.001588252272
  error estimate for blocks of size 2^( 7) =       0.001599358327

      target function =                  N/A
              le_mean =     -22.330102183282
             les_mean =     502.359986287782
             stat err =       0.001578631609
             autocorr =       1.319220544968
              std dev =       1.943766253470
             le_variance =       3.778227248131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778056836059
                                         uncertainty =       0.043438310438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778056836059
                                         uncertainty =       0.043438310438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374428308
  error estimate for blocks of size 2^( 2) =       0.001445470042
  error estimate for blocks of size 2^( 3) =       0.001510037982
  error estimate for blocks of size 2^( 4) =       0.001551959397
  error estimate for blocks of size 2^( 5) =       0.001574956442
  error estimate for blocks of size 2^( 6) =       0.001588252272
  error estimate for blocks of size 2^( 7) =       0.001599358327

      target function =                  N/A
              le_mean =     -22.330102183282
             les_mean =     502.359986287783
             stat err =       0.001578631609
             autocorr =       1.319220544969
              std dev =       1.943766253470
             le_variance =       3.778227248131


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330102183282        initial  <--
     2.2204e+08     2.2204e+09             2.0448e-12       -22.330102183282
     8.8818e+08     8.8818e+09             5.1120e-13       -22.330102183282
     3.5527e+09     3.5527e+10             1.2779e-13       -22.330102183282

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.1552
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2305e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.5179
    reference variance = 2.57458
====================================================
  Execution time = 2.3482e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0315e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7472e+00
  Total weights = 1.949624363e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8192e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.799700968973
                                         uncertainty =       0.034811340595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.799700968973
                                         uncertainty =       0.034811340595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378163116
  error estimate for blocks of size 2^( 2) =       0.001448952082
  error estimate for blocks of size 2^( 3) =       0.001512389872
  error estimate for blocks of size 2^( 4) =       0.001555588698
  error estimate for blocks of size 2^( 5) =       0.001581156642
  error estimate for blocks of size 2^( 6) =       0.001596553706
  error estimate for blocks of size 2^( 7) =       0.001611807826

      target function =                  N/A
              le_mean =     -22.328318530825
             les_mean =     502.301014558946
             stat err =       0.001586276718
             autocorr =       1.324819326584
              std dev =       1.949048153494
             le_variance =       3.798788704637


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232831853083e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+09, overlap shift 2.2204e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328318529991       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328318529991       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328318529991       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+09 is 1.851746e-13

solving harmonic davidson linear method for identity shift 8.8818e+09, overlap shift 8.8818e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328318529991       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328318529991       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328318529991       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+09 is 4.630087e-14

solving harmonic davidson linear method for identity shift 3.5527e+10, overlap shift 3.5527e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328318529991       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328318529991       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328318529991       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+10 is 1.154976e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.274157 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9308e+01
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.468
    reference variance = 2.76886
====================================================
  Execution time = 2.2832e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7724e+00
  Total weights = 1.9498e+06
  Execution time = 4.3246e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826667350603
                                         uncertainty =       0.041116451587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826667350603
                                         uncertainty =       0.041116451587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383030960
  error estimate for blocks of size 2^( 2) =       0.001454260623
  error estimate for blocks of size 2^( 3) =       0.001516830119
  error estimate for blocks of size 2^( 4) =       0.001557971476
  error estimate for blocks of size 2^( 5) =       0.001583998300
  error estimate for blocks of size 2^( 6) =       0.001599895106
  error estimate for blocks of size 2^( 7) =       0.001604082371

      target function =                  N/A
              le_mean =     -22.327719557560
             les_mean =     502.299436950825
             stat err =       0.001586486813
             autocorr =       1.315858313600
              std dev =       1.955932435559
             le_variance =       3.825671692471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826667350603
                                         uncertainty =       0.041116451587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826667350603
                                         uncertainty =       0.041116451587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383030960
  error estimate for blocks of size 2^( 2) =       0.001454260623
  error estimate for blocks of size 2^( 3) =       0.001516830119
  error estimate for blocks of size 2^( 4) =       0.001557971476
  error estimate for blocks of size 2^( 5) =       0.001583998300
  error estimate for blocks of size 2^( 6) =       0.001599895106
  error estimate for blocks of size 2^( 7) =       0.001604082371

      target function =                  N/A
              le_mean =     -22.327719557560
             les_mean =     502.299436950825
             stat err =       0.001586486813
             autocorr =       1.315858313601
              std dev =       1.955932435559
             le_variance =       3.825671692471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826667350603
                                         uncertainty =       0.041116451587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826667350603
                                         uncertainty =       0.041116451587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383030960
  error estimate for blocks of size 2^( 2) =       0.001454260623
  error estimate for blocks of size 2^( 3) =       0.001516830119
  error estimate for blocks of size 2^( 4) =       0.001557971476
  error estimate for blocks of size 2^( 5) =       0.001583998300
  error estimate for blocks of size 2^( 6) =       0.001599895106
  error estimate for blocks of size 2^( 7) =       0.001604082371

      target function =                  N/A
              le_mean =     -22.327719557560
             les_mean =     502.299436950825
             stat err =       0.001586486813
             autocorr =       1.315858313600
              std dev =       1.955932435559
             le_variance =       3.825671692470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826667350603
                                         uncertainty =       0.041116451587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826667350603
                                         uncertainty =       0.041116451587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383030960
  error estimate for blocks of size 2^( 2) =       0.001454260623
  error estimate for blocks of size 2^( 3) =       0.001516830119
  error estimate for blocks of size 2^( 4) =       0.001557971476
  error estimate for blocks of size 2^( 5) =       0.001583998300
  error estimate for blocks of size 2^( 6) =       0.001599895106
  error estimate for blocks of size 2^( 7) =       0.001604082371

      target function =                  N/A
              le_mean =     -22.327719557560
             les_mean =     502.299436950825
             stat err =       0.001586486813
             autocorr =       1.315858313601
              std dev =       1.955932435559
             le_variance =       3.825671692470


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327719557560        initial  <--
     2.2204e+09     2.2204e+10             1.8517e-13       -22.327719557560
     8.8818e+09     8.8818e+10             4.6301e-14       -22.327719557560
     3.5527e+10     3.5527e+11             1.1550e-14       -22.327719557560

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6101
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3927e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2308e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.6455
    reference variance = 2.25238
====================================================
  Execution time = 2.3400e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0344e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7323e+00
  Total weights = 1.949902922e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8707e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783819396732
                                         uncertainty =       0.029468926904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783819396732
                                         uncertainty =       0.029468926904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375541335
  error estimate for blocks of size 2^( 2) =       0.001447912885
  error estimate for blocks of size 2^( 3) =       0.001511917065
  error estimate for blocks of size 2^( 4) =       0.001556422134
  error estimate for blocks of size 2^( 5) =       0.001576369296
  error estimate for blocks of size 2^( 6) =       0.001592190711
  error estimate for blocks of size 2^( 7) =       0.001597106268

      target function =                  N/A
              le_mean =     -22.325800872073
             les_mean =     502.173680941082
             stat err =       0.001580522102
             autocorr =       1.320242946811
              std dev =       1.945340336326
             le_variance =       3.784349024138


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232580087207e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+10, overlap shift 2.2204e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325800871293       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325800871293       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325800871293       residual = 1.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+10 is 1.657615e-14

solving harmonic davidson linear method for identity shift 8.8818e+10, overlap shift 8.8818e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325800871293       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325800871293       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325800871293       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325826562270       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+10 is 4.129424e-15

solving harmonic davidson linear method for identity shift 3.5527e+11, overlap shift 3.5527e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325800871293       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325800871293       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325800871293       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325800871293       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.325651207626       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328542718782       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.341138242436       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.328081020135       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.439330911324       residual = 1.99e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.359699687610       residual = 6.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.269544510037       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.294459873908       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.343720808058       residual = 6.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.244136769058       residual = 1.21e-01           smallest_sin_value = 9.98e-01
davidson iteration   14 stopping due to small subspace S singular value of 9.36e-01
davidson solver did not converge after         14 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+11 is 1.040635e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.287621 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9289e+01
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.1316
    reference variance = 4.64633
====================================================
  Execution time = 2.2837e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7122e+00
  Total weights = 1.9500e+06
  Execution time = 4.3552e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764319499282
                                         uncertainty =       0.044296384917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764319499282
                                         uncertainty =       0.044296384917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371798868
  error estimate for blocks of size 2^( 2) =       0.001443366794
  error estimate for blocks of size 2^( 3) =       0.001506262039
  error estimate for blocks of size 2^( 4) =       0.001549351894
  error estimate for blocks of size 2^( 5) =       0.001577841728
  error estimate for blocks of size 2^( 6) =       0.001595275421
  error estimate for blocks of size 2^( 7) =       0.001601460008

      target function =                  N/A
              le_mean =     -22.328731840049
             les_mean =     502.284464839014
             stat err =       0.001580982263
             autocorr =       1.328229478880
              std dev =       1.940047603918
             le_variance =       3.763784705469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764319499282
                                         uncertainty =       0.044296384917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764319499282
                                         uncertainty =       0.044296384917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371798868
  error estimate for blocks of size 2^( 2) =       0.001443366794
  error estimate for blocks of size 2^( 3) =       0.001506262039
  error estimate for blocks of size 2^( 4) =       0.001549351894
  error estimate for blocks of size 2^( 5) =       0.001577841728
  error estimate for blocks of size 2^( 6) =       0.001595275421
  error estimate for blocks of size 2^( 7) =       0.001601460008

      target function =                  N/A
              le_mean =     -22.328731840049
             les_mean =     502.284464839015
             stat err =       0.001580982263
             autocorr =       1.328229478879
              std dev =       1.940047603918
             le_variance =       3.763784705469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764319499282
                                         uncertainty =       0.044296384917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764319499282
                                         uncertainty =       0.044296384917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371798868
  error estimate for blocks of size 2^( 2) =       0.001443366794
  error estimate for blocks of size 2^( 3) =       0.001506262039
  error estimate for blocks of size 2^( 4) =       0.001549351894
  error estimate for blocks of size 2^( 5) =       0.001577841728
  error estimate for blocks of size 2^( 6) =       0.001595275421
  error estimate for blocks of size 2^( 7) =       0.001601460008

      target function =                  N/A
              le_mean =     -22.328731840049
             les_mean =     502.284464839014
             stat err =       0.001580982263
             autocorr =       1.328229478879
              std dev =       1.940047603918
             le_variance =       3.763784705469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764319499282
                                         uncertainty =       0.044296384917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764319499282
                                         uncertainty =       0.044296384917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371798868
  error estimate for blocks of size 2^( 2) =       0.001443366794
  error estimate for blocks of size 2^( 3) =       0.001506262039
  error estimate for blocks of size 2^( 4) =       0.001549351894
  error estimate for blocks of size 2^( 5) =       0.001577841728
  error estimate for blocks of size 2^( 6) =       0.001595275421
  error estimate for blocks of size 2^( 7) =       0.001601460008

      target function =                  N/A
              le_mean =     -22.328731840049
             les_mean =     502.284464839014
             stat err =       0.001580982263
             autocorr =       1.328229478879
              std dev =       1.940047603918
             le_variance =       3.763784705469


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328731840049        initial
     2.2204e+10     2.2204e+11             1.6576e-14       -22.328731840049  <--
     8.8818e+10     8.8818e+11             4.1294e-15       -22.328731840049
     3.5527e+11     3.5527e+12             1.0406e-15       -22.328731840049

*****************************************************************************
Applying the update for shift_i =   2.2204e+10     and shift_s =   2.2204e+11
*****************************************************************************

  Execution time = 4.4685e+01
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3983e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2309e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.7427
    reference variance = 1.57135
====================================================
  Execution time = 2.3371e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0316e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7749e+00
  Total weights = 1.950196364e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8524e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830023093845
                                         uncertainty =       0.076329796343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830023093845
                                         uncertainty =       0.076329796343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383588367
  error estimate for blocks of size 2^( 2) =       0.001452666789
  error estimate for blocks of size 2^( 3) =       0.001513874058
  error estimate for blocks of size 2^( 4) =       0.001557972200
  error estimate for blocks of size 2^( 5) =       0.001581529369
  error estimate for blocks of size 2^( 6) =       0.001591826365
  error estimate for blocks of size 2^( 7) =       0.001603070124

      target function =                  N/A
              le_mean =     -22.328126980748
             les_mean =     502.320131663267
             stat err =       0.001583599514
             autocorr =       1.310016953884
              std dev =       1.956720739519
             le_variance =       3.828756052462


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232812698075e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+09, overlap shift 5.5511e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328126979919       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328126979919       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328126979919       residual = 2.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+09 is 8.182854e-14

solving harmonic davidson linear method for identity shift 2.2204e+10, overlap shift 2.2204e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328126979919       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328126979919       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328126979919       residual = 2.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+10 is 2.045713e-14

solving harmonic davidson linear method for identity shift 8.8818e+10, overlap shift 8.8818e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328126979919       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328126979919       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328126979919       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+10 is 5.125142e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288843 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9230e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.211
    reference variance = 3.22044
====================================================
  Execution time = 2.2854e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.9136e+00
  Total weights = 1.9499e+06
  Execution time = 4.3622e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.969349499681
                                         uncertainty =       0.183214321684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.969349499681
                                         uncertainty =       0.183214321684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001408826010
  error estimate for blocks of size 2^( 2) =       0.001478345998
  error estimate for blocks of size 2^( 3) =       0.001540474917
  error estimate for blocks of size 2^( 4) =       0.001584162629
  error estimate for blocks of size 2^( 5) =       0.001608059264
  error estimate for blocks of size 2^( 6) =       0.001622671178
  error estimate for blocks of size 2^( 7) =       0.001627686708

      target function =                  N/A
              le_mean =     -22.326743146025
             les_mean =     502.397068447464
             stat err =       0.001610644945
             autocorr =       1.307028042534
              std dev =       1.992412728302
             le_variance =       3.969708479899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.969349499681
                                         uncertainty =       0.183214321684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.969349499681
                                         uncertainty =       0.183214321684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001408826010
  error estimate for blocks of size 2^( 2) =       0.001478345998
  error estimate for blocks of size 2^( 3) =       0.001540474917
  error estimate for blocks of size 2^( 4) =       0.001584162629
  error estimate for blocks of size 2^( 5) =       0.001608059264
  error estimate for blocks of size 2^( 6) =       0.001622671178
  error estimate for blocks of size 2^( 7) =       0.001627686708

      target function =                  N/A
              le_mean =     -22.326743146025
             les_mean =     502.397068447463
             stat err =       0.001610644945
             autocorr =       1.307028042534
              std dev =       1.992412728302
             le_variance =       3.969708479899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.969349499681
                                         uncertainty =       0.183214321684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.969349499681
                                         uncertainty =       0.183214321684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001408826010
  error estimate for blocks of size 2^( 2) =       0.001478345998
  error estimate for blocks of size 2^( 3) =       0.001540474917
  error estimate for blocks of size 2^( 4) =       0.001584162629
  error estimate for blocks of size 2^( 5) =       0.001608059264
  error estimate for blocks of size 2^( 6) =       0.001622671178
  error estimate for blocks of size 2^( 7) =       0.001627686708

      target function =                  N/A
              le_mean =     -22.326743146025
             les_mean =     502.397068447463
             stat err =       0.001610644945
             autocorr =       1.307028042534
              std dev =       1.992412728302
             le_variance =       3.969708479899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.969349499681
                                         uncertainty =       0.183214321684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.969349499681
                                         uncertainty =       0.183214321684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001408826010
  error estimate for blocks of size 2^( 2) =       0.001478345998
  error estimate for blocks of size 2^( 3) =       0.001540474917
  error estimate for blocks of size 2^( 4) =       0.001584162629
  error estimate for blocks of size 2^( 5) =       0.001608059264
  error estimate for blocks of size 2^( 6) =       0.001622671178
  error estimate for blocks of size 2^( 7) =       0.001627686708

      target function =                  N/A
              le_mean =     -22.326743146025
             les_mean =     502.397068447464
             stat err =       0.001610644945
             autocorr =       1.307028042534
              std dev =       1.992412728302
             le_variance =       3.969708479899


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326743146025        initial  <--
     5.5511e+09     5.5511e+10             8.1829e-14       -22.326743146025
     2.2204e+10     2.2204e+11             2.0457e-14       -22.326743146025
     8.8818e+10     8.8818e+11             5.1251e-15       -22.326743146025

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7582
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3996e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2312e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.567
    reference variance = 2.13301
====================================================
  Execution time = 2.3404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0313e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.6762e+00
  Total weights = 1.949946923e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8337e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722305748287
                                         uncertainty =       0.029321641432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722305748287
                                         uncertainty =       0.029321641432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364431775
  error estimate for blocks of size 2^( 2) =       0.001436771293
  error estimate for blocks of size 2^( 3) =       0.001501007195
  error estimate for blocks of size 2^( 4) =       0.001545114074
  error estimate for blocks of size 2^( 5) =       0.001565130269
  error estimate for blocks of size 2^( 6) =       0.001575713210
  error estimate for blocks of size 2^( 7) =       0.001582825144

      target function =                  N/A
              le_mean =     -22.326904280887
             les_mean =     502.166851510661
             stat err =       0.001567195674
             autocorr =       1.319297679770
              std dev =       1.929628794957
             le_variance =       3.723467286325


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232690428089e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+10, overlap shift 5.5511e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326904280073       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326904280073       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326904280073       residual = 2.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+10 is 8.512933e-15

solving harmonic davidson linear method for identity shift 2.2204e+11, overlap shift 2.2204e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326904280073       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326904280073       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326904280073       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+11 is 2.118667e-15

solving harmonic davidson linear method for identity shift 8.8818e+11, overlap shift 8.8818e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326904280073       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326904280073       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326904280073       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326377791529       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328326328039       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.300670586605       residual = 9.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.622144209408       residual = 5.86e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.320295674239       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.335511639680       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.320457358721       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.329924533953       residual = 2.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.194523822218       residual = 2.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.381353563568       residual = 3.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -21.986671505321       residual = 7.93e-01           smallest_sin_value = 9.91e-01
davidson iteration   14 stopping due to small subspace S singular value of 7.64e-01
davidson solver did not converge after         14 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+11 is 5.403917e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.292621 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9247e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.3799
    reference variance = 3.82109
====================================================
  Execution time = 2.4629e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7072e+00
  Total weights = 1.9500e+06
  Execution time = 4.5096e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758582356522
                                         uncertainty =       0.029067353143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758582356522
                                         uncertainty =       0.029067353143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370865578
  error estimate for blocks of size 2^( 2) =       0.001442311507
  error estimate for blocks of size 2^( 3) =       0.001503304598
  error estimate for blocks of size 2^( 4) =       0.001546644545
  error estimate for blocks of size 2^( 5) =       0.001573154538
  error estimate for blocks of size 2^( 6) =       0.001591714538
  error estimate for blocks of size 2^( 7) =       0.001606237552

      target function =                  N/A
              le_mean =     -22.328381100540
             les_mean =     502.263779611118
             stat err =       0.001579437793
             autocorr =       1.327441247934
              std dev =       1.938727711250
             le_variance =       3.758665138367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758582356522
                                         uncertainty =       0.029067353143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758582356522
                                         uncertainty =       0.029067353143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370865578
  error estimate for blocks of size 2^( 2) =       0.001442311507
  error estimate for blocks of size 2^( 3) =       0.001503304598
  error estimate for blocks of size 2^( 4) =       0.001546644545
  error estimate for blocks of size 2^( 5) =       0.001573154538
  error estimate for blocks of size 2^( 6) =       0.001591714538
  error estimate for blocks of size 2^( 7) =       0.001606237552

      target function =                  N/A
              le_mean =     -22.328381100540
             les_mean =     502.263779611118
             stat err =       0.001579437793
             autocorr =       1.327441247934
              std dev =       1.938727711250
             le_variance =       3.758665138367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758582356522
                                         uncertainty =       0.029067353143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758582356522
                                         uncertainty =       0.029067353143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370865578
  error estimate for blocks of size 2^( 2) =       0.001442311507
  error estimate for blocks of size 2^( 3) =       0.001503304598
  error estimate for blocks of size 2^( 4) =       0.001546644545
  error estimate for blocks of size 2^( 5) =       0.001573154538
  error estimate for blocks of size 2^( 6) =       0.001591714538
  error estimate for blocks of size 2^( 7) =       0.001606237552

      target function =                  N/A
              le_mean =     -22.328381100540
             les_mean =     502.263779611118
             stat err =       0.001579437793
             autocorr =       1.327441247934
              std dev =       1.938727711250
             le_variance =       3.758665138367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758582356522
                                         uncertainty =       0.029067353143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758582356522
                                         uncertainty =       0.029067353143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370865578
  error estimate for blocks of size 2^( 2) =       0.001442311507
  error estimate for blocks of size 2^( 3) =       0.001503304598
  error estimate for blocks of size 2^( 4) =       0.001546644545
  error estimate for blocks of size 2^( 5) =       0.001573154538
  error estimate for blocks of size 2^( 6) =       0.001591714538
  error estimate for blocks of size 2^( 7) =       0.001606237552

      target function =                  N/A
              le_mean =     -22.328381100540
             les_mean =     502.263779611118
             stat err =       0.001579437793
             autocorr =       1.327441247933
              std dev =       1.938727711250
             le_variance =       3.758665138367


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328381100540        initial  <--
     5.5511e+10     5.5511e+11             8.5129e-15       -22.328381100540
     2.2204e+11     2.2204e+12             2.1187e-15       -22.328381100540
     8.8818e+11     8.8818e+12             5.4039e-16       -22.328381100540

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.6080
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5863e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2314e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.396
    reference variance = 2.37273
====================================================
  Execution time = 2.3450e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0322e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7104e+00
  Total weights = 1.950028639e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9475e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764016116854
                                         uncertainty =       0.031301031117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764016116854
                                         uncertainty =       0.031301031117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371651817
  error estimate for blocks of size 2^( 2) =       0.001442328080
  error estimate for blocks of size 2^( 3) =       0.001505776084
  error estimate for blocks of size 2^( 4) =       0.001548583739
  error estimate for blocks of size 2^( 5) =       0.001569863177
  error estimate for blocks of size 2^( 6) =       0.001585624004
  error estimate for blocks of size 2^( 7) =       0.001595218643

      target function =                  N/A
              le_mean =     -22.329640256026
             les_mean =     502.323262362471
             stat err =       0.001574822391
             autocorr =       1.318182055885
              std dev =       1.939839639487
             le_variance =       3.762977826924


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232964025603e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+11, overlap shift 5.5511e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329640255233       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329640255233       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329640255233       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+11 is 8.690019e-16

solving harmonic davidson linear method for identity shift 2.2204e+12, overlap shift 2.2204e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329640255233       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329640255233       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329640255233       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+12 is 2.172505e-16

solving harmonic davidson linear method for identity shift 8.8818e+12, overlap shift 8.8818e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329640255233       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329640255233       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.12e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.293825 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9404e+01
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.2866
    reference variance = 3.54133
====================================================
  Execution time = 2.2885e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6945e+00
  Total weights = 1.9496e+06
  Execution time = 4.3709e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747471272173
                                         uncertainty =       0.023807757548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747471272173
                                         uncertainty =       0.023807757548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368654616
  error estimate for blocks of size 2^( 2) =       0.001438852267
  error estimate for blocks of size 2^( 3) =       0.001501756235
  error estimate for blocks of size 2^( 4) =       0.001547238491
  error estimate for blocks of size 2^( 5) =       0.001573634589
  error estimate for blocks of size 2^( 6) =       0.001585641955
  error estimate for blocks of size 2^( 7) =       0.001591975862

      target function =                  N/A
              le_mean =     -22.329065055604
             les_mean =     502.281678402978
             stat err =       0.001574622724
             autocorr =       1.323626021361
              std dev =       1.935600888951
             le_variance =       3.746550801308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747471272173
                                         uncertainty =       0.023807757548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747471272173
                                         uncertainty =       0.023807757548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368654616
  error estimate for blocks of size 2^( 2) =       0.001438852267
  error estimate for blocks of size 2^( 3) =       0.001501756235
  error estimate for blocks of size 2^( 4) =       0.001547238491
  error estimate for blocks of size 2^( 5) =       0.001573634589
  error estimate for blocks of size 2^( 6) =       0.001585641955
  error estimate for blocks of size 2^( 7) =       0.001591975862

      target function =                  N/A
              le_mean =     -22.329065055604
             les_mean =     502.281678402978
             stat err =       0.001574622724
             autocorr =       1.323626021361
              std dev =       1.935600888951
             le_variance =       3.746550801308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747471272173
                                         uncertainty =       0.023807757548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747471272173
                                         uncertainty =       0.023807757548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368654616
  error estimate for blocks of size 2^( 2) =       0.001438852267
  error estimate for blocks of size 2^( 3) =       0.001501756235
  error estimate for blocks of size 2^( 4) =       0.001547238491
  error estimate for blocks of size 2^( 5) =       0.001573634589
  error estimate for blocks of size 2^( 6) =       0.001585641955
  error estimate for blocks of size 2^( 7) =       0.001591975862

      target function =                  N/A
              le_mean =     -22.329065055604
             les_mean =     502.281678402978
             stat err =       0.001574622724
             autocorr =       1.323626021361
              std dev =       1.935600888951
             le_variance =       3.746550801308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747471272173
                                         uncertainty =       0.023807757548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747471272173
                                         uncertainty =       0.023807757548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368654616
  error estimate for blocks of size 2^( 2) =       0.001438852267
  error estimate for blocks of size 2^( 3) =       0.001501756235
  error estimate for blocks of size 2^( 4) =       0.001547238491
  error estimate for blocks of size 2^( 5) =       0.001573634589
  error estimate for blocks of size 2^( 6) =       0.001585641955
  error estimate for blocks of size 2^( 7) =       0.001591975862

      target function =                  N/A
              le_mean =     -22.329065055604
             les_mean =     502.281678402978
             stat err =       0.001574622724
             autocorr =       1.323626021361
              std dev =       1.935600888951
             le_variance =       3.746550801308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329065055604        initial  <--
     5.5511e+11     5.5511e+12             8.6900e-16       -22.329065055604
     2.2204e+12     2.2204e+13             2.1725e-16       -22.329065055604
     8.8818e+12     8.8818e+13             0.0000e+00       -22.329065055604

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8218
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4234e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2314e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.614
    reference variance = 2.30953
====================================================
  Execution time = 2.3466e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0295e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7453e+00
  Total weights = 1.950055904e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9536e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796806368846
                                         uncertainty =       0.052598378444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796806368846
                                         uncertainty =       0.052598378444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378019231
  error estimate for blocks of size 2^( 2) =       0.001447705572
  error estimate for blocks of size 2^( 3) =       0.001508907403
  error estimate for blocks of size 2^( 4) =       0.001551673736
  error estimate for blocks of size 2^( 5) =       0.001572663792
  error estimate for blocks of size 2^( 6) =       0.001577446253
  error estimate for blocks of size 2^( 7) =       0.001583296747

      target function =                  N/A
              le_mean =     -22.329997167647
             les_mean =     502.374059489606
             stat err =       0.001571270132
             autocorr =       1.300143094254
              std dev =       1.948844665925
             le_variance =       3.797995531904


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232999716765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+12, overlap shift 5.5511e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329997166840       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329997166840       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329997166840       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329997166840       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329833114256       residual = 9.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.323005614029       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.340066545424       residual = 8.64e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.294615922490       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.282546644617       residual = 6.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.352848932339       residual = 8.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.290450099810       residual = 4.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.285790087567       residual = 7.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.185254508864       residual = 1.18e+01           smallest_sin_value = 9.95e-01
davidson iteration   13 stopping due to small subspace S singular value of 9.60e-01
davidson solver did not converge after         13 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+12 is 6.287262e-17

solving harmonic davidson linear method for identity shift 2.2204e+13, overlap shift 2.2204e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329997166840       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329997166840       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329997166840       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329997166833       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327078101173       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329272553978       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.502536317451       residual = 7.36e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -19.507701767786       residual = 3.27e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -20.833076105295       residual = 4.59e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -20.986525255461       residual = 3.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.039137584589       residual = 1.69e+03           smallest_sin_value = 1.00e+00
davidson iteration   11 stopping due to too large eigenvalue change
davidson solver did not converge after         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+13 is 1.571816e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+13, overlap shift 8.8818e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329997166840       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329997166840       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329997166840       residual = 1.53e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+13 is 3.855808e-18

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.298835 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9430e+01
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.3191
    reference variance = 3.51483
====================================================
  Execution time = 2.2879e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7152e+00
  Total weights = 1.9495e+06
  Execution time = 4.3522e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764898729312
                                         uncertainty =       0.027577634044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764898729312
                                         uncertainty =       0.027577634044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372084026
  error estimate for blocks of size 2^( 2) =       0.001442351319
  error estimate for blocks of size 2^( 3) =       0.001504714537
  error estimate for blocks of size 2^( 4) =       0.001549082397
  error estimate for blocks of size 2^( 5) =       0.001572903575
  error estimate for blocks of size 2^( 6) =       0.001585534732
  error estimate for blocks of size 2^( 7) =       0.001595240801

      target function =                  N/A
              le_mean =     -22.329071368745
             les_mean =     502.302650164660
             stat err =       0.001575690376
             autocorr =       1.318804281161
              std dev =       1.940450885063
             le_variance =       3.765349637340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764898729312
                                         uncertainty =       0.027577634044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764898729312
                                         uncertainty =       0.027577634044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372084026
  error estimate for blocks of size 2^( 2) =       0.001442351319
  error estimate for blocks of size 2^( 3) =       0.001504714537
  error estimate for blocks of size 2^( 4) =       0.001549082397
  error estimate for blocks of size 2^( 5) =       0.001572903575
  error estimate for blocks of size 2^( 6) =       0.001585534732
  error estimate for blocks of size 2^( 7) =       0.001595240801

      target function =                  N/A
              le_mean =     -22.329071368745
             les_mean =     502.302650164660
             stat err =       0.001575690376
             autocorr =       1.318804281161
              std dev =       1.940450885063
             le_variance =       3.765349637340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764898729312
                                         uncertainty =       0.027577634044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764898729312
                                         uncertainty =       0.027577634044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372084026
  error estimate for blocks of size 2^( 2) =       0.001442351319
  error estimate for blocks of size 2^( 3) =       0.001504714537
  error estimate for blocks of size 2^( 4) =       0.001549082397
  error estimate for blocks of size 2^( 5) =       0.001572903575
  error estimate for blocks of size 2^( 6) =       0.001585534732
  error estimate for blocks of size 2^( 7) =       0.001595240801

      target function =                  N/A
              le_mean =     -22.329071368745
             les_mean =     502.302650164660
             stat err =       0.001575690376
             autocorr =       1.318804281161
              std dev =       1.940450885063
             le_variance =       3.765349637340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764898729312
                                         uncertainty =       0.027577634044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764898729312
                                         uncertainty =       0.027577634044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372084026
  error estimate for blocks of size 2^( 2) =       0.001442351319
  error estimate for blocks of size 2^( 3) =       0.001504714537
  error estimate for blocks of size 2^( 4) =       0.001549082397
  error estimate for blocks of size 2^( 5) =       0.001572903575
  error estimate for blocks of size 2^( 6) =       0.001585534732
  error estimate for blocks of size 2^( 7) =       0.001595240801

      target function =                  N/A
              le_mean =     -22.329071368745
             les_mean =     502.302650164660
             stat err =       0.001575690376
             autocorr =       1.318804281161
              std dev =       1.940450885063
             le_variance =       3.765349637340


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329071368745        initial
     5.5511e+12     5.5511e+13             6.2873e-17       -22.329071368745
     2.2204e+13     2.2204e+14             1.5718e-17       -22.329071368745
     8.8818e+13     8.8818e+14             3.8558e-18       -22.329071368745  <--

*****************************************************************************
Applying the update for shift_i =   8.8818e+13     and shift_s =   8.8818e+14
*****************************************************************************

  Execution time = 4.4689e+01
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4127e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2317e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.5149
    reference variance = 2.90181
====================================================
  Execution time = 2.3429e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0346e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7468e+00
  Total weights = 1.950049436e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9327e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788738101092
                                         uncertainty =       0.031664371381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788738101092
                                         uncertainty =       0.031664371381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378038212
  error estimate for blocks of size 2^( 2) =       0.001448904887
  error estimate for blocks of size 2^( 3) =       0.001511046359
  error estimate for blocks of size 2^( 4) =       0.001551455171
  error estimate for blocks of size 2^( 5) =       0.001575578268
  error estimate for blocks of size 2^( 6) =       0.001593497890
  error estimate for blocks of size 2^( 7) =       0.001601811963

      target function =                  N/A
              le_mean =     -22.326723988954
             les_mean =     502.229374629056
             stat err =       0.001580585823
             autocorr =       1.315569037717
              std dev =       1.948871510013
             le_variance =       3.798100162539


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232672398895e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+13, overlap shift 2.2204e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326723988157       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326723988157       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.71e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 8.8818e+13, overlap shift 8.8818e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326723988157       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326723988157       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.09e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.5527e+14, overlap shift 3.5527e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326723988157       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326723988157       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.71e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300035 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9369e+01
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.5614
    reference variance = 3.27575
====================================================
  Execution time = 2.2883e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7560e+00
  Total weights = 1.9498e+06
  Execution time = 4.3579e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807540903932
                                         uncertainty =       0.048518255259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807540903932
                                         uncertainty =       0.048518255259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379809144
  error estimate for blocks of size 2^( 2) =       0.001450053691
  error estimate for blocks of size 2^( 3) =       0.001511766042
  error estimate for blocks of size 2^( 4) =       0.001555488099
  error estimate for blocks of size 2^( 5) =       0.001578234241
  error estimate for blocks of size 2^( 6) =       0.001591322613
  error estimate for blocks of size 2^( 7) =       0.001599771971

      target function =                  N/A
              le_mean =     -22.329904791660
             les_mean =     502.380653754383
             stat err =       0.001581204231
             autocorr =       1.313221240490
              std dev =       1.951376025650
             le_variance =       3.807868393483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807540903932
                                         uncertainty =       0.048518255259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807540903932
                                         uncertainty =       0.048518255259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379809144
  error estimate for blocks of size 2^( 2) =       0.001450053691
  error estimate for blocks of size 2^( 3) =       0.001511766042
  error estimate for blocks of size 2^( 4) =       0.001555488099
  error estimate for blocks of size 2^( 5) =       0.001578234241
  error estimate for blocks of size 2^( 6) =       0.001591322613
  error estimate for blocks of size 2^( 7) =       0.001599771971

      target function =                  N/A
              le_mean =     -22.329904791660
             les_mean =     502.380653754383
             stat err =       0.001581204231
             autocorr =       1.313221240490
              std dev =       1.951376025650
             le_variance =       3.807868393483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807540903932
                                         uncertainty =       0.048518255259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807540903932
                                         uncertainty =       0.048518255259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379809144
  error estimate for blocks of size 2^( 2) =       0.001450053691
  error estimate for blocks of size 2^( 3) =       0.001511766042
  error estimate for blocks of size 2^( 4) =       0.001555488099
  error estimate for blocks of size 2^( 5) =       0.001578234241
  error estimate for blocks of size 2^( 6) =       0.001591322613
  error estimate for blocks of size 2^( 7) =       0.001599771971

      target function =                  N/A
              le_mean =     -22.329904791660
             les_mean =     502.380653754383
             stat err =       0.001581204231
             autocorr =       1.313221240490
              std dev =       1.951376025650
             le_variance =       3.807868393483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807540903932
                                         uncertainty =       0.048518255259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807540903932
                                         uncertainty =       0.048518255259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379809144
  error estimate for blocks of size 2^( 2) =       0.001450053691
  error estimate for blocks of size 2^( 3) =       0.001511766042
  error estimate for blocks of size 2^( 4) =       0.001555488099
  error estimate for blocks of size 2^( 5) =       0.001578234241
  error estimate for blocks of size 2^( 6) =       0.001591322613
  error estimate for blocks of size 2^( 7) =       0.001599771971

      target function =                  N/A
              le_mean =     -22.329904791660
             les_mean =     502.380653754383
             stat err =       0.001581204231
             autocorr =       1.313221240490
              std dev =       1.951376025650
             le_variance =       3.807868393483


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329904791660        initial  <--
     2.2204e+13     2.2204e+14             0.0000e+00       -22.329904791660
     8.8818e+13     8.8818e+14             0.0000e+00       -22.329904791660
     3.5527e+14     3.5527e+15             0.0000e+00       -22.329904791660

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7435
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4121e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2320e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.6452
    reference variance = 2.10031
====================================================
  Execution time = 2.3462e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0320e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7529e+00
  Total weights = 1.949488642e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9484e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.806249775277
                                         uncertainty =       0.052894857346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.806249775277
                                         uncertainty =       0.052894857346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379533227
  error estimate for blocks of size 2^( 2) =       0.001448590007
  error estimate for blocks of size 2^( 3) =       0.001512490234
  error estimate for blocks of size 2^( 4) =       0.001558306420
  error estimate for blocks of size 2^( 5) =       0.001584360716
  error estimate for blocks of size 2^( 6) =       0.001597650276
  error estimate for blocks of size 2^( 7) =       0.001613806977

      target function =                  N/A
              le_mean =     -22.327594282754
             les_mean =     502.274337145239
             stat err =       0.001588531097
             autocorr =       1.325949890336
              std dev =       1.950985814164
             le_variance =       3.806345647071


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232759428275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+14, overlap shift 2.2204e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327594281912       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327594281912       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327594281912       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327594281912       residual = 1.67e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+14 is 2.047720e-18

solving harmonic davidson linear method for identity shift 8.8818e+14, overlap shift 8.8818e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327594281912       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327594281912       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327594281912       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+14 is 5.198923e-19

solving harmonic davidson linear method for identity shift 3.5527e+15, overlap shift 3.5527e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327594281912       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327594281912       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327594281912       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+15 is 1.299731e-19

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301583 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9417e+01
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.4528
    reference variance = 2.11177
====================================================
  Execution time = 2.2915e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7731e+00
  Total weights = 1.9498e+06
  Execution time = 4.9142e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826377823195
                                         uncertainty =       0.049384274366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826377823195
                                         uncertainty =       0.049384274366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383115599
  error estimate for blocks of size 2^( 2) =       0.001454379764
  error estimate for blocks of size 2^( 3) =       0.001516607180
  error estimate for blocks of size 2^( 4) =       0.001559461997
  error estimate for blocks of size 2^( 5) =       0.001584840615
  error estimate for blocks of size 2^( 6) =       0.001599188719
  error estimate for blocks of size 2^( 7) =       0.001610945552

      target function =                  N/A
              le_mean =     -22.328531206227
             les_mean =     502.336394927898
             stat err =       0.001588609221
             autocorr =       1.319219915498
              std dev =       1.956052135072
             le_variance =       3.826139955118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826377823195
                                         uncertainty =       0.049384274366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826377823195
                                         uncertainty =       0.049384274366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383115599
  error estimate for blocks of size 2^( 2) =       0.001454379764
  error estimate for blocks of size 2^( 3) =       0.001516607180
  error estimate for blocks of size 2^( 4) =       0.001559461997
  error estimate for blocks of size 2^( 5) =       0.001584840615
  error estimate for blocks of size 2^( 6) =       0.001599188719
  error estimate for blocks of size 2^( 7) =       0.001610945552

      target function =                  N/A
              le_mean =     -22.328531206227
             les_mean =     502.336394927898
             stat err =       0.001588609221
             autocorr =       1.319219915498
              std dev =       1.956052135072
             le_variance =       3.826139955118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826377823195
                                         uncertainty =       0.049384274366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826377823195
                                         uncertainty =       0.049384274366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383115599
  error estimate for blocks of size 2^( 2) =       0.001454379764
  error estimate for blocks of size 2^( 3) =       0.001516607180
  error estimate for blocks of size 2^( 4) =       0.001559461997
  error estimate for blocks of size 2^( 5) =       0.001584840615
  error estimate for blocks of size 2^( 6) =       0.001599188719
  error estimate for blocks of size 2^( 7) =       0.001610945552

      target function =                  N/A
              le_mean =     -22.328531206227
             les_mean =     502.336394927898
             stat err =       0.001588609221
             autocorr =       1.319219915498
              std dev =       1.956052135072
             le_variance =       3.826139955118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826377823195
                                         uncertainty =       0.049384274366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.826377823195
                                         uncertainty =       0.049384274366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383115599
  error estimate for blocks of size 2^( 2) =       0.001454379764
  error estimate for blocks of size 2^( 3) =       0.001516607180
  error estimate for blocks of size 2^( 4) =       0.001559461997
  error estimate for blocks of size 2^( 5) =       0.001584840615
  error estimate for blocks of size 2^( 6) =       0.001599188719
  error estimate for blocks of size 2^( 7) =       0.001610945552

      target function =                  N/A
              le_mean =     -22.328531206227
             les_mean =     502.336394927898
             stat err =       0.001588609221
             autocorr =       1.319219915498
              std dev =       1.956052135072
             le_variance =       3.826139955118


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328531206227        initial
     2.2204e+14     2.2204e+15             2.0477e-18       -22.328531206227
     8.8818e+14     8.8818e+15             5.1989e-19       -22.328531206227  <--
     3.5527e+15     3.5527e+16             1.2997e-19       -22.328531206227

*****************************************************************************
Applying the update for shift_i =   8.8818e+14     and shift_s =   8.8818e+15
*****************************************************************************

  Execution time = 4.5666e+01
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5091e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2323e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.6156
    reference variance = 2.90137
====================================================
  Execution time = 2.3474e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0301e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8036e+00
  Total weights = 1.949586754e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9906e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.857257757415
                                         uncertainty =       0.056876179420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.857257757415
                                         uncertainty =       0.056876179420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001388729153
  error estimate for blocks of size 2^( 2) =       0.001458330919
  error estimate for blocks of size 2^( 3) =       0.001520931508
  error estimate for blocks of size 2^( 4) =       0.001565087678
  error estimate for blocks of size 2^( 5) =       0.001590692995
  error estimate for blocks of size 2^( 6) =       0.001605443770
  error estimate for blocks of size 2^( 7) =       0.001604025682

      target function =                  N/A
              le_mean =     -22.328176380498
             les_mean =     502.351028773464
             stat err =       0.001591312531
             autocorr =       1.313033663466
              std dev =       1.963991025198
             le_variance =       3.857260747059


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232817638050e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+14, overlap shift 2.2204e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328176379697       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328176379697       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.74e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 8.8818e+14, overlap shift 8.8818e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328176379697       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328176379697       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.74e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.5527e+15, overlap shift 3.5527e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328176379697       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328176379697       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.74e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.302785 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9471e+01
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.39
    reference variance = 2.01144
====================================================
  Execution time = 2.2923e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7357e+00
  Total weights = 1.9499e+06
  Execution time = 4.4052e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785915709302
                                         uncertainty =       0.033370677453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785915709302
                                         uncertainty =       0.033370677453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375816427
  error estimate for blocks of size 2^( 2) =       0.001447564744
  error estimate for blocks of size 2^( 3) =       0.001511792396
  error estimate for blocks of size 2^( 4) =       0.001554953175
  error estimate for blocks of size 2^( 5) =       0.001575897145
  error estimate for blocks of size 2^( 6) =       0.001588375842
  error estimate for blocks of size 2^( 7) =       0.001602653079

      target function =                  N/A
              le_mean =     -22.325093331488
             les_mean =     502.145492833439
             stat err =       0.001580469810
             autocorr =       1.319627715145
              std dev =       1.945729380750
             le_variance =       3.785862823114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785915709302
                                         uncertainty =       0.033370677453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785915709302
                                         uncertainty =       0.033370677453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375816427
  error estimate for blocks of size 2^( 2) =       0.001447564744
  error estimate for blocks of size 2^( 3) =       0.001511792396
  error estimate for blocks of size 2^( 4) =       0.001554953175
  error estimate for blocks of size 2^( 5) =       0.001575897145
  error estimate for blocks of size 2^( 6) =       0.001588375842
  error estimate for blocks of size 2^( 7) =       0.001602653079

      target function =                  N/A
              le_mean =     -22.325093331488
             les_mean =     502.145492833439
             stat err =       0.001580469810
             autocorr =       1.319627715145
              std dev =       1.945729380750
             le_variance =       3.785862823114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785915709302
                                         uncertainty =       0.033370677453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785915709302
                                         uncertainty =       0.033370677453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375816427
  error estimate for blocks of size 2^( 2) =       0.001447564744
  error estimate for blocks of size 2^( 3) =       0.001511792396
  error estimate for blocks of size 2^( 4) =       0.001554953175
  error estimate for blocks of size 2^( 5) =       0.001575897145
  error estimate for blocks of size 2^( 6) =       0.001588375842
  error estimate for blocks of size 2^( 7) =       0.001602653079

      target function =                  N/A
              le_mean =     -22.325093331488
             les_mean =     502.145492833439
             stat err =       0.001580469810
             autocorr =       1.319627715145
              std dev =       1.945729380750
             le_variance =       3.785862823114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785915709302
                                         uncertainty =       0.033370677453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785915709302
                                         uncertainty =       0.033370677453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375816427
  error estimate for blocks of size 2^( 2) =       0.001447564744
  error estimate for blocks of size 2^( 3) =       0.001511792396
  error estimate for blocks of size 2^( 4) =       0.001554953175
  error estimate for blocks of size 2^( 5) =       0.001575897145
  error estimate for blocks of size 2^( 6) =       0.001588375842
  error estimate for blocks of size 2^( 7) =       0.001602653079

      target function =                  N/A
              le_mean =     -22.325093331488
             les_mean =     502.145492833439
             stat err =       0.001580469810
             autocorr =       1.319627715145
              std dev =       1.945729380750
             le_variance =       3.785862823114


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325093331488        initial  <--
     2.2204e+14     2.2204e+15             0.0000e+00       -22.325093331488
     8.8818e+14     8.8818e+15             0.0000e+00       -22.325093331488
     3.5527e+15     3.5527e+16             0.0000e+00       -22.325093331488

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1901
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4671e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2325e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.2249
    reference variance = 4.22052
====================================================
  Execution time = 2.3479e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0313e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6855e+00
  Total weights = 1.949966772e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9130e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.735981776739
                                         uncertainty =       0.022687649644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.735981776739
                                         uncertainty =       0.022687649644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366554013
  error estimate for blocks of size 2^( 2) =       0.001437610788
  error estimate for blocks of size 2^( 3) =       0.001502076898
  error estimate for blocks of size 2^( 4) =       0.001543526841
  error estimate for blocks of size 2^( 5) =       0.001569362502
  error estimate for blocks of size 2^( 6) =       0.001583796977
  error estimate for blocks of size 2^( 7) =       0.001585581240

      target function =                  N/A
              le_mean =     -22.329989442126
             les_mean =     502.313943427798
             stat err =       0.001570566890
             autocorr =       1.320867551535
              std dev =       1.932630140407
             le_variance =       3.735059259609


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232998944213e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+15, overlap shift 2.2204e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329989441345       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329989441345       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329989441345       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.33e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+15 is 2.231169e-19

solving harmonic davidson linear method for identity shift 8.8818e+15, overlap shift 8.8818e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329989441345       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329989441345       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329989441345       residual = 1.50e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329989441757       residual = 1.29e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.975114006427       residual = 1.33e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -21.213093035838       residual = 1.69e+02           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+15 is 5.577922e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+16, overlap shift 3.5527e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329989441345       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329989441345       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329989441344       residual = 6.72e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.501554370423       residual = 6.90e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+16 is 1.394480e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304872 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9399e+01
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -21.8716
    reference variance = 4.91521
====================================================
  Execution time = 2.2944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.8150e+00
  Total weights = 1.9500e+06
  Execution time = 4.3999e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.870318651756
                                         uncertainty =       0.061381257450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.870318651756
                                         uncertainty =       0.061381257450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001390901638
  error estimate for blocks of size 2^( 2) =       0.001462392695
  error estimate for blocks of size 2^( 3) =       0.001524007704
  error estimate for blocks of size 2^( 4) =       0.001566447893
  error estimate for blocks of size 2^( 5) =       0.001592916816
  error estimate for blocks of size 2^( 6) =       0.001608320253
  error estimate for blocks of size 2^( 7) =       0.001620293702

      target function =                  N/A
              le_mean =     -22.326523730476
             les_mean =     502.288663671669
             stat err =       0.001596994666
             autocorr =       1.318299519884
              std dev =       1.967063432898
             le_variance =       3.869338549046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.870318651756
                                         uncertainty =       0.061381257450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.870318651756
                                         uncertainty =       0.061381257450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001390901638
  error estimate for blocks of size 2^( 2) =       0.001462392695
  error estimate for blocks of size 2^( 3) =       0.001524007704
  error estimate for blocks of size 2^( 4) =       0.001566447893
  error estimate for blocks of size 2^( 5) =       0.001592916816
  error estimate for blocks of size 2^( 6) =       0.001608320253
  error estimate for blocks of size 2^( 7) =       0.001620293702

      target function =                  N/A
              le_mean =     -22.326523730476
             les_mean =     502.288663671669
             stat err =       0.001596994666
             autocorr =       1.318299519884
              std dev =       1.967063432898
             le_variance =       3.869338549046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.870318651756
                                         uncertainty =       0.061381257450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.870318651756
                                         uncertainty =       0.061381257450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001390901638
  error estimate for blocks of size 2^( 2) =       0.001462392695
  error estimate for blocks of size 2^( 3) =       0.001524007704
  error estimate for blocks of size 2^( 4) =       0.001566447893
  error estimate for blocks of size 2^( 5) =       0.001592916816
  error estimate for blocks of size 2^( 6) =       0.001608320253
  error estimate for blocks of size 2^( 7) =       0.001620293702

      target function =                  N/A
              le_mean =     -22.326523730476
             les_mean =     502.288663671669
             stat err =       0.001596994666
             autocorr =       1.318299519884
              std dev =       1.967063432898
             le_variance =       3.869338549046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.870318651756
                                         uncertainty =       0.061381257450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.870318651756
                                         uncertainty =       0.061381257450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001390901638
  error estimate for blocks of size 2^( 2) =       0.001462392695
  error estimate for blocks of size 2^( 3) =       0.001524007704
  error estimate for blocks of size 2^( 4) =       0.001566447893
  error estimate for blocks of size 2^( 5) =       0.001592916816
  error estimate for blocks of size 2^( 6) =       0.001608320253
  error estimate for blocks of size 2^( 7) =       0.001620293702

      target function =                  N/A
              le_mean =     -22.326523730476
             les_mean =     502.288663671669
             stat err =       0.001596994666
             autocorr =       1.318299519884
              std dev =       1.967063432898
             le_variance =       3.869338549046


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326523730476        initial  <--
     2.2204e+15     2.2204e+16             2.2312e-19       -22.326523730476
     8.8818e+15     8.8818e+16             5.5779e-20       -22.326523730476
     3.5527e+16     3.5527e+17             1.3945e-20       -22.326523730476

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1792
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4587e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2322e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.6055
    reference variance = 1.8932
====================================================
  Execution time = 2.3468e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0329e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6981e+00
  Total weights = 1.949767283e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9163e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.744917309899
                                         uncertainty =       0.030279005395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.744917309899
                                         uncertainty =       0.030279005395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368499009
  error estimate for blocks of size 2^( 2) =       0.001439598606
  error estimate for blocks of size 2^( 3) =       0.001501988297
  error estimate for blocks of size 2^( 4) =       0.001544982558
  error estimate for blocks of size 2^( 5) =       0.001569699733
  error estimate for blocks of size 2^( 6) =       0.001579175763
  error estimate for blocks of size 2^( 7) =       0.001585980884

      target function =                  N/A
              le_mean =     -22.328424039154
             les_mean =     502.256640231709
             stat err =       0.001569959734
             autocorr =       1.316097467630
              std dev =       1.935380823813
             le_variance =       3.745698933184


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232842403915e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+16, overlap shift 2.2204e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328424038330       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328424038330       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 8.8818e+16, overlap shift 8.8818e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328424038330       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328424038330       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.5527e+17, overlap shift 3.5527e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328424038330       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328424038330       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+17 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306077 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9391e+01
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.4181
    reference variance = 3.32255
====================================================
  Execution time = 2.2889e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6666e+00
  Total weights = 1.9496e+06
  Execution time = 4.3865e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718221394160
                                         uncertainty =       0.026152065760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718221394160
                                         uncertainty =       0.026152065760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363463150
  error estimate for blocks of size 2^( 2) =       0.001436292662
  error estimate for blocks of size 2^( 3) =       0.001499262751
  error estimate for blocks of size 2^( 4) =       0.001543748381
  error estimate for blocks of size 2^( 5) =       0.001564707074
  error estimate for blocks of size 2^( 6) =       0.001574469113
  error estimate for blocks of size 2^( 7) =       0.001582569610

      target function =                  N/A
              le_mean =     -22.330384152774
             les_mean =     502.312685863765
             stat err =       0.001566373544
             autocorr =       1.319787069539
              std dev =       1.928258929963
             le_variance =       3.718182500980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718221394160
                                         uncertainty =       0.026152065760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718221394160
                                         uncertainty =       0.026152065760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363463150
  error estimate for blocks of size 2^( 2) =       0.001436292662
  error estimate for blocks of size 2^( 3) =       0.001499262751
  error estimate for blocks of size 2^( 4) =       0.001543748381
  error estimate for blocks of size 2^( 5) =       0.001564707074
  error estimate for blocks of size 2^( 6) =       0.001574469113
  error estimate for blocks of size 2^( 7) =       0.001582569610

      target function =                  N/A
              le_mean =     -22.330384152774
             les_mean =     502.312685863765
             stat err =       0.001566373544
             autocorr =       1.319787069539
              std dev =       1.928258929963
             le_variance =       3.718182500980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718221394160
                                         uncertainty =       0.026152065760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718221394160
                                         uncertainty =       0.026152065760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363463150
  error estimate for blocks of size 2^( 2) =       0.001436292662
  error estimate for blocks of size 2^( 3) =       0.001499262751
  error estimate for blocks of size 2^( 4) =       0.001543748381
  error estimate for blocks of size 2^( 5) =       0.001564707074
  error estimate for blocks of size 2^( 6) =       0.001574469113
  error estimate for blocks of size 2^( 7) =       0.001582569610

      target function =                  N/A
              le_mean =     -22.330384152774
             les_mean =     502.312685863765
             stat err =       0.001566373544
             autocorr =       1.319787069539
              std dev =       1.928258929963
             le_variance =       3.718182500980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718221394160
                                         uncertainty =       0.026152065760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718221394160
                                         uncertainty =       0.026152065760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363463150
  error estimate for blocks of size 2^( 2) =       0.001436292662
  error estimate for blocks of size 2^( 3) =       0.001499262751
  error estimate for blocks of size 2^( 4) =       0.001543748381
  error estimate for blocks of size 2^( 5) =       0.001564707074
  error estimate for blocks of size 2^( 6) =       0.001574469113
  error estimate for blocks of size 2^( 7) =       0.001582569610

      target function =                  N/A
              le_mean =     -22.330384152774
             les_mean =     502.312685863765
             stat err =       0.001566373544
             autocorr =       1.319787069539
              std dev =       1.928258929963
             le_variance =       3.718182500980


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330384152774        initial  <--
     2.2204e+16     2.2204e+17             0.0000e+00       -22.330384152774
     8.8818e+16     8.8818e+17             0.0000e+00       -22.330384152774
     3.5527e+17     3.5527e+18             0.0000e+00       -22.330384152774

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0491
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4448e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2324e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.1961
    reference variance = 3.18397
====================================================
  Execution time = 2.3472e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0303e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7493e+00
  Total weights = 1.949527202e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9564e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793758011314
                                         uncertainty =       0.037712375949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793758011314
                                         uncertainty =       0.037712375949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377159442
  error estimate for blocks of size 2^( 2) =       0.001449416032
  error estimate for blocks of size 2^( 3) =       0.001512679728
  error estimate for blocks of size 2^( 4) =       0.001554948535
  error estimate for blocks of size 2^( 5) =       0.001582935368
  error estimate for blocks of size 2^( 6) =       0.001594625251
  error estimate for blocks of size 2^( 7) =       0.001605266230

      target function =                  N/A
              le_mean =     -22.329508115334
             les_mean =     502.356210704493
             stat err =       0.001584443846
             autocorr =       1.323686854354
              std dev =       1.947628722012
             le_variance =       3.793257638805


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232950811533e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+17, overlap shift 2.2204e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329508114513       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329508114513       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+17, overlap shift 8.8818e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329508114513       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329508114513       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+18, overlap shift 3.5527e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329508114513       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329508114513       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.307279 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9436e+01
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.5014
    reference variance = 3.4826
====================================================
  Execution time = 2.2957e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6639e+00
  Total weights = 1.9500e+06
  Execution time = 4.8836e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715287958001
                                         uncertainty =       0.025391251161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715287958001
                                         uncertainty =       0.025391251161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362906226
  error estimate for blocks of size 2^( 2) =       0.001434762344
  error estimate for blocks of size 2^( 3) =       0.001497956033
  error estimate for blocks of size 2^( 4) =       0.001542539195
  error estimate for blocks of size 2^( 5) =       0.001563481604
  error estimate for blocks of size 2^( 6) =       0.001571638917
  error estimate for blocks of size 2^( 7) =       0.001581049953

      target function =                  N/A
              le_mean =     -22.330225110652
             les_mean =     502.302831573438
             stat err =       0.001564677417
             autocorr =       1.318006882053
              std dev =       1.927471308037
             le_variance =       3.715145643306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715287958001
                                         uncertainty =       0.025391251161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715287958001
                                         uncertainty =       0.025391251161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362906226
  error estimate for blocks of size 2^( 2) =       0.001434762344
  error estimate for blocks of size 2^( 3) =       0.001497956033
  error estimate for blocks of size 2^( 4) =       0.001542539195
  error estimate for blocks of size 2^( 5) =       0.001563481604
  error estimate for blocks of size 2^( 6) =       0.001571638917
  error estimate for blocks of size 2^( 7) =       0.001581049953

      target function =                  N/A
              le_mean =     -22.330225110652
             les_mean =     502.302831573438
             stat err =       0.001564677417
             autocorr =       1.318006882053
              std dev =       1.927471308037
             le_variance =       3.715145643306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715287958001
                                         uncertainty =       0.025391251161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715287958001
                                         uncertainty =       0.025391251161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362906226
  error estimate for blocks of size 2^( 2) =       0.001434762344
  error estimate for blocks of size 2^( 3) =       0.001497956033
  error estimate for blocks of size 2^( 4) =       0.001542539195
  error estimate for blocks of size 2^( 5) =       0.001563481604
  error estimate for blocks of size 2^( 6) =       0.001571638917
  error estimate for blocks of size 2^( 7) =       0.001581049953

      target function =                  N/A
              le_mean =     -22.330225110652
             les_mean =     502.302831573438
             stat err =       0.001564677417
             autocorr =       1.318006882053
              std dev =       1.927471308037
             le_variance =       3.715145643306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715287958001
                                         uncertainty =       0.025391251161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715287958001
                                         uncertainty =       0.025391251161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362906226
  error estimate for blocks of size 2^( 2) =       0.001434762344
  error estimate for blocks of size 2^( 3) =       0.001497956033
  error estimate for blocks of size 2^( 4) =       0.001542539195
  error estimate for blocks of size 2^( 5) =       0.001563481604
  error estimate for blocks of size 2^( 6) =       0.001571638917
  error estimate for blocks of size 2^( 7) =       0.001581049953

      target function =                  N/A
              le_mean =     -22.330225110652
             les_mean =     502.302831573438
             stat err =       0.001564677417
             autocorr =       1.318006882053
              std dev =       1.927471308037
             le_variance =       3.715145643306


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330225110652        initial  <--
     2.2204e+17     2.2204e+18             0.0000e+00       -22.330225110652
     8.8818e+17     8.8818e+18             0.0000e+00       -22.330225110652
     3.5527e+18     3.5527e+19             0.0000e+00       -22.330225110652

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3278
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4773e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2325e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.3136
    reference variance = 3.46522
====================================================
  Execution time = 2.3410e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0289e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7835e+00
  Total weights = 1.950375007e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9559e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.836724216516
                                         uncertainty =       0.037612654777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.836724216516
                                         uncertainty =       0.037612654777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001384965178
  error estimate for blocks of size 2^( 2) =       0.001455978115
  error estimate for blocks of size 2^( 3) =       0.001519920022
  error estimate for blocks of size 2^( 4) =       0.001562414469
  error estimate for blocks of size 2^( 5) =       0.001590157540
  error estimate for blocks of size 2^( 6) =       0.001597234094
  error estimate for blocks of size 2^( 7) =       0.001607839565

      target function =                  N/A
              le_mean =     -22.325521383679
             les_mean =     502.212399880036
             stat err =       0.001589411417
             autocorr =       1.317027817480
              std dev =       1.958667876757
             le_variance =       3.836379851442


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232552138368e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+18, overlap shift 2.2204e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325521382863       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325521382863       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+18, overlap shift 8.8818e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325521382863       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325521382863       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+19, overlap shift 3.5527e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325521382863       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325521382863       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.308522 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9373e+01
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.4203
    reference variance = 2.70351
====================================================
  Execution time = 2.2869e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6468e+00
  Total weights = 1.9497e+06
  Execution time = 4.3084e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.696795154064
                                         uncertainty =       0.025671613987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.696795154064
                                         uncertainty =       0.025671613987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001359467108
  error estimate for blocks of size 2^( 2) =       0.001430214824
  error estimate for blocks of size 2^( 3) =       0.001492553065
  error estimate for blocks of size 2^( 4) =       0.001536696581
  error estimate for blocks of size 2^( 5) =       0.001562726291
  error estimate for blocks of size 2^( 6) =       0.001574588174
  error estimate for blocks of size 2^( 7) =       0.001581949935

      target function =                  N/A
              le_mean =     -22.330256192772
             les_mean =     502.287179544495
             stat err =       0.001563990246
             autocorr =       1.323520496488
              std dev =       1.922607582841
             le_variance =       3.696419917598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.696795154064
                                         uncertainty =       0.025671613987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.696795154064
                                         uncertainty =       0.025671613987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001359467108
  error estimate for blocks of size 2^( 2) =       0.001430214824
  error estimate for blocks of size 2^( 3) =       0.001492553065
  error estimate for blocks of size 2^( 4) =       0.001536696581
  error estimate for blocks of size 2^( 5) =       0.001562726291
  error estimate for blocks of size 2^( 6) =       0.001574588174
  error estimate for blocks of size 2^( 7) =       0.001581949935

      target function =                  N/A
              le_mean =     -22.330256192772
             les_mean =     502.287179544495
             stat err =       0.001563990246
             autocorr =       1.323520496488
              std dev =       1.922607582841
             le_variance =       3.696419917598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.696795154064
                                         uncertainty =       0.025671613987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.696795154064
                                         uncertainty =       0.025671613987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001359467108
  error estimate for blocks of size 2^( 2) =       0.001430214824
  error estimate for blocks of size 2^( 3) =       0.001492553065
  error estimate for blocks of size 2^( 4) =       0.001536696581
  error estimate for blocks of size 2^( 5) =       0.001562726291
  error estimate for blocks of size 2^( 6) =       0.001574588174
  error estimate for blocks of size 2^( 7) =       0.001581949935

      target function =                  N/A
              le_mean =     -22.330256192772
             les_mean =     502.287179544495
             stat err =       0.001563990246
             autocorr =       1.323520496488
              std dev =       1.922607582841
             le_variance =       3.696419917598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.696795154064
                                         uncertainty =       0.025671613987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.696795154064
                                         uncertainty =       0.025671613987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001359467108
  error estimate for blocks of size 2^( 2) =       0.001430214824
  error estimate for blocks of size 2^( 3) =       0.001492553065
  error estimate for blocks of size 2^( 4) =       0.001536696581
  error estimate for blocks of size 2^( 5) =       0.001562726291
  error estimate for blocks of size 2^( 6) =       0.001574588174
  error estimate for blocks of size 2^( 7) =       0.001581949935

      target function =                  N/A
              le_mean =     -22.330256192772
             les_mean =     502.287179544495
             stat err =       0.001563990246
             autocorr =       1.323520496488
              std dev =       1.922607582841
             le_variance =       3.696419917598


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330256192772        initial  <--
     2.2204e+18     2.2204e+19             0.0000e+00       -22.330256192772
     8.8818e+18     8.8818e+19             0.0000e+00       -22.330256192772
     3.5527e+19     3.5527e+20             0.0000e+00       -22.330256192772

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5978
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3979e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2325e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.3703
    reference variance = 2.6076
====================================================
  Execution time = 2.3425e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0310e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7491e+00
  Total weights = 1.949807966e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8590e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.803188618131
                                         uncertainty =       0.036248792473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.803188618131
                                         uncertainty =       0.036248792473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378935153
  error estimate for blocks of size 2^( 2) =       0.001449493039
  error estimate for blocks of size 2^( 3) =       0.001512818404
  error estimate for blocks of size 2^( 4) =       0.001555866854
  error estimate for blocks of size 2^( 5) =       0.001580392553
  error estimate for blocks of size 2^( 6) =       0.001596924406
  error estimate for blocks of size 2^( 7) =       0.001609375817

      target function =                  N/A
              le_mean =     -22.328309895134
             les_mean =     502.302498202991
             stat err =       0.001585639907
             autocorr =       1.322273970682
              std dev =       1.950139996794
             le_variance =       3.803046007096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232830989513e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+19, overlap shift 2.2204e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328309894364       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328309894364       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+19, overlap shift 8.8818e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328309894364       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328309894364       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+20, overlap shift 3.5527e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328309894364       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328309894364       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.309772 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9291e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.4198
    reference variance = 2.45154
====================================================
  Execution time = 2.2850e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7924e+00
  Total weights = 1.9500e+06
  Execution time = 4.3153e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844481020966
                                         uncertainty =       0.054108091581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844481020966
                                         uncertainty =       0.054108091581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386315186
  error estimate for blocks of size 2^( 2) =       0.001456521000
  error estimate for blocks of size 2^( 3) =       0.001519989311
  error estimate for blocks of size 2^( 4) =       0.001560030964
  error estimate for blocks of size 2^( 5) =       0.001589342440
  error estimate for blocks of size 2^( 6) =       0.001605300844
  error estimate for blocks of size 2^( 7) =       0.001609388150

      target function =                  N/A
              le_mean =     -22.324522225969
             les_mean =     502.176681643496
             stat err =       0.001591015599
             autocorr =       1.317118695572
              std dev =       1.960577106317
             le_variance =       3.843862589816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844481020966
                                         uncertainty =       0.054108091581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844481020966
                                         uncertainty =       0.054108091581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386315186
  error estimate for blocks of size 2^( 2) =       0.001456521000
  error estimate for blocks of size 2^( 3) =       0.001519989311
  error estimate for blocks of size 2^( 4) =       0.001560030964
  error estimate for blocks of size 2^( 5) =       0.001589342440
  error estimate for blocks of size 2^( 6) =       0.001605300844
  error estimate for blocks of size 2^( 7) =       0.001609388150

      target function =                  N/A
              le_mean =     -22.324522225969
             les_mean =     502.176681643496
             stat err =       0.001591015599
             autocorr =       1.317118695572
              std dev =       1.960577106317
             le_variance =       3.843862589816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844481020966
                                         uncertainty =       0.054108091581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844481020966
                                         uncertainty =       0.054108091581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386315186
  error estimate for blocks of size 2^( 2) =       0.001456521000
  error estimate for blocks of size 2^( 3) =       0.001519989311
  error estimate for blocks of size 2^( 4) =       0.001560030964
  error estimate for blocks of size 2^( 5) =       0.001589342440
  error estimate for blocks of size 2^( 6) =       0.001605300844
  error estimate for blocks of size 2^( 7) =       0.001609388150

      target function =                  N/A
              le_mean =     -22.324522225969
             les_mean =     502.176681643496
             stat err =       0.001591015599
             autocorr =       1.317118695572
              std dev =       1.960577106317
             le_variance =       3.843862589816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844481020966
                                         uncertainty =       0.054108091581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.844481020966
                                         uncertainty =       0.054108091581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386315186
  error estimate for blocks of size 2^( 2) =       0.001456521000
  error estimate for blocks of size 2^( 3) =       0.001519989311
  error estimate for blocks of size 2^( 4) =       0.001560030964
  error estimate for blocks of size 2^( 5) =       0.001589342440
  error estimate for blocks of size 2^( 6) =       0.001605300844
  error estimate for blocks of size 2^( 7) =       0.001609388150

      target function =                  N/A
              le_mean =     -22.324522225969
             les_mean =     502.176681643496
             stat err =       0.001591015599
             autocorr =       1.317118695572
              std dev =       1.960577106317
             le_variance =       3.843862589816


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.324522225969        initial  <--
     2.2204e+19     2.2204e+20             0.0000e+00       -22.324522225969
     8.8818e+19     8.8818e+20             0.0000e+00       -22.324522225969
     3.5527e+20     3.5527e+21             0.0000e+00       -22.324522225969

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6257
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3928e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2326e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.3368
    reference variance = 3.49924
====================================================
  Execution time = 2.3377e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0360e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7252e+00
  Total weights = 1.949908117e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9148e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776607345465
                                         uncertainty =       0.036831977065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776607345465
                                         uncertainty =       0.036831977065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374002231
  error estimate for blocks of size 2^( 2) =       0.001445371589
  error estimate for blocks of size 2^( 3) =       0.001507557899
  error estimate for blocks of size 2^( 4) =       0.001548690454
  error estimate for blocks of size 2^( 5) =       0.001572760165
  error estimate for blocks of size 2^( 6) =       0.001585729790
  error estimate for blocks of size 2^( 7) =       0.001594265659

      target function =                  N/A
              le_mean =     -22.329601421960
             les_mean =     502.336284725674
             stat err =       0.001575361517
             autocorr =       1.314575666747
              std dev =       1.943163679402
             le_variance =       3.775885084948


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232960142196e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+20, overlap shift 2.2204e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329601421177       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329601421177       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+20, overlap shift 8.8818e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329601421177       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329601421177       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+21, overlap shift 3.5527e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329601421177       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329601421177       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310993 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9298e+01
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.1476
    reference variance = 4.58296
====================================================
  Execution time = 2.2849e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2333e+01
  VMC Evar = 3.6829e+00
  Total weights = 1.9496e+06
  Execution time = 4.3043e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.735299366625
                                         uncertainty =       0.026901474687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.735299366625
                                         uncertainty =       0.026901474687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366441257
  error estimate for blocks of size 2^( 2) =       0.001437591341
  error estimate for blocks of size 2^( 3) =       0.001501287000
  error estimate for blocks of size 2^( 4) =       0.001544563433
  error estimate for blocks of size 2^( 5) =       0.001569482726
  error estimate for blocks of size 2^( 6) =       0.001586380700
  error estimate for blocks of size 2^( 7) =       0.001582755500

      target function =                  N/A
              le_mean =     -22.332783942276
             les_mean =     502.436103417789
             stat err =       0.001570795590
             autocorr =       1.321470321360
              std dev =       1.932470676947
             le_variance =       3.734442917260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.735299366625
                                         uncertainty =       0.026901474687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.735299366625
                                         uncertainty =       0.026901474687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366441257
  error estimate for blocks of size 2^( 2) =       0.001437591341
  error estimate for blocks of size 2^( 3) =       0.001501287000
  error estimate for blocks of size 2^( 4) =       0.001544563433
  error estimate for blocks of size 2^( 5) =       0.001569482726
  error estimate for blocks of size 2^( 6) =       0.001586380700
  error estimate for blocks of size 2^( 7) =       0.001582755500

      target function =                  N/A
              le_mean =     -22.332783942276
             les_mean =     502.436103417789
             stat err =       0.001570795590
             autocorr =       1.321470321360
              std dev =       1.932470676947
             le_variance =       3.734442917260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.735299366625
                                         uncertainty =       0.026901474687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.735299366625
                                         uncertainty =       0.026901474687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366441257
  error estimate for blocks of size 2^( 2) =       0.001437591341
  error estimate for blocks of size 2^( 3) =       0.001501287000
  error estimate for blocks of size 2^( 4) =       0.001544563433
  error estimate for blocks of size 2^( 5) =       0.001569482726
  error estimate for blocks of size 2^( 6) =       0.001586380700
  error estimate for blocks of size 2^( 7) =       0.001582755500

      target function =                  N/A
              le_mean =     -22.332783942276
             les_mean =     502.436103417789
             stat err =       0.001570795590
             autocorr =       1.321470321360
              std dev =       1.932470676947
             le_variance =       3.734442917260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.735299366625
                                         uncertainty =       0.026901474687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.735299366625
                                         uncertainty =       0.026901474687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366441257
  error estimate for blocks of size 2^( 2) =       0.001437591341
  error estimate for blocks of size 2^( 3) =       0.001501287000
  error estimate for blocks of size 2^( 4) =       0.001544563433
  error estimate for blocks of size 2^( 5) =       0.001569482726
  error estimate for blocks of size 2^( 6) =       0.001586380700
  error estimate for blocks of size 2^( 7) =       0.001582755500

      target function =                  N/A
              le_mean =     -22.332783942276
             les_mean =     502.436103417789
             stat err =       0.001570795590
             autocorr =       1.321470321360
              std dev =       1.932470676947
             le_variance =       3.734442917260


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.332783942276        initial  <--
     2.2204e+20     2.2204e+21             0.0000e+00       -22.332783942276
     8.8818e+20     8.8818e+21             0.0000e+00       -22.332783942276
     3.5527e+21     3.5527e+22             0.0000e+00       -22.332783942276

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5742
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3893e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2325e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.4123
    reference variance = 2.96827
====================================================
  Execution time = 2.3472e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0331e+04
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.7609e+00
  Total weights = 1.949962964e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8866e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813993142549
                                         uncertainty =       0.075364929356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813993142549
                                         uncertainty =       0.075364929356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380754799
  error estimate for blocks of size 2^( 2) =       0.001452512694
  error estimate for blocks of size 2^( 3) =       0.001514460677
  error estimate for blocks of size 2^( 4) =       0.001557473298
  error estimate for blocks of size 2^( 5) =       0.001584210816
  error estimate for blocks of size 2^( 6) =       0.001598253517
  error estimate for blocks of size 2^( 7) =       0.001607089052

      target function =                  N/A
              le_mean =     -22.330776177904
             les_mean =     502.424434321882
             stat err =       0.001586756671
             autocorr =       1.320649413579
              std dev =       1.952713405763
             le_variance =       3.813089645045


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233077617790e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+21, overlap shift 2.2204e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330776177116       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330776177116       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+21, overlap shift 8.8818e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330776177116       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330776177116       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+22, overlap shift 3.5527e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330776177116       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330776177116       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.312217 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9365e+01
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.3554
    reference variance = 2.2372
====================================================
  Execution time = 2.2868e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7986e+00
  Total weights = 1.9500e+06
  Execution time = 4.6475e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.848333527944
                                         uncertainty =       0.072359332576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.848333527944
                                         uncertainty =       0.072359332576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387028752
  error estimate for blocks of size 2^( 2) =       0.001456614105
  error estimate for blocks of size 2^( 3) =       0.001519492483
  error estimate for blocks of size 2^( 4) =       0.001561700655
  error estimate for blocks of size 2^( 5) =       0.001580297886
  error estimate for blocks of size 2^( 6) =       0.001590890297
  error estimate for blocks of size 2^( 7) =       0.001596110411

      target function =                  N/A
              le_mean =     -22.325645366616
             les_mean =     502.233042585211
             stat err =       0.001582249812
             autocorr =       1.301305238518
              std dev =       1.961586257197
             le_variance =       3.847820644424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.848333527944
                                         uncertainty =       0.072359332576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.848333527944
                                         uncertainty =       0.072359332576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387028752
  error estimate for blocks of size 2^( 2) =       0.001456614105
  error estimate for blocks of size 2^( 3) =       0.001519492483
  error estimate for blocks of size 2^( 4) =       0.001561700655
  error estimate for blocks of size 2^( 5) =       0.001580297886
  error estimate for blocks of size 2^( 6) =       0.001590890297
  error estimate for blocks of size 2^( 7) =       0.001596110411

      target function =                  N/A
              le_mean =     -22.325645366616
             les_mean =     502.233042585211
             stat err =       0.001582249812
             autocorr =       1.301305238518
              std dev =       1.961586257197
             le_variance =       3.847820644424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.848333527944
                                         uncertainty =       0.072359332576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.848333527944
                                         uncertainty =       0.072359332576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387028752
  error estimate for blocks of size 2^( 2) =       0.001456614105
  error estimate for blocks of size 2^( 3) =       0.001519492483
  error estimate for blocks of size 2^( 4) =       0.001561700655
  error estimate for blocks of size 2^( 5) =       0.001580297886
  error estimate for blocks of size 2^( 6) =       0.001590890297
  error estimate for blocks of size 2^( 7) =       0.001596110411

      target function =                  N/A
              le_mean =     -22.325645366616
             les_mean =     502.233042585211
             stat err =       0.001582249812
             autocorr =       1.301305238518
              std dev =       1.961586257197
             le_variance =       3.847820644424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.848333527944
                                         uncertainty =       0.072359332576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.848333527944
                                         uncertainty =       0.072359332576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387028752
  error estimate for blocks of size 2^( 2) =       0.001456614105
  error estimate for blocks of size 2^( 3) =       0.001519492483
  error estimate for blocks of size 2^( 4) =       0.001561700655
  error estimate for blocks of size 2^( 5) =       0.001580297886
  error estimate for blocks of size 2^( 6) =       0.001590890297
  error estimate for blocks of size 2^( 7) =       0.001596110411

      target function =                  N/A
              le_mean =     -22.325645366616
             les_mean =     502.233042585211
             stat err =       0.001582249812
             autocorr =       1.301305238518
              std dev =       1.961586257197
             le_variance =       3.847820644424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325645366616        initial  <--
     2.2204e+21     2.2204e+22             0.0000e+00       -22.325645366616
     8.8818e+21     8.8818e+22             0.0000e+00       -22.325645366616
     3.5527e+22     3.5527e+23             0.0000e+00       -22.325645366616

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5624
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4935e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2326e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.0816
    reference variance = 6.86275
====================================================
  Execution time = 2.3366e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0289e+04
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.6900e+00
  Total weights = 1.950066783e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8932e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741242639435
                                         uncertainty =       0.025406408637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741242639435
                                         uncertainty =       0.025406408637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367810762
  error estimate for blocks of size 2^( 2) =       0.001438618110
  error estimate for blocks of size 2^( 3) =       0.001502742537
  error estimate for blocks of size 2^( 4) =       0.001547011612
  error estimate for blocks of size 2^( 5) =       0.001572664545
  error estimate for blocks of size 2^( 6) =       0.001588736684
  error estimate for blocks of size 2^( 7) =       0.001599507756

      target function =                  N/A
              le_mean =     -22.324993807830
             les_mean =     502.095368912690
             stat err =       0.001576980149
             autocorr =       1.329230873825
              std dev =       1.934407480445
             le_variance =       3.741932300401


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232499380783e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+22, overlap shift 2.2204e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324993807053       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324993807053       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324993807053       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+22 is 2.956013e-26

solving harmonic davidson linear method for identity shift 8.8818e+22, overlap shift 8.8818e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324993807053       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324993807053       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324993807053       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+22 is 7.390032e-27

solving harmonic davidson linear method for identity shift 3.5527e+23, overlap shift 3.5527e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324993807053       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324993807053       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324993807053       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+23 is 1.847508e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.313758 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9266e+01
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.4719
    reference variance = 2.5954
====================================================
  Execution time = 2.2819e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.6858e+00
  Total weights = 1.9496e+06
  Execution time = 4.3294e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737442086488
                                         uncertainty =       0.027102394743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737442086488
                                         uncertainty =       0.027102394743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366838437
  error estimate for blocks of size 2^( 2) =       0.001439070987
  error estimate for blocks of size 2^( 3) =       0.001502717850
  error estimate for blocks of size 2^( 4) =       0.001543789569
  error estimate for blocks of size 2^( 5) =       0.001568271679
  error estimate for blocks of size 2^( 6) =       0.001583032965
  error estimate for blocks of size 2^( 7) =       0.001587000329

      target function =                  N/A
              le_mean =     -22.326079367073
             les_mean =     502.139581623026
             stat err =       0.001570523635
             autocorr =       1.320245168952
              std dev =       1.933032382926
             le_variance =       3.736614193442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737442086488
                                         uncertainty =       0.027102394743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737442086488
                                         uncertainty =       0.027102394743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366838437
  error estimate for blocks of size 2^( 2) =       0.001439070987
  error estimate for blocks of size 2^( 3) =       0.001502717850
  error estimate for blocks of size 2^( 4) =       0.001543789569
  error estimate for blocks of size 2^( 5) =       0.001568271679
  error estimate for blocks of size 2^( 6) =       0.001583032965
  error estimate for blocks of size 2^( 7) =       0.001587000329

      target function =                  N/A
              le_mean =     -22.326079367073
             les_mean =     502.139581623026
             stat err =       0.001570523635
             autocorr =       1.320245168952
              std dev =       1.933032382926
             le_variance =       3.736614193442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737442086488
                                         uncertainty =       0.027102394743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737442086488
                                         uncertainty =       0.027102394743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366838437
  error estimate for blocks of size 2^( 2) =       0.001439070987
  error estimate for blocks of size 2^( 3) =       0.001502717850
  error estimate for blocks of size 2^( 4) =       0.001543789569
  error estimate for blocks of size 2^( 5) =       0.001568271679
  error estimate for blocks of size 2^( 6) =       0.001583032965
  error estimate for blocks of size 2^( 7) =       0.001587000329

      target function =                  N/A
              le_mean =     -22.326079367073
             les_mean =     502.139581623026
             stat err =       0.001570523635
             autocorr =       1.320245168952
              std dev =       1.933032382926
             le_variance =       3.736614193442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737442086488
                                         uncertainty =       0.027102394743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737442086488
                                         uncertainty =       0.027102394743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366838437
  error estimate for blocks of size 2^( 2) =       0.001439070987
  error estimate for blocks of size 2^( 3) =       0.001502717850
  error estimate for blocks of size 2^( 4) =       0.001543789569
  error estimate for blocks of size 2^( 5) =       0.001568271679
  error estimate for blocks of size 2^( 6) =       0.001583032965
  error estimate for blocks of size 2^( 7) =       0.001587000329

      target function =                  N/A
              le_mean =     -22.326079367073
             les_mean =     502.139581623026
             stat err =       0.001570523635
             autocorr =       1.320245168952
              std dev =       1.933032382926
             le_variance =       3.736614193442


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326079367073        initial  <--
     2.2204e+22     2.2204e+23             2.9560e-26       -22.326079367073
     8.8818e+22     8.8818e+23             7.3900e-27       -22.326079367073
     3.5527e+23     3.5527e+24             1.8475e-27       -22.326079367073

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6327
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3912e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2325e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -21.6471
    reference variance = 7.00412
====================================================
  Execution time = 2.3388e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0295e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6878e+00
  Total weights = 1.949961477e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8566e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.740592288256
                                         uncertainty =       0.033189122182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.740592288256
                                         uncertainty =       0.033189122182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367353272
  error estimate for blocks of size 2^( 2) =       0.001438656144
  error estimate for blocks of size 2^( 3) =       0.001500473568
  error estimate for blocks of size 2^( 4) =       0.001542761777
  error estimate for blocks of size 2^( 5) =       0.001569632021
  error estimate for blocks of size 2^( 6) =       0.001582330112
  error estimate for blocks of size 2^( 7) =       0.001590130297

      target function =                  N/A
              le_mean =     -22.329925609085
             les_mean =     502.313348671539
             stat err =       0.001571213552
             autocorr =       1.320410483887
              std dev =       1.933760481622
             le_variance =       3.739429600283


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232992560909e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+23, overlap shift 2.2204e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329925608268       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329925608268       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+23, overlap shift 8.8818e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329925608268       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329925608268       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+24, overlap shift 3.5527e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329925608268       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329925608268       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.315009 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9252e+01
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.2958
    reference variance = 2.83676
====================================================
  Execution time = 2.2844e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7865e+00
  Total weights = 1.9499e+06
  Execution time = 4.3300e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841138819017
                                         uncertainty =       0.062066716608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841138819017
                                         uncertainty =       0.062066716608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385742001
  error estimate for blocks of size 2^( 2) =       0.001455412421
  error estimate for blocks of size 2^( 3) =       0.001516639138
  error estimate for blocks of size 2^( 4) =       0.001559202442
  error estimate for blocks of size 2^( 5) =       0.001586166165
  error estimate for blocks of size 2^( 6) =       0.001604061540
  error estimate for blocks of size 2^( 7) =       0.001610379429

      target function =                  N/A
              le_mean =     -22.328346391721
             les_mean =     502.341545920295
             stat err =       0.001589952394
             autocorr =       1.316447308997
              std dev =       1.959766487715
             le_variance =       3.840684686372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841138819017
                                         uncertainty =       0.062066716608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841138819017
                                         uncertainty =       0.062066716608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385742001
  error estimate for blocks of size 2^( 2) =       0.001455412421
  error estimate for blocks of size 2^( 3) =       0.001516639138
  error estimate for blocks of size 2^( 4) =       0.001559202442
  error estimate for blocks of size 2^( 5) =       0.001586166165
  error estimate for blocks of size 2^( 6) =       0.001604061540
  error estimate for blocks of size 2^( 7) =       0.001610379429

      target function =                  N/A
              le_mean =     -22.328346391721
             les_mean =     502.341545920295
             stat err =       0.001589952394
             autocorr =       1.316447308997
              std dev =       1.959766487715
             le_variance =       3.840684686372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841138819017
                                         uncertainty =       0.062066716608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841138819017
                                         uncertainty =       0.062066716608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385742001
  error estimate for blocks of size 2^( 2) =       0.001455412421
  error estimate for blocks of size 2^( 3) =       0.001516639138
  error estimate for blocks of size 2^( 4) =       0.001559202442
  error estimate for blocks of size 2^( 5) =       0.001586166165
  error estimate for blocks of size 2^( 6) =       0.001604061540
  error estimate for blocks of size 2^( 7) =       0.001610379429

      target function =                  N/A
              le_mean =     -22.328346391721
             les_mean =     502.341545920295
             stat err =       0.001589952394
             autocorr =       1.316447308997
              std dev =       1.959766487715
             le_variance =       3.840684686372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841138819017
                                         uncertainty =       0.062066716608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841138819017
                                         uncertainty =       0.062066716608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385742001
  error estimate for blocks of size 2^( 2) =       0.001455412421
  error estimate for blocks of size 2^( 3) =       0.001516639138
  error estimate for blocks of size 2^( 4) =       0.001559202442
  error estimate for blocks of size 2^( 5) =       0.001586166165
  error estimate for blocks of size 2^( 6) =       0.001604061540
  error estimate for blocks of size 2^( 7) =       0.001610379429

      target function =                  N/A
              le_mean =     -22.328346391721
             les_mean =     502.341545920295
             stat err =       0.001589952394
             autocorr =       1.316447308997
              std dev =       1.959766487715
             le_variance =       3.840684686372


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328346391721        initial  <--
     2.2204e+23     2.2204e+24             0.0000e+00       -22.328346391721
     8.8818e+23     8.8818e+24             0.0000e+00       -22.328346391721
     3.5527e+24     3.5527e+25             0.0000e+00       -22.328346391721

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6296
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3892e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2321e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.3833
    reference variance = 2.86555
====================================================
  Execution time = 2.3362e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0295e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6561e+00
  Total weights = 1.949507935e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8335e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.705701746247
                                         uncertainty =       0.023694360330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.705701746247
                                         uncertainty =       0.023694360330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001361441606
  error estimate for blocks of size 2^( 2) =       0.001431776131
  error estimate for blocks of size 2^( 3) =       0.001493804431
  error estimate for blocks of size 2^( 4) =       0.001537862608
  error estimate for blocks of size 2^( 5) =       0.001564712799
  error estimate for blocks of size 2^( 6) =       0.001579000839
  error estimate for blocks of size 2^( 7) =       0.001587774281

      target function =                  N/A
              le_mean =     -22.330098771935
             les_mean =     502.289416121511
             stat err =       0.001567337632
             autocorr =       1.325339328007
              std dev =       1.925399988538
             le_variance =       3.707165115861


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233009877194e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+24, overlap shift 2.2204e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330098771090       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330098771090       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+24, overlap shift 8.8818e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330098771090       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330098771090       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+25, overlap shift 3.5527e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330098771090       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330098771090       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.316210 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9202e+01
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.343
    reference variance = 3.56868
====================================================
  Execution time = 2.2832e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6616e+00
  Total weights = 1.9497e+06
  Execution time = 4.3370e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.710437598791
                                         uncertainty =       0.026851232030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.710437598791
                                         uncertainty =       0.026851232030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362090483
  error estimate for blocks of size 2^( 2) =       0.001432527667
  error estimate for blocks of size 2^( 3) =       0.001495773509
  error estimate for blocks of size 2^( 4) =       0.001538190991
  error estimate for blocks of size 2^( 5) =       0.001562089787
  error estimate for blocks of size 2^( 6) =       0.001577151341
  error estimate for blocks of size 2^( 7) =       0.001580964937

      target function =                  N/A
              le_mean =     -22.328938849431
             les_mean =     502.243133477387
             stat err =       0.001564599264
             autocorr =       1.319454219205
              std dev =       1.926317654449
             le_variance =       3.710699705843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.710437598791
                                         uncertainty =       0.026851232030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.710437598791
                                         uncertainty =       0.026851232030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362090483
  error estimate for blocks of size 2^( 2) =       0.001432527667
  error estimate for blocks of size 2^( 3) =       0.001495773509
  error estimate for blocks of size 2^( 4) =       0.001538190991
  error estimate for blocks of size 2^( 5) =       0.001562089787
  error estimate for blocks of size 2^( 6) =       0.001577151341
  error estimate for blocks of size 2^( 7) =       0.001580964937

      target function =                  N/A
              le_mean =     -22.328938849431
             les_mean =     502.243133477387
             stat err =       0.001564599264
             autocorr =       1.319454219205
              std dev =       1.926317654449
             le_variance =       3.710699705843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.710437598791
                                         uncertainty =       0.026851232030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.710437598791
                                         uncertainty =       0.026851232030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362090483
  error estimate for blocks of size 2^( 2) =       0.001432527667
  error estimate for blocks of size 2^( 3) =       0.001495773509
  error estimate for blocks of size 2^( 4) =       0.001538190991
  error estimate for blocks of size 2^( 5) =       0.001562089787
  error estimate for blocks of size 2^( 6) =       0.001577151341
  error estimate for blocks of size 2^( 7) =       0.001580964937

      target function =                  N/A
              le_mean =     -22.328938849431
             les_mean =     502.243133477387
             stat err =       0.001564599264
             autocorr =       1.319454219205
              std dev =       1.926317654449
             le_variance =       3.710699705843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.710437598791
                                         uncertainty =       0.026851232030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.710437598791
                                         uncertainty =       0.026851232030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362090483
  error estimate for blocks of size 2^( 2) =       0.001432527667
  error estimate for blocks of size 2^( 3) =       0.001495773509
  error estimate for blocks of size 2^( 4) =       0.001538190991
  error estimate for blocks of size 2^( 5) =       0.001562089787
  error estimate for blocks of size 2^( 6) =       0.001577151341
  error estimate for blocks of size 2^( 7) =       0.001580964937

      target function =                  N/A
              le_mean =     -22.328938849431
             les_mean =     502.243133477387
             stat err =       0.001564599264
             autocorr =       1.319454219205
              std dev =       1.926317654449
             le_variance =       3.710699705843


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328938849431        initial  <--
     2.2204e+24     2.2204e+25             0.0000e+00       -22.328938849431
     8.8818e+24     8.8818e+25             0.0000e+00       -22.328938849431
     3.5527e+25     3.5527e+26             0.0000e+00       -22.328938849431

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6238
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3835e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2321e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.2827
    reference variance = 2.72238
====================================================
  Execution time = 2.3359e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0326e+04
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7471e+00
  Total weights = 1.949819442e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8287e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.799308707553
                                         uncertainty =       0.039946595670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.799308707553
                                         uncertainty =       0.039946595670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378255572
  error estimate for blocks of size 2^( 2) =       0.001448893238
  error estimate for blocks of size 2^( 3) =       0.001511146048
  error estimate for blocks of size 2^( 4) =       0.001552341509
  error estimate for blocks of size 2^( 5) =       0.001576230976
  error estimate for blocks of size 2^( 6) =       0.001583579194
  error estimate for blocks of size 2^( 7) =       0.001590991130

      target function =                  N/A
              le_mean =     -22.325331887427
             les_mean =     502.167503874262
             stat err =       0.001575785702
             autocorr =       1.307178203020
              std dev =       1.949178908565
             le_variance =       3.799298417596


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232533188743e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+25, overlap shift 2.2204e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325331886635       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325331886635       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+25, overlap shift 8.8818e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325331886635       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325331886635       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+26, overlap shift 3.5527e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325331886635       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325331886635       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.317428 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9195e+01
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.3638
    reference variance = 2.47017
====================================================
  Execution time = 2.2864e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7391e+00
  Total weights = 1.9498e+06
  Execution time = 4.3303e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792062815774
                                         uncertainty =       0.029704569824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792062815774
                                         uncertainty =       0.029704569824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376737145
  error estimate for blocks of size 2^( 2) =       0.001446100598
  error estimate for blocks of size 2^( 3) =       0.001507842420
  error estimate for blocks of size 2^( 4) =       0.001550448561
  error estimate for blocks of size 2^( 5) =       0.001576520269
  error estimate for blocks of size 2^( 6) =       0.001592759595
  error estimate for blocks of size 2^( 7) =       0.001603168522

      target function =                  N/A
              le_mean =     -22.326837218442
             les_mean =     502.226748067177
             stat err =       0.001580724237
             autocorr =       1.318287592476
              std dev =       1.947031493713
             le_variance =       3.790931637511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792062815774
                                         uncertainty =       0.029704569824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792062815774
                                         uncertainty =       0.029704569824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376737145
  error estimate for blocks of size 2^( 2) =       0.001446100598
  error estimate for blocks of size 2^( 3) =       0.001507842420
  error estimate for blocks of size 2^( 4) =       0.001550448561
  error estimate for blocks of size 2^( 5) =       0.001576520269
  error estimate for blocks of size 2^( 6) =       0.001592759595
  error estimate for blocks of size 2^( 7) =       0.001603168522

      target function =                  N/A
              le_mean =     -22.326837218442
             les_mean =     502.226748067177
             stat err =       0.001580724237
             autocorr =       1.318287592476
              std dev =       1.947031493713
             le_variance =       3.790931637511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792062815774
                                         uncertainty =       0.029704569824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792062815774
                                         uncertainty =       0.029704569824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376737145
  error estimate for blocks of size 2^( 2) =       0.001446100598
  error estimate for blocks of size 2^( 3) =       0.001507842420
  error estimate for blocks of size 2^( 4) =       0.001550448561
  error estimate for blocks of size 2^( 5) =       0.001576520269
  error estimate for blocks of size 2^( 6) =       0.001592759595
  error estimate for blocks of size 2^( 7) =       0.001603168522

      target function =                  N/A
              le_mean =     -22.326837218442
             les_mean =     502.226748067177
             stat err =       0.001580724237
             autocorr =       1.318287592476
              std dev =       1.947031493713
             le_variance =       3.790931637511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792062815774
                                         uncertainty =       0.029704569824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792062815774
                                         uncertainty =       0.029704569824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376737145
  error estimate for blocks of size 2^( 2) =       0.001446100598
  error estimate for blocks of size 2^( 3) =       0.001507842420
  error estimate for blocks of size 2^( 4) =       0.001550448561
  error estimate for blocks of size 2^( 5) =       0.001576520269
  error estimate for blocks of size 2^( 6) =       0.001592759595
  error estimate for blocks of size 2^( 7) =       0.001603168522

      target function =                  N/A
              le_mean =     -22.326837218442
             les_mean =     502.226748067177
             stat err =       0.001580724237
             autocorr =       1.318287592476
              std dev =       1.947031493713
             le_variance =       3.790931637511


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326837218442        initial  <--
     2.2204e+25     2.2204e+26             0.0000e+00       -22.326837218442
     8.8818e+25     8.8818e+26             0.0000e+00       -22.326837218442
     3.5527e+26     3.5527e+27             0.0000e+00       -22.326837218442

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.9070
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7111e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2321e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.4353
    reference variance = 2.60513
====================================================
  Execution time = 2.3428e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0298e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7279e+00
  Total weights = 1.949951456e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7832e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778627820077
                                         uncertainty =       0.033604690361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778627820077
                                         uncertainty =       0.033604690361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374260893
  error estimate for blocks of size 2^( 2) =       0.001445051467
  error estimate for blocks of size 2^( 3) =       0.001507538509
  error estimate for blocks of size 2^( 4) =       0.001551153442
  error estimate for blocks of size 2^( 5) =       0.001578857582
  error estimate for blocks of size 2^( 6) =       0.001592341135
  error estimate for blocks of size 2^( 7) =       0.001588494670

      target function =                  N/A
              le_mean =     -22.325877563404
             les_mean =     502.172732612292
             stat err =       0.001577711707
             autocorr =       1.318004582243
              std dev =       1.943529489115
             le_variance =       3.777306875061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232587756340e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+26, overlap shift 2.2204e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325877562585       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325877562585       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+26, overlap shift 8.8818e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325877562585       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325877562585       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+27, overlap shift 3.5527e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325877562585       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325877562585       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.318630 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9218e+01
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.623
    reference variance = 1.72366
====================================================
  Execution time = 2.2924e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7091e+00
  Total weights = 1.9499e+06
  Execution time = 4.3194e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760960486828
                                         uncertainty =       0.033710127666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760960486828
                                         uncertainty =       0.033710127666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371366950
  error estimate for blocks of size 2^( 2) =       0.001442023384
  error estimate for blocks of size 2^( 3) =       0.001502490590
  error estimate for blocks of size 2^( 4) =       0.001545577837
  error estimate for blocks of size 2^( 5) =       0.001574115826
  error estimate for blocks of size 2^( 6) =       0.001581300930
  error estimate for blocks of size 2^( 7) =       0.001591168649

      target function =                  N/A
              le_mean =     -22.326855177283
             les_mean =     502.197564573451
             stat err =       0.001573040811
             autocorr =       1.315747708280
              std dev =       1.939436770576
             le_variance =       3.761414987064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760960486828
                                         uncertainty =       0.033710127666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760960486828
                                         uncertainty =       0.033710127666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371366950
  error estimate for blocks of size 2^( 2) =       0.001442023384
  error estimate for blocks of size 2^( 3) =       0.001502490590
  error estimate for blocks of size 2^( 4) =       0.001545577837
  error estimate for blocks of size 2^( 5) =       0.001574115826
  error estimate for blocks of size 2^( 6) =       0.001581300930
  error estimate for blocks of size 2^( 7) =       0.001591168649

      target function =                  N/A
              le_mean =     -22.326855177283
             les_mean =     502.197564573451
             stat err =       0.001573040811
             autocorr =       1.315747708280
              std dev =       1.939436770576
             le_variance =       3.761414987064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760960486828
                                         uncertainty =       0.033710127666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760960486828
                                         uncertainty =       0.033710127666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371366950
  error estimate for blocks of size 2^( 2) =       0.001442023384
  error estimate for blocks of size 2^( 3) =       0.001502490590
  error estimate for blocks of size 2^( 4) =       0.001545577837
  error estimate for blocks of size 2^( 5) =       0.001574115826
  error estimate for blocks of size 2^( 6) =       0.001581300930
  error estimate for blocks of size 2^( 7) =       0.001591168649

      target function =                  N/A
              le_mean =     -22.326855177283
             les_mean =     502.197564573451
             stat err =       0.001573040811
             autocorr =       1.315747708280
              std dev =       1.939436770576
             le_variance =       3.761414987064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760960486828
                                         uncertainty =       0.033710127666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760960486828
                                         uncertainty =       0.033710127666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371366950
  error estimate for blocks of size 2^( 2) =       0.001442023384
  error estimate for blocks of size 2^( 3) =       0.001502490590
  error estimate for blocks of size 2^( 4) =       0.001545577837
  error estimate for blocks of size 2^( 5) =       0.001574115826
  error estimate for blocks of size 2^( 6) =       0.001581300930
  error estimate for blocks of size 2^( 7) =       0.001591168649

      target function =                  N/A
              le_mean =     -22.326855177283
             les_mean =     502.197564573451
             stat err =       0.001573040811
             autocorr =       1.315747708280
              std dev =       1.939436770576
             le_variance =       3.761414987064


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326855177283        initial  <--
     2.2204e+26     2.2204e+27             0.0000e+00       -22.326855177283
     8.8818e+26     8.8818e+27             0.0000e+00       -22.326855177283
     3.5527e+27     3.5527e+28             0.0000e+00       -22.326855177283

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7219
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3949e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2324e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.472
    reference variance = 1.72164
====================================================
  Execution time = 2.3453e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0296e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7180e+00
  Total weights = 1.949948427e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8356e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.769011670640
                                         uncertainty =       0.031431752595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.769011670640
                                         uncertainty =       0.031431752595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372705124
  error estimate for blocks of size 2^( 2) =       0.001444423889
  error estimate for blocks of size 2^( 3) =       0.001507325455
  error estimate for blocks of size 2^( 4) =       0.001548982633
  error estimate for blocks of size 2^( 5) =       0.001572298260
  error estimate for blocks of size 2^( 6) =       0.001584588526
  error estimate for blocks of size 2^( 7) =       0.001593911434

      target function =                  N/A
              le_mean =     -22.328906822404
             les_mean =     502.298069930427
             stat err =       0.001574945213
             autocorr =       1.316365198517
              std dev =       1.941329264161
             le_variance =       3.768759311889


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232890682240e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+27, overlap shift 2.2204e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328906821617       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328906821617       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328906821617       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+27 is 1.942170e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+27, overlap shift 8.8818e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328906821617       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328906821617       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328906821617       residual = 2.81e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+27 is 4.909886e-32

solving harmonic davidson linear method for identity shift 3.5527e+28, overlap shift 3.5527e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328906821617       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328906821617       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328906821617       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+28 is 1.213856e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.320074 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9296e+01
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.1216
    reference variance = 7.27864
====================================================
  Execution time = 2.2890e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7971e+00
  Total weights = 1.9499e+06
  Execution time = 4.3214e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.852436775551
                                         uncertainty =       0.047030687878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.852436775551
                                         uncertainty =       0.047030687878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387651662
  error estimate for blocks of size 2^( 2) =       0.001456738888
  error estimate for blocks of size 2^( 3) =       0.001519882354
  error estimate for blocks of size 2^( 4) =       0.001561827537
  error estimate for blocks of size 2^( 5) =       0.001591638520
  error estimate for blocks of size 2^( 6) =       0.001607781423
  error estimate for blocks of size 2^( 7) =       0.001614853183

      target function =                  N/A
              le_mean =     -22.327548507559
             les_mean =     502.316521149779
             stat err =       0.001594025166
             autocorr =       1.319560864108
              std dev =       1.962467199175
             le_variance =       3.851277507838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.852436775551
                                         uncertainty =       0.047030687878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.852436775551
                                         uncertainty =       0.047030687878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387651662
  error estimate for blocks of size 2^( 2) =       0.001456738888
  error estimate for blocks of size 2^( 3) =       0.001519882354
  error estimate for blocks of size 2^( 4) =       0.001561827537
  error estimate for blocks of size 2^( 5) =       0.001591638520
  error estimate for blocks of size 2^( 6) =       0.001607781423
  error estimate for blocks of size 2^( 7) =       0.001614853183

      target function =                  N/A
              le_mean =     -22.327548507559
             les_mean =     502.316521149779
             stat err =       0.001594025166
             autocorr =       1.319560864108
              std dev =       1.962467199175
             le_variance =       3.851277507838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.852436775551
                                         uncertainty =       0.047030687878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.852436775551
                                         uncertainty =       0.047030687878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387651662
  error estimate for blocks of size 2^( 2) =       0.001456738888
  error estimate for blocks of size 2^( 3) =       0.001519882354
  error estimate for blocks of size 2^( 4) =       0.001561827537
  error estimate for blocks of size 2^( 5) =       0.001591638520
  error estimate for blocks of size 2^( 6) =       0.001607781423
  error estimate for blocks of size 2^( 7) =       0.001614853183

      target function =                  N/A
              le_mean =     -22.327548507559
             les_mean =     502.316521149779
             stat err =       0.001594025166
             autocorr =       1.319560864108
              std dev =       1.962467199175
             le_variance =       3.851277507838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.852436775551
                                         uncertainty =       0.047030687878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.852436775551
                                         uncertainty =       0.047030687878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387651662
  error estimate for blocks of size 2^( 2) =       0.001456738888
  error estimate for blocks of size 2^( 3) =       0.001519882354
  error estimate for blocks of size 2^( 4) =       0.001561827537
  error estimate for blocks of size 2^( 5) =       0.001591638520
  error estimate for blocks of size 2^( 6) =       0.001607781423
  error estimate for blocks of size 2^( 7) =       0.001614853183

      target function =                  N/A
              le_mean =     -22.327548507559
             les_mean =     502.316521149779
             stat err =       0.001594025166
             autocorr =       1.319560864108
              std dev =       1.962467199175
             le_variance =       3.851277507838


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327548507559        initial  <--
     2.2204e+27     2.2204e+28             1.9422e-31       -22.327548507559
     8.8818e+27     8.8818e+28             4.9099e-32       -22.327548507559
     3.5527e+28     3.5527e+29             1.2139e-32       -22.327548507559

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7072
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4012e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2323e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -21.9304
    reference variance = 11.2697
====================================================
  Execution time = 3.0952e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0272e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7175e+00
  Total weights = 1.949999055e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8007e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.769326515752
                                         uncertainty =       0.039220962078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.769326515752
                                         uncertainty =       0.039220962078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372707794
  error estimate for blocks of size 2^( 2) =       0.001442943338
  error estimate for blocks of size 2^( 3) =       0.001505348487
  error estimate for blocks of size 2^( 4) =       0.001553599811
  error estimate for blocks of size 2^( 5) =       0.001578118691
  error estimate for blocks of size 2^( 6) =       0.001590621594
  error estimate for blocks of size 2^( 7) =       0.001597321710

      target function =                  N/A
              le_mean =     -22.330125945065
             les_mean =     502.351989472320
             stat err =       0.001579915451
             autocorr =       1.324681569957
              std dev =       1.941333039472
             le_variance =       3.768773970145


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233012594506e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+28, overlap shift 2.2204e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330125944251       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330125944251       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+28, overlap shift 8.8818e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330125944251       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330125944251       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+29, overlap shift 3.5527e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330125944251       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330125944251       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.321296 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6760e+01
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.5261
    reference variance = 2.37773
====================================================
  Execution time = 2.2870e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7315e+00
  Total weights = 1.9500e+06
  Execution time = 4.3253e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784089881124
                                         uncertainty =       0.033398938714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784089881124
                                         uncertainty =       0.033398938714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375475733
  error estimate for blocks of size 2^( 2) =       0.001447332063
  error estimate for blocks of size 2^( 3) =       0.001510016163
  error estimate for blocks of size 2^( 4) =       0.001553334785
  error estimate for blocks of size 2^( 5) =       0.001577877519
  error estimate for blocks of size 2^( 6) =       0.001584663284
  error estimate for blocks of size 2^( 7) =       0.001589090306

      target function =                  N/A
              le_mean =     -22.326432664150
             les_mean =     502.201051634097
             stat err =       0.001576241473
             autocorr =       1.313226492066
              std dev =       1.945247559443
             le_variance =       3.783988067519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784089881124
                                         uncertainty =       0.033398938714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784089881124
                                         uncertainty =       0.033398938714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375475733
  error estimate for blocks of size 2^( 2) =       0.001447332063
  error estimate for blocks of size 2^( 3) =       0.001510016163
  error estimate for blocks of size 2^( 4) =       0.001553334785
  error estimate for blocks of size 2^( 5) =       0.001577877519
  error estimate for blocks of size 2^( 6) =       0.001584663284
  error estimate for blocks of size 2^( 7) =       0.001589090306

      target function =                  N/A
              le_mean =     -22.326432664150
             les_mean =     502.201051634097
             stat err =       0.001576241473
             autocorr =       1.313226492066
              std dev =       1.945247559443
             le_variance =       3.783988067519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784089881124
                                         uncertainty =       0.033398938714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784089881124
                                         uncertainty =       0.033398938714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375475733
  error estimate for blocks of size 2^( 2) =       0.001447332063
  error estimate for blocks of size 2^( 3) =       0.001510016163
  error estimate for blocks of size 2^( 4) =       0.001553334785
  error estimate for blocks of size 2^( 5) =       0.001577877519
  error estimate for blocks of size 2^( 6) =       0.001584663284
  error estimate for blocks of size 2^( 7) =       0.001589090306

      target function =                  N/A
              le_mean =     -22.326432664150
             les_mean =     502.201051634097
             stat err =       0.001576241473
             autocorr =       1.313226492066
              std dev =       1.945247559443
             le_variance =       3.783988067519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784089881124
                                         uncertainty =       0.033398938714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784089881124
                                         uncertainty =       0.033398938714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375475733
  error estimate for blocks of size 2^( 2) =       0.001447332063
  error estimate for blocks of size 2^( 3) =       0.001510016163
  error estimate for blocks of size 2^( 4) =       0.001553334785
  error estimate for blocks of size 2^( 5) =       0.001577877519
  error estimate for blocks of size 2^( 6) =       0.001584663284
  error estimate for blocks of size 2^( 7) =       0.001589090306

      target function =                  N/A
              le_mean =     -22.326432664150
             les_mean =     502.201051634097
             stat err =       0.001576241473
             autocorr =       1.313226492066
              std dev =       1.945247559443
             le_variance =       3.783988067519


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326432664150        initial  <--
     2.2204e+28     2.2204e+29             0.0000e+00       -22.326432664150
     8.8818e+28     8.8818e+29             0.0000e+00       -22.326432664150
     3.5527e+29     3.5527e+30             0.0000e+00       -22.326432664150

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6857
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1463e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2322e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -21.9905
    reference variance = 3.39527
====================================================
  Execution time = 2.3401e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0329e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7068e+00
  Total weights = 1.949794095e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8026e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757331423787
                                         uncertainty =       0.024657564878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757331423787
                                         uncertainty =       0.024657564878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370559685
  error estimate for blocks of size 2^( 2) =       0.001441506710
  error estimate for blocks of size 2^( 3) =       0.001505123325
  error estimate for blocks of size 2^( 4) =       0.001550349197
  error estimate for blocks of size 2^( 5) =       0.001571543480
  error estimate for blocks of size 2^( 6) =       0.001583635792
  error estimate for blocks of size 2^( 7) =       0.001589187820

      target function =                  N/A
              le_mean =     -22.327566319870
             les_mean =     502.227035742172
             stat err =       0.001573679072
             autocorr =       1.318367331528
              std dev =       1.938295106395
             le_variance =       3.756987919477


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232756631987e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+29, overlap shift 2.2204e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327566319039       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327566319039       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327566319039       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+29 is 2.572930e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+29, overlap shift 8.8818e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327566319039       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327566319039       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327566319039       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+29 is 6.432324e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+30, overlap shift 3.5527e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327566319039       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327566319039       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327566319039       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+30 is 1.608081e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.322825 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9211e+01
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.4444
    reference variance = 2.63898
====================================================
  Execution time = 2.2880e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7273e+00
  Total weights = 1.9499e+06
  Execution time = 4.9109e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775238422709
                                         uncertainty =       0.036772226001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775238422709
                                         uncertainty =       0.036772226001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374059062
  error estimate for blocks of size 2^( 2) =       0.001444524781
  error estimate for blocks of size 2^( 3) =       0.001506920632
  error estimate for blocks of size 2^( 4) =       0.001548869925
  error estimate for blocks of size 2^( 5) =       0.001572253103
  error estimate for blocks of size 2^( 6) =       0.001583029054
  error estimate for blocks of size 2^( 7) =       0.001586268688

      target function =                  N/A
              le_mean =     -22.329490769852
             les_mean =     502.333496756460
             stat err =       0.001572605192
             autocorr =       1.309871248419
              std dev =       1.943244051598
             le_variance =       3.776197444072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775238422709
                                         uncertainty =       0.036772226001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775238422709
                                         uncertainty =       0.036772226001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374059062
  error estimate for blocks of size 2^( 2) =       0.001444524781
  error estimate for blocks of size 2^( 3) =       0.001506920632
  error estimate for blocks of size 2^( 4) =       0.001548869925
  error estimate for blocks of size 2^( 5) =       0.001572253103
  error estimate for blocks of size 2^( 6) =       0.001583029054
  error estimate for blocks of size 2^( 7) =       0.001586268688

      target function =                  N/A
              le_mean =     -22.329490769852
             les_mean =     502.333496756460
             stat err =       0.001572605192
             autocorr =       1.309871248419
              std dev =       1.943244051598
             le_variance =       3.776197444072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775238422709
                                         uncertainty =       0.036772226001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775238422709
                                         uncertainty =       0.036772226001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374059062
  error estimate for blocks of size 2^( 2) =       0.001444524781
  error estimate for blocks of size 2^( 3) =       0.001506920632
  error estimate for blocks of size 2^( 4) =       0.001548869925
  error estimate for blocks of size 2^( 5) =       0.001572253103
  error estimate for blocks of size 2^( 6) =       0.001583029054
  error estimate for blocks of size 2^( 7) =       0.001586268688

      target function =                  N/A
              le_mean =     -22.329490769852
             les_mean =     502.333496756460
             stat err =       0.001572605192
             autocorr =       1.309871248419
              std dev =       1.943244051598
             le_variance =       3.776197444072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775238422709
                                         uncertainty =       0.036772226001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775238422709
                                         uncertainty =       0.036772226001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374059062
  error estimate for blocks of size 2^( 2) =       0.001444524781
  error estimate for blocks of size 2^( 3) =       0.001506920632
  error estimate for blocks of size 2^( 4) =       0.001548869925
  error estimate for blocks of size 2^( 5) =       0.001572253103
  error estimate for blocks of size 2^( 6) =       0.001583029054
  error estimate for blocks of size 2^( 7) =       0.001586268688

      target function =                  N/A
              le_mean =     -22.329490769852
             les_mean =     502.333496756460
             stat err =       0.001572605192
             autocorr =       1.309871248419
              std dev =       1.943244051598
             le_variance =       3.776197444072


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329490769852        initial  <--
     2.2204e+29     2.2204e+30             2.5729e-33       -22.329490769852
     8.8818e+29     8.8818e+30             6.4323e-34       -22.329490769852
     3.5527e+30     3.5527e+31             1.6081e-34       -22.329490769852

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5531
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4773e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2321e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.1617
    reference variance = 3.13639
====================================================
  Execution time = 2.3579e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0323e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7424e+00
  Total weights = 1.950140808e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8473e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793668677650
                                         uncertainty =       0.035190134928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793668677650
                                         uncertainty =       0.035190134928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377187755
  error estimate for blocks of size 2^( 2) =       0.001448928175
  error estimate for blocks of size 2^( 3) =       0.001512318060
  error estimate for blocks of size 2^( 4) =       0.001558207646
  error estimate for blocks of size 2^( 5) =       0.001582666794
  error estimate for blocks of size 2^( 6) =       0.001595817607
  error estimate for blocks of size 2^( 7) =       0.001605116573

      target function =                  N/A
              le_mean =     -22.326892714708
             les_mean =     502.232522190326
             stat err =       0.001585452155
             autocorr =       1.325317632598
              std dev =       1.947668762979
             le_variance =       3.793413610283


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232689271471e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+30, overlap shift 2.2204e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326892713849       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326892713849       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+30, overlap shift 8.8818e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326892713849       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326892713849       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+31, overlap shift 3.5527e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326892713849       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326892713849       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.324022 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9433e+01
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.3228
    reference variance = 3.79354
====================================================
  Execution time = 2.2951e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7188e+00
  Total weights = 1.9498e+06
  Execution time = 4.3452e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772435535096
                                         uncertainty =       0.035361607741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772435535096
                                         uncertainty =       0.035361607741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373287194
  error estimate for blocks of size 2^( 2) =       0.001444503993
  error estimate for blocks of size 2^( 3) =       0.001509084845
  error estimate for blocks of size 2^( 4) =       0.001551247572
  error estimate for blocks of size 2^( 5) =       0.001577116975
  error estimate for blocks of size 2^( 6) =       0.001591606901
  error estimate for blocks of size 2^( 7) =       0.001605858256

      target function =                  N/A
              le_mean =     -22.328263993406
             les_mean =     502.270164702074
             stat err =       0.001581457426
             autocorr =       1.326148838573
              std dev =       1.942152448425
             le_variance =       3.771956132922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772435535096
                                         uncertainty =       0.035361607741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772435535096
                                         uncertainty =       0.035361607741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373287194
  error estimate for blocks of size 2^( 2) =       0.001444503993
  error estimate for blocks of size 2^( 3) =       0.001509084845
  error estimate for blocks of size 2^( 4) =       0.001551247572
  error estimate for blocks of size 2^( 5) =       0.001577116975
  error estimate for blocks of size 2^( 6) =       0.001591606901
  error estimate for blocks of size 2^( 7) =       0.001605858256

      target function =                  N/A
              le_mean =     -22.328263993406
             les_mean =     502.270164702074
             stat err =       0.001581457426
             autocorr =       1.326148838573
              std dev =       1.942152448425
             le_variance =       3.771956132922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772435535096
                                         uncertainty =       0.035361607741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772435535096
                                         uncertainty =       0.035361607741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373287194
  error estimate for blocks of size 2^( 2) =       0.001444503993
  error estimate for blocks of size 2^( 3) =       0.001509084845
  error estimate for blocks of size 2^( 4) =       0.001551247572
  error estimate for blocks of size 2^( 5) =       0.001577116975
  error estimate for blocks of size 2^( 6) =       0.001591606901
  error estimate for blocks of size 2^( 7) =       0.001605858256

      target function =                  N/A
              le_mean =     -22.328263993406
             les_mean =     502.270164702074
             stat err =       0.001581457426
             autocorr =       1.326148838573
              std dev =       1.942152448425
             le_variance =       3.771956132922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772435535096
                                         uncertainty =       0.035361607741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772435535096
                                         uncertainty =       0.035361607741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373287194
  error estimate for blocks of size 2^( 2) =       0.001444503993
  error estimate for blocks of size 2^( 3) =       0.001509084845
  error estimate for blocks of size 2^( 4) =       0.001551247572
  error estimate for blocks of size 2^( 5) =       0.001577116975
  error estimate for blocks of size 2^( 6) =       0.001591606901
  error estimate for blocks of size 2^( 7) =       0.001605858256

      target function =                  N/A
              le_mean =     -22.328263993406
             les_mean =     502.270164702074
             stat err =       0.001581457426
             autocorr =       1.326148838573
              std dev =       1.942152448425
             le_variance =       3.771956132922


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328263993406        initial  <--
     2.2204e+30     2.2204e+31             0.0000e+00       -22.328263993406
     8.8818e+30     8.8818e+31             0.0000e+00       -22.328263993406
     3.5527e+31     3.5527e+32             0.0000e+00       -22.328263993406

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8021
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4244e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2320e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.1938
    reference variance = 4.22732
====================================================
  Execution time = 2.3530e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0333e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.8067e+00
  Total weights = 1.949992480e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8562e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860795309411
                                         uncertainty =       0.076605945212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860795309411
                                         uncertainty =       0.076605945212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389274864
  error estimate for blocks of size 2^( 2) =       0.001458809284
  error estimate for blocks of size 2^( 3) =       0.001520047034
  error estimate for blocks of size 2^( 4) =       0.001561494281
  error estimate for blocks of size 2^( 5) =       0.001587969143
  error estimate for blocks of size 2^( 6) =       0.001601931573
  error estimate for blocks of size 2^( 7) =       0.001615136906

      target function =                  N/A
              le_mean =     -22.329724434988
             les_mean =     502.423333131217
             stat err =       0.001591632976
             autocorr =       1.312530791161
              std dev =       1.964762789967
             le_variance =       3.860292820837


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232972443499e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+31, overlap shift 2.2204e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329724434185       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329724434185       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329724434185       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+31 is 1.864636e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+31, overlap shift 8.8818e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329724434185       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329724434185       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329724434185       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+31 is 4.661590e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+32, overlap shift 3.5527e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329724434185       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329724434185       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329724434185       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+32 is 1.165398e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.325549 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9394e+01
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.6196
    reference variance = 3.45341
====================================================
  Execution time = 2.3071e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7513e+00
  Total weights = 1.9498e+06
  Execution time = 4.3065e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801823538575
                                         uncertainty =       0.037190196135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801823538575
                                         uncertainty =       0.037190196135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378527346
  error estimate for blocks of size 2^( 2) =       0.001448442423
  error estimate for blocks of size 2^( 3) =       0.001512256517
  error estimate for blocks of size 2^( 4) =       0.001555362811
  error estimate for blocks of size 2^( 5) =       0.001581734761
  error estimate for blocks of size 2^( 6) =       0.001597583992
  error estimate for blocks of size 2^( 7) =       0.001608916527

      target function =                  N/A
              le_mean =     -22.326765492021
             les_mean =     502.235734188282
             stat err =       0.001585899523
             autocorr =       1.323489699432
              std dev =       1.949563260980
             le_variance =       3.800796908564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801823538575
                                         uncertainty =       0.037190196135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801823538575
                                         uncertainty =       0.037190196135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378527346
  error estimate for blocks of size 2^( 2) =       0.001448442423
  error estimate for blocks of size 2^( 3) =       0.001512256517
  error estimate for blocks of size 2^( 4) =       0.001555362811
  error estimate for blocks of size 2^( 5) =       0.001581734761
  error estimate for blocks of size 2^( 6) =       0.001597583992
  error estimate for blocks of size 2^( 7) =       0.001608916527

      target function =                  N/A
              le_mean =     -22.326765492021
             les_mean =     502.235734188282
             stat err =       0.001585899523
             autocorr =       1.323489699432
              std dev =       1.949563260980
             le_variance =       3.800796908564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801823538575
                                         uncertainty =       0.037190196135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801823538575
                                         uncertainty =       0.037190196135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378527346
  error estimate for blocks of size 2^( 2) =       0.001448442423
  error estimate for blocks of size 2^( 3) =       0.001512256517
  error estimate for blocks of size 2^( 4) =       0.001555362811
  error estimate for blocks of size 2^( 5) =       0.001581734761
  error estimate for blocks of size 2^( 6) =       0.001597583992
  error estimate for blocks of size 2^( 7) =       0.001608916527

      target function =                  N/A
              le_mean =     -22.326765492021
             les_mean =     502.235734188282
             stat err =       0.001585899523
             autocorr =       1.323489699432
              std dev =       1.949563260980
             le_variance =       3.800796908564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801823538575
                                         uncertainty =       0.037190196135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801823538575
                                         uncertainty =       0.037190196135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378527346
  error estimate for blocks of size 2^( 2) =       0.001448442423
  error estimate for blocks of size 2^( 3) =       0.001512256517
  error estimate for blocks of size 2^( 4) =       0.001555362811
  error estimate for blocks of size 2^( 5) =       0.001581734761
  error estimate for blocks of size 2^( 6) =       0.001597583992
  error estimate for blocks of size 2^( 7) =       0.001608916527

      target function =                  N/A
              le_mean =     -22.326765492021
             les_mean =     502.235734188282
             stat err =       0.001585899523
             autocorr =       1.323489699432
              std dev =       1.949563260980
             le_variance =       3.800796908564


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326765492021        initial  <--
     2.2204e+31     2.2204e+32             1.8646e-35       -22.326765492021
     8.8818e+31     8.8818e+32             4.6616e-36       -22.326765492021
     3.5527e+32     3.5527e+33             1.1654e-36       -22.326765492021

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7874
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4191e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2321e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.3132
    reference variance = 2.85663
====================================================
  Execution time = 2.3553e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0292e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7751e+00
  Total weights = 1.950123715e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8742e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830284098437
                                         uncertainty =       0.050899547568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.830284098437
                                         uncertainty =       0.050899547568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383633651
  error estimate for blocks of size 2^( 2) =       0.001452951854
  error estimate for blocks of size 2^( 3) =       0.001514263236
  error estimate for blocks of size 2^( 4) =       0.001557768236
  error estimate for blocks of size 2^( 5) =       0.001577080965
  error estimate for blocks of size 2^( 6) =       0.001587880812
  error estimate for blocks of size 2^( 7) =       0.001586114885

      target function =                  N/A
              le_mean =     -22.329432710780
             les_mean =     502.378693470367
             stat err =       0.001577211225
             autocorr =       1.299383915636
              std dev =       1.956784782758
             le_variance =       3.829006686034


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232943271078e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+32, overlap shift 2.2204e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329432709937       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329432709937       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329432709937       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+32 is 2.381937e-36

solving harmonic davidson linear method for identity shift 8.8818e+32, overlap shift 8.8818e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329432709937       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329432709937       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329432709937       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+32 is 5.954842e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+33, overlap shift 3.5527e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329432709937       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329432709937       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329432709937       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+33 is 1.488710e-37

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.327053 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9434e+01
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.2365
    reference variance = 2.6533
====================================================
  Execution time = 2.3171e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7267e+00
  Total weights = 1.9498e+06
  Execution time = 4.3364e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780832413296
                                         uncertainty =       0.045986259508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780832413296
                                         uncertainty =       0.045986259508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374869395
  error estimate for blocks of size 2^( 2) =       0.001444764427
  error estimate for blocks of size 2^( 3) =       0.001507506318
  error estimate for blocks of size 2^( 4) =       0.001549024432
  error estimate for blocks of size 2^( 5) =       0.001573533178
  error estimate for blocks of size 2^( 6) =       0.001588513055
  error estimate for blocks of size 2^( 7) =       0.001598832793

      target function =                  N/A
              le_mean =     -22.327917252177
             les_mean =     502.262539386293
             stat err =       0.001577475865
             autocorr =       1.316444510133
              std dev =       1.944390053713
             le_variance =       3.780652680980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780832413296
                                         uncertainty =       0.045986259508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780832413296
                                         uncertainty =       0.045986259508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374869395
  error estimate for blocks of size 2^( 2) =       0.001444764427
  error estimate for blocks of size 2^( 3) =       0.001507506318
  error estimate for blocks of size 2^( 4) =       0.001549024432
  error estimate for blocks of size 2^( 5) =       0.001573533178
  error estimate for blocks of size 2^( 6) =       0.001588513055
  error estimate for blocks of size 2^( 7) =       0.001598832793

      target function =                  N/A
              le_mean =     -22.327917252177
             les_mean =     502.262539386293
             stat err =       0.001577475865
             autocorr =       1.316444510133
              std dev =       1.944390053713
             le_variance =       3.780652680980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780832413296
                                         uncertainty =       0.045986259508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780832413296
                                         uncertainty =       0.045986259508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374869395
  error estimate for blocks of size 2^( 2) =       0.001444764427
  error estimate for blocks of size 2^( 3) =       0.001507506318
  error estimate for blocks of size 2^( 4) =       0.001549024432
  error estimate for blocks of size 2^( 5) =       0.001573533178
  error estimate for blocks of size 2^( 6) =       0.001588513055
  error estimate for blocks of size 2^( 7) =       0.001598832793

      target function =                  N/A
              le_mean =     -22.327917252177
             les_mean =     502.262539386293
             stat err =       0.001577475865
             autocorr =       1.316444510133
              std dev =       1.944390053713
             le_variance =       3.780652680980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780832413296
                                         uncertainty =       0.045986259508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780832413296
                                         uncertainty =       0.045986259508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374869395
  error estimate for blocks of size 2^( 2) =       0.001444764427
  error estimate for blocks of size 2^( 3) =       0.001507506318
  error estimate for blocks of size 2^( 4) =       0.001549024432
  error estimate for blocks of size 2^( 5) =       0.001573533178
  error estimate for blocks of size 2^( 6) =       0.001588513055
  error estimate for blocks of size 2^( 7) =       0.001598832793

      target function =                  N/A
              le_mean =     -22.327917252177
             les_mean =     502.262539386293
             stat err =       0.001577475865
             autocorr =       1.316444510133
              std dev =       1.944390053713
             le_variance =       3.780652680980


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327917252177        initial  <--
     2.2204e+32     2.2204e+33             2.3819e-36       -22.327917252177
     8.8818e+32     8.8818e+33             5.9548e-37       -22.327917252177
     3.5527e+33     3.5527e+34             1.4887e-37       -22.327917252177

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9532
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4404e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2321e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.3866
    reference variance = 3.27289
====================================================
  Execution time = 2.3567e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0289e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7825e+00
  Total weights = 1.950236058e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8815e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.836145320808
                                         uncertainty =       0.054760527633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.836145320808
                                         uncertainty =       0.054760527633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001384834557
  error estimate for blocks of size 2^( 2) =       0.001455727654
  error estimate for blocks of size 2^( 3) =       0.001516816810
  error estimate for blocks of size 2^( 4) =       0.001559443195
  error estimate for blocks of size 2^( 5) =       0.001583730584
  error estimate for blocks of size 2^( 6) =       0.001597626029
  error estimate for blocks of size 2^( 7) =       0.001608092852

      target function =                  N/A
              le_mean =     -22.326134672589
             les_mean =     502.238758477475
             stat err =       0.001587223165
             autocorr =       1.313651607347
              std dev =       1.958483147736
             le_variance =       3.835656239965


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232613467259e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+33, overlap shift 2.2204e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326134671775       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326134671775       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+33, overlap shift 8.8818e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326134671775       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326134671775       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+34, overlap shift 3.5527e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326134671775       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326134671775       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.328217 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9455e+01
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.1594
    reference variance = 2.90406
====================================================
  Execution time = 2.2898e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.6413e+00
  Total weights = 1.9499e+06
  Execution time = 4.6262e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.694174521243
                                         uncertainty =       0.018751134585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.694174521243
                                         uncertainty =       0.018751134585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001358943117
  error estimate for blocks of size 2^( 2) =       0.001430753111
  error estimate for blocks of size 2^( 3) =       0.001495443613
  error estimate for blocks of size 2^( 4) =       0.001535491385
  error estimate for blocks of size 2^( 5) =       0.001560015197
  error estimate for blocks of size 2^( 6) =       0.001568487374
  error estimate for blocks of size 2^( 7) =       0.001582055215

      target function =                  N/A
              le_mean =     -22.331113651125
             les_mean =     502.319966645393
             stat err =       0.001561512293
             autocorr =       1.320347532567
              std dev =       1.921866535904
             le_variance =       3.693570981826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.694174521243
                                         uncertainty =       0.018751134585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.694174521243
                                         uncertainty =       0.018751134585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001358943117
  error estimate for blocks of size 2^( 2) =       0.001430753111
  error estimate for blocks of size 2^( 3) =       0.001495443613
  error estimate for blocks of size 2^( 4) =       0.001535491385
  error estimate for blocks of size 2^( 5) =       0.001560015197
  error estimate for blocks of size 2^( 6) =       0.001568487374
  error estimate for blocks of size 2^( 7) =       0.001582055215

      target function =                  N/A
              le_mean =     -22.331113651125
             les_mean =     502.319966645393
             stat err =       0.001561512293
             autocorr =       1.320347532567
              std dev =       1.921866535904
             le_variance =       3.693570981826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.694174521243
                                         uncertainty =       0.018751134585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.694174521243
                                         uncertainty =       0.018751134585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001358943117
  error estimate for blocks of size 2^( 2) =       0.001430753111
  error estimate for blocks of size 2^( 3) =       0.001495443613
  error estimate for blocks of size 2^( 4) =       0.001535491385
  error estimate for blocks of size 2^( 5) =       0.001560015197
  error estimate for blocks of size 2^( 6) =       0.001568487374
  error estimate for blocks of size 2^( 7) =       0.001582055215

      target function =                  N/A
              le_mean =     -22.331113651125
             les_mean =     502.319966645393
             stat err =       0.001561512293
             autocorr =       1.320347532567
              std dev =       1.921866535904
             le_variance =       3.693570981826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.694174521243
                                         uncertainty =       0.018751134585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.694174521243
                                         uncertainty =       0.018751134585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001358943117
  error estimate for blocks of size 2^( 2) =       0.001430753111
  error estimate for blocks of size 2^( 3) =       0.001495443613
  error estimate for blocks of size 2^( 4) =       0.001535491385
  error estimate for blocks of size 2^( 5) =       0.001560015197
  error estimate for blocks of size 2^( 6) =       0.001568487374
  error estimate for blocks of size 2^( 7) =       0.001582055215

      target function =                  N/A
              le_mean =     -22.331113651125
             les_mean =     502.319966645393
             stat err =       0.001561512293
             autocorr =       1.320347532567
              std dev =       1.921866535904
             le_variance =       3.693570981826


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.331113651125        initial  <--
     2.2204e+33     2.2204e+34             0.0000e+00       -22.331113651125
     8.8818e+33     8.8818e+34             0.0000e+00       -22.331113651125
     3.5527e+34     3.5527e+35             0.0000e+00       -22.331113651125

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5227
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4993e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2320e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.2949
    reference variance = 3.7122
====================================================
  Execution time = 2.3383e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0337e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 4.9367e+00
  Total weights = 1.949781492e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7993e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       5.005980819289
                                         uncertainty =       1.233964768576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       5.005980819289
                                         uncertainty =       1.233964768576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001581540150
  error estimate for blocks of size 2^( 2) =       0.001644250524
  error estimate for blocks of size 2^( 3) =       0.001699850170
  error estimate for blocks of size 2^( 4) =       0.001738774679
  error estimate for blocks of size 2^( 5) =       0.001761882698
  error estimate for blocks of size 2^( 6) =       0.001775044058
  error estimate for blocks of size 2^( 7) =       0.001782765001

      target function =                  N/A
              le_mean =     -22.327136154667
             les_mean =     503.437692239806
             stat err =       0.001764616609
             autocorr =       1.244916668135
              std dev =       2.236671315887
             le_variance =       5.002698575311


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232713615467e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+34, overlap shift 2.2204e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327136153844       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327136153844       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+34, overlap shift 8.8818e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327136153844       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327136153844       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+35, overlap shift 3.5527e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327136153844       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327136153844       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.329398 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9189e+01
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.537
    reference variance = 3.19176
====================================================
  Execution time = 2.2858e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7943e+00
  Total weights = 1.9497e+06
  Execution time = 4.2911e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846201164020
                                         uncertainty =       0.063992539161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846201164020
                                         uncertainty =       0.063992539161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386797130
  error estimate for blocks of size 2^( 2) =       0.001457303550
  error estimate for blocks of size 2^( 3) =       0.001519362880
  error estimate for blocks of size 2^( 4) =       0.001562034604
  error estimate for blocks of size 2^( 5) =       0.001589291035
  error estimate for blocks of size 2^( 6) =       0.001603628162
  error estimate for blocks of size 2^( 7) =       0.001619439438

      target function =                  N/A
              le_mean =     -22.328217972555
             les_mean =     502.343593528535
             stat err =       0.001593598310
             autocorr =       1.320480074784
              std dev =       1.961258689512
             le_variance =       3.846535647186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846201164020
                                         uncertainty =       0.063992539161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846201164020
                                         uncertainty =       0.063992539161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386797130
  error estimate for blocks of size 2^( 2) =       0.001457303550
  error estimate for blocks of size 2^( 3) =       0.001519362880
  error estimate for blocks of size 2^( 4) =       0.001562034604
  error estimate for blocks of size 2^( 5) =       0.001589291035
  error estimate for blocks of size 2^( 6) =       0.001603628162
  error estimate for blocks of size 2^( 7) =       0.001619439438

      target function =                  N/A
              le_mean =     -22.328217972555
             les_mean =     502.343593528535
             stat err =       0.001593598310
             autocorr =       1.320480074784
              std dev =       1.961258689512
             le_variance =       3.846535647186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846201164020
                                         uncertainty =       0.063992539161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846201164020
                                         uncertainty =       0.063992539161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386797130
  error estimate for blocks of size 2^( 2) =       0.001457303550
  error estimate for blocks of size 2^( 3) =       0.001519362880
  error estimate for blocks of size 2^( 4) =       0.001562034604
  error estimate for blocks of size 2^( 5) =       0.001589291035
  error estimate for blocks of size 2^( 6) =       0.001603628162
  error estimate for blocks of size 2^( 7) =       0.001619439438

      target function =                  N/A
              le_mean =     -22.328217972555
             les_mean =     502.343593528535
             stat err =       0.001593598310
             autocorr =       1.320480074784
              std dev =       1.961258689512
             le_variance =       3.846535647186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846201164020
                                         uncertainty =       0.063992539161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.846201164020
                                         uncertainty =       0.063992539161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386797130
  error estimate for blocks of size 2^( 2) =       0.001457303550
  error estimate for blocks of size 2^( 3) =       0.001519362880
  error estimate for blocks of size 2^( 4) =       0.001562034604
  error estimate for blocks of size 2^( 5) =       0.001589291035
  error estimate for blocks of size 2^( 6) =       0.001603628162
  error estimate for blocks of size 2^( 7) =       0.001619439438

      target function =                  N/A
              le_mean =     -22.328217972555
             les_mean =     502.343593528535
             stat err =       0.001593598310
             autocorr =       1.320480074784
              std dev =       1.961258689512
             le_variance =       3.846535647186


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328217972555        initial  <--
     2.2204e+34     2.2204e+35             0.0000e+00       -22.328217972555
     8.8818e+34     8.8818e+35             0.0000e+00       -22.328217972555
     3.5527e+35     3.5527e+36             0.0000e+00       -22.328217972555

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5279
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3731e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2321e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.4199
    reference variance = 2.85191
====================================================
  Execution time = 2.3465e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0301e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.6682e+00
  Total weights = 1.949550618e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8748e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718419976601
                                         uncertainty =       0.022292614744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.718419976601
                                         uncertainty =       0.022292614744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363552014
  error estimate for blocks of size 2^( 2) =       0.001435403879
  error estimate for blocks of size 2^( 3) =       0.001499020981
  error estimate for blocks of size 2^( 4) =       0.001544529386
  error estimate for blocks of size 2^( 5) =       0.001566753441
  error estimate for blocks of size 2^( 6) =       0.001578486891
  error estimate for blocks of size 2^( 7) =       0.001573409934

      target function =                  N/A
              le_mean =     -22.326946844184
             les_mean =     502.160754981153
             stat err =       0.001565794913
             autocorr =       1.318640279524
              std dev =       1.928384603975
             le_variance =       3.718667180848


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232694684418e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+35, overlap shift 2.2204e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326946843365       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326946843365       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326946843365       residual = 1.28e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+35 is 1.777472e-39

solving harmonic davidson linear method for identity shift 8.8818e+35, overlap shift 8.8818e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326946843365       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326946843365       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326946843365       residual = 1.28e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+35 is 4.443681e-40

solving harmonic davidson linear method for identity shift 3.5527e+36, overlap shift 3.5527e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326946843365       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326946843365       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326946843365       residual = 1.28e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+36 is 1.110920e-40

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.330592 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9348e+01
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.3739
    reference variance = 3.63015
====================================================
  Execution time = 2.2845e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8460e+00
  Total weights = 1.9495e+06
  Execution time = 4.3016e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893576355940
                                         uncertainty =       0.085448222005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893576355940
                                         uncertainty =       0.085448222005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395059471
  error estimate for blocks of size 2^( 2) =       0.001465319273
  error estimate for blocks of size 2^( 3) =       0.001528258935
  error estimate for blocks of size 2^( 4) =       0.001568844081
  error estimate for blocks of size 2^( 5) =       0.001591595715
  error estimate for blocks of size 2^( 6) =       0.001602154363
  error estimate for blocks of size 2^( 7) =       0.001620060380

      target function =                  N/A
              le_mean =     -22.327793283282
             les_mean =     502.376396463070
             stat err =       0.001595663634
             autocorr =       1.308269603971
              std dev =       1.972943590583
             le_variance =       3.892506411622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893576355940
                                         uncertainty =       0.085448222005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893576355940
                                         uncertainty =       0.085448222005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395059471
  error estimate for blocks of size 2^( 2) =       0.001465319273
  error estimate for blocks of size 2^( 3) =       0.001528258935
  error estimate for blocks of size 2^( 4) =       0.001568844081
  error estimate for blocks of size 2^( 5) =       0.001591595715
  error estimate for blocks of size 2^( 6) =       0.001602154363
  error estimate for blocks of size 2^( 7) =       0.001620060380

      target function =                  N/A
              le_mean =     -22.327793283282
             les_mean =     502.376396463070
             stat err =       0.001595663634
             autocorr =       1.308269603971
              std dev =       1.972943590583
             le_variance =       3.892506411622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893576355940
                                         uncertainty =       0.085448222005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893576355940
                                         uncertainty =       0.085448222005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395059471
  error estimate for blocks of size 2^( 2) =       0.001465319273
  error estimate for blocks of size 2^( 3) =       0.001528258935
  error estimate for blocks of size 2^( 4) =       0.001568844081
  error estimate for blocks of size 2^( 5) =       0.001591595715
  error estimate for blocks of size 2^( 6) =       0.001602154363
  error estimate for blocks of size 2^( 7) =       0.001620060380

      target function =                  N/A
              le_mean =     -22.327793283282
             les_mean =     502.376396463070
             stat err =       0.001595663634
             autocorr =       1.308269603971
              std dev =       1.972943590583
             le_variance =       3.892506411622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893576355940
                                         uncertainty =       0.085448222005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.893576355940
                                         uncertainty =       0.085448222005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395059471
  error estimate for blocks of size 2^( 2) =       0.001465319273
  error estimate for blocks of size 2^( 3) =       0.001528258935
  error estimate for blocks of size 2^( 4) =       0.001568844081
  error estimate for blocks of size 2^( 5) =       0.001591595715
  error estimate for blocks of size 2^( 6) =       0.001602154363
  error estimate for blocks of size 2^( 7) =       0.001620060380

      target function =                  N/A
              le_mean =     -22.327793283282
             les_mean =     502.376396463070
             stat err =       0.001595663634
             autocorr =       1.308269603971
              std dev =       1.972943590583
             le_variance =       3.892506411622


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327793283282        initial  <--
     2.2204e+35     2.2204e+36             1.7775e-39       -22.327793283282
     8.8818e+35     8.8818e+36             4.4437e-40       -22.327793283282
     3.5527e+36     3.5527e+37             1.1109e-40       -22.327793283282

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5695
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3963e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2322e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.3647
    reference variance = 3.25118
====================================================
  Execution time = 2.3386e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0303e+04
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.8062e+00
  Total weights = 1.949707416e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8725e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.859005545348
                                         uncertainty =       0.053152019922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.859005545348
                                         uncertainty =       0.053152019922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001388979484
  error estimate for blocks of size 2^( 2) =       0.001459314492
  error estimate for blocks of size 2^( 3) =       0.001521295436
  error estimate for blocks of size 2^( 4) =       0.001565157389
  error estimate for blocks of size 2^( 5) =       0.001587916170
  error estimate for blocks of size 2^( 6) =       0.001595896599
  error estimate for blocks of size 2^( 7) =       0.001597242562

      target function =                  N/A
              le_mean =     -22.324559139708
             les_mean =     502.192107665824
             stat err =       0.001586553180
             autocorr =       1.304720859273
              std dev =       1.964345052856
             le_variance =       3.858651486680


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232455913971e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+36, overlap shift 2.2204e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324559138890       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324559138890       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+36, overlap shift 8.8818e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324559138890       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324559138890       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+37, overlap shift 3.5527e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324559138890       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324559138890       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.331811 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9265e+01
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.1388
    reference variance = 3.83614
====================================================
  Execution time = 2.2873e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7623e+00
  Total weights = 1.9500e+06
  Execution time = 4.3101e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815064968658
                                         uncertainty =       0.040244687365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815064968658
                                         uncertainty =       0.040244687365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380996178
  error estimate for blocks of size 2^( 2) =       0.001451888356
  error estimate for blocks of size 2^( 3) =       0.001514363802
  error estimate for blocks of size 2^( 4) =       0.001556855433
  error estimate for blocks of size 2^( 5) =       0.001583723998
  error estimate for blocks of size 2^( 6) =       0.001595265787
  error estimate for blocks of size 2^( 7) =       0.001608009945

      target function =                  N/A
              le_mean =     -22.328465134354
             les_mean =     502.322691366723
             stat err =       0.001585963791
             autocorr =       1.318868761532
              std dev =       1.953054773268
             le_variance =       3.814422947387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815064968658
                                         uncertainty =       0.040244687365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815064968658
                                         uncertainty =       0.040244687365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380996178
  error estimate for blocks of size 2^( 2) =       0.001451888356
  error estimate for blocks of size 2^( 3) =       0.001514363802
  error estimate for blocks of size 2^( 4) =       0.001556855433
  error estimate for blocks of size 2^( 5) =       0.001583723998
  error estimate for blocks of size 2^( 6) =       0.001595265787
  error estimate for blocks of size 2^( 7) =       0.001608009945

      target function =                  N/A
              le_mean =     -22.328465134354
             les_mean =     502.322691366723
             stat err =       0.001585963791
             autocorr =       1.318868761532
              std dev =       1.953054773268
             le_variance =       3.814422947387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815064968658
                                         uncertainty =       0.040244687365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815064968658
                                         uncertainty =       0.040244687365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380996178
  error estimate for blocks of size 2^( 2) =       0.001451888356
  error estimate for blocks of size 2^( 3) =       0.001514363802
  error estimate for blocks of size 2^( 4) =       0.001556855433
  error estimate for blocks of size 2^( 5) =       0.001583723998
  error estimate for blocks of size 2^( 6) =       0.001595265787
  error estimate for blocks of size 2^( 7) =       0.001608009945

      target function =                  N/A
              le_mean =     -22.328465134354
             les_mean =     502.322691366723
             stat err =       0.001585963791
             autocorr =       1.318868761532
              std dev =       1.953054773268
             le_variance =       3.814422947387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815064968658
                                         uncertainty =       0.040244687365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815064968658
                                         uncertainty =       0.040244687365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380996178
  error estimate for blocks of size 2^( 2) =       0.001451888356
  error estimate for blocks of size 2^( 3) =       0.001514363802
  error estimate for blocks of size 2^( 4) =       0.001556855433
  error estimate for blocks of size 2^( 5) =       0.001583723998
  error estimate for blocks of size 2^( 6) =       0.001595265787
  error estimate for blocks of size 2^( 7) =       0.001608009945

      target function =                  N/A
              le_mean =     -22.328465134354
             les_mean =     502.322691366723
             stat err =       0.001585963791
             autocorr =       1.318868761532
              std dev =       1.953054773268
             le_variance =       3.814422947387


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328465134354        initial  <--
     2.2204e+36     2.2204e+37             0.0000e+00       -22.328465134354
     8.8818e+36     8.8818e+37             0.0000e+00       -22.328465134354
     3.5527e+37     3.5527e+38             0.0000e+00       -22.328465134354

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6218
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3898e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2321e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.4303
    reference variance = 3.23503
====================================================
  Execution time = 2.3423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0334e+04
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.7617e+00
  Total weights = 1.949810263e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8966e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814963404580
                                         uncertainty =       0.074464480012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.814963404580
                                         uncertainty =       0.074464480012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381095426
  error estimate for blocks of size 2^( 2) =       0.001452176132
  error estimate for blocks of size 2^( 3) =       0.001514369536
  error estimate for blocks of size 2^( 4) =       0.001555892857
  error estimate for blocks of size 2^( 5) =       0.001577852921
  error estimate for blocks of size 2^( 6) =       0.001586393093
  error estimate for blocks of size 2^( 7) =       0.001599192757

      target function =                  N/A
              le_mean =     -22.330737897049
             les_mean =     502.423551826638
             stat err =       0.001579832907
             autocorr =       1.308503648096
              std dev =       1.953195132086
             le_variance =       3.814971224005


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233073789705e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+37, overlap shift 2.2204e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330737896254       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330737896254       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330738067627       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+37 is 2.013015e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+37, overlap shift 8.8818e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330737896254       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330737896254       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330737896254       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+37 is 5.090758e-42

solving harmonic davidson linear method for identity shift 3.5527e+38, overlap shift 3.5527e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330737896254       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330737896254       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330734252930       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+38 is 1.258134e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.333229 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9327e+01
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.0596
    reference variance = 4.15358
====================================================
  Execution time = 2.2879e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7598e+00
  Total weights = 1.9501e+06
  Execution time = 4.3649e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812644383515
                                         uncertainty =       0.049184775709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812644383515
                                         uncertainty =       0.049184775709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380598488
  error estimate for blocks of size 2^( 2) =       0.001450915654
  error estimate for blocks of size 2^( 3) =       0.001514072853
  error estimate for blocks of size 2^( 4) =       0.001554903787
  error estimate for blocks of size 2^( 5) =       0.001577669147
  error estimate for blocks of size 2^( 6) =       0.001586525342
  error estimate for blocks of size 2^( 7) =       0.001592274650

      target function =                  N/A
              le_mean =     -22.326930901923
             les_mean =     502.251628669242
             stat err =       0.001577843231
             autocorr =       1.306149581214
              std dev =       1.952492344596
             le_variance =       3.812226355704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812644383515
                                         uncertainty =       0.049184775709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812644383515
                                         uncertainty =       0.049184775709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380598488
  error estimate for blocks of size 2^( 2) =       0.001450915654
  error estimate for blocks of size 2^( 3) =       0.001514072853
  error estimate for blocks of size 2^( 4) =       0.001554903787
  error estimate for blocks of size 2^( 5) =       0.001577669147
  error estimate for blocks of size 2^( 6) =       0.001586525342
  error estimate for blocks of size 2^( 7) =       0.001592274650

      target function =                  N/A
              le_mean =     -22.326930901923
             les_mean =     502.251628669242
             stat err =       0.001577843231
             autocorr =       1.306149581214
              std dev =       1.952492344596
             le_variance =       3.812226355704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812644383515
                                         uncertainty =       0.049184775709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812644383515
                                         uncertainty =       0.049184775709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380598488
  error estimate for blocks of size 2^( 2) =       0.001450915654
  error estimate for blocks of size 2^( 3) =       0.001514072853
  error estimate for blocks of size 2^( 4) =       0.001554903787
  error estimate for blocks of size 2^( 5) =       0.001577669147
  error estimate for blocks of size 2^( 6) =       0.001586525342
  error estimate for blocks of size 2^( 7) =       0.001592274650

      target function =                  N/A
              le_mean =     -22.326930901923
             les_mean =     502.251628669242
             stat err =       0.001577843231
             autocorr =       1.306149581214
              std dev =       1.952492344596
             le_variance =       3.812226355704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812644383515
                                         uncertainty =       0.049184775709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812644383515
                                         uncertainty =       0.049184775709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380598488
  error estimate for blocks of size 2^( 2) =       0.001450915654
  error estimate for blocks of size 2^( 3) =       0.001514072853
  error estimate for blocks of size 2^( 4) =       0.001554903787
  error estimate for blocks of size 2^( 5) =       0.001577669147
  error estimate for blocks of size 2^( 6) =       0.001586525342
  error estimate for blocks of size 2^( 7) =       0.001592274650

      target function =                  N/A
              le_mean =     -22.326930901923
             les_mean =     502.251628669242
             stat err =       0.001577843231
             autocorr =       1.306149581214
              std dev =       1.952492344596
             le_variance =       3.812226355704


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326930901923        initial  <--
     2.2204e+37     2.2204e+38             2.0130e-41       -22.326930901923
     8.8818e+37     8.8818e+38             5.0908e-42       -22.326930901923
     3.5527e+38     3.5527e+39             1.2581e-42       -22.326930901923

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.8072
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7229e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2320e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.4946
    reference variance = 2.9765
====================================================
  Execution time = 2.3384e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0317e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7843e+00
  Total weights = 1.950167391e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8794e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.833143602971
                                         uncertainty =       0.055699257715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.833143602971
                                         uncertainty =       0.055699257715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001384931719
  error estimate for blocks of size 2^( 2) =       0.001454123120
  error estimate for blocks of size 2^( 3) =       0.001519802961
  error estimate for blocks of size 2^( 4) =       0.001565661741
  error estimate for blocks of size 2^( 5) =       0.001593895736
  error estimate for blocks of size 2^( 6) =       0.001609863679
  error estimate for blocks of size 2^( 7) =       0.001620464335

      target function =                  N/A
              le_mean =     -22.328250437384
             les_mean =     502.335038602100
             stat err =       0.001597471373
             autocorr =       1.330483350913
              std dev =       1.958620557049
             le_variance =       3.836194486496


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232825043738e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+38, overlap shift 2.2204e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328250436552       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328250436552       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328250436552       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+38 is 2.582418e-42

solving harmonic davidson linear method for identity shift 8.8818e+38, overlap shift 8.8818e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328250436552       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328250436552       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328250436552       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+38 is 6.456045e-43

solving harmonic davidson linear method for identity shift 3.5527e+39, overlap shift 3.5527e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328250436552       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328250436552       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328250436552       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+39 is 1.614011e-43

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.334400 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9270e+01
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.3017
    reference variance = 3.00576
====================================================
  Execution time = 2.2849e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7388e+00
  Total weights = 1.9499e+06
  Execution time = 4.3653e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788171812521
                                         uncertainty =       0.037170407893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788171812521
                                         uncertainty =       0.037170407893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376077243
  error estimate for blocks of size 2^( 2) =       0.001447868271
  error estimate for blocks of size 2^( 3) =       0.001511784195
  error estimate for blocks of size 2^( 4) =       0.001556503992
  error estimate for blocks of size 2^( 5) =       0.001581977978
  error estimate for blocks of size 2^( 6) =       0.001596811755
  error estimate for blocks of size 2^( 7) =       0.001598150480

      target function =                  N/A
              le_mean =     -22.328586332843
             les_mean =     502.304606420939
             stat err =       0.001583361051
             autocorr =       1.323958248897
              std dev =       1.946098236756
             le_variance =       3.787298347105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788171812521
                                         uncertainty =       0.037170407893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788171812521
                                         uncertainty =       0.037170407893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376077243
  error estimate for blocks of size 2^( 2) =       0.001447868271
  error estimate for blocks of size 2^( 3) =       0.001511784195
  error estimate for blocks of size 2^( 4) =       0.001556503992
  error estimate for blocks of size 2^( 5) =       0.001581977978
  error estimate for blocks of size 2^( 6) =       0.001596811755
  error estimate for blocks of size 2^( 7) =       0.001598150480

      target function =                  N/A
              le_mean =     -22.328586332843
             les_mean =     502.304606420939
             stat err =       0.001583361051
             autocorr =       1.323958248897
              std dev =       1.946098236756
             le_variance =       3.787298347105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788171812521
                                         uncertainty =       0.037170407893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788171812521
                                         uncertainty =       0.037170407893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376077243
  error estimate for blocks of size 2^( 2) =       0.001447868271
  error estimate for blocks of size 2^( 3) =       0.001511784195
  error estimate for blocks of size 2^( 4) =       0.001556503992
  error estimate for blocks of size 2^( 5) =       0.001581977978
  error estimate for blocks of size 2^( 6) =       0.001596811755
  error estimate for blocks of size 2^( 7) =       0.001598150480

      target function =                  N/A
              le_mean =     -22.328586332843
             les_mean =     502.304606420939
             stat err =       0.001583361051
             autocorr =       1.323958248897
              std dev =       1.946098236756
             le_variance =       3.787298347105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788171812521
                                         uncertainty =       0.037170407893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788171812521
                                         uncertainty =       0.037170407893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376077243
  error estimate for blocks of size 2^( 2) =       0.001447868271
  error estimate for blocks of size 2^( 3) =       0.001511784195
  error estimate for blocks of size 2^( 4) =       0.001556503992
  error estimate for blocks of size 2^( 5) =       0.001581977978
  error estimate for blocks of size 2^( 6) =       0.001596811755
  error estimate for blocks of size 2^( 7) =       0.001598150480

      target function =                  N/A
              le_mean =     -22.328586332843
             les_mean =     502.304606420939
             stat err =       0.001583361051
             autocorr =       1.323958248897
              std dev =       1.946098236756
             le_variance =       3.787298347105


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328586332843        initial  <--
     2.2204e+38     2.2204e+39             2.5824e-42       -22.328586332843
     8.8818e+38     8.8818e+39             6.4560e-43       -22.328586332843
     3.5527e+39     3.5527e+40             1.6140e-43       -22.328586332843

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6589
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3937e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2321e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.4834
    reference variance = 2.45747
====================================================
  Execution time = 2.3491e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0356e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.6999e+00
  Total weights = 1.949562771e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8424e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751448885021
                                         uncertainty =       0.027316180088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751448885021
                                         uncertainty =       0.027316180088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369523064
  error estimate for blocks of size 2^( 2) =       0.001441027750
  error estimate for blocks of size 2^( 3) =       0.001503144039
  error estimate for blocks of size 2^( 4) =       0.001547625900
  error estimate for blocks of size 2^( 5) =       0.001573778488
  error estimate for blocks of size 2^( 6) =       0.001586359680
  error estimate for blocks of size 2^( 7) =       0.001587104584

      target function =                  N/A
              le_mean =     -22.326912440219
             les_mean =     502.190961800758
             stat err =       0.001573717163
             autocorr =       1.320427807382
              std dev =       1.936829078936
             le_variance =       3.751306881011


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232691244022e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+39, overlap shift 2.2204e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326912439374       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326912439374       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+39, overlap shift 8.8818e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326912439374       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326912439374       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+40, overlap shift 3.5527e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326912439374       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326912439374       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.335660 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9340e+01
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.496
    reference variance = 3.23133
====================================================
  Execution time = 2.2887e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7448e+00
  Total weights = 1.9499e+06
  Execution time = 4.3740e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.798281947208
                                         uncertainty =       0.040835122676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.798281947208
                                         uncertainty =       0.040835122676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378104262
  error estimate for blocks of size 2^( 2) =       0.001448513270
  error estimate for blocks of size 2^( 3) =       0.001513394550
  error estimate for blocks of size 2^( 4) =       0.001557241599
  error estimate for blocks of size 2^( 5) =       0.001581164688
  error estimate for blocks of size 2^( 6) =       0.001596464991
  error estimate for blocks of size 2^( 7) =       0.001609679757

      target function =                  N/A
              le_mean =     -22.326581216012
             les_mean =     502.221009785512
             stat err =       0.001586137759
             autocorr =       1.324700364944
              std dev =       1.948964920808
             le_variance =       3.798464262541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.798281947208
                                         uncertainty =       0.040835122676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.798281947208
                                         uncertainty =       0.040835122676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378104262
  error estimate for blocks of size 2^( 2) =       0.001448513270
  error estimate for blocks of size 2^( 3) =       0.001513394550
  error estimate for blocks of size 2^( 4) =       0.001557241599
  error estimate for blocks of size 2^( 5) =       0.001581164688
  error estimate for blocks of size 2^( 6) =       0.001596464991
  error estimate for blocks of size 2^( 7) =       0.001609679757

      target function =                  N/A
              le_mean =     -22.326581216012
             les_mean =     502.221009785512
             stat err =       0.001586137759
             autocorr =       1.324700364944
              std dev =       1.948964920808
             le_variance =       3.798464262541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.798281947208
                                         uncertainty =       0.040835122676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.798281947208
                                         uncertainty =       0.040835122676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378104262
  error estimate for blocks of size 2^( 2) =       0.001448513270
  error estimate for blocks of size 2^( 3) =       0.001513394550
  error estimate for blocks of size 2^( 4) =       0.001557241599
  error estimate for blocks of size 2^( 5) =       0.001581164688
  error estimate for blocks of size 2^( 6) =       0.001596464991
  error estimate for blocks of size 2^( 7) =       0.001609679757

      target function =                  N/A
              le_mean =     -22.326581216012
             les_mean =     502.221009785512
             stat err =       0.001586137759
             autocorr =       1.324700364944
              std dev =       1.948964920808
             le_variance =       3.798464262541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.798281947208
                                         uncertainty =       0.040835122676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.798281947208
                                         uncertainty =       0.040835122676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378104262
  error estimate for blocks of size 2^( 2) =       0.001448513270
  error estimate for blocks of size 2^( 3) =       0.001513394550
  error estimate for blocks of size 2^( 4) =       0.001557241599
  error estimate for blocks of size 2^( 5) =       0.001581164688
  error estimate for blocks of size 2^( 6) =       0.001596464991
  error estimate for blocks of size 2^( 7) =       0.001609679757

      target function =                  N/A
              le_mean =     -22.326581216012
             les_mean =     502.221009785512
             stat err =       0.001586137759
             autocorr =       1.324700364944
              std dev =       1.948964920808
             le_variance =       3.798464262541


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326581216012        initial  <--
     2.2204e+39     2.2204e+40             0.0000e+00       -22.326581216012
     8.8818e+39     8.8818e+40             0.0000e+00       -22.326581216012
     3.5527e+40     3.5527e+41             0.0000e+00       -22.326581216012

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7598
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4108e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2323e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.2424
    reference variance = 2.30604
====================================================
  Execution time = 2.3383e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0349e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7013e+00
  Total weights = 1.949759621e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8341e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753024150164
                                         uncertainty =       0.023185314954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753024150164
                                         uncertainty =       0.023185314954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369851216
  error estimate for blocks of size 2^( 2) =       0.001440778593
  error estimate for blocks of size 2^( 3) =       0.001504640957
  error estimate for blocks of size 2^( 4) =       0.001550479896
  error estimate for blocks of size 2^( 5) =       0.001574516476
  error estimate for blocks of size 2^( 6) =       0.001584869522
  error estimate for blocks of size 2^( 7) =       0.001588116200

      target function =                  N/A
              le_mean =     -22.329104228765
             les_mean =     502.290213627487
             stat err =       0.001574495524
             autocorr =       1.321101122195
              std dev =       1.937293163826
             le_variance =       3.753104802609


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232910422877e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+40, overlap shift 2.2204e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329104227927       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329104227927       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329101562500       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+40 is 1.724764e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+40, overlap shift 8.8818e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329104227927       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329104227927       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329104227927       residual = 1.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+40 is 4.284967e-45

solving harmonic davidson linear method for identity shift 3.5527e+41, overlap shift 3.5527e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329104227927       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329104227927       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329101562500       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+41 is 1.077978e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.337093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9224e+01
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.3149
    reference variance = 4.65459
====================================================
  Execution time = 2.2815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7738e+00
  Total weights = 1.9501e+06
  Execution time = 4.3524e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.828607106522
                                         uncertainty =       0.047459484989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.828607106522
                                         uncertainty =       0.047459484989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383468839
  error estimate for blocks of size 2^( 2) =       0.001454438768
  error estimate for blocks of size 2^( 3) =       0.001518192114
  error estimate for blocks of size 2^( 4) =       0.001566322383
  error estimate for blocks of size 2^( 5) =       0.001591779472
  error estimate for blocks of size 2^( 6) =       0.001601307151
  error estimate for blocks of size 2^( 7) =       0.001614936106

      target function =                  N/A
              le_mean =     -22.327177088270
             les_mean =     502.276593651178
             stat err =       0.001593586278
             autocorr =       1.326821192791
              std dev =       1.956551699426
             le_variance =       3.828094552525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.828607106522
                                         uncertainty =       0.047459484989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.828607106522
                                         uncertainty =       0.047459484989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383468839
  error estimate for blocks of size 2^( 2) =       0.001454438768
  error estimate for blocks of size 2^( 3) =       0.001518192114
  error estimate for blocks of size 2^( 4) =       0.001566322383
  error estimate for blocks of size 2^( 5) =       0.001591779472
  error estimate for blocks of size 2^( 6) =       0.001601307151
  error estimate for blocks of size 2^( 7) =       0.001614936106

      target function =                  N/A
              le_mean =     -22.327177088270
             les_mean =     502.276593651178
             stat err =       0.001593586278
             autocorr =       1.326821192791
              std dev =       1.956551699426
             le_variance =       3.828094552525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.828607106522
                                         uncertainty =       0.047459484989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.828607106522
                                         uncertainty =       0.047459484989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383468839
  error estimate for blocks of size 2^( 2) =       0.001454438768
  error estimate for blocks of size 2^( 3) =       0.001518192114
  error estimate for blocks of size 2^( 4) =       0.001566322383
  error estimate for blocks of size 2^( 5) =       0.001591779472
  error estimate for blocks of size 2^( 6) =       0.001601307151
  error estimate for blocks of size 2^( 7) =       0.001614936106

      target function =                  N/A
              le_mean =     -22.327177088270
             les_mean =     502.276593651178
             stat err =       0.001593586278
             autocorr =       1.326821192791
              std dev =       1.956551699426
             le_variance =       3.828094552525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.828607106522
                                         uncertainty =       0.047459484989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.828607106522
                                         uncertainty =       0.047459484989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383468839
  error estimate for blocks of size 2^( 2) =       0.001454438768
  error estimate for blocks of size 2^( 3) =       0.001518192114
  error estimate for blocks of size 2^( 4) =       0.001566322383
  error estimate for blocks of size 2^( 5) =       0.001591779472
  error estimate for blocks of size 2^( 6) =       0.001601307151
  error estimate for blocks of size 2^( 7) =       0.001614936106

      target function =                  N/A
              le_mean =     -22.327177088270
             les_mean =     502.276593651178
             stat err =       0.001593586278
             autocorr =       1.326821192791
              std dev =       1.956551699426
             le_variance =       3.828094552525


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327177088270        initial  <--
     2.2204e+40     2.2204e+41             1.7248e-44       -22.327177088270
     8.8818e+40     8.8818e+41             4.2850e-45       -22.327177088270
     3.5527e+41     3.5527e+42             1.0780e-45       -22.327177088270

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5734
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3807e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2323e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.1817
    reference variance = 3.25091
====================================================
  Execution time = 2.3383e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0312e+04
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.7056e+00
  Total weights = 1.950064156e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8190e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755042841337
                                         uncertainty =       0.032458031918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755042841337
                                         uncertainty =       0.032458031918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369988714
  error estimate for blocks of size 2^( 2) =       0.001440805118
  error estimate for blocks of size 2^( 3) =       0.001504721768
  error estimate for blocks of size 2^( 4) =       0.001549139819
  error estimate for blocks of size 2^( 5) =       0.001577347176
  error estimate for blocks of size 2^( 6) =       0.001588256256
  error estimate for blocks of size 2^( 7) =       0.001591648205

      target function =                  N/A
              le_mean =     -22.330599650400
             les_mean =     502.361324889541
             stat err =       0.001576597864
             autocorr =       1.324365591927
              std dev =       1.937487618390
             le_variance =       3.753858271416


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233059965040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+41, overlap shift 2.2204e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330599649588       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330599649588       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+41, overlap shift 8.8818e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330599649588       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330599649588       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+42, overlap shift 3.5527e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330599649588       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330599649588       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.338303 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9209e+01
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.3452
    reference variance = 2.08194
====================================================
  Execution time = 2.2858e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7419e+00
  Total weights = 1.9505e+06
  Execution time = 4.3634e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792713231788
                                         uncertainty =       0.032758306778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792713231788
                                         uncertainty =       0.032758306778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376952243
  error estimate for blocks of size 2^( 2) =       0.001448400016
  error estimate for blocks of size 2^( 3) =       0.001510453329
  error estimate for blocks of size 2^( 4) =       0.001554214189
  error estimate for blocks of size 2^( 5) =       0.001578906812
  error estimate for blocks of size 2^( 6) =       0.001591928432
  error estimate for blocks of size 2^( 7) =       0.001594089393

      target function =                  N/A
              le_mean =     -22.327421802330
             les_mean =     502.255691447523
             stat err =       0.001579784707
             autocorr =       1.316309619274
              std dev =       1.947335693024
             le_variance =       3.792116301325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792713231788
                                         uncertainty =       0.032758306778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792713231788
                                         uncertainty =       0.032758306778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376952243
  error estimate for blocks of size 2^( 2) =       0.001448400016
  error estimate for blocks of size 2^( 3) =       0.001510453329
  error estimate for blocks of size 2^( 4) =       0.001554214189
  error estimate for blocks of size 2^( 5) =       0.001578906812
  error estimate for blocks of size 2^( 6) =       0.001591928432
  error estimate for blocks of size 2^( 7) =       0.001594089393

      target function =                  N/A
              le_mean =     -22.327421802330
             les_mean =     502.255691447523
             stat err =       0.001579784707
             autocorr =       1.316309619274
              std dev =       1.947335693024
             le_variance =       3.792116301325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792713231788
                                         uncertainty =       0.032758306778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792713231788
                                         uncertainty =       0.032758306778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376952243
  error estimate for blocks of size 2^( 2) =       0.001448400016
  error estimate for blocks of size 2^( 3) =       0.001510453329
  error estimate for blocks of size 2^( 4) =       0.001554214189
  error estimate for blocks of size 2^( 5) =       0.001578906812
  error estimate for blocks of size 2^( 6) =       0.001591928432
  error estimate for blocks of size 2^( 7) =       0.001594089393

      target function =                  N/A
              le_mean =     -22.327421802330
             les_mean =     502.255691447523
             stat err =       0.001579784707
             autocorr =       1.316309619274
              std dev =       1.947335693024
             le_variance =       3.792116301325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792713231788
                                         uncertainty =       0.032758306778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792713231788
                                         uncertainty =       0.032758306778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376952243
  error estimate for blocks of size 2^( 2) =       0.001448400016
  error estimate for blocks of size 2^( 3) =       0.001510453329
  error estimate for blocks of size 2^( 4) =       0.001554214189
  error estimate for blocks of size 2^( 5) =       0.001578906812
  error estimate for blocks of size 2^( 6) =       0.001591928432
  error estimate for blocks of size 2^( 7) =       0.001594089393

      target function =                  N/A
              le_mean =     -22.327421802330
             les_mean =     502.255691447523
             stat err =       0.001579784707
             autocorr =       1.316309619274
              std dev =       1.947335693024
             le_variance =       3.792116301325


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327421802330        initial  <--
     2.2204e+41     2.2204e+42             0.0000e+00       -22.327421802330
     8.8818e+41     8.8818e+42             0.0000e+00       -22.327421802330
     3.5527e+42     3.5527e+43             0.0000e+00       -22.327421802330

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.7417
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6959e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2322e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.5068
    reference variance = 2.92591
====================================================
  Execution time = 2.3368e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0291e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8083e+00
  Total weights = 1.949778002e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8222e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.862187216109
                                         uncertainty =       0.057047630923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.862187216109
                                         uncertainty =       0.057047630923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389609868
  error estimate for blocks of size 2^( 2) =       0.001459425164
  error estimate for blocks of size 2^( 3) =       0.001519301777
  error estimate for blocks of size 2^( 4) =       0.001563336593
  error estimate for blocks of size 2^( 5) =       0.001583540539
  error estimate for blocks of size 2^( 6) =       0.001598838638
  error estimate for blocks of size 2^( 7) =       0.001610273945

      target function =                  N/A
              le_mean =     -22.327512249055
             les_mean =     502.326119592936
             stat err =       0.001588997429
             autocorr =       1.307556938709
              std dev =       1.965236565185
             le_variance =       3.862154757139


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232751224906e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+42, overlap shift 2.2204e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327512248210       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327512248210       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+42, overlap shift 8.8818e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327512248210       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327512248210       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+43, overlap shift 3.5527e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327512248210       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327512248210       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.339503 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9197e+01
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.478
    reference variance = 3.37693
====================================================
  Execution time = 2.2821e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7383e+00
  Total weights = 1.9497e+06
  Execution time = 4.2938e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.791310338173
                                         uncertainty =       0.031282597464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.791310338173
                                         uncertainty =       0.031282597464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376663385
  error estimate for blocks of size 2^( 2) =       0.001447949857
  error estimate for blocks of size 2^( 3) =       0.001509245180
  error estimate for blocks of size 2^( 4) =       0.001550938375
  error estimate for blocks of size 2^( 5) =       0.001573450795
  error estimate for blocks of size 2^( 6) =       0.001581833293
  error estimate for blocks of size 2^( 7) =       0.001592632015

      target function =                  N/A
              le_mean =     -22.328913789387
             les_mean =     502.318695216678
             stat err =       0.001574713619
             autocorr =       1.308421416241
              std dev =       1.946927179638
             le_variance =       3.790525442812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.791310338173
                                         uncertainty =       0.031282597464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.791310338173
                                         uncertainty =       0.031282597464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376663385
  error estimate for blocks of size 2^( 2) =       0.001447949857
  error estimate for blocks of size 2^( 3) =       0.001509245180
  error estimate for blocks of size 2^( 4) =       0.001550938375
  error estimate for blocks of size 2^( 5) =       0.001573450795
  error estimate for blocks of size 2^( 6) =       0.001581833293
  error estimate for blocks of size 2^( 7) =       0.001592632015

      target function =                  N/A
              le_mean =     -22.328913789387
             les_mean =     502.318695216678
             stat err =       0.001574713619
             autocorr =       1.308421416241
              std dev =       1.946927179638
             le_variance =       3.790525442812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.791310338173
                                         uncertainty =       0.031282597464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.791310338173
                                         uncertainty =       0.031282597464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376663385
  error estimate for blocks of size 2^( 2) =       0.001447949857
  error estimate for blocks of size 2^( 3) =       0.001509245180
  error estimate for blocks of size 2^( 4) =       0.001550938375
  error estimate for blocks of size 2^( 5) =       0.001573450795
  error estimate for blocks of size 2^( 6) =       0.001581833293
  error estimate for blocks of size 2^( 7) =       0.001592632015

      target function =                  N/A
              le_mean =     -22.328913789387
             les_mean =     502.318695216678
             stat err =       0.001574713619
             autocorr =       1.308421416241
              std dev =       1.946927179638
             le_variance =       3.790525442812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.791310338173
                                         uncertainty =       0.031282597464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.791310338173
                                         uncertainty =       0.031282597464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376663385
  error estimate for blocks of size 2^( 2) =       0.001447949857
  error estimate for blocks of size 2^( 3) =       0.001509245180
  error estimate for blocks of size 2^( 4) =       0.001550938375
  error estimate for blocks of size 2^( 5) =       0.001573450795
  error estimate for blocks of size 2^( 6) =       0.001581833293
  error estimate for blocks of size 2^( 7) =       0.001592632015

      target function =                  N/A
              le_mean =     -22.328913789387
             les_mean =     502.318695216678
             stat err =       0.001574713619
             autocorr =       1.308421416241
              std dev =       1.946927179638
             le_variance =       3.790525442812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328913789387        initial  <--
     2.2204e+42     2.2204e+43             0.0000e+00       -22.328913789387
     8.8818e+42     8.8818e+43             0.0000e+00       -22.328913789387
     3.5527e+43     3.5527e+44             0.0000e+00       -22.328913789387

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.4999
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_001                -6.983703e-01 3 1  ON 0
ci_002                -7.020924e-01 3 1  ON 1
ci_003                -6.074541e-02 3 1  ON 2
ci_004                -6.209267e-02 3 1  ON 3
ci_005                 4.548865e-02 3 1  ON 4
ci_006                 4.551040e-02 3 1  ON 5
ci_007                 3.081560e-02 3 1  ON 6
ci_008                 3.277653e-02 3 1  ON 7
ci_009                -2.622068e-02 3 1  ON 8
ci_010                -2.459988e-02 3 1  ON 9
ci_011                -2.274386e-02 3 1  ON 10
ci_012                -2.285607e-02 3 1  ON 11
ci_013                 1.885739e-02 3 1  ON 12
ci_014                 2.004170e-02 3 1  ON 13
ci_015                 1.980792e-02 3 1  ON 14
ci_016                 2.072980e-02 3 1  ON 15
ci_017                 1.568034e-02 3 1  ON 16
ci_018                 1.574339e-02 3 1  ON 17
ci_019                 8.844816e-03 3 1  ON 18
ci_020                 1.011336e-02 3 1  ON 19
ci_021                -9.897961e-03 3 1  ON 20
ci_022                -1.035081e-02 3 1  ON 21
ci_023                 8.432434e-03 3 1  ON 22
ci_024                 8.978240e-03 3 1  ON 23
ci_025                 8.177514e-03 3 1  ON 24
ci_026                 8.376324e-03 3 1  ON 25
ci_027                 8.431295e-03 3 1  ON 26
ci_028                 7.641715e-03 3 1  ON 27
ci_029                -8.455369e-03 3 1  ON 28
ci_030                -7.149589e-03 3 1  ON 29
ci_031                -7.382290e-03 3 1  ON 30
ci_032                -7.071167e-03 3 1  ON 31
ci_033                 7.035555e-03 3 1  ON 32
ci_034                 6.978991e-03 3 1  ON 33
ci_035                 6.931502e-03 3 1  ON 34
ci_036                 7.111776e-03 3 1  ON 35
ci_037                 6.111115e-03 3 1  ON 36
ci_038                 6.850992e-03 3 1  ON 37
ci_039                 5.641092e-03 3 1  ON 38
ci_040                 5.882747e-03 3 1  ON 39
ci_041                 6.158487e-03 3 1  ON 40
ci_042                 5.133511e-03 3 1  ON 41
ci_043                 5.221518e-03 3 1  ON 42
ci_044                 5.597932e-03 3 1  ON 43
ci_045                 4.384066e-03 3 1  ON 44
ci_046                 5.614000e-03 3 1  ON 45
ci_047                -4.895397e-03 3 1  ON 46
ci_048                -4.110861e-03 3 1  ON 47
ci_049                 2.728452e-03 3 1  ON 48
ci_050                 3.376031e-03 3 1  ON 49
ci_051                -2.574598e-03 3 1  ON 50
ci_052                -2.345721e-03 3 1  ON 51
ci_053                -2.766917e-03 3 1  ON 52
ci_054                -1.661451e-03 3 1  ON 53
ci_055                -2.098303e-03 3 1  ON 54
ci_056                -3.531912e-03 3 1  ON 55
ci_057                -1.917446e-03 3 1  ON 56
ci_058                -2.351897e-03 3 1  ON 57
ci_059                -1.192357e-03 3 1  ON 58
ci_060                -1.604861e-03 3 1  ON 59
ci_061                -1.285939e-03 3 1  ON 60
ci_062                -1.159558e-03 3 1  ON 61
ci_063                -1.052133e-03 3 1  ON 62
ci_064                -1.386424e-03 3 1  ON 63
ci_065                -1.972930e-03 3 1  ON 64
ci_066                -1.713267e-03 3 1  ON 65
ci_067                -1.330872e-03 3 1  ON 66
ci_068                -5.475510e-04 3 1  ON 67
ci_069                 1.679778e-03 3 1  ON 68
ci_070                 7.498007e-04 3 1  ON 69
ci_071                -1.567334e-03 3 1  ON 70
ci_072                -1.527162e-03 3 1  ON 71
ci_073                 4.251781e-04 3 1  ON 72
ci_074                 8.099032e-04 3 1  ON 73
ci_075                -6.931145e-04 3 1  ON 74
ci_076                -1.750793e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3705e+01 secs
  Total Execution time = 7.4758e+03 secs

=========================================================
  A new xml input file : FORM.s099.cont.xml
