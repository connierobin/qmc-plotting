Rank =    0  Free Memory = 55497 MB
Rank =    1  Free Memory = 55489 MB
Rank =    2  Free Memory = 55489 MB
Rank =    3  Free Memory = 55489 MB
Rank =    4  Free Memory = 55488 MB
Rank =    5  Free Memory = 55488 MB
Rank =    6  Free Memory = 55488 MB
Rank =    7  Free Memory = 55488 MB
Rank =    8  Free Memory = 55488 MB
Rank =    9  Free Memory = 55488 MB
Rank =   10  Free Memory = 55488 MB
Rank =   11  Free Memory = 55488 MB
Rank =   12  Free Memory = 55487 MB
Rank =   13  Free Memory = 55487 MB
Rank =   14  Free Memory = 55487 MB
Rank =   15  Free Memory = 55475 MB
Rank =   16  Free Memory = 55471 MB
Rank =   17  Free Memory = 55471 MB
Rank =   18  Free Memory = 55471 MB
Rank =   19  Free Memory = 55471 MB
Rank =   20  Free Memory = 55471 MB
Rank =   21  Free Memory = 55471 MB
Rank =   22  Free Memory = 55471 MB
Rank =   23  Free Memory = 55471 MB
Rank =   24  Free Memory = 57446 MB
Rank =   25  Free Memory = 57446 MB
Rank =   26  Free Memory = 57446 MB
Rank =   27  Free Memory = 57446 MB
Rank =   28  Free Memory = 57446 MB
Rank =   29  Free Memory = 57446 MB
Rank =   30  Free Memory = 57446 MB
Rank =   31  Free Memory = 57446 MB
Rank =   32  Free Memory = 57446 MB
Rank =   33  Free Memory = 57446 MB
Rank =   34  Free Memory = 57446 MB
Rank =   35  Free Memory = 57445 MB
Rank =   36  Free Memory = 57445 MB
Rank =   37  Free Memory = 57445 MB
Rank =   38  Free Memory = 57445 MB
Rank =   39  Free Memory = 57445 MB
Rank =   40  Free Memory = 57445 MB
Rank =   41  Free Memory = 57445 MB
Rank =   42  Free Memory = 57445 MB
Rank =   43  Free Memory = 57445 MB
Rank =   44  Free Memory = 57445 MB
Rank =   45  Free Memory = 57445 MB
Rank =   46  Free Memory = 57445 MB
Rank =   47  Free Memory = 57445 MB
Rank =   48  Free Memory = 57158 MB
Rank =   49  Free Memory = 57158 MB
Rank =   50  Free Memory = 57158 MB
Rank =   51  Free Memory = 57158 MB
Rank =   52  Free Memory = 57158 MB
Rank =   53  Free Memory = 57158 MB
Rank =   54  Free Memory = 57158 MB
Rank =   55  Free Memory = 57158 MB
Rank =   56  Free Memory = 57158 MB
Rank =   57  Free Memory = 57158 MB
Rank =   58  Free Memory = 57158 MB
Rank =   59  Free Memory = 57158 MB
Rank =   60  Free Memory = 57158 MB
Rank =   61  Free Memory = 57158 MB
Rank =   62  Free Memory = 57158 MB
Rank =   63  Free Memory = 57158 MB
Rank =   64  Free Memory = 57158 MB
Rank =   65  Free Memory = 57158 MB
Rank =   66  Free Memory = 57158 MB
Rank =   67  Free Memory = 57158 MB
Rank =   68  Free Memory = 57158 MB
Rank =   69  Free Memory = 57158 MB
Rank =   70  Free Memory = 57158 MB
Rank =   71  Free Memory = 57158 MB
Rank =   72  Free Memory = 55310 MB
Rank =   73  Free Memory = 55310 MB
Rank =   74  Free Memory = 55310 MB
Rank =   75  Free Memory = 55310 MB
Rank =   76  Free Memory = 55310 MB
Rank =   77  Free Memory = 55310 MB
Rank =   78  Free Memory = 55310 MB
Rank =   79  Free Memory = 55310 MB
Rank =   80  Free Memory = 55310 MB
Rank =   81  Free Memory = 55310 MB
Rank =   82  Free Memory = 55310 MB
Rank =   83  Free Memory = 55310 MB
Rank =   84  Free Memory = 55310 MB
Rank =   85  Free Memory = 55310 MB
Rank =   86  Free Memory = 55310 MB
Rank =   87  Free Memory = 55310 MB
Rank =   88  Free Memory = 55310 MB
Rank =   89  Free Memory = 55310 MB
Rank =   90  Free Memory = 55310 MB
Rank =   91  Free Memory = 55303 MB
Rank =   92  Free Memory = 55303 MB
Rank =   93  Free Memory = 55303 MB
Rank =   94  Free Memory = 55303 MB
Rank =   95  Free Memory = 55303 MB
  Input file(s): opt_h2o_1b1_lmci_run001a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 96
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 96
  MPI ranks per node        = 24
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_lmci_run001a.xml

  Project = H2O
  date    = 2023-05-01 20:00:42 PDT
  host    = n0041.savio2

 Random Number
 -------------
  Offset for the random number seeds based on time: 218

  Range of prime numbers to use as seeds over processors and threads = 1373-2089


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0
  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 10.1859

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 12.7057

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 12.7057

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 0.991377
Norm of qchem ci vector (sum of qchem_ci^2): 0
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 1.075

  Adding pseudopotential for H1
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1e-10
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 0.001
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 0.001

  Adding pseudopotential for H2
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1e-10
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 0.001
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 0.001
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 0.1359 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAB source=e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 74
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.5552
    reference variance = 3.62921
====================================================
  Execution time = 1.3060e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0276e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5058e+00
  Total weights = 1.945978384e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.3779e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.530740103354
                                         uncertainty =       0.025669106708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.530740103354
                                         uncertainty =       0.025669106708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124861591
  error estimate for blocks of size 2^( 2) =       0.001162615462
  error estimate for blocks of size 2^( 3) =       0.001194790580
  error estimate for blocks of size 2^( 4) =       0.001217618009
  error estimate for blocks of size 2^( 5) =       0.001230867250
  error estimate for blocks of size 2^( 6) =       0.001238471233
  error estimate for blocks of size 2^( 7) =       0.001239792993

      target function =                  N/A
              le_mean =     -16.717940154780
             les_mean =     281.995305083862
             stat err =       0.001231687371
             autocorr =       1.198954775331
              std dev =       1.590819969662
             le_variance =       2.530708175875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.671794015478e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717940153815       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717983448363       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717985742030       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717986701955       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.717986599648       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 1.288196e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717940153815       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717957030034       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717957231526       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717957295526       residual = 9.83e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 5.051121e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717940153815       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717945058542       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717945054595       residual = 8.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 1.472572e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070234 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6517e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001 6.932705e-01                 3 1 ON  0
ci_0002 6.931268e-01                 3 1 ON  1
ci_0003 -4.812850e-02                3 1 ON  2
ci_0004 -4.844722e-02                3 1 ON  3
ci_0005 -4.557844e-02                3 1 ON  4
ci_0006 -4.568658e-02                3 1 ON  5
ci_0007 -3.325796e-02                3 1 ON  6
ci_0008 -3.326061e-02                3 1 ON  7
ci_0009 -3.195401e-02                3 1 ON  8
ci_0010 -3.182534e-02                3 1 ON  9
ci_0011 -2.710738e-02                3 1 ON  10
ci_0012 -2.709028e-02                3 1 ON  11
ci_0013 2.660296e-02                 3 1 ON  12
ci_0014 2.624073e-02                 3 1 ON  13
ci_0015 2.648149e-02                 3 1 ON  14
ci_0016 2.652087e-02                 3 1 ON  15
ci_0017 2.434474e-02                 3 1 ON  16
ci_0018 2.434704e-02                 3 1 ON  17
ci_0019 2.036994e-02                 3 1 ON  18
ci_0020 2.010708e-02                 3 1 ON  19
ci_0021 1.878076e-02                 3 1 ON  20
ci_0022 1.882365e-02                 3 1 ON  21
ci_0023 -1.894208e-02                3 1 ON  22
ci_0024 -1.898093e-02                3 1 ON  23
ci_0025 -1.875850e-02                3 1 ON  24
ci_0026 -1.885259e-02                3 1 ON  25
ci_0027 -1.824123e-02                3 1 ON  26
ci_0028 -1.799026e-02                3 1 ON  27
ci_0029 -1.678450e-02                3 1 ON  28
ci_0030 -1.708155e-02                3 1 ON  29
ci_0031 1.635424e-02                 3 1 ON  30
ci_0032 1.622092e-02                 3 1 ON  31
ci_0033 1.592975e-02                 3 1 ON  32
ci_0034 1.585883e-02                 3 1 ON  33
ci_0035 1.630147e-02                 3 1 ON  34
ci_0036 1.598972e-02                 3 1 ON  35
ci_0037 -1.476022e-02                3 1 ON  36
ci_0038 -1.508044e-02                3 1 ON  37
ci_0039 -1.504738e-02                3 1 ON  38
ci_0040 -1.505882e-02                3 1 ON  39
ci_0041 1.487882e-02                 3 1 ON  40
ci_0042 1.475518e-02                 3 1 ON  41
ci_0043 -1.431202e-02                3 1 ON  42
ci_0044 -1.418658e-02                3 1 ON  43
ci_0045 1.434128e-02                 3 1 ON  44
ci_0046 1.432702e-02                 3 1 ON  45
ci_0047 -1.385983e-02                3 1 ON  46
ci_0048 -1.405876e-02                3 1 ON  47
ci_0049 -1.274081e-02                3 1 ON  48
ci_0050 -1.316521e-02                3 1 ON  49
ci_0051 -1.273525e-02                3 1 ON  50
ci_0052 -1.259909e-02                3 1 ON  51
ci_0053 -1.244779e-02                3 1 ON  52
ci_0054 -1.217068e-02                3 1 ON  53
ci_0055 1.209305e-02                 3 1 ON  54
ci_0056 1.230462e-02                 3 1 ON  55
ci_0057 1.197288e-02                 3 1 ON  56
ci_0058 1.189343e-02                 3 1 ON  57
ci_0059 -1.199461e-02                3 1 ON  58
ci_0060 -1.200264e-02                3 1 ON  59
ci_0061 -1.178969e-02                3 1 ON  60
ci_0062 -1.204461e-02                3 1 ON  61
ci_0063 -1.139116e-02                3 1 ON  62
ci_0064 -1.119884e-02                3 1 ON  63
ci_0065 -1.115686e-02                3 1 ON  64
ci_0066 -1.124614e-02                3 1 ON  65
ci_0067 -1.112892e-02                3 1 ON  66
ci_0068 -1.105200e-02                3 1 ON  67
ci_0069 1.059596e-02                 3 1 ON  68
ci_0070 1.054717e-02                 3 1 ON  69
ci_0071 1.012635e-02                 3 1 ON  70
ci_0072 1.039585e-02                 3 1 ON  71
ci_0073 1.023460e-02                 3 1 ON  72
ci_0074 1.055968e-02                 3 1 ON  73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.6956
    reference variance = 2.77867
====================================================
  Execution time = 1.2838e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5556e+00
  Total weights = 1.9457e+06
  Execution time = 2.2609e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.585946646487
                                         uncertainty =       0.039012306462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.585946646487
                                         uncertainty =       0.039012306462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136938489
  error estimate for blocks of size 2^( 2) =       0.001175840527
  error estimate for blocks of size 2^( 3) =       0.001209493502
  error estimate for blocks of size 2^( 4) =       0.001234378277
  error estimate for blocks of size 2^( 5) =       0.001248917262
  error estimate for blocks of size 2^( 6) =       0.001257522722
  error estimate for blocks of size 2^( 7) =       0.001262010785

      target function =                  N/A
              le_mean =     -16.717276379146
             les_mean =     282.023125527986
             stat err =       0.001250707261
             autocorr =       1.210144982593
              std dev =       1.607899556370
             le_variance =       2.585340983376

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.038804
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.587652552483
                                         uncertainty =       0.039017143327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.587652552483
                                         uncertainty =       0.039017143327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137313899
  error estimate for blocks of size 2^( 2) =       0.001176168030
  error estimate for blocks of size 2^( 3) =       0.001209763446
  error estimate for blocks of size 2^( 4) =       0.001234608533
  error estimate for blocks of size 2^( 5) =       0.001249130558
  error estimate for blocks of size 2^( 6) =       0.001257742211
  error estimate for blocks of size 2^( 7) =       0.001262161032

      target function =                  N/A
              le_mean =     -16.717283352737
             les_mean =     282.027116632223
             stat err =       0.001250910584
             autocorr =       1.209739441988
              std dev =       1.608430475403
             le_variance =       2.587048594206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.587311901732
                                         uncertainty =       0.039015296268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.587311901732
                                         uncertainty =       0.039015296268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137238920
  error estimate for blocks of size 2^( 2) =       0.001176102994
  error estimate for blocks of size 2^( 3) =       0.001209708784
  error estimate for blocks of size 2^( 4) =       0.001234559880
  error estimate for blocks of size 2^( 5) =       0.001249082291
  error estimate for blocks of size 2^( 6) =       0.001257688095
  error estimate for blocks of size 2^( 7) =       0.001262118013

      target function =                  N/A
              le_mean =     -16.717276261772
             les_mean =     282.026786695185
             stat err =       0.001250862070
             autocorr =       1.209805120453
              std dev =       1.608324437381
             le_variance =       2.586707495878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.586129885278
                                         uncertainty =       0.039012677407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.586129885278
                                         uncertainty =       0.039012677407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136978821
  error estimate for blocks of size 2^( 2) =       0.001175875200
  error estimate for blocks of size 2^( 3) =       0.001209520697
  error estimate for blocks of size 2^( 4) =       0.001234400906
  error estimate for blocks of size 2^( 5) =       0.001248939010
  error estimate for blocks of size 2^( 6) =       0.001257547277
  error estimate for blocks of size 2^( 7) =       0.001262025609

      target function =                  N/A
              le_mean =     -16.717273545951
             les_mean =     282.022351491045
             stat err =       0.001250728200
             autocorr =       1.210099647671
              std dev =       1.607956594867
             le_variance =       2.585524410976


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717276379146        initial
     2.5000e-01     2.5000e+00             1.2882e-03       -16.717283352737  <--
     1.0000e+00     1.0000e+01             5.0511e-04       -16.717276261772
     4.0000e+00     4.0000e+01             1.4726e-04       -16.717273545951

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.4262e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001                 6.934970e-01 3 1  ON 0
ci_0002                 6.929335e-01 3 1  ON 1
ci_0003                -4.746882e-02 3 1  ON 2
ci_0004                -4.834664e-02 3 1  ON 3
ci_0005                -4.538964e-02 3 1  ON 4
ci_0006                -4.572422e-02 3 1  ON 5
ci_0007                -3.323327e-02 3 1  ON 6
ci_0008                -3.323616e-02 3 1  ON 7
ci_0009                -3.185522e-02 3 1  ON 8
ci_0010                -3.152539e-02 3 1  ON 9
ci_0011                -2.725166e-02 3 1  ON 10
ci_0012                -2.719685e-02 3 1  ON 11
ci_0013                 2.686407e-02 3 1  ON 12
ci_0014                 2.590849e-02 3 1  ON 13
ci_0015                 2.675601e-02 3 1  ON 14
ci_0016                 2.686133e-02 3 1  ON 15
ci_0017                 2.429747e-02 3 1  ON 16
ci_0018                 2.428327e-02 3 1  ON 17
ci_0019                 2.058223e-02 3 1  ON 18
ci_0020                 1.988489e-02 3 1  ON 19
ci_0021                 1.811232e-02 3 1  ON 20
ci_0022                 1.824478e-02 3 1  ON 21
ci_0023                -1.881000e-02 3 1  ON 22
ci_0024                -1.893167e-02 3 1  ON 23
ci_0025                -1.837017e-02 3 1  ON 24
ci_0026                -1.861463e-02 3 1  ON 25
ci_0027                -1.825490e-02 3 1  ON 26
ci_0028                -1.762029e-02 3 1  ON 27
ci_0029                -1.636475e-02 3 1  ON 28
ci_0030                -1.714734e-02 3 1  ON 29
ci_0031                 1.597154e-02 3 1  ON 30
ci_0032                 1.556102e-02 3 1  ON 31
ci_0033                 1.608728e-02 3 1  ON 32
ci_0034                 1.586086e-02 3 1  ON 33
ci_0035                 1.702592e-02 3 1  ON 34
ci_0036                 1.619852e-02 3 1  ON 35
ci_0037                -1.447307e-02 3 1  ON 36
ci_0038                -1.536069e-02 3 1  ON 37
ci_0039                -1.521366e-02 3 1  ON 38
ci_0040                -1.523033e-02 3 1  ON 39
ci_0041                 1.536421e-02 3 1  ON 40
ci_0042                 1.502979e-02 3 1  ON 41
ci_0043                -1.457696e-02 3 1  ON 42
ci_0044                -1.420337e-02 3 1  ON 43
ci_0045                 1.493833e-02 3 1  ON 44
ci_0046                 1.488595e-02 3 1  ON 45
ci_0047                -1.388422e-02 3 1  ON 46
ci_0048                -1.432478e-02 3 1  ON 47
ci_0049                -1.284012e-02 3 1  ON 48
ci_0050                -1.394830e-02 3 1  ON 49
ci_0051                -1.290587e-02 3 1  ON 50
ci_0052                -1.258447e-02 3 1  ON 51
ci_0053                -1.280252e-02 3 1  ON 52
ci_0054                -1.216010e-02 3 1  ON 53
ci_0055                 1.213204e-02 3 1  ON 54
ci_0056                 1.272932e-02 3 1  ON 55
ci_0057                 1.199325e-02 3 1  ON 56
ci_0058                 1.178134e-02 3 1  ON 57
ci_0059                -1.225122e-02 3 1  ON 58
ci_0060                -1.224541e-02 3 1  ON 59
ci_0061                -1.182874e-02 3 1  ON 60
ci_0062                -1.250390e-02 3 1  ON 61
ci_0063                -1.141782e-02 3 1  ON 62
ci_0064                -1.092769e-02 3 1  ON 63
ci_0065                -1.115949e-02 3 1  ON 64
ci_0066                -1.136289e-02 3 1  ON 65
ci_0067                -1.107519e-02 3 1  ON 66
ci_0068                -1.092527e-02 3 1  ON 67
ci_0069                 1.060916e-02 3 1  ON 68
ci_0070                 1.051719e-02 3 1  ON 69
ci_0071                 9.606643e-03 3 1  ON 70
ci_0072                 1.030348e-02 3 1  ON 71
ci_0073                 1.027141e-02 3 1  ON 72
ci_0074                 1.099834e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0788e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6625e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.7545
    reference variance = 1.81306
====================================================
  Execution time = 1.3054e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0258e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5305e+00
  Total weights = 1.945802916e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2828e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559640952381
                                         uncertainty =       0.035297179052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559640952381
                                         uncertainty =       0.035297179052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131225380
  error estimate for blocks of size 2^( 2) =       0.001169409081
  error estimate for blocks of size 2^( 3) =       0.001202994371
  error estimate for blocks of size 2^( 4) =       0.001226391747
  error estimate for blocks of size 2^( 5) =       0.001240240500
  error estimate for blocks of size 2^( 6) =       0.001249752242
  error estimate for blocks of size 2^( 7) =       0.001248513994

      target function =                  N/A
              le_mean =     -16.716575737015
             les_mean =     281.974407304995
             stat err =       0.001241224621
             autocorr =       1.203933452825
              std dev =       1.599819871649
             le_variance =       2.559423621722


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671657573701e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716575736092       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716680214313       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716684434091       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716686631732       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.716686505928       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.716687095004       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.716687266143       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.716687095376       residual = 9.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-02 is 2.142044e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716575736092       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716640849955       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716641568202       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716641875261       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.716641859709       residual = 1.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 1.381110e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716575736092       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716601707822       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716601762183       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716601765177       residual = 8.86e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 5.692426e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.075534 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6350e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 6.936221e-01 3 1  ON 0
ci_0002                 6.926738e-01 3 1  ON 1
ci_0003                -4.808488e-02 3 1  ON 2
ci_0004                -4.771464e-02 3 1  ON 3
ci_0005                -4.545258e-02 3 1  ON 4
ci_0006                -4.533665e-02 3 1  ON 5
ci_0007                -3.313840e-02 3 1  ON 6
ci_0008                -3.252452e-02 3 1  ON 7
ci_0009                -3.262503e-02 3 1  ON 8
ci_0010                -3.197283e-02 3 1  ON 9
ci_0011                -2.727491e-02 3 1  ON 10
ci_0012                -2.750470e-02 3 1  ON 11
ci_0013                 2.718603e-02 3 1  ON 12
ci_0014                 2.648464e-02 3 1  ON 13
ci_0015                 2.686330e-02 3 1  ON 14
ci_0016                 2.697583e-02 3 1  ON 15
ci_0017                 2.444447e-02 3 1  ON 16
ci_0018                 2.415120e-02 3 1  ON 17
ci_0019                 2.035868e-02 3 1  ON 18
ci_0020                 1.958032e-02 3 1  ON 19
ci_0021                 1.776702e-02 3 1  ON 20
ci_0022                 1.831337e-02 3 1  ON 21
ci_0023                -1.923549e-02 3 1  ON 22
ci_0024                -1.919458e-02 3 1  ON 23
ci_0025                -1.834577e-02 3 1  ON 24
ci_0026                -1.860787e-02 3 1  ON 25
ci_0027                -1.854337e-02 3 1  ON 26
ci_0028                -1.705680e-02 3 1  ON 27
ci_0029                -1.592826e-02 3 1  ON 28
ci_0030                -1.622219e-02 3 1  ON 29
ci_0031                 1.550151e-02 3 1  ON 30
ci_0032                 1.516709e-02 3 1  ON 31
ci_0033                 1.634580e-02 3 1  ON 32
ci_0034                 1.619453e-02 3 1  ON 33
ci_0035                 1.764631e-02 3 1  ON 34
ci_0036                 1.681337e-02 3 1  ON 35
ci_0037                -1.506108e-02 3 1  ON 36
ci_0038                -1.507809e-02 3 1  ON 37
ci_0039                -1.582140e-02 3 1  ON 38
ci_0040                -1.506600e-02 3 1  ON 39
ci_0041                 1.568704e-02 3 1  ON 40
ci_0042                 1.545258e-02 3 1  ON 41
ci_0043                -1.511234e-02 3 1  ON 42
ci_0044                -1.460951e-02 3 1  ON 43
ci_0045                 1.497549e-02 3 1  ON 44
ci_0046                 1.514566e-02 3 1  ON 45
ci_0047                -1.389882e-02 3 1  ON 46
ci_0048                -1.434587e-02 3 1  ON 47
ci_0049                -1.303970e-02 3 1  ON 48
ci_0050                -1.370449e-02 3 1  ON 49
ci_0051                -1.256523e-02 3 1  ON 50
ci_0052                -1.264751e-02 3 1  ON 51
ci_0053                -1.247113e-02 3 1  ON 52
ci_0054                -1.267089e-02 3 1  ON 53
ci_0055                 1.274289e-02 3 1  ON 54
ci_0056                 1.260139e-02 3 1  ON 55
ci_0057                 1.172246e-02 3 1  ON 56
ci_0058                 1.192042e-02 3 1  ON 57
ci_0059                -1.296435e-02 3 1  ON 58
ci_0060                -1.271552e-02 3 1  ON 59
ci_0061                -1.192727e-02 3 1  ON 60
ci_0062                -1.230399e-02 3 1  ON 61
ci_0063                -1.135261e-02 3 1  ON 62
ci_0064                -1.230880e-02 3 1  ON 63
ci_0065                -1.153341e-02 3 1  ON 64
ci_0066                -1.109650e-02 3 1  ON 65
ci_0067                -1.105785e-02 3 1  ON 66
ci_0068                -1.124770e-02 3 1  ON 67
ci_0069                 1.049721e-02 3 1  ON 68
ci_0070                 1.104838e-02 3 1  ON 69
ci_0071                 9.014571e-03 3 1  ON 70
ci_0072                 1.011348e-02 3 1  ON 71
ci_0073                 1.057528e-02 3 1  ON 72
ci_0074                 1.090417e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.771
    reference variance = 3.62723
====================================================
  Execution time = 1.2742e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.6378e+00
  Total weights = 1.9459e+06
  Execution time = 2.2600e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00214452
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.649517456494
                                         uncertainty =       0.059038908628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.649517456494
                                         uncertainty =       0.059038908628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001150898819
  error estimate for blocks of size 2^( 2) =       0.001188671566
  error estimate for blocks of size 2^( 3) =       0.001223037068
  error estimate for blocks of size 2^( 4) =       0.001243425373
  error estimate for blocks of size 2^( 5) =       0.001258749297
  error estimate for blocks of size 2^( 6) =       0.001268321093
  error estimate for blocks of size 2^( 7) =       0.001274754455

      target function =                  N/A
              le_mean =     -16.719524204329
             les_mean =     282.194705947565
             stat err =       0.001261312554
             autocorr =       1.201077822280
              std dev =       1.627642760786
             le_variance =       2.649220956740

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00595045
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.650999492681
                                         uncertainty =       0.059067491517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.650999492681
                                         uncertainty =       0.059067491517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001151221129
  error estimate for blocks of size 2^( 2) =       0.001188899874
  error estimate for blocks of size 2^( 3) =       0.001223152460
  error estimate for blocks of size 2^( 4) =       0.001243471443
  error estimate for blocks of size 2^( 5) =       0.001258753341
  error estimate for blocks of size 2^( 6) =       0.001268319323
  error estimate for blocks of size 2^( 7) =       0.001274713477

      target function =                  N/A
              le_mean =     -16.719504812143
             les_mean =     282.183283568053
             stat err =       0.001261314396
             autocorr =       1.200408885292
              std dev =       1.628098582627
             le_variance =       2.650704994750

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00216955
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.651989331562
                                         uncertainty =       0.059036361281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.651989331562
                                         uncertainty =       0.059036361281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001151435817
  error estimate for blocks of size 2^( 2) =       0.001189071345
  error estimate for blocks of size 2^( 3) =       0.001223293413
  error estimate for blocks of size 2^( 4) =       0.001243550676
  error estimate for blocks of size 2^( 5) =       0.001258810931
  error estimate for blocks of size 2^( 6) =       0.001268338264
  error estimate for blocks of size 2^( 7) =       0.001274697042

      target function =                  N/A
              le_mean =     -16.719529696904
             les_mean =     282.597438999439
             stat err =       0.001261349228
             autocorr =       1.200027565166
              std dev =       1.628402202558
             le_variance =       2.651693733297

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0106371
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.649790034527
                                         uncertainty =       0.059042305125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.649790034527
                                         uncertainty =       0.059042305125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001150958102
  error estimate for blocks of size 2^( 2) =       0.001188706269
  error estimate for blocks of size 2^( 3) =       0.001223041483
  error estimate for blocks of size 2^( 4) =       0.001243411321
  error estimate for blocks of size 2^( 5) =       0.001258720234
  error estimate for blocks of size 2^( 6) =       0.001268296997
  error estimate for blocks of size 2^( 7) =       0.001274723162

      target function =                  N/A
              le_mean =     -16.719508527382
             les_mean =     282.190714132635
             stat err =       0.001261287929
             autocorr =       1.200907202561
              std dev =       1.627726600856
             le_variance =       2.649493887135


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719524204329        initial
     6.2500e-02     6.2500e-01             2.1420e-03       -16.719504812143
     2.5000e-01     2.5000e+00             1.3811e-03       -16.719529696904  <--
     1.0000e+00     1.0000e+01             5.6924e-04       -16.719508527382

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.4179e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 6.936221e-01 3 1  ON 0
ci_0002                 6.926738e-01 3 1  ON 1
ci_0003                -4.808488e-02 3 1  ON 2
ci_0004                -4.771464e-02 3 1  ON 3
ci_0005                -4.545258e-02 3 1  ON 4
ci_0006                -4.533665e-02 3 1  ON 5
ci_0007                -3.313840e-02 3 1  ON 6
ci_0008                -3.252452e-02 3 1  ON 7
ci_0009                -3.262503e-02 3 1  ON 8
ci_0010                -3.197283e-02 3 1  ON 9
ci_0011                -2.727491e-02 3 1  ON 10
ci_0012                -2.750470e-02 3 1  ON 11
ci_0013                 2.718603e-02 3 1  ON 12
ci_0014                 2.648464e-02 3 1  ON 13
ci_0015                 2.686330e-02 3 1  ON 14
ci_0016                 2.697583e-02 3 1  ON 15
ci_0017                 2.444447e-02 3 1  ON 16
ci_0018                 2.415120e-02 3 1  ON 17
ci_0019                 2.035868e-02 3 1  ON 18
ci_0020                 1.958032e-02 3 1  ON 19
ci_0021                 1.776702e-02 3 1  ON 20
ci_0022                 1.831337e-02 3 1  ON 21
ci_0023                -1.923549e-02 3 1  ON 22
ci_0024                -1.919458e-02 3 1  ON 23
ci_0025                -1.834577e-02 3 1  ON 24
ci_0026                -1.860787e-02 3 1  ON 25
ci_0027                -1.854337e-02 3 1  ON 26
ci_0028                -1.705680e-02 3 1  ON 27
ci_0029                -1.592826e-02 3 1  ON 28
ci_0030                -1.622219e-02 3 1  ON 29
ci_0031                 1.550151e-02 3 1  ON 30
ci_0032                 1.516709e-02 3 1  ON 31
ci_0033                 1.634580e-02 3 1  ON 32
ci_0034                 1.619453e-02 3 1  ON 33
ci_0035                 1.764631e-02 3 1  ON 34
ci_0036                 1.681337e-02 3 1  ON 35
ci_0037                -1.506108e-02 3 1  ON 36
ci_0038                -1.507809e-02 3 1  ON 37
ci_0039                -1.582140e-02 3 1  ON 38
ci_0040                -1.506600e-02 3 1  ON 39
ci_0041                 1.568704e-02 3 1  ON 40
ci_0042                 1.545258e-02 3 1  ON 41
ci_0043                -1.511234e-02 3 1  ON 42
ci_0044                -1.460951e-02 3 1  ON 43
ci_0045                 1.497549e-02 3 1  ON 44
ci_0046                 1.514566e-02 3 1  ON 45
ci_0047                -1.389882e-02 3 1  ON 46
ci_0048                -1.434587e-02 3 1  ON 47
ci_0049                -1.303970e-02 3 1  ON 48
ci_0050                -1.370449e-02 3 1  ON 49
ci_0051                -1.256523e-02 3 1  ON 50
ci_0052                -1.264751e-02 3 1  ON 51
ci_0053                -1.247113e-02 3 1  ON 52
ci_0054                -1.267089e-02 3 1  ON 53
ci_0055                 1.274289e-02 3 1  ON 54
ci_0056                 1.260139e-02 3 1  ON 55
ci_0057                 1.172246e-02 3 1  ON 56
ci_0058                 1.192042e-02 3 1  ON 57
ci_0059                -1.296435e-02 3 1  ON 58
ci_0060                -1.271552e-02 3 1  ON 59
ci_0061                -1.192727e-02 3 1  ON 60
ci_0062                -1.230399e-02 3 1  ON 61
ci_0063                -1.135261e-02 3 1  ON 62
ci_0064                -1.230880e-02 3 1  ON 63
ci_0065                -1.153341e-02 3 1  ON 64
ci_0066                -1.109650e-02 3 1  ON 65
ci_0067                -1.105785e-02 3 1  ON 66
ci_0068                -1.124770e-02 3 1  ON 67
ci_0069                 1.049721e-02 3 1  ON 68
ci_0070                 1.104838e-02 3 1  ON 69
ci_0071                 9.014571e-03 3 1  ON 70
ci_0072                 1.011348e-02 3 1  ON 71
ci_0073                 1.057528e-02 3 1  ON 72
ci_0074                 1.090417e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0539e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6694e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.757
    reference variance = 2.74715
====================================================
  Execution time = 1.3010e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0286e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5264e+00
  Total weights = 1.945730400e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2072e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553618380284
                                         uncertainty =       0.028773679655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553618380284
                                         uncertainty =       0.028773679655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129958855
  error estimate for blocks of size 2^( 2) =       0.001169214301
  error estimate for blocks of size 2^( 3) =       0.001201916733
  error estimate for blocks of size 2^( 4) =       0.001225356759
  error estimate for blocks of size 2^( 5) =       0.001242722070
  error estimate for blocks of size 2^( 6) =       0.001251802662
  error estimate for blocks of size 2^( 7) =       0.001263496482

      target function =                  N/A
              le_mean =     -16.718145185386
             les_mean =     282.022822824924
             stat err =       0.001245844493
             autocorr =       1.215632811771
              std dev =       1.598028705906
             le_variance =       2.553695744898


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671814518539e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718145184448       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718223432058       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718226127322       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718226172428       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718227038836       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.718226703717       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.718226447827       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-02 is 1.511063e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718145184448       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718194773184       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718195299306       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718195252120       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718195324407       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 8.369607e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718145184448       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718165301172       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718165368166       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 3.273352e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079941 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6229e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 6.933460e-01 3 1  ON 0
ci_0002                 6.931516e-01 3 1  ON 1
ci_0003                -4.759221e-02 3 1  ON 2
ci_0004                -4.779555e-02 3 1  ON 3
ci_0005                -4.561692e-02 3 1  ON 4
ci_0006                -4.545783e-02 3 1  ON 5
ci_0007                -3.256549e-02 3 1  ON 6
ci_0008                -3.203289e-02 3 1  ON 7
ci_0009                -3.249909e-02 3 1  ON 8
ci_0010                -3.133334e-02 3 1  ON 9
ci_0011                -2.738287e-02 3 1  ON 10
ci_0012                -2.692806e-02 3 1  ON 11
ci_0013                 2.723273e-02 3 1  ON 12
ci_0014                 2.584119e-02 3 1  ON 13
ci_0015                 2.642463e-02 3 1  ON 14
ci_0016                 2.693552e-02 3 1  ON 15
ci_0017                 2.377728e-02 3 1  ON 16
ci_0018                 2.358979e-02 3 1  ON 17
ci_0019                 2.034167e-02 3 1  ON 18
ci_0020                 1.938794e-02 3 1  ON 19
ci_0021                 1.813770e-02 3 1  ON 20
ci_0022                 1.826057e-02 3 1  ON 21
ci_0023                -1.921504e-02 3 1  ON 22
ci_0024                -1.865232e-02 3 1  ON 23
ci_0025                -1.849525e-02 3 1  ON 24
ci_0026                -1.833816e-02 3 1  ON 25
ci_0027                -1.771498e-02 3 1  ON 26
ci_0028                -1.683122e-02 3 1  ON 27
ci_0029                -1.653887e-02 3 1  ON 28
ci_0030                -1.575100e-02 3 1  ON 29
ci_0031                 1.507187e-02 3 1  ON 30
ci_0032                 1.520394e-02 3 1  ON 31
ci_0033                 1.673683e-02 3 1  ON 32
ci_0034                 1.630664e-02 3 1  ON 33
ci_0035                 1.746085e-02 3 1  ON 34
ci_0036                 1.702973e-02 3 1  ON 35
ci_0037                -1.509426e-02 3 1  ON 36
ci_0038                -1.497553e-02 3 1  ON 37
ci_0039                -1.536475e-02 3 1  ON 38
ci_0040                -1.500938e-02 3 1  ON 39
ci_0041                 1.636884e-02 3 1  ON 40
ci_0042                 1.515268e-02 3 1  ON 41
ci_0043                -1.494917e-02 3 1  ON 42
ci_0044                -1.445947e-02 3 1  ON 43
ci_0045                 1.565497e-02 3 1  ON 44
ci_0046                 1.512039e-02 3 1  ON 45
ci_0047                -1.445351e-02 3 1  ON 46
ci_0048                -1.398363e-02 3 1  ON 47
ci_0049                -1.227322e-02 3 1  ON 48
ci_0050                -1.342729e-02 3 1  ON 49
ci_0051                -1.329295e-02 3 1  ON 50
ci_0052                -1.304606e-02 3 1  ON 51
ci_0053                -1.262392e-02 3 1  ON 52
ci_0054                -1.286768e-02 3 1  ON 53
ci_0055                 1.226044e-02 3 1  ON 54
ci_0056                 1.267894e-02 3 1  ON 55
ci_0057                 1.238860e-02 3 1  ON 56
ci_0058                 1.201413e-02 3 1  ON 57
ci_0059                -1.267221e-02 3 1  ON 58
ci_0060                -1.252063e-02 3 1  ON 59
ci_0061                -1.265200e-02 3 1  ON 60
ci_0062                -1.251794e-02 3 1  ON 61
ci_0063                -1.166712e-02 3 1  ON 62
ci_0064                -1.158967e-02 3 1  ON 63
ci_0065                -1.113847e-02 3 1  ON 64
ci_0066                -1.162278e-02 3 1  ON 65
ci_0067                -1.107581e-02 3 1  ON 66
ci_0068                -1.129569e-02 3 1  ON 67
ci_0069                 1.063274e-02 3 1  ON 68
ci_0070                 1.089608e-02 3 1  ON 69
ci_0071                 9.851532e-03 3 1  ON 70
ci_0072                 1.031846e-02 3 1  ON 71
ci_0073                 1.069419e-02 3 1  ON 72
ci_0074                 1.082455e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8458
    reference variance = 1.40119
====================================================
  Execution time = 1.5038e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4994e+00
  Total weights = 1.9459e+06
  Execution time = 2.2425e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.527345938011
                                         uncertainty =       0.026372438863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.527345938011
                                         uncertainty =       0.026372438863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124125829
  error estimate for blocks of size 2^( 2) =       0.001162613607
  error estimate for blocks of size 2^( 3) =       0.001195893246
  error estimate for blocks of size 2^( 4) =       0.001220098272
  error estimate for blocks of size 2^( 5) =       0.001232829419
  error estimate for blocks of size 2^( 6) =       0.001238006266
  error estimate for blocks of size 2^( 7) =       0.001242589052

      target function =                  N/A
              le_mean =     -16.718914016135
             les_mean =     282.023971132331
             stat err =       0.001233380752
             autocorr =       1.203828109550
              std dev =       1.589779429143
             le_variance =       2.527398633327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.528395578399
                                         uncertainty =       0.026368646870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.528395578399
                                         uncertainty =       0.026368646870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124359197
  error estimate for blocks of size 2^( 2) =       0.001162931992
  error estimate for blocks of size 2^( 3) =       0.001196270447
  error estimate for blocks of size 2^( 4) =       0.001220498621
  error estimate for blocks of size 2^( 5) =       0.001233273939
  error estimate for blocks of size 2^( 6) =       0.001238442977
  error estimate for blocks of size 2^( 7) =       0.001242967605

      target function =                  N/A
              le_mean =     -16.718897551338
             les_mean =     282.021756272203
             stat err =       0.001233795785
             autocorr =       1.204138414403
              std dev =       1.590109466531
             le_variance =       2.528448115551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529159360048
                                         uncertainty =       0.026362367305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529159360048
                                         uncertainty =       0.026362367305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124528963
  error estimate for blocks of size 2^( 2) =       0.001163126469
  error estimate for blocks of size 2^( 3) =       0.001196474938
  error estimate for blocks of size 2^( 4) =       0.001220712432
  error estimate for blocks of size 2^( 5) =       0.001233475721
  error estimate for blocks of size 2^( 6) =       0.001238628477
  error estimate for blocks of size 2^( 7) =       0.001243173846

      target function =                  N/A
              le_mean =     -16.718908571397
             les_mean =     282.095207092251
             stat err =       0.001233997619
             autocorr =       1.204168750406
              std dev =       1.590349555833
             le_variance =       2.529211709739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.527559401402
                                         uncertainty =       0.026374089138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.527559401402
                                         uncertainty =       0.026374089138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124173289
  error estimate for blocks of size 2^( 2) =       0.001162684447
  error estimate for blocks of size 2^( 3) =       0.001195982129
  error estimate for blocks of size 2^( 4) =       0.001220189457
  error estimate for blocks of size 2^( 5) =       0.001232925348
  error estimate for blocks of size 2^( 6) =       0.001238105841
  error estimate for blocks of size 2^( 7) =       0.001242679560

      target function =                  N/A
              le_mean =     -16.718897594033
             les_mean =     282.032793718000
             stat err =       0.001233475052
             autocorr =       1.203910537735
              std dev =       1.589846548460
             le_variance =       2.527612047649


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718914016135        initial  <--
     6.2500e-02     6.2500e-01             1.5111e-03       -16.718897551338
     2.5000e-01     2.5000e+00             8.3696e-04       -16.718908571397
     1.0000e+00     1.0000e+01             3.2734e-04       -16.718897594033

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.3988
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 6.936221e-01 3 1  ON 0
ci_0002                 6.926738e-01 3 1  ON 1
ci_0003                -4.808488e-02 3 1  ON 2
ci_0004                -4.771464e-02 3 1  ON 3
ci_0005                -4.545258e-02 3 1  ON 4
ci_0006                -4.533665e-02 3 1  ON 5
ci_0007                -3.313840e-02 3 1  ON 6
ci_0008                -3.252452e-02 3 1  ON 7
ci_0009                -3.262503e-02 3 1  ON 8
ci_0010                -3.197283e-02 3 1  ON 9
ci_0011                -2.727491e-02 3 1  ON 10
ci_0012                -2.750470e-02 3 1  ON 11
ci_0013                 2.718603e-02 3 1  ON 12
ci_0014                 2.648464e-02 3 1  ON 13
ci_0015                 2.686330e-02 3 1  ON 14
ci_0016                 2.697583e-02 3 1  ON 15
ci_0017                 2.444447e-02 3 1  ON 16
ci_0018                 2.415120e-02 3 1  ON 17
ci_0019                 2.035868e-02 3 1  ON 18
ci_0020                 1.958032e-02 3 1  ON 19
ci_0021                 1.776702e-02 3 1  ON 20
ci_0022                 1.831337e-02 3 1  ON 21
ci_0023                -1.923549e-02 3 1  ON 22
ci_0024                -1.919458e-02 3 1  ON 23
ci_0025                -1.834577e-02 3 1  ON 24
ci_0026                -1.860787e-02 3 1  ON 25
ci_0027                -1.854337e-02 3 1  ON 26
ci_0028                -1.705680e-02 3 1  ON 27
ci_0029                -1.592826e-02 3 1  ON 28
ci_0030                -1.622219e-02 3 1  ON 29
ci_0031                 1.550151e-02 3 1  ON 30
ci_0032                 1.516709e-02 3 1  ON 31
ci_0033                 1.634580e-02 3 1  ON 32
ci_0034                 1.619453e-02 3 1  ON 33
ci_0035                 1.764631e-02 3 1  ON 34
ci_0036                 1.681337e-02 3 1  ON 35
ci_0037                -1.506108e-02 3 1  ON 36
ci_0038                -1.507809e-02 3 1  ON 37
ci_0039                -1.582140e-02 3 1  ON 38
ci_0040                -1.506600e-02 3 1  ON 39
ci_0041                 1.568704e-02 3 1  ON 40
ci_0042                 1.545258e-02 3 1  ON 41
ci_0043                -1.511234e-02 3 1  ON 42
ci_0044                -1.460951e-02 3 1  ON 43
ci_0045                 1.497549e-02 3 1  ON 44
ci_0046                 1.514566e-02 3 1  ON 45
ci_0047                -1.389882e-02 3 1  ON 46
ci_0048                -1.434587e-02 3 1  ON 47
ci_0049                -1.303970e-02 3 1  ON 48
ci_0050                -1.370449e-02 3 1  ON 49
ci_0051                -1.256523e-02 3 1  ON 50
ci_0052                -1.264751e-02 3 1  ON 51
ci_0053                -1.247113e-02 3 1  ON 52
ci_0054                -1.267089e-02 3 1  ON 53
ci_0055                 1.274289e-02 3 1  ON 54
ci_0056                 1.260139e-02 3 1  ON 55
ci_0057                 1.172246e-02 3 1  ON 56
ci_0058                 1.192042e-02 3 1  ON 57
ci_0059                -1.296435e-02 3 1  ON 58
ci_0060                -1.271552e-02 3 1  ON 59
ci_0061                -1.192727e-02 3 1  ON 60
ci_0062                -1.230399e-02 3 1  ON 61
ci_0063                -1.135261e-02 3 1  ON 62
ci_0064                -1.230880e-02 3 1  ON 63
ci_0065                -1.153341e-02 3 1  ON 64
ci_0066                -1.109650e-02 3 1  ON 65
ci_0067                -1.105785e-02 3 1  ON 66
ci_0068                -1.124770e-02 3 1  ON 67
ci_0069                 1.049721e-02 3 1  ON 68
ci_0070                 1.104838e-02 3 1  ON 69
ci_0071                 9.014571e-03 3 1  ON 70
ci_0072                 1.011348e-02 3 1  ON 71
ci_0073                 1.057528e-02 3 1  ON 72
ci_0074                 1.090417e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2642e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6730e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9352
    reference variance = 1.26281
====================================================
  Execution time = 1.2976e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0277e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5119e+00
  Total weights = 1.945347362e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2027e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.541018665389
                                         uncertainty =       0.023386173933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.541018665389
                                         uncertainty =       0.023386173933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127128903
  error estimate for blocks of size 2^( 2) =       0.001164913673
  error estimate for blocks of size 2^( 3) =       0.001197765959
  error estimate for blocks of size 2^( 4) =       0.001220431353
  error estimate for blocks of size 2^( 5) =       0.001233720290
  error estimate for blocks of size 2^( 6) =       0.001241233736
  error estimate for blocks of size 2^( 7) =       0.001244453848

      target function =                  N/A
              le_mean =     -16.716965219551
             les_mean =     281.968872962437
             stat err =       0.001234959807
             autocorr =       1.200489796406
              std dev =       1.594026485348
             le_variance =       2.540920435991


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671696521955e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716965218612       residual = 7.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716990572753       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716993677769       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716993474659       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 9.972540e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716965218612       residual = 7.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716973130684       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716974146847       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716974139549       residual = 3.07e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 3.026328e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716965218612       residual = 7.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716967327512       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716967608032       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716967608991       residual = 1.53e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 7.992495e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083628 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6189e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 6.935694e-01 3 1  ON 0
ci_0002                 6.927020e-01 3 1  ON 1
ci_0003                -4.804822e-02 3 1  ON 2
ci_0004                -4.771658e-02 3 1  ON 3
ci_0005                -4.535415e-02 3 1  ON 4
ci_0006                -4.530835e-02 3 1  ON 5
ci_0007                -3.317290e-02 3 1  ON 6
ci_0008                -3.252867e-02 3 1  ON 7
ci_0009                -3.267165e-02 3 1  ON 8
ci_0010                -3.186444e-02 3 1  ON 9
ci_0011                -2.730526e-02 3 1  ON 10
ci_0012                -2.760851e-02 3 1  ON 11
ci_0013                 2.716656e-02 3 1  ON 12
ci_0014                 2.660683e-02 3 1  ON 13
ci_0015                 2.687970e-02 3 1  ON 14
ci_0016                 2.696675e-02 3 1  ON 15
ci_0017                 2.427540e-02 3 1  ON 16
ci_0018                 2.418733e-02 3 1  ON 17
ci_0019                 2.032582e-02 3 1  ON 18
ci_0020                 1.955309e-02 3 1  ON 19
ci_0021                 1.775153e-02 3 1  ON 20
ci_0022                 1.824237e-02 3 1  ON 21
ci_0023                -1.923887e-02 3 1  ON 22
ci_0024                -1.926057e-02 3 1  ON 23
ci_0025                -1.836143e-02 3 1  ON 24
ci_0026                -1.854663e-02 3 1  ON 25
ci_0027                -1.855686e-02 3 1  ON 26
ci_0028                -1.711378e-02 3 1  ON 27
ci_0029                -1.574943e-02 3 1  ON 28
ci_0030                -1.619911e-02 3 1  ON 29
ci_0031                 1.546819e-02 3 1  ON 30
ci_0032                 1.520091e-02 3 1  ON 31
ci_0033                 1.623365e-02 3 1  ON 32
ci_0034                 1.641241e-02 3 1  ON 33
ci_0035                 1.761018e-02 3 1  ON 34
ci_0036                 1.677636e-02 3 1  ON 35
ci_0037                -1.504538e-02 3 1  ON 36
ci_0038                -1.508942e-02 3 1  ON 37
ci_0039                -1.574239e-02 3 1  ON 38
ci_0040                -1.507041e-02 3 1  ON 39
ci_0041                 1.578856e-02 3 1  ON 40
ci_0042                 1.557001e-02 3 1  ON 41
ci_0043                -1.515036e-02 3 1  ON 42
ci_0044                -1.460601e-02 3 1  ON 43
ci_0045                 1.498743e-02 3 1  ON 44
ci_0046                 1.513497e-02 3 1  ON 45
ci_0047                -1.378392e-02 3 1  ON 46
ci_0048                -1.423734e-02 3 1  ON 47
ci_0049                -1.324694e-02 3 1  ON 48
ci_0050                -1.378996e-02 3 1  ON 49
ci_0051                -1.278870e-02 3 1  ON 50
ci_0052                -1.283476e-02 3 1  ON 51
ci_0053                -1.263862e-02 3 1  ON 52
ci_0054                -1.270334e-02 3 1  ON 53
ci_0055                 1.270916e-02 3 1  ON 54
ci_0056                 1.255653e-02 3 1  ON 55
ci_0057                 1.171095e-02 3 1  ON 56
ci_0058                 1.196485e-02 3 1  ON 57
ci_0059                -1.305472e-02 3 1  ON 58
ci_0060                -1.276134e-02 3 1  ON 59
ci_0061                -1.222990e-02 3 1  ON 60
ci_0062                -1.248155e-02 3 1  ON 61
ci_0063                -1.139525e-02 3 1  ON 62
ci_0064                -1.234304e-02 3 1  ON 63
ci_0065                -1.164777e-02 3 1  ON 64
ci_0066                -1.123414e-02 3 1  ON 65
ci_0067                -1.116702e-02 3 1  ON 66
ci_0068                -1.121399e-02 3 1  ON 67
ci_0069                 1.051095e-02 3 1  ON 68
ci_0070                 1.105840e-02 3 1  ON 69
ci_0071                 9.186393e-03 3 1  ON 70
ci_0072                 1.018231e-02 3 1  ON 71
ci_0073                 1.056321e-02 3 1  ON 72
ci_0074                 1.096967e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.7237
    reference variance = 2.1914
====================================================
  Execution time = 1.2756e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5673e+00
  Total weights = 1.9459e+06
  Execution time = 2.2586e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0145866
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.596147713511
                                         uncertainty =       0.057740996137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.596147713511
                                         uncertainty =       0.057740996137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139381477
  error estimate for blocks of size 2^( 2) =       0.001177249071
  error estimate for blocks of size 2^( 3) =       0.001209411458
  error estimate for blocks of size 2^( 4) =       0.001232023818
  error estimate for blocks of size 2^( 5) =       0.001246246015
  error estimate for blocks of size 2^( 6) =       0.001255249377
  error estimate for blocks of size 2^( 7) =       0.001259598224

      target function =                  N/A
              le_mean =     -16.719029091927
             les_mean =     282.094252568762
             stat err =       0.001248279358
             autocorr =       1.200287460122
              std dev =       1.611354517913
             le_variance =       2.596463382398

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00110541
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.597912652301
                                         uncertainty =       0.057736417047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.597912652301
                                         uncertainty =       0.057736417047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139768569
  error estimate for blocks of size 2^( 2) =       0.001177578352
  error estimate for blocks of size 2^( 3) =       0.001209706939
  error estimate for blocks of size 2^( 4) =       0.001232315422
  error estimate for blocks of size 2^( 5) =       0.001246505887
  error estimate for blocks of size 2^( 6) =       0.001255530647
  error estimate for blocks of size 2^( 7) =       0.001259851128

      target function =                  N/A
              le_mean =     -16.719041519593
             les_mean =     282.574723383337
             stat err =       0.001248550771
             autocorr =       1.199993964153
              std dev =       1.611901957872
             le_variance =       2.598227921791

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0142754
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.597127243757
                                         uncertainty =       0.057740746496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.597127243757
                                         uncertainty =       0.057740746496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139596338
  error estimate for blocks of size 2^( 2) =       0.001177440352
  error estimate for blocks of size 2^( 3) =       0.001209582173
  error estimate for blocks of size 2^( 4) =       0.001232177271
  error estimate for blocks of size 2^( 5) =       0.001246380950
  error estimate for blocks of size 2^( 6) =       0.001255388645
  error estimate for blocks of size 2^( 7) =       0.001259706469

      target function =                  N/A
              le_mean =     -16.719028402963
             les_mean =     282.094405542640
             stat err =       0.001248413334
             autocorr =       1.200092459346
              std dev =       1.611658382912
             le_variance =       2.597442743209

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0488908
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.596276034982
                                         uncertainty =       0.057740936147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.596276034982
                                         uncertainty =       0.057740936147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139409626
  error estimate for blocks of size 2^( 2) =       0.001177276455
  error estimate for blocks of size 2^( 3) =       0.001209440054
  error estimate for blocks of size 2^( 4) =       0.001232050874
  error estimate for blocks of size 2^( 5) =       0.001246273442
  error estimate for blocks of size 2^( 6) =       0.001255277811
  error estimate for blocks of size 2^( 7) =       0.001259624656

      target function =                  N/A
              le_mean =     -16.719027135519
             les_mean =     282.100537104384
             stat err =       0.001248306696
             autocorr =       1.200280724032
              std dev =       1.611394328168
             le_variance =       2.596591680851


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719029091927        initial
     6.2500e-01     6.2500e+00             9.9725e-04       -16.719041519593  <--
     2.5000e+00     2.5000e+01             3.0263e-04       -16.719028402963
     1.0000e+01     1.0000e+02             7.9925e-05       -16.719027135519

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.4146e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 6.934172e-01 3 1  ON 0
ci_0002                 6.928054e-01 3 1  ON 1
ci_0003                -4.796430e-02 3 1  ON 2
ci_0004                -4.771490e-02 3 1  ON 3
ci_0005                -4.510727e-02 3 1  ON 4
ci_0006                -4.523474e-02 3 1  ON 5
ci_0007                -3.326633e-02 3 1  ON 6
ci_0008                -3.253622e-02 3 1  ON 7
ci_0009                -3.277790e-02 3 1  ON 8
ci_0010                -3.162759e-02 3 1  ON 9
ci_0011                -2.738162e-02 3 1  ON 10
ci_0012                -2.783752e-02 3 1  ON 11
ci_0013                 2.712640e-02 3 1  ON 12
ci_0014                 2.687732e-02 3 1  ON 13
ci_0015                 2.692391e-02 3 1  ON 14
ci_0016                 2.695019e-02 3 1  ON 15
ci_0017                 2.389963e-02 3 1  ON 16
ci_0018                 2.426813e-02 3 1  ON 17
ci_0019                 2.025027e-02 3 1  ON 18
ci_0020                 1.948662e-02 3 1  ON 19
ci_0021                 1.771642e-02 3 1  ON 20
ci_0022                 1.805795e-02 3 1  ON 21
ci_0023                -1.924739e-02 3 1  ON 22
ci_0024                -1.940088e-02 3 1  ON 23
ci_0025                -1.839051e-02 3 1  ON 24
ci_0026                -1.841202e-02 3 1  ON 25
ci_0027                -1.858410e-02 3 1  ON 26
ci_0028                -1.723821e-02 3 1  ON 27
ci_0029                -1.533683e-02 3 1  ON 28
ci_0030                -1.613743e-02 3 1  ON 29
ci_0031                 1.537216e-02 3 1  ON 30
ci_0032                 1.527587e-02 3 1  ON 31
ci_0033                 1.594052e-02 3 1  ON 32
ci_0034                 1.696717e-02 3 1  ON 33
ci_0035                 1.751882e-02 3 1  ON 34
ci_0036                 1.667624e-02 3 1  ON 35
ci_0037                -1.500455e-02 3 1  ON 36
ci_0038                -1.511985e-02 3 1  ON 37
ci_0039                -1.558786e-02 3 1  ON 38
ci_0040                -1.507621e-02 3 1  ON 39
ci_0041                 1.601290e-02 3 1  ON 40
ci_0042                 1.583191e-02 3 1  ON 41
ci_0043                -1.525048e-02 3 1  ON 42
ci_0044                -1.459027e-02 3 1  ON 43
ci_0045                 1.501638e-02 3 1  ON 44
ci_0046                 1.510907e-02 3 1  ON 45
ci_0047                -1.355611e-02 3 1  ON 46
ci_0048                -1.403377e-02 3 1  ON 47
ci_0049                -1.371093e-02 3 1  ON 48
ci_0050                -1.397731e-02 3 1  ON 49
ci_0051                -1.322674e-02 3 1  ON 50
ci_0052                -1.319697e-02 3 1  ON 51
ci_0053                -1.297903e-02 3 1  ON 52
ci_0054                -1.277305e-02 3 1  ON 53
ci_0055                 1.262967e-02 3 1  ON 54
ci_0056                 1.244780e-02 3 1  ON 55
ci_0057                 1.167739e-02 3 1  ON 56
ci_0058                 1.206632e-02 3 1  ON 57
ci_0059                -1.324024e-02 3 1  ON 58
ci_0060                -1.285424e-02 3 1  ON 59
ci_0061                -1.292452e-02 3 1  ON 60
ci_0062                -1.288138e-02 3 1  ON 61
ci_0063                -1.148834e-02 3 1  ON 62
ci_0064                -1.241946e-02 3 1  ON 63
ci_0065                -1.189070e-02 3 1  ON 64
ci_0066                -1.152995e-02 3 1  ON 65
ci_0067                -1.138336e-02 3 1  ON 66
ci_0068                -1.115008e-02 3 1  ON 67
ci_0069                 1.053435e-02 3 1  ON 68
ci_0070                 1.108118e-02 3 1  ON 69
ci_0071                 9.577266e-03 3 1  ON 70
ci_0072                 1.033196e-02 3 1  ON 71
ci_0073                 1.053988e-02 3 1  ON 72
ci_0074                 1.109475e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0349e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6755e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8169
    reference variance = 2.42924
====================================================
  Execution time = 1.3051e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0284e+04
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5305e+00
  Total weights = 1.945459612e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2065e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.555833894695
                                         uncertainty =       0.023976504179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.555833894695
                                         uncertainty =       0.023976504179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130455907
  error estimate for blocks of size 2^( 2) =       0.001168229680
  error estimate for blocks of size 2^( 3) =       0.001201623978
  error estimate for blocks of size 2^( 4) =       0.001225612490
  error estimate for blocks of size 2^( 5) =       0.001239711293
  error estimate for blocks of size 2^( 6) =       0.001246914555
  error estimate for blocks of size 2^( 7) =       0.001254473841

      target function =                  N/A
              le_mean =     -16.716411742263
             les_mean =     281.968954610240
             stat err =       0.001241678045
             autocorr =       1.206453947762
              std dev =       1.598731654570
             le_variance =       2.555942903324


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671641174226e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716411741337       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716437076193       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716467408658       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716469906603       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.716469920271       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.716469961880       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e-01 is 3.453064e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716411741337       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716423362795       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716437963442       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716438170336       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.716438161825       residual = 1.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 1.562025e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716411741337       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716415413032       residual = 9.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716420188056       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716420205174       residual = 3.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 4.901023e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.088027 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6269e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 6.935652e-01 3 1  ON 0
ci_0002                 6.928185e-01 3 1  ON 1
ci_0003                -4.802226e-02 3 1  ON 2
ci_0004                -4.790070e-02 3 1  ON 3
ci_0005                -4.522288e-02 3 1  ON 4
ci_0006                -4.529218e-02 3 1  ON 5
ci_0007                -3.279687e-02 3 1  ON 6
ci_0008                -3.262855e-02 3 1  ON 7
ci_0009                -3.244004e-02 3 1  ON 8
ci_0010                -3.067822e-02 3 1  ON 9
ci_0011                -2.758045e-02 3 1  ON 10
ci_0012                -2.838462e-02 3 1  ON 11
ci_0013                 2.703950e-02 3 1  ON 12
ci_0014                 2.562162e-02 3 1  ON 13
ci_0015                 2.692856e-02 3 1  ON 14
ci_0016                 2.721585e-02 3 1  ON 15
ci_0017                 2.406459e-02 3 1  ON 16
ci_0018                 2.564791e-02 3 1  ON 17
ci_0019                 2.063795e-02 3 1  ON 18
ci_0020                 1.967166e-02 3 1  ON 19
ci_0021                 1.783106e-02 3 1  ON 20
ci_0022                 1.819347e-02 3 1  ON 21
ci_0023                -1.839585e-02 3 1  ON 22
ci_0024                -1.881887e-02 3 1  ON 23
ci_0025                -1.827063e-02 3 1  ON 24
ci_0026                -1.848062e-02 3 1  ON 25
ci_0027                -1.702207e-02 3 1  ON 26
ci_0028                -1.705986e-02 3 1  ON 27
ci_0029                -1.522599e-02 3 1  ON 28
ci_0030                -1.595602e-02 3 1  ON 29
ci_0031                 1.570752e-02 3 1  ON 30
ci_0032                 1.488728e-02 3 1  ON 31
ci_0033                 1.597319e-02 3 1  ON 32
ci_0034                 1.658437e-02 3 1  ON 33
ci_0035                 1.738134e-02 3 1  ON 34
ci_0036                 1.673787e-02 3 1  ON 35
ci_0037                -1.446542e-02 3 1  ON 36
ci_0038                -1.489781e-02 3 1  ON 37
ci_0039                -1.580195e-02 3 1  ON 38
ci_0040                -1.507401e-02 3 1  ON 39
ci_0041                 1.584495e-02 3 1  ON 40
ci_0042                 1.623292e-02 3 1  ON 41
ci_0043                -1.509383e-02 3 1  ON 42
ci_0044                -1.465328e-02 3 1  ON 43
ci_0045                 1.540951e-02 3 1  ON 44
ci_0046                 1.419395e-02 3 1  ON 45
ci_0047                -1.401197e-02 3 1  ON 46
ci_0048                -1.360893e-02 3 1  ON 47
ci_0049                -1.364658e-02 3 1  ON 48
ci_0050                -1.371642e-02 3 1  ON 49
ci_0051                -1.305373e-02 3 1  ON 50
ci_0052                -1.346347e-02 3 1  ON 51
ci_0053                -1.263633e-02 3 1  ON 52
ci_0054                -1.226931e-02 3 1  ON 53
ci_0055                 1.217428e-02 3 1  ON 54
ci_0056                 1.296365e-02 3 1  ON 55
ci_0057                 1.168405e-02 3 1  ON 56
ci_0058                 1.209135e-02 3 1  ON 57
ci_0059                -1.319898e-02 3 1  ON 58
ci_0060                -1.261479e-02 3 1  ON 59
ci_0061                -1.268767e-02 3 1  ON 60
ci_0062                -1.286323e-02 3 1  ON 61
ci_0063                -1.140586e-02 3 1  ON 62
ci_0064                -1.216725e-02 3 1  ON 63
ci_0065                -1.158189e-02 3 1  ON 64
ci_0066                -1.195945e-02 3 1  ON 65
ci_0067                -1.117426e-02 3 1  ON 66
ci_0068                -1.071084e-02 3 1  ON 67
ci_0069                 1.042447e-02 3 1  ON 68
ci_0070                 1.144078e-02 3 1  ON 69
ci_0071                 9.663717e-03 3 1  ON 70
ci_0072                 9.930495e-03 3 1  ON 71
ci_0073                 1.055033e-02 3 1  ON 72
ci_0074                 1.064830e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.6969
    reference variance = 1.82043
====================================================
  Execution time = 1.2725e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5117e+00
  Total weights = 1.9455e+06
  Execution time = 2.2619e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538592166345
                                         uncertainty =       0.032049428444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538592166345
                                         uncertainty =       0.032049428444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126716788
  error estimate for blocks of size 2^( 2) =       0.001166369759
  error estimate for blocks of size 2^( 3) =       0.001201041897
  error estimate for blocks of size 2^( 4) =       0.001225632716
  error estimate for blocks of size 2^( 5) =       0.001240370581
  error estimate for blocks of size 2^( 6) =       0.001250376152
  error estimate for blocks of size 2^( 7) =       0.001256300880

      target function =                  N/A
              le_mean =     -16.717451296744
             les_mean =     282.000189462349
             stat err =       0.001243170082
             autocorr =       1.217395155660
              std dev =       1.593443656958
             le_variance =       2.539062687899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537781683532
                                         uncertainty =       0.032054123424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537781683532
                                         uncertainty =       0.032054123424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126537610
  error estimate for blocks of size 2^( 2) =       0.001166292879
  error estimate for blocks of size 2^( 3) =       0.001201066057
  error estimate for blocks of size 2^( 4) =       0.001225694620
  error estimate for blocks of size 2^( 5) =       0.001240481085
  error estimate for blocks of size 2^( 6) =       0.001250488574
  error estimate for blocks of size 2^( 7) =       0.001256361276

      target function =                  N/A
              le_mean =     -16.717480555279
             les_mean =     281.999942837825
             stat err =       0.001243256389
             autocorr =       1.217951537385
              std dev =       1.593190257628
             le_variance =       2.538255197002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537660569453
                                         uncertainty =       0.032056274133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537660569453
                                         uncertainty =       0.032056274133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126510824
  error estimate for blocks of size 2^( 2) =       0.001166268050
  error estimate for blocks of size 2^( 3) =       0.001201049327
  error estimate for blocks of size 2^( 4) =       0.001225678606
  error estimate for blocks of size 2^( 5) =       0.001240479537
  error estimate for blocks of size 2^( 6) =       0.001250479175
  error estimate for blocks of size 2^( 7) =       0.001256350360

      target function =                  N/A
              le_mean =     -16.717463814149
             les_mean =     282.153073979757
             stat err =       0.001243246919
             autocorr =       1.217990905953
              std dev =       1.593152375304
             le_variance =       2.538134490938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538206133964
                                         uncertainty =       0.032058230587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538206133964
                                         uncertainty =       0.032058230587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126631312
  error estimate for blocks of size 2^( 2) =       0.001166307209
  error estimate for blocks of size 2^( 3) =       0.001200995910
  error estimate for blocks of size 2^( 4) =       0.001225593730
  error estimate for blocks of size 2^( 5) =       0.001240363236
  error estimate for blocks of size 2^( 6) =       0.001250362394
  error estimate for blocks of size 2^( 7) =       0.001256282284

      target function =                  N/A
              le_mean =     -16.717436372911
             les_mean =     281.988657542651
             stat err =       0.001243150411
             autocorr =       1.217541354679
              std dev =       1.593322773847
             le_variance =       2.538677461659


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717451296744        initial
     1.5625e-01     1.5625e+00             3.4531e-03       -16.717480555279  <--
     6.2500e-01     6.2500e+00             1.5620e-03       -16.717463814149
     2.5000e+00     2.5000e+01             4.9010e-04       -16.717436372911

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.4121e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 6.938261e-01 3 1  ON 0
ci_0002                 6.927307e-01 3 1  ON 1
ci_0003                -4.815010e-02 3 1  ON 2
ci_0004                -4.818488e-02 3 1  ON 3
ci_0005                -4.543975e-02 3 1  ON 4
ci_0006                -4.536170e-02 3 1  ON 5
ci_0007                -3.189310e-02 3 1  ON 6
ci_0008                -3.281329e-02 3 1  ON 7
ci_0009                -3.214890e-02 3 1  ON 8
ci_0010                -2.962330e-02 3 1  ON 9
ci_0011                -2.784318e-02 3 1  ON 10
ci_0012                -2.909447e-02 3 1  ON 11
ci_0013                 2.703867e-02 3 1  ON 12
ci_0014                 2.407705e-02 3 1  ON 13
ci_0015                 2.697852e-02 3 1  ON 14
ci_0016                 2.751099e-02 3 1  ON 15
ci_0017                 2.428358e-02 3 1  ON 16
ci_0018                 2.727829e-02 3 1  ON 17
ci_0019                 2.117692e-02 3 1  ON 18
ci_0020                 1.983241e-02 3 1  ON 19
ci_0021                 1.803550e-02 3 1  ON 20
ci_0022                 1.848048e-02 3 1  ON 21
ci_0023                -1.743373e-02 3 1  ON 22
ci_0024                -1.813903e-02 3 1  ON 23
ci_0025                -1.814864e-02 3 1  ON 24
ci_0026                -1.855076e-02 3 1  ON 25
ci_0027                -1.513103e-02 3 1  ON 26
ci_0028                -1.692274e-02 3 1  ON 27
ci_0029                -1.508030e-02 3 1  ON 28
ci_0030                -1.573819e-02 3 1  ON 29
ci_0031                 1.617751e-02 3 1  ON 30
ci_0032                 1.427926e-02 3 1  ON 31
ci_0033                 1.605556e-02 3 1  ON 32
ci_0034                 1.592664e-02 3 1  ON 33
ci_0035                 1.720662e-02 3 1  ON 34
ci_0036                 1.684332e-02 3 1  ON 35
ci_0037                -1.368824e-02 3 1  ON 36
ci_0038                -1.458783e-02 3 1  ON 37
ci_0039                -1.599170e-02 3 1  ON 38
ci_0040                -1.507015e-02 3 1  ON 39
ci_0041                 1.568519e-02 3 1  ON 40
ci_0042                 1.666484e-02 3 1  ON 41
ci_0043                -1.481492e-02 3 1  ON 42
ci_0044                -1.477961e-02 3 1  ON 43
ci_0045                 1.599153e-02 3 1  ON 44
ci_0046                 1.281786e-02 3 1  ON 45
ci_0047                -1.444291e-02 3 1  ON 46
ci_0048                -1.322406e-02 3 1  ON 47
ci_0049                -1.357285e-02 3 1  ON 48
ci_0050                -1.339042e-02 3 1  ON 49
ci_0051                -1.288855e-02 3 1  ON 50
ci_0052                -1.370121e-02 3 1  ON 51
ci_0053                -1.232122e-02 3 1  ON 52
ci_0054                -1.176639e-02 3 1  ON 53
ci_0055                 1.153185e-02 3 1  ON 54
ci_0056                 1.371963e-02 3 1  ON 55
ci_0057                 1.171712e-02 3 1  ON 56
ci_0058                 1.211017e-02 3 1  ON 57
ci_0059                -1.314916e-02 3 1  ON 58
ci_0060                -1.239917e-02 3 1  ON 59
ci_0061                -1.238573e-02 3 1  ON 60
ci_0062                -1.284292e-02 3 1  ON 61
ci_0063                -1.133349e-02 3 1  ON 62
ci_0064                -1.189454e-02 3 1  ON 63
ci_0065                -1.128152e-02 3 1  ON 64
ci_0066                -1.239751e-02 3 1  ON 65
ci_0067                -1.099923e-02 3 1  ON 66
ci_0068                -1.030464e-02 3 1  ON 67
ci_0069                 1.038884e-02 3 1  ON 68
ci_0070                 1.177495e-02 3 1  ON 69
ci_0071                 9.740956e-03 3 1  ON 70
ci_0072                 9.398943e-03 3 1  ON 71
ci_0073                 1.054918e-02 3 1  ON 72
ci_0074                 1.025765e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0404e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6755e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.7178
    reference variance = 1.82574
====================================================
  Execution time = 1.2982e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0248e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5516e+00
  Total weights = 1.945709402e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1923e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.579478579072
                                         uncertainty =       0.035776175641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.579478579072
                                         uncertainty =       0.035776175641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135585755
  error estimate for blocks of size 2^( 2) =       0.001173144837
  error estimate for blocks of size 2^( 3) =       0.001205800209
  error estimate for blocks of size 2^( 4) =       0.001230159873
  error estimate for blocks of size 2^( 5) =       0.001245096208
  error estimate for blocks of size 2^( 6) =       0.001259675089
  error estimate for blocks of size 2^( 7) =       0.001265403475

      target function =                  N/A
              le_mean =     -16.718405774976
             les_mean =     282.056677625445
             stat err =       0.001250083661
             autocorr =       1.211820473421
              std dev =       1.605986471605
             le_variance =       2.579192546980


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671840577498e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718405774066       residual = 5.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718594070288       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718616343455       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718618040592       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718616162980       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.718618641660       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.718620392114       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.718619822079       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.718619905802       residual = 1.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-02 is 3.118335e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718405774066       residual = 5.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718539830824       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718548937602       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718548775555       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718548388356       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.718548535337       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e-01 is 1.540457e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718405774066       residual = 5.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718468060917       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718469741251       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718469667662       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 6.903578e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093699 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6187e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 6.945858e-01 3 1  ON 0
ci_0002                 6.919415e-01 3 1  ON 1
ci_0003                -4.821534e-02 3 1  ON 2
ci_0004                -4.829448e-02 3 1  ON 3
ci_0005                -4.478327e-02 3 1  ON 4
ci_0006                -4.479514e-02 3 1  ON 5
ci_0007                -3.305648e-02 3 1  ON 6
ci_0008                -3.251402e-02 3 1  ON 7
ci_0009                -3.177014e-02 3 1  ON 8
ci_0010                -3.055865e-02 3 1  ON 9
ci_0011                -2.668738e-02 3 1  ON 10
ci_0012                -2.809296e-02 3 1  ON 11
ci_0013                 2.716420e-02 3 1  ON 12
ci_0014                 2.503918e-02 3 1  ON 13
ci_0015                 2.711834e-02 3 1  ON 14
ci_0016                 2.745209e-02 3 1  ON 15
ci_0017                 2.469335e-02 3 1  ON 16
ci_0018                 2.573783e-02 3 1  ON 17
ci_0019                 2.032154e-02 3 1  ON 18
ci_0020                 1.974746e-02 3 1  ON 19
ci_0021                 1.829697e-02 3 1  ON 20
ci_0022                 1.801085e-02 3 1  ON 21
ci_0023                -1.838394e-02 3 1  ON 22
ci_0024                -1.903640e-02 3 1  ON 23
ci_0025                -1.862848e-02 3 1  ON 24
ci_0026                -1.819341e-02 3 1  ON 25
ci_0027                -1.630254e-02 3 1  ON 26
ci_0028                -1.704214e-02 3 1  ON 27
ci_0029                -1.627579e-02 3 1  ON 28
ci_0030                -1.615825e-02 3 1  ON 29
ci_0031                 1.527739e-02 3 1  ON 30
ci_0032                 1.412176e-02 3 1  ON 31
ci_0033                 1.571938e-02 3 1  ON 32
ci_0034                 1.692481e-02 3 1  ON 33
ci_0035                 1.751530e-02 3 1  ON 34
ci_0036                 1.725766e-02 3 1  ON 35
ci_0037                -1.398310e-02 3 1  ON 36
ci_0038                -1.523995e-02 3 1  ON 37
ci_0039                -1.540603e-02 3 1  ON 38
ci_0040                -1.557495e-02 3 1  ON 39
ci_0041                 1.547364e-02 3 1  ON 40
ci_0042                 1.588950e-02 3 1  ON 41
ci_0043                -1.566655e-02 3 1  ON 42
ci_0044                -1.544964e-02 3 1  ON 43
ci_0045                 1.564445e-02 3 1  ON 44
ci_0046                 1.435819e-02 3 1  ON 45
ci_0047                -1.445991e-02 3 1  ON 46
ci_0048                -1.404498e-02 3 1  ON 47
ci_0049                -1.257233e-02 3 1  ON 48
ci_0050                -1.298597e-02 3 1  ON 49
ci_0051                -1.266889e-02 3 1  ON 50
ci_0052                -1.317881e-02 3 1  ON 51
ci_0053                -1.293357e-02 3 1  ON 52
ci_0054                -1.264417e-02 3 1  ON 53
ci_0055                 1.188039e-02 3 1  ON 54
ci_0056                 1.276070e-02 3 1  ON 55
ci_0057                 1.282485e-02 3 1  ON 56
ci_0058                 1.213448e-02 3 1  ON 57
ci_0059                -1.287377e-02 3 1  ON 58
ci_0060                -1.280690e-02 3 1  ON 59
ci_0061                -1.243360e-02 3 1  ON 60
ci_0062                -1.266539e-02 3 1  ON 61
ci_0063                -1.155951e-02 3 1  ON 62
ci_0064                -1.157678e-02 3 1  ON 63
ci_0065                -1.120006e-02 3 1  ON 64
ci_0066                -1.107868e-02 3 1  ON 65
ci_0067                -1.139313e-02 3 1  ON 66
ci_0068                -1.070287e-02 3 1  ON 67
ci_0069                 1.078709e-02 3 1  ON 68
ci_0070                 1.100732e-02 3 1  ON 69
ci_0071                 9.477896e-03 3 1  ON 70
ci_0072                 9.687900e-03 3 1  ON 71
ci_0073                 1.072376e-02 3 1  ON 72
ci_0074                 1.063539e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.7858
    reference variance = 1.81154
====================================================
  Execution time = 1.2746e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.4939e+00
  Total weights = 1.9457e+06
  Execution time = 2.2568e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0195101
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.524716938059
                                         uncertainty =       0.024046074830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.524716938059
                                         uncertainty =       0.024046074830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001123567406
  error estimate for blocks of size 2^( 2) =       0.001161832837
  error estimate for blocks of size 2^( 3) =       0.001194322267
  error estimate for blocks of size 2^( 4) =       0.001218245198
  error estimate for blocks of size 2^( 5) =       0.001233704221
  error estimate for blocks of size 2^( 6) =       0.001240610015
  error estimate for blocks of size 2^( 7) =       0.001241393259

      target function =                  N/A
              le_mean =     -16.718394608269
             les_mean =     282.246349826838
             stat err =       0.001233488173
             autocorr =       1.205234945319
              std dev =       1.588989687307
             le_variance =       2.524888226368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.534380083926
                                         uncertainty =       0.026291320763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.534380083926
                                         uncertainty =       0.026291320763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125716814
  error estimate for blocks of size 2^( 2) =       0.001163881492
  error estimate for blocks of size 2^( 3) =       0.001196125313
  error estimate for blocks of size 2^( 4) =       0.001219702403
  error estimate for blocks of size 2^( 5) =       0.001235013611
  error estimate for blocks of size 2^( 6) =       0.001242247554
  error estimate for blocks of size 2^( 7) =       0.001243506255

      target function =                  N/A
              le_mean =     -16.718456049632
             les_mean =     286.330701135662
             stat err =       0.001235117456
             autocorr =       1.203810739104
              std dev =       1.592029458056
             le_variance =       2.534557795319

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0190654
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.521083075997
                                         uncertainty =       0.024302960906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.521083075997
                                         uncertainty =       0.024302960906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122760263
  error estimate for blocks of size 2^( 2) =       0.001160979544
  error estimate for blocks of size 2^( 3) =       0.001193378644
  error estimate for blocks of size 2^( 4) =       0.001217214944
  error estimate for blocks of size 2^( 5) =       0.001232674359
  error estimate for blocks of size 2^( 6) =       0.001239605474
  error estimate for blocks of size 2^( 7) =       0.001240232093

      target function =                  N/A
              le_mean =     -16.718450022658
             les_mean =     282.003495260627
             stat err =       0.001232431718
             autocorr =       1.204901835394
              std dev =       1.587848196761
             le_variance =       2.521261895957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.520593003604
                                         uncertainty =       0.024305031621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.520593003604
                                         uncertainty =       0.024305031621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122650863
  error estimate for blocks of size 2^( 2) =       0.001160920969
  error estimate for blocks of size 2^( 3) =       0.001193379618
  error estimate for blocks of size 2^( 4) =       0.001217279390
  error estimate for blocks of size 2^( 5) =       0.001232825381
  error estimate for blocks of size 2^( 6) =       0.001239767778
  error estimate for blocks of size 2^( 7) =       0.001240390089

      target function =                  N/A
              le_mean =     -16.718355702743
             les_mean =     281.998845145707
             stat err =       0.001232565659
             autocorr =       1.205398641548
              std dev =       1.587693479450
             le_variance =       2.520770584687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718394608269        initial
     3.9062e-02     3.9062e-01             3.1183e-03       -16.718456049632  <--
     1.5625e-01     1.5625e+00             1.5405e-03       -16.718450022658
     6.2500e-01     6.2500e+00             6.9036e-04       -16.718355702743

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 2.4155e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 6.969149e-01 3 1  ON 0
ci_0002                 6.896124e-01 3 1  ON 1
ci_0003                -4.838093e-02 3 1  ON 2
ci_0004                -4.819900e-02 3 1  ON 3
ci_0005                -4.443914e-02 3 1  ON 4
ci_0006                -4.419010e-02 3 1  ON 5
ci_0007                -3.398399e-02 3 1  ON 6
ci_0008                -3.220350e-02 3 1  ON 7
ci_0009                -3.163156e-02 3 1  ON 8
ci_0010                -3.081997e-02 3 1  ON 9
ci_0011                -2.623425e-02 3 1  ON 10
ci_0012                -2.751492e-02 3 1  ON 11
ci_0013                 2.723563e-02 3 1  ON 12
ci_0014                 2.539206e-02 3 1  ON 13
ci_0015                 2.719942e-02 3 1  ON 14
ci_0016                 2.734274e-02 3 1  ON 15
ci_0017                 2.492811e-02 3 1  ON 16
ci_0018                 2.499545e-02 3 1  ON 17
ci_0019                 1.997086e-02 3 1  ON 18
ci_0020                 1.964922e-02 3 1  ON 19
ci_0021                 1.856572e-02 3 1  ON 20
ci_0022                 1.754560e-02 3 1  ON 21
ci_0023                -1.884079e-02 3 1  ON 22
ci_0024                -1.934656e-02 3 1  ON 23
ci_0025                -1.887828e-02 3 1  ON 24
ci_0026                -1.796010e-02 3 1  ON 25
ci_0027                -1.688817e-02 3 1  ON 26
ci_0028                -1.701191e-02 3 1  ON 27
ci_0029                -1.690847e-02 3 1  ON 28
ci_0030                -1.630829e-02 3 1  ON 29
ci_0031                 1.489571e-02 3 1  ON 30
ci_0032                 1.398661e-02 3 1  ON 31
ci_0033                 1.547645e-02 3 1  ON 32
ci_0034                 1.766859e-02 3 1  ON 33
ci_0035                 1.774761e-02 3 1  ON 34
ci_0036                 1.738966e-02 3 1  ON 35
ci_0037                -1.420211e-02 3 1  ON 36
ci_0038                -1.555386e-02 3 1  ON 37
ci_0039                -1.528835e-02 3 1  ON 38
ci_0040                -1.567346e-02 3 1  ON 39
ci_0041                 1.541895e-02 3 1  ON 40
ci_0042                 1.551880e-02 3 1  ON 41
ci_0043                -1.647600e-02 3 1  ON 42
ci_0044                -1.594797e-02 3 1  ON 43
ci_0045                 1.547572e-02 3 1  ON 44
ci_0046                 1.525687e-02 3 1  ON 45
ci_0047                -1.449728e-02 3 1  ON 46
ci_0048                -1.424452e-02 3 1  ON 47
ci_0049                -1.217082e-02 3 1  ON 48
ci_0050                -1.281398e-02 3 1  ON 49
ci_0051                -1.263935e-02 3 1  ON 50
ci_0052                -1.296464e-02 3 1  ON 51
ci_0053                -1.315300e-02 3 1  ON 52
ci_0054                -1.289307e-02 3 1  ON 53
ci_0055                 1.206385e-02 3 1  ON 54
ci_0056                 1.223364e-02 3 1  ON 55
ci_0057                 1.338624e-02 3 1  ON 56
ci_0058                 1.208911e-02 3 1  ON 57
ci_0059                -1.282602e-02 3 1  ON 58
ci_0060                -1.287346e-02 3 1  ON 59
ci_0061                -1.248595e-02 3 1  ON 60
ci_0062                -1.255119e-02 3 1  ON 61
ci_0063                -1.166681e-02 3 1  ON 62
ci_0064                -1.139514e-02 3 1  ON 63
ci_0065                -1.120955e-02 3 1  ON 64
ci_0066                -1.061444e-02 3 1  ON 65
ci_0067                -1.150708e-02 3 1  ON 66
ci_0068                -1.078081e-02 3 1  ON 67
ci_0069                 1.088430e-02 3 1  ON 68
ci_0070                 1.072897e-02 3 1  ON 69
ci_0071                 9.437052e-03 3 1  ON 70
ci_0072                 9.807516e-03 3 1  ON 71
ci_0073                 1.079219e-02 3 1  ON 72
ci_0074                 1.071859e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0355e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6755e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.829
    reference variance = 1.67048
====================================================
  Execution time = 1.2970e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0224e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5271e+00
  Total weights = 1.945713534e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1766e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554029627246
                                         uncertainty =       0.025188862424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554029627246
                                         uncertainty =       0.025188862424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129933376
  error estimate for blocks of size 2^( 2) =       0.001168990451
  error estimate for blocks of size 2^( 3) =       0.001202202081
  error estimate for blocks of size 2^( 4) =       0.001225148561
  error estimate for blocks of size 2^( 5) =       0.001240281965
  error estimate for blocks of size 2^( 6) =       0.001249462011
  error estimate for blocks of size 2^( 7) =       0.001255689912

      target function =                  N/A
              le_mean =     -16.718764260634
             les_mean =     282.044131447848
             stat err =       0.001242645612
             autocorr =       1.209452752320
              std dev =       1.597992672364
             le_variance =       2.553580580928


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671876426063e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718764259705       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718862042205       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718889557888       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718891704981       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718903498417       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.718914721196       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.718911659732       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.718912992629       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.718913820388       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.718913905138       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-03 is 1.620633e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718764259705       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718850899949       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718870339214       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718870535593       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718874512472       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.718874574780       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.718873264050       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.718873321247       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-02 is 3.538578e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718764259705       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718823773389       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718830841683       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718830405048       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718830807759       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.718830731024       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e-01 is 1.524576e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099794 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6161e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.004535e-01 3 1  ON 0
ci_0002                 6.863416e-01 3 1  ON 1
ci_0003                -4.785128e-02 3 1  ON 2
ci_0004                -4.787648e-02 3 1  ON 3
ci_0005                -4.371136e-02 3 1  ON 4
ci_0006                -4.456073e-02 3 1  ON 5
ci_0007                -3.121053e-02 3 1  ON 6
ci_0008                -3.286667e-02 3 1  ON 7
ci_0009                -3.168610e-02 3 1  ON 8
ci_0010                -3.193141e-02 3 1  ON 9
ci_0011                -2.570766e-02 3 1  ON 10
ci_0012                -2.653044e-02 3 1  ON 11
ci_0013                 2.748276e-02 3 1  ON 12
ci_0014                 2.728529e-02 3 1  ON 13
ci_0015                 2.702185e-02 3 1  ON 14
ci_0016                 2.649680e-02 3 1  ON 15
ci_0017                 2.384047e-02 3 1  ON 16
ci_0018                 2.401970e-02 3 1  ON 17
ci_0019                 2.046766e-02 3 1  ON 18
ci_0020                 2.006798e-02 3 1  ON 19
ci_0021                 1.683456e-02 3 1  ON 20
ci_0022                 1.885467e-02 3 1  ON 21
ci_0023                -1.822781e-02 3 1  ON 22
ci_0024                -1.836626e-02 3 1  ON 23
ci_0025                -1.793963e-02 3 1  ON 24
ci_0026                -1.822083e-02 3 1  ON 25
ci_0027                -1.700375e-02 3 1  ON 26
ci_0028                -1.768635e-02 3 1  ON 27
ci_0029                -1.475893e-02 3 1  ON 28
ci_0030                -1.552340e-02 3 1  ON 29
ci_0031                 1.458429e-02 3 1  ON 30
ci_0032                 1.482136e-02 3 1  ON 31
ci_0033                 1.797194e-02 3 1  ON 32
ci_0034                 1.597012e-02 3 1  ON 33
ci_0035                 1.738799e-02 3 1  ON 34
ci_0036                 1.684755e-02 3 1  ON 35
ci_0037                -1.613168e-02 3 1  ON 36
ci_0038                -1.554501e-02 3 1  ON 37
ci_0039                -1.582306e-02 3 1  ON 38
ci_0040                -1.576993e-02 3 1  ON 39
ci_0041                 1.534693e-02 3 1  ON 40
ci_0042                 1.515793e-02 3 1  ON 41
ci_0043                -1.554282e-02 3 1  ON 42
ci_0044                -1.413262e-02 3 1  ON 43
ci_0045                 1.556921e-02 3 1  ON 44
ci_0046                 1.579302e-02 3 1  ON 45
ci_0047                -1.403964e-02 3 1  ON 46
ci_0048                -1.451641e-02 3 1  ON 47
ci_0049                -1.257632e-02 3 1  ON 48
ci_0050                -1.366335e-02 3 1  ON 49
ci_0051                -1.332606e-02 3 1  ON 50
ci_0052                -1.284592e-02 3 1  ON 51
ci_0053                -1.254573e-02 3 1  ON 52
ci_0054                -1.231786e-02 3 1  ON 53
ci_0055                 1.178675e-02 3 1  ON 54
ci_0056                 1.413153e-02 3 1  ON 55
ci_0057                 1.231391e-02 3 1  ON 56
ci_0058                 1.156694e-02 3 1  ON 57
ci_0059                -1.318436e-02 3 1  ON 58
ci_0060                -1.264128e-02 3 1  ON 59
ci_0061                -1.308541e-02 3 1  ON 60
ci_0062                -1.227537e-02 3 1  ON 61
ci_0063                -1.163437e-02 3 1  ON 62
ci_0064                -1.204050e-02 3 1  ON 63
ci_0065                -1.096913e-02 3 1  ON 64
ci_0066                -1.020624e-02 3 1  ON 65
ci_0067                -1.194532e-02 3 1  ON 66
ci_0068                -1.096729e-02 3 1  ON 67
ci_0069                 1.120666e-02 3 1  ON 68
ci_0070                 1.121638e-02 3 1  ON 69
ci_0071                 9.397335e-03 3 1  ON 70
ci_0072                 9.491690e-03 3 1  ON 71
ci_0073                 1.081614e-02 3 1  ON 72
ci_0074                 1.088907e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8352
    reference variance = 1.37427
====================================================
  Execution time = 1.2711e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5026e+00
  Total weights = 1.9455e+06
  Execution time = 2.2586e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533439391957
                                         uncertainty =       0.021307032524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533439391957
                                         uncertainty =       0.021307032524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125492598
  error estimate for blocks of size 2^( 2) =       0.001164201461
  error estimate for blocks of size 2^( 3) =       0.001197735354
  error estimate for blocks of size 2^( 4) =       0.001221307842
  error estimate for blocks of size 2^( 5) =       0.001235727487
  error estimate for blocks of size 2^( 6) =       0.001244494183
  error estimate for blocks of size 2^( 7) =       0.001256175365

      target function =                  N/A
              le_mean =     -16.717881508912
             les_mean =     282.089645303977
             stat err =       0.001239426219
             autocorr =       1.212707523582
              std dev =       1.591712363282
             le_variance =       2.533548247426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.532001287109
                                         uncertainty =       0.021100481756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.532001287109
                                         uncertainty =       0.021100481756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125171712
  error estimate for blocks of size 2^( 2) =       0.001163945300
  error estimate for blocks of size 2^( 3) =       0.001197570741
  error estimate for blocks of size 2^( 4) =       0.001221112243
  error estimate for blocks of size 2^( 5) =       0.001235613347
  error estimate for blocks of size 2^( 6) =       0.001244525755
  error estimate for blocks of size 2^( 7) =       0.001256438291

      target function =                  N/A
              le_mean =     -16.717729175519
             les_mean =     282.001789337621
             stat err =       0.001239422409
             autocorr =       1.213391861273
              std dev =       1.591258555299
             le_variance =       2.532103789811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531878098634
                                         uncertainty =       0.021206115995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531878098634
                                         uncertainty =       0.021206115995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125145062
  error estimate for blocks of size 2^( 2) =       0.001163966575
  error estimate for blocks of size 2^( 3) =       0.001197629071
  error estimate for blocks of size 2^( 4) =       0.001221274934
  error estimate for blocks of size 2^( 5) =       0.001235803875
  error estimate for blocks of size 2^( 6) =       0.001244798391
  error estimate for blocks of size 2^( 7) =       0.001256602669

      target function =                  N/A
              le_mean =     -16.717856811462
             les_mean =     282.030429140244
             stat err =       0.001239619967
             autocorr =       1.213836211407
              std dev =       1.591220864936
             le_variance =       2.531983841006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.791995990204
                                         uncertainty =       0.260433686462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.791995990204
                                         uncertainty =       0.260433686462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001181512490
  error estimate for blocks of size 2^( 2) =       0.001218307724
  error estimate for blocks of size 2^( 3) =       0.001250587126
  error estimate for blocks of size 2^( 4) =       0.001273121401
  error estimate for blocks of size 2^( 5) =       0.001287109980
  error estimate for blocks of size 2^( 6) =       0.001295913159
  error estimate for blocks of size 2^( 7) =       0.001306320672

      target function =                  N/A
              le_mean =     -16.717377338684
             les_mean =     345.252360912809
             stat err =       0.001290616303
             autocorr =       1.193212128805
              std dev =       1.670937722306
             le_variance =       2.792032871825


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717881508912        initial  <--
     9.7656e-03     9.7656e-02             1.6206e-02       -16.717729175519
     3.9062e-02     3.9062e-01             3.5386e-03       -16.717856811462
     1.5625e-01     1.5625e+00             1.5246e-03       -16.717377338684

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0977
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 6.969149e-01 3 1  ON 0
ci_0002                 6.896124e-01 3 1  ON 1
ci_0003                -4.838093e-02 3 1  ON 2
ci_0004                -4.819900e-02 3 1  ON 3
ci_0005                -4.443914e-02 3 1  ON 4
ci_0006                -4.419010e-02 3 1  ON 5
ci_0007                -3.398399e-02 3 1  ON 6
ci_0008                -3.220350e-02 3 1  ON 7
ci_0009                -3.163156e-02 3 1  ON 8
ci_0010                -3.081997e-02 3 1  ON 9
ci_0011                -2.623425e-02 3 1  ON 10
ci_0012                -2.751492e-02 3 1  ON 11
ci_0013                 2.723563e-02 3 1  ON 12
ci_0014                 2.539206e-02 3 1  ON 13
ci_0015                 2.719942e-02 3 1  ON 14
ci_0016                 2.734274e-02 3 1  ON 15
ci_0017                 2.492811e-02 3 1  ON 16
ci_0018                 2.499545e-02 3 1  ON 17
ci_0019                 1.997086e-02 3 1  ON 18
ci_0020                 1.964922e-02 3 1  ON 19
ci_0021                 1.856572e-02 3 1  ON 20
ci_0022                 1.754560e-02 3 1  ON 21
ci_0023                -1.884079e-02 3 1  ON 22
ci_0024                -1.934656e-02 3 1  ON 23
ci_0025                -1.887828e-02 3 1  ON 24
ci_0026                -1.796010e-02 3 1  ON 25
ci_0027                -1.688817e-02 3 1  ON 26
ci_0028                -1.701191e-02 3 1  ON 27
ci_0029                -1.690847e-02 3 1  ON 28
ci_0030                -1.630829e-02 3 1  ON 29
ci_0031                 1.489571e-02 3 1  ON 30
ci_0032                 1.398661e-02 3 1  ON 31
ci_0033                 1.547645e-02 3 1  ON 32
ci_0034                 1.766859e-02 3 1  ON 33
ci_0035                 1.774761e-02 3 1  ON 34
ci_0036                 1.738966e-02 3 1  ON 35
ci_0037                -1.420211e-02 3 1  ON 36
ci_0038                -1.555386e-02 3 1  ON 37
ci_0039                -1.528835e-02 3 1  ON 38
ci_0040                -1.567346e-02 3 1  ON 39
ci_0041                 1.541895e-02 3 1  ON 40
ci_0042                 1.551880e-02 3 1  ON 41
ci_0043                -1.647600e-02 3 1  ON 42
ci_0044                -1.594797e-02 3 1  ON 43
ci_0045                 1.547572e-02 3 1  ON 44
ci_0046                 1.525687e-02 3 1  ON 45
ci_0047                -1.449728e-02 3 1  ON 46
ci_0048                -1.424452e-02 3 1  ON 47
ci_0049                -1.217082e-02 3 1  ON 48
ci_0050                -1.281398e-02 3 1  ON 49
ci_0051                -1.263935e-02 3 1  ON 50
ci_0052                -1.296464e-02 3 1  ON 51
ci_0053                -1.315300e-02 3 1  ON 52
ci_0054                -1.289307e-02 3 1  ON 53
ci_0055                 1.206385e-02 3 1  ON 54
ci_0056                 1.223364e-02 3 1  ON 55
ci_0057                 1.338624e-02 3 1  ON 56
ci_0058                 1.208911e-02 3 1  ON 57
ci_0059                -1.282602e-02 3 1  ON 58
ci_0060                -1.287346e-02 3 1  ON 59
ci_0061                -1.248595e-02 3 1  ON 60
ci_0062                -1.255119e-02 3 1  ON 61
ci_0063                -1.166681e-02 3 1  ON 62
ci_0064                -1.139514e-02 3 1  ON 63
ci_0065                -1.120955e-02 3 1  ON 64
ci_0066                -1.061444e-02 3 1  ON 65
ci_0067                -1.150708e-02 3 1  ON 66
ci_0068                -1.078081e-02 3 1  ON 67
ci_0069                 1.088430e-02 3 1  ON 68
ci_0070                 1.072897e-02 3 1  ON 69
ci_0071                 9.437052e-03 3 1  ON 70
ci_0072                 9.807516e-03 3 1  ON 71
ci_0073                 1.079219e-02 3 1  ON 72
ci_0074                 1.071859e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6766e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8301
    reference variance = 1.76633
====================================================
  Execution time = 1.3042e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0275e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5637e+00
  Total weights = 1.945600232e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1826e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592678956723
                                         uncertainty =       0.044459466625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592678956723
                                         uncertainty =       0.044459466625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138493920
  error estimate for blocks of size 2^( 2) =       0.001177182663
  error estimate for blocks of size 2^( 3) =       0.001207845543
  error estimate for blocks of size 2^( 4) =       0.001232294119
  error estimate for blocks of size 2^( 5) =       0.001244586946
  error estimate for blocks of size 2^( 6) =       0.001254871625
  error estimate for blocks of size 2^( 7) =       0.001267946928

      target function =                  N/A
              le_mean =     -16.719182150301
             les_mean =     282.094734111265
             stat err =       0.001249924904
             autocorr =       1.205331236759
              std dev =       1.610099302636
             le_variance =       2.592419764350


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671918215030e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719182149357       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719250724735       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719256560530       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719258776670       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.719259441379       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.719259824599       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.719259724621       residual = 8.90e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-02 is 1.433935e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719182149357       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719217876564       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719218767691       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719218955161       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 7.532373e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719182149357       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719194401280       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719194423914       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 2.578772e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104001 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6236e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 6.972331e-01 3 1  ON 0
ci_0002                 6.893132e-01 3 1  ON 1
ci_0003                -4.841125e-02 3 1  ON 2
ci_0004                -4.769215e-02 3 1  ON 3
ci_0005                -4.502514e-02 3 1  ON 4
ci_0006                -4.412271e-02 3 1  ON 5
ci_0007                -3.377113e-02 3 1  ON 6
ci_0008                -3.256400e-02 3 1  ON 7
ci_0009                -3.157667e-02 3 1  ON 8
ci_0010                -3.076726e-02 3 1  ON 9
ci_0011                -2.619095e-02 3 1  ON 10
ci_0012                -2.794944e-02 3 1  ON 11
ci_0013                 2.690986e-02 3 1  ON 12
ci_0014                 2.614529e-02 3 1  ON 13
ci_0015                 2.675454e-02 3 1  ON 14
ci_0016                 2.681210e-02 3 1  ON 15
ci_0017                 2.457714e-02 3 1  ON 16
ci_0018                 2.468226e-02 3 1  ON 17
ci_0019                 2.006550e-02 3 1  ON 18
ci_0020                 1.971144e-02 3 1  ON 19
ci_0021                 1.802200e-02 3 1  ON 20
ci_0022                 1.772192e-02 3 1  ON 21
ci_0023                -1.916321e-02 3 1  ON 22
ci_0024                -1.915704e-02 3 1  ON 23
ci_0025                -1.844507e-02 3 1  ON 24
ci_0026                -1.807047e-02 3 1  ON 25
ci_0027                -1.725209e-02 3 1  ON 26
ci_0028                -1.707487e-02 3 1  ON 27
ci_0029                -1.622435e-02 3 1  ON 28
ci_0030                -1.625393e-02 3 1  ON 29
ci_0031                 1.494264e-02 3 1  ON 30
ci_0032                 1.455688e-02 3 1  ON 31
ci_0033                 1.595076e-02 3 1  ON 32
ci_0034                 1.713136e-02 3 1  ON 33
ci_0035                 1.778250e-02 3 1  ON 34
ci_0036                 1.717729e-02 3 1  ON 35
ci_0037                -1.453342e-02 3 1  ON 36
ci_0038                -1.537621e-02 3 1  ON 37
ci_0039                -1.539552e-02 3 1  ON 38
ci_0040                -1.560955e-02 3 1  ON 39
ci_0041                 1.565413e-02 3 1  ON 40
ci_0042                 1.541428e-02 3 1  ON 41
ci_0043                -1.621826e-02 3 1  ON 42
ci_0044                -1.620331e-02 3 1  ON 43
ci_0045                 1.566462e-02 3 1  ON 44
ci_0046                 1.523389e-02 3 1  ON 45
ci_0047                -1.429776e-02 3 1  ON 46
ci_0048                -1.432796e-02 3 1  ON 47
ci_0049                -1.271790e-02 3 1  ON 48
ci_0050                -1.270984e-02 3 1  ON 49
ci_0051                -1.273342e-02 3 1  ON 50
ci_0052                -1.274066e-02 3 1  ON 51
ci_0053                -1.298587e-02 3 1  ON 52
ci_0054                -1.242650e-02 3 1  ON 53
ci_0055                 1.243770e-02 3 1  ON 54
ci_0056                 1.185180e-02 3 1  ON 55
ci_0057                 1.338939e-02 3 1  ON 56
ci_0058                 1.240250e-02 3 1  ON 57
ci_0059                -1.288039e-02 3 1  ON 58
ci_0060                -1.286283e-02 3 1  ON 59
ci_0061                -1.214587e-02 3 1  ON 60
ci_0062                -1.289564e-02 3 1  ON 61
ci_0063                -1.130383e-02 3 1  ON 62
ci_0064                -1.181068e-02 3 1  ON 63
ci_0065                -1.140248e-02 3 1  ON 64
ci_0066                -1.072414e-02 3 1  ON 65
ci_0067                -1.121545e-02 3 1  ON 66
ci_0068                -1.093564e-02 3 1  ON 67
ci_0069                 1.116925e-02 3 1  ON 68
ci_0070                 1.045097e-02 3 1  ON 69
ci_0071                 1.004573e-02 3 1  ON 70
ci_0072                 9.742766e-03 3 1  ON 71
ci_0073                 1.084186e-02 3 1  ON 72
ci_0074                 1.091607e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.42
    reference variance = 2.35774
====================================================
  Execution time = 1.2696e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.4907e+00
  Total weights = 1.9458e+06
  Execution time = 2.2592e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515583000848
                                         uncertainty =       0.034870803991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515583000848
                                         uncertainty =       0.034870803991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121654911
  error estimate for blocks of size 2^( 2) =       0.001160995474
  error estimate for blocks of size 2^( 3) =       0.001193593375
  error estimate for blocks of size 2^( 4) =       0.001217152229
  error estimate for blocks of size 2^( 5) =       0.001232942413
  error estimate for blocks of size 2^( 6) =       0.001237074415
  error estimate for blocks of size 2^( 7) =       0.001244153147

      target function =                  N/A
              le_mean =     -16.719849620586
             les_mean =     282.087989693346
             stat err =       0.001232830551
             autocorr =       1.208059298485
              std dev =       1.586284966706
             le_variance =       2.516299995598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.516098875087
                                         uncertainty =       0.034868526576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.516098875087
                                         uncertainty =       0.034868526576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121768691
  error estimate for blocks of size 2^( 2) =       0.001161096400
  error estimate for blocks of size 2^( 3) =       0.001193700820
  error estimate for blocks of size 2^( 4) =       0.001217280361
  error estimate for blocks of size 2^( 5) =       0.001233061973
  error estimate for blocks of size 2^( 6) =       0.001237163035
  error estimate for blocks of size 2^( 7) =       0.001244209098

      target function =                  N/A
              le_mean =     -16.719873786484
             les_mean =     282.052231079992
             stat err =       0.001232928617
             autocorr =       1.208006403226
              std dev =       1.586445879659
             le_variance =       2.516810529087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.516197602914
                                         uncertainty =       0.034872961089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.516197602914
                                         uncertainty =       0.034872961089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121790514
  error estimate for blocks of size 2^( 2) =       0.001161122014
  error estimate for blocks of size 2^( 3) =       0.001193731301
  error estimate for blocks of size 2^( 4) =       0.001217313485
  error estimate for blocks of size 2^( 5) =       0.001233092119
  error estimate for blocks of size 2^( 6) =       0.001237198380
  error estimate for blocks of size 2^( 7) =       0.001244241880

      target function =                  N/A
              le_mean =     -16.719873899722
             les_mean =     282.047470224174
             stat err =       0.001232961466
             autocorr =       1.208023772129
              std dev =       1.586476742314
             le_variance =       2.516908453904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515586093817
                                         uncertainty =       0.034861707623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515586093817
                                         uncertainty =       0.034861707623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121655381
  error estimate for blocks of size 2^( 2) =       0.001160995134
  error estimate for blocks of size 2^( 3) =       0.001193605598
  error estimate for blocks of size 2^( 4) =       0.001217170234
  error estimate for blocks of size 2^( 5) =       0.001232972454
  error estimate for blocks of size 2^( 6) =       0.001237080805
  error estimate for blocks of size 2^( 7) =       0.001244182799

      target function =                  N/A
              le_mean =     -16.719861665866
             les_mean =     282.080519817802
             stat err =       0.001232851573
             autocorr =       1.208099484762
              std dev =       1.586285631759
             le_variance =       2.516302105526


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719849620586        initial
     9.7656e-02     9.7656e-01             1.4339e-03       -16.719873786484
     3.9062e-01     3.9062e+00             7.5324e-04       -16.719873899722  <--
     1.5625e+00     1.5625e+01             2.5788e-04       -16.719861665866

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.4093e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 6.972331e-01 3 1  ON 0
ci_0002                 6.893132e-01 3 1  ON 1
ci_0003                -4.841125e-02 3 1  ON 2
ci_0004                -4.769215e-02 3 1  ON 3
ci_0005                -4.502514e-02 3 1  ON 4
ci_0006                -4.412271e-02 3 1  ON 5
ci_0007                -3.377113e-02 3 1  ON 6
ci_0008                -3.256400e-02 3 1  ON 7
ci_0009                -3.157667e-02 3 1  ON 8
ci_0010                -3.076726e-02 3 1  ON 9
ci_0011                -2.619095e-02 3 1  ON 10
ci_0012                -2.794944e-02 3 1  ON 11
ci_0013                 2.690986e-02 3 1  ON 12
ci_0014                 2.614529e-02 3 1  ON 13
ci_0015                 2.675454e-02 3 1  ON 14
ci_0016                 2.681210e-02 3 1  ON 15
ci_0017                 2.457714e-02 3 1  ON 16
ci_0018                 2.468226e-02 3 1  ON 17
ci_0019                 2.006550e-02 3 1  ON 18
ci_0020                 1.971144e-02 3 1  ON 19
ci_0021                 1.802200e-02 3 1  ON 20
ci_0022                 1.772192e-02 3 1  ON 21
ci_0023                -1.916321e-02 3 1  ON 22
ci_0024                -1.915704e-02 3 1  ON 23
ci_0025                -1.844507e-02 3 1  ON 24
ci_0026                -1.807047e-02 3 1  ON 25
ci_0027                -1.725209e-02 3 1  ON 26
ci_0028                -1.707487e-02 3 1  ON 27
ci_0029                -1.622435e-02 3 1  ON 28
ci_0030                -1.625393e-02 3 1  ON 29
ci_0031                 1.494264e-02 3 1  ON 30
ci_0032                 1.455688e-02 3 1  ON 31
ci_0033                 1.595076e-02 3 1  ON 32
ci_0034                 1.713136e-02 3 1  ON 33
ci_0035                 1.778250e-02 3 1  ON 34
ci_0036                 1.717729e-02 3 1  ON 35
ci_0037                -1.453342e-02 3 1  ON 36
ci_0038                -1.537621e-02 3 1  ON 37
ci_0039                -1.539552e-02 3 1  ON 38
ci_0040                -1.560955e-02 3 1  ON 39
ci_0041                 1.565413e-02 3 1  ON 40
ci_0042                 1.541428e-02 3 1  ON 41
ci_0043                -1.621826e-02 3 1  ON 42
ci_0044                -1.620331e-02 3 1  ON 43
ci_0045                 1.566462e-02 3 1  ON 44
ci_0046                 1.523389e-02 3 1  ON 45
ci_0047                -1.429776e-02 3 1  ON 46
ci_0048                -1.432796e-02 3 1  ON 47
ci_0049                -1.271790e-02 3 1  ON 48
ci_0050                -1.270984e-02 3 1  ON 49
ci_0051                -1.273342e-02 3 1  ON 50
ci_0052                -1.274066e-02 3 1  ON 51
ci_0053                -1.298587e-02 3 1  ON 52
ci_0054                -1.242650e-02 3 1  ON 53
ci_0055                 1.243770e-02 3 1  ON 54
ci_0056                 1.185180e-02 3 1  ON 55
ci_0057                 1.338939e-02 3 1  ON 56
ci_0058                 1.240250e-02 3 1  ON 57
ci_0059                -1.288039e-02 3 1  ON 58
ci_0060                -1.286283e-02 3 1  ON 59
ci_0061                -1.214587e-02 3 1  ON 60
ci_0062                -1.289564e-02 3 1  ON 61
ci_0063                -1.130383e-02 3 1  ON 62
ci_0064                -1.181068e-02 3 1  ON 63
ci_0065                -1.140248e-02 3 1  ON 64
ci_0066                -1.072414e-02 3 1  ON 65
ci_0067                -1.121545e-02 3 1  ON 66
ci_0068                -1.093564e-02 3 1  ON 67
ci_0069                 1.116925e-02 3 1  ON 68
ci_0070                 1.045097e-02 3 1  ON 69
ci_0071                 1.004573e-02 3 1  ON 70
ci_0072                 9.742766e-03 3 1  ON 71
ci_0073                 1.084186e-02 3 1  ON 72
ci_0074                 1.091607e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0342e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6748e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.6498
    reference variance = 2.37843
====================================================
  Execution time = 1.2979e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0229e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5155e+00
  Total weights = 1.945502435e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2865e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545504299677
                                         uncertainty =       0.034872466970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545504299677
                                         uncertainty =       0.034872466970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127998364
  error estimate for blocks of size 2^( 2) =       0.001166713400
  error estimate for blocks of size 2^( 3) =       0.001198538173
  error estimate for blocks of size 2^( 4) =       0.001222901636
  error estimate for blocks of size 2^( 5) =       0.001235012157
  error estimate for blocks of size 2^( 6) =       0.001242923992
  error estimate for blocks of size 2^( 7) =       0.001249322051

      target function =                  N/A
              le_mean =     -16.718195101662
             les_mean =     282.013545354199
             stat err =       0.001237539959
             autocorr =       1.203653608538
              std dev =       1.595256108112
             le_variance =       2.544842050468


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671819510166e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718195100766       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718256395587       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718264141081       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718266717652       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718267179411       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.718267350638       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.718267330738       residual = 6.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-02 is 1.650664e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718195100766       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718227801184       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718229026240       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718229267139       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 6.717260e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718195100766       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718206510393       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718206524079       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 2.285759e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108180 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6277e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 6.976027e-01 3 1  ON 0
ci_0002                 6.890524e-01 3 1  ON 1
ci_0003                -4.795106e-02 3 1  ON 2
ci_0004                -4.750193e-02 3 1  ON 3
ci_0005                -4.485112e-02 3 1  ON 4
ci_0006                -4.466651e-02 3 1  ON 5
ci_0007                -3.355645e-02 3 1  ON 6
ci_0008                -3.214785e-02 3 1  ON 7
ci_0009                -3.194070e-02 3 1  ON 8
ci_0010                -3.107962e-02 3 1  ON 9
ci_0011                -2.647872e-02 3 1  ON 10
ci_0012                -2.729073e-02 3 1  ON 11
ci_0013                 2.719218e-02 3 1  ON 12
ci_0014                 2.609699e-02 3 1  ON 13
ci_0015                 2.706453e-02 3 1  ON 14
ci_0016                 2.666394e-02 3 1  ON 15
ci_0017                 2.427714e-02 3 1  ON 16
ci_0018                 2.407432e-02 3 1  ON 17
ci_0019                 1.998906e-02 3 1  ON 18
ci_0020                 1.933170e-02 3 1  ON 19
ci_0021                 1.779457e-02 3 1  ON 20
ci_0022                 1.798929e-02 3 1  ON 21
ci_0023                -1.912341e-02 3 1  ON 22
ci_0024                -1.900615e-02 3 1  ON 23
ci_0025                -1.828350e-02 3 1  ON 24
ci_0026                -1.805151e-02 3 1  ON 25
ci_0027                -1.764879e-02 3 1  ON 26
ci_0028                -1.705388e-02 3 1  ON 27
ci_0029                -1.628957e-02 3 1  ON 28
ci_0030                -1.639780e-02 3 1  ON 29
ci_0031                 1.483105e-02 3 1  ON 30
ci_0032                 1.463192e-02 3 1  ON 31
ci_0033                 1.565583e-02 3 1  ON 32
ci_0034                 1.667583e-02 3 1  ON 33
ci_0035                 1.741914e-02 3 1  ON 34
ci_0036                 1.710840e-02 3 1  ON 35
ci_0037                -1.474351e-02 3 1  ON 36
ci_0038                -1.510978e-02 3 1  ON 37
ci_0039                -1.555112e-02 3 1  ON 38
ci_0040                -1.533550e-02 3 1  ON 39
ci_0041                 1.580915e-02 3 1  ON 40
ci_0042                 1.565955e-02 3 1  ON 41
ci_0043                -1.554654e-02 3 1  ON 42
ci_0044                -1.575665e-02 3 1  ON 43
ci_0045                 1.554534e-02 3 1  ON 44
ci_0046                 1.535214e-02 3 1  ON 45
ci_0047                -1.480993e-02 3 1  ON 46
ci_0048                -1.410958e-02 3 1  ON 47
ci_0049                -1.332562e-02 3 1  ON 48
ci_0050                -1.278437e-02 3 1  ON 49
ci_0051                -1.237694e-02 3 1  ON 50
ci_0052                -1.268254e-02 3 1  ON 51
ci_0053                -1.284401e-02 3 1  ON 52
ci_0054                -1.241330e-02 3 1  ON 53
ci_0055                 1.266297e-02 3 1  ON 54
ci_0056                 1.200766e-02 3 1  ON 55
ci_0057                 1.323999e-02 3 1  ON 56
ci_0058                 1.222104e-02 3 1  ON 57
ci_0059                -1.276605e-02 3 1  ON 58
ci_0060                -1.296371e-02 3 1  ON 59
ci_0061                -1.227766e-02 3 1  ON 60
ci_0062                -1.263072e-02 3 1  ON 61
ci_0063                -1.111809e-02 3 1  ON 62
ci_0064                -1.159275e-02 3 1  ON 63
ci_0065                -1.156313e-02 3 1  ON 64
ci_0066                -1.119154e-02 3 1  ON 65
ci_0067                -1.133141e-02 3 1  ON 66
ci_0068                -1.070914e-02 3 1  ON 67
ci_0069                 1.077332e-02 3 1  ON 68
ci_0070                 1.030841e-02 3 1  ON 69
ci_0071                 9.831988e-03 3 1  ON 70
ci_0072                 1.021479e-02 3 1  ON 71
ci_0073                 1.090482e-02 3 1  ON 72
ci_0074                 1.077757e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.6325
    reference variance = 2.6676
====================================================
  Execution time = 1.2727e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5885e+00
  Total weights = 1.9453e+06
  Execution time = 2.2560e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0799385
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619373980942
                                         uncertainty =       0.048958374517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619373980942
                                         uncertainty =       0.048958374517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144494079
  error estimate for blocks of size 2^( 2) =       0.001182670385
  error estimate for blocks of size 2^( 3) =       0.001213879045
  error estimate for blocks of size 2^( 4) =       0.001236289859
  error estimate for blocks of size 2^( 5) =       0.001250985852
  error estimate for blocks of size 2^( 6) =       0.001259665344
  error estimate for blocks of size 2^( 7) =       0.001268587221

      target function =                  N/A
              le_mean =     -16.717058162147
             les_mean =     282.052627164036
             stat err =       0.001253882069
             autocorr =       1.200290262744
              std dev =       1.618584945927
             le_variance =       2.619817227181

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.131444
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.618671666104
                                         uncertainty =       0.048953584826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.618671666104
                                         uncertainty =       0.048953584826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144341018
  error estimate for blocks of size 2^( 2) =       0.001182543558
  error estimate for blocks of size 2^( 3) =       0.001213782190
  error estimate for blocks of size 2^( 4) =       0.001236203982
  error estimate for blocks of size 2^( 5) =       0.001250906397
  error estimate for blocks of size 2^( 6) =       0.001259590001
  error estimate for blocks of size 2^( 7) =       0.001268543228

      target function =                  N/A
              le_mean =     -16.717068266241
             les_mean =     282.054824292952
             stat err =       0.001253810902
             autocorr =       1.200475091371
              std dev =       1.618368480615
             le_variance =       2.619116539048

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0772147
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.618569932715
                                         uncertainty =       0.048955833947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.618569932715
                                         uncertainty =       0.048955833947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144318896
  error estimate for blocks of size 2^( 2) =       0.001182525849
  error estimate for blocks of size 2^( 3) =       0.001213765998
  error estimate for blocks of size 2^( 4) =       0.001236186183
  error estimate for blocks of size 2^( 5) =       0.001250885607
  error estimate for blocks of size 2^( 6) =       0.001259568058
  error estimate for blocks of size 2^( 7) =       0.001268515773

      target function =                  N/A
              le_mean =     -16.717065673148
             les_mean =     282.053058430405
             stat err =       0.001253788905
             autocorr =       1.200479384429
              std dev =       1.618337194521
             le_variance =       2.619015275171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619158607032
                                         uncertainty =       0.048959036921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619158607032
                                         uncertainty =       0.048959036921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144447139
  error estimate for blocks of size 2^( 2) =       0.001182629810
  error estimate for blocks of size 2^( 3) =       0.001213845230
  error estimate for blocks of size 2^( 4) =       0.001236253590
  error estimate for blocks of size 2^( 5) =       0.001250949937
  error estimate for blocks of size 2^( 6) =       0.001259625951
  error estimate for blocks of size 2^( 7) =       0.001268552504

      target function =                  N/A
              le_mean =     -16.717053316171
             les_mean =     282.050003751297
             stat err =       0.001253845495
             autocorr =       1.200318700642
              std dev =       1.618518561432
             le_variance =       2.619602333701


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717058162147        initial
     9.7656e-02     9.7656e-01             1.6507e-03       -16.717068266241  <--
     3.9062e-01     3.9062e+00             6.7173e-04       -16.717065673148
     1.5625e+00     1.5625e+01             2.2858e-04       -16.717053316171

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.4111e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 6.986802e-01 3 1  ON 0
ci_0002                 6.880867e-01 3 1  ON 1
ci_0003                -4.750213e-02 3 1  ON 2
ci_0004                -4.730667e-02 3 1  ON 3
ci_0005                -4.466180e-02 3 1  ON 4
ci_0006                -4.541295e-02 3 1  ON 5
ci_0007                -3.322256e-02 3 1  ON 6
ci_0008                -3.154056e-02 3 1  ON 7
ci_0009                -3.225339e-02 3 1  ON 8
ci_0010                -3.132723e-02 3 1  ON 9
ci_0011                -2.678082e-02 3 1  ON 10
ci_0012                -2.667504e-02 3 1  ON 11
ci_0013                 2.746869e-02 3 1  ON 12
ci_0014                 2.603328e-02 3 1  ON 13
ci_0015                 2.737916e-02 3 1  ON 14
ci_0016                 2.651295e-02 3 1  ON 15
ci_0017                 2.403646e-02 3 1  ON 16
ci_0018                 2.353902e-02 3 1  ON 17
ci_0019                 1.996309e-02 3 1  ON 18
ci_0020                 1.902019e-02 3 1  ON 19
ci_0021                 1.736389e-02 3 1  ON 20
ci_0022                 1.834554e-02 3 1  ON 21
ci_0023                -1.909984e-02 3 1  ON 22
ci_0024                -1.888607e-02 3 1  ON 23
ci_0025                -1.815334e-02 3 1  ON 24
ci_0026                -1.800917e-02 3 1  ON 25
ci_0027                -1.802525e-02 3 1  ON 26
ci_0028                -1.703181e-02 3 1  ON 27
ci_0029                -1.635239e-02 3 1  ON 28
ci_0030                -1.653940e-02 3 1  ON 29
ci_0031                 1.465525e-02 3 1  ON 30
ci_0032                 1.467869e-02 3 1  ON 31
ci_0033                 1.529828e-02 3 1  ON 32
ci_0034                 1.606389e-02 3 1  ON 33
ci_0035                 1.708111e-02 3 1  ON 34
ci_0036                 1.703268e-02 3 1  ON 35
ci_0037                -1.500448e-02 3 1  ON 36
ci_0038                -1.482144e-02 3 1  ON 37
ci_0039                -1.566148e-02 3 1  ON 38
ci_0040                -1.515007e-02 3 1  ON 39
ci_0041                 1.595085e-02 3 1  ON 40
ci_0042                 1.587158e-02 3 1  ON 41
ci_0043                -1.456760e-02 3 1  ON 42
ci_0044                -1.511759e-02 3 1  ON 43
ci_0045                 1.541611e-02 3 1  ON 44
ci_0046                 1.547817e-02 3 1  ON 45
ci_0047                -1.515328e-02 3 1  ON 46
ci_0048                -1.395043e-02 3 1  ON 47
ci_0049                -1.387758e-02 3 1  ON 48
ci_0050                -1.285261e-02 3 1  ON 49
ci_0051                -1.216362e-02 3 1  ON 50
ci_0052                -1.263977e-02 3 1  ON 51
ci_0053                -1.274152e-02 3 1  ON 52
ci_0054                -1.241643e-02 3 1  ON 53
ci_0055                 1.289981e-02 3 1  ON 54
ci_0056                 1.218826e-02 3 1  ON 55
ci_0057                 1.312286e-02 3 1  ON 56
ci_0058                 1.203610e-02 3 1  ON 57
ci_0059                -1.269542e-02 3 1  ON 58
ci_0060                -1.302602e-02 3 1  ON 59
ci_0061                -1.243153e-02 3 1  ON 60
ci_0062                -1.238005e-02 3 1  ON 61
ci_0063                -1.100450e-02 3 1  ON 62
ci_0064                -1.144733e-02 3 1  ON 63
ci_0065                -1.170358e-02 3 1  ON 64
ci_0066                -1.156695e-02 3 1  ON 65
ci_0067                -1.142764e-02 3 1  ON 66
ci_0068                -1.056512e-02 3 1  ON 67
ci_0069                 1.052069e-02 3 1  ON 68
ci_0070                 1.022125e-02 3 1  ON 69
ci_0071                 9.634350e-03 3 1  ON 70
ci_0072                 1.062888e-02 3 1  ON 71
ci_0073                 1.095859e-02 3 1  ON 72
ci_0074                 1.067914e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0401e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6736e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.1867
    reference variance = 3.91366
====================================================
  Execution time = 1.2971e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0272e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5800e+00
  Total weights = 1.945974569e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2030e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.602865833162
                                         uncertainty =       0.042028127677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.602865833162
                                         uncertainty =       0.042028127677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140889689
  error estimate for blocks of size 2^( 2) =       0.001179168069
  error estimate for blocks of size 2^( 3) =       0.001212361155
  error estimate for blocks of size 2^( 4) =       0.001235981395
  error estimate for blocks of size 2^( 5) =       0.001249661339
  error estimate for blocks of size 2^( 6) =       0.001255853714
  error estimate for blocks of size 2^( 7) =       0.001255783772

      target function =                  N/A
              le_mean =     -16.718597263826
             les_mean =     282.091510043482
             stat err =       0.001249320055
             autocorr =       1.199113005438
              std dev =       1.613487485995
             le_variance =       2.603341867464


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671859726383e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718597262921       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718630881084       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718632511230       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718636013916       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718651685192       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.718655856693       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.718655481391       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.718655259419       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.718655181374       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-02 is 7.503892e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718597262921       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718623266447       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718623547606       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718624453982       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718626302327       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.718626334629       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-02 is 2.282112e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718597262921       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718610905763       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718610684925       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718610756261       residual = 8.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 9.720518e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113462 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6187e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.002396e-01 3 1  ON 0
ci_0002                 6.863112e-01 3 1  ON 1
ci_0003                -4.752642e-02 3 1  ON 2
ci_0004                -4.788208e-02 3 1  ON 3
ci_0005                -4.694391e-02 3 1  ON 4
ci_0006                -4.467006e-02 3 1  ON 5
ci_0007                -3.332766e-02 3 1  ON 6
ci_0008                -3.137993e-02 3 1  ON 7
ci_0009                -3.183587e-02 3 1  ON 8
ci_0010                -3.107678e-02 3 1  ON 9
ci_0011                -2.731635e-02 3 1  ON 10
ci_0012                -2.717064e-02 3 1  ON 11
ci_0013                 2.678113e-02 3 1  ON 12
ci_0014                 2.655465e-02 3 1  ON 13
ci_0015                 2.716727e-02 3 1  ON 14
ci_0016                 2.691478e-02 3 1  ON 15
ci_0017                 2.486155e-02 3 1  ON 16
ci_0018                 2.423042e-02 3 1  ON 17
ci_0019                 2.023220e-02 3 1  ON 18
ci_0020                 1.887357e-02 3 1  ON 19
ci_0021                 1.701976e-02 3 1  ON 20
ci_0022                 1.885937e-02 3 1  ON 21
ci_0023                -1.844462e-02 3 1  ON 22
ci_0024                -1.876711e-02 3 1  ON 23
ci_0025                -1.815946e-02 3 1  ON 24
ci_0026                -1.824686e-02 3 1  ON 25
ci_0027                -1.887430e-02 3 1  ON 26
ci_0028                -1.754156e-02 3 1  ON 27
ci_0029                -1.627282e-02 3 1  ON 28
ci_0030                -1.671542e-02 3 1  ON 29
ci_0031                 1.481653e-02 3 1  ON 30
ci_0032                 1.521568e-02 3 1  ON 31
ci_0033                 1.697280e-02 3 1  ON 32
ci_0034                 1.569406e-02 3 1  ON 33
ci_0035                 1.645185e-02 3 1  ON 34
ci_0036                 1.690276e-02 3 1  ON 35
ci_0037                -1.470256e-02 3 1  ON 36
ci_0038                -1.507859e-02 3 1  ON 37
ci_0039                -1.507510e-02 3 1  ON 38
ci_0040                -1.479201e-02 3 1  ON 39
ci_0041                 1.649801e-02 3 1  ON 40
ci_0042                 1.518368e-02 3 1  ON 41
ci_0043                -1.446806e-02 3 1  ON 42
ci_0044                -1.457421e-02 3 1  ON 43
ci_0045                 1.536818e-02 3 1  ON 44
ci_0046                 1.615751e-02 3 1  ON 45
ci_0047                -1.489257e-02 3 1  ON 46
ci_0048                -1.361003e-02 3 1  ON 47
ci_0049                -1.243647e-02 3 1  ON 48
ci_0050                -1.262400e-02 3 1  ON 49
ci_0051                -1.274138e-02 3 1  ON 50
ci_0052                -1.254035e-02 3 1  ON 51
ci_0053                -1.317038e-02 3 1  ON 52
ci_0054                -1.222358e-02 3 1  ON 53
ci_0055                 1.226281e-02 3 1  ON 54
ci_0056                 1.284426e-02 3 1  ON 55
ci_0057                 1.210570e-02 3 1  ON 56
ci_0058                 1.222304e-02 3 1  ON 57
ci_0059                -1.331354e-02 3 1  ON 58
ci_0060                -1.261093e-02 3 1  ON 59
ci_0061                -1.185968e-02 3 1  ON 60
ci_0062                -1.240597e-02 3 1  ON 61
ci_0063                -1.142409e-02 3 1  ON 62
ci_0064                -1.174963e-02 3 1  ON 63
ci_0065                -1.240917e-02 3 1  ON 64
ci_0066                -1.105772e-02 3 1  ON 65
ci_0067                -1.206337e-02 3 1  ON 66
ci_0068                -1.043636e-02 3 1  ON 67
ci_0069                 1.057615e-02 3 1  ON 68
ci_0070                 1.015965e-02 3 1  ON 69
ci_0071                 9.743204e-03 3 1  ON 70
ci_0072                 1.062801e-02 3 1  ON 71
ci_0073                 1.097480e-02 3 1  ON 72
ci_0074                 1.024574e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8855
    reference variance = 2.71052
====================================================
  Execution time = 1.2714e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4779e+00
  Total weights = 1.9453e+06
  Execution time = 2.2569e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.521951078261
                                         uncertainty =       0.026484950894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.521951078261
                                         uncertainty =       0.026484950894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122773290
  error estimate for blocks of size 2^( 2) =       0.001162032183
  error estimate for blocks of size 2^( 3) =       0.001194649710
  error estimate for blocks of size 2^( 4) =       0.001216799378
  error estimate for blocks of size 2^( 5) =       0.001228831408
  error estimate for blocks of size 2^( 6) =       0.001236632463
  error estimate for blocks of size 2^( 7) =       0.001237791262

      target function =                  N/A
              le_mean =     -16.719240688488
             les_mean =     282.070038334950
             stat err =       0.001230013628
             autocorr =       1.200150474923
              std dev =       1.587866619512
             le_variance =       2.521320401359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508564246481
                                         uncertainty =       0.022145092013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508564246481
                                         uncertainty =       0.022145092013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119803619
  error estimate for blocks of size 2^( 2) =       0.001159048680
  error estimate for blocks of size 2^( 3) =       0.001191682856
  error estimate for blocks of size 2^( 4) =       0.001213639593
  error estimate for blocks of size 2^( 5) =       0.001225550219
  error estimate for blocks of size 2^( 6) =       0.001233573622
  error estimate for blocks of size 2^( 7) =       0.001234586072

      target function =                  N/A
              le_mean =     -16.719301747374
             les_mean =     282.140808112974
             stat err =       0.001226837377
             autocorr =       1.200301264200
              std dev =       1.583666803914
             le_variance =       2.508000545819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.507165147037
                                         uncertainty =       0.022197595161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.507165147037
                                         uncertainty =       0.022197595161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119492344
  error estimate for blocks of size 2^( 2) =       0.001158796043
  error estimate for blocks of size 2^( 3) =       0.001191412510
  error estimate for blocks of size 2^( 4) =       0.001213385834
  error estimate for blocks of size 2^( 5) =       0.001225343988
  error estimate for blocks of size 2^( 6) =       0.001233281108
  error estimate for blocks of size 2^( 7) =       0.001234081779

      target function =                  N/A
              le_mean =     -16.719317921291
             les_mean =     282.482374914823
             stat err =       0.001226523177
             autocorr =       1.200353776609
              std dev =       1.583226586394
             le_variance =       2.506606423866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.509051084736
                                         uncertainty =       0.022302740452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.509051084736
                                         uncertainty =       0.022302740452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119911847
  error estimate for blocks of size 2^( 2) =       0.001159179549
  error estimate for blocks of size 2^( 3) =       0.001191797288
  error estimate for blocks of size 2^( 4) =       0.001213718963
  error estimate for blocks of size 2^( 5) =       0.001225627430
  error estimate for blocks of size 2^( 6) =       0.001233643235
  error estimate for blocks of size 2^( 7) =       0.001234522993

      target function =                  N/A
              le_mean =     -16.719316039126
             les_mean =     282.019907403545
             stat err =       0.001226878155
             autocorr =       1.200149062666
              std dev =       1.583819862536
             le_variance =       2.508485356965


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719240688488        initial
     2.4414e-02     2.4414e-01             7.5039e-03       -16.719301747374
     9.7656e-02     9.7656e-01             2.2821e-03       -16.719317921291  <--
     3.9062e-01     3.9062e+00             9.7205e-04       -16.719316039126

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.7198e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.002396e-01 3 1  ON 0
ci_0002                 6.863112e-01 3 1  ON 1
ci_0003                -4.752642e-02 3 1  ON 2
ci_0004                -4.788208e-02 3 1  ON 3
ci_0005                -4.694391e-02 3 1  ON 4
ci_0006                -4.467006e-02 3 1  ON 5
ci_0007                -3.332766e-02 3 1  ON 6
ci_0008                -3.137993e-02 3 1  ON 7
ci_0009                -3.183587e-02 3 1  ON 8
ci_0010                -3.107678e-02 3 1  ON 9
ci_0011                -2.731635e-02 3 1  ON 10
ci_0012                -2.717064e-02 3 1  ON 11
ci_0013                 2.678113e-02 3 1  ON 12
ci_0014                 2.655465e-02 3 1  ON 13
ci_0015                 2.716727e-02 3 1  ON 14
ci_0016                 2.691478e-02 3 1  ON 15
ci_0017                 2.486155e-02 3 1  ON 16
ci_0018                 2.423042e-02 3 1  ON 17
ci_0019                 2.023220e-02 3 1  ON 18
ci_0020                 1.887357e-02 3 1  ON 19
ci_0021                 1.701976e-02 3 1  ON 20
ci_0022                 1.885937e-02 3 1  ON 21
ci_0023                -1.844462e-02 3 1  ON 22
ci_0024                -1.876711e-02 3 1  ON 23
ci_0025                -1.815946e-02 3 1  ON 24
ci_0026                -1.824686e-02 3 1  ON 25
ci_0027                -1.887430e-02 3 1  ON 26
ci_0028                -1.754156e-02 3 1  ON 27
ci_0029                -1.627282e-02 3 1  ON 28
ci_0030                -1.671542e-02 3 1  ON 29
ci_0031                 1.481653e-02 3 1  ON 30
ci_0032                 1.521568e-02 3 1  ON 31
ci_0033                 1.697280e-02 3 1  ON 32
ci_0034                 1.569406e-02 3 1  ON 33
ci_0035                 1.645185e-02 3 1  ON 34
ci_0036                 1.690276e-02 3 1  ON 35
ci_0037                -1.470256e-02 3 1  ON 36
ci_0038                -1.507859e-02 3 1  ON 37
ci_0039                -1.507510e-02 3 1  ON 38
ci_0040                -1.479201e-02 3 1  ON 39
ci_0041                 1.649801e-02 3 1  ON 40
ci_0042                 1.518368e-02 3 1  ON 41
ci_0043                -1.446806e-02 3 1  ON 42
ci_0044                -1.457421e-02 3 1  ON 43
ci_0045                 1.536818e-02 3 1  ON 44
ci_0046                 1.615751e-02 3 1  ON 45
ci_0047                -1.489257e-02 3 1  ON 46
ci_0048                -1.361003e-02 3 1  ON 47
ci_0049                -1.243647e-02 3 1  ON 48
ci_0050                -1.262400e-02 3 1  ON 49
ci_0051                -1.274138e-02 3 1  ON 50
ci_0052                -1.254035e-02 3 1  ON 51
ci_0053                -1.317038e-02 3 1  ON 52
ci_0054                -1.222358e-02 3 1  ON 53
ci_0055                 1.226281e-02 3 1  ON 54
ci_0056                 1.284426e-02 3 1  ON 55
ci_0057                 1.210570e-02 3 1  ON 56
ci_0058                 1.222304e-02 3 1  ON 57
ci_0059                -1.331354e-02 3 1  ON 58
ci_0060                -1.261093e-02 3 1  ON 59
ci_0061                -1.185968e-02 3 1  ON 60
ci_0062                -1.240597e-02 3 1  ON 61
ci_0063                -1.142409e-02 3 1  ON 62
ci_0064                -1.174963e-02 3 1  ON 63
ci_0065                -1.240917e-02 3 1  ON 64
ci_0066                -1.105772e-02 3 1  ON 65
ci_0067                -1.206337e-02 3 1  ON 66
ci_0068                -1.043636e-02 3 1  ON 67
ci_0069                 1.057615e-02 3 1  ON 68
ci_0070                 1.015965e-02 3 1  ON 69
ci_0071                 9.743204e-03 3 1  ON 70
ci_0072                 1.062801e-02 3 1  ON 71
ci_0073                 1.097480e-02 3 1  ON 72
ci_0074                 1.024574e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3398e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6716e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.5421
    reference variance = 7.54192
====================================================
  Execution time = 1.3019e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0277e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 3.2790e+00
  Total weights = 1.945529005e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2090e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.327303637379
                                         uncertainty =       0.810737596028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.327303637379
                                         uncertainty =       0.810737596028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001289680741
  error estimate for blocks of size 2^( 2) =       0.001324087384
  error estimate for blocks of size 2^( 3) =       0.001353816354
  error estimate for blocks of size 2^( 4) =       0.001374863508
  error estimate for blocks of size 2^( 5) =       0.001387020512
  error estimate for blocks of size 2^( 6) =       0.001393524053
  error estimate for blocks of size 2^( 7) =       0.001396398158

      target function =                  N/A
              le_mean =     -16.718110373155
             les_mean =     282.774182545015
             stat err =       0.001387951558
             autocorr =       1.158201673837
              std dev =       1.823913177285
             le_variance =       3.326659278275


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671811037316e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718110372205       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718223058315       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718227563984       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718226262785       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718232725754       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.718232008832       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.718231642289       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.718232110521       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.718232131914       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-02 is 4.902405e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718110372205       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718198879960       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718199919635       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718199007976       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718200331185       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.718199976350       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.718199920993       residual = 1.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-02 is 1.747664e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718110372205       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718158001323       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718157604854       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718157455084       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 9.398022e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118736 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6240e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.013251e-01 3 1  ON 0
ci_0002                 6.851807e-01 3 1  ON 1
ci_0003                -4.850450e-02 3 1  ON 2
ci_0004                -4.735440e-02 3 1  ON 3
ci_0005                -4.654893e-02 3 1  ON 4
ci_0006                -4.525920e-02 3 1  ON 5
ci_0007                -3.183639e-02 3 1  ON 6
ci_0008                -3.264527e-02 3 1  ON 7
ci_0009                -3.131876e-02 3 1  ON 8
ci_0010                -3.157246e-02 3 1  ON 9
ci_0011                -2.762438e-02 3 1  ON 10
ci_0012                -2.722520e-02 3 1  ON 11
ci_0013                 2.707564e-02 3 1  ON 12
ci_0014                 2.644631e-02 3 1  ON 13
ci_0015                 2.737982e-02 3 1  ON 14
ci_0016                 2.629840e-02 3 1  ON 15
ci_0017                 2.474218e-02 3 1  ON 16
ci_0018                 2.379878e-02 3 1  ON 17
ci_0019                 1.979266e-02 3 1  ON 18
ci_0020                 1.941896e-02 3 1  ON 19
ci_0021                 1.804163e-02 3 1  ON 20
ci_0022                 1.895444e-02 3 1  ON 21
ci_0023                -1.912863e-02 3 1  ON 22
ci_0024                -1.864817e-02 3 1  ON 23
ci_0025                -1.839965e-02 3 1  ON 24
ci_0026                -1.873698e-02 3 1  ON 25
ci_0027                -1.867566e-02 3 1  ON 26
ci_0028                -1.790543e-02 3 1  ON 27
ci_0029                -1.586086e-02 3 1  ON 28
ci_0030                -1.547749e-02 3 1  ON 29
ci_0031                 1.517205e-02 3 1  ON 30
ci_0032                 1.548558e-02 3 1  ON 31
ci_0033                 1.671681e-02 3 1  ON 32
ci_0034                 1.548784e-02 3 1  ON 33
ci_0035                 1.704047e-02 3 1  ON 34
ci_0036                 1.642279e-02 3 1  ON 35
ci_0037                -1.360349e-02 3 1  ON 36
ci_0038                -1.472733e-02 3 1  ON 37
ci_0039                -1.582618e-02 3 1  ON 38
ci_0040                -1.487753e-02 3 1  ON 39
ci_0041                 1.475034e-02 3 1  ON 40
ci_0042                 1.576351e-02 3 1  ON 41
ci_0043                -1.386975e-02 3 1  ON 42
ci_0044                -1.333341e-02 3 1  ON 43
ci_0045                 1.585427e-02 3 1  ON 44
ci_0046                 1.546935e-02 3 1  ON 45
ci_0047                -1.473602e-02 3 1  ON 46
ci_0048                -1.430483e-02 3 1  ON 47
ci_0049                -1.258035e-02 3 1  ON 48
ci_0050                -1.324263e-02 3 1  ON 49
ci_0051                -1.300640e-02 3 1  ON 50
ci_0052                -1.255342e-02 3 1  ON 51
ci_0053                -1.307735e-02 3 1  ON 52
ci_0054                -1.237775e-02 3 1  ON 53
ci_0055                 1.242016e-02 3 1  ON 54
ci_0056                 1.339787e-02 3 1  ON 55
ci_0057                 1.266045e-02 3 1  ON 56
ci_0058                 1.175266e-02 3 1  ON 57
ci_0059                -1.303217e-02 3 1  ON 58
ci_0060                -1.331097e-02 3 1  ON 59
ci_0061                -1.309665e-02 3 1  ON 60
ci_0062                -1.301721e-02 3 1  ON 61
ci_0063                -1.232927e-02 3 1  ON 62
ci_0064                -1.107005e-02 3 1  ON 63
ci_0065                -1.154407e-02 3 1  ON 64
ci_0066                -1.133784e-02 3 1  ON 65
ci_0067                -1.129783e-02 3 1  ON 66
ci_0068                -1.092769e-02 3 1  ON 67
ci_0069                 1.077352e-02 3 1  ON 68
ci_0070                 9.888417e-03 3 1  ON 69
ci_0071                 9.833098e-03 3 1  ON 70
ci_0072                 1.008418e-02 3 1  ON 71
ci_0073                 1.102819e-02 3 1  ON 72
ci_0074                 1.021853e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.006
    reference variance = 1.6658
====================================================
  Execution time = 1.2757e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5558e+00
  Total weights = 1.9456e+06
  Execution time = 2.2470e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00427524
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.679944314729
                                         uncertainty =       0.107002636418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.679944314729
                                         uncertainty =       0.107002636418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001157471317
  error estimate for blocks of size 2^( 2) =       0.001196121593
  error estimate for blocks of size 2^( 3) =       0.001228550949
  error estimate for blocks of size 2^( 4) =       0.001251338754
  error estimate for blocks of size 2^( 5) =       0.001264363886
  error estimate for blocks of size 2^( 6) =       0.001268827952
  error estimate for blocks of size 2^( 7) =       0.001269244840

      target function =                  N/A
              le_mean =     -16.716826130788
             les_mean =     289.617294480469
             stat err =       0.001263443858
             autocorr =       1.191492797779
              std dev =       1.636937825196
             le_variance =       2.679565443557

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.175321
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.583758589631
                                         uncertainty =       0.050337640706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.583758589631
                                         uncertainty =       0.050337640706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136503475
  error estimate for blocks of size 2^( 2) =       0.001175276983
  error estimate for blocks of size 2^( 3) =       0.001208455394
  error estimate for blocks of size 2^( 4) =       0.001231790902
  error estimate for blocks of size 2^( 5) =       0.001245520187
  error estimate for blocks of size 2^( 6) =       0.001250119590
  error estimate for blocks of size 2^( 7) =       0.001250394278

      target function =                  N/A
              le_mean =     -16.717022843719
             les_mean =     282.018413373074
             stat err =       0.001244456239
             autocorr =       1.198995967340
              std dev =       1.607284344515
             le_variance =       2.583362964122

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00421472
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.584833874235
                                         uncertainty =       0.050330162686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.584833874235
                                         uncertainty =       0.050330162686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136739042
  error estimate for blocks of size 2^( 2) =       0.001175499153
  error estimate for blocks of size 2^( 3) =       0.001208677875
  error estimate for blocks of size 2^( 4) =       0.001232017372
  error estimate for blocks of size 2^( 5) =       0.001245751599
  error estimate for blocks of size 2^( 6) =       0.001250346253
  error estimate for blocks of size 2^( 7) =       0.001250573040

      target function =                  N/A
              le_mean =     -16.717068634457
             les_mean =     282.032290558121
             stat err =       0.001244672066
             autocorr =       1.198914831836
              std dev =       1.607617491695
             le_variance =       2.584433999604

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0587806
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.583048341444
                                         uncertainty =       0.050344359575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.583048341444
                                         uncertainty =       0.050344359575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136344483
  error estimate for blocks of size 2^( 2) =       0.001175119385
  error estimate for blocks of size 2^( 3) =       0.001208310011
  error estimate for blocks of size 2^( 4) =       0.001231666355
  error estimate for blocks of size 2^( 5) =       0.001245390644
  error estimate for blocks of size 2^( 6) =       0.001250031717
  error estimate for blocks of size 2^( 7) =       0.001250298188

      target function =                  N/A
              le_mean =     -16.717034295631
             les_mean =     282.089949903200
             stat err =       0.001244346726
             autocorr =       1.199120433371
              std dev =       1.607059491164
             le_variance =       2.582640208141


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716826130788        initial
     2.4414e-02     2.4414e-01             4.9024e-03       -16.717022843719
     9.7656e-02     9.7656e-01             1.7477e-03       -16.717068634457  <--
     3.9062e-01     3.9062e+00             9.3980e-04       -16.717034295631

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.4134e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.013251e-01 3 1  ON 0
ci_0002                 6.851807e-01 3 1  ON 1
ci_0003                -4.850450e-02 3 1  ON 2
ci_0004                -4.735440e-02 3 1  ON 3
ci_0005                -4.654893e-02 3 1  ON 4
ci_0006                -4.525920e-02 3 1  ON 5
ci_0007                -3.183639e-02 3 1  ON 6
ci_0008                -3.264527e-02 3 1  ON 7
ci_0009                -3.131876e-02 3 1  ON 8
ci_0010                -3.157246e-02 3 1  ON 9
ci_0011                -2.762438e-02 3 1  ON 10
ci_0012                -2.722520e-02 3 1  ON 11
ci_0013                 2.707564e-02 3 1  ON 12
ci_0014                 2.644631e-02 3 1  ON 13
ci_0015                 2.737982e-02 3 1  ON 14
ci_0016                 2.629840e-02 3 1  ON 15
ci_0017                 2.474218e-02 3 1  ON 16
ci_0018                 2.379878e-02 3 1  ON 17
ci_0019                 1.979266e-02 3 1  ON 18
ci_0020                 1.941896e-02 3 1  ON 19
ci_0021                 1.804163e-02 3 1  ON 20
ci_0022                 1.895444e-02 3 1  ON 21
ci_0023                -1.912863e-02 3 1  ON 22
ci_0024                -1.864817e-02 3 1  ON 23
ci_0025                -1.839965e-02 3 1  ON 24
ci_0026                -1.873698e-02 3 1  ON 25
ci_0027                -1.867566e-02 3 1  ON 26
ci_0028                -1.790543e-02 3 1  ON 27
ci_0029                -1.586086e-02 3 1  ON 28
ci_0030                -1.547749e-02 3 1  ON 29
ci_0031                 1.517205e-02 3 1  ON 30
ci_0032                 1.548558e-02 3 1  ON 31
ci_0033                 1.671681e-02 3 1  ON 32
ci_0034                 1.548784e-02 3 1  ON 33
ci_0035                 1.704047e-02 3 1  ON 34
ci_0036                 1.642279e-02 3 1  ON 35
ci_0037                -1.360349e-02 3 1  ON 36
ci_0038                -1.472733e-02 3 1  ON 37
ci_0039                -1.582618e-02 3 1  ON 38
ci_0040                -1.487753e-02 3 1  ON 39
ci_0041                 1.475034e-02 3 1  ON 40
ci_0042                 1.576351e-02 3 1  ON 41
ci_0043                -1.386975e-02 3 1  ON 42
ci_0044                -1.333341e-02 3 1  ON 43
ci_0045                 1.585427e-02 3 1  ON 44
ci_0046                 1.546935e-02 3 1  ON 45
ci_0047                -1.473602e-02 3 1  ON 46
ci_0048                -1.430483e-02 3 1  ON 47
ci_0049                -1.258035e-02 3 1  ON 48
ci_0050                -1.324263e-02 3 1  ON 49
ci_0051                -1.300640e-02 3 1  ON 50
ci_0052                -1.255342e-02 3 1  ON 51
ci_0053                -1.307735e-02 3 1  ON 52
ci_0054                -1.237775e-02 3 1  ON 53
ci_0055                 1.242016e-02 3 1  ON 54
ci_0056                 1.339787e-02 3 1  ON 55
ci_0057                 1.266045e-02 3 1  ON 56
ci_0058                 1.175266e-02 3 1  ON 57
ci_0059                -1.303217e-02 3 1  ON 58
ci_0060                -1.331097e-02 3 1  ON 59
ci_0061                -1.309665e-02 3 1  ON 60
ci_0062                -1.301721e-02 3 1  ON 61
ci_0063                -1.232927e-02 3 1  ON 62
ci_0064                -1.107005e-02 3 1  ON 63
ci_0065                -1.154407e-02 3 1  ON 64
ci_0066                -1.133784e-02 3 1  ON 65
ci_0067                -1.129783e-02 3 1  ON 66
ci_0068                -1.092769e-02 3 1  ON 67
ci_0069                 1.077352e-02 3 1  ON 68
ci_0070                 9.888417e-03 3 1  ON 69
ci_0071                 9.833098e-03 3 1  ON 70
ci_0072                 1.008418e-02 3 1  ON 71
ci_0073                 1.102819e-02 3 1  ON 72
ci_0074                 1.021853e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0388e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6721e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.4224
    reference variance = 4.30758
====================================================
  Execution time = 1.2963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0289e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5342e+00
  Total weights = 1.945998414e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2063e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564056229341
                                         uncertainty =       0.028201012350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564056229341
                                         uncertainty =       0.028201012350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132142754
  error estimate for blocks of size 2^( 2) =       0.001170100773
  error estimate for blocks of size 2^( 3) =       0.001203420100
  error estimate for blocks of size 2^( 4) =       0.001225698498
  error estimate for blocks of size 2^( 5) =       0.001238846913
  error estimate for blocks of size 2^( 6) =       0.001245427633
  error estimate for blocks of size 2^( 7) =       0.001253211862

      target function =                  N/A
              le_mean =     -16.718947964920
             les_mean =     282.057442244156
             stat err =       0.001240796227
             autocorr =       1.201153594332
              std dev =       1.601117255013
             le_variance =       2.563576464300


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671894796492e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718947964002       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719024477751       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719035177084       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719045482256       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.719052409979       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.719055690496       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.719056941193       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.719056621532       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.719056682904       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-02 is 6.090254e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718947964002       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719008100754       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719012968586       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719015443361       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.719015806091       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.719015756322       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-02 is 1.376883e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718947964002       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718980362306       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718981130475       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718981305870       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 5.997984e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123834 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6181e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.026519e-01 3 1  ON 0
ci_0002                 6.838038e-01 3 1  ON 1
ci_0003                -4.895598e-02 3 1  ON 2
ci_0004                -4.734759e-02 3 1  ON 3
ci_0005                -4.598619e-02 3 1  ON 4
ci_0006                -4.463401e-02 3 1  ON 5
ci_0007                -3.127734e-02 3 1  ON 6
ci_0008                -3.230703e-02 3 1  ON 7
ci_0009                -3.210385e-02 3 1  ON 8
ci_0010                -3.171854e-02 3 1  ON 9
ci_0011                -2.799035e-02 3 1  ON 10
ci_0012                -2.701000e-02 3 1  ON 11
ci_0013                 2.729741e-02 3 1  ON 12
ci_0014                 2.653623e-02 3 1  ON 13
ci_0015                 2.781920e-02 3 1  ON 14
ci_0016                 2.667991e-02 3 1  ON 15
ci_0017                 2.515821e-02 3 1  ON 16
ci_0018                 2.408571e-02 3 1  ON 17
ci_0019                 2.037739e-02 3 1  ON 18
ci_0020                 2.001874e-02 3 1  ON 19
ci_0021                 1.800138e-02 3 1  ON 20
ci_0022                 1.890862e-02 3 1  ON 21
ci_0023                -1.982177e-02 3 1  ON 22
ci_0024                -1.821717e-02 3 1  ON 23
ci_0025                -1.829721e-02 3 1  ON 24
ci_0026                -1.824079e-02 3 1  ON 25
ci_0027                -1.771950e-02 3 1  ON 26
ci_0028                -1.698273e-02 3 1  ON 27
ci_0029                -1.584057e-02 3 1  ON 28
ci_0030                -1.522409e-02 3 1  ON 29
ci_0031                 1.478694e-02 3 1  ON 30
ci_0032                 1.434330e-02 3 1  ON 31
ci_0033                 1.657017e-02 3 1  ON 32
ci_0034                 1.565855e-02 3 1  ON 33
ci_0035                 1.771644e-02 3 1  ON 34
ci_0036                 1.753739e-02 3 1  ON 35
ci_0037                -1.389867e-02 3 1  ON 36
ci_0038                -1.518830e-02 3 1  ON 37
ci_0039                -1.539071e-02 3 1  ON 38
ci_0040                -1.511856e-02 3 1  ON 39
ci_0041                 1.525515e-02 3 1  ON 40
ci_0042                 1.613517e-02 3 1  ON 41
ci_0043                -1.419222e-02 3 1  ON 42
ci_0044                -1.470205e-02 3 1  ON 43
ci_0045                 1.534384e-02 3 1  ON 44
ci_0046                 1.481754e-02 3 1  ON 45
ci_0047                -1.465518e-02 3 1  ON 46
ci_0048                -1.390726e-02 3 1  ON 47
ci_0049                -1.288293e-02 3 1  ON 48
ci_0050                -1.259001e-02 3 1  ON 49
ci_0051                -1.314474e-02 3 1  ON 50
ci_0052                -1.235075e-02 3 1  ON 51
ci_0053                -1.331334e-02 3 1  ON 52
ci_0054                -1.233048e-02 3 1  ON 53
ci_0055                 1.251290e-02 3 1  ON 54
ci_0056                 1.284345e-02 3 1  ON 55
ci_0057                 1.326870e-02 3 1  ON 56
ci_0058                 1.205265e-02 3 1  ON 57
ci_0059                -1.301502e-02 3 1  ON 58
ci_0060                -1.232266e-02 3 1  ON 59
ci_0061                -1.289259e-02 3 1  ON 60
ci_0062                -1.234350e-02 3 1  ON 61
ci_0063                -1.178482e-02 3 1  ON 62
ci_0064                -1.106509e-02 3 1  ON 63
ci_0065                -1.197352e-02 3 1  ON 64
ci_0066                -1.092289e-02 3 1  ON 65
ci_0067                -1.166386e-02 3 1  ON 66
ci_0068                -1.109946e-02 3 1  ON 67
ci_0069                 1.047718e-02 3 1  ON 68
ci_0070                 9.821680e-03 3 1  ON 69
ci_0071                 1.032672e-02 3 1  ON 70
ci_0072                 1.034409e-02 3 1  ON 71
ci_0073                 1.117770e-02 3 1  ON 72
ci_0074                 1.117807e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9711
    reference variance = 1.20882
====================================================
  Execution time = 1.2722e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5733e+00
  Total weights = 1.9457e+06
  Execution time = 2.2456e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.600862591405
                                         uncertainty =       0.039430629833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.600862591405
                                         uncertainty =       0.039430629833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140290283
  error estimate for blocks of size 2^( 2) =       0.001178914486
  error estimate for blocks of size 2^( 3) =       0.001212826503
  error estimate for blocks of size 2^( 4) =       0.001232851282
  error estimate for blocks of size 2^( 5) =       0.001246270858
  error estimate for blocks of size 2^( 6) =       0.001254170409
  error estimate for blocks of size 2^( 7) =       0.001260334136

      target function =                  N/A
              le_mean =     -16.715620840571
             les_mean =     282.013844745303
             stat err =       0.001248406671
             autocorr =       1.198619433984
              std dev =       1.612639784181
             le_variance =       2.600607073525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.601615010052
                                         uncertainty =       0.039440524011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.601615010052
                                         uncertainty =       0.039440524011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140455180
  error estimate for blocks of size 2^( 2) =       0.001179026479
  error estimate for blocks of size 2^( 3) =       0.001212908887
  error estimate for blocks of size 2^( 4) =       0.001232887199
  error estimate for blocks of size 2^( 5) =       0.001246286402
  error estimate for blocks of size 2^( 6) =       0.001254178832
  error estimate for blocks of size 2^( 7) =       0.001260354190

      target function =                  N/A
              le_mean =     -16.715602786185
             les_mean =     282.002909760411
             stat err =       0.001248426656
             autocorr =       1.198311209646
              std dev =       1.612872987736
             le_variance =       2.601359274569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.602367302100
                                         uncertainty =       0.039451699774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.602367302100
                                         uncertainty =       0.039451699774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140619982
  error estimate for blocks of size 2^( 2) =       0.001179168422
  error estimate for blocks of size 2^( 3) =       0.001213027192
  error estimate for blocks of size 2^( 4) =       0.001232981188
  error estimate for blocks of size 2^( 5) =       0.001246380394
  error estimate for blocks of size 2^( 6) =       0.001254285729
  error estimate for blocks of size 2^( 7) =       0.001260504550

      target function =                  N/A
              le_mean =     -16.715649927980
             les_mean =     282.005512380035
             stat err =       0.001248537965
             autocorr =       1.198178588817
              std dev =       1.613106057135
             le_variance =       2.602111151564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.601042501645
                                         uncertainty =       0.039434565715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.601042501645
                                         uncertainty =       0.039434565715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140329704
  error estimate for blocks of size 2^( 2) =       0.001178932280
  error estimate for blocks of size 2^( 3) =       0.001212827117
  error estimate for blocks of size 2^( 4) =       0.001232831873
  error estimate for blocks of size 2^( 5) =       0.001246239835
  error estimate for blocks of size 2^( 6) =       0.001254135007
  error estimate for blocks of size 2^( 7) =       0.001260300795

      target function =                  N/A
              le_mean =     -16.715597217103
             les_mean =     281.997333305257
             stat err =       0.001248376877
             autocorr =       1.198479356266
              std dev =       1.612695535153
             le_variance =       2.600786889102


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.715620840571        initial
     2.4414e-02     2.4414e-01             6.0903e-03       -16.715602786185
     9.7656e-02     9.7656e-01             1.3769e-03       -16.715649927980  <--
     3.9062e-01     3.9062e+00             5.9980e-04       -16.715597217103

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.4070e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.026519e-01 3 1  ON 0
ci_0002                 6.838038e-01 3 1  ON 1
ci_0003                -4.895598e-02 3 1  ON 2
ci_0004                -4.734759e-02 3 1  ON 3
ci_0005                -4.598619e-02 3 1  ON 4
ci_0006                -4.463401e-02 3 1  ON 5
ci_0007                -3.127734e-02 3 1  ON 6
ci_0008                -3.230703e-02 3 1  ON 7
ci_0009                -3.210385e-02 3 1  ON 8
ci_0010                -3.171854e-02 3 1  ON 9
ci_0011                -2.799035e-02 3 1  ON 10
ci_0012                -2.701000e-02 3 1  ON 11
ci_0013                 2.729741e-02 3 1  ON 12
ci_0014                 2.653623e-02 3 1  ON 13
ci_0015                 2.781920e-02 3 1  ON 14
ci_0016                 2.667991e-02 3 1  ON 15
ci_0017                 2.515821e-02 3 1  ON 16
ci_0018                 2.408571e-02 3 1  ON 17
ci_0019                 2.037739e-02 3 1  ON 18
ci_0020                 2.001874e-02 3 1  ON 19
ci_0021                 1.800138e-02 3 1  ON 20
ci_0022                 1.890862e-02 3 1  ON 21
ci_0023                -1.982177e-02 3 1  ON 22
ci_0024                -1.821717e-02 3 1  ON 23
ci_0025                -1.829721e-02 3 1  ON 24
ci_0026                -1.824079e-02 3 1  ON 25
ci_0027                -1.771950e-02 3 1  ON 26
ci_0028                -1.698273e-02 3 1  ON 27
ci_0029                -1.584057e-02 3 1  ON 28
ci_0030                -1.522409e-02 3 1  ON 29
ci_0031                 1.478694e-02 3 1  ON 30
ci_0032                 1.434330e-02 3 1  ON 31
ci_0033                 1.657017e-02 3 1  ON 32
ci_0034                 1.565855e-02 3 1  ON 33
ci_0035                 1.771644e-02 3 1  ON 34
ci_0036                 1.753739e-02 3 1  ON 35
ci_0037                -1.389867e-02 3 1  ON 36
ci_0038                -1.518830e-02 3 1  ON 37
ci_0039                -1.539071e-02 3 1  ON 38
ci_0040                -1.511856e-02 3 1  ON 39
ci_0041                 1.525515e-02 3 1  ON 40
ci_0042                 1.613517e-02 3 1  ON 41
ci_0043                -1.419222e-02 3 1  ON 42
ci_0044                -1.470205e-02 3 1  ON 43
ci_0045                 1.534384e-02 3 1  ON 44
ci_0046                 1.481754e-02 3 1  ON 45
ci_0047                -1.465518e-02 3 1  ON 46
ci_0048                -1.390726e-02 3 1  ON 47
ci_0049                -1.288293e-02 3 1  ON 48
ci_0050                -1.259001e-02 3 1  ON 49
ci_0051                -1.314474e-02 3 1  ON 50
ci_0052                -1.235075e-02 3 1  ON 51
ci_0053                -1.331334e-02 3 1  ON 52
ci_0054                -1.233048e-02 3 1  ON 53
ci_0055                 1.251290e-02 3 1  ON 54
ci_0056                 1.284345e-02 3 1  ON 55
ci_0057                 1.326870e-02 3 1  ON 56
ci_0058                 1.205265e-02 3 1  ON 57
ci_0059                -1.301502e-02 3 1  ON 58
ci_0060                -1.232266e-02 3 1  ON 59
ci_0061                -1.289259e-02 3 1  ON 60
ci_0062                -1.234350e-02 3 1  ON 61
ci_0063                -1.178482e-02 3 1  ON 62
ci_0064                -1.106509e-02 3 1  ON 63
ci_0065                -1.197352e-02 3 1  ON 64
ci_0066                -1.092289e-02 3 1  ON 65
ci_0067                -1.166386e-02 3 1  ON 66
ci_0068                -1.109946e-02 3 1  ON 67
ci_0069                 1.047718e-02 3 1  ON 68
ci_0070                 9.821680e-03 3 1  ON 69
ci_0071                 1.032672e-02 3 1  ON 70
ci_0072                 1.034409e-02 3 1  ON 71
ci_0073                 1.117770e-02 3 1  ON 72
ci_0074                 1.117807e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0269e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6719e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.7317
    reference variance = 2.31305
====================================================
  Execution time = 1.3038e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0242e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5509e+00
  Total weights = 1.945934660e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2238e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.579948949456
                                         uncertainty =       0.049068844292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.579948949456
                                         uncertainty =       0.049068844292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135602424
  error estimate for blocks of size 2^( 2) =       0.001174705139
  error estimate for blocks of size 2^( 3) =       0.001207177332
  error estimate for blocks of size 2^( 4) =       0.001232103991
  error estimate for blocks of size 2^( 5) =       0.001247779347
  error estimate for blocks of size 2^( 6) =       0.001253565064
  error estimate for blocks of size 2^( 7) =       0.001256956504

      target function =                  N/A
              le_mean =     -16.717923705197
             les_mean =     282.039855196620
             stat err =       0.001247601227
             autocorr =       1.206976916082
              std dev =       1.606010045609
             le_variance =       2.579268266597


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671792370520e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717923704256       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717969609160       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717984093782       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717981976340       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.717988578011       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.717988321731       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.717987992385       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.717988543466       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.717988737747       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-02 is 6.122534e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717923704256       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717960235165       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717968832564       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717967554590       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.717968525053       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.717968292036       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.717968269780       residual = 8.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-02 is 1.479538e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717923704256       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717943811272       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717946643875       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717946413407       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 7.824419e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126422 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6270e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.041314e-01 3 1  ON 0
ci_0002                 6.824083e-01 3 1  ON 1
ci_0003                -4.906502e-02 3 1  ON 2
ci_0004                -4.647717e-02 3 1  ON 3
ci_0005                -4.639068e-02 3 1  ON 4
ci_0006                -4.489139e-02 3 1  ON 5
ci_0007                -3.066338e-02 3 1  ON 6
ci_0008                -3.182642e-02 3 1  ON 7
ci_0009                -3.137984e-02 3 1  ON 8
ci_0010                -3.147691e-02 3 1  ON 9
ci_0011                -2.753140e-02 3 1  ON 10
ci_0012                -2.760512e-02 3 1  ON 11
ci_0013                 2.779828e-02 3 1  ON 12
ci_0014                 2.630360e-02 3 1  ON 13
ci_0015                 2.754845e-02 3 1  ON 14
ci_0016                 2.621703e-02 3 1  ON 15
ci_0017                 2.418891e-02 3 1  ON 16
ci_0018                 2.398694e-02 3 1  ON 17
ci_0019                 1.959033e-02 3 1  ON 18
ci_0020                 1.925564e-02 3 1  ON 19
ci_0021                 1.903279e-02 3 1  ON 20
ci_0022                 1.977487e-02 3 1  ON 21
ci_0023                -1.936408e-02 3 1  ON 22
ci_0024                -1.803778e-02 3 1  ON 23
ci_0025                -1.923883e-02 3 1  ON 24
ci_0026                -1.700923e-02 3 1  ON 25
ci_0027                -1.755845e-02 3 1  ON 26
ci_0028                -1.752774e-02 3 1  ON 27
ci_0029                -1.508806e-02 3 1  ON 28
ci_0030                -1.613942e-02 3 1  ON 29
ci_0031                 1.463258e-02 3 1  ON 30
ci_0032                 1.439467e-02 3 1  ON 31
ci_0033                 1.580368e-02 3 1  ON 32
ci_0034                 1.570149e-02 3 1  ON 33
ci_0035                 1.749572e-02 3 1  ON 34
ci_0036                 1.779188e-02 3 1  ON 35
ci_0037                -1.360789e-02 3 1  ON 36
ci_0038                -1.455290e-02 3 1  ON 37
ci_0039                -1.583907e-02 3 1  ON 38
ci_0040                -1.444177e-02 3 1  ON 39
ci_0041                 1.616020e-02 3 1  ON 40
ci_0042                 1.510088e-02 3 1  ON 41
ci_0043                -1.387481e-02 3 1  ON 42
ci_0044                -1.412725e-02 3 1  ON 43
ci_0045                 1.590090e-02 3 1  ON 44
ci_0046                 1.616529e-02 3 1  ON 45
ci_0047                -1.441379e-02 3 1  ON 46
ci_0048                -1.388234e-02 3 1  ON 47
ci_0049                -1.227733e-02 3 1  ON 48
ci_0050                -1.325533e-02 3 1  ON 49
ci_0051                -1.315221e-02 3 1  ON 50
ci_0052                -1.327487e-02 3 1  ON 51
ci_0053                -1.351000e-02 3 1  ON 52
ci_0054                -1.176378e-02 3 1  ON 53
ci_0055                 1.253647e-02 3 1  ON 54
ci_0056                 1.324886e-02 3 1  ON 55
ci_0057                 1.301349e-02 3 1  ON 56
ci_0058                 1.262059e-02 3 1  ON 57
ci_0059                -1.284041e-02 3 1  ON 58
ci_0060                -1.247054e-02 3 1  ON 59
ci_0061                -1.248891e-02 3 1  ON 60
ci_0062                -1.248110e-02 3 1  ON 61
ci_0063                -1.214471e-02 3 1  ON 62
ci_0064                -1.155209e-02 3 1  ON 63
ci_0065                -1.165242e-02 3 1  ON 64
ci_0066                -1.140130e-02 3 1  ON 65
ci_0067                -1.298276e-02 3 1  ON 66
ci_0068                -1.059265e-02 3 1  ON 67
ci_0069                 1.132771e-02 3 1  ON 68
ci_0070                 9.714035e-03 3 1  ON 69
ci_0071                 1.059222e-02 3 1  ON 70
ci_0072                 1.048543e-02 3 1  ON 71
ci_0073                 1.133063e-02 3 1  ON 72
ci_0074                 1.131280e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.7128
    reference variance = 2.02475
====================================================
  Execution time = 1.2697e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.6654e+00
  Total weights = 1.9458e+06
  Execution time = 2.2510e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.695171157553
                                         uncertainty =       0.096683448896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.695171157553
                                         uncertainty =       0.096683448896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001161009642
  error estimate for blocks of size 2^( 2) =       0.001198169637
  error estimate for blocks of size 2^( 3) =       0.001229528933
  error estimate for blocks of size 2^( 4) =       0.001252397714
  error estimate for blocks of size 2^( 5) =       0.001266297882
  error estimate for blocks of size 2^( 6) =       0.001276060659
  error estimate for blocks of size 2^( 7) =       0.001273025175

      target function =                  N/A
              le_mean =     -16.715931442050
             les_mean =     282.126986184000
             stat err =       0.001266945358
             autocorr =       1.190814505031
              std dev =       1.641941852175
             le_variance =       2.695973045925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.696486864073
                                         uncertainty =       0.096723710526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.696486864073
                                         uncertainty =       0.096723710526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001161293069
  error estimate for blocks of size 2^( 2) =       0.001198509580
  error estimate for blocks of size 2^( 3) =       0.001229925862
  error estimate for blocks of size 2^( 4) =       0.001252862027
  error estimate for blocks of size 2^( 5) =       0.001266815424
  error estimate for blocks of size 2^( 6) =       0.001276489851
  error estimate for blocks of size 2^( 7) =       0.001273433734

      target function =                  N/A
              le_mean =     -16.715926966997
             les_mean =     282.102944898128
             stat err =       0.001267400259
             autocorr =       1.191088181239
              std dev =       1.642342684637
             le_variance =       2.697289493780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.698557475159
                                         uncertainty =       0.096745592875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.698557475159
                                         uncertainty =       0.096745592875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001161738343
  error estimate for blocks of size 2^( 2) =       0.001198979741
  error estimate for blocks of size 2^( 3) =       0.001230432096
  error estimate for blocks of size 2^( 4) =       0.001253414720
  error estimate for blocks of size 2^( 5) =       0.001267357190
  error estimate for blocks of size 2^( 6) =       0.001277011366
  error estimate for blocks of size 2^( 7) =       0.001273955249

      target function =                  N/A
              le_mean =     -16.716017251256
             les_mean =     282.217589609193
             stat err =       0.001267934631
             autocorr =       1.191179144235
              std dev =       1.642972407552
             le_variance =       2.699358331977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.695508287890
                                         uncertainty =       0.096704415009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.695508287890
                                         uncertainty =       0.096704415009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001161082380
  error estimate for blocks of size 2^( 2) =       0.001198257597
  error estimate for blocks of size 2^( 3) =       0.001229639824
  error estimate for blocks of size 2^( 4) =       0.001252531579
  error estimate for blocks of size 2^( 5) =       0.001266445193
  error estimate for blocks of size 2^( 6) =       0.001276160349
  error estimate for blocks of size 2^( 7) =       0.001273148980

      target function =                  N/A
              le_mean =     -16.715913697640
             les_mean =     282.087022563496
             stat err =       0.001267071525
             autocorr =       1.190902463318
              std dev =       1.642044720327
             le_variance =       2.696310863555


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.715931442050        initial
     2.4414e-02     2.4414e-01             6.1225e-03       -16.715926966997
     9.7656e-02     9.7656e-01             1.4795e-03       -16.716017251256  <--
     3.9062e-01     3.9062e+00             7.8244e-04       -16.715913697640

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.4087e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.041314e-01 3 1  ON 0
ci_0002                 6.824083e-01 3 1  ON 1
ci_0003                -4.906502e-02 3 1  ON 2
ci_0004                -4.647717e-02 3 1  ON 3
ci_0005                -4.639068e-02 3 1  ON 4
ci_0006                -4.489139e-02 3 1  ON 5
ci_0007                -3.066338e-02 3 1  ON 6
ci_0008                -3.182642e-02 3 1  ON 7
ci_0009                -3.137984e-02 3 1  ON 8
ci_0010                -3.147691e-02 3 1  ON 9
ci_0011                -2.753140e-02 3 1  ON 10
ci_0012                -2.760512e-02 3 1  ON 11
ci_0013                 2.779828e-02 3 1  ON 12
ci_0014                 2.630360e-02 3 1  ON 13
ci_0015                 2.754845e-02 3 1  ON 14
ci_0016                 2.621703e-02 3 1  ON 15
ci_0017                 2.418891e-02 3 1  ON 16
ci_0018                 2.398694e-02 3 1  ON 17
ci_0019                 1.959033e-02 3 1  ON 18
ci_0020                 1.925564e-02 3 1  ON 19
ci_0021                 1.903279e-02 3 1  ON 20
ci_0022                 1.977487e-02 3 1  ON 21
ci_0023                -1.936408e-02 3 1  ON 22
ci_0024                -1.803778e-02 3 1  ON 23
ci_0025                -1.923883e-02 3 1  ON 24
ci_0026                -1.700923e-02 3 1  ON 25
ci_0027                -1.755845e-02 3 1  ON 26
ci_0028                -1.752774e-02 3 1  ON 27
ci_0029                -1.508806e-02 3 1  ON 28
ci_0030                -1.613942e-02 3 1  ON 29
ci_0031                 1.463258e-02 3 1  ON 30
ci_0032                 1.439467e-02 3 1  ON 31
ci_0033                 1.580368e-02 3 1  ON 32
ci_0034                 1.570149e-02 3 1  ON 33
ci_0035                 1.749572e-02 3 1  ON 34
ci_0036                 1.779188e-02 3 1  ON 35
ci_0037                -1.360789e-02 3 1  ON 36
ci_0038                -1.455290e-02 3 1  ON 37
ci_0039                -1.583907e-02 3 1  ON 38
ci_0040                -1.444177e-02 3 1  ON 39
ci_0041                 1.616020e-02 3 1  ON 40
ci_0042                 1.510088e-02 3 1  ON 41
ci_0043                -1.387481e-02 3 1  ON 42
ci_0044                -1.412725e-02 3 1  ON 43
ci_0045                 1.590090e-02 3 1  ON 44
ci_0046                 1.616529e-02 3 1  ON 45
ci_0047                -1.441379e-02 3 1  ON 46
ci_0048                -1.388234e-02 3 1  ON 47
ci_0049                -1.227733e-02 3 1  ON 48
ci_0050                -1.325533e-02 3 1  ON 49
ci_0051                -1.315221e-02 3 1  ON 50
ci_0052                -1.327487e-02 3 1  ON 51
ci_0053                -1.351000e-02 3 1  ON 52
ci_0054                -1.176378e-02 3 1  ON 53
ci_0055                 1.253647e-02 3 1  ON 54
ci_0056                 1.324886e-02 3 1  ON 55
ci_0057                 1.301349e-02 3 1  ON 56
ci_0058                 1.262059e-02 3 1  ON 57
ci_0059                -1.284041e-02 3 1  ON 58
ci_0060                -1.247054e-02 3 1  ON 59
ci_0061                -1.248891e-02 3 1  ON 60
ci_0062                -1.248110e-02 3 1  ON 61
ci_0063                -1.214471e-02 3 1  ON 62
ci_0064                -1.155209e-02 3 1  ON 63
ci_0065                -1.165242e-02 3 1  ON 64
ci_0066                -1.140130e-02 3 1  ON 65
ci_0067                -1.298276e-02 3 1  ON 66
ci_0068                -1.059265e-02 3 1  ON 67
ci_0069                 1.132771e-02 3 1  ON 68
ci_0070                 9.714035e-03 3 1  ON 69
ci_0071                 1.059222e-02 3 1  ON 70
ci_0072                 1.048543e-02 3 1  ON 71
ci_0073                 1.133063e-02 3 1  ON 72
ci_0074                 1.131280e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0363e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6720e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9738
    reference variance = 1.32039
====================================================
  Execution time = 1.3014e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0266e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5656e+00
  Total weights = 1.945704813e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2327e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.593005500205
                                         uncertainty =       0.052745527037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.593005500205
                                         uncertainty =       0.052745527037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138599403
  error estimate for blocks of size 2^( 2) =       0.001176279773
  error estimate for blocks of size 2^( 3) =       0.001209068525
  error estimate for blocks of size 2^( 4) =       0.001230941988
  error estimate for blocks of size 2^( 5) =       0.001243612067
  error estimate for blocks of size 2^( 6) =       0.001249262124
  error estimate for blocks of size 2^( 7) =       0.001255007270

      target function =                  N/A
              le_mean =     -16.718886445874
             les_mean =     282.086775750197
             stat err =       0.001244705862
             autocorr =       1.195065108363
              std dev =       1.610248480629
             le_variance =       2.592900169367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671888644587e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718886444969       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718983784588       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718991481242       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718997371474       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718995560911       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.719000261182       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.719001205118       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.719000852683       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.719000988838       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-02 is 4.069359e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718886444969       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718964466189       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718967658543       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718969532241       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718968874166       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.718969305662       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-02 is 1.759377e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718886444969       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718929938306       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718930077911       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718930268277       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 1.068564e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128802 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6254e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.050192e-01 3 1  ON 0
ci_0002                 6.813823e-01 3 1  ON 1
ci_0003                -4.926166e-02 3 1  ON 2
ci_0004                -4.714130e-02 3 1  ON 3
ci_0005                -4.647318e-02 3 1  ON 4
ci_0006                -4.390136e-02 3 1  ON 5
ci_0007                -3.170529e-02 3 1  ON 6
ci_0008                -3.128795e-02 3 1  ON 7
ci_0009                -3.235441e-02 3 1  ON 8
ci_0010                -3.189444e-02 3 1  ON 9
ci_0011                -2.735727e-02 3 1  ON 10
ci_0012                -2.648206e-02 3 1  ON 11
ci_0013                 2.734400e-02 3 1  ON 12
ci_0014                 2.588525e-02 3 1  ON 13
ci_0015                 2.775254e-02 3 1  ON 14
ci_0016                 2.684974e-02 3 1  ON 15
ci_0017                 2.501238e-02 3 1  ON 16
ci_0018                 2.425967e-02 3 1  ON 17
ci_0019                 2.041366e-02 3 1  ON 18
ci_0020                 2.016612e-02 3 1  ON 19
ci_0021                 1.908165e-02 3 1  ON 20
ci_0022                 1.857039e-02 3 1  ON 21
ci_0023                -1.861332e-02 3 1  ON 22
ci_0024                -1.886329e-02 3 1  ON 23
ci_0025                -1.933043e-02 3 1  ON 24
ci_0026                -1.822052e-02 3 1  ON 25
ci_0027                -1.722887e-02 3 1  ON 26
ci_0028                -1.731138e-02 3 1  ON 27
ci_0029                -1.552576e-02 3 1  ON 28
ci_0030                -1.691231e-02 3 1  ON 29
ci_0031                 1.464294e-02 3 1  ON 30
ci_0032                 1.454645e-02 3 1  ON 31
ci_0033                 1.509919e-02 3 1  ON 32
ci_0034                 1.581503e-02 3 1  ON 33
ci_0035                 1.734450e-02 3 1  ON 34
ci_0036                 1.726109e-02 3 1  ON 35
ci_0037                -1.418958e-02 3 1  ON 36
ci_0038                -1.426203e-02 3 1  ON 37
ci_0039                -1.531856e-02 3 1  ON 38
ci_0040                -1.473275e-02 3 1  ON 39
ci_0041                 1.550991e-02 3 1  ON 40
ci_0042                 1.553988e-02 3 1  ON 41
ci_0043                -1.460315e-02 3 1  ON 42
ci_0044                -1.521059e-02 3 1  ON 43
ci_0045                 1.543795e-02 3 1  ON 44
ci_0046                 1.563426e-02 3 1  ON 45
ci_0047                -1.432511e-02 3 1  ON 46
ci_0048                -1.433378e-02 3 1  ON 47
ci_0049                -1.242604e-02 3 1  ON 48
ci_0050                -1.303995e-02 3 1  ON 49
ci_0051                -1.328369e-02 3 1  ON 50
ci_0052                -1.345297e-02 3 1  ON 51
ci_0053                -1.346101e-02 3 1  ON 52
ci_0054                -1.195738e-02 3 1  ON 53
ci_0055                 1.281820e-02 3 1  ON 54
ci_0056                 1.324791e-02 3 1  ON 55
ci_0057                 1.336086e-02 3 1  ON 56
ci_0058                 1.291472e-02 3 1  ON 57
ci_0059                -1.335849e-02 3 1  ON 58
ci_0060                -1.298477e-02 3 1  ON 59
ci_0061                -1.259321e-02 3 1  ON 60
ci_0062                -1.220854e-02 3 1  ON 61
ci_0063                -1.185958e-02 3 1  ON 62
ci_0064                -1.173901e-02 3 1  ON 63
ci_0065                -1.107408e-02 3 1  ON 64
ci_0066                -1.184498e-02 3 1  ON 65
ci_0067                -1.122338e-02 3 1  ON 66
ci_0068                -1.025674e-02 3 1  ON 67
ci_0069                 1.073223e-02 3 1  ON 68
ci_0070                 1.044323e-02 3 1  ON 69
ci_0071                 1.089893e-02 3 1  ON 70
ci_0072                 9.909867e-03 3 1  ON 71
ci_0073                 1.147204e-02 3 1  ON 72
ci_0074                 1.096821e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8482
    reference variance = 1.29455
====================================================
  Execution time = 1.2750e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5316e+00
  Total weights = 1.9459e+06
  Execution time = 2.2565e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00776748
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.558326011591
                                         uncertainty =       0.030599894597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.558326011591
                                         uncertainty =       0.030599894597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130861214
  error estimate for blocks of size 2^( 2) =       0.001170146145
  error estimate for blocks of size 2^( 3) =       0.001201871895
  error estimate for blocks of size 2^( 4) =       0.001223777661
  error estimate for blocks of size 2^( 5) =       0.001241143663
  error estimate for blocks of size 2^( 6) =       0.001249910729
  error estimate for blocks of size 2^( 7) =       0.001253542869

      target function =                  N/A
              le_mean =     -16.717697439782
             les_mean =     282.136261390087
             stat err =       0.001242093731
             autocorr =       1.206396647350
              std dev =       1.599304854045
             le_variance =       2.557776016172

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.141811
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.558510561582
                                         uncertainty =       0.031152485693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.558510561582
                                         uncertainty =       0.031152485693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130900805
  error estimate for blocks of size 2^( 2) =       0.001170096059
  error estimate for blocks of size 2^( 3) =       0.001201754596
  error estimate for blocks of size 2^( 4) =       0.001223570781
  error estimate for blocks of size 2^( 5) =       0.001240912495
  error estimate for blocks of size 2^( 6) =       0.001249596528
  error estimate for blocks of size 2^( 7) =       0.001253240618

      target function =                  N/A
              le_mean =     -16.717660318804
             les_mean =     282.016524623504
             stat err =       0.001241830105
             autocorr =       1.205800173307
              std dev =       1.599360844991
             le_variance =       2.557955112490

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00779196
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.675378119397
                                         uncertainty =       0.122065674411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.675378119397
                                         uncertainty =       0.122065674411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001156432929
  error estimate for blocks of size 2^( 2) =       0.001194702242
  error estimate for blocks of size 2^( 3) =       0.001225948136
  error estimate for blocks of size 2^( 4) =       0.001247502150
  error estimate for blocks of size 2^( 5) =       0.001264530998
  error estimate for blocks of size 2^( 6) =       0.001273099822
  error estimate for blocks of size 2^( 7) =       0.001277776849

      target function =                  N/A
              le_mean =     -16.717930545616
             les_mean =     282.267767722595
             stat err =       0.001265727455
             autocorr =       1.197952233506
              std dev =       1.635469299486
             le_variance =       2.674759829561

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.140238
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.558925560538
                                         uncertainty =       0.030697096834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.558925560538
                                         uncertainty =       0.030697096834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130992923
  error estimate for blocks of size 2^( 2) =       0.001170152518
  error estimate for blocks of size 2^( 3) =       0.001201823346
  error estimate for blocks of size 2^( 4) =       0.001223663272
  error estimate for blocks of size 2^( 5) =       0.001240985638
  error estimate for blocks of size 2^( 6) =       0.001249765390
  error estimate for blocks of size 2^( 7) =       0.001253208339

      target function =                  N/A
              le_mean =     -16.717684305687
             les_mean =     282.338750027577
             stat err =       0.001241905660
             autocorr =       1.205750463199
              std dev =       1.599491122425
             le_variance =       2.558371850716


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717697439782        initial
     2.4414e-02     2.4414e-01             4.0694e-03       -16.717660318804
     9.7656e-02     9.7656e-01             1.7594e-03       -16.717930545616  <--
     3.9062e-01     3.9062e+00             1.0686e-03       -16.717684305687

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.4141e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.050192e-01 3 1  ON 0
ci_0002                 6.813823e-01 3 1  ON 1
ci_0003                -4.926166e-02 3 1  ON 2
ci_0004                -4.714130e-02 3 1  ON 3
ci_0005                -4.647318e-02 3 1  ON 4
ci_0006                -4.390136e-02 3 1  ON 5
ci_0007                -3.170529e-02 3 1  ON 6
ci_0008                -3.128795e-02 3 1  ON 7
ci_0009                -3.235441e-02 3 1  ON 8
ci_0010                -3.189444e-02 3 1  ON 9
ci_0011                -2.735727e-02 3 1  ON 10
ci_0012                -2.648206e-02 3 1  ON 11
ci_0013                 2.734400e-02 3 1  ON 12
ci_0014                 2.588525e-02 3 1  ON 13
ci_0015                 2.775254e-02 3 1  ON 14
ci_0016                 2.684974e-02 3 1  ON 15
ci_0017                 2.501238e-02 3 1  ON 16
ci_0018                 2.425967e-02 3 1  ON 17
ci_0019                 2.041366e-02 3 1  ON 18
ci_0020                 2.016612e-02 3 1  ON 19
ci_0021                 1.908165e-02 3 1  ON 20
ci_0022                 1.857039e-02 3 1  ON 21
ci_0023                -1.861332e-02 3 1  ON 22
ci_0024                -1.886329e-02 3 1  ON 23
ci_0025                -1.933043e-02 3 1  ON 24
ci_0026                -1.822052e-02 3 1  ON 25
ci_0027                -1.722887e-02 3 1  ON 26
ci_0028                -1.731138e-02 3 1  ON 27
ci_0029                -1.552576e-02 3 1  ON 28
ci_0030                -1.691231e-02 3 1  ON 29
ci_0031                 1.464294e-02 3 1  ON 30
ci_0032                 1.454645e-02 3 1  ON 31
ci_0033                 1.509919e-02 3 1  ON 32
ci_0034                 1.581503e-02 3 1  ON 33
ci_0035                 1.734450e-02 3 1  ON 34
ci_0036                 1.726109e-02 3 1  ON 35
ci_0037                -1.418958e-02 3 1  ON 36
ci_0038                -1.426203e-02 3 1  ON 37
ci_0039                -1.531856e-02 3 1  ON 38
ci_0040                -1.473275e-02 3 1  ON 39
ci_0041                 1.550991e-02 3 1  ON 40
ci_0042                 1.553988e-02 3 1  ON 41
ci_0043                -1.460315e-02 3 1  ON 42
ci_0044                -1.521059e-02 3 1  ON 43
ci_0045                 1.543795e-02 3 1  ON 44
ci_0046                 1.563426e-02 3 1  ON 45
ci_0047                -1.432511e-02 3 1  ON 46
ci_0048                -1.433378e-02 3 1  ON 47
ci_0049                -1.242604e-02 3 1  ON 48
ci_0050                -1.303995e-02 3 1  ON 49
ci_0051                -1.328369e-02 3 1  ON 50
ci_0052                -1.345297e-02 3 1  ON 51
ci_0053                -1.346101e-02 3 1  ON 52
ci_0054                -1.195738e-02 3 1  ON 53
ci_0055                 1.281820e-02 3 1  ON 54
ci_0056                 1.324791e-02 3 1  ON 55
ci_0057                 1.336086e-02 3 1  ON 56
ci_0058                 1.291472e-02 3 1  ON 57
ci_0059                -1.335849e-02 3 1  ON 58
ci_0060                -1.298477e-02 3 1  ON 59
ci_0061                -1.259321e-02 3 1  ON 60
ci_0062                -1.220854e-02 3 1  ON 61
ci_0063                -1.185958e-02 3 1  ON 62
ci_0064                -1.173901e-02 3 1  ON 63
ci_0065                -1.107408e-02 3 1  ON 64
ci_0066                -1.184498e-02 3 1  ON 65
ci_0067                -1.122338e-02 3 1  ON 66
ci_0068                -1.025674e-02 3 1  ON 67
ci_0069                 1.073223e-02 3 1  ON 68
ci_0070                 1.044323e-02 3 1  ON 69
ci_0071                 1.089893e-02 3 1  ON 70
ci_0072                 9.909867e-03 3 1  ON 71
ci_0073                 1.147204e-02 3 1  ON 72
ci_0074                 1.096821e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0405e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6733e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.7086
    reference variance = 2.33607
====================================================
  Execution time = 1.2919e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0280e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5067e+00
  Total weights = 1.945423560e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2137e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.524991988096
                                         uncertainty =       0.022508411056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.524991988096
                                         uncertainty =       0.022508411056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125326070
  error estimate for blocks of size 2^( 2) =       0.001164243510
  error estimate for blocks of size 2^( 3) =       0.001197299562
  error estimate for blocks of size 2^( 4) =       0.001223081777
  error estimate for blocks of size 2^( 5) =       0.001239665167
  error estimate for blocks of size 2^( 6) =       0.001243669291
  error estimate for blocks of size 2^( 7) =       0.001249747396

      target function =                  N/A
              le_mean =     -16.717588390806
             les_mean =     281.984468506087
             stat err =       0.001239040908
             autocorr =       1.212312351817
              std dev =       1.591476852955
             le_variance =       2.532798573490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671758839081e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717588389877       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717684608018       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717695902671       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717702269593       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.717708376190       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.717714292658       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.717712876227       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.717712631224       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.717712871088       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-02 is 7.143117e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717588389877       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717664849363       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717670165260       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717671225881       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.717671510043       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.717671830389       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-02 is 1.674578e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717588389877       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717630367782       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717631203507       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717631200062       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 8.466672e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6145e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.066938e-01 3 1  ON 0
ci_0002                 6.799299e-01 3 1  ON 1
ci_0003                -4.810835e-02 3 1  ON 2
ci_0004                -4.644844e-02 3 1  ON 3
ci_0005                -4.623592e-02 3 1  ON 4
ci_0006                -4.353306e-02 3 1  ON 5
ci_0007                -3.117185e-02 3 1  ON 6
ci_0008                -3.131576e-02 3 1  ON 7
ci_0009                -3.232794e-02 3 1  ON 8
ci_0010                -3.055777e-02 3 1  ON 9
ci_0011                -2.686004e-02 3 1  ON 10
ci_0012                -2.560055e-02 3 1  ON 11
ci_0013                 2.738111e-02 3 1  ON 12
ci_0014                 2.712362e-02 3 1  ON 13
ci_0015                 2.758693e-02 3 1  ON 14
ci_0016                 2.635311e-02 3 1  ON 15
ci_0017                 2.494319e-02 3 1  ON 16
ci_0018                 2.321437e-02 3 1  ON 17
ci_0019                 2.065869e-02 3 1  ON 18
ci_0020                 1.930225e-02 3 1  ON 19
ci_0021                 1.842141e-02 3 1  ON 20
ci_0022                 1.857039e-02 3 1  ON 21
ci_0023                -2.021564e-02 3 1  ON 22
ci_0024                -1.837920e-02 3 1  ON 23
ci_0025                -1.867794e-02 3 1  ON 24
ci_0026                -1.781160e-02 3 1  ON 25
ci_0027                -1.781032e-02 3 1  ON 26
ci_0028                -1.750015e-02 3 1  ON 27
ci_0029                -1.473004e-02 3 1  ON 28
ci_0030                -1.640273e-02 3 1  ON 29
ci_0031                 1.530398e-02 3 1  ON 30
ci_0032                 1.455564e-02 3 1  ON 31
ci_0033                 1.663658e-02 3 1  ON 32
ci_0034                 1.579483e-02 3 1  ON 33
ci_0035                 1.690441e-02 3 1  ON 34
ci_0036                 1.725564e-02 3 1  ON 35
ci_0037                -1.552299e-02 3 1  ON 36
ci_0038                -1.393392e-02 3 1  ON 37
ci_0039                -1.574394e-02 3 1  ON 38
ci_0040                -1.521298e-02 3 1  ON 39
ci_0041                 1.632066e-02 3 1  ON 40
ci_0042                 1.554470e-02 3 1  ON 41
ci_0043                -1.464859e-02 3 1  ON 42
ci_0044                -1.604352e-02 3 1  ON 43
ci_0045                 1.513139e-02 3 1  ON 44
ci_0046                 1.588380e-02 3 1  ON 45
ci_0047                -1.469343e-02 3 1  ON 46
ci_0048                -1.412004e-02 3 1  ON 47
ci_0049                -1.248193e-02 3 1  ON 48
ci_0050                -1.255693e-02 3 1  ON 49
ci_0051                -1.313002e-02 3 1  ON 50
ci_0052                -1.235176e-02 3 1  ON 51
ci_0053                -1.345174e-02 3 1  ON 52
ci_0054                -1.219892e-02 3 1  ON 53
ci_0055                 1.361282e-02 3 1  ON 54
ci_0056                 1.349113e-02 3 1  ON 55
ci_0057                 1.392022e-02 3 1  ON 56
ci_0058                 1.286784e-02 3 1  ON 57
ci_0059                -1.369944e-02 3 1  ON 58
ci_0060                -1.216062e-02 3 1  ON 59
ci_0061                -1.296254e-02 3 1  ON 60
ci_0062                -1.245775e-02 3 1  ON 61
ci_0063                -1.176228e-02 3 1  ON 62
ci_0064                -1.102135e-02 3 1  ON 63
ci_0065                -1.123715e-02 3 1  ON 64
ci_0066                -1.124230e-02 3 1  ON 65
ci_0067                -1.173040e-02 3 1  ON 66
ci_0068                -1.039512e-02 3 1  ON 67
ci_0069                 1.144911e-02 3 1  ON 68
ci_0070                 1.000232e-02 3 1  ON 69
ci_0071                 9.895529e-03 3 1  ON 70
ci_0072                 1.032936e-02 3 1  ON 71
ci_0073                 1.134680e-02 3 1  ON 72
ci_0074                 1.067671e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8866
    reference variance = 1.25944
====================================================
  Execution time = 1.2673e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5384e+00
  Total weights = 1.9457e+06
  Execution time = 2.2598e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.566474849180
                                         uncertainty =       0.035723869622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.566474849180
                                         uncertainty =       0.035723869622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132673475
  error estimate for blocks of size 2^( 2) =       0.001171657730
  error estimate for blocks of size 2^( 3) =       0.001204706526
  error estimate for blocks of size 2^( 4) =       0.001226896785
  error estimate for blocks of size 2^( 5) =       0.001242279527
  error estimate for blocks of size 2^( 6) =       0.001253050267
  error estimate for blocks of size 2^( 7) =       0.001259266708

      target function =                  N/A
              le_mean =     -16.719836287981
             les_mean =     282.278405000771
             stat err =       0.001245373322
             autocorr =       1.208897989578
              std dev =       1.601867819750
             le_variance =       2.565980511951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.563622607503
                                         uncertainty =       0.035678645802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.563622607503
                                         uncertainty =       0.035678645802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132046164
  error estimate for blocks of size 2^( 2) =       0.001171114493
  error estimate for blocks of size 2^( 3) =       0.001204249595
  error estimate for blocks of size 2^( 4) =       0.001226481932
  error estimate for blocks of size 2^( 5) =       0.001241835056
  error estimate for blocks of size 2^( 6) =       0.001252590906
  error estimate for blocks of size 2^( 7) =       0.001258458764

      target function =                  N/A
              le_mean =     -16.719805706411
             les_mean =     282.104833313995
             stat err =       0.001244841664
             autocorr =       1.209205062179
              std dev =       1.600980652847
             le_variance =       2.563139050790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.563618716126
                                         uncertainty =       0.035680406761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.563618716126
                                         uncertainty =       0.035680406761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132045706
  error estimate for blocks of size 2^( 2) =       0.001171152832
  error estimate for blocks of size 2^( 3) =       0.001204323648
  error estimate for blocks of size 2^( 4) =       0.001226581436
  error estimate for blocks of size 2^( 5) =       0.001241958755
  error estimate for blocks of size 2^( 6) =       0.001252685188
  error estimate for blocks of size 2^( 7) =       0.001258476183

      target function =                  N/A
              le_mean =     -16.719873658139
             les_mean =     282.101223769989
             stat err =       0.001244925390
             autocorr =       1.209368702846
              std dev =       1.600980006008
             le_variance =       2.563136979637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.563536236464
                                         uncertainty =       0.035673564051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.563536236464
                                         uncertainty =       0.035673564051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132026340
  error estimate for blocks of size 2^( 2) =       0.001171061604
  error estimate for blocks of size 2^( 3) =       0.001204169531
  error estimate for blocks of size 2^( 4) =       0.001226399671
  error estimate for blocks of size 2^( 5) =       0.001241772537
  error estimate for blocks of size 2^( 6) =       0.001252571707
  error estimate for blocks of size 2^( 7) =       0.001258513617

      target function =                  N/A
              le_mean =     -16.719798367703
             les_mean =     282.101360014651
             stat err =       0.001244814383
             autocorr =       1.209194410176
              std dev =       1.600952617858
             le_variance =       2.563049284626


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719836287981        initial
     2.4414e-02     2.4414e-01             7.1431e-03       -16.719805706411
     9.7656e-02     9.7656e-01             1.6746e-03       -16.719873658139  <--
     3.9062e-01     3.9062e+00             8.4667e-04       -16.719798367703

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.4087e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.066938e-01 3 1  ON 0
ci_0002                 6.799299e-01 3 1  ON 1
ci_0003                -4.810835e-02 3 1  ON 2
ci_0004                -4.644844e-02 3 1  ON 3
ci_0005                -4.623592e-02 3 1  ON 4
ci_0006                -4.353306e-02 3 1  ON 5
ci_0007                -3.117185e-02 3 1  ON 6
ci_0008                -3.131576e-02 3 1  ON 7
ci_0009                -3.232794e-02 3 1  ON 8
ci_0010                -3.055777e-02 3 1  ON 9
ci_0011                -2.686004e-02 3 1  ON 10
ci_0012                -2.560055e-02 3 1  ON 11
ci_0013                 2.738111e-02 3 1  ON 12
ci_0014                 2.712362e-02 3 1  ON 13
ci_0015                 2.758693e-02 3 1  ON 14
ci_0016                 2.635311e-02 3 1  ON 15
ci_0017                 2.494319e-02 3 1  ON 16
ci_0018                 2.321437e-02 3 1  ON 17
ci_0019                 2.065869e-02 3 1  ON 18
ci_0020                 1.930225e-02 3 1  ON 19
ci_0021                 1.842141e-02 3 1  ON 20
ci_0022                 1.857039e-02 3 1  ON 21
ci_0023                -2.021564e-02 3 1  ON 22
ci_0024                -1.837920e-02 3 1  ON 23
ci_0025                -1.867794e-02 3 1  ON 24
ci_0026                -1.781160e-02 3 1  ON 25
ci_0027                -1.781032e-02 3 1  ON 26
ci_0028                -1.750015e-02 3 1  ON 27
ci_0029                -1.473004e-02 3 1  ON 28
ci_0030                -1.640273e-02 3 1  ON 29
ci_0031                 1.530398e-02 3 1  ON 30
ci_0032                 1.455564e-02 3 1  ON 31
ci_0033                 1.663658e-02 3 1  ON 32
ci_0034                 1.579483e-02 3 1  ON 33
ci_0035                 1.690441e-02 3 1  ON 34
ci_0036                 1.725564e-02 3 1  ON 35
ci_0037                -1.552299e-02 3 1  ON 36
ci_0038                -1.393392e-02 3 1  ON 37
ci_0039                -1.574394e-02 3 1  ON 38
ci_0040                -1.521298e-02 3 1  ON 39
ci_0041                 1.632066e-02 3 1  ON 40
ci_0042                 1.554470e-02 3 1  ON 41
ci_0043                -1.464859e-02 3 1  ON 42
ci_0044                -1.604352e-02 3 1  ON 43
ci_0045                 1.513139e-02 3 1  ON 44
ci_0046                 1.588380e-02 3 1  ON 45
ci_0047                -1.469343e-02 3 1  ON 46
ci_0048                -1.412004e-02 3 1  ON 47
ci_0049                -1.248193e-02 3 1  ON 48
ci_0050                -1.255693e-02 3 1  ON 49
ci_0051                -1.313002e-02 3 1  ON 50
ci_0052                -1.235176e-02 3 1  ON 51
ci_0053                -1.345174e-02 3 1  ON 52
ci_0054                -1.219892e-02 3 1  ON 53
ci_0055                 1.361282e-02 3 1  ON 54
ci_0056                 1.349113e-02 3 1  ON 55
ci_0057                 1.392022e-02 3 1  ON 56
ci_0058                 1.286784e-02 3 1  ON 57
ci_0059                -1.369944e-02 3 1  ON 58
ci_0060                -1.216062e-02 3 1  ON 59
ci_0061                -1.296254e-02 3 1  ON 60
ci_0062                -1.245775e-02 3 1  ON 61
ci_0063                -1.176228e-02 3 1  ON 62
ci_0064                -1.102135e-02 3 1  ON 63
ci_0065                -1.123715e-02 3 1  ON 64
ci_0066                -1.124230e-02 3 1  ON 65
ci_0067                -1.173040e-02 3 1  ON 66
ci_0068                -1.039512e-02 3 1  ON 67
ci_0069                 1.144911e-02 3 1  ON 68
ci_0070                 1.000232e-02 3 1  ON 69
ci_0071                 9.895529e-03 3 1  ON 70
ci_0072                 1.032936e-02 3 1  ON 71
ci_0073                 1.134680e-02 3 1  ON 72
ci_0074                 1.067671e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0246e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6738e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8696
    reference variance = 1.54994
====================================================
  Execution time = 1.2958e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0282e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4912e+00
  Total weights = 1.945613254e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2253e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.518223033920
                                         uncertainty =       0.024923505291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.518223033920
                                         uncertainty =       0.024923505291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122079493
  error estimate for blocks of size 2^( 2) =       0.001161417271
  error estimate for blocks of size 2^( 3) =       0.001194341794
  error estimate for blocks of size 2^( 4) =       0.001217484285
  error estimate for blocks of size 2^( 5) =       0.001231264433
  error estimate for blocks of size 2^( 6) =       0.001241627785
  error estimate for blocks of size 2^( 7) =       0.001245742847

      target function =                  N/A
              le_mean =     -16.718861111674
             les_mean =     282.011541060373
             stat err =       0.001234029837
             autocorr =       1.209494980264
              std dev =       1.586885426894
             le_variance =       2.518205358088


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671886111167e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718861110778       residual = 9.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719000485597       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719006155657       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719012044956       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.719014262991       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.719020721021       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.719021261550       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.719021363763       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.719021146253       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-02 is 6.236202e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718861110778       residual = 9.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718963784532       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718971072382       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718971908256       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718972130438       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.718972606809       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.718972539823       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-02 is 4.152743e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718861110778       residual = 9.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718911114143       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718917309749       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718916824215       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718916925926       residual = 6.91e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 1.763754e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139250 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6196e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.080538e-01 3 1  ON 0
ci_0002                 6.788706e-01 3 1  ON 1
ci_0003                -4.743036e-02 3 1  ON 2
ci_0004                -4.611134e-02 3 1  ON 3
ci_0005                -4.595487e-02 3 1  ON 4
ci_0006                -4.365077e-02 3 1  ON 5
ci_0007                -3.153095e-02 3 1  ON 6
ci_0008                -3.049928e-02 3 1  ON 7
ci_0009                -3.323958e-02 3 1  ON 8
ci_0010                -3.085238e-02 3 1  ON 9
ci_0011                -2.765333e-02 3 1  ON 10
ci_0012                -2.596327e-02 3 1  ON 11
ci_0013                 2.751045e-02 3 1  ON 12
ci_0014                 2.659137e-02 3 1  ON 13
ci_0015                 2.825745e-02 3 1  ON 14
ci_0016                 2.583706e-02 3 1  ON 15
ci_0017                 2.399035e-02 3 1  ON 16
ci_0018                 2.327270e-02 3 1  ON 17
ci_0019                 2.019906e-02 3 1  ON 18
ci_0020                 1.957875e-02 3 1  ON 19
ci_0021                 1.697152e-02 3 1  ON 20
ci_0022                 1.720072e-02 3 1  ON 21
ci_0023                -1.944929e-02 3 1  ON 22
ci_0024                -1.864538e-02 3 1  ON 23
ci_0025                -1.909101e-02 3 1  ON 24
ci_0026                -1.672855e-02 3 1  ON 25
ci_0027                -1.891827e-02 3 1  ON 26
ci_0028                -1.735940e-02 3 1  ON 27
ci_0029                -1.637656e-02 3 1  ON 28
ci_0030                -1.464810e-02 3 1  ON 29
ci_0031                 1.530627e-02 3 1  ON 30
ci_0032                 1.405456e-02 3 1  ON 31
ci_0033                 1.248384e-02 3 1  ON 32
ci_0034                 1.574876e-02 3 1  ON 33
ci_0035                 1.770580e-02 3 1  ON 34
ci_0036                 1.753819e-02 3 1  ON 35
ci_0037                -1.818558e-02 3 1  ON 36
ci_0038                -1.451610e-02 3 1  ON 37
ci_0039                -1.554948e-02 3 1  ON 38
ci_0040                -1.482923e-02 3 1  ON 39
ci_0041                 1.612226e-02 3 1  ON 40
ci_0042                 1.446093e-02 3 1  ON 41
ci_0043                -1.592149e-02 3 1  ON 42
ci_0044                -1.489807e-02 3 1  ON 43
ci_0045                 1.562914e-02 3 1  ON 44
ci_0046                 1.509271e-02 3 1  ON 45
ci_0047                -1.499259e-02 3 1  ON 46
ci_0048                -1.366417e-02 3 1  ON 47
ci_0049                -1.197281e-02 3 1  ON 48
ci_0050                -1.324002e-02 3 1  ON 49
ci_0051                -1.353216e-02 3 1  ON 50
ci_0052                -1.218823e-02 3 1  ON 51
ci_0053                -1.283225e-02 3 1  ON 52
ci_0054                -1.278577e-02 3 1  ON 53
ci_0055                 1.323708e-02 3 1  ON 54
ci_0056                 1.271851e-02 3 1  ON 55
ci_0057                 1.048980e-02 3 1  ON 56
ci_0058                 1.139739e-02 3 1  ON 57
ci_0059                -1.296053e-02 3 1  ON 58
ci_0060                -1.250565e-02 3 1  ON 59
ci_0061                -1.270326e-02 3 1  ON 60
ci_0062                -1.239006e-02 3 1  ON 61
ci_0063                -1.159593e-02 3 1  ON 62
ci_0064                -1.062006e-02 3 1  ON 63
ci_0065                -1.215738e-02 3 1  ON 64
ci_0066                -1.118567e-02 3 1  ON 65
ci_0067                -1.133199e-02 3 1  ON 66
ci_0068                -1.070591e-02 3 1  ON 67
ci_0069                 1.143994e-02 3 1  ON 68
ci_0070                 1.026527e-02 3 1  ON 69
ci_0071                 9.149540e-03 3 1  ON 70
ci_0072                 1.000763e-02 3 1  ON 71
ci_0073                 1.114740e-02 3 1  ON 72
ci_0074                 1.033684e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.621
    reference variance = 2.42247
====================================================
  Execution time = 1.2681e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.6244e+00
  Total weights = 1.9456e+06
  Execution time = 2.2544e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.659340494179
                                         uncertainty =       0.074625676007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.659340494179
                                         uncertainty =       0.074625676007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001152923495
  error estimate for blocks of size 2^( 2) =       0.001189903881
  error estimate for blocks of size 2^( 3) =       0.001220979668
  error estimate for blocks of size 2^( 4) =       0.001240947827
  error estimate for blocks of size 2^( 5) =       0.001252549221
  error estimate for blocks of size 2^( 6) =       0.001260583177
  error estimate for blocks of size 2^( 7) =       0.001262248848

      target function =                  N/A
              le_mean =     -16.717090770635
             les_mean =     282.112258099334
             stat err =       0.001254082268
             autocorr =       1.183180696589
              std dev =       1.630506130239
             le_variance =       2.658550240748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.656624246646
                                         uncertainty =       0.074615790626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.656624246646
                                         uncertainty =       0.074615790626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001152335867
  error estimate for blocks of size 2^( 2) =       0.001189394583
  error estimate for blocks of size 2^( 3) =       0.001220558471
  error estimate for blocks of size 2^( 4) =       0.001240508002
  error estimate for blocks of size 2^( 5) =       0.001252201514
  error estimate for blocks of size 2^( 6) =       0.001260303370
  error estimate for blocks of size 2^( 7) =       0.001262088032

      target function =                  N/A
              le_mean =     -16.716974165588
             les_mean =     282.094027163313
             stat err =       0.001253775230
             autocorr =       1.183807838919
              std dev =       1.629675085388
             le_variance =       2.655840883933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.034750109300
                                         uncertainty =       0.283135613048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.034750109300
                                         uncertainty =       0.283135613048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001231482746
  error estimate for blocks of size 2^( 2) =       0.001266188649
  error estimate for blocks of size 2^( 3) =       0.001295505722
  error estimate for blocks of size 2^( 4) =       0.001314691720
  error estimate for blocks of size 2^( 5) =       0.001326301022
  error estimate for blocks of size 2^( 6) =       0.001333520106
  error estimate for blocks of size 2^( 7) =       0.001334365595

      target function =                  N/A
              le_mean =     -16.717004737018
             les_mean =     304.747237996869
             stat err =       0.001327219611
             autocorr =       1.161525950657
              std dev =       1.741607466726
             le_variance =       3.033196568156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.659789631112
                                         uncertainty =       0.074549038095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.659789631112
                                         uncertainty =       0.074549038095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001153022157
  error estimate for blocks of size 2^( 2) =       0.001190015476
  error estimate for blocks of size 2^( 3) =       0.001221105117
  error estimate for blocks of size 2^( 4) =       0.001241053969
  error estimate for blocks of size 2^( 5) =       0.001252619365
  error estimate for blocks of size 2^( 6) =       0.001260676695
  error estimate for blocks of size 2^( 7) =       0.001262483594

      target function =                  N/A
              le_mean =     -16.716965559058
             les_mean =     283.690331402054
             stat err =       0.001254208406
             autocorr =       1.183216201981
              std dev =       1.630645662397
             le_variance =       2.659005276294


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717090770635        initial  <--
     2.4414e-02     2.4414e-01             6.2362e-03       -16.716974165588
     9.7656e-02     9.7656e-01             4.1527e-03       -16.717004737018
     3.9062e-01     3.9062e+00             1.7638e-03       -16.716965559058

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0762
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.066938e-01 3 1  ON 0
ci_0002                 6.799299e-01 3 1  ON 1
ci_0003                -4.810835e-02 3 1  ON 2
ci_0004                -4.644844e-02 3 1  ON 3
ci_0005                -4.623592e-02 3 1  ON 4
ci_0006                -4.353306e-02 3 1  ON 5
ci_0007                -3.117185e-02 3 1  ON 6
ci_0008                -3.131576e-02 3 1  ON 7
ci_0009                -3.232794e-02 3 1  ON 8
ci_0010                -3.055777e-02 3 1  ON 9
ci_0011                -2.686004e-02 3 1  ON 10
ci_0012                -2.560055e-02 3 1  ON 11
ci_0013                 2.738111e-02 3 1  ON 12
ci_0014                 2.712362e-02 3 1  ON 13
ci_0015                 2.758693e-02 3 1  ON 14
ci_0016                 2.635311e-02 3 1  ON 15
ci_0017                 2.494319e-02 3 1  ON 16
ci_0018                 2.321437e-02 3 1  ON 17
ci_0019                 2.065869e-02 3 1  ON 18
ci_0020                 1.930225e-02 3 1  ON 19
ci_0021                 1.842141e-02 3 1  ON 20
ci_0022                 1.857039e-02 3 1  ON 21
ci_0023                -2.021564e-02 3 1  ON 22
ci_0024                -1.837920e-02 3 1  ON 23
ci_0025                -1.867794e-02 3 1  ON 24
ci_0026                -1.781160e-02 3 1  ON 25
ci_0027                -1.781032e-02 3 1  ON 26
ci_0028                -1.750015e-02 3 1  ON 27
ci_0029                -1.473004e-02 3 1  ON 28
ci_0030                -1.640273e-02 3 1  ON 29
ci_0031                 1.530398e-02 3 1  ON 30
ci_0032                 1.455564e-02 3 1  ON 31
ci_0033                 1.663658e-02 3 1  ON 32
ci_0034                 1.579483e-02 3 1  ON 33
ci_0035                 1.690441e-02 3 1  ON 34
ci_0036                 1.725564e-02 3 1  ON 35
ci_0037                -1.552299e-02 3 1  ON 36
ci_0038                -1.393392e-02 3 1  ON 37
ci_0039                -1.574394e-02 3 1  ON 38
ci_0040                -1.521298e-02 3 1  ON 39
ci_0041                 1.632066e-02 3 1  ON 40
ci_0042                 1.554470e-02 3 1  ON 41
ci_0043                -1.464859e-02 3 1  ON 42
ci_0044                -1.604352e-02 3 1  ON 43
ci_0045                 1.513139e-02 3 1  ON 44
ci_0046                 1.588380e-02 3 1  ON 45
ci_0047                -1.469343e-02 3 1  ON 46
ci_0048                -1.412004e-02 3 1  ON 47
ci_0049                -1.248193e-02 3 1  ON 48
ci_0050                -1.255693e-02 3 1  ON 49
ci_0051                -1.313002e-02 3 1  ON 50
ci_0052                -1.235176e-02 3 1  ON 51
ci_0053                -1.345174e-02 3 1  ON 52
ci_0054                -1.219892e-02 3 1  ON 53
ci_0055                 1.361282e-02 3 1  ON 54
ci_0056                 1.349113e-02 3 1  ON 55
ci_0057                 1.392022e-02 3 1  ON 56
ci_0058                 1.286784e-02 3 1  ON 57
ci_0059                -1.369944e-02 3 1  ON 58
ci_0060                -1.216062e-02 3 1  ON 59
ci_0061                -1.296254e-02 3 1  ON 60
ci_0062                -1.245775e-02 3 1  ON 61
ci_0063                -1.176228e-02 3 1  ON 62
ci_0064                -1.102135e-02 3 1  ON 63
ci_0065                -1.123715e-02 3 1  ON 64
ci_0066                -1.124230e-02 3 1  ON 65
ci_0067                -1.173040e-02 3 1  ON 66
ci_0068                -1.039512e-02 3 1  ON 67
ci_0069                 1.144911e-02 3 1  ON 68
ci_0070                 1.000232e-02 3 1  ON 69
ci_0071                 9.895529e-03 3 1  ON 70
ci_0072                 1.032936e-02 3 1  ON 71
ci_0073                 1.134680e-02 3 1  ON 72
ci_0074                 1.067671e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0289e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6738e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.6489
    reference variance = 2.3607
====================================================
  Execution time = 1.3009e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0261e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5338e+00
  Total weights = 1.945655395e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1648e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564007189379
                                         uncertainty =       0.035632886688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564007189379
                                         uncertainty =       0.035632886688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132134265
  error estimate for blocks of size 2^( 2) =       0.001170483999
  error estimate for blocks of size 2^( 3) =       0.001201841181
  error estimate for blocks of size 2^( 4) =       0.001224856673
  error estimate for blocks of size 2^( 5) =       0.001238527148
  error estimate for blocks of size 2^( 6) =       0.001245340971
  error estimate for blocks of size 2^( 7) =       0.001246645538

      target function =                  N/A
              le_mean =     -16.717988450596
             les_mean =     282.024956488730
             stat err =       0.001238842582
             autocorr =       1.197392076146
              std dev =       1.601105249261
             le_variance =       2.563538019210


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671798845060e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717988449664       residual = 5.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718028072631       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718037243181       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718036843377       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718037138847       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-01 is 1.472904e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717988449664       residual = 5.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718004118296       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718007662825       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718007563006       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 5.486520e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717988449664       residual = 5.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717993033502       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717994092890       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717994081127       residual = 2.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 1.565719e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143124 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6184e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.067317e-01 3 1  ON 0
ci_0002                 6.799330e-01 3 1  ON 1
ci_0003                -4.799618e-02 3 1  ON 2
ci_0004                -4.677932e-02 3 1  ON 3
ci_0005                -4.610921e-02 3 1  ON 4
ci_0006                -4.350549e-02 3 1  ON 5
ci_0007                -3.127495e-02 3 1  ON 6
ci_0008                -3.125197e-02 3 1  ON 7
ci_0009                -3.240838e-02 3 1  ON 8
ci_0010                -3.062213e-02 3 1  ON 9
ci_0011                -2.682257e-02 3 1  ON 10
ci_0012                -2.567572e-02 3 1  ON 11
ci_0013                 2.734779e-02 3 1  ON 12
ci_0014                 2.699769e-02 3 1  ON 13
ci_0015                 2.747011e-02 3 1  ON 14
ci_0016                 2.621392e-02 3 1  ON 15
ci_0017                 2.470254e-02 3 1  ON 16
ci_0018                 2.313226e-02 3 1  ON 17
ci_0019                 2.061343e-02 3 1  ON 18
ci_0020                 1.925838e-02 3 1  ON 19
ci_0021                 1.842579e-02 3 1  ON 20
ci_0022                 1.847669e-02 3 1  ON 21
ci_0023                -2.003357e-02 3 1  ON 22
ci_0024                -1.836811e-02 3 1  ON 23
ci_0025                -1.836752e-02 3 1  ON 24
ci_0026                -1.783347e-02 3 1  ON 25
ci_0027                -1.790760e-02 3 1  ON 26
ci_0028                -1.740617e-02 3 1  ON 27
ci_0029                -1.478393e-02 3 1  ON 28
ci_0030                -1.623518e-02 3 1  ON 29
ci_0031                 1.550644e-02 3 1  ON 30
ci_0032                 1.442762e-02 3 1  ON 31
ci_0033                 1.680040e-02 3 1  ON 32
ci_0034                 1.564798e-02 3 1  ON 33
ci_0035                 1.709683e-02 3 1  ON 34
ci_0036                 1.740646e-02 3 1  ON 35
ci_0037                -1.531436e-02 3 1  ON 36
ci_0038                -1.393478e-02 3 1  ON 37
ci_0039                -1.568570e-02 3 1  ON 38
ci_0040                -1.514557e-02 3 1  ON 39
ci_0041                 1.631388e-02 3 1  ON 40
ci_0042                 1.568133e-02 3 1  ON 41
ci_0043                -1.462912e-02 3 1  ON 42
ci_0044                -1.564302e-02 3 1  ON 43
ci_0045                 1.495549e-02 3 1  ON 44
ci_0046                 1.569337e-02 3 1  ON 45
ci_0047                -1.466074e-02 3 1  ON 46
ci_0048                -1.405688e-02 3 1  ON 47
ci_0049                -1.270046e-02 3 1  ON 48
ci_0050                -1.307777e-02 3 1  ON 49
ci_0051                -1.292104e-02 3 1  ON 50
ci_0052                -1.257328e-02 3 1  ON 51
ci_0053                -1.336394e-02 3 1  ON 52
ci_0054                -1.234131e-02 3 1  ON 53
ci_0055                 1.306417e-02 3 1  ON 54
ci_0056                 1.330112e-02 3 1  ON 55
ci_0057                 1.371698e-02 3 1  ON 56
ci_0058                 1.279208e-02 3 1  ON 57
ci_0059                -1.382213e-02 3 1  ON 58
ci_0060                -1.228394e-02 3 1  ON 59
ci_0061                -1.298393e-02 3 1  ON 60
ci_0062                -1.253310e-02 3 1  ON 61
ci_0063                -1.184915e-02 3 1  ON 62
ci_0064                -1.140483e-02 3 1  ON 63
ci_0065                -1.114983e-02 3 1  ON 64
ci_0066                -1.116166e-02 3 1  ON 65
ci_0067                -1.152641e-02 3 1  ON 66
ci_0068                -1.061387e-02 3 1  ON 67
ci_0069                 1.120316e-02 3 1  ON 68
ci_0070                 1.017747e-02 3 1  ON 69
ci_0071                 9.954101e-03 3 1  ON 70
ci_0072                 1.028494e-02 3 1  ON 71
ci_0073                 1.131247e-02 3 1  ON 72
ci_0074                 1.089773e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8044
    reference variance = 1.74841
====================================================
  Execution time = 1.2724e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5331e+00
  Total weights = 1.9458e+06
  Execution time = 2.2514e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560708827801
                                         uncertainty =       0.028401980870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560708827801
                                         uncertainty =       0.028401980870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131532118
  error estimate for blocks of size 2^( 2) =       0.001169132504
  error estimate for blocks of size 2^( 3) =       0.001202172642
  error estimate for blocks of size 2^( 4) =       0.001225960881
  error estimate for blocks of size 2^( 5) =       0.001239379992
  error estimate for blocks of size 2^( 6) =       0.001246065402
  error estimate for blocks of size 2^( 7) =       0.001251512183

      target function =                  N/A
              le_mean =     -16.717161359310
             les_mean =     282.002213790447
             stat err =       0.001240729615
             autocorr =       1.202321256477
              std dev =       1.600253671058
             le_variance =       2.560811811735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561332994459
                                         uncertainty =       0.028406823600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561332994459
                                         uncertainty =       0.028406823600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131671592
  error estimate for blocks of size 2^( 2) =       0.001169284220
  error estimate for blocks of size 2^( 3) =       0.001202336888
  error estimate for blocks of size 2^( 4) =       0.001226108150
  error estimate for blocks of size 2^( 5) =       0.001239519592
  error estimate for blocks of size 2^( 6) =       0.001246199075
  error estimate for blocks of size 2^( 7) =       0.001251676466

      target function =                  N/A
              le_mean =     -16.717152547829
             les_mean =     282.037878543805
             stat err =       0.001240875820
             autocorr =       1.202308218388
              std dev =       1.600450920532
             le_variance =       2.561443149033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561082656333
                                         uncertainty =       0.028410736478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561082656333
                                         uncertainty =       0.028410736478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131615980
  error estimate for blocks of size 2^( 2) =       0.001169229230
  error estimate for blocks of size 2^( 3) =       0.001202275725
  error estimate for blocks of size 2^( 4) =       0.001226054230
  error estimate for blocks of size 2^( 5) =       0.001239468857
  error estimate for blocks of size 2^( 6) =       0.001246156494
  error estimate for blocks of size 2^( 7) =       0.001251575750

      target function =                  N/A
              le_mean =     -16.717153398998
             les_mean =     281.997855063987
             stat err =       0.001240813833
             autocorr =       1.202306263139
              std dev =       1.600372271459
             le_variance =       2.561191407256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560739796862
                                         uncertainty =       0.028403312171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560739796862
                                         uncertainty =       0.028403312171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131539139
  error estimate for blocks of size 2^( 2) =       0.001169141362
  error estimate for blocks of size 2^( 3) =       0.001202180871
  error estimate for blocks of size 2^( 4) =       0.001225967710
  error estimate for blocks of size 2^( 5) =       0.001239384745
  error estimate for blocks of size 2^( 6) =       0.001246066559
  error estimate for blocks of size 2^( 7) =       0.001251502582

      target function =                  N/A
              le_mean =     -16.717157459900
             les_mean =     282.010564926226
             stat err =       0.001240730399
             autocorr =       1.202307856408
              std dev =       1.600263600565
             le_variance =       2.560843591294


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717161359310        initial  <--
     2.4414e-01     2.4414e+00             1.4729e-03       -16.717152547829
     9.7656e-01     9.7656e+00             5.4865e-04       -16.717153398998
     3.9062e+00     3.9062e+01             1.5657e-04       -16.717157459900

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1066
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.066938e-01 3 1  ON 0
ci_0002                 6.799299e-01 3 1  ON 1
ci_0003                -4.810835e-02 3 1  ON 2
ci_0004                -4.644844e-02 3 1  ON 3
ci_0005                -4.623592e-02 3 1  ON 4
ci_0006                -4.353306e-02 3 1  ON 5
ci_0007                -3.117185e-02 3 1  ON 6
ci_0008                -3.131576e-02 3 1  ON 7
ci_0009                -3.232794e-02 3 1  ON 8
ci_0010                -3.055777e-02 3 1  ON 9
ci_0011                -2.686004e-02 3 1  ON 10
ci_0012                -2.560055e-02 3 1  ON 11
ci_0013                 2.738111e-02 3 1  ON 12
ci_0014                 2.712362e-02 3 1  ON 13
ci_0015                 2.758693e-02 3 1  ON 14
ci_0016                 2.635311e-02 3 1  ON 15
ci_0017                 2.494319e-02 3 1  ON 16
ci_0018                 2.321437e-02 3 1  ON 17
ci_0019                 2.065869e-02 3 1  ON 18
ci_0020                 1.930225e-02 3 1  ON 19
ci_0021                 1.842141e-02 3 1  ON 20
ci_0022                 1.857039e-02 3 1  ON 21
ci_0023                -2.021564e-02 3 1  ON 22
ci_0024                -1.837920e-02 3 1  ON 23
ci_0025                -1.867794e-02 3 1  ON 24
ci_0026                -1.781160e-02 3 1  ON 25
ci_0027                -1.781032e-02 3 1  ON 26
ci_0028                -1.750015e-02 3 1  ON 27
ci_0029                -1.473004e-02 3 1  ON 28
ci_0030                -1.640273e-02 3 1  ON 29
ci_0031                 1.530398e-02 3 1  ON 30
ci_0032                 1.455564e-02 3 1  ON 31
ci_0033                 1.663658e-02 3 1  ON 32
ci_0034                 1.579483e-02 3 1  ON 33
ci_0035                 1.690441e-02 3 1  ON 34
ci_0036                 1.725564e-02 3 1  ON 35
ci_0037                -1.552299e-02 3 1  ON 36
ci_0038                -1.393392e-02 3 1  ON 37
ci_0039                -1.574394e-02 3 1  ON 38
ci_0040                -1.521298e-02 3 1  ON 39
ci_0041                 1.632066e-02 3 1  ON 40
ci_0042                 1.554470e-02 3 1  ON 41
ci_0043                -1.464859e-02 3 1  ON 42
ci_0044                -1.604352e-02 3 1  ON 43
ci_0045                 1.513139e-02 3 1  ON 44
ci_0046                 1.588380e-02 3 1  ON 45
ci_0047                -1.469343e-02 3 1  ON 46
ci_0048                -1.412004e-02 3 1  ON 47
ci_0049                -1.248193e-02 3 1  ON 48
ci_0050                -1.255693e-02 3 1  ON 49
ci_0051                -1.313002e-02 3 1  ON 50
ci_0052                -1.235176e-02 3 1  ON 51
ci_0053                -1.345174e-02 3 1  ON 52
ci_0054                -1.219892e-02 3 1  ON 53
ci_0055                 1.361282e-02 3 1  ON 54
ci_0056                 1.349113e-02 3 1  ON 55
ci_0057                 1.392022e-02 3 1  ON 56
ci_0058                 1.286784e-02 3 1  ON 57
ci_0059                -1.369944e-02 3 1  ON 58
ci_0060                -1.216062e-02 3 1  ON 59
ci_0061                -1.296254e-02 3 1  ON 60
ci_0062                -1.245775e-02 3 1  ON 61
ci_0063                -1.176228e-02 3 1  ON 62
ci_0064                -1.102135e-02 3 1  ON 63
ci_0065                -1.123715e-02 3 1  ON 64
ci_0066                -1.124230e-02 3 1  ON 65
ci_0067                -1.173040e-02 3 1  ON 66
ci_0068                -1.039512e-02 3 1  ON 67
ci_0069                 1.144911e-02 3 1  ON 68
ci_0070                 1.000232e-02 3 1  ON 69
ci_0071                 9.895529e-03 3 1  ON 70
ci_0072                 1.032936e-02 3 1  ON 71
ci_0073                 1.134680e-02 3 1  ON 72
ci_0074                 1.067671e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0309e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6737e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.907
    reference variance = 1.54483
====================================================
  Execution time = 1.5312e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0256e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5892e+00
  Total weights = 1.945695942e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1812e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621887998055
                                         uncertainty =       0.067338354061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621887998055
                                         uncertainty =       0.067338354061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144795397
  error estimate for blocks of size 2^( 2) =       0.001183797129
  error estimate for blocks of size 2^( 3) =       0.001217286581
  error estimate for blocks of size 2^( 4) =       0.001238504005
  error estimate for blocks of size 2^( 5) =       0.001252815093
  error estimate for blocks of size 2^( 6) =       0.001262016860
  error estimate for blocks of size 2^( 7) =       0.001269917885

      target function =                  N/A
              le_mean =     -16.719889785954
             les_mean =     282.143897242856
             stat err =       0.001255813461
             autocorr =       1.203357083833
              std dev =       1.619011079749
             le_variance =       2.621196876351


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671988978595e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719889785021       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719895801977       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719895783283       residual = 8.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.452187e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719889785021       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719891393769       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719891394762       residual = 2.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 3.985002e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719889785021       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719890194317       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719890195042       residual = 1.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+01 is 1.021067e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8500e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.067057e-01 3 1  ON 0
ci_0002                 6.799178e-01 3 1  ON 1
ci_0003                -4.810640e-02 3 1  ON 2
ci_0004                -4.646037e-02 3 1  ON 3
ci_0005                -4.624189e-02 3 1  ON 4
ci_0006                -4.355299e-02 3 1  ON 5
ci_0007                -3.116186e-02 3 1  ON 6
ci_0008                -3.131713e-02 3 1  ON 7
ci_0009                -3.234022e-02 3 1  ON 8
ci_0010                -3.056457e-02 3 1  ON 9
ci_0011                -2.684197e-02 3 1  ON 10
ci_0012                -2.562371e-02 3 1  ON 11
ci_0013                 2.738822e-02 3 1  ON 12
ci_0014                 2.712296e-02 3 1  ON 13
ci_0015                 2.756907e-02 3 1  ON 14
ci_0016                 2.636373e-02 3 1  ON 15
ci_0017                 2.492729e-02 3 1  ON 16
ci_0018                 2.320663e-02 3 1  ON 17
ci_0019                 2.065844e-02 3 1  ON 18
ci_0020                 1.931759e-02 3 1  ON 19
ci_0021                 1.840908e-02 3 1  ON 20
ci_0022                 1.856055e-02 3 1  ON 21
ci_0023                -2.019182e-02 3 1  ON 22
ci_0024                -1.837594e-02 3 1  ON 23
ci_0025                -1.866922e-02 3 1  ON 24
ci_0026                -1.781544e-02 3 1  ON 25
ci_0027                -1.778318e-02 3 1  ON 26
ci_0028                -1.747405e-02 3 1  ON 27
ci_0029                -1.473861e-02 3 1  ON 28
ci_0030                -1.638787e-02 3 1  ON 29
ci_0031                 1.531307e-02 3 1  ON 30
ci_0032                 1.453654e-02 3 1  ON 31
ci_0033                 1.664009e-02 3 1  ON 32
ci_0034                 1.581509e-02 3 1  ON 33
ci_0035                 1.693227e-02 3 1  ON 34
ci_0036                 1.724899e-02 3 1  ON 35
ci_0037                -1.554910e-02 3 1  ON 36
ci_0038                -1.395705e-02 3 1  ON 37
ci_0039                -1.575040e-02 3 1  ON 38
ci_0040                -1.520347e-02 3 1  ON 39
ci_0041                 1.630712e-02 3 1  ON 40
ci_0042                 1.555283e-02 3 1  ON 41
ci_0043                -1.465427e-02 3 1  ON 42
ci_0044                -1.603999e-02 3 1  ON 43
ci_0045                 1.513704e-02 3 1  ON 44
ci_0046                 1.584933e-02 3 1  ON 45
ci_0047                -1.470046e-02 3 1  ON 46
ci_0048                -1.413430e-02 3 1  ON 47
ci_0049                -1.249289e-02 3 1  ON 48
ci_0050                -1.258745e-02 3 1  ON 49
ci_0051                -1.313181e-02 3 1  ON 50
ci_0052                -1.236608e-02 3 1  ON 51
ci_0053                -1.341189e-02 3 1  ON 52
ci_0054                -1.221271e-02 3 1  ON 53
ci_0055                 1.360649e-02 3 1  ON 54
ci_0056                 1.346883e-02 3 1  ON 55
ci_0057                 1.389878e-02 3 1  ON 56
ci_0058                 1.286716e-02 3 1  ON 57
ci_0059                -1.368347e-02 3 1  ON 58
ci_0060                -1.218529e-02 3 1  ON 59
ci_0061                -1.294969e-02 3 1  ON 60
ci_0062                -1.245326e-02 3 1  ON 61
ci_0063                -1.176665e-02 3 1  ON 62
ci_0064                -1.100159e-02 3 1  ON 63
ci_0065                -1.126455e-02 3 1  ON 64
ci_0066                -1.124137e-02 3 1  ON 65
ci_0067                -1.173543e-02 3 1  ON 66
ci_0068                -1.040080e-02 3 1  ON 67
ci_0069                 1.143374e-02 3 1  ON 68
ci_0070                 9.995162e-03 3 1  ON 69
ci_0071                 9.889319e-03 3 1  ON 70
ci_0072                 1.031887e-02 3 1  ON 71
ci_0073                 1.132936e-02 3 1  ON 72
ci_0074                 1.067687e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.7235
    reference variance = 1.79882
====================================================
  Execution time = 1.2689e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.6293e+00
  Total weights = 1.9460e+06
  Execution time = 2.2585e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.661552376094
                                         uncertainty =       0.131388627234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.661552376094
                                         uncertainty =       0.131388627234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001153335042
  error estimate for blocks of size 2^( 2) =       0.001192211252
  error estimate for blocks of size 2^( 3) =       0.001224013749
  error estimate for blocks of size 2^( 4) =       0.001246820150
  error estimate for blocks of size 2^( 5) =       0.001259393521
  error estimate for blocks of size 2^( 6) =       0.001266915800
  error estimate for blocks of size 2^( 7) =       0.001269415754

      target function =                  N/A
              le_mean =     -16.715616777857
             les_mean =     282.041144171602
             stat err =       0.001260636306
             autocorr =       1.194726910821
              std dev =       1.631088155304
             le_variance =       2.660448570372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.661495778926
                                         uncertainty =       0.131388699644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.661495778926
                                         uncertainty =       0.131388699644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001153322800
  error estimate for blocks of size 2^( 2) =       0.001192198101
  error estimate for blocks of size 2^( 3) =       0.001224002395
  error estimate for blocks of size 2^( 4) =       0.001246808679
  error estimate for blocks of size 2^( 5) =       0.001259378648
  error estimate for blocks of size 2^( 6) =       0.001266903961
  error estimate for blocks of size 2^( 7) =       0.001269405524

      target function =                  N/A
              le_mean =     -16.715613099812
             les_mean =     282.040967520978
             stat err =       0.001260624203
             autocorr =       1.194729333196
              std dev =       1.631070841943
             le_variance =       2.660392091436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.661520496213
                                         uncertainty =       0.131388653974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.661520496213
                                         uncertainty =       0.131388653974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001153328146
  error estimate for blocks of size 2^( 2) =       0.001192203918
  error estimate for blocks of size 2^( 3) =       0.001224007394
  error estimate for blocks of size 2^( 4) =       0.001246813783
  error estimate for blocks of size 2^( 5) =       0.001259385259
  error estimate for blocks of size 2^( 6) =       0.001266909183
  error estimate for blocks of size 2^( 7) =       0.001269410109

      target function =                  N/A
              le_mean =     -16.715614696645
             les_mean =     282.041013747519
             stat err =       0.001260629584
             autocorr =       1.194728455578
              std dev =       1.631078402744
             le_variance =       2.660416755898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.661548164144
                                         uncertainty =       0.131388629861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.661548164144
                                         uncertainty =       0.131388629861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001153334131
  error estimate for blocks of size 2^( 2) =       0.001192210287
  error estimate for blocks of size 2^( 3) =       0.001224012910
  error estimate for blocks of size 2^( 4) =       0.001246819311
  error estimate for blocks of size 2^( 5) =       0.001259392441
  error estimate for blocks of size 2^( 6) =       0.001266914926
  error estimate for blocks of size 2^( 7) =       0.001269415007

      target function =                  N/A
              le_mean =     -16.715616494877
             les_mean =     282.041122241045
             stat err =       0.001260635421
             autocorr =       1.194727121222
              std dev =       1.631086866750
             le_variance =       2.660444366884


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.715616777857        initial  <--
     2.4414e+00     2.4414e+01             1.4522e-04       -16.715613099812
     9.7656e+00     9.7656e+01             3.9850e-05       -16.715614696645
     3.9062e+01     3.9062e+02             1.0211e-05       -16.715616494877

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0876
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.066938e-01 3 1  ON 0
ci_0002                 6.799299e-01 3 1  ON 1
ci_0003                -4.810835e-02 3 1  ON 2
ci_0004                -4.644844e-02 3 1  ON 3
ci_0005                -4.623592e-02 3 1  ON 4
ci_0006                -4.353306e-02 3 1  ON 5
ci_0007                -3.117185e-02 3 1  ON 6
ci_0008                -3.131576e-02 3 1  ON 7
ci_0009                -3.232794e-02 3 1  ON 8
ci_0010                -3.055777e-02 3 1  ON 9
ci_0011                -2.686004e-02 3 1  ON 10
ci_0012                -2.560055e-02 3 1  ON 11
ci_0013                 2.738111e-02 3 1  ON 12
ci_0014                 2.712362e-02 3 1  ON 13
ci_0015                 2.758693e-02 3 1  ON 14
ci_0016                 2.635311e-02 3 1  ON 15
ci_0017                 2.494319e-02 3 1  ON 16
ci_0018                 2.321437e-02 3 1  ON 17
ci_0019                 2.065869e-02 3 1  ON 18
ci_0020                 1.930225e-02 3 1  ON 19
ci_0021                 1.842141e-02 3 1  ON 20
ci_0022                 1.857039e-02 3 1  ON 21
ci_0023                -2.021564e-02 3 1  ON 22
ci_0024                -1.837920e-02 3 1  ON 23
ci_0025                -1.867794e-02 3 1  ON 24
ci_0026                -1.781160e-02 3 1  ON 25
ci_0027                -1.781032e-02 3 1  ON 26
ci_0028                -1.750015e-02 3 1  ON 27
ci_0029                -1.473004e-02 3 1  ON 28
ci_0030                -1.640273e-02 3 1  ON 29
ci_0031                 1.530398e-02 3 1  ON 30
ci_0032                 1.455564e-02 3 1  ON 31
ci_0033                 1.663658e-02 3 1  ON 32
ci_0034                 1.579483e-02 3 1  ON 33
ci_0035                 1.690441e-02 3 1  ON 34
ci_0036                 1.725564e-02 3 1  ON 35
ci_0037                -1.552299e-02 3 1  ON 36
ci_0038                -1.393392e-02 3 1  ON 37
ci_0039                -1.574394e-02 3 1  ON 38
ci_0040                -1.521298e-02 3 1  ON 39
ci_0041                 1.632066e-02 3 1  ON 40
ci_0042                 1.554470e-02 3 1  ON 41
ci_0043                -1.464859e-02 3 1  ON 42
ci_0044                -1.604352e-02 3 1  ON 43
ci_0045                 1.513139e-02 3 1  ON 44
ci_0046                 1.588380e-02 3 1  ON 45
ci_0047                -1.469343e-02 3 1  ON 46
ci_0048                -1.412004e-02 3 1  ON 47
ci_0049                -1.248193e-02 3 1  ON 48
ci_0050                -1.255693e-02 3 1  ON 49
ci_0051                -1.313002e-02 3 1  ON 50
ci_0052                -1.235176e-02 3 1  ON 51
ci_0053                -1.345174e-02 3 1  ON 52
ci_0054                -1.219892e-02 3 1  ON 53
ci_0055                 1.361282e-02 3 1  ON 54
ci_0056                 1.349113e-02 3 1  ON 55
ci_0057                 1.392022e-02 3 1  ON 56
ci_0058                 1.286784e-02 3 1  ON 57
ci_0059                -1.369944e-02 3 1  ON 58
ci_0060                -1.216062e-02 3 1  ON 59
ci_0061                -1.296254e-02 3 1  ON 60
ci_0062                -1.245775e-02 3 1  ON 61
ci_0063                -1.176228e-02 3 1  ON 62
ci_0064                -1.102135e-02 3 1  ON 63
ci_0065                -1.123715e-02 3 1  ON 64
ci_0066                -1.124230e-02 3 1  ON 65
ci_0067                -1.173040e-02 3 1  ON 66
ci_0068                -1.039512e-02 3 1  ON 67
ci_0069                 1.144911e-02 3 1  ON 68
ci_0070                 1.000232e-02 3 1  ON 69
ci_0071                 9.895529e-03 3 1  ON 70
ci_0072                 1.032936e-02 3 1  ON 71
ci_0073                 1.134680e-02 3 1  ON 72
ci_0074                 1.067671e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2593e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6742e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.6838
    reference variance = 1.4003
====================================================
  Execution time = 1.2984e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0260e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5271e+00
  Total weights = 1.945196635e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1688e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.557983993552
                                         uncertainty =       0.028271566348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.557983993552
                                         uncertainty =       0.028271566348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130981658
  error estimate for blocks of size 2^( 2) =       0.001169382522
  error estimate for blocks of size 2^( 3) =       0.001201000392
  error estimate for blocks of size 2^( 4) =       0.001224436880
  error estimate for blocks of size 2^( 5) =       0.001240016168
  error estimate for blocks of size 2^( 6) =       0.001247093514
  error estimate for blocks of size 2^( 7) =       0.001255309178

      target function =                  N/A
              le_mean =     -16.718956227981
             les_mean =     282.050646925660
             stat err =       0.001241713935
             autocorr =       1.205402220168
              std dev =       1.599475189892
             le_variance =       2.558320883079


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671895622798e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718956227091       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718957109991       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718957110324       residual = 2.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+01 is 1.907635e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718956227091       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718956449288       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718956449287       residual = 2.46e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+01 is 4.792483e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718956227091       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718956282733       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718956282727       residual = 2.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+02 is 1.199594e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145464 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6160e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.066975e-01 3 1  ON 0
ci_0002                 6.799265e-01 3 1  ON 1
ci_0003                -4.810990e-02 3 1  ON 2
ci_0004                -4.644665e-02 3 1  ON 3
ci_0005                -4.623488e-02 3 1  ON 4
ci_0006                -4.353225e-02 3 1  ON 5
ci_0007                -3.117098e-02 3 1  ON 6
ci_0008                -3.131671e-02 3 1  ON 7
ci_0009                -3.232462e-02 3 1  ON 8
ci_0010                -3.055843e-02 3 1  ON 9
ci_0011                -2.686238e-02 3 1  ON 10
ci_0012                -2.560365e-02 3 1  ON 11
ci_0013                 2.738099e-02 3 1  ON 12
ci_0014                 2.712138e-02 3 1  ON 13
ci_0015                 2.758653e-02 3 1  ON 14
ci_0016                 2.635233e-02 3 1  ON 15
ci_0017                 2.494167e-02 3 1  ON 16
ci_0018                 2.321569e-02 3 1  ON 17
ci_0019                 2.065609e-02 3 1  ON 18
ci_0020                 1.930078e-02 3 1  ON 19
ci_0021                 1.841979e-02 3 1  ON 20
ci_0022                 1.857098e-02 3 1  ON 21
ci_0023                -2.021136e-02 3 1  ON 22
ci_0024                -1.838150e-02 3 1  ON 23
ci_0025                -1.867856e-02 3 1  ON 24
ci_0026                -1.780946e-02 3 1  ON 25
ci_0027                -1.781107e-02 3 1  ON 26
ci_0028                -1.749732e-02 3 1  ON 27
ci_0029                -1.473097e-02 3 1  ON 28
ci_0030                -1.640160e-02 3 1  ON 29
ci_0031                 1.530410e-02 3 1  ON 30
ci_0032                 1.455634e-02 3 1  ON 31
ci_0033                 1.663670e-02 3 1  ON 32
ci_0034                 1.579739e-02 3 1  ON 33
ci_0035                 1.690398e-02 3 1  ON 34
ci_0036                 1.725729e-02 3 1  ON 35
ci_0037                -1.552157e-02 3 1  ON 36
ci_0038                -1.393449e-02 3 1  ON 37
ci_0039                -1.574451e-02 3 1  ON 38
ci_0040                -1.521458e-02 3 1  ON 39
ci_0041                 1.631953e-02 3 1  ON 40
ci_0042                 1.554416e-02 3 1  ON 41
ci_0043                -1.465113e-02 3 1  ON 42
ci_0044                -1.604158e-02 3 1  ON 43
ci_0045                 1.513009e-02 3 1  ON 44
ci_0046                 1.588137e-02 3 1  ON 45
ci_0047                -1.469444e-02 3 1  ON 46
ci_0048                -1.412110e-02 3 1  ON 47
ci_0049                -1.248281e-02 3 1  ON 48
ci_0050                -1.255822e-02 3 1  ON 49
ci_0051                -1.313068e-02 3 1  ON 50
ci_0052                -1.235357e-02 3 1  ON 51
ci_0053                -1.344881e-02 3 1  ON 52
ci_0054                -1.219793e-02 3 1  ON 53
ci_0055                 1.360803e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391760e-02 3 1  ON 56
ci_0058                 1.286625e-02 3 1  ON 57
ci_0059                -1.370261e-02 3 1  ON 58
ci_0060                -1.216261e-02 3 1  ON 59
ci_0061                -1.296163e-02 3 1  ON 60
ci_0062                -1.245770e-02 3 1  ON 61
ci_0063                -1.176338e-02 3 1  ON 62
ci_0064                -1.102287e-02 3 1  ON 63
ci_0065                -1.124009e-02 3 1  ON 64
ci_0066                -1.124445e-02 3 1  ON 65
ci_0067                -1.172880e-02 3 1  ON 66
ci_0068                -1.039646e-02 3 1  ON 67
ci_0069                 1.144822e-02 3 1  ON 68
ci_0070                 1.000508e-02 3 1  ON 69
ci_0071                 9.897292e-03 3 1  ON 70
ci_0072                 1.032889e-02 3 1  ON 71
ci_0073                 1.134375e-02 3 1  ON 72
ci_0074                 1.067671e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8437
    reference variance = 1.13398
====================================================
  Execution time = 1.2763e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5972e+00
  Total weights = 1.9454e+06
  Execution time = 2.2503e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.625688340052
                                         uncertainty =       0.047079510076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.625688340052
                                         uncertainty =       0.047079510076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001145633212
  error estimate for blocks of size 2^( 2) =       0.001184654729
  error estimate for blocks of size 2^( 3) =       0.001216181914
  error estimate for blocks of size 2^( 4) =       0.001237034853
  error estimate for blocks of size 2^( 5) =       0.001250992983
  error estimate for blocks of size 2^( 6) =       0.001258117792
  error estimate for blocks of size 2^( 7) =       0.001258444055

      target function =                  N/A
              le_mean =     -16.716160834314
             les_mean =     282.027281943842
             stat err =       0.001251147421
             autocorr =       1.192685060088
              std dev =       1.620195948676
             le_variance =       2.625034912106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.625684409245
                                         uncertainty =       0.047079441113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.625684409245
                                         uncertainty =       0.047079441113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001145632352
  error estimate for blocks of size 2^( 2) =       0.001184653788
  error estimate for blocks of size 2^( 3) =       0.001216180818
  error estimate for blocks of size 2^( 4) =       0.001237033533
  error estimate for blocks of size 2^( 5) =       0.001250992569
  error estimate for blocks of size 2^( 6) =       0.001258115958
  error estimate for blocks of size 2^( 7) =       0.001258442969

      target function =                  N/A
              le_mean =     -16.716160833040
             les_mean =     282.027274049506
             stat err =       0.001251146257
             autocorr =       1.192684631818
              std dev =       1.620194732423
             le_variance =       2.625030970971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.625686350423
                                         uncertainty =       0.047079475196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.625686350423
                                         uncertainty =       0.047079475196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001145632777
  error estimate for blocks of size 2^( 2) =       0.001184654253
  error estimate for blocks of size 2^( 3) =       0.001216181359
  error estimate for blocks of size 2^( 4) =       0.001237034184
  error estimate for blocks of size 2^( 5) =       0.001250992770
  error estimate for blocks of size 2^( 6) =       0.001258116863
  error estimate for blocks of size 2^( 7) =       0.001258443500

      target function =                  N/A
              le_mean =     -16.716160831797
             les_mean =     282.027276979140
             stat err =       0.001251146830
             autocorr =       1.192684838776
              std dev =       1.620195333053
             le_variance =       2.625032917248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.625688089102
                                         uncertainty =       0.047079505702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.625688089102
                                         uncertainty =       0.047079505702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001145633157
  error estimate for blocks of size 2^( 2) =       0.001184654669
  error estimate for blocks of size 2^( 3) =       0.001216181844
  error estimate for blocks of size 2^( 4) =       0.001237034769
  error estimate for blocks of size 2^( 5) =       0.001250992956
  error estimate for blocks of size 2^( 6) =       0.001258117675
  error estimate for blocks of size 2^( 7) =       0.001258443985

      target function =                  N/A
              le_mean =     -16.716160833774
             les_mean =     282.027281202020
             stat err =       0.001251147346
             autocorr =       1.192685032184
              std dev =       1.620195871030
             le_variance =       2.625034660502


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716160834314        initial  <--
     2.4414e+01     2.4414e+02             1.9076e-05       -16.716160833040
     9.7656e+01     9.7656e+02             4.7925e-06       -16.716160831797
     3.9062e+02     3.9062e+03             1.1996e-06       -16.716160833774

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1177
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.066938e-01 3 1  ON 0
ci_0002                 6.799299e-01 3 1  ON 1
ci_0003                -4.810835e-02 3 1  ON 2
ci_0004                -4.644844e-02 3 1  ON 3
ci_0005                -4.623592e-02 3 1  ON 4
ci_0006                -4.353306e-02 3 1  ON 5
ci_0007                -3.117185e-02 3 1  ON 6
ci_0008                -3.131576e-02 3 1  ON 7
ci_0009                -3.232794e-02 3 1  ON 8
ci_0010                -3.055777e-02 3 1  ON 9
ci_0011                -2.686004e-02 3 1  ON 10
ci_0012                -2.560055e-02 3 1  ON 11
ci_0013                 2.738111e-02 3 1  ON 12
ci_0014                 2.712362e-02 3 1  ON 13
ci_0015                 2.758693e-02 3 1  ON 14
ci_0016                 2.635311e-02 3 1  ON 15
ci_0017                 2.494319e-02 3 1  ON 16
ci_0018                 2.321437e-02 3 1  ON 17
ci_0019                 2.065869e-02 3 1  ON 18
ci_0020                 1.930225e-02 3 1  ON 19
ci_0021                 1.842141e-02 3 1  ON 20
ci_0022                 1.857039e-02 3 1  ON 21
ci_0023                -2.021564e-02 3 1  ON 22
ci_0024                -1.837920e-02 3 1  ON 23
ci_0025                -1.867794e-02 3 1  ON 24
ci_0026                -1.781160e-02 3 1  ON 25
ci_0027                -1.781032e-02 3 1  ON 26
ci_0028                -1.750015e-02 3 1  ON 27
ci_0029                -1.473004e-02 3 1  ON 28
ci_0030                -1.640273e-02 3 1  ON 29
ci_0031                 1.530398e-02 3 1  ON 30
ci_0032                 1.455564e-02 3 1  ON 31
ci_0033                 1.663658e-02 3 1  ON 32
ci_0034                 1.579483e-02 3 1  ON 33
ci_0035                 1.690441e-02 3 1  ON 34
ci_0036                 1.725564e-02 3 1  ON 35
ci_0037                -1.552299e-02 3 1  ON 36
ci_0038                -1.393392e-02 3 1  ON 37
ci_0039                -1.574394e-02 3 1  ON 38
ci_0040                -1.521298e-02 3 1  ON 39
ci_0041                 1.632066e-02 3 1  ON 40
ci_0042                 1.554470e-02 3 1  ON 41
ci_0043                -1.464859e-02 3 1  ON 42
ci_0044                -1.604352e-02 3 1  ON 43
ci_0045                 1.513139e-02 3 1  ON 44
ci_0046                 1.588380e-02 3 1  ON 45
ci_0047                -1.469343e-02 3 1  ON 46
ci_0048                -1.412004e-02 3 1  ON 47
ci_0049                -1.248193e-02 3 1  ON 48
ci_0050                -1.255693e-02 3 1  ON 49
ci_0051                -1.313002e-02 3 1  ON 50
ci_0052                -1.235176e-02 3 1  ON 51
ci_0053                -1.345174e-02 3 1  ON 52
ci_0054                -1.219892e-02 3 1  ON 53
ci_0055                 1.361282e-02 3 1  ON 54
ci_0056                 1.349113e-02 3 1  ON 55
ci_0057                 1.392022e-02 3 1  ON 56
ci_0058                 1.286784e-02 3 1  ON 57
ci_0059                -1.369944e-02 3 1  ON 58
ci_0060                -1.216062e-02 3 1  ON 59
ci_0061                -1.296254e-02 3 1  ON 60
ci_0062                -1.245775e-02 3 1  ON 61
ci_0063                -1.176228e-02 3 1  ON 62
ci_0064                -1.102135e-02 3 1  ON 63
ci_0065                -1.123715e-02 3 1  ON 64
ci_0066                -1.124230e-02 3 1  ON 65
ci_0067                -1.173040e-02 3 1  ON 66
ci_0068                -1.039512e-02 3 1  ON 67
ci_0069                 1.144911e-02 3 1  ON 68
ci_0070                 1.000232e-02 3 1  ON 69
ci_0071                 9.895529e-03 3 1  ON 70
ci_0072                 1.032936e-02 3 1  ON 71
ci_0073                 1.134680e-02 3 1  ON 72
ci_0074                 1.067671e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0284e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6743e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.7707
    reference variance = 1.3778
====================================================
  Execution time = 1.2981e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0268e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5571e+00
  Total weights = 1.945842122e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1718e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.584950608342
                                         uncertainty =       0.045561562793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.584950608342
                                         uncertainty =       0.045561562793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136989519
  error estimate for blocks of size 2^( 2) =       0.001175477507
  error estimate for blocks of size 2^( 3) =       0.001208535529
  error estimate for blocks of size 2^( 4) =       0.001232537294
  error estimate for blocks of size 2^( 5) =       0.001246663265
  error estimate for blocks of size 2^( 6) =       0.001252589649
  error estimate for blocks of size 2^( 7) =       0.001252310570

      target function =                  N/A
              le_mean =     -16.719216359095
             les_mean =     282.089262621645
             stat err =       0.001246025195
             autocorr =       1.200993688504
              std dev =       1.607971724928
             le_variance =       2.585573068167


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671921635910e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719216358185       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719216420747       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719216420596       residual = 2.71e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+02 is 1.840984e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719216358185       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719216373837       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719216373798       residual = 2.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+02 is 4.606986e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719216358185       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719216362098       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719216362089       residual = 2.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+03 is 1.152030e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146572 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6161e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.066939e-01 3 1  ON 0
ci_0002                 6.799297e-01 3 1  ON 1
ci_0003                -4.810849e-02 3 1  ON 2
ci_0004                -4.644842e-02 3 1  ON 3
ci_0005                -4.623593e-02 3 1  ON 4
ci_0006                -4.353300e-02 3 1  ON 5
ci_0007                -3.117181e-02 3 1  ON 6
ci_0008                -3.131585e-02 3 1  ON 7
ci_0009                -3.232824e-02 3 1  ON 8
ci_0010                -3.055798e-02 3 1  ON 9
ci_0011                -2.686015e-02 3 1  ON 10
ci_0012                -2.560072e-02 3 1  ON 11
ci_0013                 2.738105e-02 3 1  ON 12
ci_0014                 2.712344e-02 3 1  ON 13
ci_0015                 2.758709e-02 3 1  ON 14
ci_0016                 2.635319e-02 3 1  ON 15
ci_0017                 2.494315e-02 3 1  ON 16
ci_0018                 2.321429e-02 3 1  ON 17
ci_0019                 2.065850e-02 3 1  ON 18
ci_0020                 1.930252e-02 3 1  ON 19
ci_0021                 1.842117e-02 3 1  ON 20
ci_0022                 1.857026e-02 3 1  ON 21
ci_0023                -2.021533e-02 3 1  ON 22
ci_0024                -1.837919e-02 3 1  ON 23
ci_0025                -1.867807e-02 3 1  ON 24
ci_0026                -1.781131e-02 3 1  ON 25
ci_0027                -1.781055e-02 3 1  ON 26
ci_0028                -1.750021e-02 3 1  ON 27
ci_0029                -1.473041e-02 3 1  ON 28
ci_0030                -1.640263e-02 3 1  ON 29
ci_0031                 1.530388e-02 3 1  ON 30
ci_0032                 1.455553e-02 3 1  ON 31
ci_0033                 1.663674e-02 3 1  ON 32
ci_0034                 1.579460e-02 3 1  ON 33
ci_0035                 1.690461e-02 3 1  ON 34
ci_0036                 1.725569e-02 3 1  ON 35
ci_0037                -1.552307e-02 3 1  ON 36
ci_0038                -1.393411e-02 3 1  ON 37
ci_0039                -1.574406e-02 3 1  ON 38
ci_0040                -1.521312e-02 3 1  ON 39
ci_0041                 1.632061e-02 3 1  ON 40
ci_0042                 1.554447e-02 3 1  ON 41
ci_0043                -1.464868e-02 3 1  ON 42
ci_0044                -1.604329e-02 3 1  ON 43
ci_0045                 1.513152e-02 3 1  ON 44
ci_0046                 1.588374e-02 3 1  ON 45
ci_0047                -1.469350e-02 3 1  ON 46
ci_0048                -1.412005e-02 3 1  ON 47
ci_0049                -1.248216e-02 3 1  ON 48
ci_0050                -1.255731e-02 3 1  ON 49
ci_0051                -1.313004e-02 3 1  ON 50
ci_0052                -1.235189e-02 3 1  ON 51
ci_0053                -1.345157e-02 3 1  ON 52
ci_0054                -1.219917e-02 3 1  ON 53
ci_0055                 1.361261e-02 3 1  ON 54
ci_0056                 1.349098e-02 3 1  ON 55
ci_0057                 1.392013e-02 3 1  ON 56
ci_0058                 1.286782e-02 3 1  ON 57
ci_0059                -1.369924e-02 3 1  ON 58
ci_0060                -1.216108e-02 3 1  ON 59
ci_0061                -1.296286e-02 3 1  ON 60
ci_0062                -1.245778e-02 3 1  ON 61
ci_0063                -1.176203e-02 3 1  ON 62
ci_0064                -1.102158e-02 3 1  ON 63
ci_0065                -1.123727e-02 3 1  ON 64
ci_0066                -1.124230e-02 3 1  ON 65
ci_0067                -1.173025e-02 3 1  ON 66
ci_0068                -1.039516e-02 3 1  ON 67
ci_0069                 1.144886e-02 3 1  ON 68
ci_0070                 1.000235e-02 3 1  ON 69
ci_0071                 9.895446e-03 3 1  ON 70
ci_0072                 1.032947e-02 3 1  ON 71
ci_0073                 1.134687e-02 3 1  ON 72
ci_0074                 1.067636e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.6645
    reference variance = 2.18153
====================================================
  Execution time = 1.2729e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5035e+00
  Total weights = 1.9458e+06
  Execution time = 2.2441e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531681011122
                                         uncertainty =       0.022316695109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531681011122
                                         uncertainty =       0.022316695109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125033943
  error estimate for blocks of size 2^( 2) =       0.001163319649
  error estimate for blocks of size 2^( 3) =       0.001195944102
  error estimate for blocks of size 2^( 4) =       0.001219166303
  error estimate for blocks of size 2^( 5) =       0.001234134443
  error estimate for blocks of size 2^( 6) =       0.001243745207
  error estimate for blocks of size 2^( 7) =       0.001252808855

      target function =                  N/A
              le_mean =     -16.717434689313
             les_mean =     281.976122099868
             stat err =       0.001237463702
             autocorr =       1.209856010178
              std dev =       1.591063717156
             le_variance =       2.531483752050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531681508792
                                         uncertainty =       0.022316705160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531681508792
                                         uncertainty =       0.022316705160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125034052
  error estimate for blocks of size 2^( 2) =       0.001163319662
  error estimate for blocks of size 2^( 3) =       0.001195944040
  error estimate for blocks of size 2^( 4) =       0.001219166185
  error estimate for blocks of size 2^( 5) =       0.001234134259
  error estimate for blocks of size 2^( 6) =       0.001243745009
  error estimate for blocks of size 2^( 7) =       0.001252808559

      target function =                  N/A
              le_mean =     -16.717434691093
             les_mean =     281.976121716927
             stat err =       0.001237463503
             autocorr =       1.209855388049
              std dev =       1.591063870421
             le_variance =       2.531484239760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531681259933
                                         uncertainty =       0.022316700136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531681259933
                                         uncertainty =       0.022316700136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125033997
  error estimate for blocks of size 2^( 2) =       0.001163319655
  error estimate for blocks of size 2^( 3) =       0.001195944071
  error estimate for blocks of size 2^( 4) =       0.001219166244
  error estimate for blocks of size 2^( 5) =       0.001234134351
  error estimate for blocks of size 2^( 6) =       0.001243745108
  error estimate for blocks of size 2^( 7) =       0.001252808707

      target function =                  N/A
              le_mean =     -16.717434690184
             les_mean =     281.976121880502
             stat err =       0.001237463602
             autocorr =       1.209855698857
              std dev =       1.591063793779
             le_variance =       2.531483995875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531681042207
                                         uncertainty =       0.022316695738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531681042207
                                         uncertainty =       0.022316695738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125033950
  error estimate for blocks of size 2^( 2) =       0.001163319650
  error estimate for blocks of size 2^( 3) =       0.001195944099
  error estimate for blocks of size 2^( 4) =       0.001219166296
  error estimate for blocks of size 2^( 5) =       0.001234134431
  error estimate for blocks of size 2^( 6) =       0.001243745195
  error estimate for blocks of size 2^( 7) =       0.001252808837

      target function =                  N/A
              le_mean =     -16.717434689420
             les_mean =     281.976122069242
             stat err =       0.001237463690
             autocorr =       1.209855971257
              std dev =       1.591063726729
             le_variance =       2.531483782512


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717434689313        initial
     2.4414e+02     2.4414e+03             1.8410e-06       -16.717434691093  <--
     9.7656e+02     9.7656e+03             4.6070e-07       -16.717434690184
     3.9062e+03     3.9062e+04             1.1520e-07       -16.717434689420

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 2.4052e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.066944e-01 3 1  ON 0
ci_0002                 6.799291e-01 3 1  ON 1
ci_0003                -4.810889e-02 3 1  ON 2
ci_0004                -4.644835e-02 3 1  ON 3
ci_0005                -4.623595e-02 3 1  ON 4
ci_0006                -4.353283e-02 3 1  ON 5
ci_0007                -3.117168e-02 3 1  ON 6
ci_0008                -3.131610e-02 3 1  ON 7
ci_0009                -3.232914e-02 3 1  ON 8
ci_0010                -3.055859e-02 3 1  ON 9
ci_0011                -2.686046e-02 3 1  ON 10
ci_0012                -2.560123e-02 3 1  ON 11
ci_0013                 2.738085e-02 3 1  ON 12
ci_0014                 2.712292e-02 3 1  ON 13
ci_0015                 2.758755e-02 3 1  ON 14
ci_0016                 2.635343e-02 3 1  ON 15
ci_0017                 2.494303e-02 3 1  ON 16
ci_0018                 2.321405e-02 3 1  ON 17
ci_0019                 2.065794e-02 3 1  ON 18
ci_0020                 1.930331e-02 3 1  ON 19
ci_0021                 1.842046e-02 3 1  ON 20
ci_0022                 1.856987e-02 3 1  ON 21
ci_0023                -2.021437e-02 3 1  ON 22
ci_0024                -1.837916e-02 3 1  ON 23
ci_0025                -1.867845e-02 3 1  ON 24
ci_0026                -1.781044e-02 3 1  ON 25
ci_0027                -1.781127e-02 3 1  ON 26
ci_0028                -1.750040e-02 3 1  ON 27
ci_0029                -1.473152e-02 3 1  ON 28
ci_0030                -1.640231e-02 3 1  ON 29
ci_0031                 1.530358e-02 3 1  ON 30
ci_0032                 1.455523e-02 3 1  ON 31
ci_0033                 1.663720e-02 3 1  ON 32
ci_0034                 1.579391e-02 3 1  ON 33
ci_0035                 1.690521e-02 3 1  ON 34
ci_0036                 1.725583e-02 3 1  ON 35
ci_0037                -1.552330e-02 3 1  ON 36
ci_0038                -1.393469e-02 3 1  ON 37
ci_0039                -1.574442e-02 3 1  ON 38
ci_0040                -1.521354e-02 3 1  ON 39
ci_0041                 1.632046e-02 3 1  ON 40
ci_0042                 1.554377e-02 3 1  ON 41
ci_0043                -1.464895e-02 3 1  ON 42
ci_0044                -1.604260e-02 3 1  ON 43
ci_0045                 1.513189e-02 3 1  ON 44
ci_0046                 1.588356e-02 3 1  ON 45
ci_0047                -1.469371e-02 3 1  ON 46
ci_0048                -1.412009e-02 3 1  ON 47
ci_0049                -1.248287e-02 3 1  ON 48
ci_0050                -1.255847e-02 3 1  ON 49
ci_0051                -1.313009e-02 3 1  ON 50
ci_0052                -1.235227e-02 3 1  ON 51
ci_0053                -1.345106e-02 3 1  ON 52
ci_0054                -1.219992e-02 3 1  ON 53
ci_0055                 1.361198e-02 3 1  ON 54
ci_0056                 1.349053e-02 3 1  ON 55
ci_0057                 1.391984e-02 3 1  ON 56
ci_0058                 1.286775e-02 3 1  ON 57
ci_0059                -1.369862e-02 3 1  ON 58
ci_0060                -1.216246e-02 3 1  ON 59
ci_0061                -1.296385e-02 3 1  ON 60
ci_0062                -1.245789e-02 3 1  ON 61
ci_0063                -1.176129e-02 3 1  ON 62
ci_0064                -1.102228e-02 3 1  ON 63
ci_0065                -1.123761e-02 3 1  ON 64
ci_0066                -1.124228e-02 3 1  ON 65
ci_0067                -1.172981e-02 3 1  ON 66
ci_0068                -1.039528e-02 3 1  ON 67
ci_0069                 1.144811e-02 3 1  ON 68
ci_0070                 1.000245e-02 3 1  ON 69
ci_0071                 9.895197e-03 3 1  ON 70
ci_0072                 1.032982e-02 3 1  ON 71
ci_0073                 1.134710e-02 3 1  ON 72
ci_0074                 1.067534e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0219e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6742e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.962
    reference variance = 1.26948
====================================================
  Execution time = 1.3001e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0259e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5595e+00
  Total weights = 1.945610207e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1886e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589002362903
                                         uncertainty =       0.076859754018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589002362903
                                         uncertainty =       0.076859754018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137736164
  error estimate for blocks of size 2^( 2) =       0.001175595122
  error estimate for blocks of size 2^( 3) =       0.001208001609
  error estimate for blocks of size 2^( 4) =       0.001232415972
  error estimate for blocks of size 2^( 5) =       0.001243773250
  error estimate for blocks of size 2^( 6) =       0.001253983158
  error estimate for blocks of size 2^( 7) =       0.001265499838

      target function =                  N/A
              le_mean =     -16.719078283413
             les_mean =     282.087112345258
             stat err =       0.001248918054
             autocorr =       1.204993661100
              std dev =       1.609027657076
             le_variance =       2.588970001236


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671907828341e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719078282515       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719078647878       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719078645457       residual = 2.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+01 is 8.156731e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719078282515       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719078374120       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719078373512       residual = 1.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+02 is 2.044697e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719078282515       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719078305433       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719078305281       residual = 1.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+02 is 5.115204e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147722 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6195e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.066945e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810799e-02 3 1  ON 2
ci_0004                -4.644786e-02 3 1  ON 3
ci_0005                -4.623630e-02 3 1  ON 4
ci_0006                -4.353290e-02 3 1  ON 5
ci_0007                -3.117258e-02 3 1  ON 6
ci_0008                -3.131572e-02 3 1  ON 7
ci_0009                -3.233023e-02 3 1  ON 8
ci_0010                -3.055941e-02 3 1  ON 9
ci_0011                -2.686180e-02 3 1  ON 10
ci_0012                -2.560157e-02 3 1  ON 11
ci_0013                 2.738125e-02 3 1  ON 12
ci_0014                 2.712277e-02 3 1  ON 13
ci_0015                 2.758730e-02 3 1  ON 14
ci_0016                 2.635432e-02 3 1  ON 15
ci_0017                 2.494315e-02 3 1  ON 16
ci_0018                 2.321476e-02 3 1  ON 17
ci_0019                 2.065726e-02 3 1  ON 18
ci_0020                 1.930322e-02 3 1  ON 19
ci_0021                 1.841967e-02 3 1  ON 20
ci_0022                 1.856984e-02 3 1  ON 21
ci_0023                -2.021413e-02 3 1  ON 22
ci_0024                -1.837933e-02 3 1  ON 23
ci_0025                -1.867865e-02 3 1  ON 24
ci_0026                -1.780991e-02 3 1  ON 25
ci_0027                -1.781160e-02 3 1  ON 26
ci_0028                -1.749940e-02 3 1  ON 27
ci_0029                -1.473357e-02 3 1  ON 28
ci_0030                -1.640274e-02 3 1  ON 29
ci_0031                 1.530371e-02 3 1  ON 30
ci_0032                 1.455556e-02 3 1  ON 31
ci_0033                 1.663787e-02 3 1  ON 32
ci_0034                 1.579265e-02 3 1  ON 33
ci_0035                 1.690578e-02 3 1  ON 34
ci_0036                 1.725581e-02 3 1  ON 35
ci_0037                -1.552297e-02 3 1  ON 36
ci_0038                -1.393600e-02 3 1  ON 37
ci_0039                -1.574588e-02 3 1  ON 38
ci_0040                -1.521414e-02 3 1  ON 39
ci_0041                 1.632075e-02 3 1  ON 40
ci_0042                 1.554383e-02 3 1  ON 41
ci_0043                -1.464925e-02 3 1  ON 42
ci_0044                -1.604143e-02 3 1  ON 43
ci_0045                 1.513282e-02 3 1  ON 44
ci_0046                 1.588213e-02 3 1  ON 45
ci_0047                -1.469380e-02 3 1  ON 46
ci_0048                -1.411929e-02 3 1  ON 47
ci_0049                -1.248374e-02 3 1  ON 48
ci_0050                -1.255792e-02 3 1  ON 49
ci_0051                -1.312994e-02 3 1  ON 50
ci_0052                -1.235312e-02 3 1  ON 51
ci_0053                -1.345112e-02 3 1  ON 52
ci_0054                -1.220073e-02 3 1  ON 53
ci_0055                 1.361111e-02 3 1  ON 54
ci_0056                 1.349085e-02 3 1  ON 55
ci_0057                 1.391896e-02 3 1  ON 56
ci_0058                 1.286644e-02 3 1  ON 57
ci_0059                -1.369712e-02 3 1  ON 58
ci_0060                -1.216384e-02 3 1  ON 59
ci_0061                -1.296310e-02 3 1  ON 60
ci_0062                -1.245731e-02 3 1  ON 61
ci_0063                -1.176196e-02 3 1  ON 62
ci_0064                -1.102256e-02 3 1  ON 63
ci_0065                -1.123763e-02 3 1  ON 64
ci_0066                -1.124219e-02 3 1  ON 65
ci_0067                -1.172986e-02 3 1  ON 66
ci_0068                -1.039589e-02 3 1  ON 67
ci_0069                 1.144706e-02 3 1  ON 68
ci_0070                 1.000307e-02 3 1  ON 69
ci_0071                 9.895482e-03 3 1  ON 70
ci_0072                 1.032928e-02 3 1  ON 71
ci_0073                 1.134639e-02 3 1  ON 72
ci_0074                 1.067569e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.5888
    reference variance = 1.738
====================================================
  Execution time = 1.2696e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4999e+00
  Total weights = 1.9454e+06
  Execution time = 2.2473e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529631945220
                                         uncertainty =       0.026719674740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529631945220
                                         uncertainty =       0.026719674740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124486393
  error estimate for blocks of size 2^( 2) =       0.001163124844
  error estimate for blocks of size 2^( 3) =       0.001196514916
  error estimate for blocks of size 2^( 4) =       0.001219699482
  error estimate for blocks of size 2^( 5) =       0.001232992738
  error estimate for blocks of size 2^( 6) =       0.001242116710
  error estimate for blocks of size 2^( 7) =       0.001245752301

      target function =                  N/A
              le_mean =     -16.719269477554
             les_mean =     282.034032542090
             stat err =       0.001235140308
             autocorr =       1.206491260444
              std dev =       1.590289351685
             le_variance =       2.529020222083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529632380055
                                         uncertainty =       0.026719449354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529632380055
                                         uncertainty =       0.026719449354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124486489
  error estimate for blocks of size 2^( 2) =       0.001163124745
  error estimate for blocks of size 2^( 3) =       0.001196514619
  error estimate for blocks of size 2^( 4) =       0.001219699028
  error estimate for blocks of size 2^( 5) =       0.001232992055
  error estimate for blocks of size 2^( 6) =       0.001242115643
  error estimate for blocks of size 2^( 7) =       0.001245751531

      target function =                  N/A
              le_mean =     -16.719269548019
             les_mean =     282.033906651414
             stat err =       0.001235139564
             autocorr =       1.206489602592
              std dev =       1.590289487164
             le_variance =       2.529020652983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529632154114
                                         uncertainty =       0.026719561800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529632154114
                                         uncertainty =       0.026719561800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124486439
  error estimate for blocks of size 2^( 2) =       0.001163124792
  error estimate for blocks of size 2^( 3) =       0.001196514765
  error estimate for blocks of size 2^( 4) =       0.001219699253
  error estimate for blocks of size 2^( 5) =       0.001232992393
  error estimate for blocks of size 2^( 6) =       0.001242116173
  error estimate for blocks of size 2^( 7) =       0.001245751910

      target function =                  N/A
              le_mean =     -16.719269512274
             les_mean =     282.033904800375
             stat err =       0.001235139932
             autocorr =       1.206490428108
              std dev =       1.590289416750
             le_variance =       2.529020429028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529631970417
                                         uncertainty =       0.026719660623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529631970417
                                         uncertainty =       0.026719660623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124486399
  error estimate for blocks of size 2^( 2) =       0.001163124837
  error estimate for blocks of size 2^( 3) =       0.001196514898
  error estimate for blocks of size 2^( 4) =       0.001219699454
  error estimate for blocks of size 2^( 5) =       0.001232992695
  error estimate for blocks of size 2^( 6) =       0.001242116643
  error estimate for blocks of size 2^( 7) =       0.001245752251

      target function =                  N/A
              le_mean =     -16.719269481637
             les_mean =     282.033945268260
             stat err =       0.001235140261
             autocorr =       1.206491156859
              std dev =       1.590289359531
             le_variance =       2.529020247038


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719269477554        initial
     6.1035e+01     6.1035e+02             8.1567e-06       -16.719269548019  <--
     2.4414e+02     2.4414e+03             2.0447e-06       -16.719269512274
     9.7656e+02     9.7656e+03             5.1152e-07       -16.719269481637

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 2.4060e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.066947e-01 3 1  ON 0
ci_0002                 6.799282e-01 3 1  ON 1
ci_0003                -4.810527e-02 3 1  ON 2
ci_0004                -4.644639e-02 3 1  ON 3
ci_0005                -4.623735e-02 3 1  ON 4
ci_0006                -4.353311e-02 3 1  ON 5
ci_0007                -3.117526e-02 3 1  ON 6
ci_0008                -3.131457e-02 3 1  ON 7
ci_0009                -3.233348e-02 3 1  ON 8
ci_0010                -3.056186e-02 3 1  ON 9
ci_0011                -2.686579e-02 3 1  ON 10
ci_0012                -2.560257e-02 3 1  ON 11
ci_0013                 2.738247e-02 3 1  ON 12
ci_0014                 2.712232e-02 3 1  ON 13
ci_0015                 2.758654e-02 3 1  ON 14
ci_0016                 2.635700e-02 3 1  ON 15
ci_0017                 2.494349e-02 3 1  ON 16
ci_0018                 2.321688e-02 3 1  ON 17
ci_0019                 2.065521e-02 3 1  ON 18
ci_0020                 1.930298e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856975e-02 3 1  ON 21
ci_0023                -2.021342e-02 3 1  ON 22
ci_0024                -1.837983e-02 3 1  ON 23
ci_0025                -1.867926e-02 3 1  ON 24
ci_0026                -1.780832e-02 3 1  ON 25
ci_0027                -1.781261e-02 3 1  ON 26
ci_0028                -1.749643e-02 3 1  ON 27
ci_0029                -1.473968e-02 3 1  ON 28
ci_0030                -1.640402e-02 3 1  ON 29
ci_0031                 1.530409e-02 3 1  ON 30
ci_0032                 1.455654e-02 3 1  ON 31
ci_0033                 1.663985e-02 3 1  ON 32
ci_0034                 1.578888e-02 3 1  ON 33
ci_0035                 1.690747e-02 3 1  ON 34
ci_0036                 1.725577e-02 3 1  ON 35
ci_0037                -1.552196e-02 3 1  ON 36
ci_0038                -1.393992e-02 3 1  ON 37
ci_0039                -1.575025e-02 3 1  ON 38
ci_0040                -1.521592e-02 3 1  ON 39
ci_0041                 1.632161e-02 3 1  ON 40
ci_0042                 1.554399e-02 3 1  ON 41
ci_0043                -1.465014e-02 3 1  ON 42
ci_0044                -1.603792e-02 3 1  ON 43
ci_0045                 1.513558e-02 3 1  ON 44
ci_0046                 1.587785e-02 3 1  ON 45
ci_0047                -1.469407e-02 3 1  ON 46
ci_0048                -1.411692e-02 3 1  ON 47
ci_0049                -1.248635e-02 3 1  ON 48
ci_0050                -1.255627e-02 3 1  ON 49
ci_0051                -1.312948e-02 3 1  ON 50
ci_0052                -1.235565e-02 3 1  ON 51
ci_0053                -1.345129e-02 3 1  ON 52
ci_0054                -1.220315e-02 3 1  ON 53
ci_0055                 1.360851e-02 3 1  ON 54
ci_0056                 1.349181e-02 3 1  ON 55
ci_0057                 1.391631e-02 3 1  ON 56
ci_0058                 1.286254e-02 3 1  ON 57
ci_0059                -1.369263e-02 3 1  ON 58
ci_0060                -1.216795e-02 3 1  ON 59
ci_0061                -1.296087e-02 3 1  ON 60
ci_0062                -1.245555e-02 3 1  ON 61
ci_0063                -1.176394e-02 3 1  ON 62
ci_0064                -1.102336e-02 3 1  ON 63
ci_0065                -1.123768e-02 3 1  ON 64
ci_0066                -1.124194e-02 3 1  ON 65
ci_0067                -1.173000e-02 3 1  ON 66
ci_0068                -1.039771e-02 3 1  ON 67
ci_0069                 1.144394e-02 3 1  ON 68
ci_0070                 1.000492e-02 3 1  ON 69
ci_0071                 9.896335e-03 3 1  ON 70
ci_0072                 1.032767e-02 3 1  ON 71
ci_0073                 1.134426e-02 3 1  ON 72
ci_0074                 1.067673e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0262e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6743e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8367
    reference variance = 1.75649
====================================================
  Execution time = 1.3036e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0246e+04
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.6164e+00
  Total weights = 1.945374812e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2082e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.649029816879
                                         uncertainty =       0.053650844720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.649029816879
                                         uncertainty =       0.053650844720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001150752578
  error estimate for blocks of size 2^( 2) =       0.001189543604
  error estimate for blocks of size 2^( 3) =       0.001221894152
  error estimate for blocks of size 2^( 4) =       0.001244104549
  error estimate for blocks of size 2^( 5) =       0.001255705862
  error estimate for blocks of size 2^( 6) =       0.001260781825
  error estimate for blocks of size 2^( 7) =       0.001260656306

      target function =                  N/A
              le_mean =     -16.716218185554
             les_mean =     282.048392359473
             stat err =       0.001255312135
             autocorr =       1.189979670192
              std dev =       1.627435940404
             le_variance =       2.648547740118


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671621818555e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716218184630       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716219161108       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716219174846       residual = 6.90e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+01 is 3.113920e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716218184630       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716218431678       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716218434786       residual = 6.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+01 is 7.878643e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716218184630       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716218246578       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716218247334       residual = 6.54e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+02 is 1.975622e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148883 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6251e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.066941e-01 3 1  ON 0
ci_0002                 6.799275e-01 3 1  ON 1
ci_0003                -4.810862e-02 3 1  ON 2
ci_0004                -4.645033e-02 3 1  ON 3
ci_0005                -4.623632e-02 3 1  ON 4
ci_0006                -4.353238e-02 3 1  ON 5
ci_0007                -3.117520e-02 3 1  ON 6
ci_0008                -3.131497e-02 3 1  ON 7
ci_0009                -3.233301e-02 3 1  ON 8
ci_0010                -3.056459e-02 3 1  ON 9
ci_0011                -2.686941e-02 3 1  ON 10
ci_0012                -2.560922e-02 3 1  ON 11
ci_0013                 2.738122e-02 3 1  ON 12
ci_0014                 2.712100e-02 3 1  ON 13
ci_0015                 2.758909e-02 3 1  ON 14
ci_0016                 2.635628e-02 3 1  ON 15
ci_0017                 2.494267e-02 3 1  ON 16
ci_0018                 2.321941e-02 3 1  ON 17
ci_0019                 2.065520e-02 3 1  ON 18
ci_0020                 1.930486e-02 3 1  ON 19
ci_0021                 1.842120e-02 3 1  ON 20
ci_0022                 1.857032e-02 3 1  ON 21
ci_0023                -2.020554e-02 3 1  ON 22
ci_0024                -1.837887e-02 3 1  ON 23
ci_0025                -1.867938e-02 3 1  ON 24
ci_0026                -1.781090e-02 3 1  ON 25
ci_0027                -1.781264e-02 3 1  ON 26
ci_0028                -1.749593e-02 3 1  ON 27
ci_0029                -1.474672e-02 3 1  ON 28
ci_0030                -1.640070e-02 3 1  ON 29
ci_0031                 1.530657e-02 3 1  ON 30
ci_0032                 1.455713e-02 3 1  ON 31
ci_0033                 1.663838e-02 3 1  ON 32
ci_0034                 1.579105e-02 3 1  ON 33
ci_0035                 1.690970e-02 3 1  ON 34
ci_0036                 1.725566e-02 3 1  ON 35
ci_0037                -1.552744e-02 3 1  ON 36
ci_0038                -1.394524e-02 3 1  ON 37
ci_0039                -1.574926e-02 3 1  ON 38
ci_0040                -1.521211e-02 3 1  ON 39
ci_0041                 1.631969e-02 3 1  ON 40
ci_0042                 1.554238e-02 3 1  ON 41
ci_0043                -1.465125e-02 3 1  ON 42
ci_0044                -1.604010e-02 3 1  ON 43
ci_0045                 1.513275e-02 3 1  ON 44
ci_0046                 1.587619e-02 3 1  ON 45
ci_0047                -1.469346e-02 3 1  ON 46
ci_0048                -1.411869e-02 3 1  ON 47
ci_0049                -1.248807e-02 3 1  ON 48
ci_0050                -1.256080e-02 3 1  ON 49
ci_0051                -1.312873e-02 3 1  ON 50
ci_0052                -1.235764e-02 3 1  ON 51
ci_0053                -1.345143e-02 3 1  ON 52
ci_0054                -1.220088e-02 3 1  ON 53
ci_0055                 1.360656e-02 3 1  ON 54
ci_0056                 1.349294e-02 3 1  ON 55
ci_0057                 1.391222e-02 3 1  ON 56
ci_0058                 1.286009e-02 3 1  ON 57
ci_0059                -1.368727e-02 3 1  ON 58
ci_0060                -1.217192e-02 3 1  ON 59
ci_0061                -1.296524e-02 3 1  ON 60
ci_0062                -1.245651e-02 3 1  ON 61
ci_0063                -1.176290e-02 3 1  ON 62
ci_0064                -1.103000e-02 3 1  ON 63
ci_0065                -1.124024e-02 3 1  ON 64
ci_0066                -1.124652e-02 3 1  ON 65
ci_0067                -1.172465e-02 3 1  ON 66
ci_0068                -1.039954e-02 3 1  ON 67
ci_0069                 1.144831e-02 3 1  ON 68
ci_0070                 1.000711e-02 3 1  ON 69
ci_0071                 9.895883e-03 3 1  ON 70
ci_0072                 1.032463e-02 3 1  ON 71
ci_0073                 1.134546e-02 3 1  ON 72
ci_0074                 1.067853e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.4324
    reference variance = 5.33779
====================================================
  Execution time = 1.2724e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5200e+00
  Total weights = 1.9457e+06
  Execution time = 2.2506e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546791140846
                                         uncertainty =       0.045284754475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546791140846
                                         uncertainty =       0.045284754475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128336148
  error estimate for blocks of size 2^( 2) =       0.001166795338
  error estimate for blocks of size 2^( 3) =       0.001199402545
  error estimate for blocks of size 2^( 4) =       0.001222520012
  error estimate for blocks of size 2^( 5) =       0.001235395131
  error estimate for blocks of size 2^( 6) =       0.001244581294
  error estimate for blocks of size 2^( 7) =       0.001248187743

      target function =                  N/A
              le_mean =     -16.719945883849
             les_mean =     282.076538826948
             stat err =       0.001237671045
             autocorr =       1.203187907301
              std dev =       1.595733814553
             le_variance =       2.546366406907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546794625102
                                         uncertainty =       0.045284607183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546794625102
                                         uncertainty =       0.045284607183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128336964
  error estimate for blocks of size 2^( 2) =       0.001166795169
  error estimate for blocks of size 2^( 3) =       0.001199401299
  error estimate for blocks of size 2^( 4) =       0.001222517641
  error estimate for blocks of size 2^( 5) =       0.001235392280
  error estimate for blocks of size 2^( 6) =       0.001244578446
  error estimate for blocks of size 2^( 7) =       0.001248186116

      target function =                  N/A
              le_mean =     -16.719945646924
             les_mean =     282.076604043430
             stat err =       0.001237668621
             autocorr =       1.203181453939
              std dev =       1.595734968567
             le_variance =       2.546370089906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546792868692
                                         uncertainty =       0.045284679820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546792868692
                                         uncertainty =       0.045284679820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128336553
  error estimate for blocks of size 2^( 2) =       0.001166795245
  error estimate for blocks of size 2^( 3) =       0.001199401907
  error estimate for blocks of size 2^( 4) =       0.001222518802
  error estimate for blocks of size 2^( 5) =       0.001235393680
  error estimate for blocks of size 2^( 6) =       0.001244579836
  error estimate for blocks of size 2^( 7) =       0.001248186911

      target function =                  N/A
              le_mean =     -16.719945757497
             les_mean =     282.076558543008
             stat err =       0.001237669807
             autocorr =       1.203184636936
              std dev =       1.595734387424
             le_variance =       2.546368235208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546791352892
                                         uncertainty =       0.045284745109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546791352892
                                         uncertainty =       0.045284745109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128336198
  error estimate for blocks of size 2^( 2) =       0.001166795325
  error estimate for blocks of size 2^( 3) =       0.001199402464
  error estimate for blocks of size 2^( 4) =       0.001222519859
  error estimate for blocks of size 2^( 5) =       0.001235394948
  error estimate for blocks of size 2^( 6) =       0.001244581110
  error estimate for blocks of size 2^( 7) =       0.001248187637

      target function =                  N/A
              le_mean =     -16.719945867234
             les_mean =     282.076540360470
             stat err =       0.001237670889
             autocorr =       1.203187497299
              std dev =       1.595733884939
             le_variance =       2.546366631541


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719945883849        initial  <--
     1.5259e+01     1.5259e+02             3.1139e-05       -16.719945646924
     6.1035e+01     6.1035e+02             7.8786e-06       -16.719945757497
     2.4414e+02     2.4414e+03             1.9756e-06       -16.719945867234

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0569
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.066947e-01 3 1  ON 0
ci_0002                 6.799282e-01 3 1  ON 1
ci_0003                -4.810527e-02 3 1  ON 2
ci_0004                -4.644639e-02 3 1  ON 3
ci_0005                -4.623735e-02 3 1  ON 4
ci_0006                -4.353311e-02 3 1  ON 5
ci_0007                -3.117526e-02 3 1  ON 6
ci_0008                -3.131457e-02 3 1  ON 7
ci_0009                -3.233348e-02 3 1  ON 8
ci_0010                -3.056186e-02 3 1  ON 9
ci_0011                -2.686579e-02 3 1  ON 10
ci_0012                -2.560257e-02 3 1  ON 11
ci_0013                 2.738247e-02 3 1  ON 12
ci_0014                 2.712232e-02 3 1  ON 13
ci_0015                 2.758654e-02 3 1  ON 14
ci_0016                 2.635700e-02 3 1  ON 15
ci_0017                 2.494349e-02 3 1  ON 16
ci_0018                 2.321688e-02 3 1  ON 17
ci_0019                 2.065521e-02 3 1  ON 18
ci_0020                 1.930298e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856975e-02 3 1  ON 21
ci_0023                -2.021342e-02 3 1  ON 22
ci_0024                -1.837983e-02 3 1  ON 23
ci_0025                -1.867926e-02 3 1  ON 24
ci_0026                -1.780832e-02 3 1  ON 25
ci_0027                -1.781261e-02 3 1  ON 26
ci_0028                -1.749643e-02 3 1  ON 27
ci_0029                -1.473968e-02 3 1  ON 28
ci_0030                -1.640402e-02 3 1  ON 29
ci_0031                 1.530409e-02 3 1  ON 30
ci_0032                 1.455654e-02 3 1  ON 31
ci_0033                 1.663985e-02 3 1  ON 32
ci_0034                 1.578888e-02 3 1  ON 33
ci_0035                 1.690747e-02 3 1  ON 34
ci_0036                 1.725577e-02 3 1  ON 35
ci_0037                -1.552196e-02 3 1  ON 36
ci_0038                -1.393992e-02 3 1  ON 37
ci_0039                -1.575025e-02 3 1  ON 38
ci_0040                -1.521592e-02 3 1  ON 39
ci_0041                 1.632161e-02 3 1  ON 40
ci_0042                 1.554399e-02 3 1  ON 41
ci_0043                -1.465014e-02 3 1  ON 42
ci_0044                -1.603792e-02 3 1  ON 43
ci_0045                 1.513558e-02 3 1  ON 44
ci_0046                 1.587785e-02 3 1  ON 45
ci_0047                -1.469407e-02 3 1  ON 46
ci_0048                -1.411692e-02 3 1  ON 47
ci_0049                -1.248635e-02 3 1  ON 48
ci_0050                -1.255627e-02 3 1  ON 49
ci_0051                -1.312948e-02 3 1  ON 50
ci_0052                -1.235565e-02 3 1  ON 51
ci_0053                -1.345129e-02 3 1  ON 52
ci_0054                -1.220315e-02 3 1  ON 53
ci_0055                 1.360851e-02 3 1  ON 54
ci_0056                 1.349181e-02 3 1  ON 55
ci_0057                 1.391631e-02 3 1  ON 56
ci_0058                 1.286254e-02 3 1  ON 57
ci_0059                -1.369263e-02 3 1  ON 58
ci_0060                -1.216795e-02 3 1  ON 59
ci_0061                -1.296087e-02 3 1  ON 60
ci_0062                -1.245555e-02 3 1  ON 61
ci_0063                -1.176394e-02 3 1  ON 62
ci_0064                -1.102336e-02 3 1  ON 63
ci_0065                -1.123768e-02 3 1  ON 64
ci_0066                -1.124194e-02 3 1  ON 65
ci_0067                -1.173000e-02 3 1  ON 66
ci_0068                -1.039771e-02 3 1  ON 67
ci_0069                 1.144394e-02 3 1  ON 68
ci_0070                 1.000492e-02 3 1  ON 69
ci_0071                 9.896335e-03 3 1  ON 70
ci_0072                 1.032767e-02 3 1  ON 71
ci_0073                 1.134426e-02 3 1  ON 72
ci_0074                 1.067673e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0315e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6738e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.6942
    reference variance = 1.59986
====================================================
  Execution time = 1.2908e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0309e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.4616e+00
  Total weights = 1.945238494e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1512e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.487446163592
                                         uncertainty =       0.017834247913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.487446163592
                                         uncertainty =       0.017834247913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001115258838
  error estimate for blocks of size 2^( 2) =       0.001153440510
  error estimate for blocks of size 2^( 3) =       0.001188283354
  error estimate for blocks of size 2^( 4) =       0.001211961570
  error estimate for blocks of size 2^( 5) =       0.001225886447
  error estimate for blocks of size 2^( 6) =       0.001232762178
  error estimate for blocks of size 2^( 7) =       0.001238404788

      target function =                  N/A
              le_mean =     -16.718073084215
             les_mean =     281.955580456168
             stat err =       0.001227253746
             autocorr =       1.210925391373
              std dev =       1.577239409073
             le_variance =       2.487684153533


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671807308421e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718073083315       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718073125647       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718073127533       residual = 4.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+02 is 2.871570e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718073083315       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718073093912       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718073094379       residual = 4.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+02 is 7.188928e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718073083315       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718073085965       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718073086082       residual = 4.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+03 is 1.797858e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150024 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6065e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.066948e-01 3 1  ON 0
ci_0002                 6.799284e-01 3 1  ON 1
ci_0003                -4.810556e-02 3 1  ON 2
ci_0004                -4.644653e-02 3 1  ON 3
ci_0005                -4.623720e-02 3 1  ON 4
ci_0006                -4.353307e-02 3 1  ON 5
ci_0007                -3.117522e-02 3 1  ON 6
ci_0008                -3.131419e-02 3 1  ON 7
ci_0009                -3.233330e-02 3 1  ON 8
ci_0010                -3.056165e-02 3 1  ON 9
ci_0011                -2.686563e-02 3 1  ON 10
ci_0012                -2.560187e-02 3 1  ON 11
ci_0013                 2.738246e-02 3 1  ON 12
ci_0014                 2.712184e-02 3 1  ON 13
ci_0015                 2.758648e-02 3 1  ON 14
ci_0016                 2.635633e-02 3 1  ON 15
ci_0017                 2.494318e-02 3 1  ON 16
ci_0018                 2.321692e-02 3 1  ON 17
ci_0019                 2.065507e-02 3 1  ON 18
ci_0020                 1.930276e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856949e-02 3 1  ON 21
ci_0023                -2.021294e-02 3 1  ON 22
ci_0024                -1.837911e-02 3 1  ON 23
ci_0025                -1.867968e-02 3 1  ON 24
ci_0026                -1.780778e-02 3 1  ON 25
ci_0027                -1.781257e-02 3 1  ON 26
ci_0028                -1.749602e-02 3 1  ON 27
ci_0029                -1.473976e-02 3 1  ON 28
ci_0030                -1.640372e-02 3 1  ON 29
ci_0031                 1.530367e-02 3 1  ON 30
ci_0032                 1.455654e-02 3 1  ON 31
ci_0033                 1.663988e-02 3 1  ON 32
ci_0034                 1.578912e-02 3 1  ON 33
ci_0035                 1.690738e-02 3 1  ON 34
ci_0036                 1.725523e-02 3 1  ON 35
ci_0037                -1.552189e-02 3 1  ON 36
ci_0038                -1.394010e-02 3 1  ON 37
ci_0039                -1.574999e-02 3 1  ON 38
ci_0040                -1.521556e-02 3 1  ON 39
ci_0041                 1.632157e-02 3 1  ON 40
ci_0042                 1.554412e-02 3 1  ON 41
ci_0043                -1.464993e-02 3 1  ON 42
ci_0044                -1.603766e-02 3 1  ON 43
ci_0045                 1.513555e-02 3 1  ON 44
ci_0046                 1.587778e-02 3 1  ON 45
ci_0047                -1.469443e-02 3 1  ON 46
ci_0048                -1.411693e-02 3 1  ON 47
ci_0049                -1.248646e-02 3 1  ON 48
ci_0050                -1.255656e-02 3 1  ON 49
ci_0051                -1.312969e-02 3 1  ON 50
ci_0052                -1.235516e-02 3 1  ON 51
ci_0053                -1.345101e-02 3 1  ON 52
ci_0054                -1.220312e-02 3 1  ON 53
ci_0055                 1.360822e-02 3 1  ON 54
ci_0056                 1.349112e-02 3 1  ON 55
ci_0057                 1.391607e-02 3 1  ON 56
ci_0058                 1.286209e-02 3 1  ON 57
ci_0059                -1.369211e-02 3 1  ON 58
ci_0060                -1.216807e-02 3 1  ON 59
ci_0061                -1.296094e-02 3 1  ON 60
ci_0062                -1.245546e-02 3 1  ON 61
ci_0063                -1.176359e-02 3 1  ON 62
ci_0064                -1.102321e-02 3 1  ON 63
ci_0065                -1.123805e-02 3 1  ON 64
ci_0066                -1.124197e-02 3 1  ON 65
ci_0067                -1.173006e-02 3 1  ON 66
ci_0068                -1.039808e-02 3 1  ON 67
ci_0069                 1.144337e-02 3 1  ON 68
ci_0070                 1.000529e-02 3 1  ON 69
ci_0071                 9.896219e-03 3 1  ON 70
ci_0072                 1.032772e-02 3 1  ON 71
ci_0073                 1.134420e-02 3 1  ON 72
ci_0074                 1.067646e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.6552
    reference variance = 1.98179
====================================================
  Execution time = 1.2733e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5224e+00
  Total weights = 1.9459e+06
  Execution time = 2.2431e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549797080474
                                         uncertainty =       0.064611938437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549797080474
                                         uncertainty =       0.064611938437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129370698
  error estimate for blocks of size 2^( 2) =       0.001166343749
  error estimate for blocks of size 2^( 3) =       0.001198262924
  error estimate for blocks of size 2^( 4) =       0.001220522294
  error estimate for blocks of size 2^( 5) =       0.001236162164
  error estimate for blocks of size 2^( 6) =       0.001247067078
  error estimate for blocks of size 2^( 7) =       0.001253295939

      target function =                  N/A
              le_mean =     -16.718517140374
             les_mean =     282.031263613528
             stat err =       0.001239261868
             autocorr =       1.204073900111
              std dev =       1.597196912366
             le_variance =       2.551037976873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549793262543
                                         uncertainty =       0.064611900858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549793262543
                                         uncertainty =       0.064611900858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129369854
  error estimate for blocks of size 2^( 2) =       0.001166343157
  error estimate for blocks of size 2^( 3) =       0.001198262597
  error estimate for blocks of size 2^( 4) =       0.001220522227
  error estimate for blocks of size 2^( 5) =       0.001236162244
  error estimate for blocks of size 2^( 6) =       0.001247067171
  error estimate for blocks of size 2^( 7) =       0.001253296222

      target function =                  N/A
              le_mean =     -16.718517159435
             les_mean =     282.031258218774
             stat err =       0.001239261966
             autocorr =       1.204075890035
              std dev =       1.597195718356
             le_variance =       2.551034162735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549795168448
                                         uncertainty =       0.064611919615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549795168448
                                         uncertainty =       0.064611919615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129370275
  error estimate for blocks of size 2^( 2) =       0.001166343452
  error estimate for blocks of size 2^( 3) =       0.001198262760
  error estimate for blocks of size 2^( 4) =       0.001220522260
  error estimate for blocks of size 2^( 5) =       0.001236162204
  error estimate for blocks of size 2^( 6) =       0.001247067124
  error estimate for blocks of size 2^( 7) =       0.001253296081

      target function =                  N/A
              le_mean =     -16.718517149842
             les_mean =     282.031260898328
             stat err =       0.001239261917
             autocorr =       1.204074896564
              std dev =       1.597196314404
             le_variance =       2.551036066745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549796841328
                                         uncertainty =       0.064611936083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549796841328
                                         uncertainty =       0.064611936083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129370645
  error estimate for blocks of size 2^( 2) =       0.001166343712
  error estimate for blocks of size 2^( 3) =       0.001198262903
  error estimate for blocks of size 2^( 4) =       0.001220522289
  error estimate for blocks of size 2^( 5) =       0.001236162169
  error estimate for blocks of size 2^( 6) =       0.001247067083
  error estimate for blocks of size 2^( 7) =       0.001253295956

      target function =                  N/A
              le_mean =     -16.718517141550
             les_mean =     282.031263272435
             stat err =       0.001239261874
             autocorr =       1.204074024721
              std dev =       1.597196837576
             le_variance =       2.551037737964


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718517140374        initial
     1.5259e+02     1.5259e+03             2.8716e-06       -16.718517159435  <--
     6.1035e+02     6.1035e+03             7.1889e-07       -16.718517149842
     2.4414e+03     2.4414e+04             1.7979e-07       -16.718517141550

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 2.4046e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117510e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173022e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0117e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6736e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.7142
    reference variance = 3.07828
====================================================
  Execution time = 1.2960e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0271e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5989e+00
  Total weights = 1.945755934e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1740e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.628887338915
                                         uncertainty =       0.104785539560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.628887338915
                                         uncertainty =       0.104785539560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001146471651
  error estimate for blocks of size 2^( 2) =       0.001184517529
  error estimate for blocks of size 2^( 3) =       0.001218177757
  error estimate for blocks of size 2^( 4) =       0.001241995644
  error estimate for blocks of size 2^( 5) =       0.001255943499
  error estimate for blocks of size 2^( 6) =       0.001267451266
  error estimate for blocks of size 2^( 7) =       0.001272061170

      target function =                  N/A
              le_mean =     -16.719038213472
             les_mean =     282.125128348981
             stat err =       0.001259362895
             autocorr =       1.206632854401
              std dev =       1.621381698630
             le_variance =       2.628878612653


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671903821347e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719038212551       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719038735639       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719038736431       residual = 1.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+01 is 1.444662e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719038212551       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719038343949       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719038344173       residual = 1.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+02 is 3.627095e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719038212551       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719038245440       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719038245498       residual = 1.13e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+02 is 9.077442e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6140e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.066955e-01 3 1  ON 0
ci_0002                 6.799283e-01 3 1  ON 1
ci_0003                -4.810560e-02 3 1  ON 2
ci_0004                -4.644744e-02 3 1  ON 3
ci_0005                -4.623491e-02 3 1  ON 4
ci_0006                -4.353355e-02 3 1  ON 5
ci_0007                -3.117551e-02 3 1  ON 6
ci_0008                -3.131339e-02 3 1  ON 7
ci_0009                -3.233427e-02 3 1  ON 8
ci_0010                -3.056105e-02 3 1  ON 9
ci_0011                -2.686627e-02 3 1  ON 10
ci_0012                -2.560066e-02 3 1  ON 11
ci_0013                 2.738195e-02 3 1  ON 12
ci_0014                 2.711958e-02 3 1  ON 13
ci_0015                 2.758773e-02 3 1  ON 14
ci_0016                 2.635357e-02 3 1  ON 15
ci_0017                 2.494101e-02 3 1  ON 16
ci_0018                 2.321824e-02 3 1  ON 17
ci_0019                 2.065440e-02 3 1  ON 18
ci_0020                 1.930277e-02 3 1  ON 19
ci_0021                 1.841819e-02 3 1  ON 20
ci_0022                 1.856895e-02 3 1  ON 21
ci_0023                -2.021060e-02 3 1  ON 22
ci_0024                -1.837702e-02 3 1  ON 23
ci_0025                -1.868054e-02 3 1  ON 24
ci_0026                -1.780551e-02 3 1  ON 25
ci_0027                -1.781279e-02 3 1  ON 26
ci_0028                -1.749287e-02 3 1  ON 27
ci_0029                -1.474362e-02 3 1  ON 28
ci_0030                -1.640239e-02 3 1  ON 29
ci_0031                 1.530147e-02 3 1  ON 30
ci_0032                 1.455723e-02 3 1  ON 31
ci_0033                 1.664147e-02 3 1  ON 32
ci_0034                 1.578895e-02 3 1  ON 33
ci_0035                 1.690770e-02 3 1  ON 34
ci_0036                 1.725365e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394204e-02 3 1  ON 37
ci_0039                -1.574909e-02 3 1  ON 38
ci_0040                -1.521582e-02 3 1  ON 39
ci_0041                 1.632240e-02 3 1  ON 40
ci_0042                 1.554367e-02 3 1  ON 41
ci_0043                -1.464869e-02 3 1  ON 42
ci_0044                -1.603627e-02 3 1  ON 43
ci_0045                 1.513549e-02 3 1  ON 44
ci_0046                 1.587595e-02 3 1  ON 45
ci_0047                -1.469563e-02 3 1  ON 46
ci_0048                -1.411707e-02 3 1  ON 47
ci_0049                -1.248837e-02 3 1  ON 48
ci_0050                -1.255968e-02 3 1  ON 49
ci_0051                -1.312934e-02 3 1  ON 50
ci_0052                -1.235481e-02 3 1  ON 51
ci_0053                -1.344859e-02 3 1  ON 52
ci_0054                -1.220419e-02 3 1  ON 53
ci_0055                 1.360538e-02 3 1  ON 54
ci_0056                 1.348700e-02 3 1  ON 55
ci_0057                 1.391387e-02 3 1  ON 56
ci_0058                 1.286285e-02 3 1  ON 57
ci_0059                -1.369039e-02 3 1  ON 58
ci_0060                -1.217151e-02 3 1  ON 59
ci_0061                -1.296299e-02 3 1  ON 60
ci_0062                -1.245502e-02 3 1  ON 61
ci_0063                -1.176407e-02 3 1  ON 62
ci_0064                -1.102364e-02 3 1  ON 63
ci_0065                -1.123966e-02 3 1  ON 64
ci_0066                -1.124189e-02 3 1  ON 65
ci_0067                -1.172779e-02 3 1  ON 66
ci_0068                -1.039957e-02 3 1  ON 67
ci_0069                 1.143995e-02 3 1  ON 68
ci_0070                 1.000769e-02 3 1  ON 69
ci_0071                 9.895973e-03 3 1  ON 70
ci_0072                 1.032706e-02 3 1  ON 71
ci_0073                 1.134342e-02 3 1  ON 72
ci_0074                 1.067655e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.868
    reference variance = 1.23643
====================================================
  Execution time = 1.2741e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5173e+00
  Total weights = 1.9452e+06
  Execution time = 2.2553e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544911732958
                                         uncertainty =       0.026253710392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544911732958
                                         uncertainty =       0.026253710392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128172924
  error estimate for blocks of size 2^( 2) =       0.001167325641
  error estimate for blocks of size 2^( 3) =       0.001198732485
  error estimate for blocks of size 2^( 4) =       0.001222618733
  error estimate for blocks of size 2^( 5) =       0.001238310483
  error estimate for blocks of size 2^( 6) =       0.001245178988
  error estimate for blocks of size 2^( 7) =       0.001249564591

      target function =                  N/A
              le_mean =     -16.717970802104
             les_mean =     282.007897688312
             stat err =       0.001238918199
             autocorr =       1.205962822583
              std dev =       1.595502977801
             le_variance =       2.545629752171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544908680458
                                         uncertainty =       0.026253869247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544908680458
                                         uncertainty =       0.026253869247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128172226
  error estimate for blocks of size 2^( 2) =       0.001167324634
  error estimate for blocks of size 2^( 3) =       0.001198731236
  error estimate for blocks of size 2^( 4) =       0.001222617217
  error estimate for blocks of size 2^( 5) =       0.001238308903
  error estimate for blocks of size 2^( 6) =       0.001245177573
  error estimate for blocks of size 2^( 7) =       0.001249562739

      target function =                  N/A
              le_mean =     -16.717970784888
             les_mean =     282.007901278164
             stat err =       0.001238916608
             autocorr =       1.205961219390
              std dev =       1.595501989753
             le_variance =       2.545626599305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544910191455
                                         uncertainty =       0.026253790387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544910191455
                                         uncertainty =       0.026253790387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128172572
  error estimate for blocks of size 2^( 2) =       0.001167325133
  error estimate for blocks of size 2^( 3) =       0.001198731855
  error estimate for blocks of size 2^( 4) =       0.001222617969
  error estimate for blocks of size 2^( 5) =       0.001238309687
  error estimate for blocks of size 2^( 6) =       0.001245178275
  error estimate for blocks of size 2^( 7) =       0.001249563657

      target function =                  N/A
              le_mean =     -16.717970792314
             les_mean =     282.007897697673
             stat err =       0.001238917397
             autocorr =       1.205962015887
              std dev =       1.595502478908
             le_variance =       2.545628160203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544911539125
                                         uncertainty =       0.026253720420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544911539125
                                         uncertainty =       0.026253720420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128172880
  error estimate for blocks of size 2^( 2) =       0.001167325577
  error estimate for blocks of size 2^( 3) =       0.001198732406
  error estimate for blocks of size 2^( 4) =       0.001222618638
  error estimate for blocks of size 2^( 5) =       0.001238310383
  error estimate for blocks of size 2^( 6) =       0.001245178898
  error estimate for blocks of size 2^( 7) =       0.001249564474

      target function =                  N/A
              le_mean =     -16.717970800759
             les_mean =     282.007897521661
             stat err =       0.001238918098
             autocorr =       1.205962721595
              std dev =       1.595502915077
             le_variance =       2.545629552020


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717970802104        initial  <--
     3.8147e+01     3.8147e+02             1.4447e-05       -16.717970784888
     1.5259e+02     1.5259e+03             3.6271e-06       -16.717970792314
     6.1035e+02     6.1035e+03             9.0774e-07       -16.717970800759

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1383
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117510e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173022e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0285e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6738e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.7084
    reference variance = 2.12068
====================================================
  Execution time = 1.3021e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0267e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.6034e+00
  Total weights = 1.945663068e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1810e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.630126928625
                                         uncertainty =       0.056923903518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.630126928625
                                         uncertainty =       0.056923903518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001146630744
  error estimate for blocks of size 2^( 2) =       0.001183081019
  error estimate for blocks of size 2^( 3) =       0.001214911545
  error estimate for blocks of size 2^( 4) =       0.001235021722
  error estimate for blocks of size 2^( 5) =       0.001250349083
  error estimate for blocks of size 2^( 6) =       0.001259323452
  error estimate for blocks of size 2^( 7) =       0.001265632177

      target function =                  N/A
              le_mean =     -16.717006246341
             les_mean =     282.061716919125
             stat err =       0.001252581608
             autocorr =       1.193341921214
              std dev =       1.621606693777
             le_variance =       2.629608269303


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671700624634e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717006245410       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717006332401       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717006332223       residual = 4.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+02 is 1.418231e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717006245410       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717006267168       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717006267124       residual = 3.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+03 is 3.547232e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717006245410       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717006250850       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717006250839       residual = 3.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+03 is 8.869115e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152364 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6208e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.066952e-01 3 1  ON 0
ci_0002                 6.799288e-01 3 1  ON 1
ci_0003                -4.810636e-02 3 1  ON 2
ci_0004                -4.644683e-02 3 1  ON 3
ci_0005                -4.623654e-02 3 1  ON 4
ci_0006                -4.353295e-02 3 1  ON 5
ci_0007                -3.117510e-02 3 1  ON 6
ci_0008                -3.131315e-02 3 1  ON 7
ci_0009                -3.233293e-02 3 1  ON 8
ci_0010                -3.056111e-02 3 1  ON 9
ci_0011                -2.686518e-02 3 1  ON 10
ci_0012                -2.559987e-02 3 1  ON 11
ci_0013                 2.738241e-02 3 1  ON 12
ci_0014                 2.712007e-02 3 1  ON 13
ci_0015                 2.758634e-02 3 1  ON 14
ci_0016                 2.635437e-02 3 1  ON 15
ci_0017                 2.494192e-02 3 1  ON 16
ci_0018                 2.321726e-02 3 1  ON 17
ci_0019                 2.065443e-02 3 1  ON 18
ci_0020                 1.930212e-02 3 1  ON 19
ci_0021                 1.841737e-02 3 1  ON 20
ci_0022                 1.856867e-02 3 1  ON 21
ci_0023                -2.021119e-02 3 1  ON 22
ci_0024                -1.837698e-02 3 1  ON 23
ci_0025                -1.868111e-02 3 1  ON 24
ci_0026                -1.780618e-02 3 1  ON 25
ci_0027                -1.781239e-02 3 1  ON 26
ci_0028                -1.749450e-02 3 1  ON 27
ci_0029                -1.474025e-02 3 1  ON 28
ci_0030                -1.640272e-02 3 1  ON 29
ci_0031                 1.530230e-02 3 1  ON 30
ci_0032                 1.455646e-02 3 1  ON 31
ci_0033                 1.663990e-02 3 1  ON 32
ci_0034                 1.578976e-02 3 1  ON 33
ci_0035                 1.690716e-02 3 1  ON 34
ci_0036                 1.725341e-02 3 1  ON 35
ci_0037                -1.552168e-02 3 1  ON 36
ci_0038                -1.394084e-02 3 1  ON 37
ci_0039                -1.574931e-02 3 1  ON 38
ci_0040                -1.521440e-02 3 1  ON 39
ci_0041                 1.632116e-02 3 1  ON 40
ci_0042                 1.554456e-02 3 1  ON 41
ci_0043                -1.464951e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513551e-02 3 1  ON 44
ci_0046                 1.587739e-02 3 1  ON 45
ci_0047                -1.469554e-02 3 1  ON 46
ci_0048                -1.411709e-02 3 1  ON 47
ci_0049                -1.248683e-02 3 1  ON 48
ci_0050                -1.255731e-02 3 1  ON 49
ci_0051                -1.313036e-02 3 1  ON 50
ci_0052                -1.235362e-02 3 1  ON 51
ci_0053                -1.345006e-02 3 1  ON 52
ci_0054                -1.220302e-02 3 1  ON 53
ci_0055                 1.360705e-02 3 1  ON 54
ci_0056                 1.348895e-02 3 1  ON 55
ci_0057                 1.391519e-02 3 1  ON 56
ci_0058                 1.286064e-02 3 1  ON 57
ci_0059                -1.369033e-02 3 1  ON 58
ci_0060                -1.216865e-02 3 1  ON 59
ci_0061                -1.296121e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176263e-02 3 1  ON 62
ci_0064                -1.102278e-02 3 1  ON 63
ci_0065                -1.123941e-02 3 1  ON 64
ci_0066                -1.124204e-02 3 1  ON 65
ci_0067                -1.172993e-02 3 1  ON 66
ci_0068                -1.039927e-02 3 1  ON 67
ci_0069                 1.144158e-02 3 1  ON 68
ci_0070                 1.000633e-02 3 1  ON 69
ci_0071                 9.895977e-03 3 1  ON 70
ci_0072                 1.032774e-02 3 1  ON 71
ci_0073                 1.134393e-02 3 1  ON 72
ci_0074                 1.067578e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.7054
    reference variance = 2.00476
====================================================
  Execution time = 1.5021e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4858e+00
  Total weights = 1.9460e+06
  Execution time = 2.2644e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515231176979
                                         uncertainty =       0.025422044240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515231176979
                                         uncertainty =       0.025422044240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121277192
  error estimate for blocks of size 2^( 2) =       0.001159873898
  error estimate for blocks of size 2^( 3) =       0.001194070194
  error estimate for blocks of size 2^( 4) =       0.001217344098
  error estimate for blocks of size 2^( 5) =       0.001234675091
  error estimate for blocks of size 2^( 6) =       0.001240540315
  error estimate for blocks of size 2^( 7) =       0.001241028059

      target function =                  N/A
              le_mean =     -16.719447686062
             les_mean =     282.025762062189
             stat err =       0.001233396891
             autocorr =       1.209984263024
              std dev =       1.585750783852
             le_variance =       2.514605548487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515229458683
                                         uncertainty =       0.025422006572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515229458683
                                         uncertainty =       0.025422006572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121276811
  error estimate for blocks of size 2^( 2) =       0.001159873571
  error estimate for blocks of size 2^( 3) =       0.001194069919
  error estimate for blocks of size 2^( 4) =       0.001217343882
  error estimate for blocks of size 2^( 5) =       0.001234674906
  error estimate for blocks of size 2^( 6) =       0.001240540148
  error estimate for blocks of size 2^( 7) =       0.001241027878

      target function =                  N/A
              le_mean =     -16.719447680922
             les_mean =     282.025764213046
             stat err =       0.001233396704
             autocorr =       1.209984719057
              std dev =       1.585750244288
             le_variance =       2.514603837260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515230317257
                                         uncertainty =       0.025422025396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515230317257
                                         uncertainty =       0.025422025396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121277001
  error estimate for blocks of size 2^( 2) =       0.001159873734
  error estimate for blocks of size 2^( 3) =       0.001194070056
  error estimate for blocks of size 2^( 4) =       0.001217343990
  error estimate for blocks of size 2^( 5) =       0.001234674998
  error estimate for blocks of size 2^( 6) =       0.001240540231
  error estimate for blocks of size 2^( 7) =       0.001241027968

      target function =                  N/A
              le_mean =     -16.719447683473
             les_mean =     282.025763060342
             stat err =       0.001233396797
             autocorr =       1.209984491171
              std dev =       1.585750513890
             le_variance =       2.514604692302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515231069487
                                         uncertainty =       0.025422041884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515231069487
                                         uncertainty =       0.025422041884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121277168
  error estimate for blocks of size 2^( 2) =       0.001159873878
  error estimate for blocks of size 2^( 3) =       0.001194070176
  error estimate for blocks of size 2^( 4) =       0.001217344085
  error estimate for blocks of size 2^( 5) =       0.001234675079
  error estimate for blocks of size 2^( 6) =       0.001240540305
  error estimate for blocks of size 2^( 7) =       0.001241028047

      target function =                  N/A
              le_mean =     -16.719447685736
             les_mean =     282.025762178533
             stat err =       0.001233396879
             autocorr =       1.209984291547
              std dev =       1.585750750098
             le_variance =       2.514605441437


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719447686062        initial  <--
     3.8147e+02     3.8147e+03             1.4182e-06       -16.719447680922
     1.5259e+03     1.5259e+04             3.5472e-07       -16.719447683473
     6.1035e+03     6.1035e+04             8.8691e-08       -16.719447685736

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.4262
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117510e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173022e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2640e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6737e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8137
    reference variance = 1.62443
====================================================
  Execution time = 1.2940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0266e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5433e+00
  Total weights = 1.945919779e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2052e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.570906823533
                                         uncertainty =       0.038311625784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.570906823533
                                         uncertainty =       0.038311625784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133662493
  error estimate for blocks of size 2^( 2) =       0.001170782496
  error estimate for blocks of size 2^( 3) =       0.001204279757
  error estimate for blocks of size 2^( 4) =       0.001226605824
  error estimate for blocks of size 2^( 5) =       0.001242138673
  error estimate for blocks of size 2^( 6) =       0.001249351358
  error estimate for blocks of size 2^( 7) =       0.001253256815

      target function =                  N/A
              le_mean =     -16.720137150963
             les_mean =     282.106275326998
             stat err =       0.001242838167
             autocorr =       1.201881380798
              std dev =       1.603266524187
             le_variance =       2.570463547580


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.672013715096e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720137150045       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720137154079       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720137154180       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+03 is 1.171945e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720137150045       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720137151053       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720137151079       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+04 is 2.930004e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720137150045       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720137150297       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720137150303       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+04 is 7.325100e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153496 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6151e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799288e-01 3 1  ON 1
ci_0003                -4.810642e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117512e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233276e-02 3 1  ON 8
ci_0010                -3.056104e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559977e-02 3 1  ON 11
ci_0013                 2.738243e-02 3 1  ON 12
ci_0014                 2.712041e-02 3 1  ON 13
ci_0015                 2.758628e-02 3 1  ON 14
ci_0016                 2.635433e-02 3 1  ON 15
ci_0017                 2.494226e-02 3 1  ON 16
ci_0018                 2.321702e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930208e-02 3 1  ON 19
ci_0021                 1.841730e-02 3 1  ON 20
ci_0022                 1.856872e-02 3 1  ON 21
ci_0023                -2.021148e-02 3 1  ON 22
ci_0024                -1.837697e-02 3 1  ON 23
ci_0025                -1.868092e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781241e-02 3 1  ON 26
ci_0028                -1.749479e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640278e-02 3 1  ON 29
ci_0031                 1.530240e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663996e-02 3 1  ON 32
ci_0034                 1.578987e-02 3 1  ON 33
ci_0035                 1.690713e-02 3 1  ON 34
ci_0036                 1.725362e-02 3 1  ON 35
ci_0037                -1.552166e-02 3 1  ON 36
ci_0038                -1.394066e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521447e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554455e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603686e-02 3 1  ON 43
ci_0045                 1.513545e-02 3 1  ON 44
ci_0046                 1.587758e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411699e-02 3 1  ON 47
ci_0049                -1.248681e-02 3 1  ON 48
ci_0050                -1.255744e-02 3 1  ON 49
ci_0051                -1.313031e-02 3 1  ON 50
ci_0052                -1.235369e-02 3 1  ON 51
ci_0053                -1.345016e-02 3 1  ON 52
ci_0054                -1.220304e-02 3 1  ON 53
ci_0055                 1.360734e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391533e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216842e-02 3 1  ON 59
ci_0061                -1.296113e-02 3 1  ON 60
ci_0062                -1.245522e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123919e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173020e-02 3 1  ON 66
ci_0068                -1.039920e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000642e-02 3 1  ON 69
ci_0071                 9.895863e-03 3 1  ON 70
ci_0072                 1.032785e-02 3 1  ON 71
ci_0073                 1.134399e-02 3 1  ON 72
ci_0074                 1.067565e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8208
    reference variance = 1.17168
====================================================
  Execution time = 1.2719e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5160e+00
  Total weights = 1.9453e+06
  Execution time = 2.2476e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544112281805
                                         uncertainty =       0.031352920442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544112281805
                                         uncertainty =       0.031352920442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127993609
  error estimate for blocks of size 2^( 2) =       0.001167147062
  error estimate for blocks of size 2^( 3) =       0.001200906043
  error estimate for blocks of size 2^( 4) =       0.001224581385
  error estimate for blocks of size 2^( 5) =       0.001239985549
  error estimate for blocks of size 2^( 6) =       0.001246576572
  error estimate for blocks of size 2^( 7) =       0.001250671056

      target function =                  N/A
              le_mean =     -16.718232409010
             les_mean =     282.015293514213
             stat err =       0.001240453640
             autocorr =       1.209338273045
              std dev =       1.595249384100
             le_variance =       2.544820597473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544112176073
                                         uncertainty =       0.031352919105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544112176073
                                         uncertainty =       0.031352919105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127993586
  error estimate for blocks of size 2^( 2) =       0.001167147043
  error estimate for blocks of size 2^( 3) =       0.001200906029
  error estimate for blocks of size 2^( 4) =       0.001224581374
  error estimate for blocks of size 2^( 5) =       0.001239985539
  error estimate for blocks of size 2^( 6) =       0.001246576563
  error estimate for blocks of size 2^( 7) =       0.001250671047

      target function =                  N/A
              le_mean =     -16.718232408686
             les_mean =     282.015293388811
             stat err =       0.001240453631
             autocorr =       1.209338304308
              std dev =       1.595249350975
             le_variance =       2.544820491786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544112228935
                                         uncertainty =       0.031352919773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544112228935
                                         uncertainty =       0.031352919773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127993598
  error estimate for blocks of size 2^( 2) =       0.001167147052
  error estimate for blocks of size 2^( 3) =       0.001200906036
  error estimate for blocks of size 2^( 4) =       0.001224581380
  error estimate for blocks of size 2^( 5) =       0.001239985544
  error estimate for blocks of size 2^( 6) =       0.001246576567
  error estimate for blocks of size 2^( 7) =       0.001250671052

      target function =                  N/A
              le_mean =     -16.718232408848
             les_mean =     282.015293451485
             stat err =       0.001240453636
             autocorr =       1.209338288678
              std dev =       1.595249367537
             le_variance =       2.544820544626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544112275196
                                         uncertainty =       0.031352920358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544112275196
                                         uncertainty =       0.031352920358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127993608
  error estimate for blocks of size 2^( 2) =       0.001167147061
  error estimate for blocks of size 2^( 3) =       0.001200906042
  error estimate for blocks of size 2^( 4) =       0.001224581385
  error estimate for blocks of size 2^( 5) =       0.001239985548
  error estimate for blocks of size 2^( 6) =       0.001246576571
  error estimate for blocks of size 2^( 7) =       0.001250671055

      target function =                  N/A
              le_mean =     -16.718232408990
             les_mean =     282.015293506369
             stat err =       0.001240453640
             autocorr =       1.209338274998
              std dev =       1.595249382030
             le_variance =       2.544820590867


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718232409010        initial  <--
     3.8147e+03     3.8147e+04             1.1719e-07       -16.718232408686
     1.5259e+04     1.5259e+05             2.9300e-08       -16.718232408848
     6.1035e+04     6.1035e+05             7.3251e-09       -16.718232408990

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0686
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117510e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173022e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0226e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6740e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.6172
    reference variance = 2.06496
====================================================
  Execution time = 1.2957e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0277e+04
  VMC Eavg = -1.6721e+01
  VMC Evar = 2.4914e+00
  Total weights = 1.945869707e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1762e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.518857808161
                                         uncertainty =       0.025169116865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.518857808161
                                         uncertainty =       0.025169116865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122035766
  error estimate for blocks of size 2^( 2) =       0.001161016506
  error estimate for blocks of size 2^( 3) =       0.001193206884
  error estimate for blocks of size 2^( 4) =       0.001216406007
  error estimate for blocks of size 2^( 5) =       0.001229435250
  error estimate for blocks of size 2^( 6) =       0.001237664429
  error estimate for blocks of size 2^( 7) =       0.001244636954

      target function =                  N/A
              le_mean =     -16.720718487441
             les_mean =     282.073808320961
             stat err =       0.001232035660
             autocorr =       1.205683048803
              std dev =       1.586823586379
             le_variance =       2.518009094289


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.672071848744e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720718486515       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720718487035       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720718487038       residual = 3.83e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+04 is 1.269875e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720718486515       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720718486645       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720718486646       residual = 3.83e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+05 is 3.174711e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720718486515       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720718486548       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720718486548       residual = 3.83e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+05 is 7.936791e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154653 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6140e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117510e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738243e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321702e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552168e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039920e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895873e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134401e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9301
    reference variance = 1.64966
====================================================
  Execution time = 1.2704e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5776e+00
  Total weights = 1.9454e+06
  Execution time = 2.2536e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.605131279974
                                         uncertainty =       0.042518670703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.605131279974
                                         uncertainty =       0.042518670703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001141205745
  error estimate for blocks of size 2^( 2) =       0.001178598838
  error estimate for blocks of size 2^( 3) =       0.001211585310
  error estimate for blocks of size 2^( 4) =       0.001233005046
  error estimate for blocks of size 2^( 5) =       0.001248723103
  error estimate for blocks of size 2^( 6) =       0.001255451991
  error estimate for blocks of size 2^( 7) =       0.001260686234

      target function =                  N/A
              le_mean =     -16.719214628348
             les_mean =     282.109744410606
             stat err =       0.001249466594
             autocorr =       1.198730069334
              std dev =       1.613934464720
             le_variance =       2.604784456411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.605131261447
                                         uncertainty =       0.042518670365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.605131261447
                                         uncertainty =       0.042518670365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001141205741
  error estimate for blocks of size 2^( 2) =       0.001178598834
  error estimate for blocks of size 2^( 3) =       0.001211585307
  error estimate for blocks of size 2^( 4) =       0.001233005043
  error estimate for blocks of size 2^( 5) =       0.001248723100
  error estimate for blocks of size 2^( 6) =       0.001255451988
  error estimate for blocks of size 2^( 7) =       0.001260686231

      target function =                  N/A
              le_mean =     -16.719214628324
             les_mean =     282.109744222453
             stat err =       0.001249466591
             autocorr =       1.198730072086
              std dev =       1.613934459140
             le_variance =       2.604784438398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.605131270710
                                         uncertainty =       0.042518670534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.605131270710
                                         uncertainty =       0.042518670534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001141205743
  error estimate for blocks of size 2^( 2) =       0.001178598836
  error estimate for blocks of size 2^( 3) =       0.001211585309
  error estimate for blocks of size 2^( 4) =       0.001233005045
  error estimate for blocks of size 2^( 5) =       0.001248723102
  error estimate for blocks of size 2^( 6) =       0.001255451990
  error estimate for blocks of size 2^( 7) =       0.001260686233

      target function =                  N/A
              le_mean =     -16.719214628336
             les_mean =     282.109744316520
             stat err =       0.001249466592
             autocorr =       1.198730070711
              std dev =       1.613934461930
             le_variance =       2.604784447404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.605131278816
                                         uncertainty =       0.042518670682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.605131278816
                                         uncertainty =       0.042518670682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001141205745
  error estimate for blocks of size 2^( 2) =       0.001178598837
  error estimate for blocks of size 2^( 3) =       0.001211585310
  error estimate for blocks of size 2^( 4) =       0.001233005046
  error estimate for blocks of size 2^( 5) =       0.001248723103
  error estimate for blocks of size 2^( 6) =       0.001255451991
  error estimate for blocks of size 2^( 7) =       0.001260686234

      target function =                  N/A
              le_mean =     -16.719214628347
             les_mean =     282.109744398844
             stat err =       0.001249466593
             autocorr =       1.198730069507
              std dev =       1.613934464371
             le_variance =       2.604784455285


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719214628348        initial  <--
     3.8147e+04     3.8147e+05             1.2699e-08       -16.719214628324
     1.5259e+05     1.5259e+06             3.1747e-09       -16.719214628336
     6.1035e+05     6.1035e+06             7.9368e-10       -16.719214628347

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0862
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117510e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173022e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0232e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6741e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8156
    reference variance = 1.60592
====================================================
  Execution time = 1.3007e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0263e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5127e+00
  Total weights = 1.945756784e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1895e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538634634458
                                         uncertainty =       0.019444604911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538634634458
                                         uncertainty =       0.019444604911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126741239
  error estimate for blocks of size 2^( 2) =       0.001165859122
  error estimate for blocks of size 2^( 3) =       0.001198962341
  error estimate for blocks of size 2^( 4) =       0.001220162171
  error estimate for blocks of size 2^( 5) =       0.001232209271
  error estimate for blocks of size 2^( 6) =       0.001241981859
  error estimate for blocks of size 2^( 7) =       0.001247539031

      target function =                  N/A
              le_mean =     -16.716710164609
             les_mean =     281.961108546089
             stat err =       0.001235473083
             autocorr =       1.202314807639
              std dev =       1.593478236763
             le_variance =       2.539172891037


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671671016461e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716710163724       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716710163780       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716710163780       residual = 4.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+05 is 1.717826e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716710163724       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716710163738       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716710163738       residual = 4.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+06 is 4.294569e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716710163724       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716710163728       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716710163728       residual = 4.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+06 is 1.073642e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155830 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6203e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117510e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173022e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8072
    reference variance = 2.57922
====================================================
  Execution time = 1.2714e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5519e+00
  Total weights = 1.9461e+06
  Execution time = 2.2489e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.580682517748
                                         uncertainty =       0.027466471914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.580682517748
                                         uncertainty =       0.027466471914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135933601
  error estimate for blocks of size 2^( 2) =       0.001173690867
  error estimate for blocks of size 2^( 3) =       0.001206104626
  error estimate for blocks of size 2^( 4) =       0.001230349723
  error estimate for blocks of size 2^( 5) =       0.001243427158
  error estimate for blocks of size 2^( 6) =       0.001251423820
  error estimate for blocks of size 2^( 7) =       0.001258407716

      target function =                  N/A
              le_mean =     -16.717040006018
             les_mean =     282.011288937661
             stat err =       0.001245902104
             autocorr =       1.202989803188
              std dev =       1.606478407780
             le_variance =       2.580772874662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.580682515944
                                         uncertainty =       0.027466471911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.580682515944
                                         uncertainty =       0.027466471911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135933601
  error estimate for blocks of size 2^( 2) =       0.001173690867
  error estimate for blocks of size 2^( 3) =       0.001206104626
  error estimate for blocks of size 2^( 4) =       0.001230349722
  error estimate for blocks of size 2^( 5) =       0.001243427158
  error estimate for blocks of size 2^( 6) =       0.001251423820
  error estimate for blocks of size 2^( 7) =       0.001258407716

      target function =                  N/A
              le_mean =     -16.717040006019
             les_mean =     282.011288937320
             stat err =       0.001245902104
             autocorr =       1.202989802930
              std dev =       1.606478407219
             le_variance =       2.580772872861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.580682516846
                                         uncertainty =       0.027466471912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.580682516846
                                         uncertainty =       0.027466471912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135933601
  error estimate for blocks of size 2^( 2) =       0.001173690867
  error estimate for blocks of size 2^( 3) =       0.001206104626
  error estimate for blocks of size 2^( 4) =       0.001230349722
  error estimate for blocks of size 2^( 5) =       0.001243427158
  error estimate for blocks of size 2^( 6) =       0.001251423820
  error estimate for blocks of size 2^( 7) =       0.001258407716

      target function =                  N/A
              le_mean =     -16.717040006019
             les_mean =     282.011288937490
             stat err =       0.001245902104
             autocorr =       1.202989803059
              std dev =       1.606478407499
             le_variance =       2.580772873761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.580682517635
                                         uncertainty =       0.027466471913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.580682517635
                                         uncertainty =       0.027466471913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135933601
  error estimate for blocks of size 2^( 2) =       0.001173690867
  error estimate for blocks of size 2^( 3) =       0.001206104626
  error estimate for blocks of size 2^( 4) =       0.001230349722
  error estimate for blocks of size 2^( 5) =       0.001243427158
  error estimate for blocks of size 2^( 6) =       0.001251423820
  error estimate for blocks of size 2^( 7) =       0.001258407716

      target function =                  N/A
              le_mean =     -16.717040006018
             les_mean =     282.011288937640
             stat err =       0.001245902104
             autocorr =       1.202989803172
              std dev =       1.606478407745
             le_variance =       2.580772874550


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717040006018        initial
     3.8147e+05     3.8147e+06             1.7178e-09       -16.717040006019  <--
     1.5259e+06     1.5259e+07             4.2946e-10       -16.717040006019
     6.1035e+06     6.1035e+07             1.0736e-10       -16.717040006018

*****************************************************************************
Applying the update for shift_i =   3.8147e+05     and shift_s =   3.8147e+06
*****************************************************************************

  Execution time = 2.4061e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0270e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6743e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.6364
    reference variance = 4.24476
====================================================
  Execution time = 1.3010e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0240e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.4817e+00
  Total weights = 1.945757916e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2766e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.511678188356
                                         uncertainty =       0.024421927898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.511678188356
                                         uncertainty =       0.024421927898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001120531475
  error estimate for blocks of size 2^( 2) =       0.001159136191
  error estimate for blocks of size 2^( 3) =       0.001192375734
  error estimate for blocks of size 2^( 4) =       0.001214592434
  error estimate for blocks of size 2^( 5) =       0.001227848514
  error estimate for blocks of size 2^( 6) =       0.001236127510
  error estimate for blocks of size 2^( 7) =       0.001241872860

      target function =                  N/A
              le_mean =     -16.719674913191
             les_mean =     282.029268489551
             stat err =       0.001230110330
             autocorr =       1.205146963759
              std dev =       1.584696163148
             le_variance =       2.511261929497


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671967491319e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719674912322       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719674912554       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719674912553       residual = 5.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+04 is 4.401556e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719674912322       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719674912380       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719674912380       residual = 5.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+05 is 1.100391e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719674912322       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719674912336       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719674912336       residual = 5.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+06 is 2.750979e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156955 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6293e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056103e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738243e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411699e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895873e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9417
    reference variance = 1.25541
====================================================
  Execution time = 1.2739e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5066e+00
  Total weights = 1.9459e+06
  Execution time = 2.2492e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529181251470
                                         uncertainty =       0.024432899119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529181251470
                                         uncertainty =       0.024432899119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125016739
  error estimate for blocks of size 2^( 2) =       0.001163678256
  error estimate for blocks of size 2^( 3) =       0.001197240100
  error estimate for blocks of size 2^( 4) =       0.001218646004
  error estimate for blocks of size 2^( 5) =       0.001230277362
  error estimate for blocks of size 2^( 6) =       0.001234312843
  error estimate for blocks of size 2^( 7) =       0.001235760244

      target function =                  N/A
              le_mean =     -16.717558743993
             les_mean =     281.983407971306
             stat err =       0.001229749113
             autocorr =       1.194854621763
              std dev =       1.591039385576
             le_variance =       2.531406326453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529181251567
                                         uncertainty =       0.024432899098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529181251567
                                         uncertainty =       0.024432899098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125016739
  error estimate for blocks of size 2^( 2) =       0.001163678256
  error estimate for blocks of size 2^( 3) =       0.001197240099
  error estimate for blocks of size 2^( 4) =       0.001218646004
  error estimate for blocks of size 2^( 5) =       0.001230277361
  error estimate for blocks of size 2^( 6) =       0.001234312842
  error estimate for blocks of size 2^( 7) =       0.001235760243

      target function =                  N/A
              le_mean =     -16.717558743847
             les_mean =     281.983407991073
             stat err =       0.001229749113
             autocorr =       1.194854620506
              std dev =       1.591039385608
             le_variance =       2.531406326557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529181251518
                                         uncertainty =       0.024432899108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529181251518
                                         uncertainty =       0.024432899108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125016739
  error estimate for blocks of size 2^( 2) =       0.001163678256
  error estimate for blocks of size 2^( 3) =       0.001197240100
  error estimate for blocks of size 2^( 4) =       0.001218646004
  error estimate for blocks of size 2^( 5) =       0.001230277361
  error estimate for blocks of size 2^( 6) =       0.001234312842
  error estimate for blocks of size 2^( 7) =       0.001235760244

      target function =                  N/A
              le_mean =     -16.717558743920
             les_mean =     281.983407981189
             stat err =       0.001229749113
             autocorr =       1.194854621134
              std dev =       1.591039385592
             le_variance =       2.531406326505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529181251476
                                         uncertainty =       0.024432899117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529181251476
                                         uncertainty =       0.024432899117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125016739
  error estimate for blocks of size 2^( 2) =       0.001163678256
  error estimate for blocks of size 2^( 3) =       0.001197240100
  error estimate for blocks of size 2^( 4) =       0.001218646004
  error estimate for blocks of size 2^( 5) =       0.001230277362
  error estimate for blocks of size 2^( 6) =       0.001234312843
  error estimate for blocks of size 2^( 7) =       0.001235760244

      target function =                  N/A
              le_mean =     -16.717558743984
             les_mean =     281.983407972542
             stat err =       0.001229749113
             autocorr =       1.194854621685
              std dev =       1.591039385578
             le_variance =       2.531406326460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717558743993        initial  <--
     9.5367e+04     9.5367e+05             4.4016e-09       -16.717558743847
     3.8147e+05     3.8147e+06             1.1004e-09       -16.717558743920
     1.5259e+06     1.5259e+07             2.7510e-10       -16.717558743984

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1244
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0423e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6745e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.6513
    reference variance = 1.82116
====================================================
  Execution time = 1.3033e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0225e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5122e+00
  Total weights = 1.945399384e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1948e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540584371930
                                         uncertainty =       0.031738608591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540584371930
                                         uncertainty =       0.031738608591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126968520
  error estimate for blocks of size 2^( 2) =       0.001166261609
  error estimate for blocks of size 2^( 3) =       0.001199296228
  error estimate for blocks of size 2^( 4) =       0.001221665292
  error estimate for blocks of size 2^( 5) =       0.001234771426
  error estimate for blocks of size 2^( 6) =       0.001241283804
  error estimate for blocks of size 2^( 7) =       0.001248218658

      target function =                  N/A
              le_mean =     -16.719182347839
             les_mean =     282.043301742571
             stat err =       0.001236484795
             autocorr =       1.203799035450
              std dev =       1.593799664855
             le_variance =       2.540197371692


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671918234784e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719182346934       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719182346958       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719182346959       residual = 4.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+05 is 4.750039e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719182346934       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719182346940       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719182346940       residual = 4.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+06 is 1.187510e-10

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719182346934       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719182346936       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719182346936       residual = 4.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+07 is 2.968775e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158097 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6234e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.5287
    reference variance = 3.02489
====================================================
  Execution time = 1.2672e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5831e+00
  Total weights = 1.9459e+06
  Execution time = 2.2499e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.610024391258
                                         uncertainty =       0.036180085599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.610024391258
                                         uncertainty =       0.036180085599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001142331066
  error estimate for blocks of size 2^( 2) =       0.001181157077
  error estimate for blocks of size 2^( 3) =       0.001214210479
  error estimate for blocks of size 2^( 4) =       0.001237458374
  error estimate for blocks of size 2^( 5) =       0.001251406507
  error estimate for blocks of size 2^( 6) =       0.001257961525
  error estimate for blocks of size 2^( 7) =       0.001258412803

      target function =                  N/A
              le_mean =     -16.715518290410
             les_mean =     281.991609280353
             stat err =       0.001251309802
             autocorr =       1.199901836932
              std dev =       1.615525933422
             le_variance =       2.609924041558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.610024391367
                                         uncertainty =       0.036180085590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.610024391367
                                         uncertainty =       0.036180085590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001142331066
  error estimate for blocks of size 2^( 2) =       0.001181157077
  error estimate for blocks of size 2^( 3) =       0.001214210479
  error estimate for blocks of size 2^( 4) =       0.001237458374
  error estimate for blocks of size 2^( 5) =       0.001251406507
  error estimate for blocks of size 2^( 6) =       0.001257961525
  error estimate for blocks of size 2^( 7) =       0.001258412803

      target function =                  N/A
              le_mean =     -16.715518290407
             les_mean =     281.991609279480
             stat err =       0.001251309802
             autocorr =       1.199901836978
              std dev =       1.615525933456
             le_variance =       2.609924041668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.610024391312
                                         uncertainty =       0.036180085595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.610024391312
                                         uncertainty =       0.036180085595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001142331066
  error estimate for blocks of size 2^( 2) =       0.001181157077
  error estimate for blocks of size 2^( 3) =       0.001214210479
  error estimate for blocks of size 2^( 4) =       0.001237458374
  error estimate for blocks of size 2^( 5) =       0.001251406507
  error estimate for blocks of size 2^( 6) =       0.001257961525
  error estimate for blocks of size 2^( 7) =       0.001258412803

      target function =                  N/A
              le_mean =     -16.715518290408
             les_mean =     281.991609279916
             stat err =       0.001251309802
             autocorr =       1.199901836955
              std dev =       1.615525933439
             le_variance =       2.609924041613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.610024391264
                                         uncertainty =       0.036180085598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.610024391264
                                         uncertainty =       0.036180085598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001142331066
  error estimate for blocks of size 2^( 2) =       0.001181157077
  error estimate for blocks of size 2^( 3) =       0.001214210479
  error estimate for blocks of size 2^( 4) =       0.001237458374
  error estimate for blocks of size 2^( 5) =       0.001251406507
  error estimate for blocks of size 2^( 6) =       0.001257961525
  error estimate for blocks of size 2^( 7) =       0.001258412803

      target function =                  N/A
              le_mean =     -16.715518290410
             les_mean =     281.991609280298
             stat err =       0.001251309802
             autocorr =       1.199901836935
              std dev =       1.615525933424
             le_variance =       2.609924041565


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.715518290410        initial  <--
     9.5367e+05     9.5367e+06             4.7500e-10       -16.715518290407
     3.8147e+06     3.8147e+07             1.1875e-10       -16.715518290408
     1.5259e+07     1.5259e+08             2.9688e-11       -16.715518290410

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0375
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0277e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6740e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.5301
    reference variance = 2.58969
====================================================
  Execution time = 1.2997e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0265e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.4911e+00
  Total weights = 1.945412801e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1959e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.519116050606
                                         uncertainty =       0.028741635299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.519116050606
                                         uncertainty =       0.028741635299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122327961
  error estimate for blocks of size 2^( 2) =       0.001160622536
  error estimate for blocks of size 2^( 3) =       0.001193355190
  error estimate for blocks of size 2^( 4) =       0.001216862288
  error estimate for blocks of size 2^( 5) =       0.001231465553
  error estimate for blocks of size 2^( 6) =       0.001235349729
  error estimate for blocks of size 2^( 7) =       0.001238697894

      target function =                  N/A
              le_mean =     -16.718118315224
             les_mean =     281.986573790152
             stat err =       0.001230593866
             autocorr =       1.202236548484
              std dev =       1.587236818639
             le_variance =       2.519320718442


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671811831522e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718118314354       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718118314356       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718118314356       residual = 2.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+06 is 5.600600e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718118314354       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718118314354       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718118314354       residual = 2.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+07 is 1.400150e-11

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718118314354       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718118314354       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718118314354       residual = 2.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+08 is 3.500375e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159273 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6200e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9756
    reference variance = 1.34247
====================================================
  Execution time = 1.2728e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5422e+00
  Total weights = 1.9457e+06
  Execution time = 2.2561e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.570271629213
                                         uncertainty =       0.047451600656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.570271629213
                                         uncertainty =       0.047451600656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133571473
  error estimate for blocks of size 2^( 2) =       0.001172160944
  error estimate for blocks of size 2^( 3) =       0.001205853151
  error estimate for blocks of size 2^( 4) =       0.001227842180
  error estimate for blocks of size 2^( 5) =       0.001241818425
  error estimate for blocks of size 2^( 6) =       0.001245627935
  error estimate for blocks of size 2^( 7) =       0.001257031729

      target function =                  N/A
              le_mean =     -16.717769980227
             les_mean =     282.026000399112
             stat err =       0.001243080067
             autocorr =       1.202542374708
              std dev =       1.603137800813
             le_variance =       2.570050808395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.570271629241
                                         uncertainty =       0.047451600657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.570271629241
                                         uncertainty =       0.047451600657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133571473
  error estimate for blocks of size 2^( 2) =       0.001172160944
  error estimate for blocks of size 2^( 3) =       0.001205853151
  error estimate for blocks of size 2^( 4) =       0.001227842180
  error estimate for blocks of size 2^( 5) =       0.001241818425
  error estimate for blocks of size 2^( 6) =       0.001245627935
  error estimate for blocks of size 2^( 7) =       0.001257031729

      target function =                  N/A
              le_mean =     -16.717769980226
             les_mean =     282.026000399134
             stat err =       0.001243080067
             autocorr =       1.202542374699
              std dev =       1.603137800821
             le_variance =       2.570050808423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.570271629227
                                         uncertainty =       0.047451600656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.570271629227
                                         uncertainty =       0.047451600656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133571473
  error estimate for blocks of size 2^( 2) =       0.001172160944
  error estimate for blocks of size 2^( 3) =       0.001205853151
  error estimate for blocks of size 2^( 4) =       0.001227842180
  error estimate for blocks of size 2^( 5) =       0.001241818425
  error estimate for blocks of size 2^( 6) =       0.001245627935
  error estimate for blocks of size 2^( 7) =       0.001257031729

      target function =                  N/A
              le_mean =     -16.717769980226
             les_mean =     282.026000399123
             stat err =       0.001243080067
             autocorr =       1.202542374704
              std dev =       1.603137800817
             le_variance =       2.570050808409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.570271629215
                                         uncertainty =       0.047451600656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.570271629215
                                         uncertainty =       0.047451600656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133571473
  error estimate for blocks of size 2^( 2) =       0.001172160944
  error estimate for blocks of size 2^( 3) =       0.001205853151
  error estimate for blocks of size 2^( 4) =       0.001227842180
  error estimate for blocks of size 2^( 5) =       0.001241818425
  error estimate for blocks of size 2^( 6) =       0.001245627935
  error estimate for blocks of size 2^( 7) =       0.001257031729

      target function =                  N/A
              le_mean =     -16.717769980226
             les_mean =     282.026000399113
             stat err =       0.001243080067
             autocorr =       1.202542374708
              std dev =       1.603137800813
             le_variance =       2.570050808397


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717769980227        initial  <--
     9.5367e+06     9.5367e+07             5.6006e-11       -16.717769980226
     3.8147e+07     3.8147e+08             1.4001e-11       -16.717769980226
     1.5259e+08     1.5259e+09             3.5004e-12       -16.717769980226

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1193
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0325e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6740e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.5101
    reference variance = 4.9765
====================================================
  Execution time = 1.2941e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0290e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5333e+00
  Total weights = 1.945557438e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1904e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556309960398
                                         uncertainty =       0.025091499070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556309960398
                                         uncertainty =       0.025091499070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130670875
  error estimate for blocks of size 2^( 2) =       0.001169954383
  error estimate for blocks of size 2^( 3) =       0.001202467007
  error estimate for blocks of size 2^( 4) =       0.001225830401
  error estimate for blocks of size 2^( 5) =       0.001237395001
  error estimate for blocks of size 2^( 6) =       0.001242103243
  error estimate for blocks of size 2^( 7) =       0.001243784030

      target function =                  N/A
              le_mean =     -16.718220707743
             les_mean =     282.032206165957
             stat err =       0.001237278169
             autocorr =       1.197463514516
              std dev =       1.599035669694
             le_variance =       2.556915072953


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671822070774e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718220706833       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718220706834       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718220706834       residual = 3.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+07 is 6.549841e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718220706833       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718220706833       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718220706833       residual = 3.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+08 is 1.637446e-12

solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718220706833       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718220706833       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718220706833       residual = 3.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+09 is 4.093673e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160389 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6138e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.701
    reference variance = 2.97167
====================================================
  Execution time = 1.2736e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5309e+00
  Total weights = 1.9451e+06
  Execution time = 2.2552e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559272614205
                                         uncertainty =       0.027290244614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559272614205
                                         uncertainty =       0.027290244614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131100952
  error estimate for blocks of size 2^( 2) =       0.001169680947
  error estimate for blocks of size 2^( 3) =       0.001202949891
  error estimate for blocks of size 2^( 4) =       0.001227721841
  error estimate for blocks of size 2^( 5) =       0.001240077276
  error estimate for blocks of size 2^( 6) =       0.001248591429
  error estimate for blocks of size 2^( 7) =       0.001252765963

      target function =                  N/A
              le_mean =     -16.718688252738
             les_mean =     282.045479979927
             stat err =       0.001242289127
             autocorr =       1.206264738821
              std dev =       1.599643900020
             le_variance =       2.558860606870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559272614198
                                         uncertainty =       0.027290244614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559272614198
                                         uncertainty =       0.027290244614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131100952
  error estimate for blocks of size 2^( 2) =       0.001169680947
  error estimate for blocks of size 2^( 3) =       0.001202949891
  error estimate for blocks of size 2^( 4) =       0.001227721841
  error estimate for blocks of size 2^( 5) =       0.001240077276
  error estimate for blocks of size 2^( 6) =       0.001248591429
  error estimate for blocks of size 2^( 7) =       0.001252765963

      target function =                  N/A
              le_mean =     -16.718688252738
             les_mean =     282.045479979991
             stat err =       0.001242289127
             autocorr =       1.206264738823
              std dev =       1.599643900018
             le_variance =       2.558860606863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559272614201
                                         uncertainty =       0.027290244614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559272614201
                                         uncertainty =       0.027290244614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131100952
  error estimate for blocks of size 2^( 2) =       0.001169680947
  error estimate for blocks of size 2^( 3) =       0.001202949891
  error estimate for blocks of size 2^( 4) =       0.001227721841
  error estimate for blocks of size 2^( 5) =       0.001240077276
  error estimate for blocks of size 2^( 6) =       0.001248591429
  error estimate for blocks of size 2^( 7) =       0.001252765963

      target function =                  N/A
              le_mean =     -16.718688252738
             les_mean =     282.045479979959
             stat err =       0.001242289127
             autocorr =       1.206264738822
              std dev =       1.599643900019
             le_variance =       2.558860606867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559272614205
                                         uncertainty =       0.027290244614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559272614205
                                         uncertainty =       0.027290244614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131100952
  error estimate for blocks of size 2^( 2) =       0.001169680947
  error estimate for blocks of size 2^( 3) =       0.001202949891
  error estimate for blocks of size 2^( 4) =       0.001227721841
  error estimate for blocks of size 2^( 5) =       0.001240077276
  error estimate for blocks of size 2^( 6) =       0.001248591429
  error estimate for blocks of size 2^( 7) =       0.001252765963

      target function =                  N/A
              le_mean =     -16.718688252738
             les_mean =     282.045479979931
             stat err =       0.001242289127
             autocorr =       1.206264738822
              std dev =       1.599643900020
             le_variance =       2.558860606870


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718688252738        initial
     9.5367e+07     9.5367e+08             6.5498e-12       -16.718688252738
     3.8147e+08     3.8147e+09             1.6374e-12       -16.718688252738  <--
     1.5259e+09     1.5259e+10             4.0937e-13       -16.718688252738

*****************************************************************************
Applying the update for shift_i =   3.8147e+08     and shift_s =   3.8147e+09
*****************************************************************************

  Execution time = 2.7000e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3144e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6736e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.5766
    reference variance = 2.45442
====================================================
  Execution time = 1.2993e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0276e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5670e+00
  Total weights = 1.945365576e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1821e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.594353098517
                                         uncertainty =       0.061506728894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.594353098517
                                         uncertainty =       0.061506728894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139013439
  error estimate for blocks of size 2^( 2) =       0.001176249510
  error estimate for blocks of size 2^( 3) =       0.001207722745
  error estimate for blocks of size 2^( 4) =       0.001231354857
  error estimate for blocks of size 2^( 5) =       0.001246706977
  error estimate for blocks of size 2^( 6) =       0.001254610810
  error estimate for blocks of size 2^( 7) =       0.001259394325

      target function =                  N/A
              le_mean =     -16.716645813380
             les_mean =     282.013276281940
             stat err =       0.001248016743
             autocorr =       1.200557946802
              std dev =       1.610834025530
             le_variance =       2.594786257806


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671664581338e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716645812428       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716645812428       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716645812428       residual = 2.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+07 is 4.411518e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716645812428       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716645812428       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716645812428       residual = 2.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+08 is 1.102880e-12

solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716645812428       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716645812428       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716645812428       residual = 2.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+09 is 2.756968e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161530 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6184e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.6101
    reference variance = 4.24143
====================================================
  Execution time = 1.2708e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.6286e+00
  Total weights = 1.9459e+06
  Execution time = 2.2467e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.661102281917
                                         uncertainty =       0.090712721221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.661102281917
                                         uncertainty =       0.090712721221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001153359375
  error estimate for blocks of size 2^( 2) =       0.001191683569
  error estimate for blocks of size 2^( 3) =       0.001224277276
  error estimate for blocks of size 2^( 4) =       0.001248784659
  error estimate for blocks of size 2^( 5) =       0.001267022848
  error estimate for blocks of size 2^( 6) =       0.001277173406
  error estimate for blocks of size 2^( 7) =       0.001286813904

      target function =                  N/A
              le_mean =     -16.717855419046
             les_mean =     282.115260383282
             stat err =       0.001269948704
             autocorr =       1.212391989244
              std dev =       1.631122568146
             le_variance =       2.660560832314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.661102281913
                                         uncertainty =       0.090712721221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.661102281913
                                         uncertainty =       0.090712721221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001153359375
  error estimate for blocks of size 2^( 2) =       0.001191683569
  error estimate for blocks of size 2^( 3) =       0.001224277276
  error estimate for blocks of size 2^( 4) =       0.001248784659
  error estimate for blocks of size 2^( 5) =       0.001267022848
  error estimate for blocks of size 2^( 6) =       0.001277173406
  error estimate for blocks of size 2^( 7) =       0.001286813904

      target function =                  N/A
              le_mean =     -16.717855419046
             les_mean =     282.115260383312
             stat err =       0.001269948704
             autocorr =       1.212391989245
              std dev =       1.631122568145
             le_variance =       2.660560832311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.661102281915
                                         uncertainty =       0.090712721221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.661102281915
                                         uncertainty =       0.090712721221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001153359375
  error estimate for blocks of size 2^( 2) =       0.001191683569
  error estimate for blocks of size 2^( 3) =       0.001224277276
  error estimate for blocks of size 2^( 4) =       0.001248784659
  error estimate for blocks of size 2^( 5) =       0.001267022848
  error estimate for blocks of size 2^( 6) =       0.001277173406
  error estimate for blocks of size 2^( 7) =       0.001286813904

      target function =                  N/A
              le_mean =     -16.717855419046
             les_mean =     282.115260383297
             stat err =       0.001269948704
             autocorr =       1.212391989244
              std dev =       1.631122568145
             le_variance =       2.660560832312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.661102281916
                                         uncertainty =       0.090712721221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.661102281916
                                         uncertainty =       0.090712721221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001153359375
  error estimate for blocks of size 2^( 2) =       0.001191683569
  error estimate for blocks of size 2^( 3) =       0.001224277276
  error estimate for blocks of size 2^( 4) =       0.001248784659
  error estimate for blocks of size 2^( 5) =       0.001267022848
  error estimate for blocks of size 2^( 6) =       0.001277173406
  error estimate for blocks of size 2^( 7) =       0.001286813904

      target function =                  N/A
              le_mean =     -16.717855419046
             les_mean =     282.115260383283
             stat err =       0.001269948704
             autocorr =       1.212391989244
              std dev =       1.631122568146
             le_variance =       2.660560832314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717855419046        initial  <--
     9.5367e+07     9.5367e+08             4.4115e-12       -16.717855419046
     3.8147e+08     3.8147e+09             1.1029e-12       -16.717855419046
     1.5259e+09     1.5259e+10             2.7570e-13       -16.717855419046

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0713
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0261e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6732e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.0475
    reference variance = 1.66233
====================================================
  Execution time = 1.3032e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0256e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5312e+00
  Total weights = 1.945657482e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1932e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554032668616
                                         uncertainty =       0.025911569641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554032668616
                                         uncertainty =       0.025911569641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129949784
  error estimate for blocks of size 2^( 2) =       0.001168010839
  error estimate for blocks of size 2^( 3) =       0.001201337072
  error estimate for blocks of size 2^( 4) =       0.001224474897
  error estimate for blocks of size 2^( 5) =       0.001238085957
  error estimate for blocks of size 2^( 6) =       0.001248202250
  error estimate for blocks of size 2^( 7) =       0.001252044184

      target function =                  N/A
              le_mean =     -16.717622054925
             les_mean =     282.010091629154
             stat err =       0.001240701822
             autocorr =       1.205636960478
              std dev =       1.598015876359
             le_variance =       2.553654741094


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671762205493e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717622054021       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717622054021       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717622054021       residual = 1.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+08 is 4.772774e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717622054021       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717622054021       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717622054021       residual = 1.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+09 is 1.193194e-13

solving harmonic davidson linear method for identity shift 1.5259e+10, overlap shift 1.5259e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717622054021       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717622054021       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717622054021       residual = 1.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+10 is 2.982984e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162693 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6232e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.7842
    reference variance = 1.70991
====================================================
  Execution time = 1.2727e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5077e+00
  Total weights = 1.9459e+06
  Execution time = 2.2512e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533475546432
                                         uncertainty =       0.023804256668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533475546432
                                         uncertainty =       0.023804256668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125357519
  error estimate for blocks of size 2^( 2) =       0.001164247967
  error estimate for blocks of size 2^( 3) =       0.001199032273
  error estimate for blocks of size 2^( 4) =       0.001222078654
  error estimate for blocks of size 2^( 5) =       0.001235756433
  error estimate for blocks of size 2^( 6) =       0.001239135972
  error estimate for blocks of size 2^( 7) =       0.001244739206

      target function =                  N/A
              le_mean =     -16.716700351363
             les_mean =     281.955727418354
             stat err =       0.001235427566
             autocorr =       1.205184509917
              std dev =       1.591521329498
             le_variance =       2.532940142247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533475546432
                                         uncertainty =       0.023804256668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533475546432
                                         uncertainty =       0.023804256668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125357519
  error estimate for blocks of size 2^( 2) =       0.001164247967
  error estimate for blocks of size 2^( 3) =       0.001199032273
  error estimate for blocks of size 2^( 4) =       0.001222078654
  error estimate for blocks of size 2^( 5) =       0.001235756433
  error estimate for blocks of size 2^( 6) =       0.001239135972
  error estimate for blocks of size 2^( 7) =       0.001244739206

      target function =                  N/A
              le_mean =     -16.716700351363
             les_mean =     281.955727418354
             stat err =       0.001235427566
             autocorr =       1.205184509916
              std dev =       1.591521329498
             le_variance =       2.532940142247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533475546432
                                         uncertainty =       0.023804256668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533475546432
                                         uncertainty =       0.023804256668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125357519
  error estimate for blocks of size 2^( 2) =       0.001164247967
  error estimate for blocks of size 2^( 3) =       0.001199032273
  error estimate for blocks of size 2^( 4) =       0.001222078654
  error estimate for blocks of size 2^( 5) =       0.001235756433
  error estimate for blocks of size 2^( 6) =       0.001239135972
  error estimate for blocks of size 2^( 7) =       0.001244739206

      target function =                  N/A
              le_mean =     -16.716700351363
             les_mean =     281.955727418354
             stat err =       0.001235427566
             autocorr =       1.205184509915
              std dev =       1.591521329498
             le_variance =       2.532940142247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533475546432
                                         uncertainty =       0.023804256668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533475546432
                                         uncertainty =       0.023804256668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125357519
  error estimate for blocks of size 2^( 2) =       0.001164247967
  error estimate for blocks of size 2^( 3) =       0.001199032273
  error estimate for blocks of size 2^( 4) =       0.001222078654
  error estimate for blocks of size 2^( 5) =       0.001235756433
  error estimate for blocks of size 2^( 6) =       0.001239135972
  error estimate for blocks of size 2^( 7) =       0.001244739206

      target function =                  N/A
              le_mean =     -16.716700351363
             les_mean =     281.955727418354
             stat err =       0.001235427566
             autocorr =       1.205184509916
              std dev =       1.591521329498
             le_variance =       2.532940142247


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716700351363        initial  <--
     9.5367e+08     9.5367e+09             4.7728e-13       -16.716700351363
     3.8147e+09     3.8147e+10             1.1932e-13       -16.716700351363
     1.5259e+10     1.5259e+11             2.9830e-14       -16.716700351363

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0955
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0334e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6737e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8397
    reference variance = 1.93065
====================================================
  Execution time = 1.2977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0255e+04
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5730e+00
  Total weights = 1.945845226e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1720e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.599765670761
                                         uncertainty =       0.041423389884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.599765670761
                                         uncertainty =       0.041423389884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140021487
  error estimate for blocks of size 2^( 2) =       0.001178275439
  error estimate for blocks of size 2^( 3) =       0.001209888025
  error estimate for blocks of size 2^( 4) =       0.001232505926
  error estimate for blocks of size 2^( 5) =       0.001243505540
  error estimate for blocks of size 2^( 6) =       0.001251436782
  error estimate for blocks of size 2^( 7) =       0.001261425500

      target function =                  N/A
              le_mean =     -16.715926919790
             les_mean =     281.995194457540
             stat err =       0.001247218437
             autocorr =       1.196903040314
              std dev =       1.612259644486
             le_variance =       2.599381161238


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671592691979e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715926918892       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715926918892       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715926918892       residual = 1.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+09 is 4.424012e-14

solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715926918892       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715926918892       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715926918892       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+10 is 1.103774e-14

solving harmonic davidson linear method for identity shift 1.5259e+11, overlap shift 1.5259e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715926918892       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715926918892       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715926918892       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+11 is 2.759434e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163803 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6155e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8101
    reference variance = 1.46202
====================================================
  Execution time = 1.2728e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5613e+00
  Total weights = 1.9455e+06
  Execution time = 2.2525e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592130008687
                                         uncertainty =       0.032448616257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592130008687
                                         uncertainty =       0.032448616257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138316358
  error estimate for blocks of size 2^( 2) =       0.001175783386
  error estimate for blocks of size 2^( 3) =       0.001209136525
  error estimate for blocks of size 2^( 4) =       0.001230788239
  error estimate for blocks of size 2^( 5) =       0.001248753471
  error estimate for blocks of size 2^( 6) =       0.001259795335
  error estimate for blocks of size 2^( 7) =       0.001265322847

      target function =                  N/A
              le_mean =     -16.717525360170
             les_mean =     282.036994374558
             stat err =       0.001251164973
             autocorr =       1.208100882775
              std dev =       1.609848188516
             le_variance =       2.591611190069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592130008687
                                         uncertainty =       0.032448616257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592130008687
                                         uncertainty =       0.032448616257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138316358
  error estimate for blocks of size 2^( 2) =       0.001175783386
  error estimate for blocks of size 2^( 3) =       0.001209136525
  error estimate for blocks of size 2^( 4) =       0.001230788239
  error estimate for blocks of size 2^( 5) =       0.001248753471
  error estimate for blocks of size 2^( 6) =       0.001259795335
  error estimate for blocks of size 2^( 7) =       0.001265322847

      target function =                  N/A
              le_mean =     -16.717525360170
             les_mean =     282.036994374558
             stat err =       0.001251164973
             autocorr =       1.208100882775
              std dev =       1.609848188516
             le_variance =       2.591611190069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592130008687
                                         uncertainty =       0.032448616257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592130008687
                                         uncertainty =       0.032448616257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138316358
  error estimate for blocks of size 2^( 2) =       0.001175783386
  error estimate for blocks of size 2^( 3) =       0.001209136525
  error estimate for blocks of size 2^( 4) =       0.001230788239
  error estimate for blocks of size 2^( 5) =       0.001248753471
  error estimate for blocks of size 2^( 6) =       0.001259795335
  error estimate for blocks of size 2^( 7) =       0.001265322847

      target function =                  N/A
              le_mean =     -16.717525360170
             les_mean =     282.036994374558
             stat err =       0.001251164973
             autocorr =       1.208100882774
              std dev =       1.609848188516
             le_variance =       2.591611190069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592130008687
                                         uncertainty =       0.032448616257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592130008687
                                         uncertainty =       0.032448616257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138316358
  error estimate for blocks of size 2^( 2) =       0.001175783386
  error estimate for blocks of size 2^( 3) =       0.001209136525
  error estimate for blocks of size 2^( 4) =       0.001230788239
  error estimate for blocks of size 2^( 5) =       0.001248753471
  error estimate for blocks of size 2^( 6) =       0.001259795335
  error estimate for blocks of size 2^( 7) =       0.001265322847

      target function =                  N/A
              le_mean =     -16.717525360170
             les_mean =     282.036994374558
             stat err =       0.001251164973
             autocorr =       1.208100882774
              std dev =       1.609848188516
             le_variance =       2.591611190069


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717525360170        initial  <--
     9.5367e+09     9.5367e+10             4.4240e-14       -16.717525360170
     3.8147e+10     3.8147e+11             1.1038e-14       -16.717525360170
     1.5259e+11     1.5259e+12             2.7594e-15       -16.717525360170

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1348
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0296e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6740e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.4679
    reference variance = 2.01502
====================================================
  Execution time = 1.3052e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0276e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5899e+00
  Total weights = 1.945796582e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1852e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621678911997
                                         uncertainty =       0.092314168986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621678911997
                                         uncertainty =       0.092314168986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144852593
  error estimate for blocks of size 2^( 2) =       0.001182998126
  error estimate for blocks of size 2^( 3) =       0.001215860633
  error estimate for blocks of size 2^( 4) =       0.001239053534
  error estimate for blocks of size 2^( 5) =       0.001257508140
  error estimate for blocks of size 2^( 6) =       0.001267625513
  error estimate for blocks of size 2^( 7) =       0.001274725446

      target function =                  N/A
              le_mean =     -16.716772039657
             les_mean =     282.040405733526
             stat err =       0.001259728158
             autocorr =       1.210750146808
              std dev =       1.619091968093
             le_variance =       2.621458801142


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671677203966e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716772038723       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716772038723       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716772038723       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+10 is 5.655534e-15

solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716772038723       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716772038723       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716772038723       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+11 is 1.413884e-15

solving harmonic davidson linear method for identity shift 1.5259e+12, overlap shift 1.5259e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716772038723       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716772038723       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716772038723       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+12 is 3.534709e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164969 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6243e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.6424
    reference variance = 1.9324
====================================================
  Execution time = 1.2710e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5249e+00
  Total weights = 1.9458e+06
  Execution time = 2.2628e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551912576846
                                         uncertainty =       0.040872658386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551912576846
                                         uncertainty =       0.040872658386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129506890
  error estimate for blocks of size 2^( 2) =       0.001167807932
  error estimate for blocks of size 2^( 3) =       0.001202106661
  error estimate for blocks of size 2^( 4) =       0.001224669816
  error estimate for blocks of size 2^( 5) =       0.001240386662
  error estimate for blocks of size 2^( 6) =       0.001249577625
  error estimate for blocks of size 2^( 7) =       0.001254517733

      target function =                  N/A
              le_mean =     -16.719960184372
             les_mean =     282.081924868586
             stat err =       0.001242287959
             autocorr =       1.209669645881
              std dev =       1.597389519657
             le_variance =       2.551653277509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551912576846
                                         uncertainty =       0.040872658386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551912576846
                                         uncertainty =       0.040872658386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129506890
  error estimate for blocks of size 2^( 2) =       0.001167807932
  error estimate for blocks of size 2^( 3) =       0.001202106661
  error estimate for blocks of size 2^( 4) =       0.001224669816
  error estimate for blocks of size 2^( 5) =       0.001240386662
  error estimate for blocks of size 2^( 6) =       0.001249577625
  error estimate for blocks of size 2^( 7) =       0.001254517733

      target function =                  N/A
              le_mean =     -16.719960184372
             les_mean =     282.081924868586
             stat err =       0.001242287959
             autocorr =       1.209669645881
              std dev =       1.597389519657
             le_variance =       2.551653277509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551912576846
                                         uncertainty =       0.040872658386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551912576846
                                         uncertainty =       0.040872658386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129506890
  error estimate for blocks of size 2^( 2) =       0.001167807932
  error estimate for blocks of size 2^( 3) =       0.001202106661
  error estimate for blocks of size 2^( 4) =       0.001224669816
  error estimate for blocks of size 2^( 5) =       0.001240386662
  error estimate for blocks of size 2^( 6) =       0.001249577625
  error estimate for blocks of size 2^( 7) =       0.001254517733

      target function =                  N/A
              le_mean =     -16.719960184372
             les_mean =     282.081924868586
             stat err =       0.001242287959
             autocorr =       1.209669645881
              std dev =       1.597389519657
             le_variance =       2.551653277508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551912576846
                                         uncertainty =       0.040872658386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551912576846
                                         uncertainty =       0.040872658386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129506890
  error estimate for blocks of size 2^( 2) =       0.001167807932
  error estimate for blocks of size 2^( 3) =       0.001202106661
  error estimate for blocks of size 2^( 4) =       0.001224669816
  error estimate for blocks of size 2^( 5) =       0.001240386662
  error estimate for blocks of size 2^( 6) =       0.001249577625
  error estimate for blocks of size 2^( 7) =       0.001254517733

      target function =                  N/A
              le_mean =     -16.719960184372
             les_mean =     282.081924868586
             stat err =       0.001242287959
             autocorr =       1.209669645880
              std dev =       1.597389519657
             le_variance =       2.551653277509


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719960184372        initial  <--
     9.5367e+10     9.5367e+11             5.6555e-15       -16.719960184372
     3.8147e+11     3.8147e+12             1.4139e-15       -16.719960184372
     1.5259e+12     1.5259e+13             3.5347e-16       -16.719960184372

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0953
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0344e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6735e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.5395
    reference variance = 2.42229
====================================================
  Execution time = 1.3016e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0251e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5214e+00
  Total weights = 1.945743853e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1753e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553048345449
                                         uncertainty =       0.026393672485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553048345449
                                         uncertainty =       0.026393672485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129666090
  error estimate for blocks of size 2^( 2) =       0.001168030880
  error estimate for blocks of size 2^( 3) =       0.001200839020
  error estimate for blocks of size 2^( 4) =       0.001223331585
  error estimate for blocks of size 2^( 5) =       0.001238158470
  error estimate for blocks of size 2^( 6) =       0.001243237275
  error estimate for blocks of size 2^( 7) =       0.001248549622

      target function =                  N/A
              le_mean =     -16.717205081369
             les_mean =     281.986364652921
             stat err =       0.001238319238
             autocorr =       1.201614208014
              std dev =       1.597614667181
             le_variance =       2.552372624793


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671720508137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717205080468       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717205080468       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717205080468       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+11 is 5.926319e-16

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717205080468       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717205080468       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717205080468       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717749075379       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.725315273965       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.605288647345       residual = 2.86e+02           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+12 is 1.489037e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+13, overlap shift 1.5259e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717205080468       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717205080468       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.34e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166804 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6199e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.6231
    reference variance = 6.01167
====================================================
  Execution time = 1.2718e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.4926e+00
  Total weights = 1.9455e+06
  Execution time = 2.2369e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.520100026485
                                         uncertainty =       0.021621092103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.520100026485
                                         uncertainty =       0.021621092103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122564875
  error estimate for blocks of size 2^( 2) =       0.001161611124
  error estimate for blocks of size 2^( 3) =       0.001195770197
  error estimate for blocks of size 2^( 4) =       0.001218070519
  error estimate for blocks of size 2^( 5) =       0.001233598624
  error estimate for blocks of size 2^( 6) =       0.001243102690
  error estimate for blocks of size 2^( 7) =       0.001252867299

      target function =                  N/A
              le_mean =     -16.718219158886
             les_mean =     281.991457656124
             stat err =       0.001236909783
             autocorr =       1.214096342324
              std dev =       1.587571871349
             le_variance =       2.520384446699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.520100026485
                                         uncertainty =       0.021621092103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.520100026485
                                         uncertainty =       0.021621092103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122564875
  error estimate for blocks of size 2^( 2) =       0.001161611124
  error estimate for blocks of size 2^( 3) =       0.001195770197
  error estimate for blocks of size 2^( 4) =       0.001218070519
  error estimate for blocks of size 2^( 5) =       0.001233598624
  error estimate for blocks of size 2^( 6) =       0.001243102690
  error estimate for blocks of size 2^( 7) =       0.001252867299

      target function =                  N/A
              le_mean =     -16.718219158886
             les_mean =     281.991457656124
             stat err =       0.001236909783
             autocorr =       1.214096342324
              std dev =       1.587571871349
             le_variance =       2.520384446699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.520100026485
                                         uncertainty =       0.021621092103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.520100026485
                                         uncertainty =       0.021621092103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122564875
  error estimate for blocks of size 2^( 2) =       0.001161611124
  error estimate for blocks of size 2^( 3) =       0.001195770197
  error estimate for blocks of size 2^( 4) =       0.001218070519
  error estimate for blocks of size 2^( 5) =       0.001233598624
  error estimate for blocks of size 2^( 6) =       0.001243102690
  error estimate for blocks of size 2^( 7) =       0.001252867299

      target function =                  N/A
              le_mean =     -16.718219158886
             les_mean =     281.991457656124
             stat err =       0.001236909783
             autocorr =       1.214096342324
              std dev =       1.587571871349
             le_variance =       2.520384446699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.520100026485
                                         uncertainty =       0.021621092103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.520100026485
                                         uncertainty =       0.021621092103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122564875
  error estimate for blocks of size 2^( 2) =       0.001161611124
  error estimate for blocks of size 2^( 3) =       0.001195770197
  error estimate for blocks of size 2^( 4) =       0.001218070519
  error estimate for blocks of size 2^( 5) =       0.001233598624
  error estimate for blocks of size 2^( 6) =       0.001243102690
  error estimate for blocks of size 2^( 7) =       0.001252867299

      target function =                  N/A
              le_mean =     -16.718219158886
             les_mean =     281.991457656124
             stat err =       0.001236909783
             autocorr =       1.214096342324
              std dev =       1.587571871349
             le_variance =       2.520384446699


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718219158886        initial  <--
     9.5367e+11     9.5367e+12             5.9263e-16       -16.718219158886
     3.8147e+12     3.8147e+13             1.4890e-16       -16.718219158886
     1.5259e+13     1.5259e+14             0.0000e+00       -16.718219158886

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0011
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0206e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6730e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.6831
    reference variance = 1.73146
====================================================
  Execution time = 1.2973e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0293e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5247e+00
  Total weights = 1.945808315e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2411e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554502901651
                                         uncertainty =       0.031260111711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554502901651
                                         uncertainty =       0.031260111711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130052793
  error estimate for blocks of size 2^( 2) =       0.001168554516
  error estimate for blocks of size 2^( 3) =       0.001201246100
  error estimate for blocks of size 2^( 4) =       0.001224903038
  error estimate for blocks of size 2^( 5) =       0.001238940773
  error estimate for blocks of size 2^( 6) =       0.001245893994
  error estimate for blocks of size 2^( 7) =       0.001252172977

      target function =                  N/A
              le_mean =     -16.718701360507
             les_mean =     282.039650796244
             stat err =       0.001240477695
             autocorr =       1.204981705463
              std dev =       1.598161556151
             le_variance =       2.554120359558


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671870136051e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718701359615       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718701359615       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.83e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718701359615       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718701359615       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.83e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+14, overlap shift 1.5259e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718701359615       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718701359615       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.30e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167911 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6221e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.7771
    reference variance = 2.27246
====================================================
  Execution time = 1.2759e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5942e+00
  Total weights = 1.9457e+06
  Execution time = 2.2500e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.622293053594
                                         uncertainty =       0.047142601967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.622293053594
                                         uncertainty =       0.047142601967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144999201
  error estimate for blocks of size 2^( 2) =       0.001182938028
  error estimate for blocks of size 2^( 3) =       0.001217414412
  error estimate for blocks of size 2^( 4) =       0.001240337119
  error estimate for blocks of size 2^( 5) =       0.001253762449
  error estimate for blocks of size 2^( 6) =       0.001263618508
  error estimate for blocks of size 2^( 7) =       0.001266619911

      target function =                  N/A
              le_mean =     -16.717711527696
             les_mean =     282.076039167014
             stat err =       0.001256084497
             autocorr =       1.203448038703
              std dev =       1.619299306929
             le_variance =       2.622130245420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.622293053594
                                         uncertainty =       0.047142601967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.622293053594
                                         uncertainty =       0.047142601967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144999201
  error estimate for blocks of size 2^( 2) =       0.001182938028
  error estimate for blocks of size 2^( 3) =       0.001217414412
  error estimate for blocks of size 2^( 4) =       0.001240337119
  error estimate for blocks of size 2^( 5) =       0.001253762449
  error estimate for blocks of size 2^( 6) =       0.001263618508
  error estimate for blocks of size 2^( 7) =       0.001266619911

      target function =                  N/A
              le_mean =     -16.717711527696
             les_mean =     282.076039167014
             stat err =       0.001256084497
             autocorr =       1.203448038703
              std dev =       1.619299306929
             le_variance =       2.622130245420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.622293053594
                                         uncertainty =       0.047142601967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.622293053594
                                         uncertainty =       0.047142601967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144999201
  error estimate for blocks of size 2^( 2) =       0.001182938028
  error estimate for blocks of size 2^( 3) =       0.001217414412
  error estimate for blocks of size 2^( 4) =       0.001240337119
  error estimate for blocks of size 2^( 5) =       0.001253762449
  error estimate for blocks of size 2^( 6) =       0.001263618508
  error estimate for blocks of size 2^( 7) =       0.001266619911

      target function =                  N/A
              le_mean =     -16.717711527696
             les_mean =     282.076039167014
             stat err =       0.001256084497
             autocorr =       1.203448038703
              std dev =       1.619299306929
             le_variance =       2.622130245420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.622293053594
                                         uncertainty =       0.047142601967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.622293053594
                                         uncertainty =       0.047142601967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144999201
  error estimate for blocks of size 2^( 2) =       0.001182938028
  error estimate for blocks of size 2^( 3) =       0.001217414412
  error estimate for blocks of size 2^( 4) =       0.001240337119
  error estimate for blocks of size 2^( 5) =       0.001253762449
  error estimate for blocks of size 2^( 6) =       0.001263618508
  error estimate for blocks of size 2^( 7) =       0.001266619911

      target function =                  N/A
              le_mean =     -16.717711527696
             les_mean =     282.076039167014
             stat err =       0.001256084497
             autocorr =       1.203448038703
              std dev =       1.619299306929
             le_variance =       2.622130245420


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717711527696        initial  <--
     9.5367e+12     9.5367e+13             0.0000e+00       -16.717711527696
     3.8147e+13     3.8147e+14             0.0000e+00       -16.717711527696
     1.5259e+14     1.5259e+15             0.0000e+00       -16.717711527696

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1147
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0342e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6730e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8483
    reference variance = 1.84819
====================================================
  Execution time = 1.2984e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0294e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4758e+00
  Total weights = 1.945818904e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1664e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.498684775176
                                         uncertainty =       0.017823682524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.498684775176
                                         uncertainty =       0.017823682524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001118001654
  error estimate for blocks of size 2^( 2) =       0.001156839785
  error estimate for blocks of size 2^( 3) =       0.001189325440
  error estimate for blocks of size 2^( 4) =       0.001212026353
  error estimate for blocks of size 2^( 5) =       0.001228605016
  error estimate for blocks of size 2^( 6) =       0.001239640410
  error estimate for blocks of size 2^( 7) =       0.001241953168

      target function =                  N/A
              le_mean =     -16.718784888479
             les_mean =     281.993561806796
             stat err =       0.001230556237
             autocorr =       1.211484996553
              std dev =       1.581118398470
             le_variance =       2.499935389981


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671878488848e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718784887545       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718784887545       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.17e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718784887545       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718784887545       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.17e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+15, overlap shift 1.5259e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718784887545       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718784887545       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.29e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169059 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6157e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.6586
    reference variance = 1.56429
====================================================
  Execution time = 1.2718e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5419e+00
  Total weights = 1.9454e+06
  Execution time = 2.2546e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.572278653603
                                         uncertainty =       0.030890763857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.572278653603
                                         uncertainty =       0.030890763857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133997062
  error estimate for blocks of size 2^( 2) =       0.001173215366
  error estimate for blocks of size 2^( 3) =       0.001206804397
  error estimate for blocks of size 2^( 4) =       0.001229174442
  error estimate for blocks of size 2^( 5) =       0.001244433908
  error estimate for blocks of size 2^( 6) =       0.001252382590
  error estimate for blocks of size 2^( 7) =       0.001257455755

      target function =                  N/A
              le_mean =     -16.718824250738
             les_mean =     282.060950144218
             stat err =       0.001245861674
             autocorr =       1.207023686380
              std dev =       1.603739684382
             le_variance =       2.571980975263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.572278653603
                                         uncertainty =       0.030890763857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.572278653603
                                         uncertainty =       0.030890763857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133997062
  error estimate for blocks of size 2^( 2) =       0.001173215366
  error estimate for blocks of size 2^( 3) =       0.001206804397
  error estimate for blocks of size 2^( 4) =       0.001229174442
  error estimate for blocks of size 2^( 5) =       0.001244433908
  error estimate for blocks of size 2^( 6) =       0.001252382590
  error estimate for blocks of size 2^( 7) =       0.001257455755

      target function =                  N/A
              le_mean =     -16.718824250738
             les_mean =     282.060950144218
             stat err =       0.001245861674
             autocorr =       1.207023686380
              std dev =       1.603739684382
             le_variance =       2.571980975263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.572278653603
                                         uncertainty =       0.030890763857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.572278653603
                                         uncertainty =       0.030890763857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133997062
  error estimate for blocks of size 2^( 2) =       0.001173215366
  error estimate for blocks of size 2^( 3) =       0.001206804397
  error estimate for blocks of size 2^( 4) =       0.001229174442
  error estimate for blocks of size 2^( 5) =       0.001244433908
  error estimate for blocks of size 2^( 6) =       0.001252382590
  error estimate for blocks of size 2^( 7) =       0.001257455755

      target function =                  N/A
              le_mean =     -16.718824250738
             les_mean =     282.060950144218
             stat err =       0.001245861674
             autocorr =       1.207023686380
              std dev =       1.603739684382
             le_variance =       2.571980975263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.572278653603
                                         uncertainty =       0.030890763857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.572278653603
                                         uncertainty =       0.030890763857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133997062
  error estimate for blocks of size 2^( 2) =       0.001173215366
  error estimate for blocks of size 2^( 3) =       0.001206804397
  error estimate for blocks of size 2^( 4) =       0.001229174442
  error estimate for blocks of size 2^( 5) =       0.001244433908
  error estimate for blocks of size 2^( 6) =       0.001252382590
  error estimate for blocks of size 2^( 7) =       0.001257455755

      target function =                  N/A
              le_mean =     -16.718824250738
             les_mean =     282.060950144218
             stat err =       0.001245861674
             autocorr =       1.207023686380
              std dev =       1.603739684382
             le_variance =       2.571980975263


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718824250738        initial  <--
     9.5367e+13     9.5367e+14             0.0000e+00       -16.718824250738
     3.8147e+14     3.8147e+15             0.0000e+00       -16.718824250738
     1.5259e+15     1.5259e+16             0.0000e+00       -16.718824250738

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0874
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0251e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6731e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.6376
    reference variance = 2.19202
====================================================
  Execution time = 1.3021e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0260e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5193e+00
  Total weights = 1.945661119e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.9608e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545830343820
                                         uncertainty =       0.027818460611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545830343820
                                         uncertainty =       0.027818460611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128356111
  error estimate for blocks of size 2^( 2) =       0.001167674222
  error estimate for blocks of size 2^( 3) =       0.001201087995
  error estimate for blocks of size 2^( 4) =       0.001223388386
  error estimate for blocks of size 2^( 5) =       0.001236016512
  error estimate for blocks of size 2^( 6) =       0.001243779082
  error estimate for blocks of size 2^( 7) =       0.001245915401

      target function =                  N/A
              le_mean =     -16.718604855845
             les_mean =     282.031096911816
             stat err =       0.001237274845
             autocorr =       1.202375161685
              std dev =       1.595762047322
             le_variance =       2.546456511675


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671860485584e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718604854916       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718604854916       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.32e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718604854916       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718604854916       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.32e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+16, overlap shift 1.5259e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718604854916       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718604854916       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.32e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170312 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7986e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.6122
    reference variance = 1.82683
====================================================
  Execution time = 1.2757e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5059e+00
  Total weights = 1.9457e+06
  Execution time = 2.2440e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535051489816
                                         uncertainty =       0.024694658240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535051489816
                                         uncertainty =       0.024694658240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125708949
  error estimate for blocks of size 2^( 2) =       0.001164340763
  error estimate for blocks of size 2^( 3) =       0.001197032510
  error estimate for blocks of size 2^( 4) =       0.001217980919
  error estimate for blocks of size 2^( 5) =       0.001234191009
  error estimate for blocks of size 2^( 6) =       0.001241332051
  error estimate for blocks of size 2^( 7) =       0.001247267418

      target function =                  N/A
              le_mean =     -16.716578200752
             les_mean =     281.949864591061
             stat err =       0.001235192849
             autocorr =       1.203974531885
              std dev =       1.592018335190
             le_variance =       2.534522379582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535051489816
                                         uncertainty =       0.024694658240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535051489816
                                         uncertainty =       0.024694658240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125708949
  error estimate for blocks of size 2^( 2) =       0.001164340763
  error estimate for blocks of size 2^( 3) =       0.001197032510
  error estimate for blocks of size 2^( 4) =       0.001217980919
  error estimate for blocks of size 2^( 5) =       0.001234191009
  error estimate for blocks of size 2^( 6) =       0.001241332051
  error estimate for blocks of size 2^( 7) =       0.001247267418

      target function =                  N/A
              le_mean =     -16.716578200752
             les_mean =     281.949864591061
             stat err =       0.001235192849
             autocorr =       1.203974531885
              std dev =       1.592018335190
             le_variance =       2.534522379582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535051489816
                                         uncertainty =       0.024694658240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535051489816
                                         uncertainty =       0.024694658240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125708949
  error estimate for blocks of size 2^( 2) =       0.001164340763
  error estimate for blocks of size 2^( 3) =       0.001197032510
  error estimate for blocks of size 2^( 4) =       0.001217980919
  error estimate for blocks of size 2^( 5) =       0.001234191009
  error estimate for blocks of size 2^( 6) =       0.001241332051
  error estimate for blocks of size 2^( 7) =       0.001247267418

      target function =                  N/A
              le_mean =     -16.716578200752
             les_mean =     281.949864591061
             stat err =       0.001235192849
             autocorr =       1.203974531885
              std dev =       1.592018335190
             le_variance =       2.534522379582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535051489816
                                         uncertainty =       0.024694658240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535051489816
                                         uncertainty =       0.024694658240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125708949
  error estimate for blocks of size 2^( 2) =       0.001164340763
  error estimate for blocks of size 2^( 3) =       0.001197032510
  error estimate for blocks of size 2^( 4) =       0.001217980919
  error estimate for blocks of size 2^( 5) =       0.001234191009
  error estimate for blocks of size 2^( 6) =       0.001241332051
  error estimate for blocks of size 2^( 7) =       0.001247267418

      target function =                  N/A
              le_mean =     -16.716578200752
             les_mean =     281.949864591061
             stat err =       0.001235192849
             autocorr =       1.203974531885
              std dev =       1.592018335190
             le_variance =       2.534522379582


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716578200752        initial  <--
     9.5367e+14     9.5367e+15             0.0000e+00       -16.716578200752
     3.8147e+15     3.8147e+16             0.0000e+00       -16.716578200752
     1.5259e+16     1.5259e+17             0.0000e+00       -16.716578200752

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0854
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2077e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6728e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.5759
    reference variance = 5.04035
====================================================
  Execution time = 1.2972e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0260e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.4910e+00
  Total weights = 1.945699303e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1733e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.521239171406
                                         uncertainty =       0.021447850900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.521239171406
                                         uncertainty =       0.021447850900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122583479
  error estimate for blocks of size 2^( 2) =       0.001161131137
  error estimate for blocks of size 2^( 3) =       0.001193206704
  error estimate for blocks of size 2^( 4) =       0.001215714737
  error estimate for blocks of size 2^( 5) =       0.001229590584
  error estimate for blocks of size 2^( 6) =       0.001239527151
  error estimate for blocks of size 2^( 7) =       0.001248290896

      target function =                  N/A
              le_mean =     -16.719549554630
             les_mean =     282.034341037132
             stat err =       0.001233280842
             autocorr =       1.206942770251
              std dev =       1.587598181779
             le_variance =       2.520467986789


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671954955463e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719549553731       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719549553731       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.31e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719549553731       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719549553731       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.31e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+17, overlap shift 1.5259e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719549553731       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719549553731       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171459 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6154e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.7651
    reference variance = 1.85489
====================================================
  Execution time = 1.2774e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5344e+00
  Total weights = 1.9458e+06
  Execution time = 2.2429e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562153224639
                                         uncertainty =       0.038782675652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562153224639
                                         uncertainty =       0.038782675652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131881509
  error estimate for blocks of size 2^( 2) =       0.001169079942
  error estimate for blocks of size 2^( 3) =       0.001202892974
  error estimate for blocks of size 2^( 4) =       0.001226300958
  error estimate for blocks of size 2^( 5) =       0.001242792794
  error estimate for blocks of size 2^( 6) =       0.001251502414
  error estimate for blocks of size 2^( 7) =       0.001257110915

      target function =                  N/A
              le_mean =     -16.717758118086
             les_mean =     282.017812341836
             stat err =       0.001244426770
             autocorr =       1.208750760473
              std dev =       1.600747791741
             le_variance =       2.562393492763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562153224639
                                         uncertainty =       0.038782675652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562153224639
                                         uncertainty =       0.038782675652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131881509
  error estimate for blocks of size 2^( 2) =       0.001169079942
  error estimate for blocks of size 2^( 3) =       0.001202892974
  error estimate for blocks of size 2^( 4) =       0.001226300958
  error estimate for blocks of size 2^( 5) =       0.001242792794
  error estimate for blocks of size 2^( 6) =       0.001251502414
  error estimate for blocks of size 2^( 7) =       0.001257110915

      target function =                  N/A
              le_mean =     -16.717758118086
             les_mean =     282.017812341836
             stat err =       0.001244426770
             autocorr =       1.208750760473
              std dev =       1.600747791741
             le_variance =       2.562393492763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562153224639
                                         uncertainty =       0.038782675652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562153224639
                                         uncertainty =       0.038782675652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131881509
  error estimate for blocks of size 2^( 2) =       0.001169079942
  error estimate for blocks of size 2^( 3) =       0.001202892974
  error estimate for blocks of size 2^( 4) =       0.001226300958
  error estimate for blocks of size 2^( 5) =       0.001242792794
  error estimate for blocks of size 2^( 6) =       0.001251502414
  error estimate for blocks of size 2^( 7) =       0.001257110915

      target function =                  N/A
              le_mean =     -16.717758118086
             les_mean =     282.017812341836
             stat err =       0.001244426770
             autocorr =       1.208750760473
              std dev =       1.600747791741
             le_variance =       2.562393492763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562153224639
                                         uncertainty =       0.038782675652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562153224639
                                         uncertainty =       0.038782675652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131881509
  error estimate for blocks of size 2^( 2) =       0.001169079942
  error estimate for blocks of size 2^( 3) =       0.001202892974
  error estimate for blocks of size 2^( 4) =       0.001226300958
  error estimate for blocks of size 2^( 5) =       0.001242792794
  error estimate for blocks of size 2^( 6) =       0.001251502414
  error estimate for blocks of size 2^( 7) =       0.001257110915

      target function =                  N/A
              le_mean =     -16.717758118086
             les_mean =     282.017812341836
             stat err =       0.001244426770
             autocorr =       1.208750760473
              std dev =       1.600747791741
             le_variance =       2.562393492763


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717758118086        initial  <--
     9.5367e+15     9.5367e+16             0.0000e+00       -16.717758118086
     3.8147e+16     3.8147e+17             0.0000e+00       -16.717758118086
     1.5259e+17     1.5259e+18             0.0000e+00       -16.717758118086

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1119
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6727e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.6551
    reference variance = 1.69008
====================================================
  Execution time = 1.2989e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0301e+04
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5322e+00
  Total weights = 1.945724387e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1723e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560116332474
                                         uncertainty =       0.023070872394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560116332474
                                         uncertainty =       0.023070872394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131435859
  error estimate for blocks of size 2^( 2) =       0.001170158785
  error estimate for blocks of size 2^( 3) =       0.001203320945
  error estimate for blocks of size 2^( 4) =       0.001225323627
  error estimate for blocks of size 2^( 5) =       0.001239153177
  error estimate for blocks of size 2^( 6) =       0.001247258992
  error estimate for blocks of size 2^( 7) =       0.001251302327

      target function =                  N/A
              le_mean =     -16.715949905229
             les_mean =     281.955135287237
             stat err =       0.001240759531
             autocorr =       1.202583835594
              std dev =       1.600117538084
             le_variance =       2.560376135684


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671594990523e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715949904304       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715949904304       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.31e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715949904304       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715949904304       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+18, overlap shift 1.5259e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715949904304       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715949904304       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172640 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6168e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.7031
    reference variance = 1.70207
====================================================
  Execution time = 1.2772e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5182e+00
  Total weights = 1.9455e+06
  Execution time = 2.2537e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546936570503
                                         uncertainty =       0.035298488875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546936570503
                                         uncertainty =       0.035298488875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128449872
  error estimate for blocks of size 2^( 2) =       0.001167067510
  error estimate for blocks of size 2^( 3) =       0.001200621661
  error estimate for blocks of size 2^( 4) =       0.001224608366
  error estimate for blocks of size 2^( 5) =       0.001240966214
  error estimate for blocks of size 2^( 6) =       0.001250245390
  error estimate for blocks of size 2^( 7) =       0.001254144133

      target function =                  N/A
              le_mean =     -16.718851094879
             les_mean =     282.038196253864
             stat err =       0.001242491026
             autocorr =       1.212333142925
              std dev =       1.595894646785
             le_variance =       2.546879723636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546936570503
                                         uncertainty =       0.035298488875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546936570503
                                         uncertainty =       0.035298488875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128449872
  error estimate for blocks of size 2^( 2) =       0.001167067510
  error estimate for blocks of size 2^( 3) =       0.001200621661
  error estimate for blocks of size 2^( 4) =       0.001224608366
  error estimate for blocks of size 2^( 5) =       0.001240966214
  error estimate for blocks of size 2^( 6) =       0.001250245390
  error estimate for blocks of size 2^( 7) =       0.001254144133

      target function =                  N/A
              le_mean =     -16.718851094879
             les_mean =     282.038196253864
             stat err =       0.001242491026
             autocorr =       1.212333142925
              std dev =       1.595894646785
             le_variance =       2.546879723636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546936570503
                                         uncertainty =       0.035298488875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546936570503
                                         uncertainty =       0.035298488875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128449872
  error estimate for blocks of size 2^( 2) =       0.001167067510
  error estimate for blocks of size 2^( 3) =       0.001200621661
  error estimate for blocks of size 2^( 4) =       0.001224608366
  error estimate for blocks of size 2^( 5) =       0.001240966214
  error estimate for blocks of size 2^( 6) =       0.001250245390
  error estimate for blocks of size 2^( 7) =       0.001254144133

      target function =                  N/A
              le_mean =     -16.718851094879
             les_mean =     282.038196253864
             stat err =       0.001242491026
             autocorr =       1.212333142925
              std dev =       1.595894646785
             le_variance =       2.546879723636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546936570503
                                         uncertainty =       0.035298488875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546936570503
                                         uncertainty =       0.035298488875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128449872
  error estimate for blocks of size 2^( 2) =       0.001167067510
  error estimate for blocks of size 2^( 3) =       0.001200621661
  error estimate for blocks of size 2^( 4) =       0.001224608366
  error estimate for blocks of size 2^( 5) =       0.001240966214
  error estimate for blocks of size 2^( 6) =       0.001250245390
  error estimate for blocks of size 2^( 7) =       0.001254144133

      target function =                  N/A
              le_mean =     -16.718851094879
             les_mean =     282.038196253864
             stat err =       0.001242491026
             autocorr =       1.212333142925
              std dev =       1.595894646785
             le_variance =       2.546879723636


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718851094879        initial  <--
     9.5367e+16     9.5367e+17             0.0000e+00       -16.718851094879
     3.8147e+17     3.8147e+18             0.0000e+00       -16.718851094879
     1.5259e+18     1.5259e+19             0.0000e+00       -16.718851094879

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1791
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0353e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6726e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.8341
    reference variance = 1.49557
====================================================
  Execution time = 1.3012e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0247e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.6677e+00
  Total weights = 1.945738235e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1968e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.702194404192
                                         uncertainty =       0.085550816743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.702194404192
                                         uncertainty =       0.085550816743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001162235365
  error estimate for blocks of size 2^( 2) =       0.001199336849
  error estimate for blocks of size 2^( 3) =       0.001230952148
  error estimate for blocks of size 2^( 4) =       0.001251592884
  error estimate for blocks of size 2^( 5) =       0.001267916440
  error estimate for blocks of size 2^( 6) =       0.001272859943
  error estimate for blocks of size 2^( 7) =       0.001285108724

      target function =                  N/A
              le_mean =     -16.716910881550
             les_mean =     282.122827918548
             stat err =       0.001269369498
             autocorr =       1.192855793200
              std dev =       1.643675314220
             le_variance =       2.701668538576


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671691088155e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716910880652       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716910880652       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716910880652       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716910880652       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+19, overlap shift 1.5259e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716910880652       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716910880652       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173853 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6216e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.6642
    reference variance = 1.83533
====================================================
  Execution time = 1.2754e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5943e+00
  Total weights = 1.9458e+06
  Execution time = 2.2484e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.623195777474
                                         uncertainty =       0.059123455016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.623195777474
                                         uncertainty =       0.059123455016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001145235117
  error estimate for blocks of size 2^( 2) =       0.001184206644
  error estimate for blocks of size 2^( 3) =       0.001217214759
  error estimate for blocks of size 2^( 4) =       0.001239415274
  error estimate for blocks of size 2^( 5) =       0.001256085199
  error estimate for blocks of size 2^( 6) =       0.001263777113
  error estimate for blocks of size 2^( 7) =       0.001270674646

      target function =                  N/A
              le_mean =     -16.716128203249
             les_mean =     282.023200581795
             stat err =       0.001257488058
             autocorr =       1.205642157798
              std dev =       1.619632948030
             le_variance =       2.623210886343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.623195777474
                                         uncertainty =       0.059123455016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.623195777474
                                         uncertainty =       0.059123455016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001145235117
  error estimate for blocks of size 2^( 2) =       0.001184206644
  error estimate for blocks of size 2^( 3) =       0.001217214759
  error estimate for blocks of size 2^( 4) =       0.001239415274
  error estimate for blocks of size 2^( 5) =       0.001256085199
  error estimate for blocks of size 2^( 6) =       0.001263777113
  error estimate for blocks of size 2^( 7) =       0.001270674646

      target function =                  N/A
              le_mean =     -16.716128203249
             les_mean =     282.023200581795
             stat err =       0.001257488058
             autocorr =       1.205642157798
              std dev =       1.619632948030
             le_variance =       2.623210886343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.623195777474
                                         uncertainty =       0.059123455016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.623195777474
                                         uncertainty =       0.059123455016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001145235117
  error estimate for blocks of size 2^( 2) =       0.001184206644
  error estimate for blocks of size 2^( 3) =       0.001217214759
  error estimate for blocks of size 2^( 4) =       0.001239415274
  error estimate for blocks of size 2^( 5) =       0.001256085199
  error estimate for blocks of size 2^( 6) =       0.001263777113
  error estimate for blocks of size 2^( 7) =       0.001270674646

      target function =                  N/A
              le_mean =     -16.716128203249
             les_mean =     282.023200581795
             stat err =       0.001257488058
             autocorr =       1.205642157798
              std dev =       1.619632948030
             le_variance =       2.623210886343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.623195777474
                                         uncertainty =       0.059123455016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.623195777474
                                         uncertainty =       0.059123455016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001145235117
  error estimate for blocks of size 2^( 2) =       0.001184206644
  error estimate for blocks of size 2^( 3) =       0.001217214759
  error estimate for blocks of size 2^( 4) =       0.001239415274
  error estimate for blocks of size 2^( 5) =       0.001256085199
  error estimate for blocks of size 2^( 6) =       0.001263777113
  error estimate for blocks of size 2^( 7) =       0.001270674646

      target function =                  N/A
              le_mean =     -16.716128203249
             les_mean =     282.023200581795
             stat err =       0.001257488058
             autocorr =       1.205642157798
              std dev =       1.619632948030
             le_variance =       2.623210886343


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716128203249        initial  <--
     9.5367e+17     9.5367e+18             0.0000e+00       -16.716128203249
     3.8147e+18     3.8147e+19             0.0000e+00       -16.716128203249
     1.5259e+19     1.5259e+20             0.0000e+00       -16.716128203249

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1228
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0345e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6726e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.7528
    reference variance = 1.58278
====================================================
  Execution time = 1.3014e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0262e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5226e+00
  Total weights = 1.945362605e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1599e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544059007543
                                         uncertainty =       0.023697626701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544059007543
                                         uncertainty =       0.023697626701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128964763
  error estimate for blocks of size 2^( 2) =       0.001166441406
  error estimate for blocks of size 2^( 3) =       0.001199238076
  error estimate for blocks of size 2^( 4) =       0.001221179992
  error estimate for blocks of size 2^( 5) =       0.001236664812
  error estimate for blocks of size 2^( 6) =       0.001244262087
  error estimate for blocks of size 2^( 7) =       0.001250274358

      target function =                  N/A
              le_mean =     -16.719186703475
             les_mean =     282.053765579757
             stat err =       0.001238095312
             autocorr =       1.202672510695
              std dev =       1.596622824660
             le_variance =       2.549204444226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671918670348e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719186702521       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719186702521       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719186702521       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719186702521       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+20, overlap shift 1.5259e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719186702521       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719186702521       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175049 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6181e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.4006
    reference variance = 2.62964
====================================================
  Execution time = 1.2677e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5920e+00
  Total weights = 1.9457e+06
  Execution time = 2.2468e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621200323267
                                         uncertainty =       0.055566919814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621200323267
                                         uncertainty =       0.055566919814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144781669
  error estimate for blocks of size 2^( 2) =       0.001182621029
  error estimate for blocks of size 2^( 3) =       0.001214581603
  error estimate for blocks of size 2^( 4) =       0.001237458974
  error estimate for blocks of size 2^( 5) =       0.001252089245
  error estimate for blocks of size 2^( 6) =       0.001260216041
  error estimate for blocks of size 2^( 7) =       0.001263823921

      target function =                  N/A
              le_mean =     -16.718459295420
             les_mean =     282.098908503945
             stat err =       0.001253397045
             autocorr =       1.198759329553
              std dev =       1.618991665216
             le_variance =       2.621134012038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621200323267
                                         uncertainty =       0.055566919814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621200323267
                                         uncertainty =       0.055566919814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144781669
  error estimate for blocks of size 2^( 2) =       0.001182621029
  error estimate for blocks of size 2^( 3) =       0.001214581603
  error estimate for blocks of size 2^( 4) =       0.001237458974
  error estimate for blocks of size 2^( 5) =       0.001252089245
  error estimate for blocks of size 2^( 6) =       0.001260216041
  error estimate for blocks of size 2^( 7) =       0.001263823921

      target function =                  N/A
              le_mean =     -16.718459295420
             les_mean =     282.098908503945
             stat err =       0.001253397045
             autocorr =       1.198759329553
              std dev =       1.618991665216
             le_variance =       2.621134012038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621200323267
                                         uncertainty =       0.055566919814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621200323267
                                         uncertainty =       0.055566919814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144781669
  error estimate for blocks of size 2^( 2) =       0.001182621029
  error estimate for blocks of size 2^( 3) =       0.001214581603
  error estimate for blocks of size 2^( 4) =       0.001237458974
  error estimate for blocks of size 2^( 5) =       0.001252089245
  error estimate for blocks of size 2^( 6) =       0.001260216041
  error estimate for blocks of size 2^( 7) =       0.001263823921

      target function =                  N/A
              le_mean =     -16.718459295420
             les_mean =     282.098908503945
             stat err =       0.001253397045
             autocorr =       1.198759329553
              std dev =       1.618991665216
             le_variance =       2.621134012038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621200323267
                                         uncertainty =       0.055566919814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621200323267
                                         uncertainty =       0.055566919814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144781669
  error estimate for blocks of size 2^( 2) =       0.001182621029
  error estimate for blocks of size 2^( 3) =       0.001214581603
  error estimate for blocks of size 2^( 4) =       0.001237458974
  error estimate for blocks of size 2^( 5) =       0.001252089245
  error estimate for blocks of size 2^( 6) =       0.001260216041
  error estimate for blocks of size 2^( 7) =       0.001263823921

      target function =                  N/A
              le_mean =     -16.718459295420
             les_mean =     282.098908503945
             stat err =       0.001253397045
             autocorr =       1.198759329553
              std dev =       1.618991665216
             le_variance =       2.621134012038


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718459295420        initial  <--
     9.5367e+18     9.5367e+19             0.0000e+00       -16.718459295420
     3.8147e+19     3.8147e+20             0.0000e+00       -16.718459295420
     1.5259e+20     1.5259e+21             0.0000e+00       -16.718459295420

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0307
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0218e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6723e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.8689
    reference variance = 1.33494
====================================================
  Execution time = 1.2975e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0257e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5360e+00
  Total weights = 1.945755723e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1807e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.565168005914
                                         uncertainty =       0.039641936226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.565168005914
                                         uncertainty =       0.039641936226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132377672
  error estimate for blocks of size 2^( 2) =       0.001170850103
  error estimate for blocks of size 2^( 3) =       0.001204039086
  error estimate for blocks of size 2^( 4) =       0.001227569908
  error estimate for blocks of size 2^( 5) =       0.001242769809
  error estimate for blocks of size 2^( 6) =       0.001255821838
  error estimate for blocks of size 2^( 7) =       0.001257743895

      target function =                  N/A
              le_mean =     -16.718079651928
             les_mean =     282.030152480022
             stat err =       0.001245976363
             autocorr =       1.210701309429
              std dev =       1.601449483609
             le_variance =       2.564640448550


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671807965193e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718079650978       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718079650978       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718079650978       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+19 is 4.325526e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+20, overlap shift 3.8147e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718079650978       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718079650978       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718079650978       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+20 is 1.081382e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+21, overlap shift 1.5259e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718079650978       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718079650978       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718079650978       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+21 is 2.703454e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176604 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6162e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.658
    reference variance = 1.6622
====================================================
  Execution time = 1.2731e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5457e+00
  Total weights = 1.9460e+06
  Execution time = 2.2553e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.571001704779
                                         uncertainty =       0.025679998435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.571001704779
                                         uncertainty =       0.025679998435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133732360
  error estimate for blocks of size 2^( 2) =       0.001172748604
  error estimate for blocks of size 2^( 3) =       0.001205397102
  error estimate for blocks of size 2^( 4) =       0.001227495244
  error estimate for blocks of size 2^( 5) =       0.001238486049
  error estimate for blocks of size 2^( 6) =       0.001247947821
  error estimate for blocks of size 2^( 7) =       0.001253325668

      target function =                  N/A
              le_mean =     -16.718409712364
             les_mean =     282.050948596147
             stat err =       0.001241813696
             autocorr =       1.199752890254
              std dev =       1.603365332700
             le_variance =       2.570780390105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.571001704779
                                         uncertainty =       0.025679998435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.571001704779
                                         uncertainty =       0.025679998435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133732360
  error estimate for blocks of size 2^( 2) =       0.001172748604
  error estimate for blocks of size 2^( 3) =       0.001205397102
  error estimate for blocks of size 2^( 4) =       0.001227495244
  error estimate for blocks of size 2^( 5) =       0.001238486049
  error estimate for blocks of size 2^( 6) =       0.001247947821
  error estimate for blocks of size 2^( 7) =       0.001253325668

      target function =                  N/A
              le_mean =     -16.718409712364
             les_mean =     282.050948596147
             stat err =       0.001241813696
             autocorr =       1.199752890254
              std dev =       1.603365332700
             le_variance =       2.570780390105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.571001704779
                                         uncertainty =       0.025679998435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.571001704779
                                         uncertainty =       0.025679998435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133732360
  error estimate for blocks of size 2^( 2) =       0.001172748604
  error estimate for blocks of size 2^( 3) =       0.001205397102
  error estimate for blocks of size 2^( 4) =       0.001227495244
  error estimate for blocks of size 2^( 5) =       0.001238486049
  error estimate for blocks of size 2^( 6) =       0.001247947821
  error estimate for blocks of size 2^( 7) =       0.001253325668

      target function =                  N/A
              le_mean =     -16.718409712364
             les_mean =     282.050948596147
             stat err =       0.001241813696
             autocorr =       1.199752890254
              std dev =       1.603365332700
             le_variance =       2.570780390105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.571001704779
                                         uncertainty =       0.025679998435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.571001704779
                                         uncertainty =       0.025679998435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133732360
  error estimate for blocks of size 2^( 2) =       0.001172748604
  error estimate for blocks of size 2^( 3) =       0.001205397102
  error estimate for blocks of size 2^( 4) =       0.001227495244
  error estimate for blocks of size 2^( 5) =       0.001238486049
  error estimate for blocks of size 2^( 6) =       0.001247947821
  error estimate for blocks of size 2^( 7) =       0.001253325668

      target function =                  N/A
              le_mean =     -16.718409712364
             les_mean =     282.050948596147
             stat err =       0.001241813696
             autocorr =       1.199752890254
              std dev =       1.603365332700
             le_variance =       2.570780390105


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718409712364        initial  <--
     9.5367e+19     9.5367e+20             4.3255e-24       -16.718409712364
     3.8147e+20     3.8147e+21             1.0814e-24       -16.718409712364
     1.5259e+21     1.5259e+22             2.7035e-25       -16.718409712364

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1439
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0312e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6724e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.6709
    reference variance = 2.96936
====================================================
  Execution time = 1.2998e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0278e+04
  VMC Eavg = -1.6721e+01
  VMC Evar = 2.5565e+00
  Total weights = 1.945850110e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1808e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.581774206006
                                         uncertainty =       0.044482606523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.581774206006
                                         uncertainty =       0.044482606523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136103454
  error estimate for blocks of size 2^( 2) =       0.001173876228
  error estimate for blocks of size 2^( 3) =       0.001206519457
  error estimate for blocks of size 2^( 4) =       0.001229661519
  error estimate for blocks of size 2^( 5) =       0.001241352677
  error estimate for blocks of size 2^( 6) =       0.001243956982
  error estimate for blocks of size 2^( 7) =       0.001249823188

      target function =                  N/A
              le_mean =     -16.720897940736
             les_mean =     282.144923044277
             stat err =       0.001241198592
             autocorr =       1.193566959191
              std dev =       1.606718619547
             le_variance =       2.581544722400


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.672089794074e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720897939835       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720897939835       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+21, overlap shift 3.8147e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720897939835       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720897939835       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+22, overlap shift 1.5259e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720897939835       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720897939835       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177795 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6185e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.7935
    reference variance = 1.3563
====================================================
  Execution time = 1.2710e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.6304e+00
  Total weights = 1.9461e+06
  Execution time = 2.2454e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.662304323748
                                         uncertainty =       0.060806456614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.662304323748
                                         uncertainty =       0.060806456614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001153791254
  error estimate for blocks of size 2^( 2) =       0.001191876218
  error estimate for blocks of size 2^( 3) =       0.001224321042
  error estimate for blocks of size 2^( 4) =       0.001247076448
  error estimate for blocks of size 2^( 5) =       0.001259874913
  error estimate for blocks of size 2^( 6) =       0.001264338077
  error estimate for blocks of size 2^( 7) =       0.001268351722

      target function =                  N/A
              le_mean =     -16.717949936107
             les_mean =     282.120288419409
             stat err =       0.001259910290
             autocorr =       1.192407669897
              std dev =       1.631733346360
             le_variance =       2.662553713622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.662304323748
                                         uncertainty =       0.060806456614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.662304323748
                                         uncertainty =       0.060806456614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001153791254
  error estimate for blocks of size 2^( 2) =       0.001191876218
  error estimate for blocks of size 2^( 3) =       0.001224321042
  error estimate for blocks of size 2^( 4) =       0.001247076448
  error estimate for blocks of size 2^( 5) =       0.001259874913
  error estimate for blocks of size 2^( 6) =       0.001264338077
  error estimate for blocks of size 2^( 7) =       0.001268351722

      target function =                  N/A
              le_mean =     -16.717949936107
             les_mean =     282.120288419409
             stat err =       0.001259910290
             autocorr =       1.192407669897
              std dev =       1.631733346360
             le_variance =       2.662553713622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.662304323748
                                         uncertainty =       0.060806456614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.662304323748
                                         uncertainty =       0.060806456614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001153791254
  error estimate for blocks of size 2^( 2) =       0.001191876218
  error estimate for blocks of size 2^( 3) =       0.001224321042
  error estimate for blocks of size 2^( 4) =       0.001247076448
  error estimate for blocks of size 2^( 5) =       0.001259874913
  error estimate for blocks of size 2^( 6) =       0.001264338077
  error estimate for blocks of size 2^( 7) =       0.001268351722

      target function =                  N/A
              le_mean =     -16.717949936107
             les_mean =     282.120288419409
             stat err =       0.001259910290
             autocorr =       1.192407669897
              std dev =       1.631733346360
             le_variance =       2.662553713622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.662304323748
                                         uncertainty =       0.060806456614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.662304323748
                                         uncertainty =       0.060806456614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001153791254
  error estimate for blocks of size 2^( 2) =       0.001191876218
  error estimate for blocks of size 2^( 3) =       0.001224321042
  error estimate for blocks of size 2^( 4) =       0.001247076448
  error estimate for blocks of size 2^( 5) =       0.001259874913
  error estimate for blocks of size 2^( 6) =       0.001264338077
  error estimate for blocks of size 2^( 7) =       0.001268351722

      target function =                  N/A
              le_mean =     -16.717949936107
             les_mean =     282.120288419409
             stat err =       0.001259910290
             autocorr =       1.192407669897
              std dev =       1.631733346360
             le_variance =       2.662553713622


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717949936107        initial  <--
     9.5367e+20     9.5367e+21             0.0000e+00       -16.717949936107
     3.8147e+21     3.8147e+22             0.0000e+00       -16.717949936107
     1.5259e+22     1.5259e+23             0.0000e+00       -16.717949936107

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0525
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0244e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6724e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.746
    reference variance = 2.90612
====================================================
  Execution time = 1.3046e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0273e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5402e+00
  Total weights = 1.945467760e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1727e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569693899322
                                         uncertainty =       0.034484052544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569693899322
                                         uncertainty =       0.034484052544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133503348
  error estimate for blocks of size 2^( 2) =       0.001171518440
  error estimate for blocks of size 2^( 3) =       0.001203472190
  error estimate for blocks of size 2^( 4) =       0.001225143479
  error estimate for blocks of size 2^( 5) =       0.001238717096
  error estimate for blocks of size 2^( 6) =       0.001242649969
  error estimate for blocks of size 2^( 7) =       0.001255178640

      target function =                  N/A
              le_mean =     -16.717531832847
             les_mean =     282.016031350141
             stat err =       0.001240422296
             autocorr =       1.197549609192
              std dev =       1.603041455605
             le_variance =       2.569741908388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671753183285e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+21, overlap shift 9.5367e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717531831906       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717531831906       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717531831906       residual = 2.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+21 is 4.484896e-26

solving harmonic davidson linear method for identity shift 3.8147e+22, overlap shift 3.8147e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717531831906       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717531831906       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717531831906       residual = 2.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+22 is 1.121224e-26

solving harmonic davidson linear method for identity shift 1.5259e+23, overlap shift 1.5259e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717531831906       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717531831906       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717531831906       residual = 2.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+23 is 2.803060e-27

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178947 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6225e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.7015
    reference variance = 1.44884
====================================================
  Execution time = 1.2891e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5217e+00
  Total weights = 1.9459e+06
  Execution time = 2.6381e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549951225298
                                         uncertainty =       0.037232312340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549951225298
                                         uncertainty =       0.037232312340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129174947
  error estimate for blocks of size 2^( 2) =       0.001167230066
  error estimate for blocks of size 2^( 3) =       0.001200205504
  error estimate for blocks of size 2^( 4) =       0.001222873662
  error estimate for blocks of size 2^( 5) =       0.001236820872
  error estimate for blocks of size 2^( 6) =       0.001246608518
  error estimate for blocks of size 2^( 7) =       0.001252251728

      target function =                  N/A
              le_mean =     -16.718339658067
             les_mean =     282.024572541226
             stat err =       0.001239638695
             autocorr =       1.205224024813
              std dev =       1.596920075118
             le_variance =       2.550153726314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549951225298
                                         uncertainty =       0.037232312340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549951225298
                                         uncertainty =       0.037232312340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129174947
  error estimate for blocks of size 2^( 2) =       0.001167230066
  error estimate for blocks of size 2^( 3) =       0.001200205504
  error estimate for blocks of size 2^( 4) =       0.001222873662
  error estimate for blocks of size 2^( 5) =       0.001236820872
  error estimate for blocks of size 2^( 6) =       0.001246608518
  error estimate for blocks of size 2^( 7) =       0.001252251728

      target function =                  N/A
              le_mean =     -16.718339658067
             les_mean =     282.024572541226
             stat err =       0.001239638695
             autocorr =       1.205224024813
              std dev =       1.596920075118
             le_variance =       2.550153726314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549951225298
                                         uncertainty =       0.037232312340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549951225298
                                         uncertainty =       0.037232312340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129174947
  error estimate for blocks of size 2^( 2) =       0.001167230066
  error estimate for blocks of size 2^( 3) =       0.001200205504
  error estimate for blocks of size 2^( 4) =       0.001222873662
  error estimate for blocks of size 2^( 5) =       0.001236820872
  error estimate for blocks of size 2^( 6) =       0.001246608518
  error estimate for blocks of size 2^( 7) =       0.001252251728

      target function =                  N/A
              le_mean =     -16.718339658067
             les_mean =     282.024572541226
             stat err =       0.001239638695
             autocorr =       1.205224024813
              std dev =       1.596920075118
             le_variance =       2.550153726314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549951225298
                                         uncertainty =       0.037232312340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549951225298
                                         uncertainty =       0.037232312340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129174947
  error estimate for blocks of size 2^( 2) =       0.001167230066
  error estimate for blocks of size 2^( 3) =       0.001200205504
  error estimate for blocks of size 2^( 4) =       0.001222873662
  error estimate for blocks of size 2^( 5) =       0.001236820872
  error estimate for blocks of size 2^( 6) =       0.001246608518
  error estimate for blocks of size 2^( 7) =       0.001252251728

      target function =                  N/A
              le_mean =     -16.718339658067
             les_mean =     282.024572541226
             stat err =       0.001239638695
             autocorr =       1.205224024813
              std dev =       1.596920075118
             le_variance =       2.550153726314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718339658067        initial  <--
     9.5367e+21     9.5367e+22             4.4849e-26       -16.718339658067
     3.8147e+22     3.8147e+23             1.1212e-26       -16.718339658067
     1.5259e+23     1.5259e+24             2.8031e-27       -16.718339658067

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.9269
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1158e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6724e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.5768
    reference variance = 2.26021
====================================================
  Execution time = 1.2966e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0272e+04
  VMC Eavg = -1.6721e+01
  VMC Evar = 2.5240e+00
  Total weights = 1.945855926e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1950e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554929172210
                                         uncertainty =       0.026776835882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554929172210
                                         uncertainty =       0.026776835882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130112443
  error estimate for blocks of size 2^( 2) =       0.001167968676
  error estimate for blocks of size 2^( 3) =       0.001201172846
  error estimate for blocks of size 2^( 4) =       0.001222729493
  error estimate for blocks of size 2^( 5) =       0.001234299222
  error estimate for blocks of size 2^( 6) =       0.001243974537
  error estimate for blocks of size 2^( 7) =       0.001251540928

      target function =                  N/A
              le_mean =     -16.720658629178
             les_mean =     282.104445827828
             stat err =       0.001238136045
             autocorr =       1.200309990089
              std dev =       1.598245915289
             le_variance =       2.554390005738


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.672065862918e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+22, overlap shift 9.5367e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720658628282       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720658628282       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+22 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+23, overlap shift 3.8147e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720658628282       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720658628282       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+23 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+24, overlap shift 1.5259e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720658628282       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720658628282       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+24 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180089 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6168e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.6018
    reference variance = 2.51093
====================================================
  Execution time = 1.2757e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5645e+00
  Total weights = 1.9454e+06
  Execution time = 2.2529e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595797674243
                                         uncertainty =       0.056811044255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595797674243
                                         uncertainty =       0.056811044255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139237499
  error estimate for blocks of size 2^( 2) =       0.001178071893
  error estimate for blocks of size 2^( 3) =       0.001211603966
  error estimate for blocks of size 2^( 4) =       0.001235241458
  error estimate for blocks of size 2^( 5) =       0.001247791230
  error estimate for blocks of size 2^( 6) =       0.001256611320
  error estimate for blocks of size 2^( 7) =       0.001259473836

      target function =                  N/A
              le_mean =     -16.716617926614
             les_mean =     282.009854278347
             stat err =       0.001249779461
             autocorr =       1.203478186458
              std dev =       1.611150899776
             le_variance =       2.595807221848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595797674243
                                         uncertainty =       0.056811044255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595797674243
                                         uncertainty =       0.056811044255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139237499
  error estimate for blocks of size 2^( 2) =       0.001178071893
  error estimate for blocks of size 2^( 3) =       0.001211603966
  error estimate for blocks of size 2^( 4) =       0.001235241458
  error estimate for blocks of size 2^( 5) =       0.001247791230
  error estimate for blocks of size 2^( 6) =       0.001256611320
  error estimate for blocks of size 2^( 7) =       0.001259473836

      target function =                  N/A
              le_mean =     -16.716617926614
             les_mean =     282.009854278347
             stat err =       0.001249779461
             autocorr =       1.203478186458
              std dev =       1.611150899776
             le_variance =       2.595807221848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595797674243
                                         uncertainty =       0.056811044255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595797674243
                                         uncertainty =       0.056811044255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139237499
  error estimate for blocks of size 2^( 2) =       0.001178071893
  error estimate for blocks of size 2^( 3) =       0.001211603966
  error estimate for blocks of size 2^( 4) =       0.001235241458
  error estimate for blocks of size 2^( 5) =       0.001247791230
  error estimate for blocks of size 2^( 6) =       0.001256611320
  error estimate for blocks of size 2^( 7) =       0.001259473836

      target function =                  N/A
              le_mean =     -16.716617926614
             les_mean =     282.009854278347
             stat err =       0.001249779461
             autocorr =       1.203478186458
              std dev =       1.611150899776
             le_variance =       2.595807221848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595797674243
                                         uncertainty =       0.056811044255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595797674243
                                         uncertainty =       0.056811044255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139237499
  error estimate for blocks of size 2^( 2) =       0.001178071893
  error estimate for blocks of size 2^( 3) =       0.001211603966
  error estimate for blocks of size 2^( 4) =       0.001235241458
  error estimate for blocks of size 2^( 5) =       0.001247791230
  error estimate for blocks of size 2^( 6) =       0.001256611320
  error estimate for blocks of size 2^( 7) =       0.001259473836

      target function =                  N/A
              le_mean =     -16.716617926614
             les_mean =     282.009854278347
             stat err =       0.001249779461
             autocorr =       1.203478186458
              std dev =       1.611150899776
             le_variance =       2.595807221848


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716617926614        initial  <--
     9.5367e+22     9.5367e+23             0.0000e+00       -16.716617926614
     3.8147e+23     3.8147e+24             0.0000e+00       -16.716617926614
     1.5259e+24     1.5259e+25             0.0000e+00       -16.716617926614

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1533
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0327e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6721e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.8548
    reference variance = 1.09083
====================================================
  Execution time = 1.2991e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0245e+04
  VMC Eavg = -1.6715e+01
  VMC Evar = 2.6485e+00
  Total weights = 1.945617594e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1821e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.677449108974
                                         uncertainty =       0.123296538756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.677449108974
                                         uncertainty =       0.123296538756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001157028269
  error estimate for blocks of size 2^( 2) =       0.001193984789
  error estimate for blocks of size 2^( 3) =       0.001225696119
  error estimate for blocks of size 2^( 4) =       0.001249155685
  error estimate for blocks of size 2^( 5) =       0.001264299929
  error estimate for blocks of size 2^( 6) =       0.001270137109
  error estimate for blocks of size 2^( 7) =       0.001280985233

      target function =                  N/A
              le_mean =     -16.715429406927
             les_mean =     282.054115485642
             stat err =       0.001266144489
             autocorr =       1.197508482473
              std dev =       1.636311249811
             le_variance =       2.677514506258


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671542940693e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+23, overlap shift 9.5367e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715429406001       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715429406001       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+24, overlap shift 3.8147e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715429406001       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715429406001       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+25, overlap shift 1.5259e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715429406001       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715429406001       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181263 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6179e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.8168
    reference variance = 1.22902
====================================================
  Execution time = 1.2762e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5519e+00
  Total weights = 1.9459e+06
  Execution time = 2.2495e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582611437594
                                         uncertainty =       0.042691671050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582611437594
                                         uncertainty =       0.042691671050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136244501
  error estimate for blocks of size 2^( 2) =       0.001175273531
  error estimate for blocks of size 2^( 3) =       0.001207689164
  error estimate for blocks of size 2^( 4) =       0.001228766705
  error estimate for blocks of size 2^( 5) =       0.001241261331
  error estimate for blocks of size 2^( 6) =       0.001250126918
  error estimate for blocks of size 2^( 7) =       0.001260583880

      target function =                  N/A
              le_mean =     -16.717306662221
             les_mean =     282.020244786261
             stat err =       0.001245184708
             autocorr =       1.200947351231
              std dev =       1.606918093349
             le_variance =       2.582185758734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582611437594
                                         uncertainty =       0.042691671050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582611437594
                                         uncertainty =       0.042691671050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136244501
  error estimate for blocks of size 2^( 2) =       0.001175273531
  error estimate for blocks of size 2^( 3) =       0.001207689164
  error estimate for blocks of size 2^( 4) =       0.001228766705
  error estimate for blocks of size 2^( 5) =       0.001241261331
  error estimate for blocks of size 2^( 6) =       0.001250126918
  error estimate for blocks of size 2^( 7) =       0.001260583880

      target function =                  N/A
              le_mean =     -16.717306662221
             les_mean =     282.020244786261
             stat err =       0.001245184708
             autocorr =       1.200947351231
              std dev =       1.606918093349
             le_variance =       2.582185758734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582611437594
                                         uncertainty =       0.042691671050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582611437594
                                         uncertainty =       0.042691671050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136244501
  error estimate for blocks of size 2^( 2) =       0.001175273531
  error estimate for blocks of size 2^( 3) =       0.001207689164
  error estimate for blocks of size 2^( 4) =       0.001228766705
  error estimate for blocks of size 2^( 5) =       0.001241261331
  error estimate for blocks of size 2^( 6) =       0.001250126918
  error estimate for blocks of size 2^( 7) =       0.001260583880

      target function =                  N/A
              le_mean =     -16.717306662221
             les_mean =     282.020244786261
             stat err =       0.001245184708
             autocorr =       1.200947351231
              std dev =       1.606918093349
             le_variance =       2.582185758734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582611437594
                                         uncertainty =       0.042691671050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582611437594
                                         uncertainty =       0.042691671050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136244501
  error estimate for blocks of size 2^( 2) =       0.001175273531
  error estimate for blocks of size 2^( 3) =       0.001207689164
  error estimate for blocks of size 2^( 4) =       0.001228766705
  error estimate for blocks of size 2^( 5) =       0.001241261331
  error estimate for blocks of size 2^( 6) =       0.001250126918
  error estimate for blocks of size 2^( 7) =       0.001260583880

      target function =                  N/A
              le_mean =     -16.717306662221
             les_mean =     282.020244786261
             stat err =       0.001245184708
             autocorr =       1.200947351231
              std dev =       1.606918093349
             le_variance =       2.582185758734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717306662221        initial  <--
     9.5367e+23     9.5367e+24             0.0000e+00       -16.717306662221
     3.8147e+24     3.8147e+25             0.0000e+00       -16.717306662221
     1.5259e+25     1.5259e+26             0.0000e+00       -16.717306662221

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1408
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0326e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6724e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.4128
    reference variance = 5.34827
====================================================
  Execution time = 1.3035e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0274e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5256e+00
  Total weights = 1.945133916e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2161e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553866155683
                                         uncertainty =       0.030139919003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553866155683
                                         uncertainty =       0.030139919003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129910030
  error estimate for blocks of size 2^( 2) =       0.001169017038
  error estimate for blocks of size 2^( 3) =       0.001201153151
  error estimate for blocks of size 2^( 4) =       0.001225088650
  error estimate for blocks of size 2^( 5) =       0.001239274730
  error estimate for blocks of size 2^( 6) =       0.001247829575
  error estimate for blocks of size 2^( 7) =       0.001253272715

      target function =                  N/A
              le_mean =     -16.719059146835
             les_mean =     282.052571917573
             stat err =       0.001241366417
             autocorr =       1.207013860127
              std dev =       1.597959654881
             le_variance =       2.553475058627


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671905914684e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+24, overlap shift 9.5367e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719059145892       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719059145892       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+25, overlap shift 3.8147e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719059145892       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719059145892       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+26, overlap shift 1.5259e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719059145892       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719059145892       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182468 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6257e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.538
    reference variance = 2.62333
====================================================
  Execution time = 1.2733e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5040e+00
  Total weights = 1.9457e+06
  Execution time = 2.2459e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.532653761127
                                         uncertainty =       0.027432659415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.532653761127
                                         uncertainty =       0.027432659415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125266419
  error estimate for blocks of size 2^( 2) =       0.001164228841
  error estimate for blocks of size 2^( 3) =       0.001196661446
  error estimate for blocks of size 2^( 4) =       0.001219137623
  error estimate for blocks of size 2^( 5) =       0.001231863393
  error estimate for blocks of size 2^( 6) =       0.001239651701
  error estimate for blocks of size 2^( 7) =       0.001248500806

      target function =                  N/A
              le_mean =     -16.716891823536
             les_mean =     281.958460653068
             stat err =       0.001234788381
             autocorr =       1.204132702411
              std dev =       1.591392492486
             le_variance =       2.532530065142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.532653761127
                                         uncertainty =       0.027432659415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.532653761127
                                         uncertainty =       0.027432659415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125266419
  error estimate for blocks of size 2^( 2) =       0.001164228841
  error estimate for blocks of size 2^( 3) =       0.001196661446
  error estimate for blocks of size 2^( 4) =       0.001219137623
  error estimate for blocks of size 2^( 5) =       0.001231863393
  error estimate for blocks of size 2^( 6) =       0.001239651701
  error estimate for blocks of size 2^( 7) =       0.001248500806

      target function =                  N/A
              le_mean =     -16.716891823536
             les_mean =     281.958460653068
             stat err =       0.001234788381
             autocorr =       1.204132702411
              std dev =       1.591392492486
             le_variance =       2.532530065142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.532653761127
                                         uncertainty =       0.027432659415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.532653761127
                                         uncertainty =       0.027432659415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125266419
  error estimate for blocks of size 2^( 2) =       0.001164228841
  error estimate for blocks of size 2^( 3) =       0.001196661446
  error estimate for blocks of size 2^( 4) =       0.001219137623
  error estimate for blocks of size 2^( 5) =       0.001231863393
  error estimate for blocks of size 2^( 6) =       0.001239651701
  error estimate for blocks of size 2^( 7) =       0.001248500806

      target function =                  N/A
              le_mean =     -16.716891823536
             les_mean =     281.958460653068
             stat err =       0.001234788381
             autocorr =       1.204132702411
              std dev =       1.591392492486
             le_variance =       2.532530065142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.532653761127
                                         uncertainty =       0.027432659415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.532653761127
                                         uncertainty =       0.027432659415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125266419
  error estimate for blocks of size 2^( 2) =       0.001164228841
  error estimate for blocks of size 2^( 3) =       0.001196661446
  error estimate for blocks of size 2^( 4) =       0.001219137623
  error estimate for blocks of size 2^( 5) =       0.001231863393
  error estimate for blocks of size 2^( 6) =       0.001239651701
  error estimate for blocks of size 2^( 7) =       0.001248500806

      target function =                  N/A
              le_mean =     -16.716891823536
             les_mean =     281.958460653068
             stat err =       0.001234788381
             autocorr =       1.204132702411
              std dev =       1.591392492486
             le_variance =       2.532530065142


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716891823536        initial  <--
     9.5367e+24     9.5367e+25             0.0000e+00       -16.716891823536
     3.8147e+25     3.8147e+26             0.0000e+00       -16.716891823536
     1.5259e+26     1.5259e+27             0.0000e+00       -16.716891823536

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0708
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0334e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6719e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.6163
    reference variance = 3.01516
====================================================
  Execution time = 1.2973e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0274e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5144e+00
  Total weights = 1.945774346e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2112e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533955911994
                                         uncertainty =       0.022161658324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533955911994
                                         uncertainty =       0.022161658324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125764116
  error estimate for blocks of size 2^( 2) =       0.001164673301
  error estimate for blocks of size 2^( 3) =       0.001195836476
  error estimate for blocks of size 2^( 4) =       0.001219084545
  error estimate for blocks of size 2^( 5) =       0.001234179305
  error estimate for blocks of size 2^( 6) =       0.001243386255
  error estimate for blocks of size 2^( 7) =       0.001241315014

      target function =                  N/A
              le_mean =     -16.719441210189
             les_mean =     282.054103338145
             stat err =       0.001234491280
             autocorr =       1.202489382364
              std dev =       1.592096353620
             le_variance =       2.534770799211


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671944121019e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+25, overlap shift 9.5367e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719441209248       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719441209248       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+26, overlap shift 3.8147e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719441209248       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719441209248       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+27, overlap shift 1.5259e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719441209248       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719441209248       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183618 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6190e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.6758
    reference variance = 1.89657
====================================================
  Execution time = 1.2744e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5893e+00
  Total weights = 1.9458e+06
  Execution time = 2.2372e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619193598285
                                         uncertainty =       0.040284787493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619193598285
                                         uncertainty =       0.040284787493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144307063
  error estimate for blocks of size 2^( 2) =       0.001183207334
  error estimate for blocks of size 2^( 3) =       0.001215793375
  error estimate for blocks of size 2^( 4) =       0.001239067516
  error estimate for blocks of size 2^( 5) =       0.001254779006
  error estimate for blocks of size 2^( 6) =       0.001265037941
  error estimate for blocks of size 2^( 7) =       0.001266389117

      target function =                  N/A
              le_mean =     -16.717291723413
             les_mean =     282.057175329369
             stat err =       0.001256318395
             autocorr =       1.205353076069
              std dev =       1.618320460303
             le_variance =       2.618961112236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619193598285
                                         uncertainty =       0.040284787493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619193598285
                                         uncertainty =       0.040284787493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144307063
  error estimate for blocks of size 2^( 2) =       0.001183207334
  error estimate for blocks of size 2^( 3) =       0.001215793375
  error estimate for blocks of size 2^( 4) =       0.001239067516
  error estimate for blocks of size 2^( 5) =       0.001254779006
  error estimate for blocks of size 2^( 6) =       0.001265037941
  error estimate for blocks of size 2^( 7) =       0.001266389117

      target function =                  N/A
              le_mean =     -16.717291723413
             les_mean =     282.057175329369
             stat err =       0.001256318395
             autocorr =       1.205353076069
              std dev =       1.618320460303
             le_variance =       2.618961112236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619193598285
                                         uncertainty =       0.040284787493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619193598285
                                         uncertainty =       0.040284787493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144307063
  error estimate for blocks of size 2^( 2) =       0.001183207334
  error estimate for blocks of size 2^( 3) =       0.001215793375
  error estimate for blocks of size 2^( 4) =       0.001239067516
  error estimate for blocks of size 2^( 5) =       0.001254779006
  error estimate for blocks of size 2^( 6) =       0.001265037941
  error estimate for blocks of size 2^( 7) =       0.001266389117

      target function =                  N/A
              le_mean =     -16.717291723413
             les_mean =     282.057175329369
             stat err =       0.001256318395
             autocorr =       1.205353076069
              std dev =       1.618320460303
             le_variance =       2.618961112236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619193598285
                                         uncertainty =       0.040284787493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619193598285
                                         uncertainty =       0.040284787493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144307063
  error estimate for blocks of size 2^( 2) =       0.001183207334
  error estimate for blocks of size 2^( 3) =       0.001215793375
  error estimate for blocks of size 2^( 4) =       0.001239067516
  error estimate for blocks of size 2^( 5) =       0.001254779006
  error estimate for blocks of size 2^( 6) =       0.001265037941
  error estimate for blocks of size 2^( 7) =       0.001266389117

      target function =                  N/A
              le_mean =     -16.717291723413
             les_mean =     282.057175329369
             stat err =       0.001256318395
             autocorr =       1.205353076069
              std dev =       1.618320460303
             le_variance =       2.618961112236


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717291723413        initial  <--
     9.5367e+25     9.5367e+26             0.0000e+00       -16.717291723413
     3.8147e+26     3.8147e+27             0.0000e+00       -16.717291723413
     1.5259e+27     1.5259e+28             0.0000e+00       -16.717291723413

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0534
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0250e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6717e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.4994
    reference variance = 2.54126
====================================================
  Execution time = 1.3027e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0259e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5550e+00
  Total weights = 1.945805856e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1728e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.583077345830
                                         uncertainty =       0.030880356409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.583077345830
                                         uncertainty =       0.030880356409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136354230
  error estimate for blocks of size 2^( 2) =       0.001175811624
  error estimate for blocks of size 2^( 3) =       0.001209544156
  error estimate for blocks of size 2^( 4) =       0.001233482585
  error estimate for blocks of size 2^( 5) =       0.001244740112
  error estimate for blocks of size 2^( 6) =       0.001256522267
  error estimate for blocks of size 2^( 7) =       0.001261839412

      target function =                  N/A
              le_mean =     -16.718192075934
             les_mean =     282.052928899665
             stat err =       0.001249146094
             autocorr =       1.208367406891
              std dev =       1.607073276954
             le_variance =       2.582684517500


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671819207593e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+26, overlap shift 9.5367e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718192075006       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718192075006       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+27, overlap shift 3.8147e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718192075006       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718192075006       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+28, overlap shift 1.5259e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718192075006       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718192075006       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184783 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6206e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.847
    reference variance = 0.970512
====================================================
  Execution time = 1.2761e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5436e+00
  Total weights = 1.9459e+06
  Execution time = 2.2457e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569992078440
                                         uncertainty =       0.029220854587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569992078440
                                         uncertainty =       0.029220854587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134005934
  error estimate for blocks of size 2^( 2) =       0.001172077996
  error estimate for blocks of size 2^( 3) =       0.001204803851
  error estimate for blocks of size 2^( 4) =       0.001227155043
  error estimate for blocks of size 2^( 5) =       0.001240241120
  error estimate for blocks of size 2^( 6) =       0.001249802246
  error estimate for blocks of size 2^( 7) =       0.001255520491

      target function =                  N/A
              le_mean =     -16.718803342408
             les_mean =     282.061976065289
             stat err =       0.001243179725
             autocorr =       1.201813790403
              std dev =       1.603752230877
             le_variance =       2.572021218042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569992078440
                                         uncertainty =       0.029220854587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569992078440
                                         uncertainty =       0.029220854587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134005934
  error estimate for blocks of size 2^( 2) =       0.001172077996
  error estimate for blocks of size 2^( 3) =       0.001204803851
  error estimate for blocks of size 2^( 4) =       0.001227155043
  error estimate for blocks of size 2^( 5) =       0.001240241120
  error estimate for blocks of size 2^( 6) =       0.001249802246
  error estimate for blocks of size 2^( 7) =       0.001255520491

      target function =                  N/A
              le_mean =     -16.718803342408
             les_mean =     282.061976065289
             stat err =       0.001243179725
             autocorr =       1.201813790403
              std dev =       1.603752230877
             le_variance =       2.572021218042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569992078440
                                         uncertainty =       0.029220854587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569992078440
                                         uncertainty =       0.029220854587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134005934
  error estimate for blocks of size 2^( 2) =       0.001172077996
  error estimate for blocks of size 2^( 3) =       0.001204803851
  error estimate for blocks of size 2^( 4) =       0.001227155043
  error estimate for blocks of size 2^( 5) =       0.001240241120
  error estimate for blocks of size 2^( 6) =       0.001249802246
  error estimate for blocks of size 2^( 7) =       0.001255520491

      target function =                  N/A
              le_mean =     -16.718803342408
             les_mean =     282.061976065289
             stat err =       0.001243179725
             autocorr =       1.201813790403
              std dev =       1.603752230877
             le_variance =       2.572021218042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569992078440
                                         uncertainty =       0.029220854587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569992078440
                                         uncertainty =       0.029220854587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134005934
  error estimate for blocks of size 2^( 2) =       0.001172077996
  error estimate for blocks of size 2^( 3) =       0.001204803851
  error estimate for blocks of size 2^( 4) =       0.001227155043
  error estimate for blocks of size 2^( 5) =       0.001240241120
  error estimate for blocks of size 2^( 6) =       0.001249802246
  error estimate for blocks of size 2^( 7) =       0.001255520491

      target function =                  N/A
              le_mean =     -16.718803342408
             les_mean =     282.061976065289
             stat err =       0.001243179725
             autocorr =       1.201813790403
              std dev =       1.603752230877
             le_variance =       2.572021218042


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718803342408        initial  <--
     9.5367e+26     9.5367e+27             0.0000e+00       -16.718803342408
     3.8147e+27     3.8147e+28             0.0000e+00       -16.718803342408
     1.5259e+28     1.5259e+29             0.0000e+00       -16.718803342408

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0983
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0310e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6716e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.6261
    reference variance = 2.61249
====================================================
  Execution time = 1.3008e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0262e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5411e+00
  Total weights = 1.945721791e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1898e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.567857655941
                                         uncertainty =       0.033148473263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.567857655941
                                         uncertainty =       0.033148473263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133012964
  error estimate for blocks of size 2^( 2) =       0.001171841246
  error estimate for blocks of size 2^( 3) =       0.001206260751
  error estimate for blocks of size 2^( 4) =       0.001228437547
  error estimate for blocks of size 2^( 5) =       0.001241097546
  error estimate for blocks of size 2^( 6) =       0.001250011473
  error estimate for blocks of size 2^( 7) =       0.001255611383

      target function =                  N/A
              le_mean =     -16.718493862241
             les_mean =     282.049173191364
             stat err =       0.001243789487
             autocorr =       1.205102549283
              std dev =       1.602347936966
             le_variance =       2.567518911098


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671849386224e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+27, overlap shift 9.5367e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718493861363       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718493861363       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+28, overlap shift 3.8147e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718493861363       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718493861363       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+29, overlap shift 1.5259e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718493861363       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718493861363       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186000 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6204e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.7566
    reference variance = 2.48087
====================================================
  Execution time = 1.2714e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.6378e+00
  Total weights = 1.9456e+06
  Execution time = 2.2531e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670985028016
                                         uncertainty =       0.065711022211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670985028016
                                         uncertainty =       0.065711022211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001155520540
  error estimate for blocks of size 2^( 2) =       0.001192465434
  error estimate for blocks of size 2^( 3) =       0.001224978129
  error estimate for blocks of size 2^( 4) =       0.001248907939
  error estimate for blocks of size 2^( 5) =       0.001264321731
  error estimate for blocks of size 2^( 6) =       0.001272088445
  error estimate for blocks of size 2^( 7) =       0.001272657858

      target function =                  N/A
              le_mean =     -16.717908128573
             les_mean =     282.126238133141
             stat err =       0.001264493993
             autocorr =       1.197507388393
              std dev =       1.634178966014
             le_variance =       2.670540892961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670985028016
                                         uncertainty =       0.065711022211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670985028016
                                         uncertainty =       0.065711022211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001155520540
  error estimate for blocks of size 2^( 2) =       0.001192465434
  error estimate for blocks of size 2^( 3) =       0.001224978129
  error estimate for blocks of size 2^( 4) =       0.001248907939
  error estimate for blocks of size 2^( 5) =       0.001264321731
  error estimate for blocks of size 2^( 6) =       0.001272088445
  error estimate for blocks of size 2^( 7) =       0.001272657858

      target function =                  N/A
              le_mean =     -16.717908128573
             les_mean =     282.126238133141
             stat err =       0.001264493993
             autocorr =       1.197507388393
              std dev =       1.634178966014
             le_variance =       2.670540892961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670985028016
                                         uncertainty =       0.065711022211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670985028016
                                         uncertainty =       0.065711022211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001155520540
  error estimate for blocks of size 2^( 2) =       0.001192465434
  error estimate for blocks of size 2^( 3) =       0.001224978129
  error estimate for blocks of size 2^( 4) =       0.001248907939
  error estimate for blocks of size 2^( 5) =       0.001264321731
  error estimate for blocks of size 2^( 6) =       0.001272088445
  error estimate for blocks of size 2^( 7) =       0.001272657858

      target function =                  N/A
              le_mean =     -16.717908128573
             les_mean =     282.126238133141
             stat err =       0.001264493993
             autocorr =       1.197507388393
              std dev =       1.634178966014
             le_variance =       2.670540892961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670985028016
                                         uncertainty =       0.065711022211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670985028016
                                         uncertainty =       0.065711022211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001155520540
  error estimate for blocks of size 2^( 2) =       0.001192465434
  error estimate for blocks of size 2^( 3) =       0.001224978129
  error estimate for blocks of size 2^( 4) =       0.001248907939
  error estimate for blocks of size 2^( 5) =       0.001264321731
  error estimate for blocks of size 2^( 6) =       0.001272088445
  error estimate for blocks of size 2^( 7) =       0.001272657858

      target function =                  N/A
              le_mean =     -16.717908128573
             les_mean =     282.126238133141
             stat err =       0.001264493993
             autocorr =       1.197507388393
              std dev =       1.634178966014
             le_variance =       2.670540892961


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717908128573        initial  <--
     9.5367e+27     9.5367e+28             0.0000e+00       -16.717908128573
     3.8147e+28     3.8147e+29             0.0000e+00       -16.717908128573
     1.5259e+29     1.5259e+30             0.0000e+00       -16.717908128573

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0971
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0307e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6716e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.7561
    reference variance = 1.61096
====================================================
  Execution time = 1.2958e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0285e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5090e+00
  Total weights = 1.945736094e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1769e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533658549299
                                         uncertainty =       0.025720725540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533658549299
                                         uncertainty =       0.025720725540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125686339
  error estimate for blocks of size 2^( 2) =       0.001164368279
  error estimate for blocks of size 2^( 3) =       0.001196312062
  error estimate for blocks of size 2^( 4) =       0.001218781844
  error estimate for blocks of size 2^( 5) =       0.001231799884
  error estimate for blocks of size 2^( 6) =       0.001240629366
  error estimate for blocks of size 2^( 7) =       0.001246526029

      target function =                  N/A
              le_mean =     -16.717003250637
             les_mean =     281.967167602614
             stat err =       0.001234434281
             autocorr =       1.202544498788
              std dev =       1.591986359189
             le_variance =       2.534420567844


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671700325064e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+28, overlap shift 9.5367e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717003249727       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717003249727       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717003249727       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+28 is 6.353656e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+29, overlap shift 3.8147e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717003249727       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717003249727       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717003249727       residual = 1.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+29 is 1.578089e-33

solving harmonic davidson linear method for identity shift 1.5259e+30, overlap shift 1.5259e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717003249727       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717003249727       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717003249727       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+30 is 3.971035e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187373 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6142e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.4746
    reference variance = 3.87874
====================================================
  Execution time = 1.2723e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5141e+00
  Total weights = 1.9457e+06
  Execution time = 2.2493e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.542817690920
                                         uncertainty =       0.023532187321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.542817690920
                                         uncertainty =       0.023532187321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127464584
  error estimate for blocks of size 2^( 2) =       0.001165511968
  error estimate for blocks of size 2^( 3) =       0.001199197475
  error estimate for blocks of size 2^( 4) =       0.001221666397
  error estimate for blocks of size 2^( 5) =       0.001236144443
  error estimate for blocks of size 2^( 6) =       0.001245136360
  error estimate for blocks of size 2^( 7) =       0.001258652275

      target function =                  N/A
              le_mean =     -16.719358552865
             les_mean =     282.051020234244
             stat err =       0.001240399869
             autocorr =       1.210368480557
              std dev =       1.594501217542
             le_variance =       2.542434132743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.542817690920
                                         uncertainty =       0.023532187321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.542817690920
                                         uncertainty =       0.023532187321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127464584
  error estimate for blocks of size 2^( 2) =       0.001165511968
  error estimate for blocks of size 2^( 3) =       0.001199197475
  error estimate for blocks of size 2^( 4) =       0.001221666397
  error estimate for blocks of size 2^( 5) =       0.001236144443
  error estimate for blocks of size 2^( 6) =       0.001245136360
  error estimate for blocks of size 2^( 7) =       0.001258652275

      target function =                  N/A
              le_mean =     -16.719358552865
             les_mean =     282.051020234244
             stat err =       0.001240399869
             autocorr =       1.210368480557
              std dev =       1.594501217542
             le_variance =       2.542434132743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.542817690920
                                         uncertainty =       0.023532187321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.542817690920
                                         uncertainty =       0.023532187321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127464584
  error estimate for blocks of size 2^( 2) =       0.001165511968
  error estimate for blocks of size 2^( 3) =       0.001199197475
  error estimate for blocks of size 2^( 4) =       0.001221666397
  error estimate for blocks of size 2^( 5) =       0.001236144443
  error estimate for blocks of size 2^( 6) =       0.001245136360
  error estimate for blocks of size 2^( 7) =       0.001258652275

      target function =                  N/A
              le_mean =     -16.719358552865
             les_mean =     282.051020234244
             stat err =       0.001240399869
             autocorr =       1.210368480557
              std dev =       1.594501217542
             le_variance =       2.542434132743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.542817690920
                                         uncertainty =       0.023532187321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.542817690920
                                         uncertainty =       0.023532187321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127464584
  error estimate for blocks of size 2^( 2) =       0.001165511968
  error estimate for blocks of size 2^( 3) =       0.001199197475
  error estimate for blocks of size 2^( 4) =       0.001221666397
  error estimate for blocks of size 2^( 5) =       0.001236144443
  error estimate for blocks of size 2^( 6) =       0.001245136360
  error estimate for blocks of size 2^( 7) =       0.001258652275

      target function =                  N/A
              le_mean =     -16.719358552865
             les_mean =     282.051020234244
             stat err =       0.001240399869
             autocorr =       1.210368480557
              std dev =       1.594501217542
             le_variance =       2.542434132743


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719358552865        initial  <--
     9.5367e+28     9.5367e+29             6.3537e-33       -16.719358552865
     3.8147e+29     3.8147e+30             1.5781e-33       -16.719358552865
     1.5259e+30     1.5259e+31             3.9710e-34       -16.719358552865

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0771
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0224e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6714e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.9296
    reference variance = 1.3454
====================================================
  Execution time = 1.5282e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0290e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5339e+00
  Total weights = 1.945505334e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1823e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560240455109
                                         uncertainty =       0.031851596489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560240455109
                                         uncertainty =       0.031851596489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131223278
  error estimate for blocks of size 2^( 2) =       0.001169879334
  error estimate for blocks of size 2^( 3) =       0.001203606571
  error estimate for blocks of size 2^( 4) =       0.001225186340
  error estimate for blocks of size 2^( 5) =       0.001240393395
  error estimate for blocks of size 2^( 6) =       0.001245714188
  error estimate for blocks of size 2^( 7) =       0.001248443699

      target function =                  N/A
              le_mean =     -16.717125673103
             les_mean =     281.996207595736
             stat err =       0.001239934406
             autocorr =       1.201436315816
              std dev =       1.599816898231
             le_variance =       2.559414107866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671712567310e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+29, overlap shift 9.5367e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717125672172       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717125672172       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+30, overlap shift 3.8147e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717125672172       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717125672172       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+31, overlap shift 1.5259e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717125672172       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717125672172       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188582 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8471e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.3202
    reference variance = 3.05349
====================================================
  Execution time = 1.2700e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5133e+00
  Total weights = 1.9458e+06
  Execution time = 2.2461e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537924888411
                                         uncertainty =       0.024360303859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537924888411
                                         uncertainty =       0.024360303859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126362157
  error estimate for blocks of size 2^( 2) =       0.001166179940
  error estimate for blocks of size 2^( 3) =       0.001198114994
  error estimate for blocks of size 2^( 4) =       0.001222513099
  error estimate for blocks of size 2^( 5) =       0.001238992306
  error estimate for blocks of size 2^( 6) =       0.001246434125
  error estimate for blocks of size 2^( 7) =       0.001257976444

      target function =                  N/A
              le_mean =     -16.717404513126
             les_mean =     281.984920851415
             stat err =       0.001241478993
             autocorr =       1.214849975301
              std dev =       1.592942125124
             le_variance =       2.537464613993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537924888411
                                         uncertainty =       0.024360303859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537924888411
                                         uncertainty =       0.024360303859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126362157
  error estimate for blocks of size 2^( 2) =       0.001166179940
  error estimate for blocks of size 2^( 3) =       0.001198114994
  error estimate for blocks of size 2^( 4) =       0.001222513099
  error estimate for blocks of size 2^( 5) =       0.001238992306
  error estimate for blocks of size 2^( 6) =       0.001246434125
  error estimate for blocks of size 2^( 7) =       0.001257976444

      target function =                  N/A
              le_mean =     -16.717404513126
             les_mean =     281.984920851415
             stat err =       0.001241478993
             autocorr =       1.214849975301
              std dev =       1.592942125124
             le_variance =       2.537464613993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537924888411
                                         uncertainty =       0.024360303859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537924888411
                                         uncertainty =       0.024360303859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126362157
  error estimate for blocks of size 2^( 2) =       0.001166179940
  error estimate for blocks of size 2^( 3) =       0.001198114994
  error estimate for blocks of size 2^( 4) =       0.001222513099
  error estimate for blocks of size 2^( 5) =       0.001238992306
  error estimate for blocks of size 2^( 6) =       0.001246434125
  error estimate for blocks of size 2^( 7) =       0.001257976444

      target function =                  N/A
              le_mean =     -16.717404513126
             les_mean =     281.984920851415
             stat err =       0.001241478993
             autocorr =       1.214849975301
              std dev =       1.592942125124
             le_variance =       2.537464613993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537924888411
                                         uncertainty =       0.024360303859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537924888411
                                         uncertainty =       0.024360303859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126362157
  error estimate for blocks of size 2^( 2) =       0.001166179940
  error estimate for blocks of size 2^( 3) =       0.001198114994
  error estimate for blocks of size 2^( 4) =       0.001222513099
  error estimate for blocks of size 2^( 5) =       0.001238992306
  error estimate for blocks of size 2^( 6) =       0.001246434125
  error estimate for blocks of size 2^( 7) =       0.001257976444

      target function =                  N/A
              le_mean =     -16.717404513126
             les_mean =     281.984920851415
             stat err =       0.001241478993
             autocorr =       1.214849975301
              std dev =       1.592942125124
             le_variance =       2.537464613993


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717404513126        initial  <--
     9.5367e+29     9.5367e+30             0.0000e+00       -16.717404513126
     3.8147e+30     3.8147e+31             0.0000e+00       -16.717404513126
     1.5259e+31     1.5259e+32             0.0000e+00       -16.717404513126

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0503
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6712e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.7206
    reference variance = 2.79632
====================================================
  Execution time = 1.3035e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0288e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.4891e+00
  Total weights = 1.945739777e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2715e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.514113932836
                                         uncertainty =       0.022109474474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.514113932836
                                         uncertainty =       0.022109474474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121205774
  error estimate for blocks of size 2^( 2) =       0.001159382999
  error estimate for blocks of size 2^( 3) =       0.001193356051
  error estimate for blocks of size 2^( 4) =       0.001216062161
  error estimate for blocks of size 2^( 5) =       0.001225762067
  error estimate for blocks of size 2^( 6) =       0.001234720723
  error estimate for blocks of size 2^( 7) =       0.001246476057

      target function =                  N/A
              le_mean =     -16.719655997783
             les_mean =     282.035992075691
             stat err =       0.001230755252
             autocorr =       1.204960315657
              std dev =       1.585649781864
             le_variance =       2.514285230724


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671965599778e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+30, overlap shift 9.5367e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719655996845       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719655996845       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719655996843       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+30 is 5.642540e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+31, overlap shift 3.8147e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719655996845       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719655996845       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719655996845       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+31 is 1.410635e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+32, overlap shift 1.5259e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719655996845       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719655996845       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719655996843       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+32 is 3.526588e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190094 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6313e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.6723
    reference variance = 2.85406
====================================================
  Execution time = 1.2707e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.6073e+00
  Total weights = 1.9458e+06
  Execution time = 2.2475e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.635100987159
                                         uncertainty =       0.067214979015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.635100987159
                                         uncertainty =       0.067214979015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001147873485
  error estimate for blocks of size 2^( 2) =       0.001186336696
  error estimate for blocks of size 2^( 3) =       0.001218407912
  error estimate for blocks of size 2^( 4) =       0.001240000350
  error estimate for blocks of size 2^( 5) =       0.001255405925
  error estimate for blocks of size 2^( 6) =       0.001262239976
  error estimate for blocks of size 2^( 7) =       0.001266984725

      target function =                  N/A
              le_mean =     -16.719120680095
             les_mean =     282.136338113418
             stat err =       0.001256157744
             autocorr =       1.197568356503
              std dev =       1.623364223132
             le_variance =       2.635311400944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.635100987159
                                         uncertainty =       0.067214979015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.635100987159
                                         uncertainty =       0.067214979015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001147873485
  error estimate for blocks of size 2^( 2) =       0.001186336696
  error estimate for blocks of size 2^( 3) =       0.001218407912
  error estimate for blocks of size 2^( 4) =       0.001240000350
  error estimate for blocks of size 2^( 5) =       0.001255405925
  error estimate for blocks of size 2^( 6) =       0.001262239976
  error estimate for blocks of size 2^( 7) =       0.001266984725

      target function =                  N/A
              le_mean =     -16.719120680095
             les_mean =     282.136338113418
             stat err =       0.001256157744
             autocorr =       1.197568356503
              std dev =       1.623364223132
             le_variance =       2.635311400944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.635100987159
                                         uncertainty =       0.067214979015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.635100987159
                                         uncertainty =       0.067214979015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001147873485
  error estimate for blocks of size 2^( 2) =       0.001186336696
  error estimate for blocks of size 2^( 3) =       0.001218407912
  error estimate for blocks of size 2^( 4) =       0.001240000350
  error estimate for blocks of size 2^( 5) =       0.001255405925
  error estimate for blocks of size 2^( 6) =       0.001262239976
  error estimate for blocks of size 2^( 7) =       0.001266984725

      target function =                  N/A
              le_mean =     -16.719120680095
             les_mean =     282.136338113418
             stat err =       0.001256157744
             autocorr =       1.197568356503
              std dev =       1.623364223132
             le_variance =       2.635311400944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.635100987159
                                         uncertainty =       0.067214979015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.635100987159
                                         uncertainty =       0.067214979015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001147873485
  error estimate for blocks of size 2^( 2) =       0.001186336696
  error estimate for blocks of size 2^( 3) =       0.001218407912
  error estimate for blocks of size 2^( 4) =       0.001240000350
  error estimate for blocks of size 2^( 5) =       0.001255405925
  error estimate for blocks of size 2^( 6) =       0.001262239976
  error estimate for blocks of size 2^( 7) =       0.001266984725

      target function =                  N/A
              le_mean =     -16.719120680095
             les_mean =     282.136338113418
             stat err =       0.001256157744
             autocorr =       1.197568356503
              std dev =       1.623364223132
             le_variance =       2.635311400944


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719120680095        initial  <--
     9.5367e+30     9.5367e+31             5.6425e-35       -16.719120680095
     3.8147e+31     3.8147e+32             1.4106e-35       -16.719120680095
     1.5259e+32     1.5259e+33             3.5266e-36       -16.719120680095

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0577
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0376e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6712e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.6617
    reference variance = 2.44381
====================================================
  Execution time = 1.2998e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0278e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5026e+00
  Total weights = 1.945637245e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2185e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.527707021458
                                         uncertainty =       0.020977291479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.527707021458
                                         uncertainty =       0.020977291479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124135393
  error estimate for blocks of size 2^( 2) =       0.001163290554
  error estimate for blocks of size 2^( 3) =       0.001196958216
  error estimate for blocks of size 2^( 4) =       0.001222330347
  error estimate for blocks of size 2^( 5) =       0.001238129553
  error estimate for blocks of size 2^( 6) =       0.001246858506
  error estimate for blocks of size 2^( 7) =       0.001255746864

      target function =                  N/A
              le_mean =     -16.718902550057
             les_mean =     282.024327596835
             stat err =       0.001240766317
             autocorr =       1.218267748760
              std dev =       1.589792955008
             le_variance =       2.527441639794


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671890255006e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+31, overlap shift 9.5367e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718902549116       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718902549116       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+32, overlap shift 3.8147e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718902549116       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718902549116       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+33, overlap shift 1.5259e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718902549116       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718902549116       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191226 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6223e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.9282
    reference variance = 2.70903
====================================================
  Execution time = 1.2727e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.6257e+00
  Total weights = 1.9457e+06
  Execution time = 2.2476e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.655100124206
                                         uncertainty =       0.059174978384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.655100124206
                                         uncertainty =       0.059174978384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001152196002
  error estimate for blocks of size 2^( 2) =       0.001190581491
  error estimate for blocks of size 2^( 3) =       0.001221195192
  error estimate for blocks of size 2^( 4) =       0.001243527526
  error estimate for blocks of size 2^( 5) =       0.001256800135
  error estimate for blocks of size 2^( 6) =       0.001265333116
  error estimate for blocks of size 2^( 7) =       0.001269646780

      target function =                  N/A
              le_mean =     -16.717289017672
             les_mean =     282.093448718355
             stat err =       0.001258826889
             autocorr =       1.193656298716
              std dev =       1.629477284195
             le_variance =       2.655196219708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.655100124206
                                         uncertainty =       0.059174978384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.655100124206
                                         uncertainty =       0.059174978384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001152196002
  error estimate for blocks of size 2^( 2) =       0.001190581491
  error estimate for blocks of size 2^( 3) =       0.001221195192
  error estimate for blocks of size 2^( 4) =       0.001243527526
  error estimate for blocks of size 2^( 5) =       0.001256800135
  error estimate for blocks of size 2^( 6) =       0.001265333116
  error estimate for blocks of size 2^( 7) =       0.001269646780

      target function =                  N/A
              le_mean =     -16.717289017672
             les_mean =     282.093448718355
             stat err =       0.001258826889
             autocorr =       1.193656298716
              std dev =       1.629477284195
             le_variance =       2.655196219708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.655100124206
                                         uncertainty =       0.059174978384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.655100124206
                                         uncertainty =       0.059174978384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001152196002
  error estimate for blocks of size 2^( 2) =       0.001190581491
  error estimate for blocks of size 2^( 3) =       0.001221195192
  error estimate for blocks of size 2^( 4) =       0.001243527526
  error estimate for blocks of size 2^( 5) =       0.001256800135
  error estimate for blocks of size 2^( 6) =       0.001265333116
  error estimate for blocks of size 2^( 7) =       0.001269646780

      target function =                  N/A
              le_mean =     -16.717289017672
             les_mean =     282.093448718355
             stat err =       0.001258826889
             autocorr =       1.193656298716
              std dev =       1.629477284195
             le_variance =       2.655196219708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.655100124206
                                         uncertainty =       0.059174978384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.655100124206
                                         uncertainty =       0.059174978384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001152196002
  error estimate for blocks of size 2^( 2) =       0.001190581491
  error estimate for blocks of size 2^( 3) =       0.001221195192
  error estimate for blocks of size 2^( 4) =       0.001243527526
  error estimate for blocks of size 2^( 5) =       0.001256800135
  error estimate for blocks of size 2^( 6) =       0.001265333116
  error estimate for blocks of size 2^( 7) =       0.001269646780

      target function =                  N/A
              le_mean =     -16.717289017672
             les_mean =     282.093448718355
             stat err =       0.001258826889
             autocorr =       1.193656298716
              std dev =       1.629477284195
             le_variance =       2.655196219708


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717289017672        initial  <--
     9.5367e+31     9.5367e+32             0.0000e+00       -16.717289017672
     3.8147e+32     3.8147e+33             0.0000e+00       -16.717289017672
     1.5259e+33     1.5259e+34             0.0000e+00       -16.717289017672

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0804
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0313e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6714e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.9031
    reference variance = 1.62214
====================================================
  Execution time = 1.3041e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0227e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.4982e+00
  Total weights = 1.945765563e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2404e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.525152518602
                                         uncertainty =       0.031322072049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.525152518602
                                         uncertainty =       0.031322072049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001123627466
  error estimate for blocks of size 2^( 2) =       0.001161815788
  error estimate for blocks of size 2^( 3) =       0.001194538898
  error estimate for blocks of size 2^( 4) =       0.001217039550
  error estimate for blocks of size 2^( 5) =       0.001230303488
  error estimate for blocks of size 2^( 6) =       0.001238944434
  error estimate for blocks of size 2^( 7) =       0.001243285260

      target function =                  N/A
              le_mean =     -16.717629648441
             les_mean =     281.977329390307
             stat err =       0.001232393183
             autocorr =       1.202967464214
              std dev =       1.589074626187
             le_variance =       2.525158167590


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671762964844e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+32, overlap shift 9.5367e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717629647547       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717629647547       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+33, overlap shift 3.8147e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717629647547       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717629647547       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+34, overlap shift 1.5259e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717629647547       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717629647547       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194680 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6292e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.8799
    reference variance = 2.54158
====================================================
  Execution time = 1.2723e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5259e+00
  Total weights = 1.9462e+06
  Execution time = 2.2535e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552372710095
                                         uncertainty =       0.027621594934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552372710095
                                         uncertainty =       0.027621594934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129489456
  error estimate for blocks of size 2^( 2) =       0.001168127654
  error estimate for blocks of size 2^( 3) =       0.001200928686
  error estimate for blocks of size 2^( 4) =       0.001223787024
  error estimate for blocks of size 2^( 5) =       0.001240959158
  error estimate for blocks of size 2^( 6) =       0.001247497292
  error estimate for blocks of size 2^( 7) =       0.001253159947

      target function =                  N/A
              le_mean =     -16.717089486899
             les_mean =     281.986961730129
             stat err =       0.001241350855
             autocorr =       1.207882623058
              std dev =       1.597364864232
             le_variance =       2.551574509484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552372710095
                                         uncertainty =       0.027621594934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552372710095
                                         uncertainty =       0.027621594934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129489456
  error estimate for blocks of size 2^( 2) =       0.001168127654
  error estimate for blocks of size 2^( 3) =       0.001200928686
  error estimate for blocks of size 2^( 4) =       0.001223787024
  error estimate for blocks of size 2^( 5) =       0.001240959158
  error estimate for blocks of size 2^( 6) =       0.001247497292
  error estimate for blocks of size 2^( 7) =       0.001253159947

      target function =                  N/A
              le_mean =     -16.717089486899
             les_mean =     281.986961730129
             stat err =       0.001241350855
             autocorr =       1.207882623058
              std dev =       1.597364864232
             le_variance =       2.551574509484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552372710095
                                         uncertainty =       0.027621594934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552372710095
                                         uncertainty =       0.027621594934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129489456
  error estimate for blocks of size 2^( 2) =       0.001168127654
  error estimate for blocks of size 2^( 3) =       0.001200928686
  error estimate for blocks of size 2^( 4) =       0.001223787024
  error estimate for blocks of size 2^( 5) =       0.001240959158
  error estimate for blocks of size 2^( 6) =       0.001247497292
  error estimate for blocks of size 2^( 7) =       0.001253159947

      target function =                  N/A
              le_mean =     -16.717089486899
             les_mean =     281.986961730129
             stat err =       0.001241350855
             autocorr =       1.207882623058
              std dev =       1.597364864232
             le_variance =       2.551574509484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552372710095
                                         uncertainty =       0.027621594934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552372710095
                                         uncertainty =       0.027621594934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129489456
  error estimate for blocks of size 2^( 2) =       0.001168127654
  error estimate for blocks of size 2^( 3) =       0.001200928686
  error estimate for blocks of size 2^( 4) =       0.001223787024
  error estimate for blocks of size 2^( 5) =       0.001240959158
  error estimate for blocks of size 2^( 6) =       0.001247497292
  error estimate for blocks of size 2^( 7) =       0.001253159947

      target function =                  N/A
              le_mean =     -16.717089486899
             les_mean =     281.986961730129
             stat err =       0.001241350855
             autocorr =       1.207882623058
              std dev =       1.597364864232
             le_variance =       2.551574509484


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717089486899        initial  <--
     9.5367e+32     9.5367e+33             0.0000e+00       -16.717089486899
     3.8147e+33     3.8147e+34             0.0000e+00       -16.717089486899
     1.5259e+34     1.5259e+35             0.0000e+00       -16.717089486899

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1168
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0422e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6717e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.6839
    reference variance = 1.99268
====================================================
  Execution time = 1.3064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0273e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5291e+00
  Total weights = 1.945761904e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1903e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556558896893
                                         uncertainty =       0.024120450014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556558896893
                                         uncertainty =       0.024120450014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130649118
  error estimate for blocks of size 2^( 2) =       0.001169002017
  error estimate for blocks of size 2^( 3) =       0.001202336255
  error estimate for blocks of size 2^( 4) =       0.001224912405
  error estimate for blocks of size 2^( 5) =       0.001239081904
  error estimate for blocks of size 2^( 6) =       0.001248424086
  error estimate for blocks of size 2^( 7) =       0.001250498525

      target function =                  N/A
              le_mean =     -16.717901133463
             les_mean =     282.017288340269
             stat err =       0.001240729230
             autocorr =       1.204199191465
              std dev =       1.599004899802
             le_variance =       2.556816669591


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671790113346e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+33, overlap shift 9.5367e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717901132544       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717901132544       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+34, overlap shift 3.8147e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717901132544       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717901132544       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+35, overlap shift 1.5259e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717901132544       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717901132544       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198209 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6265e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.4779
    reference variance = 5.38432
====================================================
  Execution time = 1.2740e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5629e+00
  Total weights = 1.9460e+06
  Execution time = 2.2545e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592103502362
                                         uncertainty =       0.049877253219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592103502362
                                         uncertainty =       0.049877253219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138377084
  error estimate for blocks of size 2^( 2) =       0.001177195899
  error estimate for blocks of size 2^( 3) =       0.001210064986
  error estimate for blocks of size 2^( 4) =       0.001232850303
  error estimate for blocks of size 2^( 5) =       0.001247425400
  error estimate for blocks of size 2^( 6) =       0.001262803818
  error estimate for blocks of size 2^( 7) =       0.001270157287

      target function =                  N/A
              le_mean =     -16.717264616836
             les_mean =     282.029802803038
             stat err =       0.001253309202
             autocorr =       1.212115952784
              std dev =       1.609934070195
             le_variance =       2.591887710374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592103502362
                                         uncertainty =       0.049877253219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592103502362
                                         uncertainty =       0.049877253219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138377084
  error estimate for blocks of size 2^( 2) =       0.001177195899
  error estimate for blocks of size 2^( 3) =       0.001210064986
  error estimate for blocks of size 2^( 4) =       0.001232850303
  error estimate for blocks of size 2^( 5) =       0.001247425400
  error estimate for blocks of size 2^( 6) =       0.001262803818
  error estimate for blocks of size 2^( 7) =       0.001270157287

      target function =                  N/A
              le_mean =     -16.717264616836
             les_mean =     282.029802803038
             stat err =       0.001253309202
             autocorr =       1.212115952784
              std dev =       1.609934070195
             le_variance =       2.591887710374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592103502362
                                         uncertainty =       0.049877253219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592103502362
                                         uncertainty =       0.049877253219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138377084
  error estimate for blocks of size 2^( 2) =       0.001177195899
  error estimate for blocks of size 2^( 3) =       0.001210064986
  error estimate for blocks of size 2^( 4) =       0.001232850303
  error estimate for blocks of size 2^( 5) =       0.001247425400
  error estimate for blocks of size 2^( 6) =       0.001262803818
  error estimate for blocks of size 2^( 7) =       0.001270157287

      target function =                  N/A
              le_mean =     -16.717264616836
             les_mean =     282.029802803038
             stat err =       0.001253309202
             autocorr =       1.212115952784
              std dev =       1.609934070195
             le_variance =       2.591887710374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592103502362
                                         uncertainty =       0.049877253219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592103502362
                                         uncertainty =       0.049877253219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138377084
  error estimate for blocks of size 2^( 2) =       0.001177195899
  error estimate for blocks of size 2^( 3) =       0.001210064986
  error estimate for blocks of size 2^( 4) =       0.001232850303
  error estimate for blocks of size 2^( 5) =       0.001247425400
  error estimate for blocks of size 2^( 6) =       0.001262803818
  error estimate for blocks of size 2^( 7) =       0.001270157287

      target function =                  N/A
              le_mean =     -16.717264616836
             les_mean =     282.029802803038
             stat err =       0.001253309202
             autocorr =       1.212115952784
              std dev =       1.609934070195
             le_variance =       2.591887710374


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717264616836        initial  <--
     9.5367e+33     9.5367e+34             0.0000e+00       -16.717264616836
     3.8147e+34     3.8147e+35             0.0000e+00       -16.717264616836
     1.5259e+35     1.5259e+36             0.0000e+00       -16.717264616836

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1360
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0415e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6714e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.3706
    reference variance = 3.14547
====================================================
  Execution time = 1.3003e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0228e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.6694e+00
  Total weights = 1.945426449e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2363e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.691119827816
                                         uncertainty =       0.114932029667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.691119827816
                                         uncertainty =       0.114932029667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001161553199
  error estimate for blocks of size 2^( 2) =       0.001199621738
  error estimate for blocks of size 2^( 3) =       0.001231515332
  error estimate for blocks of size 2^( 4) =       0.001254106664
  error estimate for blocks of size 2^( 5) =       0.001268208984
  error estimate for blocks of size 2^( 6) =       0.001279955468
  error estimate for blocks of size 2^( 7) =       0.001286691303

      target function =                  N/A
              le_mean =     -16.716812207650
             les_mean =     282.121214149201
             stat err =       0.001272240605
             autocorr =       1.199665844009
              std dev =       1.642710570796
             le_variance =       2.698498019404


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671681220765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+34, overlap shift 9.5367e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716812206709       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716812206709       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+35, overlap shift 3.8147e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716812206709       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716812206709       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+36, overlap shift 1.5259e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716812206709       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716812206709       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6250e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.6512
    reference variance = 2.0641
====================================================
  Execution time = 1.2737e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5347e+00
  Total weights = 1.9454e+06
  Execution time = 2.2563e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564638940511
                                         uncertainty =       0.031499966322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564638940511
                                         uncertainty =       0.031499966322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132297594
  error estimate for blocks of size 2^( 2) =       0.001171301540
  error estimate for blocks of size 2^( 3) =       0.001203425331
  error estimate for blocks of size 2^( 4) =       0.001224091798
  error estimate for blocks of size 2^( 5) =       0.001238428302
  error estimate for blocks of size 2^( 6) =       0.001247098407
  error estimate for blocks of size 2^( 7) =       0.001255532262

      target function =                  N/A
              le_mean =     -16.718287923689
             les_mean =     282.035852392031
             stat err =       0.001241287692
             autocorr =       1.201776562111
              std dev =       1.601336234356
             le_variance =       2.564277735462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564638940511
                                         uncertainty =       0.031499966322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564638940511
                                         uncertainty =       0.031499966322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132297594
  error estimate for blocks of size 2^( 2) =       0.001171301540
  error estimate for blocks of size 2^( 3) =       0.001203425331
  error estimate for blocks of size 2^( 4) =       0.001224091798
  error estimate for blocks of size 2^( 5) =       0.001238428302
  error estimate for blocks of size 2^( 6) =       0.001247098407
  error estimate for blocks of size 2^( 7) =       0.001255532262

      target function =                  N/A
              le_mean =     -16.718287923689
             les_mean =     282.035852392031
             stat err =       0.001241287692
             autocorr =       1.201776562111
              std dev =       1.601336234356
             le_variance =       2.564277735462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564638940511
                                         uncertainty =       0.031499966322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564638940511
                                         uncertainty =       0.031499966322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132297594
  error estimate for blocks of size 2^( 2) =       0.001171301540
  error estimate for blocks of size 2^( 3) =       0.001203425331
  error estimate for blocks of size 2^( 4) =       0.001224091798
  error estimate for blocks of size 2^( 5) =       0.001238428302
  error estimate for blocks of size 2^( 6) =       0.001247098407
  error estimate for blocks of size 2^( 7) =       0.001255532262

      target function =                  N/A
              le_mean =     -16.718287923689
             les_mean =     282.035852392031
             stat err =       0.001241287692
             autocorr =       1.201776562111
              std dev =       1.601336234356
             le_variance =       2.564277735462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564638940511
                                         uncertainty =       0.031499966322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564638940511
                                         uncertainty =       0.031499966322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132297594
  error estimate for blocks of size 2^( 2) =       0.001171301540
  error estimate for blocks of size 2^( 3) =       0.001203425331
  error estimate for blocks of size 2^( 4) =       0.001224091798
  error estimate for blocks of size 2^( 5) =       0.001238428302
  error estimate for blocks of size 2^( 6) =       0.001247098407
  error estimate for blocks of size 2^( 7) =       0.001255532262

      target function =                  N/A
              le_mean =     -16.718287923689
             les_mean =     282.035852392031
             stat err =       0.001241287692
             autocorr =       1.201776562111
              std dev =       1.601336234356
             le_variance =       2.564277735462


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718287923689        initial  <--
     9.5367e+34     9.5367e+35             0.0000e+00       -16.718287923689
     3.8147e+35     3.8147e+36             0.0000e+00       -16.718287923689
     1.5259e+36     1.5259e+37             0.0000e+00       -16.718287923689

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1391
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0399e+01 secs
  Total Execution time = 2.4375e+03 secs

=========================================================
  A new xml input file : H2O.s059.cont.xml
