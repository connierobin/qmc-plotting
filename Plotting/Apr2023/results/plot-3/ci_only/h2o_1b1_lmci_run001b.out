Rank =    0  Free Memory = 58552 MB
Rank =    1  Free Memory = 58539 MB
Rank =    2  Free Memory = 58539 MB
Rank =    3  Free Memory = 58539 MB
Rank =    4  Free Memory = 58539 MB
Rank =    5  Free Memory = 58539 MB
Rank =    6  Free Memory = 58539 MB
Rank =    7  Free Memory = 58539 MB
Rank =    8  Free Memory = 58539 MB
Rank =    9  Free Memory = 58539 MB
Rank =   10  Free Memory = 58539 MB
Rank =   11  Free Memory = 58539 MB
Rank =   12  Free Memory = 58539 MB
Rank =   13  Free Memory = 58539 MB
Rank =   14  Free Memory = 58539 MB
Rank =   15  Free Memory = 58531 MB
Rank =   16  Free Memory = 58525 MB
Rank =   17  Free Memory = 58524 MB
Rank =   18  Free Memory = 58524 MB
Rank =   19  Free Memory = 58524 MB
Rank =   20  Free Memory = 58524 MB
Rank =   21  Free Memory = 58524 MB
Rank =   22  Free Memory = 58524 MB
Rank =   23  Free Memory = 58524 MB
Rank =   24  Free Memory = 54722 MB
Rank =   25  Free Memory = 54722 MB
Rank =   26  Free Memory = 54721 MB
Rank =   27  Free Memory = 54721 MB
Rank =   28  Free Memory = 54721 MB
Rank =   29  Free Memory = 54721 MB
Rank =   30  Free Memory = 54721 MB
Rank =   31  Free Memory = 54721 MB
Rank =   32  Free Memory = 54721 MB
Rank =   33  Free Memory = 54721 MB
Rank =   34  Free Memory = 54721 MB
Rank =   35  Free Memory = 54721 MB
Rank =   36  Free Memory = 54721 MB
Rank =   37  Free Memory = 54721 MB
Rank =   38  Free Memory = 54721 MB
Rank =   39  Free Memory = 54721 MB
Rank =   40  Free Memory = 54721 MB
Rank =   41  Free Memory = 54721 MB
Rank =   42  Free Memory = 54721 MB
Rank =   43  Free Memory = 54721 MB
Rank =   44  Free Memory = 54721 MB
Rank =   45  Free Memory = 54721 MB
Rank =   46  Free Memory = 54721 MB
Rank =   47  Free Memory = 54721 MB
Rank =   48  Free Memory = 53851 MB
Rank =   49  Free Memory = 53851 MB
Rank =   50  Free Memory = 53851 MB
Rank =   51  Free Memory = 53851 MB
Rank =   52  Free Memory = 53851 MB
Rank =   53  Free Memory = 53851 MB
Rank =   54  Free Memory = 53851 MB
Rank =   55  Free Memory = 53851 MB
Rank =   56  Free Memory = 53851 MB
Rank =   57  Free Memory = 53851 MB
Rank =   58  Free Memory = 53851 MB
Rank =   59  Free Memory = 53851 MB
Rank =   60  Free Memory = 53851 MB
Rank =   61  Free Memory = 53851 MB
Rank =   62  Free Memory = 53851 MB
Rank =   63  Free Memory = 53851 MB
Rank =   64  Free Memory = 53851 MB
Rank =   65  Free Memory = 53851 MB
Rank =   66  Free Memory = 53851 MB
Rank =   67  Free Memory = 53851 MB
Rank =   68  Free Memory = 53851 MB
Rank =   69  Free Memory = 53851 MB
Rank =   70  Free Memory = 53851 MB
Rank =   71  Free Memory = 53851 MB
Rank =   72  Free Memory = 56897 MB
Rank =   73  Free Memory = 56897 MB
Rank =   74  Free Memory = 56897 MB
Rank =   75  Free Memory = 56897 MB
Rank =   76  Free Memory = 56897 MB
Rank =   77  Free Memory = 56897 MB
Rank =   78  Free Memory = 56897 MB
Rank =   79  Free Memory = 56897 MB
Rank =   80  Free Memory = 56897 MB
Rank =   81  Free Memory = 56897 MB
Rank =   82  Free Memory = 56897 MB
Rank =   83  Free Memory = 56897 MB
Rank =   84  Free Memory = 56897 MB
Rank =   85  Free Memory = 56897 MB
Rank =   86  Free Memory = 56897 MB
Rank =   87  Free Memory = 56897 MB
Rank =   88  Free Memory = 56897 MB
Rank =   89  Free Memory = 56897 MB
Rank =   90  Free Memory = 56897 MB
Rank =   91  Free Memory = 56890 MB
Rank =   92  Free Memory = 56889 MB
Rank =   93  Free Memory = 56889 MB
Rank =   94  Free Memory = 56889 MB
Rank =   95  Free Memory = 56889 MB
  Input file(s): opt_h2o_1b1_lmci_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 96
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 96
  MPI ranks per node        = 24
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_lmci_run001b.xml

  Project = H2O
  date    = 2023-05-02 09:55:14 PDT
  host    = n0088.savio2

 Random Number
 -------------
  Offset for the random number seeds based on time: 114

  Range of prime numbers to use as seeds over processors and threads = 641-1301


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0
  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 10.1859

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 12.7057

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 12.7057

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 0.991778
Norm of qchem ci vector (sum of qchem_ci^2): 0
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 1.075

  Adding pseudopotential for H1
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1e-10
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 0.001
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 0.001

  Adding pseudopotential for H2
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1e-10
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 0.001
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 0.001
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 0.2058 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAB source=e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 74
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8068
    reference variance = 1.7327
====================================================
  Execution time = 1.3493e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0259e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5002e+00
  Total weights = 1.945601989e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2539e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529474651777
                                         uncertainty =       0.021579994569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529474651777
                                         uncertainty =       0.021579994569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124530028
  error estimate for blocks of size 2^( 2) =       0.001164102423
  error estimate for blocks of size 2^( 3) =       0.001196531128
  error estimate for blocks of size 2^( 4) =       0.001220390549
  error estimate for blocks of size 2^( 5) =       0.001237413068
  error estimate for blocks of size 2^( 6) =       0.001249470337
  error estimate for blocks of size 2^( 7) =       0.001254530381

      target function =                  N/A
              le_mean =     -16.718074102563
             les_mean =     281.994205625248
             stat err =       0.001240451084
             autocorr =       1.216794315734
              std dev =       1.590351061876
             le_variance =       2.529216500009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.671807410256e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718074101650       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718108056150       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718109149500       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718108749888       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718108761327       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 8.840909e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718074101650       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718087893029       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718087965493       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 3.806983e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718074101650       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718078187602       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718078184010       residual = 3.90e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 1.160929e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.302390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7056e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001 7.068179e-01                 3 1 ON  0
ci_0002 6.797864e-01                 3 1 ON  1
ci_0003 -4.823260e-02                3 1 ON  2
ci_0004 -4.658512e-02                3 1 ON  3
ci_0005 -4.629016e-02                3 1 ON  4
ci_0006 -4.347222e-02                3 1 ON  5
ci_0007 -3.128791e-02                3 1 ON  6
ci_0008 -3.128275e-02                3 1 ON  7
ci_0009 -3.226718e-02                3 1 ON  8
ci_0010 -3.061053e-02                3 1 ON  9
ci_0011 -2.693406e-02                3 1 ON  10
ci_0012 -2.582221e-02                3 1 ON  11
ci_0013 2.726031e-02                 3 1 ON  12
ci_0014 2.696533e-02                 3 1 ON  13
ci_0015 2.769550e-02                 3 1 ON  14
ci_0016 2.638786e-02                 3 1 ON  15
ci_0017 2.467468e-02                 3 1 ON  16
ci_0018 2.331619e-02                 3 1 ON  17
ci_0019 2.049318e-02                 3 1 ON  18
ci_0020 1.940777e-02                 3 1 ON  19
ci_0021 1.852333e-02                 3 1 ON  20
ci_0022 1.861312e-02                 3 1 ON  21
ci_0023 -1.993910e-02                3 1 ON  22
ci_0024 -1.844830e-02                3 1 ON  23
ci_0025 -1.853681e-02                3 1 ON  24
ci_0026 -1.793292e-02                3 1 ON  25
ci_0027 -1.777491e-02                3 1 ON  26
ci_0028 -1.734376e-02                3 1 ON  27
ci_0029 -1.491372e-02                3 1 ON  28
ci_0030 -1.623022e-02                3 1 ON  29
ci_0031 1.516394e-02                 3 1 ON  30
ci_0032 1.456206e-02                 3 1 ON  31
ci_0033 1.657920e-02                 3 1 ON  32
ci_0034 1.576175e-02                 3 1 ON  33
ci_0035 1.706305e-02                 3 1 ON  34
ci_0036 1.736703e-02                 3 1 ON  35
ci_0037 -1.550964e-02                3 1 ON  36
ci_0038 -1.395186e-02                3 1 ON  37
ci_0039 -1.587909e-02                3 1 ON  38
ci_0040 -1.519159e-02                3 1 ON  39
ci_0041 1.626821e-02                 3 1 ON  40
ci_0042 1.567936e-02                 3 1 ON  41
ci_0043 -1.468215e-02                3 1 ON  42
ci_0044 -1.597010e-02                3 1 ON  43
ci_0045 1.516647e-02                 3 1 ON  44
ci_0046 1.581418e-02                 3 1 ON  45
ci_0047 -1.477428e-02                3 1 ON  46
ci_0048 -1.402936e-02                3 1 ON  47
ci_0049 -1.271787e-02                3 1 ON  48
ci_0050 -1.251959e-02                3 1 ON  49
ci_0051 -1.325798e-02                3 1 ON  50
ci_0052 -1.247836e-02                3 1 ON  51
ci_0053 -1.337271e-02                3 1 ON  52
ci_0054 -1.233564e-02                3 1 ON  53
ci_0055 1.339539e-02                 3 1 ON  54
ci_0056 1.352114e-02                 3 1 ON  55
ci_0057 1.377859e-02                 3 1 ON  56
ci_0058 1.296454e-02                 3 1 ON  57
ci_0059 -1.344699e-02                3 1 ON  58
ci_0060 -1.254913e-02                3 1 ON  59
ci_0061 -1.301268e-02                3 1 ON  60
ci_0062 -1.242328e-02                3 1 ON  61
ci_0063 -1.183295e-02                3 1 ON  62
ci_0064 -1.109761e-02                3 1 ON  63
ci_0065 -1.100738e-02                3 1 ON  64
ci_0066 -1.128231e-02                3 1 ON  65
ci_0067 -1.159472e-02                3 1 ON  66
ci_0068 -1.052062e-02                3 1 ON  67
ci_0069 1.135454e-02                 3 1 ON  68
ci_0070 1.012474e-02                 3 1 ON  69
ci_0071 9.757871e-03                 3 1 ON  70
ci_0072 1.014437e-02                 3 1 ON  71
ci_0073 1.116383e-02                 3 1 ON  72
ci_0074 1.081062e-02                 3 1 ON  73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.6915
    reference variance = 1.75026
====================================================
  Execution time = 1.2940e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5188e+00
  Total weights = 1.9459e+06
  Execution time = 2.2241e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546545883209
                                         uncertainty =       0.027053686136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546545883209
                                         uncertainty =       0.027053686136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128414089
  error estimate for blocks of size 2^( 2) =       0.001166439191
  error estimate for blocks of size 2^( 3) =       0.001200337279
  error estimate for blocks of size 2^( 4) =       0.001222835774
  error estimate for blocks of size 2^( 5) =       0.001237771101
  error estimate for blocks of size 2^( 6) =       0.001244421001
  error estimate for blocks of size 2^( 7) =       0.001243019289

      target function =                  N/A
              le_mean =     -16.717288623128
             les_mean =     282.000516041785
             stat err =       0.001237011791
             autocorr =       1.201740448511
              std dev =       1.595844040912
             le_variance =       2.546718202913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547190049488
                                         uncertainty =       0.027049697140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547190049488
                                         uncertainty =       0.027049697140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128555984
  error estimate for blocks of size 2^( 2) =       0.001166573018
  error estimate for blocks of size 2^( 3) =       0.001200452935
  error estimate for blocks of size 2^( 4) =       0.001222966796
  error estimate for blocks of size 2^( 5) =       0.001237910509
  error estimate for blocks of size 2^( 6) =       0.001244516199
  error estimate for blocks of size 2^( 7) =       0.001243132220

      target function =                  N/A
              le_mean =     -16.717272146301
             les_mean =     281.986632603900
             stat err =       0.001237131431
             autocorr =       1.201670683702
              std dev =       1.596044714138
             le_variance =       2.547358729527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547073429359
                                         uncertainty =       0.027050043230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547073429359
                                         uncertainty =       0.027050043230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128530258
  error estimate for blocks of size 2^( 2) =       0.001166549297
  error estimate for blocks of size 2^( 3) =       0.001200431544
  error estimate for blocks of size 2^( 4) =       0.001222942996
  error estimate for blocks of size 2^( 5) =       0.001237884382
  error estimate for blocks of size 2^( 6) =       0.001244496133
  error estimate for blocks of size 2^( 7) =       0.001243105794

      target function =                  N/A
              le_mean =     -16.717272032869
             les_mean =     281.986334924525
             stat err =       0.001237107326
             autocorr =       1.201678640737
              std dev =       1.596008332500
             le_variance =       2.547242597409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546609603293
                                         uncertainty =       0.027053360217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546609603293
                                         uncertainty =       0.027053360217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128428099
  error estimate for blocks of size 2^( 2) =       0.001166455100
  error estimate for blocks of size 2^( 3) =       0.001200350323
  error estimate for blocks of size 2^( 4) =       0.001222851968
  error estimate for blocks of size 2^( 5) =       0.001237788967
  error estimate for blocks of size 2^( 6) =       0.001244431899
  error estimate for blocks of size 2^( 7) =       0.001243028013

      target function =                  N/A
              le_mean =     -16.717282787101
             les_mean =     281.988068304740
             stat err =       0.001237025212
             autocorr =       1.201736683683
              std dev =       1.595863854605
             le_variance =       2.546781442434


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717288623128        initial  <--
     2.5000e-01     2.5000e+00             8.8409e-04       -16.717272146301
     1.0000e+00     1.0000e+01             3.8070e-04       -16.717272032869
     4.0000e+00     4.0000e+01             1.1609e-04       -16.717282787101

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1956
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1258e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6749e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8215
    reference variance = 1.58899
====================================================
  Execution time = 1.3352e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0259e+04
  VMC Eavg = -1.6721e+01
  VMC Evar = 2.4900e+00
  Total weights = 1.945557049e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2235e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.517362561274
                                         uncertainty =       0.032173559835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.517362561274
                                         uncertainty =       0.032173559835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121813144
  error estimate for blocks of size 2^( 2) =       0.001160829150
  error estimate for blocks of size 2^( 3) =       0.001194907636
  error estimate for blocks of size 2^( 4) =       0.001215994267
  error estimate for blocks of size 2^( 5) =       0.001230436731
  error estimate for blocks of size 2^( 6) =       0.001239883055
  error estimate for blocks of size 2^( 7) =       0.001243629618

      target function =                  N/A
              le_mean =     -16.721392410825
             les_mean =     282.094998547336
             stat err =       0.001232485918
             autocorr =       1.207043392987
              std dev =       1.586508746354
             le_variance =       2.517010002257


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.672139241083e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.721392409960       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.721399110619       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.721400484970       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.721400448251       residual = 2.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 1.359000e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.721392409960       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.721394188722       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.721394567618       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.721394562482       residual = 6.14e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 3.547011e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.721392409960       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.721392861634       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.721392958948       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.721392957918       residual = 4.40e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 9.006246e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.303905 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6582e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 7.067131e-01 3 1  ON 0
ci_0002                 6.799169e-01 3 1  ON 1
ci_0003                -4.814065e-02 3 1  ON 2
ci_0004                -4.642232e-02 3 1  ON 3
ci_0005                -4.621835e-02 3 1  ON 4
ci_0006                -4.354226e-02 3 1  ON 5
ci_0007                -3.118516e-02 3 1  ON 6
ci_0008                -3.133405e-02 3 1  ON 7
ci_0009                -3.231886e-02 3 1  ON 8
ci_0010                -3.056795e-02 3 1  ON 9
ci_0011                -2.687850e-02 3 1  ON 10
ci_0012                -2.560741e-02 3 1  ON 11
ci_0013                 2.740409e-02 3 1  ON 12
ci_0014                 2.709224e-02 3 1  ON 13
ci_0015                 2.758786e-02 3 1  ON 14
ci_0016                 2.635963e-02 3 1  ON 15
ci_0017                 2.492273e-02 3 1  ON 16
ci_0018                 2.319794e-02 3 1  ON 17
ci_0019                 2.066585e-02 3 1  ON 18
ci_0020                 1.927902e-02 3 1  ON 19
ci_0021                 1.840287e-02 3 1  ON 20
ci_0022                 1.858609e-02 3 1  ON 21
ci_0023                -2.018218e-02 3 1  ON 22
ci_0024                -1.835591e-02 3 1  ON 23
ci_0025                -1.867786e-02 3 1  ON 24
ci_0026                -1.781181e-02 3 1  ON 25
ci_0027                -1.781704e-02 3 1  ON 26
ci_0028                -1.746470e-02 3 1  ON 27
ci_0029                -1.474973e-02 3 1  ON 28
ci_0030                -1.637701e-02 3 1  ON 29
ci_0031                 1.526711e-02 3 1  ON 30
ci_0032                 1.456830e-02 3 1  ON 31
ci_0033                 1.666377e-02 3 1  ON 32
ci_0034                 1.576294e-02 3 1  ON 33
ci_0035                 1.690438e-02 3 1  ON 34
ci_0036                 1.722624e-02 3 1  ON 35
ci_0037                -1.552229e-02 3 1  ON 36
ci_0038                -1.393484e-02 3 1  ON 37
ci_0039                -1.574791e-02 3 1  ON 38
ci_0040                -1.520811e-02 3 1  ON 39
ci_0041                 1.631469e-02 3 1  ON 40
ci_0042                 1.555848e-02 3 1  ON 41
ci_0043                -1.463212e-02 3 1  ON 42
ci_0044                -1.602685e-02 3 1  ON 43
ci_0045                 1.513445e-02 3 1  ON 44
ci_0046                 1.587209e-02 3 1  ON 45
ci_0047                -1.469453e-02 3 1  ON 46
ci_0048                -1.412373e-02 3 1  ON 47
ci_0049                -1.249091e-02 3 1  ON 48
ci_0050                -1.257708e-02 3 1  ON 49
ci_0051                -1.315513e-02 3 1  ON 50
ci_0052                -1.234292e-02 3 1  ON 51
ci_0053                -1.343756e-02 3 1  ON 52
ci_0054                -1.219917e-02 3 1  ON 53
ci_0055                 1.359934e-02 3 1  ON 54
ci_0056                 1.345977e-02 3 1  ON 55
ci_0057                 1.387987e-02 3 1  ON 56
ci_0058                 1.283247e-02 3 1  ON 57
ci_0059                -1.365855e-02 3 1  ON 58
ci_0060                -1.218822e-02 3 1  ON 59
ci_0061                -1.294584e-02 3 1  ON 60
ci_0062                -1.242831e-02 3 1  ON 61
ci_0063                -1.179342e-02 3 1  ON 62
ci_0064                -1.102932e-02 3 1  ON 63
ci_0065                -1.123054e-02 3 1  ON 64
ci_0066                -1.122669e-02 3 1  ON 65
ci_0067                -1.174273e-02 3 1  ON 66
ci_0068                -1.040762e-02 3 1  ON 67
ci_0069                 1.142907e-02 3 1  ON 68
ci_0070                 1.002846e-02 3 1  ON 69
ci_0071                 9.873837e-03 3 1  ON 70
ci_0072                 1.033996e-02 3 1  ON 71
ci_0073                 1.132905e-02 3 1  ON 72
ci_0074                 1.066518e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.7925
    reference variance = 1.5374
====================================================
  Execution time = 1.2944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5080e+00
  Total weights = 1.9459e+06
  Execution time = 2.2131e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538332141312
                                         uncertainty =       0.033539259775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538332141312
                                         uncertainty =       0.033539259775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126479829
  error estimate for blocks of size 2^( 2) =       0.001164953654
  error estimate for blocks of size 2^( 3) =       0.001197717664
  error estimate for blocks of size 2^( 4) =       0.001221210868
  error estimate for blocks of size 2^( 5) =       0.001237567828
  error estimate for blocks of size 2^( 6) =       0.001243768490
  error estimate for blocks of size 2^( 7) =       0.001250254548

      target function =                  N/A
              le_mean =     -16.719166554159
             les_mean =     282.038588851530
             stat err =       0.001238200434
             autocorr =       1.208189521523
              std dev =       1.593108540455
             le_variance =       2.537994821671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538238086670
                                         uncertainty =       0.033540709502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538238086670
                                         uncertainty =       0.033540709502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126458972
  error estimate for blocks of size 2^( 2) =       0.001164940206
  error estimate for blocks of size 2^( 3) =       0.001197713522
  error estimate for blocks of size 2^( 4) =       0.001221213570
  error estimate for blocks of size 2^( 5) =       0.001237575060
  error estimate for blocks of size 2^( 6) =       0.001243768525
  error estimate for blocks of size 2^( 7) =       0.001250265691

      target function =                  N/A
              le_mean =     -16.719166205286
             les_mean =     282.038534169366
             stat err =       0.001238205711
             autocorr =       1.208244561814
              std dev =       1.593079044136
             le_variance =       2.537900840865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538280608925
                                         uncertainty =       0.033540008600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538280608925
                                         uncertainty =       0.033540008600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126468401
  error estimate for blocks of size 2^( 2) =       0.001164946216
  error estimate for blocks of size 2^( 3) =       0.001197715216
  error estimate for blocks of size 2^( 4) =       0.001221212164
  error estimate for blocks of size 2^( 5) =       0.001237571462
  error estimate for blocks of size 2^( 6) =       0.001243768308
  error estimate for blocks of size 2^( 7) =       0.001250260399

      target function =                  N/A
              le_mean =     -16.719166216894
             les_mean =     282.038498213698
             stat err =       0.001238203083
             autocorr =       1.208219205030
              std dev =       1.593092379425
             le_variance =       2.537943329382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538325355606
                                         uncertainty =       0.033539352926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538325355606
                                         uncertainty =       0.033539352926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126478324
  error estimate for blocks of size 2^( 2) =       0.001164952659
  error estimate for blocks of size 2^( 3) =       0.001197717304
  error estimate for blocks of size 2^( 4) =       0.001221210992
  error estimate for blocks of size 2^( 5) =       0.001237568244
  error estimate for blocks of size 2^( 6) =       0.001243768422
  error estimate for blocks of size 2^( 7) =       0.001250255253

      target function =                  N/A
              le_mean =     -16.719166490053
             les_mean =     282.038569873505
             stat err =       0.001238200728
             autocorr =       1.208193323174
              std dev =       1.593106412390
             le_variance =       2.537988041197


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719166554159        initial  <--
     2.5000e+00     2.5000e+01             1.3590e-04       -16.719166205286
     1.0000e+01     1.0000e+02             3.5470e-05       -16.719166216894
     4.0000e+01     4.0000e+02             9.0062e-06       -16.719166490053

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1487
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 7.066951e-01 3 1  ON 0
ci_0002                 6.799289e-01 3 1  ON 1
ci_0003                -4.810641e-02 3 1  ON 2
ci_0004                -4.644695e-02 3 1  ON 3
ci_0005                -4.623675e-02 3 1  ON 4
ci_0006                -4.353294e-02 3 1  ON 5
ci_0007                -3.117511e-02 3 1  ON 6
ci_0008                -3.131303e-02 3 1  ON 7
ci_0009                -3.233278e-02 3 1  ON 8
ci_0010                -3.056102e-02 3 1  ON 9
ci_0011                -2.686517e-02 3 1  ON 10
ci_0012                -2.559976e-02 3 1  ON 11
ci_0013                 2.738242e-02 3 1  ON 12
ci_0014                 2.712043e-02 3 1  ON 13
ci_0015                 2.758629e-02 3 1  ON 14
ci_0016                 2.635434e-02 3 1  ON 15
ci_0017                 2.494225e-02 3 1  ON 16
ci_0018                 2.321701e-02 3 1  ON 17
ci_0019                 2.065467e-02 3 1  ON 18
ci_0020                 1.930209e-02 3 1  ON 19
ci_0021                 1.841732e-02 3 1  ON 20
ci_0022                 1.856873e-02 3 1  ON 21
ci_0023                -2.021151e-02 3 1  ON 22
ci_0024                -1.837696e-02 3 1  ON 23
ci_0025                -1.868094e-02 3 1  ON 24
ci_0026                -1.780615e-02 3 1  ON 25
ci_0027                -1.781243e-02 3 1  ON 26
ci_0028                -1.749478e-02 3 1  ON 27
ci_0029                -1.473999e-02 3 1  ON 28
ci_0030                -1.640281e-02 3 1  ON 29
ci_0031                 1.530242e-02 3 1  ON 30
ci_0032                 1.455656e-02 3 1  ON 31
ci_0033                 1.663997e-02 3 1  ON 32
ci_0034                 1.578986e-02 3 1  ON 33
ci_0035                 1.690712e-02 3 1  ON 34
ci_0036                 1.725361e-02 3 1  ON 35
ci_0037                -1.552167e-02 3 1  ON 36
ci_0038                -1.394064e-02 3 1  ON 37
ci_0039                -1.574921e-02 3 1  ON 38
ci_0040                -1.521448e-02 3 1  ON 39
ci_0041                 1.632147e-02 3 1  ON 40
ci_0042                 1.554454e-02 3 1  ON 41
ci_0043                -1.464930e-02 3 1  ON 42
ci_0044                -1.603688e-02 3 1  ON 43
ci_0045                 1.513546e-02 3 1  ON 44
ci_0046                 1.587757e-02 3 1  ON 45
ci_0047                -1.469550e-02 3 1  ON 46
ci_0048                -1.411698e-02 3 1  ON 47
ci_0049                -1.248679e-02 3 1  ON 48
ci_0050                -1.255745e-02 3 1  ON 49
ci_0051                -1.313032e-02 3 1  ON 50
ci_0052                -1.235370e-02 3 1  ON 51
ci_0053                -1.345017e-02 3 1  ON 52
ci_0054                -1.220305e-02 3 1  ON 53
ci_0055                 1.360735e-02 3 1  ON 54
ci_0056                 1.348905e-02 3 1  ON 55
ci_0057                 1.391534e-02 3 1  ON 56
ci_0058                 1.286075e-02 3 1  ON 57
ci_0059                -1.369055e-02 3 1  ON 58
ci_0060                -1.216843e-02 3 1  ON 59
ci_0061                -1.296112e-02 3 1  ON 60
ci_0062                -1.245521e-02 3 1  ON 61
ci_0063                -1.176255e-02 3 1  ON 62
ci_0064                -1.102274e-02 3 1  ON 63
ci_0065                -1.123918e-02 3 1  ON 64
ci_0066                -1.124206e-02 3 1  ON 65
ci_0067                -1.173021e-02 3 1  ON 66
ci_0068                -1.039919e-02 3 1  ON 67
ci_0069                 1.144165e-02 3 1  ON 68
ci_0070                 1.000641e-02 3 1  ON 69
ci_0071                 9.895872e-03 3 1  ON 70
ci_0072                 1.032784e-02 3 1  ON 71
ci_0073                 1.134402e-02 3 1  ON 72
ci_0074                 1.067566e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0737e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6778e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.7487
    reference variance = 1.4118
====================================================
  Execution time = 1.3310e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0276e+04
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.6258e+00
  Total weights = 1.945316309e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1954e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.657386774514
                                         uncertainty =       0.058177176114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.657386774514
                                         uncertainty =       0.058177176114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001152691359
  error estimate for blocks of size 2^( 2) =       0.001191223452
  error estimate for blocks of size 2^( 3) =       0.001223784043
  error estimate for blocks of size 2^( 4) =       0.001245481854
  error estimate for blocks of size 2^( 5) =       0.001257758138
  error estimate for blocks of size 2^( 6) =       0.001261687748
  error estimate for blocks of size 2^( 7) =       0.001267822682

      target function =                  N/A
              le_mean =     -16.716488444649
             les_mean =     282.066764537137
             stat err =       0.001258187606
             autocorr =       1.191419571876
              std dev =       1.630177835532
             le_variance =       2.657479775459


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671648844465e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716488443802       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716488946776       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716488942357       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 2.047430e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716488443802       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716488570376       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716488569296       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+02 is 5.158965e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716488443802       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716488475497       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716488475229       residual = 1.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+02 is 1.292292e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.305154 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6512e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 7.066963e-01 3 1  ON 0
ci_0002                 6.799270e-01 3 1  ON 1
ci_0003                -4.810886e-02 3 1  ON 2
ci_0004                -4.644718e-02 3 1  ON 3
ci_0005                -4.623597e-02 3 1  ON 4
ci_0006                -4.353462e-02 3 1  ON 5
ci_0007                -3.117716e-02 3 1  ON 6
ci_0008                -3.131418e-02 3 1  ON 7
ci_0009                -3.233208e-02 3 1  ON 8
ci_0010                -3.056503e-02 3 1  ON 9
ci_0011                -2.686627e-02 3 1  ON 10
ci_0012                -2.560281e-02 3 1  ON 11
ci_0013                 2.738264e-02 3 1  ON 12
ci_0014                 2.711885e-02 3 1  ON 13
ci_0015                 2.758735e-02 3 1  ON 14
ci_0016                 2.635572e-02 3 1  ON 15
ci_0017                 2.494045e-02 3 1  ON 16
ci_0018                 2.322128e-02 3 1  ON 17
ci_0019                 2.065531e-02 3 1  ON 18
ci_0020                 1.930021e-02 3 1  ON 19
ci_0021                 1.841774e-02 3 1  ON 20
ci_0022                 1.856887e-02 3 1  ON 21
ci_0023                -2.021025e-02 3 1  ON 22
ci_0024                -1.837560e-02 3 1  ON 23
ci_0025                -1.867784e-02 3 1  ON 24
ci_0026                -1.780645e-02 3 1  ON 25
ci_0027                -1.781442e-02 3 1  ON 26
ci_0028                -1.749487e-02 3 1  ON 27
ci_0029                -1.474191e-02 3 1  ON 28
ci_0030                -1.640261e-02 3 1  ON 29
ci_0031                 1.530040e-02 3 1  ON 30
ci_0032                 1.455876e-02 3 1  ON 31
ci_0033                 1.664080e-02 3 1  ON 32
ci_0034                 1.579065e-02 3 1  ON 33
ci_0035                 1.690702e-02 3 1  ON 34
ci_0036                 1.725227e-02 3 1  ON 35
ci_0037                -1.552160e-02 3 1  ON 36
ci_0038                -1.394226e-02 3 1  ON 37
ci_0039                -1.574906e-02 3 1  ON 38
ci_0040                -1.521308e-02 3 1  ON 39
ci_0041                 1.632223e-02 3 1  ON 40
ci_0042                 1.554537e-02 3 1  ON 41
ci_0043                -1.464998e-02 3 1  ON 42
ci_0044                -1.603593e-02 3 1  ON 43
ci_0045                 1.513303e-02 3 1  ON 44
ci_0046                 1.587542e-02 3 1  ON 45
ci_0047                -1.469464e-02 3 1  ON 46
ci_0048                -1.411647e-02 3 1  ON 47
ci_0049                -1.248906e-02 3 1  ON 48
ci_0050                -1.255814e-02 3 1  ON 49
ci_0051                -1.312978e-02 3 1  ON 50
ci_0052                -1.235532e-02 3 1  ON 51
ci_0053                -1.345003e-02 3 1  ON 52
ci_0054                -1.220229e-02 3 1  ON 53
ci_0055                 1.360444e-02 3 1  ON 54
ci_0056                 1.348503e-02 3 1  ON 55
ci_0057                 1.391241e-02 3 1  ON 56
ci_0058                 1.286247e-02 3 1  ON 57
ci_0059                -1.368899e-02 3 1  ON 58
ci_0060                -1.216878e-02 3 1  ON 59
ci_0061                -1.296203e-02 3 1  ON 60
ci_0062                -1.245465e-02 3 1  ON 61
ci_0063                -1.176341e-02 3 1  ON 62
ci_0064                -1.102579e-02 3 1  ON 63
ci_0065                -1.124434e-02 3 1  ON 64
ci_0066                -1.124283e-02 3 1  ON 65
ci_0067                -1.172957e-02 3 1  ON 66
ci_0068                -1.039854e-02 3 1  ON 67
ci_0069                 1.144067e-02 3 1  ON 68
ci_0070                 1.000755e-02 3 1  ON 69
ci_0071                 9.895313e-03 3 1  ON 70
ci_0072                 1.032764e-02 3 1  ON 71
ci_0073                 1.134523e-02 3 1  ON 72
ci_0074                 1.067691e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -15.9257
    reference variance = 64.2658
====================================================
  Execution time = 1.2848e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5048e+00
  Total weights = 1.9458e+06
  Execution time = 2.2095e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531339138213
                                         uncertainty =       0.017855475445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531339138213
                                         uncertainty =       0.017855475445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125181643
  error estimate for blocks of size 2^( 2) =       0.001164450649
  error estimate for blocks of size 2^( 3) =       0.001195707441
  error estimate for blocks of size 2^( 4) =       0.001219213213
  error estimate for blocks of size 2^( 5) =       0.001234642256
  error estimate for blocks of size 2^( 6) =       0.001240058811
  error estimate for blocks of size 2^( 7) =       0.001246285743

      target function =                  N/A
              le_mean =     -16.718195426641
             les_mean =     282.004463629505
             stat err =       0.001235050006
             autocorr =       1.204824547906
              std dev =       1.591272599892
             le_variance =       2.532148487168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531321462259
                                         uncertainty =       0.017855383519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531321462259
                                         uncertainty =       0.017855383519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125177713
  error estimate for blocks of size 2^( 2) =       0.001164446248
  error estimate for blocks of size 2^( 3) =       0.001195702361
  error estimate for blocks of size 2^( 4) =       0.001219207708
  error estimate for blocks of size 2^( 5) =       0.001234636432
  error estimate for blocks of size 2^( 6) =       0.001240052975
  error estimate for blocks of size 2^( 7) =       0.001246279720

      target function =                  N/A
              le_mean =     -16.718195435266
             les_mean =     282.002805517756
             stat err =       0.001235044209
             autocorr =       1.204821653805
              std dev =       1.591267041919
             le_variance =       2.532130798698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531330230490
                                         uncertainty =       0.017855429043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531330230490
                                         uncertainty =       0.017855429043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125179663
  error estimate for blocks of size 2^( 2) =       0.001164448429
  error estimate for blocks of size 2^( 3) =       0.001195704867
  error estimate for blocks of size 2^( 4) =       0.001219210417
  error estimate for blocks of size 2^( 5) =       0.001234639293
  error estimate for blocks of size 2^( 6) =       0.001240055821
  error estimate for blocks of size 2^( 7) =       0.001246282670

      target function =                  N/A
              le_mean =     -16.718195435190
             les_mean =     282.002832457341
             stat err =       0.001235047050
             autocorr =       1.204823022596
              std dev =       1.591269798990
             le_variance =       2.532139573176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531338021182
                                         uncertainty =       0.017855469627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531338021182
                                         uncertainty =       0.017855469627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125181395
  error estimate for blocks of size 2^( 2) =       0.001164450369
  error estimate for blocks of size 2^( 3) =       0.001195707104
  error estimate for blocks of size 2^( 4) =       0.001219212840
  error estimate for blocks of size 2^( 5) =       0.001234641856
  error estimate for blocks of size 2^( 6) =       0.001240058388
  error estimate for blocks of size 2^( 7) =       0.001246285320

      target function =                  N/A
              le_mean =     -16.718195433597
             les_mean =     282.003157759070
             stat err =       0.001235049601
             autocorr =       1.204824289679
              std dev =       1.591272248662
             le_variance =       2.532147369362


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718195426641        initial
     2.5000e+01     2.5000e+02             2.0474e-05       -16.718195435266  <--
     1.0000e+02     1.0000e+03             5.1590e-06       -16.718195435190
     4.0000e+02     4.0000e+03             1.2923e-06       -16.718195433597

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.4039e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 7.066997e-01 3 1  ON 0
ci_0002                 6.799214e-01 3 1  ON 1
ci_0003                -4.811616e-02 3 1  ON 2
ci_0004                -4.644785e-02 3 1  ON 3
ci_0005                -4.623365e-02 3 1  ON 4
ci_0006                -4.353962e-02 3 1  ON 5
ci_0007                -3.118332e-02 3 1  ON 6
ci_0008                -3.131762e-02 3 1  ON 7
ci_0009                -3.233000e-02 3 1  ON 8
ci_0010                -3.057692e-02 3 1  ON 9
ci_0011                -2.686953e-02 3 1  ON 10
ci_0012                -2.561188e-02 3 1  ON 11
ci_0013                 2.738327e-02 3 1  ON 12
ci_0014                 2.711417e-02 3 1  ON 13
ci_0015                 2.759048e-02 3 1  ON 14
ci_0016                 2.635983e-02 3 1  ON 15
ci_0017                 2.493512e-02 3 1  ON 16
ci_0018                 2.323394e-02 3 1  ON 17
ci_0019                 2.065722e-02 3 1  ON 18
ci_0020                 1.929460e-02 3 1  ON 19
ci_0021                 1.841902e-02 3 1  ON 20
ci_0022                 1.856931e-02 3 1  ON 21
ci_0023                -2.020649e-02 3 1  ON 22
ci_0024                -1.837155e-02 3 1  ON 23
ci_0025                -1.866864e-02 3 1  ON 24
ci_0026                -1.780736e-02 3 1  ON 25
ci_0027                -1.782033e-02 3 1  ON 26
ci_0028                -1.749513e-02 3 1  ON 27
ci_0029                -1.474762e-02 3 1  ON 28
ci_0030                -1.640201e-02 3 1  ON 29
ci_0031                 1.529439e-02 3 1  ON 30
ci_0032                 1.456530e-02 3 1  ON 31
ci_0033                 1.664328e-02 3 1  ON 32
ci_0034                 1.579302e-02 3 1  ON 33
ci_0035                 1.690672e-02 3 1  ON 34
ci_0036                 1.724827e-02 3 1  ON 35
ci_0037                -1.552137e-02 3 1  ON 36
ci_0038                -1.394706e-02 3 1  ON 37
ci_0039                -1.574861e-02 3 1  ON 38
ci_0040                -1.520892e-02 3 1  ON 39
ci_0041                 1.632448e-02 3 1  ON 40
ci_0042                 1.554782e-02 3 1  ON 41
ci_0043                -1.465201e-02 3 1  ON 42
ci_0044                -1.603310e-02 3 1  ON 43
ci_0045                 1.512580e-02 3 1  ON 44
ci_0046                 1.586903e-02 3 1  ON 45
ci_0047                -1.469210e-02 3 1  ON 46
ci_0048                -1.411496e-02 3 1  ON 47
ci_0049                -1.249584e-02 3 1  ON 48
ci_0050                -1.256016e-02 3 1  ON 49
ci_0051                -1.312817e-02 3 1  ON 50
ci_0052                -1.236011e-02 3 1  ON 51
ci_0053                -1.344960e-02 3 1  ON 52
ci_0054                -1.220003e-02 3 1  ON 53
ci_0055                 1.359576e-02 3 1  ON 54
ci_0056                 1.347304e-02 3 1  ON 55
ci_0057                 1.390368e-02 3 1  ON 56
ci_0058                 1.286758e-02 3 1  ON 57
ci_0059                -1.368438e-02 3 1  ON 58
ci_0060                -1.216982e-02 3 1  ON 59
ci_0061                -1.296474e-02 3 1  ON 60
ci_0062                -1.245299e-02 3 1  ON 61
ci_0063                -1.176594e-02 3 1  ON 62
ci_0064                -1.103484e-02 3 1  ON 63
ci_0065                -1.125966e-02 3 1  ON 64
ci_0066                -1.124511e-02 3 1  ON 65
ci_0067                -1.172768e-02 3 1  ON 66
ci_0068                -1.039662e-02 3 1  ON 67
ci_0069                 1.143778e-02 3 1  ON 68
ci_0070                 1.001092e-02 3 1  ON 69
ci_0071                 9.893652e-03 3 1  ON 70
ci_0072                 1.032704e-02 3 1  ON 71
ci_0073                 1.134884e-02 3 1  ON 72
ci_0074                 1.068062e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0557e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6631e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.4502
    reference variance = 11.5234
====================================================
  Execution time = 1.5787e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0264e+04
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5511e+00
  Total weights = 1.945388101e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1970e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.583138863863
                                         uncertainty =       0.027005206943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.583138863863
                                         uncertainty =       0.027005206943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136551376
  error estimate for blocks of size 2^( 2) =       0.001175584677
  error estimate for blocks of size 2^( 3) =       0.001209169950
  error estimate for blocks of size 2^( 4) =       0.001231043988
  error estimate for blocks of size 2^( 5) =       0.001242842616
  error estimate for blocks of size 2^( 6) =       0.001247735367
  error estimate for blocks of size 2^( 7) =       0.001249499032

      target function =                  N/A
              le_mean =     -16.715623315408
             les_mean =     281.963124022649
             stat err =       0.001242780251
             autocorr =       1.195667822997
              std dev =       1.607352087650
             le_variance =       2.583580733672


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671562331541e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715623314490       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715625962399       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715625961164       residual = 1.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 7.499048e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715623314490       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715623995853       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715623994009       residual = 1.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 1.945592e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715623314490       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715623486087       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715623485528       residual = 1.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+02 is 4.910347e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306317 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8990e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 7.067006e-01 3 1  ON 0
ci_0002                 6.799183e-01 3 1  ON 1
ci_0003                -4.813213e-02 3 1  ON 2
ci_0004                -4.644481e-02 3 1  ON 3
ci_0005                -4.622920e-02 3 1  ON 4
ci_0006                -4.354163e-02 3 1  ON 5
ci_0007                -3.118655e-02 3 1  ON 6
ci_0008                -3.131709e-02 3 1  ON 7
ci_0009                -3.233675e-02 3 1  ON 8
ci_0010                -3.058560e-02 3 1  ON 9
ci_0011                -2.686983e-02 3 1  ON 10
ci_0012                -2.561700e-02 3 1  ON 11
ci_0013                 2.737925e-02 3 1  ON 12
ci_0014                 2.710889e-02 3 1  ON 13
ci_0015                 2.759679e-02 3 1  ON 14
ci_0016                 2.635545e-02 3 1  ON 15
ci_0017                 2.493674e-02 3 1  ON 16
ci_0018                 2.323694e-02 3 1  ON 17
ci_0019                 2.066291e-02 3 1  ON 18
ci_0020                 1.929764e-02 3 1  ON 19
ci_0021                 1.841365e-02 3 1  ON 20
ci_0022                 1.857348e-02 3 1  ON 21
ci_0023                -2.020568e-02 3 1  ON 22
ci_0024                -1.837251e-02 3 1  ON 23
ci_0025                -1.866028e-02 3 1  ON 24
ci_0026                -1.779593e-02 3 1  ON 25
ci_0027                -1.781580e-02 3 1  ON 26
ci_0028                -1.748299e-02 3 1  ON 27
ci_0029                -1.476553e-02 3 1  ON 28
ci_0030                -1.639917e-02 3 1  ON 29
ci_0031                 1.530225e-02 3 1  ON 30
ci_0032                 1.455981e-02 3 1  ON 31
ci_0033                 1.663748e-02 3 1  ON 32
ci_0034                 1.579337e-02 3 1  ON 33
ci_0035                 1.691260e-02 3 1  ON 34
ci_0036                 1.724926e-02 3 1  ON 35
ci_0037                -1.551999e-02 3 1  ON 36
ci_0038                -1.394655e-02 3 1  ON 37
ci_0039                -1.575165e-02 3 1  ON 38
ci_0040                -1.519878e-02 3 1  ON 39
ci_0041                 1.632725e-02 3 1  ON 40
ci_0042                 1.555199e-02 3 1  ON 41
ci_0043                -1.465534e-02 3 1  ON 42
ci_0044                -1.602441e-02 3 1  ON 43
ci_0045                 1.512947e-02 3 1  ON 44
ci_0046                 1.585546e-02 3 1  ON 45
ci_0047                -1.469599e-02 3 1  ON 46
ci_0048                -1.411737e-02 3 1  ON 47
ci_0049                -1.251138e-02 3 1  ON 48
ci_0050                -1.257239e-02 3 1  ON 49
ci_0051                -1.312969e-02 3 1  ON 50
ci_0052                -1.236110e-02 3 1  ON 51
ci_0053                -1.344158e-02 3 1  ON 52
ci_0054                -1.221948e-02 3 1  ON 53
ci_0055                 1.358652e-02 3 1  ON 54
ci_0056                 1.346586e-02 3 1  ON 55
ci_0057                 1.389603e-02 3 1  ON 56
ci_0058                 1.287486e-02 3 1  ON 57
ci_0059                -1.368468e-02 3 1  ON 58
ci_0060                -1.217620e-02 3 1  ON 59
ci_0061                -1.296867e-02 3 1  ON 60
ci_0062                -1.244903e-02 3 1  ON 61
ci_0063                -1.176746e-02 3 1  ON 62
ci_0064                -1.104069e-02 3 1  ON 63
ci_0065                -1.126786e-02 3 1  ON 64
ci_0066                -1.124950e-02 3 1  ON 65
ci_0067                -1.172349e-02 3 1  ON 66
ci_0068                -1.040725e-02 3 1  ON 67
ci_0069                 1.143409e-02 3 1  ON 68
ci_0070                 1.002355e-02 3 1  ON 69
ci_0071                 9.884844e-03 3 1  ON 70
ci_0072                 1.032558e-02 3 1  ON 71
ci_0073                 1.135375e-02 3 1  ON 72
ci_0074                 1.068626e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.3907
    reference variance = 7.19225
====================================================
  Execution time = 1.2871e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5574e+00
  Total weights = 1.9454e+06
  Execution time = 2.2319e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.587402772740
                                         uncertainty =       0.031831262470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.587402772740
                                         uncertainty =       0.031831262470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137367319
  error estimate for blocks of size 2^( 2) =       0.001175468150
  error estimate for blocks of size 2^( 3) =       0.001209137634
  error estimate for blocks of size 2^( 4) =       0.001232737453
  error estimate for blocks of size 2^( 5) =       0.001247519317
  error estimate for blocks of size 2^( 6) =       0.001254074910
  error estimate for blocks of size 2^( 7) =       0.001264400419

      target function =                  N/A
              le_mean =     -16.715966166758
             les_mean =     281.980937855489
             stat err =       0.001249683025
             autocorr =       1.207252882313
              std dev =       1.608506023238
             le_variance =       2.587291626793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.587428567340
                                         uncertainty =       0.031830691021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.587428567340
                                         uncertainty =       0.031830691021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137373076
  error estimate for blocks of size 2^( 2) =       0.001175469547
  error estimate for blocks of size 2^( 3) =       0.001209134884
  error estimate for blocks of size 2^( 4) =       0.001232730753
  error estimate for blocks of size 2^( 5) =       0.001247509230
  error estimate for blocks of size 2^( 6) =       0.001254066253
  error estimate for blocks of size 2^( 7) =       0.001264392365

      target function =                  N/A
              le_mean =     -16.715966115013
             les_mean =     281.980961166883
             stat err =       0.001249674650
             autocorr =       1.207224479406
              std dev =       1.608514165633
             le_variance =       2.587317821041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.587416082062
                                         uncertainty =       0.031830966403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.587416082062
                                         uncertainty =       0.031830966403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137370290
  error estimate for blocks of size 2^( 2) =       0.001175468856
  error estimate for blocks of size 2^( 3) =       0.001209136184
  error estimate for blocks of size 2^( 4) =       0.001232733963
  error estimate for blocks of size 2^( 5) =       0.001247514076
  error estimate for blocks of size 2^( 6) =       0.001254070407
  error estimate for blocks of size 2^( 7) =       0.001264396220

      target function =                  N/A
              le_mean =     -16.715966107799
             les_mean =     281.980928793997
             stat err =       0.001249678667
             autocorr =       1.207238155301
              std dev =       1.608510224620
             le_variance =       2.587305142706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.587404425973
                                         uncertainty =       0.031831225141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.587404425973
                                         uncertainty =       0.031831225141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137367688
  error estimate for blocks of size 2^( 2) =       0.001175468233
  error estimate for blocks of size 2^( 3) =       0.001209137445
  error estimate for blocks of size 2^( 4) =       0.001232737007
  error estimate for blocks of size 2^( 5) =       0.001247518651
  error estimate for blocks of size 2^( 6) =       0.001254074337
  error estimate for blocks of size 2^( 7) =       0.001264399885

      target function =                  N/A
              le_mean =     -16.715966155453
             les_mean =     281.980934357671
             stat err =       0.001249682470
             autocorr =       1.207251026976
              std dev =       1.608506545231
             le_variance =       2.587293306051


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.715966166758        initial  <--
     6.2500e+00     6.2500e+01             7.4990e-05       -16.715966115013
     2.5000e+01     2.5000e+02             1.9456e-05       -16.715966107799
     1.0000e+02     1.0000e+03             4.9103e-06       -16.715966155453

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0915
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 7.066997e-01 3 1  ON 0
ci_0002                 6.799214e-01 3 1  ON 1
ci_0003                -4.811616e-02 3 1  ON 2
ci_0004                -4.644785e-02 3 1  ON 3
ci_0005                -4.623365e-02 3 1  ON 4
ci_0006                -4.353962e-02 3 1  ON 5
ci_0007                -3.118332e-02 3 1  ON 6
ci_0008                -3.131762e-02 3 1  ON 7
ci_0009                -3.233000e-02 3 1  ON 8
ci_0010                -3.057692e-02 3 1  ON 9
ci_0011                -2.686953e-02 3 1  ON 10
ci_0012                -2.561188e-02 3 1  ON 11
ci_0013                 2.738327e-02 3 1  ON 12
ci_0014                 2.711417e-02 3 1  ON 13
ci_0015                 2.759048e-02 3 1  ON 14
ci_0016                 2.635983e-02 3 1  ON 15
ci_0017                 2.493512e-02 3 1  ON 16
ci_0018                 2.323394e-02 3 1  ON 17
ci_0019                 2.065722e-02 3 1  ON 18
ci_0020                 1.929460e-02 3 1  ON 19
ci_0021                 1.841902e-02 3 1  ON 20
ci_0022                 1.856931e-02 3 1  ON 21
ci_0023                -2.020649e-02 3 1  ON 22
ci_0024                -1.837155e-02 3 1  ON 23
ci_0025                -1.866864e-02 3 1  ON 24
ci_0026                -1.780736e-02 3 1  ON 25
ci_0027                -1.782033e-02 3 1  ON 26
ci_0028                -1.749513e-02 3 1  ON 27
ci_0029                -1.474762e-02 3 1  ON 28
ci_0030                -1.640201e-02 3 1  ON 29
ci_0031                 1.529439e-02 3 1  ON 30
ci_0032                 1.456530e-02 3 1  ON 31
ci_0033                 1.664328e-02 3 1  ON 32
ci_0034                 1.579302e-02 3 1  ON 33
ci_0035                 1.690672e-02 3 1  ON 34
ci_0036                 1.724827e-02 3 1  ON 35
ci_0037                -1.552137e-02 3 1  ON 36
ci_0038                -1.394706e-02 3 1  ON 37
ci_0039                -1.574861e-02 3 1  ON 38
ci_0040                -1.520892e-02 3 1  ON 39
ci_0041                 1.632448e-02 3 1  ON 40
ci_0042                 1.554782e-02 3 1  ON 41
ci_0043                -1.465201e-02 3 1  ON 42
ci_0044                -1.603310e-02 3 1  ON 43
ci_0045                 1.512580e-02 3 1  ON 44
ci_0046                 1.586903e-02 3 1  ON 45
ci_0047                -1.469210e-02 3 1  ON 46
ci_0048                -1.411496e-02 3 1  ON 47
ci_0049                -1.249584e-02 3 1  ON 48
ci_0050                -1.256016e-02 3 1  ON 49
ci_0051                -1.312817e-02 3 1  ON 50
ci_0052                -1.236011e-02 3 1  ON 51
ci_0053                -1.344960e-02 3 1  ON 52
ci_0054                -1.220003e-02 3 1  ON 53
ci_0055                 1.359576e-02 3 1  ON 54
ci_0056                 1.347304e-02 3 1  ON 55
ci_0057                 1.390368e-02 3 1  ON 56
ci_0058                 1.286758e-02 3 1  ON 57
ci_0059                -1.368438e-02 3 1  ON 58
ci_0060                -1.216982e-02 3 1  ON 59
ci_0061                -1.296474e-02 3 1  ON 60
ci_0062                -1.245299e-02 3 1  ON 61
ci_0063                -1.176594e-02 3 1  ON 62
ci_0064                -1.103484e-02 3 1  ON 63
ci_0065                -1.125966e-02 3 1  ON 64
ci_0066                -1.124511e-02 3 1  ON 65
ci_0067                -1.172768e-02 3 1  ON 66
ci_0068                -1.039662e-02 3 1  ON 67
ci_0069                 1.143778e-02 3 1  ON 68
ci_0070                 1.001092e-02 3 1  ON 69
ci_0071                 9.893652e-03 3 1  ON 70
ci_0072                 1.032704e-02 3 1  ON 71
ci_0073                 1.134884e-02 3 1  ON 72
ci_0074                 1.068062e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3088e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6578e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.7708
    reference variance = 1.29504
====================================================
  Execution time = 1.3347e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0277e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5245e+00
  Total weights = 1.945616516e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1819e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554213332904
                                         uncertainty =       0.021132904132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554213332904
                                         uncertainty =       0.021132904132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129951665
  error estimate for blocks of size 2^( 2) =       0.001168159589
  error estimate for blocks of size 2^( 3) =       0.001200381526
  error estimate for blocks of size 2^( 4) =       0.001223242259
  error estimate for blocks of size 2^( 5) =       0.001237096118
  error estimate for blocks of size 2^( 6) =       0.001246657594
  error estimate for blocks of size 2^( 7) =       0.001251017321

      target function =                  N/A
              le_mean =     -16.716740266559
             les_mean =     281.973856147611
             stat err =       0.001239503323
             autocorr =       1.203304823458
              std dev =       1.598018537745
             le_variance =       2.553663246976


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671674026656e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716740265603       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716740581154       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716740586717       residual = 1.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+01 is 9.546152e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716740265603       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716740344714       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716740346128       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+02 is 2.393333e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716740265603       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716740285395       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716740285750       residual = 1.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+03 is 5.987597e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.307466 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6534e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 7.067001e-01 3 1  ON 0
ci_0002                 6.799207e-01 3 1  ON 1
ci_0003                -4.811695e-02 3 1  ON 2
ci_0004                -4.644806e-02 3 1  ON 3
ci_0005                -4.623427e-02 3 1  ON 4
ci_0006                -4.353939e-02 3 1  ON 5
ci_0007                -3.118383e-02 3 1  ON 6
ci_0008                -3.131781e-02 3 1  ON 7
ci_0009                -3.233089e-02 3 1  ON 8
ci_0010                -3.057723e-02 3 1  ON 9
ci_0011                -2.687071e-02 3 1  ON 10
ci_0012                -2.561281e-02 3 1  ON 11
ci_0013                 2.738333e-02 3 1  ON 12
ci_0014                 2.711398e-02 3 1  ON 13
ci_0015                 2.759134e-02 3 1  ON 14
ci_0016                 2.635970e-02 3 1  ON 15
ci_0017                 2.493558e-02 3 1  ON 16
ci_0018                 2.323608e-02 3 1  ON 17
ci_0019                 2.065701e-02 3 1  ON 18
ci_0020                 1.929438e-02 3 1  ON 19
ci_0021                 1.841883e-02 3 1  ON 20
ci_0022                 1.856897e-02 3 1  ON 21
ci_0023                -2.020564e-02 3 1  ON 22
ci_0024                -1.837125e-02 3 1  ON 23
ci_0025                -1.866746e-02 3 1  ON 24
ci_0026                -1.780742e-02 3 1  ON 25
ci_0027                -1.782008e-02 3 1  ON 26
ci_0028                -1.749449e-02 3 1  ON 27
ci_0029                -1.475002e-02 3 1  ON 28
ci_0030                -1.640092e-02 3 1  ON 29
ci_0031                 1.529523e-02 3 1  ON 30
ci_0032                 1.456457e-02 3 1  ON 31
ci_0033                 1.664195e-02 3 1  ON 32
ci_0034                 1.579276e-02 3 1  ON 33
ci_0035                 1.690713e-02 3 1  ON 34
ci_0036                 1.724850e-02 3 1  ON 35
ci_0037                -1.552236e-02 3 1  ON 36
ci_0038                -1.394556e-02 3 1  ON 37
ci_0039                -1.574940e-02 3 1  ON 38
ci_0040                -1.520854e-02 3 1  ON 39
ci_0041                 1.632416e-02 3 1  ON 40
ci_0042                 1.554780e-02 3 1  ON 41
ci_0043                -1.465208e-02 3 1  ON 42
ci_0044                -1.603310e-02 3 1  ON 43
ci_0045                 1.512596e-02 3 1  ON 44
ci_0046                 1.586859e-02 3 1  ON 45
ci_0047                -1.469203e-02 3 1  ON 46
ci_0048                -1.411502e-02 3 1  ON 47
ci_0049                -1.249701e-02 3 1  ON 48
ci_0050                -1.256076e-02 3 1  ON 49
ci_0051                -1.312814e-02 3 1  ON 50
ci_0052                -1.236118e-02 3 1  ON 51
ci_0053                -1.344938e-02 3 1  ON 52
ci_0054                -1.220091e-02 3 1  ON 53
ci_0055                 1.359569e-02 3 1  ON 54
ci_0056                 1.347200e-02 3 1  ON 55
ci_0057                 1.390166e-02 3 1  ON 56
ci_0058                 1.286746e-02 3 1  ON 57
ci_0059                -1.368353e-02 3 1  ON 58
ci_0060                -1.217108e-02 3 1  ON 59
ci_0061                -1.296523e-02 3 1  ON 60
ci_0062                -1.245373e-02 3 1  ON 61
ci_0063                -1.176607e-02 3 1  ON 62
ci_0064                -1.103455e-02 3 1  ON 63
ci_0065                -1.126142e-02 3 1  ON 64
ci_0066                -1.124528e-02 3 1  ON 65
ci_0067                -1.172609e-02 3 1  ON 66
ci_0068                -1.039653e-02 3 1  ON 67
ci_0069                 1.143673e-02 3 1  ON 68
ci_0070                 1.001141e-02 3 1  ON 69
ci_0071                 9.893712e-03 3 1  ON 70
ci_0072                 1.032731e-02 3 1  ON 71
ci_0073                 1.134846e-02 3 1  ON 72
ci_0074                 1.068172e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.7863
    reference variance = 3.86597
====================================================
  Execution time = 1.2867e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5053e+00
  Total weights = 1.9458e+06
  Execution time = 2.2222e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533427347255
                                         uncertainty =       0.023616007637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533427347255
                                         uncertainty =       0.023616007637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125466006
  error estimate for blocks of size 2^( 2) =       0.001165106723
  error estimate for blocks of size 2^( 3) =       0.001197796883
  error estimate for blocks of size 2^( 4) =       0.001223257003
  error estimate for blocks of size 2^( 5) =       0.001238010880
  error estimate for blocks of size 2^( 6) =       0.001247706369
  error estimate for blocks of size 2^( 7) =       0.001251710193

      target function =                  N/A
              le_mean =     -16.718989829870
             les_mean =     282.029913954750
             stat err =       0.001240171111
             autocorr =       1.214223005667
              std dev =       1.591674756292
             le_variance =       2.533428529817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533424935230
                                         uncertainty =       0.023616036362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533424935230
                                         uncertainty =       0.023616036362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125465471
  error estimate for blocks of size 2^( 2) =       0.001165105919
  error estimate for blocks of size 2^( 3) =       0.001197795719
  error estimate for blocks of size 2^( 4) =       0.001223255769
  error estimate for blocks of size 2^( 5) =       0.001238009488
  error estimate for blocks of size 2^( 6) =       0.001247705072
  error estimate for blocks of size 2^( 7) =       0.001251709240

      target function =                  N/A
              le_mean =     -16.718989778562
             les_mean =     282.029918796319
             stat err =       0.001240169892
             autocorr =       1.214221774000
              std dev =       1.591673999040
             le_variance =       2.533426119221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533426135055
                                         uncertainty =       0.023616022047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533426135055
                                         uncertainty =       0.023616022047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125465737
  error estimate for blocks of size 2^( 2) =       0.001165106319
  error estimate for blocks of size 2^( 3) =       0.001197796298
  error estimate for blocks of size 2^( 4) =       0.001223256384
  error estimate for blocks of size 2^( 5) =       0.001238010181
  error estimate for blocks of size 2^( 6) =       0.001247705718
  error estimate for blocks of size 2^( 7) =       0.001251709714

      target function =                  N/A
              le_mean =     -16.718989803762
             les_mean =     282.029913432242
             stat err =       0.001240170499
             autocorr =       1.214222387262
              std dev =       1.591674375722
             le_variance =       2.533427318330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533427195269
                                         uncertainty =       0.023616009439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533427195269
                                         uncertainty =       0.023616009439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125465973
  error estimate for blocks of size 2^( 2) =       0.001165106672
  error estimate for blocks of size 2^( 3) =       0.001197796809
  error estimate for blocks of size 2^( 4) =       0.001223256926
  error estimate for blocks of size 2^( 5) =       0.001238010792
  error estimate for blocks of size 2^( 6) =       0.001247706288
  error estimate for blocks of size 2^( 7) =       0.001251710133

      target function =                  N/A
              le_mean =     -16.718989826561
             les_mean =     282.029913696593
             stat err =       0.001240171035
             autocorr =       1.214222928290
              std dev =       1.591674708576
             le_variance =       2.533428377920


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718989829870        initial  <--
     6.2500e+01     6.2500e+02             9.5462e-06       -16.718989778562
     2.5000e+02     2.5000e+03             2.3933e-06       -16.718989803762
     1.0000e+03     1.0000e+04             5.9876e-07       -16.718989826561

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0813
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 7.066997e-01 3 1  ON 0
ci_0002                 6.799214e-01 3 1  ON 1
ci_0003                -4.811616e-02 3 1  ON 2
ci_0004                -4.644785e-02 3 1  ON 3
ci_0005                -4.623365e-02 3 1  ON 4
ci_0006                -4.353962e-02 3 1  ON 5
ci_0007                -3.118332e-02 3 1  ON 6
ci_0008                -3.131762e-02 3 1  ON 7
ci_0009                -3.233000e-02 3 1  ON 8
ci_0010                -3.057692e-02 3 1  ON 9
ci_0011                -2.686953e-02 3 1  ON 10
ci_0012                -2.561188e-02 3 1  ON 11
ci_0013                 2.738327e-02 3 1  ON 12
ci_0014                 2.711417e-02 3 1  ON 13
ci_0015                 2.759048e-02 3 1  ON 14
ci_0016                 2.635983e-02 3 1  ON 15
ci_0017                 2.493512e-02 3 1  ON 16
ci_0018                 2.323394e-02 3 1  ON 17
ci_0019                 2.065722e-02 3 1  ON 18
ci_0020                 1.929460e-02 3 1  ON 19
ci_0021                 1.841902e-02 3 1  ON 20
ci_0022                 1.856931e-02 3 1  ON 21
ci_0023                -2.020649e-02 3 1  ON 22
ci_0024                -1.837155e-02 3 1  ON 23
ci_0025                -1.866864e-02 3 1  ON 24
ci_0026                -1.780736e-02 3 1  ON 25
ci_0027                -1.782033e-02 3 1  ON 26
ci_0028                -1.749513e-02 3 1  ON 27
ci_0029                -1.474762e-02 3 1  ON 28
ci_0030                -1.640201e-02 3 1  ON 29
ci_0031                 1.529439e-02 3 1  ON 30
ci_0032                 1.456530e-02 3 1  ON 31
ci_0033                 1.664328e-02 3 1  ON 32
ci_0034                 1.579302e-02 3 1  ON 33
ci_0035                 1.690672e-02 3 1  ON 34
ci_0036                 1.724827e-02 3 1  ON 35
ci_0037                -1.552137e-02 3 1  ON 36
ci_0038                -1.394706e-02 3 1  ON 37
ci_0039                -1.574861e-02 3 1  ON 38
ci_0040                -1.520892e-02 3 1  ON 39
ci_0041                 1.632448e-02 3 1  ON 40
ci_0042                 1.554782e-02 3 1  ON 41
ci_0043                -1.465201e-02 3 1  ON 42
ci_0044                -1.603310e-02 3 1  ON 43
ci_0045                 1.512580e-02 3 1  ON 44
ci_0046                 1.586903e-02 3 1  ON 45
ci_0047                -1.469210e-02 3 1  ON 46
ci_0048                -1.411496e-02 3 1  ON 47
ci_0049                -1.249584e-02 3 1  ON 48
ci_0050                -1.256016e-02 3 1  ON 49
ci_0051                -1.312817e-02 3 1  ON 50
ci_0052                -1.236011e-02 3 1  ON 51
ci_0053                -1.344960e-02 3 1  ON 52
ci_0054                -1.220003e-02 3 1  ON 53
ci_0055                 1.359576e-02 3 1  ON 54
ci_0056                 1.347304e-02 3 1  ON 55
ci_0057                 1.390368e-02 3 1  ON 56
ci_0058                 1.286758e-02 3 1  ON 57
ci_0059                -1.368438e-02 3 1  ON 58
ci_0060                -1.216982e-02 3 1  ON 59
ci_0061                -1.296474e-02 3 1  ON 60
ci_0062                -1.245299e-02 3 1  ON 61
ci_0063                -1.176594e-02 3 1  ON 62
ci_0064                -1.103484e-02 3 1  ON 63
ci_0065                -1.125966e-02 3 1  ON 64
ci_0066                -1.124511e-02 3 1  ON 65
ci_0067                -1.172768e-02 3 1  ON 66
ci_0068                -1.039662e-02 3 1  ON 67
ci_0069                 1.143778e-02 3 1  ON 68
ci_0070                 1.001092e-02 3 1  ON 69
ci_0071                 9.893652e-03 3 1  ON 70
ci_0072                 1.032704e-02 3 1  ON 71
ci_0073                 1.134884e-02 3 1  ON 72
ci_0074                 1.068062e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0622e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6618e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.6516
    reference variance = 2.15767
====================================================
  Execution time = 1.3130e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0246e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.6232e+00
  Total weights = 1.945314264e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2146e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.652457452107
                                         uncertainty =       0.069673698516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.652457452107
                                         uncertainty =       0.069673698516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001151574841
  error estimate for blocks of size 2^( 2) =       0.001189096740
  error estimate for blocks of size 2^( 3) =       0.001220946300
  error estimate for blocks of size 2^( 4) =       0.001242220717
  error estimate for blocks of size 2^( 5) =       0.001256978441
  error estimate for blocks of size 2^( 6) =       0.001263117945
  error estimate for blocks of size 2^( 7) =       0.001272508870

      target function =                  N/A
              le_mean =     -16.717277821366
             les_mean =     282.090618834258
             stat err =       0.001258706493
             autocorr =       1.194715805329
              std dev =       1.628598814963
             le_variance =       2.652334100100


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671727782137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717277820441       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717277851664       residual = 7.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717277871053       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717277871198       residual = 1.36e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+02 is 2.636355e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717277820441       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717277828249       residual = 7.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717277833098       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717277833134       residual = 1.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+03 is 6.592974e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717277820441       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717277822393       residual = 7.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717277823605       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717277823614       residual = 1.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+04 is 1.648374e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.308977 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6351e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 7.066997e-01 3 1  ON 0
ci_0002                 6.799215e-01 3 1  ON 1
ci_0003                -4.811617e-02 3 1  ON 2
ci_0004                -4.644779e-02 3 1  ON 3
ci_0005                -4.623369e-02 3 1  ON 4
ci_0006                -4.353958e-02 3 1  ON 5
ci_0007                -3.118340e-02 3 1  ON 6
ci_0008                -3.131758e-02 3 1  ON 7
ci_0009                -3.232993e-02 3 1  ON 8
ci_0010                -3.057695e-02 3 1  ON 9
ci_0011                -2.686960e-02 3 1  ON 10
ci_0012                -2.561190e-02 3 1  ON 11
ci_0013                 2.738324e-02 3 1  ON 12
ci_0014                 2.711411e-02 3 1  ON 13
ci_0015                 2.759029e-02 3 1  ON 14
ci_0016                 2.635971e-02 3 1  ON 15
ci_0017                 2.493521e-02 3 1  ON 16
ci_0018                 2.323401e-02 3 1  ON 17
ci_0019                 2.065713e-02 3 1  ON 18
ci_0020                 1.929459e-02 3 1  ON 19
ci_0021                 1.841893e-02 3 1  ON 20
ci_0022                 1.856919e-02 3 1  ON 21
ci_0023                -2.020643e-02 3 1  ON 22
ci_0024                -1.837166e-02 3 1  ON 23
ci_0025                -1.866860e-02 3 1  ON 24
ci_0026                -1.780734e-02 3 1  ON 25
ci_0027                -1.782029e-02 3 1  ON 26
ci_0028                -1.749515e-02 3 1  ON 27
ci_0029                -1.474749e-02 3 1  ON 28
ci_0030                -1.640169e-02 3 1  ON 29
ci_0031                 1.529437e-02 3 1  ON 30
ci_0032                 1.456528e-02 3 1  ON 31
ci_0033                 1.664338e-02 3 1  ON 32
ci_0034                 1.579276e-02 3 1  ON 33
ci_0035                 1.690643e-02 3 1  ON 34
ci_0036                 1.724800e-02 3 1  ON 35
ci_0037                -1.552140e-02 3 1  ON 36
ci_0038                -1.394710e-02 3 1  ON 37
ci_0039                -1.574855e-02 3 1  ON 38
ci_0040                -1.520892e-02 3 1  ON 39
ci_0041                 1.632437e-02 3 1  ON 40
ci_0042                 1.554778e-02 3 1  ON 41
ci_0043                -1.465199e-02 3 1  ON 42
ci_0044                -1.603314e-02 3 1  ON 43
ci_0045                 1.512581e-02 3 1  ON 44
ci_0046                 1.586913e-02 3 1  ON 45
ci_0047                -1.469206e-02 3 1  ON 46
ci_0048                -1.411487e-02 3 1  ON 47
ci_0049                -1.249596e-02 3 1  ON 48
ci_0050                -1.256017e-02 3 1  ON 49
ci_0051                -1.312811e-02 3 1  ON 50
ci_0052                -1.236020e-02 3 1  ON 51
ci_0053                -1.344934e-02 3 1  ON 52
ci_0054                -1.219993e-02 3 1  ON 53
ci_0055                 1.359555e-02 3 1  ON 54
ci_0056                 1.347295e-02 3 1  ON 55
ci_0057                 1.390338e-02 3 1  ON 56
ci_0058                 1.286743e-02 3 1  ON 57
ci_0059                -1.368434e-02 3 1  ON 58
ci_0060                -1.217003e-02 3 1  ON 59
ci_0061                -1.296408e-02 3 1  ON 60
ci_0062                -1.245285e-02 3 1  ON 61
ci_0063                -1.176595e-02 3 1  ON 62
ci_0064                -1.103476e-02 3 1  ON 63
ci_0065                -1.125972e-02 3 1  ON 64
ci_0066                -1.124517e-02 3 1  ON 65
ci_0067                -1.172755e-02 3 1  ON 66
ci_0068                -1.039677e-02 3 1  ON 67
ci_0069                 1.143763e-02 3 1  ON 68
ci_0070                 1.001090e-02 3 1  ON 69
ci_0071                 9.893488e-03 3 1  ON 70
ci_0072                 1.032700e-02 3 1  ON 71
ci_0073                 1.134872e-02 3 1  ON 72
ci_0074                 1.068084e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.5348
    reference variance = 3.76768
====================================================
  Execution time = 1.2856e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5116e+00
  Total weights = 1.9458e+06
  Execution time = 2.2198e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.539244468643
                                         uncertainty =       0.028880096149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.539244468643
                                         uncertainty =       0.028880096149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126703456
  error estimate for blocks of size 2^( 2) =       0.001165721706
  error estimate for blocks of size 2^( 3) =       0.001199780612
  error estimate for blocks of size 2^( 4) =       0.001222296990
  error estimate for blocks of size 2^( 5) =       0.001238330794
  error estimate for blocks of size 2^( 6) =       0.001249555708
  error estimate for blocks of size 2^( 7) =       0.001252954815

      target function =                  N/A
              le_mean =     -16.717390752944
             les_mean =     281.982765383281
             stat err =       0.001240784577
             autocorr =       1.212756246290
              std dev =       1.593424802084
             le_variance =       2.539002599895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.539242136288
                                         uncertainty =       0.028880099493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.539242136288
                                         uncertainty =       0.028880099493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126702939
  error estimate for blocks of size 2^( 2) =       0.001165721276
  error estimate for blocks of size 2^( 3) =       0.001199780276
  error estimate for blocks of size 2^( 4) =       0.001222296724
  error estimate for blocks of size 2^( 5) =       0.001238330551
  error estimate for blocks of size 2^( 6) =       0.001249555483
  error estimate for blocks of size 2^( 7) =       0.001252954548

      target function =                  N/A
              le_mean =     -16.717390771243
             les_mean =     281.982762768559
             stat err =       0.001240784327
             autocorr =       1.212756870708
              std dev =       1.593424070830
             le_variance =       2.539000269501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.539243302002
                                         uncertainty =       0.028880097820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.539243302002
                                         uncertainty =       0.028880097820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126703197
  error estimate for blocks of size 2^( 2) =       0.001165721491
  error estimate for blocks of size 2^( 3) =       0.001199780444
  error estimate for blocks of size 2^( 4) =       0.001222296857
  error estimate for blocks of size 2^( 5) =       0.001238330672
  error estimate for blocks of size 2^( 6) =       0.001249555596
  error estimate for blocks of size 2^( 7) =       0.001252954681

      target function =                  N/A
              le_mean =     -16.717390762080
             les_mean =     281.982764032554
             stat err =       0.001240784452
             autocorr =       1.212756558605
              std dev =       1.593424436312
             le_variance =       2.539001434235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.539244322789
                                         uncertainty =       0.028880096358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.539244322789
                                         uncertainty =       0.028880096358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126703423
  error estimate for blocks of size 2^( 2) =       0.001165721679
  error estimate for blocks of size 2^( 3) =       0.001199780591
  error estimate for blocks of size 2^( 4) =       0.001222296973
  error estimate for blocks of size 2^( 5) =       0.001238330779
  error estimate for blocks of size 2^( 6) =       0.001249555694
  error estimate for blocks of size 2^( 7) =       0.001252954798

      target function =                  N/A
              le_mean =     -16.717390754084
             les_mean =     281.982765209256
             stat err =       0.001240784561
             autocorr =       1.212756285332
              std dev =       1.593424756355
             le_variance =       2.539002454164


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717390752944        initial
     6.2500e+02     6.2500e+03             2.6364e-06       -16.717390771243  <--
     2.5000e+03     2.5000e+04             6.5930e-07       -16.717390762080
     1.0000e+04     1.0000e+05             1.6484e-07       -16.717390754084

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 2.4087e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 7.066997e-01 3 1  ON 0
ci_0002                 6.799217e-01 3 1  ON 1
ci_0003                -4.811621e-02 3 1  ON 2
ci_0004                -4.644760e-02 3 1  ON 3
ci_0005                -4.623382e-02 3 1  ON 4
ci_0006                -4.353944e-02 3 1  ON 5
ci_0007                -3.118364e-02 3 1  ON 6
ci_0008                -3.131747e-02 3 1  ON 7
ci_0009                -3.232972e-02 3 1  ON 8
ci_0010                -3.057703e-02 3 1  ON 9
ci_0011                -2.686979e-02 3 1  ON 10
ci_0012                -2.561193e-02 3 1  ON 11
ci_0013                 2.738316e-02 3 1  ON 12
ci_0014                 2.711391e-02 3 1  ON 13
ci_0015                 2.758975e-02 3 1  ON 14
ci_0016                 2.635935e-02 3 1  ON 15
ci_0017                 2.493547e-02 3 1  ON 16
ci_0018                 2.323424e-02 3 1  ON 17
ci_0019                 2.065687e-02 3 1  ON 18
ci_0020                 1.929456e-02 3 1  ON 19
ci_0021                 1.841866e-02 3 1  ON 20
ci_0022                 1.856885e-02 3 1  ON 21
ci_0023                -2.020627e-02 3 1  ON 22
ci_0024                -1.837201e-02 3 1  ON 23
ci_0025                -1.866846e-02 3 1  ON 24
ci_0026                -1.780728e-02 3 1  ON 25
ci_0027                -1.782016e-02 3 1  ON 26
ci_0028                -1.749523e-02 3 1  ON 27
ci_0029                -1.474710e-02 3 1  ON 28
ci_0030                -1.640075e-02 3 1  ON 29
ci_0031                 1.529430e-02 3 1  ON 30
ci_0032                 1.456523e-02 3 1  ON 31
ci_0033                 1.664366e-02 3 1  ON 32
ci_0034                 1.579200e-02 3 1  ON 33
ci_0035                 1.690556e-02 3 1  ON 34
ci_0036                 1.724719e-02 3 1  ON 35
ci_0037                -1.552147e-02 3 1  ON 36
ci_0038                -1.394722e-02 3 1  ON 37
ci_0039                -1.574838e-02 3 1  ON 38
ci_0040                -1.520892e-02 3 1  ON 39
ci_0041                 1.632406e-02 3 1  ON 40
ci_0042                 1.554766e-02 3 1  ON 41
ci_0043                -1.465192e-02 3 1  ON 42
ci_0044                -1.603327e-02 3 1  ON 43
ci_0045                 1.512584e-02 3 1  ON 44
ci_0046                 1.586942e-02 3 1  ON 45
ci_0047                -1.469195e-02 3 1  ON 46
ci_0048                -1.411462e-02 3 1  ON 47
ci_0049                -1.249632e-02 3 1  ON 48
ci_0050                -1.256020e-02 3 1  ON 49
ci_0051                -1.312793e-02 3 1  ON 50
ci_0052                -1.236046e-02 3 1  ON 51
ci_0053                -1.344855e-02 3 1  ON 52
ci_0054                -1.219962e-02 3 1  ON 53
ci_0055                 1.359492e-02 3 1  ON 54
ci_0056                 1.347269e-02 3 1  ON 55
ci_0057                 1.390249e-02 3 1  ON 56
ci_0058                 1.286698e-02 3 1  ON 57
ci_0059                -1.368423e-02 3 1  ON 58
ci_0060                -1.217067e-02 3 1  ON 59
ci_0061                -1.296211e-02 3 1  ON 60
ci_0062                -1.245243e-02 3 1  ON 61
ci_0063                -1.176599e-02 3 1  ON 62
ci_0064                -1.103452e-02 3 1  ON 63
ci_0065                -1.125991e-02 3 1  ON 64
ci_0066                -1.124534e-02 3 1  ON 65
ci_0067                -1.172716e-02 3 1  ON 66
ci_0068                -1.039722e-02 3 1  ON 67
ci_0069                 1.143718e-02 3 1  ON 68
ci_0070                 1.001083e-02 3 1  ON 69
ci_0071                 9.892996e-03 3 1  ON 70
ci_0072                 1.032687e-02 3 1  ON 71
ci_0073                 1.134837e-02 3 1  ON 72
ci_0074                 1.068151e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0444e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6614e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.7303
    reference variance = 2.03774
====================================================
  Execution time = 1.3143e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0270e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5816e+00
  Total weights = 1.945746541e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1895e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.604174725246
                                         uncertainty =       0.056088125608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.604174725246
                                         uncertainty =       0.056088125608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001141026252
  error estimate for blocks of size 2^( 2) =       0.001179046681
  error estimate for blocks of size 2^( 3) =       0.001210839675
  error estimate for blocks of size 2^( 4) =       0.001235848023
  error estimate for blocks of size 2^( 5) =       0.001252360000
  error estimate for blocks of size 2^( 6) =       0.001260535401
  error estimate for blocks of size 2^( 7) =       0.001268532293

      target function =                  N/A
              le_mean =     -16.718214489874
             les_mean =     282.080336675331
             stat err =       0.001254318929
             autocorr =       1.208438853595
              std dev =       1.613680618180
             le_variance =       2.603965137489


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671821448987e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718214488924       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718214730788       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718214730090       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+02 is 7.369305e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718214488924       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718214549481       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718214549307       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+02 is 1.846091e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718214488924       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718214504069       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718214504026       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+03 is 4.617587e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310177 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6339e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.066999e-01 3 1  ON 0
ci_0002                 6.799217e-01 3 1  ON 1
ci_0003                -4.811620e-02 3 1  ON 2
ci_0004                -4.644751e-02 3 1  ON 3
ci_0005                -4.623378e-02 3 1  ON 4
ci_0006                -4.353903e-02 3 1  ON 5
ci_0007                -3.118342e-02 3 1  ON 6
ci_0008                -3.131711e-02 3 1  ON 7
ci_0009                -3.232992e-02 3 1  ON 8
ci_0010                -3.057701e-02 3 1  ON 9
ci_0011                -2.686999e-02 3 1  ON 10
ci_0012                -2.561211e-02 3 1  ON 11
ci_0013                 2.738293e-02 3 1  ON 12
ci_0014                 2.711396e-02 3 1  ON 13
ci_0015                 2.758966e-02 3 1  ON 14
ci_0016                 2.635928e-02 3 1  ON 15
ci_0017                 2.493485e-02 3 1  ON 16
ci_0018                 2.323488e-02 3 1  ON 17
ci_0019                 2.065644e-02 3 1  ON 18
ci_0020                 1.929439e-02 3 1  ON 19
ci_0021                 1.841851e-02 3 1  ON 20
ci_0022                 1.856920e-02 3 1  ON 21
ci_0023                -2.020612e-02 3 1  ON 22
ci_0024                -1.837213e-02 3 1  ON 23
ci_0025                -1.866855e-02 3 1  ON 24
ci_0026                -1.780712e-02 3 1  ON 25
ci_0027                -1.782005e-02 3 1  ON 26
ci_0028                -1.749494e-02 3 1  ON 27
ci_0029                -1.474800e-02 3 1  ON 28
ci_0030                -1.640068e-02 3 1  ON 29
ci_0031                 1.529438e-02 3 1  ON 30
ci_0032                 1.456566e-02 3 1  ON 31
ci_0033                 1.664433e-02 3 1  ON 32
ci_0034                 1.579158e-02 3 1  ON 33
ci_0035                 1.690544e-02 3 1  ON 34
ci_0036                 1.724636e-02 3 1  ON 35
ci_0037                -1.552120e-02 3 1  ON 36
ci_0038                -1.394719e-02 3 1  ON 37
ci_0039                -1.574820e-02 3 1  ON 38
ci_0040                -1.521016e-02 3 1  ON 39
ci_0041                 1.632385e-02 3 1  ON 40
ci_0042                 1.554786e-02 3 1  ON 41
ci_0043                -1.465208e-02 3 1  ON 42
ci_0044                -1.603289e-02 3 1  ON 43
ci_0045                 1.512604e-02 3 1  ON 44
ci_0046                 1.586892e-02 3 1  ON 45
ci_0047                -1.469157e-02 3 1  ON 46
ci_0048                -1.411455e-02 3 1  ON 47
ci_0049                -1.249684e-02 3 1  ON 48
ci_0050                -1.255990e-02 3 1  ON 49
ci_0051                -1.312810e-02 3 1  ON 50
ci_0052                -1.235862e-02 3 1  ON 51
ci_0053                -1.344849e-02 3 1  ON 52
ci_0054                -1.219995e-02 3 1  ON 53
ci_0055                 1.359456e-02 3 1  ON 54
ci_0056                 1.347226e-02 3 1  ON 55
ci_0057                 1.390229e-02 3 1  ON 56
ci_0058                 1.286727e-02 3 1  ON 57
ci_0059                -1.368403e-02 3 1  ON 58
ci_0060                -1.217109e-02 3 1  ON 59
ci_0061                -1.296155e-02 3 1  ON 60
ci_0062                -1.245303e-02 3 1  ON 61
ci_0063                -1.176568e-02 3 1  ON 62
ci_0064                -1.103477e-02 3 1  ON 63
ci_0065                -1.126009e-02 3 1  ON 64
ci_0066                -1.124583e-02 3 1  ON 65
ci_0067                -1.172698e-02 3 1  ON 66
ci_0068                -1.039726e-02 3 1  ON 67
ci_0069                 1.143674e-02 3 1  ON 68
ci_0070                 1.000975e-02 3 1  ON 69
ci_0071                 9.892908e-03 3 1  ON 70
ci_0072                 1.032670e-02 3 1  ON 71
ci_0073                 1.134822e-02 3 1  ON 72
ci_0074                 1.068145e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9677
    reference variance = 1.13514
====================================================
  Execution time = 1.2888e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5781e+00
  Total weights = 1.9457e+06
  Execution time = 2.2329e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.606633971454
                                         uncertainty =       0.041912876592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.606633971454
                                         uncertainty =       0.041912876592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001141465433
  error estimate for blocks of size 2^( 2) =       0.001179726380
  error estimate for blocks of size 2^( 3) =       0.001213011468
  error estimate for blocks of size 2^( 4) =       0.001236290084
  error estimate for blocks of size 2^( 5) =       0.001248568586
  error estimate for blocks of size 2^( 6) =       0.001256155164
  error estimate for blocks of size 2^( 7) =       0.001258451285

      target function =                  N/A
              le_mean =     -16.716567723710
             les_mean =     282.021776740511
             stat err =       0.001249866280
             autocorr =       1.198951385688
              std dev =       1.614301724842
             le_variance =       2.605970058828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.606627153378
                                         uncertainty =       0.041912896192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.606627153378
                                         uncertainty =       0.041912896192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001141463941
  error estimate for blocks of size 2^( 2) =       0.001179725076
  error estimate for blocks of size 2^( 3) =       0.001213010409
  error estimate for blocks of size 2^( 4) =       0.001236289441
  error estimate for blocks of size 2^( 5) =       0.001248568120
  error estimate for blocks of size 2^( 6) =       0.001256154755
  error estimate for blocks of size 2^( 7) =       0.001258450274

      target function =                  N/A
              le_mean =     -16.716567672533
             les_mean =     282.021764165208
             stat err =       0.001249865648
             autocorr =       1.198953307634
              std dev =       1.614299614498
             le_variance =       2.605963245367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.606630554902
                                         uncertainty =       0.041912886403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.606630554902
                                         uncertainty =       0.041912886403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001141464685
  error estimate for blocks of size 2^( 2) =       0.001179725726
  error estimate for blocks of size 2^( 3) =       0.001213010937
  error estimate for blocks of size 2^( 4) =       0.001236289762
  error estimate for blocks of size 2^( 5) =       0.001248568352
  error estimate for blocks of size 2^( 6) =       0.001256154959
  error estimate for blocks of size 2^( 7) =       0.001258450778

      target function =                  N/A
              le_mean =     -16.716567697849
             les_mean =     282.021769684377
             stat err =       0.001249865963
             autocorr =       1.198952348532
              std dev =       1.614300667345
             le_variance =       2.605966644589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.606633544035
                                         uncertainty =       0.041912877819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.606633544035
                                         uncertainty =       0.041912877819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001141465340
  error estimate for blocks of size 2^( 2) =       0.001179726299
  error estimate for blocks of size 2^( 3) =       0.001213011402
  error estimate for blocks of size 2^( 4) =       0.001236290044
  error estimate for blocks of size 2^( 5) =       0.001248568557
  error estimate for blocks of size 2^( 6) =       0.001256155138
  error estimate for blocks of size 2^( 7) =       0.001258451222

      target function =                  N/A
              le_mean =     -16.716567720449
             les_mean =     282.021775730145
             stat err =       0.001249866240
             autocorr =       1.198951506122
              std dev =       1.614301592547
             le_variance =       2.605969631698


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716567723710        initial  <--
     1.5625e+02     1.5625e+03             7.3693e-06       -16.716567672533
     6.2500e+02     6.2500e+03             1.8461e-06       -16.716567697849
     2.5000e+03     2.5000e+04             4.6176e-07       -16.716567720449

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1087
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.066997e-01 3 1  ON 0
ci_0002                 6.799217e-01 3 1  ON 1
ci_0003                -4.811621e-02 3 1  ON 2
ci_0004                -4.644760e-02 3 1  ON 3
ci_0005                -4.623382e-02 3 1  ON 4
ci_0006                -4.353944e-02 3 1  ON 5
ci_0007                -3.118364e-02 3 1  ON 6
ci_0008                -3.131747e-02 3 1  ON 7
ci_0009                -3.232972e-02 3 1  ON 8
ci_0010                -3.057703e-02 3 1  ON 9
ci_0011                -2.686979e-02 3 1  ON 10
ci_0012                -2.561193e-02 3 1  ON 11
ci_0013                 2.738316e-02 3 1  ON 12
ci_0014                 2.711391e-02 3 1  ON 13
ci_0015                 2.758975e-02 3 1  ON 14
ci_0016                 2.635935e-02 3 1  ON 15
ci_0017                 2.493547e-02 3 1  ON 16
ci_0018                 2.323424e-02 3 1  ON 17
ci_0019                 2.065687e-02 3 1  ON 18
ci_0020                 1.929456e-02 3 1  ON 19
ci_0021                 1.841866e-02 3 1  ON 20
ci_0022                 1.856885e-02 3 1  ON 21
ci_0023                -2.020627e-02 3 1  ON 22
ci_0024                -1.837201e-02 3 1  ON 23
ci_0025                -1.866846e-02 3 1  ON 24
ci_0026                -1.780728e-02 3 1  ON 25
ci_0027                -1.782016e-02 3 1  ON 26
ci_0028                -1.749523e-02 3 1  ON 27
ci_0029                -1.474710e-02 3 1  ON 28
ci_0030                -1.640075e-02 3 1  ON 29
ci_0031                 1.529430e-02 3 1  ON 30
ci_0032                 1.456523e-02 3 1  ON 31
ci_0033                 1.664366e-02 3 1  ON 32
ci_0034                 1.579200e-02 3 1  ON 33
ci_0035                 1.690556e-02 3 1  ON 34
ci_0036                 1.724719e-02 3 1  ON 35
ci_0037                -1.552147e-02 3 1  ON 36
ci_0038                -1.394722e-02 3 1  ON 37
ci_0039                -1.574838e-02 3 1  ON 38
ci_0040                -1.520892e-02 3 1  ON 39
ci_0041                 1.632406e-02 3 1  ON 40
ci_0042                 1.554766e-02 3 1  ON 41
ci_0043                -1.465192e-02 3 1  ON 42
ci_0044                -1.603327e-02 3 1  ON 43
ci_0045                 1.512584e-02 3 1  ON 44
ci_0046                 1.586942e-02 3 1  ON 45
ci_0047                -1.469195e-02 3 1  ON 46
ci_0048                -1.411462e-02 3 1  ON 47
ci_0049                -1.249632e-02 3 1  ON 48
ci_0050                -1.256020e-02 3 1  ON 49
ci_0051                -1.312793e-02 3 1  ON 50
ci_0052                -1.236046e-02 3 1  ON 51
ci_0053                -1.344855e-02 3 1  ON 52
ci_0054                -1.219962e-02 3 1  ON 53
ci_0055                 1.359492e-02 3 1  ON 54
ci_0056                 1.347269e-02 3 1  ON 55
ci_0057                 1.390249e-02 3 1  ON 56
ci_0058                 1.286698e-02 3 1  ON 57
ci_0059                -1.368423e-02 3 1  ON 58
ci_0060                -1.217067e-02 3 1  ON 59
ci_0061                -1.296211e-02 3 1  ON 60
ci_0062                -1.245243e-02 3 1  ON 61
ci_0063                -1.176599e-02 3 1  ON 62
ci_0064                -1.103452e-02 3 1  ON 63
ci_0065                -1.125991e-02 3 1  ON 64
ci_0066                -1.124534e-02 3 1  ON 65
ci_0067                -1.172716e-02 3 1  ON 66
ci_0068                -1.039722e-02 3 1  ON 67
ci_0069                 1.143718e-02 3 1  ON 68
ci_0070                 1.001083e-02 3 1  ON 69
ci_0071                 9.892996e-03 3 1  ON 70
ci_0072                 1.032687e-02 3 1  ON 71
ci_0073                 1.134837e-02 3 1  ON 72
ci_0074                 1.068151e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0454e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6648e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.7886
    reference variance = 1.69634
====================================================
  Execution time = 1.3125e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0268e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5278e+00
  Total weights = 1.945852482e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2156e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554072787429
                                         uncertainty =       0.037882764894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554072787429
                                         uncertainty =       0.037882764894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129993748
  error estimate for blocks of size 2^( 2) =       0.001167722880
  error estimate for blocks of size 2^( 3) =       0.001200003405
  error estimate for blocks of size 2^( 4) =       0.001221564857
  error estimate for blocks of size 2^( 5) =       0.001236066484
  error estimate for blocks of size 2^( 6) =       0.001242682100
  error estimate for blocks of size 2^( 7) =       0.001252240572

      target function =                  N/A
              le_mean =     -16.719464701607
             les_mean =     282.068267002779
             stat err =       0.001238138503
             autocorr =       1.200566931863
              std dev =       1.598078052998
             le_variance =       2.553853463475


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671946470161e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719464700702       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719464710291       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719464710500       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+03 is 2.577565e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719464700702       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719464703100       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719464703152       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+03 is 6.444747e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719464700702       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719464701302       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719464701315       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+04 is 1.611239e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.311322 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6349e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 7.066998e-01 3 1  ON 0
ci_0002                 6.799217e-01 3 1  ON 1
ci_0003                -4.811624e-02 3 1  ON 2
ci_0004                -4.644758e-02 3 1  ON 3
ci_0005                -4.623383e-02 3 1  ON 4
ci_0006                -4.353948e-02 3 1  ON 5
ci_0007                -3.118368e-02 3 1  ON 6
ci_0008                -3.131746e-02 3 1  ON 7
ci_0009                -3.232971e-02 3 1  ON 8
ci_0010                -3.057707e-02 3 1  ON 9
ci_0011                -2.686983e-02 3 1  ON 10
ci_0012                -2.561200e-02 3 1  ON 11
ci_0013                 2.738316e-02 3 1  ON 12
ci_0014                 2.711387e-02 3 1  ON 13
ci_0015                 2.758973e-02 3 1  ON 14
ci_0016                 2.635936e-02 3 1  ON 15
ci_0017                 2.493541e-02 3 1  ON 16
ci_0018                 2.323427e-02 3 1  ON 17
ci_0019                 2.065688e-02 3 1  ON 18
ci_0020                 1.929456e-02 3 1  ON 19
ci_0021                 1.841866e-02 3 1  ON 20
ci_0022                 1.856885e-02 3 1  ON 21
ci_0023                -2.020623e-02 3 1  ON 22
ci_0024                -1.837200e-02 3 1  ON 23
ci_0025                -1.866848e-02 3 1  ON 24
ci_0026                -1.780732e-02 3 1  ON 25
ci_0027                -1.782012e-02 3 1  ON 26
ci_0028                -1.749523e-02 3 1  ON 27
ci_0029                -1.474715e-02 3 1  ON 28
ci_0030                -1.640075e-02 3 1  ON 29
ci_0031                 1.529427e-02 3 1  ON 30
ci_0032                 1.456521e-02 3 1  ON 31
ci_0033                 1.664370e-02 3 1  ON 32
ci_0034                 1.579203e-02 3 1  ON 33
ci_0035                 1.690559e-02 3 1  ON 34
ci_0036                 1.724718e-02 3 1  ON 35
ci_0037                -1.552148e-02 3 1  ON 36
ci_0038                -1.394723e-02 3 1  ON 37
ci_0039                -1.574837e-02 3 1  ON 38
ci_0040                -1.520890e-02 3 1  ON 39
ci_0041                 1.632404e-02 3 1  ON 40
ci_0042                 1.554765e-02 3 1  ON 41
ci_0043                -1.465192e-02 3 1  ON 42
ci_0044                -1.603324e-02 3 1  ON 43
ci_0045                 1.512583e-02 3 1  ON 44
ci_0046                 1.586939e-02 3 1  ON 45
ci_0047                -1.469189e-02 3 1  ON 46
ci_0048                -1.411464e-02 3 1  ON 47
ci_0049                -1.249632e-02 3 1  ON 48
ci_0050                -1.256024e-02 3 1  ON 49
ci_0051                -1.312796e-02 3 1  ON 50
ci_0052                -1.236050e-02 3 1  ON 51
ci_0053                -1.344855e-02 3 1  ON 52
ci_0054                -1.219961e-02 3 1  ON 53
ci_0055                 1.359487e-02 3 1  ON 54
ci_0056                 1.347267e-02 3 1  ON 55
ci_0057                 1.390243e-02 3 1  ON 56
ci_0058                 1.286693e-02 3 1  ON 57
ci_0059                -1.368420e-02 3 1  ON 58
ci_0060                -1.217070e-02 3 1  ON 59
ci_0061                -1.296212e-02 3 1  ON 60
ci_0062                -1.245242e-02 3 1  ON 61
ci_0063                -1.176604e-02 3 1  ON 62
ci_0064                -1.103450e-02 3 1  ON 63
ci_0065                -1.125992e-02 3 1  ON 64
ci_0066                -1.124530e-02 3 1  ON 65
ci_0067                -1.172711e-02 3 1  ON 66
ci_0068                -1.039721e-02 3 1  ON 67
ci_0069                 1.143714e-02 3 1  ON 68
ci_0070                 1.001086e-02 3 1  ON 69
ci_0071                 9.892982e-03 3 1  ON 70
ci_0072                 1.032686e-02 3 1  ON 71
ci_0073                 1.134836e-02 3 1  ON 72
ci_0074                 1.068150e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8235
    reference variance = 0.980123
====================================================
  Execution time = 1.2820e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5325e+00
  Total weights = 1.9457e+06
  Execution time = 2.2267e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561525479987
                                         uncertainty =       0.046443235874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561525479987
                                         uncertainty =       0.046443235874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131783480
  error estimate for blocks of size 2^( 2) =       0.001170246898
  error estimate for blocks of size 2^( 3) =       0.001201802699
  error estimate for blocks of size 2^( 4) =       0.001223064295
  error estimate for blocks of size 2^( 5) =       0.001241006209
  error estimate for blocks of size 2^( 6) =       0.001245461647
  error estimate for blocks of size 2^( 7) =       0.001245033532

      target function =                  N/A
              le_mean =     -16.718448832697
             les_mean =     282.039035428051
             stat err =       0.001238641421
             autocorr =       1.197745358749
              std dev =       1.600609156848
             le_variance =       2.561949672987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561525371302
                                         uncertainty =       0.046443227906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561525371302
                                         uncertainty =       0.046443227906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131783457
  error estimate for blocks of size 2^( 2) =       0.001170246875
  error estimate for blocks of size 2^( 3) =       0.001201802681
  error estimate for blocks of size 2^( 4) =       0.001223064287
  error estimate for blocks of size 2^( 5) =       0.001241006197
  error estimate for blocks of size 2^( 6) =       0.001245461631
  error estimate for blocks of size 2^( 7) =       0.001245033531

      target function =                  N/A
              le_mean =     -16.718448834557
             les_mean =     282.039035426135
             stat err =       0.001238641412
             autocorr =       1.197745390761
              std dev =       1.600609123384
             le_variance =       2.561949565862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561525425635
                                         uncertainty =       0.046443231889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561525425635
                                         uncertainty =       0.046443231889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131783469
  error estimate for blocks of size 2^( 2) =       0.001170246887
  error estimate for blocks of size 2^( 3) =       0.001201802690
  error estimate for blocks of size 2^( 4) =       0.001223064291
  error estimate for blocks of size 2^( 5) =       0.001241006203
  error estimate for blocks of size 2^( 6) =       0.001245461639
  error estimate for blocks of size 2^( 7) =       0.001245033532

      target function =                  N/A
              le_mean =     -16.718448833627
             les_mean =     282.039035425657
             stat err =       0.001238641416
             autocorr =       1.197745374759
              std dev =       1.600609140113
             le_variance =       2.561949619415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561525473192
                                         uncertainty =       0.046443235376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561525473192
                                         uncertainty =       0.046443235376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131783479
  error estimate for blocks of size 2^( 2) =       0.001170246897
  error estimate for blocks of size 2^( 3) =       0.001201802698
  error estimate for blocks of size 2^( 4) =       0.001223064295
  error estimate for blocks of size 2^( 5) =       0.001241006208
  error estimate for blocks of size 2^( 6) =       0.001245461646
  error estimate for blocks of size 2^( 7) =       0.001245033532

      target function =                  N/A
              le_mean =     -16.718448832813
             les_mean =     282.039035427599
             stat err =       0.001238641420
             autocorr =       1.197745360750
              std dev =       1.600609154756
             le_variance =       2.561949666290


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718448832697        initial
     1.5625e+03     1.5625e+04             2.5776e-07       -16.718448834557  <--
     6.2500e+03     6.2500e+04             6.4447e-08       -16.718448833627
     2.5000e+04     2.5000e+05             1.6112e-08       -16.718448832813

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 2.4053e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 7.066998e-01 3 1  ON 0
ci_0002                 6.799216e-01 3 1  ON 1
ci_0003                -4.811631e-02 3 1  ON 2
ci_0004                -4.644754e-02 3 1  ON 3
ci_0005                -4.623387e-02 3 1  ON 4
ci_0006                -4.353959e-02 3 1  ON 5
ci_0007                -3.118382e-02 3 1  ON 6
ci_0008                -3.131743e-02 3 1  ON 7
ci_0009                -3.232969e-02 3 1  ON 8
ci_0010                -3.057717e-02 3 1  ON 9
ci_0011                -2.686994e-02 3 1  ON 10
ci_0012                -2.561219e-02 3 1  ON 11
ci_0013                 2.738317e-02 3 1  ON 12
ci_0014                 2.711376e-02 3 1  ON 13
ci_0015                 2.758968e-02 3 1  ON 14
ci_0016                 2.635937e-02 3 1  ON 15
ci_0017                 2.493521e-02 3 1  ON 16
ci_0018                 2.323436e-02 3 1  ON 17
ci_0019                 2.065694e-02 3 1  ON 18
ci_0020                 1.929457e-02 3 1  ON 19
ci_0021                 1.841865e-02 3 1  ON 20
ci_0022                 1.856883e-02 3 1  ON 21
ci_0023                -2.020610e-02 3 1  ON 22
ci_0024                -1.837198e-02 3 1  ON 23
ci_0025                -1.866854e-02 3 1  ON 24
ci_0026                -1.780744e-02 3 1  ON 25
ci_0027                -1.782002e-02 3 1  ON 26
ci_0028                -1.749522e-02 3 1  ON 27
ci_0029                -1.474731e-02 3 1  ON 28
ci_0030                -1.640073e-02 3 1  ON 29
ci_0031                 1.529420e-02 3 1  ON 30
ci_0032                 1.456513e-02 3 1  ON 31
ci_0033                 1.664381e-02 3 1  ON 32
ci_0034                 1.579212e-02 3 1  ON 33
ci_0035                 1.690568e-02 3 1  ON 34
ci_0036                 1.724714e-02 3 1  ON 35
ci_0037                -1.552149e-02 3 1  ON 36
ci_0038                -1.394726e-02 3 1  ON 37
ci_0039                -1.574832e-02 3 1  ON 38
ci_0040                -1.520885e-02 3 1  ON 39
ci_0041                 1.632398e-02 3 1  ON 40
ci_0042                 1.554763e-02 3 1  ON 41
ci_0043                -1.465195e-02 3 1  ON 42
ci_0044                -1.603316e-02 3 1  ON 43
ci_0045                 1.512579e-02 3 1  ON 44
ci_0046                 1.586932e-02 3 1  ON 45
ci_0047                -1.469171e-02 3 1  ON 46
ci_0048                -1.411469e-02 3 1  ON 47
ci_0049                -1.249632e-02 3 1  ON 48
ci_0050                -1.256036e-02 3 1  ON 49
ci_0051                -1.312802e-02 3 1  ON 50
ci_0052                -1.236062e-02 3 1  ON 51
ci_0053                -1.344854e-02 3 1  ON 52
ci_0054                -1.219957e-02 3 1  ON 53
ci_0055                 1.359472e-02 3 1  ON 54
ci_0056                 1.347260e-02 3 1  ON 55
ci_0057                 1.390227e-02 3 1  ON 56
ci_0058                 1.286678e-02 3 1  ON 57
ci_0059                -1.368411e-02 3 1  ON 58
ci_0060                -1.217077e-02 3 1  ON 59
ci_0061                -1.296218e-02 3 1  ON 60
ci_0062                -1.245240e-02 3 1  ON 61
ci_0063                -1.176617e-02 3 1  ON 62
ci_0064                -1.103447e-02 3 1  ON 63
ci_0065                -1.125998e-02 3 1  ON 64
ci_0066                -1.124518e-02 3 1  ON 65
ci_0067                -1.172694e-02 3 1  ON 66
ci_0068                -1.039717e-02 3 1  ON 67
ci_0069                 1.143700e-02 3 1  ON 68
ci_0070                 1.001094e-02 3 1  ON 69
ci_0071                 9.892941e-03 3 1  ON 70
ci_0072                 1.032683e-02 3 1  ON 71
ci_0073                 1.134836e-02 3 1  ON 72
ci_0074                 1.068146e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0407e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.5846
    reference variance = 2.75017
====================================================
  Execution time = 1.3074e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0277e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5018e+00
  Total weights = 1.945286705e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1874e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.526522509628
                                         uncertainty =       0.024744074553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.526522509628
                                         uncertainty =       0.024744074553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001123723026
  error estimate for blocks of size 2^( 2) =       0.001162277255
  error estimate for blocks of size 2^( 3) =       0.001194178295
  error estimate for blocks of size 2^( 4) =       0.001214741700
  error estimate for blocks of size 2^( 5) =       0.001231712466
  error estimate for blocks of size 2^( 6) =       0.001238510957
  error estimate for blocks of size 2^( 7) =       0.001245237319

      target function =                  N/A
              le_mean =     -16.718798430316
             les_mean =     282.020049652052
             stat err =       0.001232550610
             autocorr =       1.203070179917
              std dev =       1.589209770223
             le_variance =       2.525587693772


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671879843032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718798429394       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718798482480       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718798482377       residual = 2.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+02 is 1.278251e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718798429394       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718798442672       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718798442646       residual = 2.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+03 is 3.197017e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718798429394       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718798432714       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718798432708       residual = 2.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+03 is 7.993411e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.312501 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6268e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 7.067000e-01 3 1  ON 0
ci_0002                 6.799215e-01 3 1  ON 1
ci_0003                -4.811641e-02 3 1  ON 2
ci_0004                -4.644768e-02 3 1  ON 3
ci_0005                -4.623379e-02 3 1  ON 4
ci_0006                -4.353959e-02 3 1  ON 5
ci_0007                -3.118383e-02 3 1  ON 6
ci_0008                -3.131754e-02 3 1  ON 7
ci_0009                -3.232980e-02 3 1  ON 8
ci_0010                -3.057696e-02 3 1  ON 9
ci_0011                -2.687007e-02 3 1  ON 10
ci_0012                -2.561222e-02 3 1  ON 11
ci_0013                 2.738329e-02 3 1  ON 12
ci_0014                 2.711375e-02 3 1  ON 13
ci_0015                 2.758971e-02 3 1  ON 14
ci_0016                 2.635928e-02 3 1  ON 15
ci_0017                 2.493507e-02 3 1  ON 16
ci_0018                 2.323433e-02 3 1  ON 17
ci_0019                 2.065678e-02 3 1  ON 18
ci_0020                 1.929447e-02 3 1  ON 19
ci_0021                 1.841859e-02 3 1  ON 20
ci_0022                 1.856865e-02 3 1  ON 21
ci_0023                -2.020601e-02 3 1  ON 22
ci_0024                -1.837196e-02 3 1  ON 23
ci_0025                -1.866863e-02 3 1  ON 24
ci_0026                -1.780729e-02 3 1  ON 25
ci_0027                -1.781998e-02 3 1  ON 26
ci_0028                -1.749517e-02 3 1  ON 27
ci_0029                -1.474763e-02 3 1  ON 28
ci_0030                -1.640069e-02 3 1  ON 29
ci_0031                 1.529415e-02 3 1  ON 30
ci_0032                 1.456520e-02 3 1  ON 31
ci_0033                 1.664393e-02 3 1  ON 32
ci_0034                 1.579201e-02 3 1  ON 33
ci_0035                 1.690581e-02 3 1  ON 34
ci_0036                 1.724714e-02 3 1  ON 35
ci_0037                -1.552128e-02 3 1  ON 36
ci_0038                -1.394732e-02 3 1  ON 37
ci_0039                -1.574826e-02 3 1  ON 38
ci_0040                -1.520892e-02 3 1  ON 39
ci_0041                 1.632406e-02 3 1  ON 40
ci_0042                 1.554761e-02 3 1  ON 41
ci_0043                -1.465206e-02 3 1  ON 42
ci_0044                -1.603309e-02 3 1  ON 43
ci_0045                 1.512581e-02 3 1  ON 44
ci_0046                 1.586914e-02 3 1  ON 45
ci_0047                -1.469164e-02 3 1  ON 46
ci_0048                -1.411454e-02 3 1  ON 47
ci_0049                -1.249635e-02 3 1  ON 48
ci_0050                -1.256027e-02 3 1  ON 49
ci_0051                -1.312805e-02 3 1  ON 50
ci_0052                -1.236065e-02 3 1  ON 51
ci_0053                -1.344840e-02 3 1  ON 52
ci_0054                -1.219933e-02 3 1  ON 53
ci_0055                 1.359455e-02 3 1  ON 54
ci_0056                 1.347266e-02 3 1  ON 55
ci_0057                 1.390225e-02 3 1  ON 56
ci_0058                 1.286682e-02 3 1  ON 57
ci_0059                -1.368393e-02 3 1  ON 58
ci_0060                -1.217092e-02 3 1  ON 59
ci_0061                -1.296220e-02 3 1  ON 60
ci_0062                -1.245247e-02 3 1  ON 61
ci_0063                -1.176620e-02 3 1  ON 62
ci_0064                -1.103459e-02 3 1  ON 63
ci_0065                -1.126020e-02 3 1  ON 64
ci_0066                -1.124506e-02 3 1  ON 65
ci_0067                -1.172674e-02 3 1  ON 66
ci_0068                -1.039732e-02 3 1  ON 67
ci_0069                 1.143690e-02 3 1  ON 68
ci_0070                 1.001106e-02 3 1  ON 69
ci_0071                 9.892875e-03 3 1  ON 70
ci_0072                 1.032680e-02 3 1  ON 71
ci_0073                 1.134835e-02 3 1  ON 72
ci_0074                 1.068132e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.7294
    reference variance = 2.30614
====================================================
  Execution time = 1.2886e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5394e+00
  Total weights = 1.9458e+06
  Execution time = 2.2387e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569251549066
                                         uncertainty =       0.031309494079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569251549066
                                         uncertainty =       0.031309494079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133280207
  error estimate for blocks of size 2^( 2) =       0.001172496687
  error estimate for blocks of size 2^( 3) =       0.001206370578
  error estimate for blocks of size 2^( 4) =       0.001230783271
  error estimate for blocks of size 2^( 5) =       0.001244791157
  error estimate for blocks of size 2^( 6) =       0.001250691179
  error estimate for blocks of size 2^( 7) =       0.001253101444

      target function =                  N/A
              le_mean =     -16.717766503713
             les_mean =     282.023149891855
             stat err =       0.001244841763
             autocorr =       1.206573249482
              std dev =       1.602725881004
             le_variance =       2.568730249639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569250114172
                                         uncertainty =       0.031309437259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569250114172
                                         uncertainty =       0.031309437259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133279890
  error estimate for blocks of size 2^( 2) =       0.001172496397
  error estimate for blocks of size 2^( 3) =       0.001206370300
  error estimate for blocks of size 2^( 4) =       0.001230783003
  error estimate for blocks of size 2^( 5) =       0.001244790858
  error estimate for blocks of size 2^( 6) =       0.001250690861
  error estimate for blocks of size 2^( 7) =       0.001253101158

      target function =                  N/A
              le_mean =     -16.717766509260
             les_mean =     282.023148046181
             stat err =       0.001244841470
             autocorr =       1.206573355628
              std dev =       1.602725433795
             le_variance =       2.568728816135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569250831085
                                         uncertainty =       0.031309465646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569250831085
                                         uncertainty =       0.031309465646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133280048
  error estimate for blocks of size 2^( 2) =       0.001172496542
  error estimate for blocks of size 2^( 3) =       0.001206370439
  error estimate for blocks of size 2^( 4) =       0.001230783137
  error estimate for blocks of size 2^( 5) =       0.001244791007
  error estimate for blocks of size 2^( 6) =       0.001250691020
  error estimate for blocks of size 2^( 7) =       0.001253101301

      target function =                  N/A
              le_mean =     -16.717766506481
             les_mean =     282.023148921379
             stat err =       0.001244841616
             autocorr =       1.206573302620
              std dev =       1.602725657233
             le_variance =       2.568729532353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569251459294
                                         uncertainty =       0.031309490524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569251459294
                                         uncertainty =       0.031309490524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133280187
  error estimate for blocks of size 2^( 2) =       0.001172496669
  error estimate for blocks of size 2^( 3) =       0.001206370561
  error estimate for blocks of size 2^( 4) =       0.001230783254
  error estimate for blocks of size 2^( 5) =       0.001244791138
  error estimate for blocks of size 2^( 6) =       0.001250691159
  error estimate for blocks of size 2^( 7) =       0.001253101426

      target function =                  N/A
              le_mean =     -16.717766504058
             les_mean =     282.023149765488
             stat err =       0.001244841744
             autocorr =       1.206573256127
              std dev =       1.602725853025
             le_variance =       2.568730159954


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717766503713        initial
     3.9062e+02     3.9062e+03             1.2783e-06       -16.717766509260  <--
     1.5625e+03     1.5625e+04             3.1970e-07       -16.717766506481
     6.2500e+03     6.2500e+04             7.9934e-08       -16.717766504058

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 2.4107e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 7.067003e-01 3 1  ON 0
ci_0002                 6.799212e-01 3 1  ON 1
ci_0003                -4.811669e-02 3 1  ON 2
ci_0004                -4.644808e-02 3 1  ON 3
ci_0005                -4.623356e-02 3 1  ON 4
ci_0006                -4.353959e-02 3 1  ON 5
ci_0007                -3.118388e-02 3 1  ON 6
ci_0008                -3.131788e-02 3 1  ON 7
ci_0009                -3.233013e-02 3 1  ON 8
ci_0010                -3.057634e-02 3 1  ON 9
ci_0011                -2.687045e-02 3 1  ON 10
ci_0012                -2.561229e-02 3 1  ON 11
ci_0013                 2.738364e-02 3 1  ON 12
ci_0014                 2.711371e-02 3 1  ON 13
ci_0015                 2.758978e-02 3 1  ON 14
ci_0016                 2.635902e-02 3 1  ON 15
ci_0017                 2.493463e-02 3 1  ON 16
ci_0018                 2.323422e-02 3 1  ON 17
ci_0019                 2.065628e-02 3 1  ON 18
ci_0020                 1.929416e-02 3 1  ON 19
ci_0021                 1.841839e-02 3 1  ON 20
ci_0022                 1.856809e-02 3 1  ON 21
ci_0023                -2.020574e-02 3 1  ON 22
ci_0024                -1.837189e-02 3 1  ON 23
ci_0025                -1.866889e-02 3 1  ON 24
ci_0026                -1.780684e-02 3 1  ON 25
ci_0027                -1.781987e-02 3 1  ON 26
ci_0028                -1.749503e-02 3 1  ON 27
ci_0029                -1.474859e-02 3 1  ON 28
ci_0030                -1.640058e-02 3 1  ON 29
ci_0031                 1.529398e-02 3 1  ON 30
ci_0032                 1.456541e-02 3 1  ON 31
ci_0033                 1.664428e-02 3 1  ON 32
ci_0034                 1.579166e-02 3 1  ON 33
ci_0035                 1.690618e-02 3 1  ON 34
ci_0036                 1.724717e-02 3 1  ON 35
ci_0037                -1.552065e-02 3 1  ON 36
ci_0038                -1.394750e-02 3 1  ON 37
ci_0039                -1.574808e-02 3 1  ON 38
ci_0040                -1.520913e-02 3 1  ON 39
ci_0041                 1.632433e-02 3 1  ON 40
ci_0042                 1.554754e-02 3 1  ON 41
ci_0043                -1.465239e-02 3 1  ON 42
ci_0044                -1.603288e-02 3 1  ON 43
ci_0045                 1.512587e-02 3 1  ON 44
ci_0046                 1.586862e-02 3 1  ON 45
ci_0047                -1.469142e-02 3 1  ON 46
ci_0048                -1.411411e-02 3 1  ON 47
ci_0049                -1.249643e-02 3 1  ON 48
ci_0050                -1.256002e-02 3 1  ON 49
ci_0051                -1.312813e-02 3 1  ON 50
ci_0052                -1.236073e-02 3 1  ON 51
ci_0053                -1.344797e-02 3 1  ON 52
ci_0054                -1.219863e-02 3 1  ON 53
ci_0055                 1.359403e-02 3 1  ON 54
ci_0056                 1.347285e-02 3 1  ON 55
ci_0057                 1.390219e-02 3 1  ON 56
ci_0058                 1.286695e-02 3 1  ON 57
ci_0059                -1.368338e-02 3 1  ON 58
ci_0060                -1.217134e-02 3 1  ON 59
ci_0061                -1.296225e-02 3 1  ON 60
ci_0062                -1.245269e-02 3 1  ON 61
ci_0063                -1.176626e-02 3 1  ON 62
ci_0064                -1.103495e-02 3 1  ON 63
ci_0065                -1.126085e-02 3 1  ON 64
ci_0066                -1.124471e-02 3 1  ON 65
ci_0067                -1.172614e-02 3 1  ON 66
ci_0068                -1.039775e-02 3 1  ON 67
ci_0069                 1.143660e-02 3 1  ON 68
ci_0070                 1.001144e-02 3 1  ON 69
ci_0071                 9.892676e-03 3 1  ON 70
ci_0072                 1.032673e-02 3 1  ON 71
ci_0073                 1.134832e-02 3 1  ON 72
ci_0074                 1.068088e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0385e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.5722
    reference variance = 5.82321
====================================================
  Execution time = 1.3084e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0255e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5996e+00
  Total weights = 1.945598998e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1821e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.627187317579
                                         uncertainty =       0.074592187055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.627187317579
                                         uncertainty =       0.074592187055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001145998052
  error estimate for blocks of size 2^( 2) =       0.001185064904
  error estimate for blocks of size 2^( 3) =       0.001217097365
  error estimate for blocks of size 2^( 4) =       0.001240104341
  error estimate for blocks of size 2^( 5) =       0.001255980373
  error estimate for blocks of size 2^( 6) =       0.001262368960
  error estimate for blocks of size 2^( 7) =       0.001268096375

      target function =                  N/A
              le_mean =     -16.719195548591
             les_mean =     282.131142442942
             stat err =       0.001256637512
             autocorr =       1.202409172940
              std dev =       1.620711918785
             le_variance =       2.626707123693


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671919554859e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719195547612       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719195780194       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719195778687       residual = 1.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+01 is 4.445688e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719195547612       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719195605869       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719195605499       residual = 1.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+02 is 1.113715e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719195547612       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719195562184       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719195562092       residual = 1.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+03 is 2.785726e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.313708 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6273e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.067005e-01 3 1  ON 0
ci_0002                 6.799210e-01 3 1  ON 1
ci_0003                -4.811689e-02 3 1  ON 2
ci_0004                -4.644813e-02 3 1  ON 3
ci_0005                -4.623396e-02 3 1  ON 4
ci_0006                -4.353948e-02 3 1  ON 5
ci_0007                -3.118351e-02 3 1  ON 6
ci_0008                -3.131753e-02 3 1  ON 7
ci_0009                -3.233006e-02 3 1  ON 8
ci_0010                -3.057617e-02 3 1  ON 9
ci_0011                -2.687068e-02 3 1  ON 10
ci_0012                -2.561228e-02 3 1  ON 11
ci_0013                 2.738364e-02 3 1  ON 12
ci_0014                 2.711362e-02 3 1  ON 13
ci_0015                 2.758994e-02 3 1  ON 14
ci_0016                 2.635889e-02 3 1  ON 15
ci_0017                 2.493379e-02 3 1  ON 16
ci_0018                 2.323492e-02 3 1  ON 17
ci_0019                 2.065595e-02 3 1  ON 18
ci_0020                 1.929436e-02 3 1  ON 19
ci_0021                 1.841879e-02 3 1  ON 20
ci_0022                 1.856789e-02 3 1  ON 21
ci_0023                -2.020463e-02 3 1  ON 22
ci_0024                -1.837136e-02 3 1  ON 23
ci_0025                -1.866888e-02 3 1  ON 24
ci_0026                -1.780661e-02 3 1  ON 25
ci_0027                -1.781967e-02 3 1  ON 26
ci_0028                -1.749458e-02 3 1  ON 27
ci_0029                -1.474938e-02 3 1  ON 28
ci_0030                -1.640028e-02 3 1  ON 29
ci_0031                 1.529362e-02 3 1  ON 30
ci_0032                 1.456493e-02 3 1  ON 31
ci_0033                 1.664440e-02 3 1  ON 32
ci_0034                 1.579164e-02 3 1  ON 33
ci_0035                 1.690694e-02 3 1  ON 34
ci_0036                 1.724678e-02 3 1  ON 35
ci_0037                -1.552055e-02 3 1  ON 36
ci_0038                -1.394779e-02 3 1  ON 37
ci_0039                -1.574808e-02 3 1  ON 38
ci_0040                -1.520884e-02 3 1  ON 39
ci_0041                 1.632438e-02 3 1  ON 40
ci_0042                 1.554774e-02 3 1  ON 41
ci_0043                -1.465250e-02 3 1  ON 42
ci_0044                -1.603245e-02 3 1  ON 43
ci_0045                 1.512601e-02 3 1  ON 44
ci_0046                 1.586864e-02 3 1  ON 45
ci_0047                -1.469170e-02 3 1  ON 46
ci_0048                -1.411433e-02 3 1  ON 47
ci_0049                -1.249725e-02 3 1  ON 48
ci_0050                -1.256015e-02 3 1  ON 49
ci_0051                -1.312818e-02 3 1  ON 50
ci_0052                -1.236146e-02 3 1  ON 51
ci_0053                -1.344755e-02 3 1  ON 52
ci_0054                -1.219909e-02 3 1  ON 53
ci_0055                 1.359337e-02 3 1  ON 54
ci_0056                 1.347273e-02 3 1  ON 55
ci_0057                 1.390129e-02 3 1  ON 56
ci_0058                 1.286747e-02 3 1  ON 57
ci_0059                -1.368312e-02 3 1  ON 58
ci_0060                -1.217111e-02 3 1  ON 59
ci_0061                -1.296223e-02 3 1  ON 60
ci_0062                -1.245345e-02 3 1  ON 61
ci_0063                -1.176629e-02 3 1  ON 62
ci_0064                -1.103525e-02 3 1  ON 63
ci_0065                -1.126146e-02 3 1  ON 64
ci_0066                -1.124427e-02 3 1  ON 65
ci_0067                -1.172546e-02 3 1  ON 66
ci_0068                -1.039799e-02 3 1  ON 67
ci_0069                 1.143578e-02 3 1  ON 68
ci_0070                 1.001194e-02 3 1  ON 69
ci_0071                 9.893330e-03 3 1  ON 70
ci_0072                 1.032647e-02 3 1  ON 71
ci_0073                 1.134763e-02 3 1  ON 72
ci_0074                 1.068084e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8072
    reference variance = 1.23831
====================================================
  Execution time = 1.2845e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5841e+00
  Total weights = 1.9458e+06
  Execution time = 2.2322e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.612492178665
                                         uncertainty =       0.042373508928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.612492178665
                                         uncertainty =       0.042373508928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001142960589
  error estimate for blocks of size 2^( 2) =       0.001181547687
  error estimate for blocks of size 2^( 3) =       0.001215475268
  error estimate for blocks of size 2^( 4) =       0.001238129501
  error estimate for blocks of size 2^( 5) =       0.001254811134
  error estimate for blocks of size 2^( 6) =       0.001265487545
  error estimate for blocks of size 2^( 7) =       0.001281775950

      target function =                  N/A
              le_mean =     -16.718400532011
             les_mean =     282.089056583162
             stat err =       0.001260051032
             autocorr =       1.215384679723
              std dev =       1.616416228923
             le_variance =       2.612801425127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.612493064785
                                         uncertainty =       0.042373606122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.612493064785
                                         uncertainty =       0.042373606122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001142960782
  error estimate for blocks of size 2^( 2) =       0.001181547914
  error estimate for blocks of size 2^( 3) =       0.001215475489
  error estimate for blocks of size 2^( 4) =       0.001238129796
  error estimate for blocks of size 2^( 5) =       0.001254811431
  error estimate for blocks of size 2^( 6) =       0.001265487939
  error estimate for blocks of size 2^( 7) =       0.001281776182

      target function =                  N/A
              le_mean =     -16.718400534037
             les_mean =     282.089056298871
             stat err =       0.001260051337
             autocorr =       1.215384857496
              std dev =       1.616416501260
             le_variance =       2.612802305547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.612492622027
                                         uncertainty =       0.042373557634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.612492622027
                                         uncertainty =       0.042373557634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001142960686
  error estimate for blocks of size 2^( 2) =       0.001181547800
  error estimate for blocks of size 2^( 3) =       0.001215475378
  error estimate for blocks of size 2^( 4) =       0.001238129648
  error estimate for blocks of size 2^( 5) =       0.001254811283
  error estimate for blocks of size 2^( 6) =       0.001265487743
  error estimate for blocks of size 2^( 7) =       0.001281776066

      target function =                  N/A
              le_mean =     -16.718400532922
             les_mean =     282.089056383899
             stat err =       0.001260051185
             autocorr =       1.215384768799
              std dev =       1.616416365183
             le_variance =       2.612801865632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.612492234008
                                         uncertainty =       0.042373515018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.612492234008
                                         uncertainty =       0.042373515018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001142960601
  error estimate for blocks of size 2^( 2) =       0.001181547701
  error estimate for blocks of size 2^( 3) =       0.001215475282
  error estimate for blocks of size 2^( 4) =       0.001238129519
  error estimate for blocks of size 2^( 5) =       0.001254811152
  error estimate for blocks of size 2^( 6) =       0.001265487570
  error estimate for blocks of size 2^( 7) =       0.001281775964

      target function =                  N/A
              le_mean =     -16.718400532112
             les_mean =     282.089056551628
             stat err =       0.001260051051
             autocorr =       1.215384690869
              std dev =       1.616416245932
             le_variance =       2.612801480113


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718400532011        initial
     9.7656e+01     9.7656e+02             4.4457e-06       -16.718400534037  <--
     3.9062e+02     3.9062e+03             1.1137e-06       -16.718400532922
     1.5625e+03     1.5625e+04             2.7857e-07       -16.718400532112

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 2.4070e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.067012e-01 3 1  ON 0
ci_0002                 6.799205e-01 3 1  ON 1
ci_0003                -4.811750e-02 3 1  ON 2
ci_0004                -4.644827e-02 3 1  ON 3
ci_0005                -4.623517e-02 3 1  ON 4
ci_0006                -4.353916e-02 3 1  ON 5
ci_0007                -3.118239e-02 3 1  ON 6
ci_0008                -3.131651e-02 3 1  ON 7
ci_0009                -3.232982e-02 3 1  ON 8
ci_0010                -3.057566e-02 3 1  ON 9
ci_0011                -2.687137e-02 3 1  ON 10
ci_0012                -2.561224e-02 3 1  ON 11
ci_0013                 2.738365e-02 3 1  ON 12
ci_0014                 2.711334e-02 3 1  ON 13
ci_0015                 2.759043e-02 3 1  ON 14
ci_0016                 2.635851e-02 3 1  ON 15
ci_0017                 2.493126e-02 3 1  ON 16
ci_0018                 2.323700e-02 3 1  ON 17
ci_0019                 2.065496e-02 3 1  ON 18
ci_0020                 1.929496e-02 3 1  ON 19
ci_0021                 1.841999e-02 3 1  ON 20
ci_0022                 1.856729e-02 3 1  ON 21
ci_0023                -2.020130e-02 3 1  ON 22
ci_0024                -1.836979e-02 3 1  ON 23
ci_0025                -1.866885e-02 3 1  ON 24
ci_0026                -1.780592e-02 3 1  ON 25
ci_0027                -1.781908e-02 3 1  ON 26
ci_0028                -1.749322e-02 3 1  ON 27
ci_0029                -1.475173e-02 3 1  ON 28
ci_0030                -1.639937e-02 3 1  ON 29
ci_0031                 1.529255e-02 3 1  ON 30
ci_0032                 1.456349e-02 3 1  ON 31
ci_0033                 1.664474e-02 3 1  ON 32
ci_0034                 1.579158e-02 3 1  ON 33
ci_0035                 1.690919e-02 3 1  ON 34
ci_0036                 1.724565e-02 3 1  ON 35
ci_0037                -1.552025e-02 3 1  ON 36
ci_0038                -1.394864e-02 3 1  ON 37
ci_0039                -1.574807e-02 3 1  ON 38
ci_0040                -1.520798e-02 3 1  ON 39
ci_0041                 1.632454e-02 3 1  ON 40
ci_0042                 1.554832e-02 3 1  ON 41
ci_0043                -1.465282e-02 3 1  ON 42
ci_0044                -1.603118e-02 3 1  ON 43
ci_0045                 1.512642e-02 3 1  ON 44
ci_0046                 1.586870e-02 3 1  ON 45
ci_0047                -1.469256e-02 3 1  ON 46
ci_0048                -1.411501e-02 3 1  ON 47
ci_0049                -1.249970e-02 3 1  ON 48
ci_0050                -1.256054e-02 3 1  ON 49
ci_0051                -1.312833e-02 3 1  ON 50
ci_0052                -1.236363e-02 3 1  ON 51
ci_0053                -1.344628e-02 3 1  ON 52
ci_0054                -1.220047e-02 3 1  ON 53
ci_0055                 1.359140e-02 3 1  ON 54
ci_0056                 1.347239e-02 3 1  ON 55
ci_0057                 1.389859e-02 3 1  ON 56
ci_0058                 1.286904e-02 3 1  ON 57
ci_0059                -1.368235e-02 3 1  ON 58
ci_0060                -1.217040e-02 3 1  ON 59
ci_0061                -1.296214e-02 3 1  ON 60
ci_0062                -1.245573e-02 3 1  ON 61
ci_0063                -1.176639e-02 3 1  ON 62
ci_0064                -1.103615e-02 3 1  ON 63
ci_0065                -1.126329e-02 3 1  ON 64
ci_0066                -1.124297e-02 3 1  ON 65
ci_0067                -1.172342e-02 3 1  ON 66
ci_0068                -1.039871e-02 3 1  ON 67
ci_0069                 1.143333e-02 3 1  ON 68
ci_0070                 1.001343e-02 3 1  ON 69
ci_0071                 9.895285e-03 3 1  ON 70
ci_0072                 1.032566e-02 3 1  ON 71
ci_0073                 1.134556e-02 3 1  ON 72
ci_0074                 1.068072e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0348e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8047
    reference variance = 1.19568
====================================================
  Execution time = 1.3128e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0268e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5255e+00
  Total weights = 1.945674935e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2070e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554739808789
                                         uncertainty =       0.021605681459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554739808789
                                         uncertainty =       0.021605681459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130031698
  error estimate for blocks of size 2^( 2) =       0.001168953860
  error estimate for blocks of size 2^( 3) =       0.001203125923
  error estimate for blocks of size 2^( 4) =       0.001225819667
  error estimate for blocks of size 2^( 5) =       0.001241235857
  error estimate for blocks of size 2^( 6) =       0.001250140710
  error estimate for blocks of size 2^( 7) =       0.001259790189

      target function =                  N/A
              le_mean =     -16.717236455346
             les_mean =     281.991539249808
             stat err =       0.001244246606
             autocorr =       1.212360218216
              std dev =       1.598131723414
             le_variance =       2.554025005382


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671723645535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717236454442       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717237414238       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717237410121       residual = 1.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+01 is 2.430820e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717236454442       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717236696059       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717236694952       residual = 1.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+01 is 6.124336e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717236454442       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717236514952       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717236514670       residual = 1.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+02 is 1.534071e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.314824 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6341e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.067024e-01 3 1  ON 0
ci_0002                 6.799193e-01 3 1  ON 1
ci_0003                -4.811781e-02 3 1  ON 2
ci_0004                -4.644612e-02 3 1  ON 3
ci_0005                -4.623421e-02 3 1  ON 4
ci_0006                -4.354054e-02 3 1  ON 5
ci_0007                -3.118294e-02 3 1  ON 6
ci_0008                -3.131326e-02 3 1  ON 7
ci_0009                -3.233102e-02 3 1  ON 8
ci_0010                -3.058179e-02 3 1  ON 9
ci_0011                -2.687333e-02 3 1  ON 10
ci_0012                -2.561173e-02 3 1  ON 11
ci_0013                 2.738301e-02 3 1  ON 12
ci_0014                 2.711229e-02 3 1  ON 13
ci_0015                 2.759023e-02 3 1  ON 14
ci_0016                 2.636064e-02 3 1  ON 15
ci_0017                 2.492927e-02 3 1  ON 16
ci_0018                 2.324017e-02 3 1  ON 17
ci_0019                 2.065649e-02 3 1  ON 18
ci_0020                 1.929626e-02 3 1  ON 19
ci_0021                 1.842214e-02 3 1  ON 20
ci_0022                 1.856537e-02 3 1  ON 21
ci_0023                -2.019784e-02 3 1  ON 22
ci_0024                -1.836826e-02 3 1  ON 23
ci_0025                -1.866706e-02 3 1  ON 24
ci_0026                -1.780709e-02 3 1  ON 25
ci_0027                -1.781866e-02 3 1  ON 26
ci_0028                -1.748992e-02 3 1  ON 27
ci_0029                -1.475491e-02 3 1  ON 28
ci_0030                -1.639727e-02 3 1  ON 29
ci_0031                 1.529120e-02 3 1  ON 30
ci_0032                 1.456150e-02 3 1  ON 31
ci_0033                 1.664328e-02 3 1  ON 32
ci_0034                 1.579024e-02 3 1  ON 33
ci_0035                 1.691285e-02 3 1  ON 34
ci_0036                 1.724665e-02 3 1  ON 35
ci_0037                -1.552188e-02 3 1  ON 36
ci_0038                -1.394946e-02 3 1  ON 37
ci_0039                -1.574799e-02 3 1  ON 38
ci_0040                -1.520826e-02 3 1  ON 39
ci_0041                 1.632505e-02 3 1  ON 40
ci_0042                 1.554768e-02 3 1  ON 41
ci_0043                -1.465180e-02 3 1  ON 42
ci_0044                -1.603171e-02 3 1  ON 43
ci_0045                 1.512638e-02 3 1  ON 44
ci_0046                 1.586752e-02 3 1  ON 45
ci_0047                -1.469181e-02 3 1  ON 46
ci_0048                -1.411551e-02 3 1  ON 47
ci_0049                -1.249909e-02 3 1  ON 48
ci_0050                -1.256074e-02 3 1  ON 49
ci_0051                -1.312711e-02 3 1  ON 50
ci_0052                -1.236537e-02 3 1  ON 51
ci_0053                -1.344788e-02 3 1  ON 52
ci_0054                -1.220072e-02 3 1  ON 53
ci_0055                 1.358900e-02 3 1  ON 54
ci_0056                 1.347317e-02 3 1  ON 55
ci_0057                 1.389555e-02 3 1  ON 56
ci_0058                 1.286653e-02 3 1  ON 57
ci_0059                -1.368106e-02 3 1  ON 58
ci_0060                -1.217315e-02 3 1  ON 59
ci_0061                -1.296126e-02 3 1  ON 60
ci_0062                -1.245858e-02 3 1  ON 61
ci_0063                -1.176669e-02 3 1  ON 62
ci_0064                -1.103794e-02 3 1  ON 63
ci_0065                -1.126657e-02 3 1  ON 64
ci_0066                -1.124234e-02 3 1  ON 65
ci_0067                -1.172094e-02 3 1  ON 66
ci_0068                -1.039877e-02 3 1  ON 67
ci_0069                 1.143025e-02 3 1  ON 68
ci_0070                 1.001360e-02 3 1  ON 69
ci_0071                 9.898404e-03 3 1  ON 70
ci_0072                 1.032423e-02 3 1  ON 71
ci_0073                 1.134548e-02 3 1  ON 72
ci_0074                 1.067816e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.5856
    reference variance = 2.30585
====================================================
  Execution time = 1.5305e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5385e+00
  Total weights = 1.9456e+06
  Execution time = 2.2344e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568844485783
                                         uncertainty =       0.047136905892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568844485783
                                         uncertainty =       0.047136905892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133083213
  error estimate for blocks of size 2^( 2) =       0.001171857644
  error estimate for blocks of size 2^( 3) =       0.001205362461
  error estimate for blocks of size 2^( 4) =       0.001226649865
  error estimate for blocks of size 2^( 5) =       0.001239483357
  error estimate for blocks of size 2^( 6) =       0.001247841838
  error estimate for blocks of size 2^( 7) =       0.001254372877

      target function =                  N/A
              le_mean =     -16.717902736350
             les_mean =     282.026809047960
             stat err =       0.001242086984
             autocorr =       1.201656696363
              std dev =       1.602447285823
             le_variance =       2.567837303842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568836775025
                                         uncertainty =       0.047136802749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568836775025
                                         uncertainty =       0.047136802749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133081485
  error estimate for blocks of size 2^( 2) =       0.001171855496
  error estimate for blocks of size 2^( 3) =       0.001205359918
  error estimate for blocks of size 2^( 4) =       0.001226647233
  error estimate for blocks of size 2^( 5) =       0.001239480476
  error estimate for blocks of size 2^( 6) =       0.001247839317
  error estimate for blocks of size 2^( 7) =       0.001254369947

      target function =                  N/A
              le_mean =     -16.717903117030
             les_mean =     282.026809731503
             stat err =       0.001242084243
             autocorr =       1.201655057740
              std dev =       1.602444842294
             le_variance =       2.567829472594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568840570059
                                         uncertainty =       0.047136853666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568840570059
                                         uncertainty =       0.047136853666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133082336
  error estimate for blocks of size 2^( 2) =       0.001171856555
  error estimate for blocks of size 2^( 3) =       0.001205361173
  error estimate for blocks of size 2^( 4) =       0.001226648532
  error estimate for blocks of size 2^( 5) =       0.001239481898
  error estimate for blocks of size 2^( 6) =       0.001247840559
  error estimate for blocks of size 2^( 7) =       0.001254371393

      target function =                  N/A
              le_mean =     -16.717902925596
             les_mean =     282.026808372137
             stat err =       0.001242085596
             autocorr =       1.201655869963
              std dev =       1.602446045066
             le_variance =       2.567833327349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568843993055
                                         uncertainty =       0.047136899337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568843993055
                                         uncertainty =       0.047136899337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133083103
  error estimate for blocks of size 2^( 2) =       0.001171857507
  error estimate for blocks of size 2^( 3) =       0.001205362299
  error estimate for blocks of size 2^( 4) =       0.001226649698
  error estimate for blocks of size 2^( 5) =       0.001239483174
  error estimate for blocks of size 2^( 6) =       0.001247841677
  error estimate for blocks of size 2^( 7) =       0.001254372691

      target function =                  N/A
              le_mean =     -16.717902759767
             les_mean =     282.026808867062
             stat err =       0.001242086810
             autocorr =       1.201656593044
              std dev =       1.602447129704
             le_variance =       2.567836803498


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717902736350        initial
     2.4414e+01     2.4414e+02             2.4308e-05       -16.717903117030  <--
     9.7656e+01     9.7656e+02             6.1243e-06       -16.717902925596
     3.9062e+02     3.9062e+03             1.5341e-06       -16.717902759767

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 2.6538e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.067059e-01 3 1  ON 0
ci_0002                 6.799158e-01 3 1  ON 1
ci_0003                -4.811871e-02 3 1  ON 2
ci_0004                -4.643969e-02 3 1  ON 3
ci_0005                -4.623134e-02 3 1  ON 4
ci_0006                -4.354466e-02 3 1  ON 5
ci_0007                -3.118456e-02 3 1  ON 6
ci_0008                -3.130354e-02 3 1  ON 7
ci_0009                -3.233457e-02 3 1  ON 8
ci_0010                -3.059997e-02 3 1  ON 9
ci_0011                -2.687913e-02 3 1  ON 10
ci_0012                -2.561022e-02 3 1  ON 11
ci_0013                 2.738113e-02 3 1  ON 12
ci_0014                 2.710920e-02 3 1  ON 13
ci_0015                 2.758964e-02 3 1  ON 14
ci_0016                 2.636698e-02 3 1  ON 15
ci_0017                 2.492337e-02 3 1  ON 16
ci_0018                 2.324959e-02 3 1  ON 17
ci_0019                 2.066105e-02 3 1  ON 18
ci_0020                 1.930015e-02 3 1  ON 19
ci_0021                 1.842858e-02 3 1  ON 20
ci_0022                 1.855964e-02 3 1  ON 21
ci_0023                -2.018758e-02 3 1  ON 22
ci_0024                -1.836372e-02 3 1  ON 23
ci_0025                -1.866176e-02 3 1  ON 24
ci_0026                -1.781056e-02 3 1  ON 25
ci_0027                -1.781739e-02 3 1  ON 26
ci_0028                -1.748009e-02 3 1  ON 27
ci_0029                -1.476436e-02 3 1  ON 28
ci_0030                -1.639102e-02 3 1  ON 29
ci_0031                 1.528719e-02 3 1  ON 30
ci_0032                 1.455556e-02 3 1  ON 31
ci_0033                 1.663891e-02 3 1  ON 32
ci_0034                 1.578623e-02 3 1  ON 33
ci_0035                 1.692374e-02 3 1  ON 34
ci_0036                 1.724963e-02 3 1  ON 35
ci_0037                -1.552672e-02 3 1  ON 36
ci_0038                -1.395189e-02 3 1  ON 37
ci_0039                -1.574776e-02 3 1  ON 38
ci_0040                -1.520907e-02 3 1  ON 39
ci_0041                 1.632657e-02 3 1  ON 40
ci_0042                 1.554577e-02 3 1  ON 41
ci_0043                -1.464878e-02 3 1  ON 42
ci_0044                -1.603329e-02 3 1  ON 43
ci_0045                 1.512627e-02 3 1  ON 44
ci_0046                 1.586400e-02 3 1  ON 45
ci_0047                -1.468957e-02 3 1  ON 46
ci_0048                -1.411699e-02 3 1  ON 47
ci_0049                -1.249730e-02 3 1  ON 48
ci_0050                -1.256132e-02 3 1  ON 49
ci_0051                -1.312351e-02 3 1  ON 50
ci_0052                -1.237054e-02 3 1  ON 51
ci_0053                -1.345264e-02 3 1  ON 52
ci_0054                -1.220149e-02 3 1  ON 53
ci_0055                 1.358186e-02 3 1  ON 54
ci_0056                 1.347548e-02 3 1  ON 55
ci_0057                 1.388650e-02 3 1  ON 56
ci_0058                 1.285903e-02 3 1  ON 57
ci_0059                -1.367724e-02 3 1  ON 58
ci_0060                -1.218131e-02 3 1  ON 59
ci_0061                -1.295864e-02 3 1  ON 60
ci_0062                -1.246705e-02 3 1  ON 61
ci_0063                -1.176760e-02 3 1  ON 62
ci_0064                -1.104323e-02 3 1  ON 63
ci_0065                -1.127630e-02 3 1  ON 64
ci_0066                -1.124049e-02 3 1  ON 65
ci_0067                -1.171362e-02 3 1  ON 66
ci_0068                -1.039894e-02 3 1  ON 67
ci_0069                 1.142115e-02 3 1  ON 68
ci_0070                 1.001411e-02 3 1  ON 69
ci_0071                 9.907669e-03 3 1  ON 70
ci_0072                 1.031999e-02 3 1  ON 71
ci_0073                 1.134524e-02 3 1  ON 72
ci_0074                 1.067058e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2888e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.5531
    reference variance = 7.6981
====================================================
  Execution time = 1.3111e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0277e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5197e+00
  Total weights = 1.945373311e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1913e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.548136800886
                                         uncertainty =       0.027942706893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.548136800886
                                         uncertainty =       0.027942706893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128705109
  error estimate for blocks of size 2^( 2) =       0.001167598986
  error estimate for blocks of size 2^( 3) =       0.001201228760
  error estimate for blocks of size 2^( 4) =       0.001223728518
  error estimate for blocks of size 2^( 5) =       0.001236388231
  error estimate for blocks of size 2^( 6) =       0.001245012076
  error estimate for blocks of size 2^( 7) =       0.001247138108

      target function =                  N/A
              le_mean =     -16.717111562031
             les_mean =     281.981550800363
             stat err =       0.001238066733
             autocorr =       1.203170366392
              std dev =       1.596255612644
             le_variance =       2.548031980897


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671711156203e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717111561113       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717115948023       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717115920342       residual = 4.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+00 is 8.118668e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717111561113       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717112690871       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717112684551       residual = 3.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+01 is 2.118687e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717111561113       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717111845695       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717111844165       residual = 2.96e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+01 is 5.355401e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.317747 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6313e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.067151e-01 3 1  ON 0
ci_0002                 6.799095e-01 3 1  ON 1
ci_0003                -4.811465e-02 3 1  ON 2
ci_0004                -4.643761e-02 3 1  ON 3
ci_0005                -4.621985e-02 3 1  ON 4
ci_0006                -4.354182e-02 3 1  ON 5
ci_0007                -3.118516e-02 3 1  ON 6
ci_0008                -3.130356e-02 3 1  ON 7
ci_0009                -3.233127e-02 3 1  ON 8
ci_0010                -3.060343e-02 3 1  ON 9
ci_0011                -2.687499e-02 3 1  ON 10
ci_0012                -2.561467e-02 3 1  ON 11
ci_0013                 2.737775e-02 3 1  ON 12
ci_0014                 2.710949e-02 3 1  ON 13
ci_0015                 2.758504e-02 3 1  ON 14
ci_0016                 2.636961e-02 3 1  ON 15
ci_0017                 2.492354e-02 3 1  ON 16
ci_0018                 2.324922e-02 3 1  ON 17
ci_0019                 2.065982e-02 3 1  ON 18
ci_0020                 1.929064e-02 3 1  ON 19
ci_0021                 1.843053e-02 3 1  ON 20
ci_0022                 1.856078e-02 3 1  ON 21
ci_0023                -2.016874e-02 3 1  ON 22
ci_0024                -1.836155e-02 3 1  ON 23
ci_0025                -1.866703e-02 3 1  ON 24
ci_0026                -1.780189e-02 3 1  ON 25
ci_0027                -1.781194e-02 3 1  ON 26
ci_0028                -1.747461e-02 3 1  ON 27
ci_0029                -1.476358e-02 3 1  ON 28
ci_0030                -1.639142e-02 3 1  ON 29
ci_0031                 1.529047e-02 3 1  ON 30
ci_0032                 1.455282e-02 3 1  ON 31
ci_0033                 1.664139e-02 3 1  ON 32
ci_0034                 1.579447e-02 3 1  ON 33
ci_0035                 1.694221e-02 3 1  ON 34
ci_0036                 1.724797e-02 3 1  ON 35
ci_0037                -1.551270e-02 3 1  ON 36
ci_0038                -1.395953e-02 3 1  ON 37
ci_0039                -1.574934e-02 3 1  ON 38
ci_0040                -1.520273e-02 3 1  ON 39
ci_0041                 1.632860e-02 3 1  ON 40
ci_0042                 1.554583e-02 3 1  ON 41
ci_0043                -1.465175e-02 3 1  ON 42
ci_0044                -1.602792e-02 3 1  ON 43
ci_0045                 1.512180e-02 3 1  ON 44
ci_0046                 1.585704e-02 3 1  ON 45
ci_0047                -1.468776e-02 3 1  ON 46
ci_0048                -1.411399e-02 3 1  ON 47
ci_0049                -1.251094e-02 3 1  ON 48
ci_0050                -1.256401e-02 3 1  ON 49
ci_0051                -1.312732e-02 3 1  ON 50
ci_0052                -1.237898e-02 3 1  ON 51
ci_0053                -1.345543e-02 3 1  ON 52
ci_0054                -1.220425e-02 3 1  ON 53
ci_0055                 1.357459e-02 3 1  ON 54
ci_0056                 1.347318e-02 3 1  ON 55
ci_0057                 1.387289e-02 3 1  ON 56
ci_0058                 1.285130e-02 3 1  ON 57
ci_0059                -1.367888e-02 3 1  ON 58
ci_0060                -1.218757e-02 3 1  ON 59
ci_0061                -1.296461e-02 3 1  ON 60
ci_0062                -1.246937e-02 3 1  ON 61
ci_0063                -1.176884e-02 3 1  ON 62
ci_0064                -1.104876e-02 3 1  ON 63
ci_0065                -1.127884e-02 3 1  ON 64
ci_0066                -1.124047e-02 3 1  ON 65
ci_0067                -1.170271e-02 3 1  ON 66
ci_0068                -1.040725e-02 3 1  ON 67
ci_0069                 1.140857e-02 3 1  ON 68
ci_0070                 1.000954e-02 3 1  ON 69
ci_0071                 9.899994e-03 3 1  ON 70
ci_0072                 1.030737e-02 3 1  ON 71
ci_0073                 1.132405e-02 3 1  ON 72
ci_0074                 1.067089e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8821
    reference variance = 1.53771
====================================================
  Execution time = 1.2898e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5121e+00
  Total weights = 1.9454e+06
  Execution time = 2.2302e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.534529311071
                                         uncertainty =       0.021751544870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.534529311071
                                         uncertainty =       0.021751544870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125511704
  error estimate for blocks of size 2^( 2) =       0.001163137311
  error estimate for blocks of size 2^( 3) =       0.001197658384
  error estimate for blocks of size 2^( 4) =       0.001220602492
  error estimate for blocks of size 2^( 5) =       0.001231983522
  error estimate for blocks of size 2^( 6) =       0.001238998697
  error estimate for blocks of size 2^( 7) =       0.001247683354

      target function =                  N/A
              le_mean =     -16.716747831524
             les_mean =     281.961829372620
             stat err =       0.001234817016
             autocorr =       1.203663747412
              std dev =       1.591739383092
             le_variance =       2.533634263685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.534520587699
                                         uncertainty =       0.021754368072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.534520587699
                                         uncertainty =       0.021754368072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125509742
  error estimate for blocks of size 2^( 2) =       0.001163137458
  error estimate for blocks of size 2^( 3) =       0.001197660736
  error estimate for blocks of size 2^( 4) =       0.001220604367
  error estimate for blocks of size 2^( 5) =       0.001231986117
  error estimate for blocks of size 2^( 6) =       0.001239001271
  error estimate for blocks of size 2^( 7) =       0.001247685279

      target function =                  N/A
              le_mean =     -16.716748284345
             les_mean =     281.961714488383
             stat err =       0.001234819258
             autocorr =       1.203672314504
              std dev =       1.591736608687
             le_variance =       2.533625431433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.534524329896
                                         uncertainty =       0.021753003616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.534524329896
                                         uncertainty =       0.021753003616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125510585
  error estimate for blocks of size 2^( 2) =       0.001163137292
  error estimate for blocks of size 2^( 3) =       0.001197659512
  error estimate for blocks of size 2^( 4) =       0.001220603355
  error estimate for blocks of size 2^( 5) =       0.001231984773
  error estimate for blocks of size 2^( 6) =       0.001238999912
  error estimate for blocks of size 2^( 7) =       0.001247684244

      target function =                  N/A
              le_mean =     -16.716748044834
             les_mean =     281.961712554589
             stat err =       0.001234818071
             autocorr =       1.203668196159
              std dev =       1.591737801229
             le_variance =       2.533629227862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.534528632888
                                         uncertainty =       0.021751729125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.534528632888
                                         uncertainty =       0.021751729125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125511551
  error estimate for blocks of size 2^( 2) =       0.001163137298
  error estimate for blocks of size 2^( 3) =       0.001197658515
  error estimate for blocks of size 2^( 4) =       0.001220602591
  error estimate for blocks of size 2^( 5) =       0.001231983669
  error estimate for blocks of size 2^( 6) =       0.001238998841
  error estimate for blocks of size 2^( 7) =       0.001247683458

      target function =                  N/A
              le_mean =     -16.716747854866
             les_mean =     281.961810829196
             stat err =       0.001234817140
             autocorr =       1.203664313498
              std dev =       1.591739167920
             le_variance =       2.533633578692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716747831524        initial
     6.1035e+00     6.1035e+01             8.1187e-05       -16.716748284345  <--
     2.4414e+01     2.4414e+02             2.1187e-05       -16.716748044834
     9.7656e+01     9.7656e+02             5.3554e-06       -16.716747854866

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 2.4116e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.067424e-01 3 1  ON 0
ci_0002                 6.798904e-01 3 1  ON 1
ci_0003                -4.810296e-02 3 1  ON 2
ci_0004                -4.643150e-02 3 1  ON 3
ci_0005                -4.618613e-02 3 1  ON 4
ci_0006                -4.353344e-02 3 1  ON 5
ci_0007                -3.118697e-02 3 1  ON 6
ci_0008                -3.130355e-02 3 1  ON 7
ci_0009                -3.232194e-02 3 1  ON 8
ci_0010                -3.061336e-02 3 1  ON 9
ci_0011                -2.686313e-02 3 1  ON 10
ci_0012                -2.562766e-02 3 1  ON 11
ci_0013                 2.736813e-02 3 1  ON 12
ci_0014                 2.711035e-02 3 1  ON 13
ci_0015                 2.757182e-02 3 1  ON 14
ci_0016                 2.637732e-02 3 1  ON 15
ci_0017                 2.492429e-02 3 1  ON 16
ci_0018                 2.324815e-02 3 1  ON 17
ci_0019                 2.065649e-02 3 1  ON 18
ci_0020                 1.926308e-02 3 1  ON 19
ci_0021                 1.843626e-02 3 1  ON 20
ci_0022                 1.856412e-02 3 1  ON 21
ci_0023                -2.011470e-02 3 1  ON 22
ci_0024                -1.835526e-02 3 1  ON 23
ci_0025                -1.868240e-02 3 1  ON 24
ci_0026                -1.777690e-02 3 1  ON 25
ci_0027                -1.779637e-02 3 1  ON 26
ci_0028                -1.745874e-02 3 1  ON 27
ci_0029                -1.476153e-02 3 1  ON 28
ci_0030                -1.639252e-02 3 1  ON 29
ci_0031                 1.530011e-02 3 1  ON 30
ci_0032                 1.454468e-02 3 1  ON 31
ci_0033                 1.664865e-02 3 1  ON 32
ci_0034                 1.581859e-02 3 1  ON 33
ci_0035                 1.699578e-02 3 1  ON 34
ci_0036                 1.724315e-02 3 1  ON 35
ci_0037                -1.547180e-02 3 1  ON 36
ci_0038                -1.398184e-02 3 1  ON 37
ci_0039                -1.575387e-02 3 1  ON 38
ci_0040                -1.518478e-02 3 1  ON 39
ci_0041                 1.633446e-02 3 1  ON 40
ci_0042                 1.554601e-02 3 1  ON 41
ci_0043                -1.466065e-02 3 1  ON 42
ci_0044                -1.601211e-02 3 1  ON 43
ci_0045                 1.510873e-02 3 1  ON 44
ci_0046                 1.583668e-02 3 1  ON 45
ci_0047                -1.468264e-02 3 1  ON 46
ci_0048                -1.410544e-02 3 1  ON 47
ci_0049                -1.255034e-02 3 1  ON 48
ci_0050                -1.257179e-02 3 1  ON 49
ci_0051                -1.313825e-02 3 1  ON 50
ci_0052                -1.240307e-02 3 1  ON 51
ci_0053                -1.346347e-02 3 1  ON 52
ci_0054                -1.221207e-02 3 1  ON 53
ci_0055                 1.355337e-02 3 1  ON 54
ci_0056                 1.346643e-02 3 1  ON 55
ci_0057                 1.383331e-02 3 1  ON 56
ci_0058                 1.282880e-02 3 1  ON 57
ci_0059                -1.368361e-02 3 1  ON 58
ci_0060                -1.220546e-02 3 1  ON 59
ci_0061                -1.298199e-02 3 1  ON 60
ci_0062                -1.247611e-02 3 1  ON 61
ci_0063                -1.177256e-02 3 1  ON 62
ci_0064                -1.106458e-02 3 1  ON 63
ci_0065                -1.128613e-02 3 1  ON 64
ci_0066                -1.124034e-02 3 1  ON 65
ci_0067                -1.167187e-02 3 1  ON 66
ci_0068                -1.043079e-02 3 1  ON 67
ci_0069                 1.137294e-02 3 1  ON 68
ci_0070                 9.996504e-03 3 1  ON 69
ci_0071                 9.877669e-03 3 1  ON 70
ci_0072                 1.027090e-02 3 1  ON 71
ci_0073                 1.126405e-02 3 1  ON 72
ci_0074                 1.067176e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0442e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8923
    reference variance = 1.27847
====================================================
  Execution time = 1.3218e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0279e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5188e+00
  Total weights = 1.945762654e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1839e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545358195290
                                         uncertainty =       0.024658385988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545358195290
                                         uncertainty =       0.024658385988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128048289
  error estimate for blocks of size 2^( 2) =       0.001166564427
  error estimate for blocks of size 2^( 3) =       0.001199833038
  error estimate for blocks of size 2^( 4) =       0.001222486022
  error estimate for blocks of size 2^( 5) =       0.001232306541
  error estimate for blocks of size 2^( 6) =       0.001243033693
  error estimate for blocks of size 2^( 7) =       0.001252295959

      target function =                  N/A
              le_mean =     -16.717072303717
             les_mean =     281.979321231004
             stat err =       0.001237530554
             autocorr =       1.203528773741
              std dev =       1.595326714204
             le_variance =       2.545067325054


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671707230372e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717072302798       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717087490286       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717087388431       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+00 is 2.992176e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717072302798       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717076572157       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717076546992       residual = 1.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+00 is 8.727069e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717072302798       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717073404409       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717073398624       residual = 1.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+01 is 2.275793e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.320724 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6412e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.067300e-01 3 1  ON 0
ci_0002                 6.798945e-01 3 1  ON 1
ci_0003                -4.808307e-02 3 1  ON 2
ci_0004                -4.640269e-02 3 1  ON 3
ci_0005                -4.617275e-02 3 1  ON 4
ci_0006                -4.354915e-02 3 1  ON 5
ci_0007                -3.118012e-02 3 1  ON 6
ci_0008                -3.130470e-02 3 1  ON 7
ci_0009                -3.235660e-02 3 1  ON 8
ci_0010                -3.068091e-02 3 1  ON 9
ci_0011                -2.689712e-02 3 1  ON 10
ci_0012                -2.565940e-02 3 1  ON 11
ci_0013                 2.739363e-02 3 1  ON 12
ci_0014                 2.709404e-02 3 1  ON 13
ci_0015                 2.757566e-02 3 1  ON 14
ci_0016                 2.641266e-02 3 1  ON 15
ci_0017                 2.494337e-02 3 1  ON 16
ci_0018                 2.329525e-02 3 1  ON 17
ci_0019                 2.068742e-02 3 1  ON 18
ci_0020                 1.926735e-02 3 1  ON 19
ci_0021                 1.839931e-02 3 1  ON 20
ci_0022                 1.854451e-02 3 1  ON 21
ci_0023                -2.008664e-02 3 1  ON 22
ci_0024                -1.835084e-02 3 1  ON 23
ci_0025                -1.869782e-02 3 1  ON 24
ci_0026                -1.776851e-02 3 1  ON 25
ci_0027                -1.778914e-02 3 1  ON 26
ci_0028                -1.741127e-02 3 1  ON 27
ci_0029                -1.480524e-02 3 1  ON 28
ci_0030                -1.638876e-02 3 1  ON 29
ci_0031                 1.530405e-02 3 1  ON 30
ci_0032                 1.454693e-02 3 1  ON 31
ci_0033                 1.662062e-02 3 1  ON 32
ci_0034                 1.580706e-02 3 1  ON 33
ci_0035                 1.701688e-02 3 1  ON 34
ci_0036                 1.725195e-02 3 1  ON 35
ci_0037                -1.548985e-02 3 1  ON 36
ci_0038                -1.397600e-02 3 1  ON 37
ci_0039                -1.579170e-02 3 1  ON 38
ci_0040                -1.518402e-02 3 1  ON 39
ci_0041                 1.633070e-02 3 1  ON 40
ci_0042                 1.555843e-02 3 1  ON 41
ci_0043                -1.464192e-02 3 1  ON 42
ci_0044                -1.599488e-02 3 1  ON 43
ci_0045                 1.512645e-02 3 1  ON 44
ci_0046                 1.580078e-02 3 1  ON 45
ci_0047                -1.468918e-02 3 1  ON 46
ci_0048                -1.408736e-02 3 1  ON 47
ci_0049                -1.259887e-02 3 1  ON 48
ci_0050                -1.257662e-02 3 1  ON 49
ci_0051                -1.314108e-02 3 1  ON 50
ci_0052                -1.242279e-02 3 1  ON 51
ci_0053                -1.343525e-02 3 1  ON 52
ci_0054                -1.228743e-02 3 1  ON 53
ci_0055                 1.357384e-02 3 1  ON 54
ci_0056                 1.340708e-02 3 1  ON 55
ci_0057                 1.378999e-02 3 1  ON 56
ci_0058                 1.278158e-02 3 1  ON 57
ci_0059                -1.362747e-02 3 1  ON 58
ci_0060                -1.222784e-02 3 1  ON 59
ci_0061                -1.299685e-02 3 1  ON 60
ci_0062                -1.248970e-02 3 1  ON 61
ci_0063                -1.178889e-02 3 1  ON 62
ci_0064                -1.108881e-02 3 1  ON 63
ci_0065                -1.130500e-02 3 1  ON 64
ci_0066                -1.123669e-02 3 1  ON 65
ci_0067                -1.162933e-02 3 1  ON 66
ci_0068                -1.051806e-02 3 1  ON 67
ci_0069                 1.136882e-02 3 1  ON 68
ci_0070                 1.003358e-02 3 1  ON 69
ci_0071                 9.910922e-03 3 1  ON 70
ci_0072                 1.025836e-02 3 1  ON 71
ci_0073                 1.133210e-02 3 1  ON 72
ci_0074                 1.067205e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.6186
    reference variance = 1.61252
====================================================
  Execution time = 1.2965e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5605e+00
  Total weights = 1.9460e+06
  Execution time = 2.2269e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.588185464640
                                         uncertainty =       0.034460052829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.588185464640
                                         uncertainty =       0.034460052829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137431719
  error estimate for blocks of size 2^( 2) =       0.001175856198
  error estimate for blocks of size 2^( 3) =       0.001208982327
  error estimate for blocks of size 2^( 4) =       0.001232060627
  error estimate for blocks of size 2^( 5) =       0.001247602485
  error estimate for blocks of size 2^( 6) =       0.001253799128
  error estimate for blocks of size 2^( 7) =       0.001261174553

      target function =                  N/A
              le_mean =     -16.718374212964
             les_mean =     282.064521203093
             stat err =       0.001248659198
             autocorr =       1.205139084760
              std dev =       1.608597099955
             le_variance =       2.587584629983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.588269800551
                                         uncertainty =       0.034456037484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.588269800551
                                         uncertainty =       0.034456037484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137450255
  error estimate for blocks of size 2^( 2) =       0.001175860942
  error estimate for blocks of size 2^( 3) =       0.001208976840
  error estimate for blocks of size 2^( 4) =       0.001232049235
  error estimate for blocks of size 2^( 5) =       0.001247582077
  error estimate for blocks of size 2^( 6) =       0.001253783180
  error estimate for blocks of size 2^( 7) =       0.001261152016

      target function =                  N/A
              le_mean =     -16.718372760298
             les_mean =     282.066456388217
             stat err =       0.001248641627
             autocorr =       1.205065889197
              std dev =       1.608623315129
             le_variance =       2.587668969976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.588232301248
                                         uncertainty =       0.034457798079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.588232301248
                                         uncertainty =       0.034457798079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137442011
  error estimate for blocks of size 2^( 2) =       0.001175858273
  error estimate for blocks of size 2^( 3) =       0.001208978382
  error estimate for blocks of size 2^( 4) =       0.001232052867
  error estimate for blocks of size 2^( 5) =       0.001247588623
  error estimate for blocks of size 2^( 6) =       0.001253789802
  error estimate for blocks of size 2^( 7) =       0.001261164035

      target function =                  N/A
              le_mean =     -16.718373169123
             les_mean =     282.065789651776
             stat err =       0.001248648831
             autocorr =       1.205097264541
              std dev =       1.608611655508
             le_variance =       2.587631458235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.588190879034
                                         uncertainty =       0.034459770341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.588190879034
                                         uncertainty =       0.034459770341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137432908
  error estimate for blocks of size 2^( 2) =       0.001175856318
  error estimate for blocks of size 2^( 3) =       0.001208981658
  error estimate for blocks of size 2^( 4) =       0.001232059480
  error estimate for blocks of size 2^( 5) =       0.001247600584
  error estimate for blocks of size 2^( 6) =       0.001253797696
  error estimate for blocks of size 2^( 7) =       0.001261172840

      target function =                  N/A
              le_mean =     -16.718373974259
             les_mean =     282.064490165047
             stat err =       0.001248657650
             autocorr =       1.205133575387
              std dev =       1.608598782418
             le_variance =       2.587590042797


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718374212964        initial  <--
     1.5259e+00     1.5259e+01             2.9922e-04       -16.718372760298
     6.1035e+00     6.1035e+01             8.7271e-05       -16.718373169123
     2.4414e+01     2.4414e+02             2.2758e-05       -16.718373974259

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1896
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.067424e-01 3 1  ON 0
ci_0002                 6.798904e-01 3 1  ON 1
ci_0003                -4.810296e-02 3 1  ON 2
ci_0004                -4.643150e-02 3 1  ON 3
ci_0005                -4.618613e-02 3 1  ON 4
ci_0006                -4.353344e-02 3 1  ON 5
ci_0007                -3.118697e-02 3 1  ON 6
ci_0008                -3.130355e-02 3 1  ON 7
ci_0009                -3.232194e-02 3 1  ON 8
ci_0010                -3.061336e-02 3 1  ON 9
ci_0011                -2.686313e-02 3 1  ON 10
ci_0012                -2.562766e-02 3 1  ON 11
ci_0013                 2.736813e-02 3 1  ON 12
ci_0014                 2.711035e-02 3 1  ON 13
ci_0015                 2.757182e-02 3 1  ON 14
ci_0016                 2.637732e-02 3 1  ON 15
ci_0017                 2.492429e-02 3 1  ON 16
ci_0018                 2.324815e-02 3 1  ON 17
ci_0019                 2.065649e-02 3 1  ON 18
ci_0020                 1.926308e-02 3 1  ON 19
ci_0021                 1.843626e-02 3 1  ON 20
ci_0022                 1.856412e-02 3 1  ON 21
ci_0023                -2.011470e-02 3 1  ON 22
ci_0024                -1.835526e-02 3 1  ON 23
ci_0025                -1.868240e-02 3 1  ON 24
ci_0026                -1.777690e-02 3 1  ON 25
ci_0027                -1.779637e-02 3 1  ON 26
ci_0028                -1.745874e-02 3 1  ON 27
ci_0029                -1.476153e-02 3 1  ON 28
ci_0030                -1.639252e-02 3 1  ON 29
ci_0031                 1.530011e-02 3 1  ON 30
ci_0032                 1.454468e-02 3 1  ON 31
ci_0033                 1.664865e-02 3 1  ON 32
ci_0034                 1.581859e-02 3 1  ON 33
ci_0035                 1.699578e-02 3 1  ON 34
ci_0036                 1.724315e-02 3 1  ON 35
ci_0037                -1.547180e-02 3 1  ON 36
ci_0038                -1.398184e-02 3 1  ON 37
ci_0039                -1.575387e-02 3 1  ON 38
ci_0040                -1.518478e-02 3 1  ON 39
ci_0041                 1.633446e-02 3 1  ON 40
ci_0042                 1.554601e-02 3 1  ON 41
ci_0043                -1.466065e-02 3 1  ON 42
ci_0044                -1.601211e-02 3 1  ON 43
ci_0045                 1.510873e-02 3 1  ON 44
ci_0046                 1.583668e-02 3 1  ON 45
ci_0047                -1.468264e-02 3 1  ON 46
ci_0048                -1.410544e-02 3 1  ON 47
ci_0049                -1.255034e-02 3 1  ON 48
ci_0050                -1.257179e-02 3 1  ON 49
ci_0051                -1.313825e-02 3 1  ON 50
ci_0052                -1.240307e-02 3 1  ON 51
ci_0053                -1.346347e-02 3 1  ON 52
ci_0054                -1.221207e-02 3 1  ON 53
ci_0055                 1.355337e-02 3 1  ON 54
ci_0056                 1.346643e-02 3 1  ON 55
ci_0057                 1.383331e-02 3 1  ON 56
ci_0058                 1.282880e-02 3 1  ON 57
ci_0059                -1.368361e-02 3 1  ON 58
ci_0060                -1.220546e-02 3 1  ON 59
ci_0061                -1.298199e-02 3 1  ON 60
ci_0062                -1.247611e-02 3 1  ON 61
ci_0063                -1.177256e-02 3 1  ON 62
ci_0064                -1.106458e-02 3 1  ON 63
ci_0065                -1.128613e-02 3 1  ON 64
ci_0066                -1.124034e-02 3 1  ON 65
ci_0067                -1.167187e-02 3 1  ON 66
ci_0068                -1.043079e-02 3 1  ON 67
ci_0069                 1.137294e-02 3 1  ON 68
ci_0070                 9.996504e-03 3 1  ON 69
ci_0071                 9.877669e-03 3 1  ON 70
ci_0072                 1.027090e-02 3 1  ON 71
ci_0073                 1.126405e-02 3 1  ON 72
ci_0074                 1.067176e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0612e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6681e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.6568
    reference variance = 7.08952
====================================================
  Execution time = 1.3126e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0246e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5628e+00
  Total weights = 1.945926865e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2800e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.593655385642
                                         uncertainty =       0.066488705337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.593655385642
                                         uncertainty =       0.066488705337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138641113
  error estimate for blocks of size 2^( 2) =       0.001178048011
  error estimate for blocks of size 2^( 3) =       0.001210578934
  error estimate for blocks of size 2^( 4) =       0.001235020517
  error estimate for blocks of size 2^( 5) =       0.001248451321
  error estimate for blocks of size 2^( 6) =       0.001255296624
  error estimate for blocks of size 2^( 7) =       0.001257542567

      target function =                  N/A
              le_mean =     -16.719766077260
             les_mean =     282.113427434175
             stat err =       0.001249077757
             autocorr =       1.203386756064
              std dev =       1.610307469652
             le_variance =       2.593090146818


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671976607726e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719766076311       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719767367396       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719767363464       residual = 8.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+01 is 2.839249e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719766076311       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719766402628       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719766401536       residual = 7.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+01 is 7.167452e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719766076311       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719766158115       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719766157835       residual = 6.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+02 is 1.796253e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.321871 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6412e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.067434e-01 3 1  ON 0
ci_0002                 6.798874e-01 3 1  ON 1
ci_0003                -4.810759e-02 3 1  ON 2
ci_0004                -4.643380e-02 3 1  ON 3
ci_0005                -4.618597e-02 3 1  ON 4
ci_0006                -4.353430e-02 3 1  ON 5
ci_0007                -3.119058e-02 3 1  ON 6
ci_0008                -3.131054e-02 3 1  ON 7
ci_0009                -3.232576e-02 3 1  ON 8
ci_0010                -3.061489e-02 3 1  ON 9
ci_0011                -2.686967e-02 3 1  ON 10
ci_0012                -2.562952e-02 3 1  ON 11
ci_0013                 2.737157e-02 3 1  ON 12
ci_0014                 2.710588e-02 3 1  ON 13
ci_0015                 2.757545e-02 3 1  ON 14
ci_0016                 2.637890e-02 3 1  ON 15
ci_0017                 2.492408e-02 3 1  ON 16
ci_0018                 2.325239e-02 3 1  ON 17
ci_0019                 2.065725e-02 3 1  ON 18
ci_0020                 1.926018e-02 3 1  ON 19
ci_0021                 1.843318e-02 3 1  ON 20
ci_0022                 1.856425e-02 3 1  ON 21
ci_0023                -2.011460e-02 3 1  ON 22
ci_0024                -1.835287e-02 3 1  ON 23
ci_0025                -1.868314e-02 3 1  ON 24
ci_0026                -1.777800e-02 3 1  ON 25
ci_0027                -1.779819e-02 3 1  ON 26
ci_0028                -1.745786e-02 3 1  ON 27
ci_0029                -1.476815e-02 3 1  ON 28
ci_0030                -1.638909e-02 3 1  ON 29
ci_0031                 1.530038e-02 3 1  ON 30
ci_0032                 1.454515e-02 3 1  ON 31
ci_0033                 1.665471e-02 3 1  ON 32
ci_0034                 1.581779e-02 3 1  ON 33
ci_0035                 1.700074e-02 3 1  ON 34
ci_0036                 1.724077e-02 3 1  ON 35
ci_0037                -1.547653e-02 3 1  ON 36
ci_0038                -1.398461e-02 3 1  ON 37
ci_0039                -1.575271e-02 3 1  ON 38
ci_0040                -1.518575e-02 3 1  ON 39
ci_0041                 1.633048e-02 3 1  ON 40
ci_0042                 1.554472e-02 3 1  ON 41
ci_0043                -1.466083e-02 3 1  ON 42
ci_0044                -1.601019e-02 3 1  ON 43
ci_0045                 1.511377e-02 3 1  ON 44
ci_0046                 1.583821e-02 3 1  ON 45
ci_0047                -1.468415e-02 3 1  ON 46
ci_0048                -1.410351e-02 3 1  ON 47
ci_0049                -1.255632e-02 3 1  ON 48
ci_0050                -1.257716e-02 3 1  ON 49
ci_0051                -1.313827e-02 3 1  ON 50
ci_0052                -1.239990e-02 3 1  ON 51
ci_0053                -1.346079e-02 3 1  ON 52
ci_0054                -1.221495e-02 3 1  ON 53
ci_0055                 1.354964e-02 3 1  ON 54
ci_0056                 1.346278e-02 3 1  ON 55
ci_0057                 1.383048e-02 3 1  ON 56
ci_0058                 1.282163e-02 3 1  ON 57
ci_0059                -1.368186e-02 3 1  ON 58
ci_0060                -1.220775e-02 3 1  ON 59
ci_0061                -1.298283e-02 3 1  ON 60
ci_0062                -1.247485e-02 3 1  ON 61
ci_0063                -1.177054e-02 3 1  ON 62
ci_0064                -1.106666e-02 3 1  ON 63
ci_0065                -1.128753e-02 3 1  ON 64
ci_0066                -1.124581e-02 3 1  ON 65
ci_0067                -1.166850e-02 3 1  ON 66
ci_0068                -1.042972e-02 3 1  ON 67
ci_0069                 1.136913e-02 3 1  ON 68
ci_0070                 1.000320e-02 3 1  ON 69
ci_0071                 9.880575e-03 3 1  ON 70
ci_0072                 1.027206e-02 3 1  ON 71
ci_0073                 1.126136e-02 3 1  ON 72
ci_0074                 1.066950e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8322
    reference variance = 1.38089
====================================================
  Execution time = 1.2859e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5270e+00
  Total weights = 1.9455e+06
  Execution time = 2.2314e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553390799686
                                         uncertainty =       0.024964024618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553390799686
                                         uncertainty =       0.024964024618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129700065
  error estimate for blocks of size 2^( 2) =       0.001168014950
  error estimate for blocks of size 2^( 3) =       0.001199913521
  error estimate for blocks of size 2^( 4) =       0.001224996870
  error estimate for blocks of size 2^( 5) =       0.001240012162
  error estimate for blocks of size 2^( 6) =       0.001244648137
  error estimate for blocks of size 2^( 7) =       0.001253144182

      target function =                  N/A
              le_mean =     -16.718047252650
             les_mean =     282.020130095675
             stat err =       0.001240700338
             autocorr =       1.206167142136
              std dev =       1.597662715083
             le_variance =       2.552526151167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553399119456
                                         uncertainty =       0.024964080559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553399119456
                                         uncertainty =       0.024964080559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129701887
  error estimate for blocks of size 2^( 2) =       0.001168011616
  error estimate for blocks of size 2^( 3) =       0.001199907219
  error estimate for blocks of size 2^( 4) =       0.001224995077
  error estimate for blocks of size 2^( 5) =       0.001240009415
  error estimate for blocks of size 2^( 6) =       0.001244634449
  error estimate for blocks of size 2^( 7) =       0.001253110908

      target function =                  N/A
              le_mean =     -16.718050735784
             les_mean =     299.219148531067
             stat err =       0.001240687462
             autocorr =       1.206138216255
              std dev =       1.597665292771
             le_variance =       2.552534387726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553381958746
                                         uncertainty =       0.024964574761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553381958746
                                         uncertainty =       0.024964574761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129698109
  error estimate for blocks of size 2^( 2) =       0.001168012329
  error estimate for blocks of size 2^( 3) =       0.001199910277
  error estimate for blocks of size 2^( 4) =       0.001224993153
  error estimate for blocks of size 2^( 5) =       0.001240008527
  error estimate for blocks of size 2^( 6) =       0.001244643844
  error estimate for blocks of size 2^( 7) =       0.001253139300

      target function =                  N/A
              le_mean =     -16.718047202121
             les_mean =     282.020178762405
             stat err =       0.001240696206
             autocorr =       1.206163286254
              std dev =       1.597659948633
             le_variance =       2.552517311467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553389683355
                                         uncertainty =       0.024964093363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553389683355
                                         uncertainty =       0.024964093363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129699818
  error estimate for blocks of size 2^( 2) =       0.001168014619
  error estimate for blocks of size 2^( 3) =       0.001199913113
  error estimate for blocks of size 2^( 4) =       0.001224996403
  error estimate for blocks of size 2^( 5) =       0.001240011705
  error estimate for blocks of size 2^( 6) =       0.001244647598
  error estimate for blocks of size 2^( 7) =       0.001253143569

      target function =                  N/A
              le_mean =     -16.718047245537
             les_mean =     282.020132540308
             stat err =       0.001240699819
             autocorr =       1.206166660446
              std dev =       1.597662365768
             le_variance =       2.552525034993


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718047252650        initial
     1.5259e+01     1.5259e+02             2.8392e-05       -16.718050735784  <--
     6.1035e+01     6.1035e+02             7.1675e-06       -16.718047202121
     2.4414e+02     2.4414e+03             1.7963e-06       -16.718047245537

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 2.4119e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.067463e-01 3 1  ON 0
ci_0002                 6.798783e-01 3 1  ON 1
ci_0003                -4.812124e-02 3 1  ON 2
ci_0004                -4.644060e-02 3 1  ON 3
ci_0005                -4.618548e-02 3 1  ON 4
ci_0006                -4.353686e-02 3 1  ON 5
ci_0007                -3.120133e-02 3 1  ON 6
ci_0008                -3.133143e-02 3 1  ON 7
ci_0009                -3.233699e-02 3 1  ON 8
ci_0010                -3.061938e-02 3 1  ON 9
ci_0011                -2.688898e-02 3 1  ON 10
ci_0012                -2.563503e-02 3 1  ON 11
ci_0013                 2.738171e-02 3 1  ON 12
ci_0014                 2.709266e-02 3 1  ON 13
ci_0015                 2.758615e-02 3 1  ON 14
ci_0016                 2.638358e-02 3 1  ON 15
ci_0017                 2.492340e-02 3 1  ON 16
ci_0018                 2.326490e-02 3 1  ON 17
ci_0019                 2.065948e-02 3 1  ON 18
ci_0020                 1.925158e-02 3 1  ON 19
ci_0021                 1.842404e-02 3 1  ON 20
ci_0022                 1.856463e-02 3 1  ON 21
ci_0023                -2.011428e-02 3 1  ON 22
ci_0024                -1.834579e-02 3 1  ON 23
ci_0025                -1.868534e-02 3 1  ON 24
ci_0026                -1.778125e-02 3 1  ON 25
ci_0027                -1.780355e-02 3 1  ON 26
ci_0028                -1.745522e-02 3 1  ON 27
ci_0029                -1.478771e-02 3 1  ON 28
ci_0030                -1.637893e-02 3 1  ON 29
ci_0031                 1.530118e-02 3 1  ON 30
ci_0032                 1.454657e-02 3 1  ON 31
ci_0033                 1.667274e-02 3 1  ON 32
ci_0034                 1.581540e-02 3 1  ON 33
ci_0035                 1.701539e-02 3 1  ON 34
ci_0036                 1.723374e-02 3 1  ON 35
ci_0037                -1.549054e-02 3 1  ON 36
ci_0038                -1.399284e-02 3 1  ON 37
ci_0039                -1.574928e-02 3 1  ON 38
ci_0040                -1.518860e-02 3 1  ON 39
ci_0041                 1.631872e-02 3 1  ON 40
ci_0042                 1.554090e-02 3 1  ON 41
ci_0043                -1.466135e-02 3 1  ON 42
ci_0044                -1.600448e-02 3 1  ON 43
ci_0045                 1.512873e-02 3 1  ON 44
ci_0046                 1.584276e-02 3 1  ON 45
ci_0047                -1.468856e-02 3 1  ON 46
ci_0048                -1.409785e-02 3 1  ON 47
ci_0049                -1.257398e-02 3 1  ON 48
ci_0050                -1.259305e-02 3 1  ON 49
ci_0051                -1.313833e-02 3 1  ON 50
ci_0052                -1.239060e-02 3 1  ON 51
ci_0053                -1.345292e-02 3 1  ON 52
ci_0054                -1.222342e-02 3 1  ON 53
ci_0055                 1.353854e-02 3 1  ON 54
ci_0056                 1.345194e-02 3 1  ON 55
ci_0057                 1.382209e-02 3 1  ON 56
ci_0058                 1.280041e-02 3 1  ON 57
ci_0059                -1.367672e-02 3 1  ON 58
ci_0060                -1.221449e-02 3 1  ON 59
ci_0061                -1.298529e-02 3 1  ON 60
ci_0062                -1.247113e-02 3 1  ON 61
ci_0063                -1.176457e-02 3 1  ON 62
ci_0064                -1.107277e-02 3 1  ON 63
ci_0065                -1.129164e-02 3 1  ON 64
ci_0066                -1.126195e-02 3 1  ON 65
ci_0067                -1.165864e-02 3 1  ON 66
ci_0068                -1.042658e-02 3 1  ON 67
ci_0069                 1.135797e-02 3 1  ON 68
ci_0070                 1.002282e-02 3 1  ON 69
ci_0071                 9.889136e-03 3 1  ON 70
ci_0072                 1.027552e-02 3 1  ON 71
ci_0073                 1.125347e-02 3 1  ON 72
ci_0074                 1.066286e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0537e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6686e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9387
    reference variance = 1.43763
====================================================
  Execution time = 1.3100e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0258e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.9753e+00
  Total weights = 1.945666860e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2090e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.013147471588
                                         uncertainty =       0.296782577840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.013147471588
                                         uncertainty =       0.296782577840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001227308689
  error estimate for blocks of size 2^( 2) =       0.001263704136
  error estimate for blocks of size 2^( 3) =       0.001294354725
  error estimate for blocks of size 2^( 4) =       0.001315255340
  error estimate for blocks of size 2^( 5) =       0.001327592027
  error estimate for blocks of size 2^( 6) =       0.001334379289
  error estimate for blocks of size 2^( 7) =       0.001339226311

      target function =                  N/A
              le_mean =     -16.716569340344
             les_mean =     282.418965191954
             stat err =       0.001329113242
             autocorr =       1.172779462389
              std dev =       1.735704363267
             le_variance =       3.012669636663


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671656934034e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716569339481       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716574468025       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716574475177       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716574477347       residual = 3.96e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+00 is 1.285312e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716569339481       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716570676555       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716570671999       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+01 is 3.357515e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716569339481       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716569677369       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716569675817       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+01 is 8.486129e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.323151 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6316e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.067534e-01 3 1  ON 0
ci_0002                 6.798738e-01 3 1  ON 1
ci_0003                -4.810808e-02 3 1  ON 2
ci_0004                -4.642841e-02 3 1  ON 3
ci_0005                -4.615334e-02 3 1  ON 4
ci_0006                -4.353014e-02 3 1  ON 5
ci_0007                -3.120961e-02 3 1  ON 6
ci_0008                -3.134621e-02 3 1  ON 7
ci_0009                -3.235051e-02 3 1  ON 8
ci_0010                -3.063195e-02 3 1  ON 9
ci_0011                -2.688833e-02 3 1  ON 10
ci_0012                -2.566185e-02 3 1  ON 11
ci_0013                 2.738761e-02 3 1  ON 12
ci_0014                 2.709915e-02 3 1  ON 13
ci_0015                 2.757987e-02 3 1  ON 14
ci_0016                 2.641716e-02 3 1  ON 15
ci_0017                 2.491105e-02 3 1  ON 16
ci_0018                 2.328184e-02 3 1  ON 17
ci_0019                 2.064614e-02 3 1  ON 18
ci_0020                 1.926544e-02 3 1  ON 19
ci_0021                 1.842681e-02 3 1  ON 20
ci_0022                 1.855991e-02 3 1  ON 21
ci_0023                -2.009487e-02 3 1  ON 22
ci_0024                -1.834756e-02 3 1  ON 23
ci_0025                -1.869580e-02 3 1  ON 24
ci_0026                -1.777464e-02 3 1  ON 25
ci_0027                -1.779793e-02 3 1  ON 26
ci_0028                -1.745219e-02 3 1  ON 27
ci_0029                -1.479576e-02 3 1  ON 28
ci_0030                -1.637638e-02 3 1  ON 29
ci_0031                 1.530444e-02 3 1  ON 30
ci_0032                 1.454572e-02 3 1  ON 31
ci_0033                 1.667932e-02 3 1  ON 32
ci_0034                 1.582043e-02 3 1  ON 33
ci_0035                 1.701798e-02 3 1  ON 34
ci_0036                 1.723237e-02 3 1  ON 35
ci_0037                -1.548935e-02 3 1  ON 36
ci_0038                -1.401080e-02 3 1  ON 37
ci_0039                -1.574179e-02 3 1  ON 38
ci_0040                -1.518978e-02 3 1  ON 39
ci_0041                 1.630409e-02 3 1  ON 40
ci_0042                 1.555303e-02 3 1  ON 41
ci_0043                -1.465749e-02 3 1  ON 42
ci_0044                -1.597181e-02 3 1  ON 43
ci_0045                 1.513547e-02 3 1  ON 44
ci_0046                 1.582358e-02 3 1  ON 45
ci_0047                -1.468434e-02 3 1  ON 46
ci_0048                -1.409224e-02 3 1  ON 47
ci_0049                -1.257482e-02 3 1  ON 48
ci_0050                -1.260390e-02 3 1  ON 49
ci_0051                -1.313957e-02 3 1  ON 50
ci_0052                -1.238204e-02 3 1  ON 51
ci_0053                -1.343842e-02 3 1  ON 52
ci_0054                -1.222167e-02 3 1  ON 53
ci_0055                 1.353313e-02 3 1  ON 54
ci_0056                 1.344339e-02 3 1  ON 55
ci_0057                 1.380760e-02 3 1  ON 56
ci_0058                 1.279773e-02 3 1  ON 57
ci_0059                -1.366387e-02 3 1  ON 58
ci_0060                -1.222545e-02 3 1  ON 59
ci_0061                -1.297494e-02 3 1  ON 60
ci_0062                -1.245708e-02 3 1  ON 61
ci_0063                -1.175951e-02 3 1  ON 62
ci_0064                -1.108506e-02 3 1  ON 63
ci_0065                -1.130526e-02 3 1  ON 64
ci_0066                -1.127112e-02 3 1  ON 65
ci_0067                -1.166168e-02 3 1  ON 66
ci_0068                -1.041311e-02 3 1  ON 67
ci_0069                 1.133264e-02 3 1  ON 68
ci_0070                 1.002461e-02 3 1  ON 69
ci_0071                 9.906724e-03 3 1  ON 70
ci_0072                 1.024922e-02 3 1  ON 71
ci_0073                 1.124368e-02 3 1  ON 72
ci_0074                 1.065237e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8455
    reference variance = 1.52636
====================================================
  Execution time = 1.2845e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5103e+00
  Total weights = 1.9455e+06
  Execution time = 2.2144e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538953933111
                                         uncertainty =       0.021538785004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538953933111
                                         uncertainty =       0.021538785004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126655813
  error estimate for blocks of size 2^( 2) =       0.001164964588
  error estimate for blocks of size 2^( 3) =       0.001198440911
  error estimate for blocks of size 2^( 4) =       0.001218126880
  error estimate for blocks of size 2^( 5) =       0.001233831487
  error estimate for blocks of size 2^( 6) =       0.001243539832
  error estimate for blocks of size 2^( 7) =       0.001245285899

      target function =                  N/A
              le_mean =     -16.718555257805
             les_mean =     282.020776842231
             stat err =       0.001235196025
             autocorr =       1.201957873832
              std dev =       1.593357424121
             le_variance =       2.538787881003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538813296389
                                         uncertainty =       0.021535374972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538813296389
                                         uncertainty =       0.021535374972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126624528
  error estimate for blocks of size 2^( 2) =       0.001164935722
  error estimate for blocks of size 2^( 3) =       0.001198413009
  error estimate for blocks of size 2^( 4) =       0.001218101585
  error estimate for blocks of size 2^( 5) =       0.001233804768
  error estimate for blocks of size 2^( 6) =       0.001243509541
  error estimate for blocks of size 2^( 7) =       0.001245253523

      target function =                  N/A
              le_mean =     -16.718555510037
             les_mean =     282.020017086790
             stat err =       0.001235167354
             autocorr =       1.201968828879
              std dev =       1.593313179530
             le_variance =       2.538646888065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538878649705
                                         uncertainty =       0.021537000707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538878649705
                                         uncertainty =       0.021537000707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126639061
  error estimate for blocks of size 2^( 2) =       0.001164949136
  error estimate for blocks of size 2^( 3) =       0.001198426006
  error estimate for blocks of size 2^( 4) =       0.001218113321
  error estimate for blocks of size 2^( 5) =       0.001233817187
  error estimate for blocks of size 2^( 6) =       0.001243523611
  error estimate for blocks of size 2^( 7) =       0.001245268522

      target function =                  N/A
              le_mean =     -16.718555298323
             les_mean =     282.020219691617
             stat err =       0.001235180660
             autocorr =       1.201963716202
              std dev =       1.593333732351
             le_variance =       2.538712382646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538944295158
                                         uncertainty =       0.021538558509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538944295158
                                         uncertainty =       0.021538558509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126653668
  error estimate for blocks of size 2^( 2) =       0.001164962607
  error estimate for blocks of size 2^( 3) =       0.001198439002
  error estimate for blocks of size 2^( 4) =       0.001218125138
  error estimate for blocks of size 2^( 5) =       0.001233829658
  error estimate for blocks of size 2^( 6) =       0.001243537747
  error estimate for blocks of size 2^( 7) =       0.001245283662

      target function =                  N/A
              le_mean =     -16.718555247987
             les_mean =     282.020660158845
             stat err =       0.001235194051
             autocorr =       1.201958609807
              std dev =       1.593354390933
             le_variance =       2.538778215106


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718555257805        initial
     3.8147e+00     3.8147e+01             1.2853e-04       -16.718555510037  <--
     1.5259e+01     1.5259e+02             3.3575e-05       -16.718555298323
     6.1035e+01     6.1035e+02             8.4861e-06       -16.718555247987

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 2.4013e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.067737e-01 3 1  ON 0
ci_0002                 6.798607e-01 3 1  ON 1
ci_0003                -4.807108e-02 3 1  ON 2
ci_0004                -4.639311e-02 3 1  ON 3
ci_0005                -4.605999e-02 3 1  ON 4
ci_0006                -4.351049e-02 3 1  ON 5
ci_0007                -3.123415e-02 3 1  ON 6
ci_0008                -3.138939e-02 3 1  ON 7
ci_0009                -3.238849e-02 3 1  ON 8
ci_0010                -3.066685e-02 3 1  ON 9
ci_0011                -2.688738e-02 3 1  ON 10
ci_0012                -2.573781e-02 3 1  ON 11
ci_0013                 2.740450e-02 3 1  ON 12
ci_0014                 2.711755e-02 3 1  ON 13
ci_0015                 2.756265e-02 3 1  ON 14
ci_0016                 2.651212e-02 3 1  ON 15
ci_0017                 2.487656e-02 3 1  ON 16
ci_0018                 2.332917e-02 3 1  ON 17
ci_0019                 2.060877e-02 3 1  ON 18
ci_0020                 1.930449e-02 3 1  ON 19
ci_0021                 1.843445e-02 3 1  ON 20
ci_0022                 1.854587e-02 3 1  ON 21
ci_0023                -2.004030e-02 3 1  ON 22
ci_0024                -1.835229e-02 3 1  ON 23
ci_0025                -1.872532e-02 3 1  ON 24
ci_0026                -1.775638e-02 3 1  ON 25
ci_0027                -1.778245e-02 3 1  ON 26
ci_0028                -1.744331e-02 3 1  ON 27
ci_0029                -1.481888e-02 3 1  ON 28
ci_0030                -1.636855e-02 3 1  ON 29
ci_0031                 1.531411e-02 3 1  ON 30
ci_0032                 1.454365e-02 3 1  ON 31
ci_0033                 1.669852e-02 3 1  ON 32
ci_0034                 1.583513e-02 3 1  ON 33
ci_0035                 1.702528e-02 3 1  ON 34
ci_0036                 1.722870e-02 3 1  ON 35
ci_0037                -1.548627e-02 3 1  ON 36
ci_0038                -1.406247e-02 3 1  ON 37
ci_0039                -1.572155e-02 3 1  ON 38
ci_0040                -1.519265e-02 3 1  ON 39
ci_0041                 1.626241e-02 3 1  ON 40
ci_0042                 1.558782e-02 3 1  ON 41
ci_0043                -1.464644e-02 3 1  ON 42
ci_0044                -1.587604e-02 3 1  ON 43
ci_0045                 1.515503e-02 3 1  ON 44
ci_0046                 1.576743e-02 3 1  ON 45
ci_0047                -1.467286e-02 3 1  ON 46
ci_0048                -1.407690e-02 3 1  ON 47
ci_0049                -1.257749e-02 3 1  ON 48
ci_0050                -1.263436e-02 3 1  ON 49
ci_0051                -1.314308e-02 3 1  ON 50
ci_0052                -1.235900e-02 3 1  ON 51
ci_0053                -1.339856e-02 3 1  ON 52
ci_0054                -1.221648e-02 3 1  ON 53
ci_0055                 1.351749e-02 3 1  ON 54
ci_0056                 1.341895e-02 3 1  ON 55
ci_0057                 1.376631e-02 3 1  ON 56
ci_0058                 1.279016e-02 3 1  ON 57
ci_0059                -1.362853e-02 3 1  ON 58
ci_0060                -1.225514e-02 3 1  ON 59
ci_0061                -1.294548e-02 3 1  ON 60
ci_0062                -1.241701e-02 3 1  ON 61
ci_0063                -1.174537e-02 3 1  ON 62
ci_0064                -1.111958e-02 3 1  ON 63
ci_0065                -1.134395e-02 3 1  ON 64
ci_0066                -1.129692e-02 3 1  ON 65
ci_0067                -1.167046e-02 3 1  ON 66
ci_0068                -1.037584e-02 3 1  ON 67
ci_0069                 1.126387e-02 3 1  ON 68
ci_0070                 1.002935e-02 3 1  ON 69
ci_0071                 9.956057e-03 3 1  ON 70
ci_0072                 1.017449e-02 3 1  ON 71
ci_0073                 1.121694e-02 3 1  ON 72
ci_0074                 1.062356e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0334e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6699e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.3982
    reference variance = 2.7679
====================================================
  Execution time = 1.3067e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0284e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4865e+00
  Total weights = 1.946071004e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1692e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.514055552353
                                         uncertainty =       0.020721961304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.514055552353
                                         uncertainty =       0.020721961304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121192113
  error estimate for blocks of size 2^( 2) =       0.001159523895
  error estimate for blocks of size 2^( 3) =       0.001190815045
  error estimate for blocks of size 2^( 4) =       0.001212339343
  error estimate for blocks of size 2^( 5) =       0.001228538257
  error estimate for blocks of size 2^( 6) =       0.001238323828
  error estimate for blocks of size 2^( 7) =       0.001248295363

      target function =                  N/A
              le_mean =     -16.719243657797
             les_mean =     282.019563171781
             stat err =       0.001231874198
             autocorr =       1.207181717117
              std dev =       1.585630462038
             le_variance =       2.514223962143


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671924365780e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719243656888       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719256236202       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719256564643       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e-01 is 4.200156e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719243656888       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719247353902       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719247350948       residual = 4.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+00 is 1.221589e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719243656888       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719244623575       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719244615555       residual = 1.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+01 is 3.186694e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.324360 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6243e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.067800e-01 3 1  ON 0
ci_0002                 6.798390e-01 3 1  ON 1
ci_0003                -4.816501e-02 3 1  ON 2
ci_0004                -4.638836e-02 3 1  ON 3
ci_0005                -4.605677e-02 3 1  ON 4
ci_0006                -4.354097e-02 3 1  ON 5
ci_0007                -3.118520e-02 3 1  ON 6
ci_0008                -3.143374e-02 3 1  ON 7
ci_0009                -3.238738e-02 3 1  ON 8
ci_0010                -3.066536e-02 3 1  ON 9
ci_0011                -2.692055e-02 3 1  ON 10
ci_0012                -2.577174e-02 3 1  ON 11
ci_0013                 2.741273e-02 3 1  ON 12
ci_0014                 2.707931e-02 3 1  ON 13
ci_0015                 2.757172e-02 3 1  ON 14
ci_0016                 2.647804e-02 3 1  ON 15
ci_0017                 2.485030e-02 3 1  ON 16
ci_0018                 2.340902e-02 3 1  ON 17
ci_0019                 2.064482e-02 3 1  ON 18
ci_0020                 1.931359e-02 3 1  ON 19
ci_0021                 1.844771e-02 3 1  ON 20
ci_0022                 1.853664e-02 3 1  ON 21
ci_0023                -2.002149e-02 3 1  ON 22
ci_0024                -1.836037e-02 3 1  ON 23
ci_0025                -1.869090e-02 3 1  ON 24
ci_0026                -1.780388e-02 3 1  ON 25
ci_0027                -1.782093e-02 3 1  ON 26
ci_0028                -1.739321e-02 3 1  ON 27
ci_0029                -1.494104e-02 3 1  ON 28
ci_0030                -1.636468e-02 3 1  ON 29
ci_0031                 1.528415e-02 3 1  ON 30
ci_0032                 1.448141e-02 3 1  ON 31
ci_0033                 1.672001e-02 3 1  ON 32
ci_0034                 1.586494e-02 3 1  ON 33
ci_0035                 1.709653e-02 3 1  ON 34
ci_0036                 1.721869e-02 3 1  ON 35
ci_0037                -1.546548e-02 3 1  ON 36
ci_0038                -1.405850e-02 3 1  ON 37
ci_0039                -1.569972e-02 3 1  ON 38
ci_0040                -1.523410e-02 3 1  ON 39
ci_0041                 1.627855e-02 3 1  ON 40
ci_0042                 1.555227e-02 3 1  ON 41
ci_0043                -1.463253e-02 3 1  ON 42
ci_0044                -1.587392e-02 3 1  ON 43
ci_0045                 1.522783e-02 3 1  ON 44
ci_0046                 1.573394e-02 3 1  ON 45
ci_0047                -1.469249e-02 3 1  ON 46
ci_0048                -1.404323e-02 3 1  ON 47
ci_0049                -1.269780e-02 3 1  ON 48
ci_0050                -1.264254e-02 3 1  ON 49
ci_0051                -1.316664e-02 3 1  ON 50
ci_0052                -1.241208e-02 3 1  ON 51
ci_0053                -1.337623e-02 3 1  ON 52
ci_0054                -1.223859e-02 3 1  ON 53
ci_0055                 1.340371e-02 3 1  ON 54
ci_0056                 1.338154e-02 3 1  ON 55
ci_0057                 1.365251e-02 3 1  ON 56
ci_0058                 1.280697e-02 3 1  ON 57
ci_0059                -1.354365e-02 3 1  ON 58
ci_0060                -1.227310e-02 3 1  ON 59
ci_0061                -1.299013e-02 3 1  ON 60
ci_0062                -1.245954e-02 3 1  ON 61
ci_0063                -1.184357e-02 3 1  ON 62
ci_0064                -1.113263e-02 3 1  ON 63
ci_0065                -1.137170e-02 3 1  ON 64
ci_0066                -1.130453e-02 3 1  ON 65
ci_0067                -1.164564e-02 3 1  ON 66
ci_0068                -1.045004e-02 3 1  ON 67
ci_0069                 1.123004e-02 3 1  ON 68
ci_0070                 1.001862e-02 3 1  ON 69
ci_0071                 9.909353e-03 3 1  ON 70
ci_0072                 1.013974e-02 3 1  ON 71
ci_0073                 1.122006e-02 3 1  ON 72
ci_0074                 1.067199e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9859
    reference variance = 1.00317
====================================================
  Execution time = 1.2822e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5234e+00
  Total weights = 1.9454e+06
  Execution time = 2.2218e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550762209588
                                         uncertainty =       0.026863553521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550762209588
                                         uncertainty =       0.026863553521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129166309
  error estimate for blocks of size 2^( 2) =       0.001167435960
  error estimate for blocks of size 2^( 3) =       0.001201240790
  error estimate for blocks of size 2^( 4) =       0.001224411420
  error estimate for blocks of size 2^( 5) =       0.001236095693
  error estimate for blocks of size 2^( 6) =       0.001240255454
  error estimate for blocks of size 2^( 7) =       0.001250948610

      target function =                  N/A
              le_mean =     -16.716866444938
             les_mean =     281.979553057793
             stat err =       0.001237927794
             autocorr =       1.201917903384
              std dev =       1.596907858482
             le_variance =       2.550114708483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550717231125
                                         uncertainty =       0.026865562772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550717231125
                                         uncertainty =       0.026865562772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129156183
  error estimate for blocks of size 2^( 2) =       0.001167409842
  error estimate for blocks of size 2^( 3) =       0.001201201140
  error estimate for blocks of size 2^( 4) =       0.001224360392
  error estimate for blocks of size 2^( 5) =       0.001236054478
  error estimate for blocks of size 2^( 6) =       0.001240201187
  error estimate for blocks of size 2^( 7) =       0.001250867844

      target function =                  N/A
              le_mean =     -16.716871465344
             les_mean =     281.977466210229
             stat err =       0.001237870975
             autocorr =       1.201829130030
              std dev =       1.596893537521
             le_variance =       2.550068970177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.020993797576
                                         uncertainty =       0.469124244125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.020993797576
                                         uncertainty =       0.469124244125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001228810340
  error estimate for blocks of size 2^( 2) =       0.001264031520
  error estimate for blocks of size 2^( 3) =       0.001295241402
  error estimate for blocks of size 2^( 4) =       0.001317164357
  error estimate for blocks of size 2^( 5) =       0.001328687148
  error estimate for blocks of size 2^( 6) =       0.001329939846
  error estimate for blocks of size 2^( 7) =       0.001337806510

      target function =                  N/A
              le_mean =     -16.717353403061
             les_mean =   19238.961313514261
             stat err =       0.001328399465
             autocorr =       1.168658627734
              std dev =       1.737828053640
             le_variance =       3.020046344017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550757666189
                                         uncertainty =       0.026863690147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550757666189
                                         uncertainty =       0.026863690147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129165290
  error estimate for blocks of size 2^( 2) =       0.001167433671
  error estimate for blocks of size 2^( 3) =       0.001201237362
  error estimate for blocks of size 2^( 4) =       0.001224407199
  error estimate for blocks of size 2^( 5) =       0.001236091920
  error estimate for blocks of size 2^( 6) =       0.001240250600
  error estimate for blocks of size 2^( 7) =       0.001250941743

      target function =                  N/A
              le_mean =     -16.716866700710
             les_mean =     281.977198685915
             stat err =       0.001237922865
             autocorr =       1.201910503398
              std dev =       1.596906416722
             le_variance =       2.550110103768


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716866444938        initial
     9.5367e-01     9.5367e+00             4.2002e-04       -16.716871465344
     3.8147e+00     3.8147e+01             1.2216e-04       -16.717353403061  <--
     1.5259e+01     1.5259e+02             3.1867e-05       -16.716866700710

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 2.4025e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.067800e-01 3 1  ON 0
ci_0002                 6.798390e-01 3 1  ON 1
ci_0003                -4.816501e-02 3 1  ON 2
ci_0004                -4.638836e-02 3 1  ON 3
ci_0005                -4.605677e-02 3 1  ON 4
ci_0006                -4.354097e-02 3 1  ON 5
ci_0007                -3.118520e-02 3 1  ON 6
ci_0008                -3.143374e-02 3 1  ON 7
ci_0009                -3.238738e-02 3 1  ON 8
ci_0010                -3.066536e-02 3 1  ON 9
ci_0011                -2.692055e-02 3 1  ON 10
ci_0012                -2.577174e-02 3 1  ON 11
ci_0013                 2.741273e-02 3 1  ON 12
ci_0014                 2.707931e-02 3 1  ON 13
ci_0015                 2.757172e-02 3 1  ON 14
ci_0016                 2.647804e-02 3 1  ON 15
ci_0017                 2.485030e-02 3 1  ON 16
ci_0018                 2.340902e-02 3 1  ON 17
ci_0019                 2.064482e-02 3 1  ON 18
ci_0020                 1.931359e-02 3 1  ON 19
ci_0021                 1.844771e-02 3 1  ON 20
ci_0022                 1.853664e-02 3 1  ON 21
ci_0023                -2.002149e-02 3 1  ON 22
ci_0024                -1.836037e-02 3 1  ON 23
ci_0025                -1.869090e-02 3 1  ON 24
ci_0026                -1.780388e-02 3 1  ON 25
ci_0027                -1.782093e-02 3 1  ON 26
ci_0028                -1.739321e-02 3 1  ON 27
ci_0029                -1.494104e-02 3 1  ON 28
ci_0030                -1.636468e-02 3 1  ON 29
ci_0031                 1.528415e-02 3 1  ON 30
ci_0032                 1.448141e-02 3 1  ON 31
ci_0033                 1.672001e-02 3 1  ON 32
ci_0034                 1.586494e-02 3 1  ON 33
ci_0035                 1.709653e-02 3 1  ON 34
ci_0036                 1.721869e-02 3 1  ON 35
ci_0037                -1.546548e-02 3 1  ON 36
ci_0038                -1.405850e-02 3 1  ON 37
ci_0039                -1.569972e-02 3 1  ON 38
ci_0040                -1.523410e-02 3 1  ON 39
ci_0041                 1.627855e-02 3 1  ON 40
ci_0042                 1.555227e-02 3 1  ON 41
ci_0043                -1.463253e-02 3 1  ON 42
ci_0044                -1.587392e-02 3 1  ON 43
ci_0045                 1.522783e-02 3 1  ON 44
ci_0046                 1.573394e-02 3 1  ON 45
ci_0047                -1.469249e-02 3 1  ON 46
ci_0048                -1.404323e-02 3 1  ON 47
ci_0049                -1.269780e-02 3 1  ON 48
ci_0050                -1.264254e-02 3 1  ON 49
ci_0051                -1.316664e-02 3 1  ON 50
ci_0052                -1.241208e-02 3 1  ON 51
ci_0053                -1.337623e-02 3 1  ON 52
ci_0054                -1.223859e-02 3 1  ON 53
ci_0055                 1.340371e-02 3 1  ON 54
ci_0056                 1.338154e-02 3 1  ON 55
ci_0057                 1.365251e-02 3 1  ON 56
ci_0058                 1.280697e-02 3 1  ON 57
ci_0059                -1.354365e-02 3 1  ON 58
ci_0060                -1.227310e-02 3 1  ON 59
ci_0061                -1.299013e-02 3 1  ON 60
ci_0062                -1.245954e-02 3 1  ON 61
ci_0063                -1.184357e-02 3 1  ON 62
ci_0064                -1.113263e-02 3 1  ON 63
ci_0065                -1.137170e-02 3 1  ON 64
ci_0066                -1.130453e-02 3 1  ON 65
ci_0067                -1.164564e-02 3 1  ON 66
ci_0068                -1.045004e-02 3 1  ON 67
ci_0069                 1.123004e-02 3 1  ON 68
ci_0070                 1.001862e-02 3 1  ON 69
ci_0071                 9.909353e-03 3 1  ON 70
ci_0072                 1.013974e-02 3 1  ON 71
ci_0073                 1.122006e-02 3 1  ON 72
ci_0074                 1.067199e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0274e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6699e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.3432
    reference variance = 5.7679
====================================================
  Execution time = 1.3122e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0282e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.4670e+00
  Total weights = 1.945653219e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1732e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.494905562233
                                         uncertainty =       0.020863983930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.494905562233
                                         uncertainty =       0.020863983930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001116798545
  error estimate for blocks of size 2^( 2) =       0.001155719883
  error estimate for blocks of size 2^( 3) =       0.001187948924
  error estimate for blocks of size 2^( 4) =       0.001210569466
  error estimate for blocks of size 2^( 5) =       0.001225263370
  error estimate for blocks of size 2^( 6) =       0.001237199957
  error estimate for blocks of size 2^( 7) =       0.001243507830

      target function =                  N/A
              le_mean =     -16.719996367254
             les_mean =     282.025275806689
             stat err =       0.001229135155
             autocorr =       1.211294099039
              std dev =       1.579416919480
             le_variance =       2.494557805540


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671999636725e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719996366322       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720013374746       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720013374276       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e-01 is 4.534750e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719996366322       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720001373979       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720001382549       residual = 3.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+00 is 1.291313e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719996366322       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719997676434       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719997680336       residual = 2.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+01 is 3.346085e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.325509 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6302e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.068170e-01 3 1  ON 0
ci_0002                 6.798135e-01 3 1  ON 1
ci_0003                -4.813699e-02 3 1  ON 2
ci_0004                -4.643943e-02 3 1  ON 3
ci_0005                -4.605479e-02 3 1  ON 4
ci_0006                -4.355140e-02 3 1  ON 5
ci_0007                -3.116182e-02 3 1  ON 6
ci_0008                -3.138731e-02 3 1  ON 7
ci_0009                -3.231762e-02 3 1  ON 8
ci_0010                -3.071081e-02 3 1  ON 9
ci_0011                -2.689966e-02 3 1  ON 10
ci_0012                -2.583842e-02 3 1  ON 11
ci_0013                 2.745022e-02 3 1  ON 12
ci_0014                 2.701608e-02 3 1  ON 13
ci_0015                 2.750112e-02 3 1  ON 14
ci_0016                 2.646635e-02 3 1  ON 15
ci_0017                 2.480051e-02 3 1  ON 16
ci_0018                 2.346343e-02 3 1  ON 17
ci_0019                 2.057977e-02 3 1  ON 18
ci_0020                 1.933073e-02 3 1  ON 19
ci_0021                 1.844530e-02 3 1  ON 20
ci_0022                 1.852443e-02 3 1  ON 21
ci_0023                -1.994872e-02 3 1  ON 22
ci_0024                -1.834533e-02 3 1  ON 23
ci_0025                -1.869321e-02 3 1  ON 24
ci_0026                -1.776238e-02 3 1  ON 25
ci_0027                -1.778538e-02 3 1  ON 26
ci_0028                -1.734009e-02 3 1  ON 27
ci_0029                -1.507017e-02 3 1  ON 28
ci_0030                -1.642607e-02 3 1  ON 29
ci_0031                 1.530630e-02 3 1  ON 30
ci_0032                 1.448851e-02 3 1  ON 31
ci_0033                 1.669469e-02 3 1  ON 32
ci_0034                 1.580295e-02 3 1  ON 33
ci_0035                 1.709678e-02 3 1  ON 34
ci_0036                 1.719650e-02 3 1  ON 35
ci_0037                -1.540133e-02 3 1  ON 36
ci_0038                -1.413072e-02 3 1  ON 37
ci_0039                -1.570458e-02 3 1  ON 38
ci_0040                -1.520295e-02 3 1  ON 39
ci_0041                 1.620834e-02 3 1  ON 40
ci_0042                 1.554346e-02 3 1  ON 41
ci_0043                -1.464698e-02 3 1  ON 42
ci_0044                -1.588576e-02 3 1  ON 43
ci_0045                 1.529616e-02 3 1  ON 44
ci_0046                 1.570850e-02 3 1  ON 45
ci_0047                -1.465994e-02 3 1  ON 46
ci_0048                -1.410691e-02 3 1  ON 47
ci_0049                -1.262974e-02 3 1  ON 48
ci_0050                -1.274995e-02 3 1  ON 49
ci_0051                -1.317821e-02 3 1  ON 50
ci_0052                -1.239824e-02 3 1  ON 51
ci_0053                -1.333954e-02 3 1  ON 52
ci_0054                -1.226539e-02 3 1  ON 53
ci_0055                 1.334634e-02 3 1  ON 54
ci_0056                 1.328372e-02 3 1  ON 55
ci_0057                 1.362304e-02 3 1  ON 56
ci_0058                 1.282696e-02 3 1  ON 57
ci_0059                -1.350287e-02 3 1  ON 58
ci_0060                -1.228762e-02 3 1  ON 59
ci_0061                -1.302060e-02 3 1  ON 60
ci_0062                -1.249264e-02 3 1  ON 61
ci_0063                -1.188405e-02 3 1  ON 62
ci_0064                -1.115033e-02 3 1  ON 63
ci_0065                -1.134937e-02 3 1  ON 64
ci_0066                -1.125754e-02 3 1  ON 65
ci_0067                -1.159213e-02 3 1  ON 66
ci_0068                -1.052434e-02 3 1  ON 67
ci_0069                 1.118056e-02 3 1  ON 68
ci_0070                 1.007758e-02 3 1  ON 69
ci_0071                 9.925833e-03 3 1  ON 70
ci_0072                 1.009825e-02 3 1  ON 71
ci_0073                 1.119206e-02 3 1  ON 72
ci_0074                 1.070941e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.6048
    reference variance = 1.8686
====================================================
  Execution time = 1.2769e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5689e+00
  Total weights = 1.9458e+06
  Execution time = 2.2238e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.591443346037
                                         uncertainty =       0.062623266924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.591443346037
                                         uncertainty =       0.062623266924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138265979
  error estimate for blocks of size 2^( 2) =       0.001176527068
  error estimate for blocks of size 2^( 3) =       0.001209213189
  error estimate for blocks of size 2^( 4) =       0.001230675902
  error estimate for blocks of size 2^( 5) =       0.001243881299
  error estimate for blocks of size 2^( 6) =       0.001254112316
  error estimate for blocks of size 2^( 7) =       0.001256919798

      target function =                  N/A
              le_mean =     -16.717665264507
             les_mean =     282.050709595392
             stat err =       0.001246397329
             autocorr =       1.199017461015
              std dev =       1.609776941412
             le_variance =       2.591381801101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.591136469511
                                         uncertainty =       0.062624773561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.591136469511
                                         uncertainty =       0.062624773561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138198522
  error estimate for blocks of size 2^( 2) =       0.001176466540
  error estimate for blocks of size 2^( 3) =       0.001209164939
  error estimate for blocks of size 2^( 4) =       0.001230631956
  error estimate for blocks of size 2^( 5) =       0.001243823531
  error estimate for blocks of size 2^( 6) =       0.001254068214
  error estimate for blocks of size 2^( 7) =       0.001256894704

      target function =                  N/A
              le_mean =     -16.717664458860
             les_mean =     282.049506265643
             stat err =       0.001246354601
             autocorr =       1.199077373059
              std dev =       1.609681541363
             le_variance =       2.591074664605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.591255689023
                                         uncertainty =       0.062624225666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.591255689023
                                         uncertainty =       0.062624225666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138224732
  error estimate for blocks of size 2^( 2) =       0.001176490024
  error estimate for blocks of size 2^( 3) =       0.001209183526
  error estimate for blocks of size 2^( 4) =       0.001230648780
  error estimate for blocks of size 2^( 5) =       0.001243845878
  error estimate for blocks of size 2^( 6) =       0.001254086490
  error estimate for blocks of size 2^( 7) =       0.001256905696

      target function =                  N/A
              le_mean =     -16.717663153403
             les_mean =     282.050578295963
             stat err =       0.001246371711
             autocorr =       1.199055072268
              std dev =       1.609718608118
             le_variance =       2.591193997321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.591417191733
                                         uncertainty =       0.062623398644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.591417191733
                                         uncertainty =       0.062623398644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138260231
  error estimate for blocks of size 2^( 2) =       0.001176521938
  error estimate for blocks of size 2^( 3) =       0.001209209200
  error estimate for blocks of size 2^( 4) =       0.001230672216
  error estimate for blocks of size 2^( 5) =       0.001243876674
  error estimate for blocks of size 2^( 6) =       0.001254110064
  error estimate for blocks of size 2^( 7) =       0.001256919855

      target function =                  N/A
              le_mean =     -16.717664734566
             les_mean =     282.050044785244
             stat err =       0.001246394702
             autocorr =       1.199024517062
              std dev =       1.609768812461
             le_variance =       2.591355629574


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717665264507        initial  <--
     9.5367e-01     9.5367e+00             4.5347e-04       -16.717664458860
     3.8147e+00     3.8147e+01             1.2913e-04       -16.717663153403
     1.5259e+01     1.5259e+02             3.3461e-05       -16.717664734566

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9857
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.067800e-01 3 1  ON 0
ci_0002                 6.798390e-01 3 1  ON 1
ci_0003                -4.816501e-02 3 1  ON 2
ci_0004                -4.638836e-02 3 1  ON 3
ci_0005                -4.605677e-02 3 1  ON 4
ci_0006                -4.354097e-02 3 1  ON 5
ci_0007                -3.118520e-02 3 1  ON 6
ci_0008                -3.143374e-02 3 1  ON 7
ci_0009                -3.238738e-02 3 1  ON 8
ci_0010                -3.066536e-02 3 1  ON 9
ci_0011                -2.692055e-02 3 1  ON 10
ci_0012                -2.577174e-02 3 1  ON 11
ci_0013                 2.741273e-02 3 1  ON 12
ci_0014                 2.707931e-02 3 1  ON 13
ci_0015                 2.757172e-02 3 1  ON 14
ci_0016                 2.647804e-02 3 1  ON 15
ci_0017                 2.485030e-02 3 1  ON 16
ci_0018                 2.340902e-02 3 1  ON 17
ci_0019                 2.064482e-02 3 1  ON 18
ci_0020                 1.931359e-02 3 1  ON 19
ci_0021                 1.844771e-02 3 1  ON 20
ci_0022                 1.853664e-02 3 1  ON 21
ci_0023                -2.002149e-02 3 1  ON 22
ci_0024                -1.836037e-02 3 1  ON 23
ci_0025                -1.869090e-02 3 1  ON 24
ci_0026                -1.780388e-02 3 1  ON 25
ci_0027                -1.782093e-02 3 1  ON 26
ci_0028                -1.739321e-02 3 1  ON 27
ci_0029                -1.494104e-02 3 1  ON 28
ci_0030                -1.636468e-02 3 1  ON 29
ci_0031                 1.528415e-02 3 1  ON 30
ci_0032                 1.448141e-02 3 1  ON 31
ci_0033                 1.672001e-02 3 1  ON 32
ci_0034                 1.586494e-02 3 1  ON 33
ci_0035                 1.709653e-02 3 1  ON 34
ci_0036                 1.721869e-02 3 1  ON 35
ci_0037                -1.546548e-02 3 1  ON 36
ci_0038                -1.405850e-02 3 1  ON 37
ci_0039                -1.569972e-02 3 1  ON 38
ci_0040                -1.523410e-02 3 1  ON 39
ci_0041                 1.627855e-02 3 1  ON 40
ci_0042                 1.555227e-02 3 1  ON 41
ci_0043                -1.463253e-02 3 1  ON 42
ci_0044                -1.587392e-02 3 1  ON 43
ci_0045                 1.522783e-02 3 1  ON 44
ci_0046                 1.573394e-02 3 1  ON 45
ci_0047                -1.469249e-02 3 1  ON 46
ci_0048                -1.404323e-02 3 1  ON 47
ci_0049                -1.269780e-02 3 1  ON 48
ci_0050                -1.264254e-02 3 1  ON 49
ci_0051                -1.316664e-02 3 1  ON 50
ci_0052                -1.241208e-02 3 1  ON 51
ci_0053                -1.337623e-02 3 1  ON 52
ci_0054                -1.223859e-02 3 1  ON 53
ci_0055                 1.340371e-02 3 1  ON 54
ci_0056                 1.338154e-02 3 1  ON 55
ci_0057                 1.365251e-02 3 1  ON 56
ci_0058                 1.280697e-02 3 1  ON 57
ci_0059                -1.354365e-02 3 1  ON 58
ci_0060                -1.227310e-02 3 1  ON 59
ci_0061                -1.299013e-02 3 1  ON 60
ci_0062                -1.245954e-02 3 1  ON 61
ci_0063                -1.184357e-02 3 1  ON 62
ci_0064                -1.113263e-02 3 1  ON 63
ci_0065                -1.137170e-02 3 1  ON 64
ci_0066                -1.130453e-02 3 1  ON 65
ci_0067                -1.164564e-02 3 1  ON 66
ci_0068                -1.045004e-02 3 1  ON 67
ci_0069                 1.123004e-02 3 1  ON 68
ci_0070                 1.001862e-02 3 1  ON 69
ci_0071                 9.909353e-03 3 1  ON 70
ci_0072                 1.013974e-02 3 1  ON 71
ci_0073                 1.122006e-02 3 1  ON 72
ci_0074                 1.067199e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0294e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6686e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.6399
    reference variance = 1.56493
====================================================
  Execution time = 1.3052e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0274e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5174e+00
  Total weights = 1.945405359e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1685e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.541266825172
                                         uncertainty =       0.021864975219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.541266825172
                                         uncertainty =       0.021864975219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127212676
  error estimate for blocks of size 2^( 2) =       0.001165011843
  error estimate for blocks of size 2^( 3) =       0.001197657829
  error estimate for blocks of size 2^( 4) =       0.001220367129
  error estimate for blocks of size 2^( 5) =       0.001232623685
  error estimate for blocks of size 2^( 6) =       0.001239839967
  error estimate for blocks of size 2^( 7) =       0.001246113968

      target function =                  N/A
              le_mean =     -16.716628824432
             les_mean =     281.963106122138
             stat err =       0.001234736187
             autocorr =       1.199876713113
              std dev =       1.594144960401
             le_variance =       2.541298154772


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671662882443e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716628823508       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716632006360       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716632027507       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+00 is 4.775059e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716628823508       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716629634863       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716629640748       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+01 is 1.212818e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716628823508       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716629027348       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716629028861       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+02 is 3.044218e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.326676 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6227e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.067797e-01 3 1  ON 0
ci_0002                 6.798392e-01 3 1  ON 1
ci_0003                -4.816834e-02 3 1  ON 2
ci_0004                -4.639398e-02 3 1  ON 3
ci_0005                -4.606136e-02 3 1  ON 4
ci_0006                -4.354341e-02 3 1  ON 5
ci_0007                -3.118734e-02 3 1  ON 6
ci_0008                -3.144137e-02 3 1  ON 7
ci_0009                -3.238908e-02 3 1  ON 8
ci_0010                -3.067024e-02 3 1  ON 9
ci_0011                -2.691873e-02 3 1  ON 10
ci_0012                -2.576478e-02 3 1  ON 11
ci_0013                 2.740809e-02 3 1  ON 12
ci_0014                 2.707214e-02 3 1  ON 13
ci_0015                 2.756858e-02 3 1  ON 14
ci_0016                 2.647740e-02 3 1  ON 15
ci_0017                 2.484715e-02 3 1  ON 16
ci_0018                 2.340934e-02 3 1  ON 17
ci_0019                 2.064035e-02 3 1  ON 18
ci_0020                 1.930682e-02 3 1  ON 19
ci_0021                 1.845047e-02 3 1  ON 20
ci_0022                 1.853315e-02 3 1  ON 21
ci_0023                -2.002646e-02 3 1  ON 22
ci_0024                -1.836211e-02 3 1  ON 23
ci_0025                -1.869119e-02 3 1  ON 24
ci_0026                -1.779508e-02 3 1  ON 25
ci_0027                -1.781194e-02 3 1  ON 26
ci_0028                -1.739445e-02 3 1  ON 27
ci_0029                -1.494730e-02 3 1  ON 28
ci_0030                -1.636191e-02 3 1  ON 29
ci_0031                 1.528350e-02 3 1  ON 30
ci_0032                 1.448399e-02 3 1  ON 31
ci_0033                 1.671535e-02 3 1  ON 32
ci_0034                 1.586407e-02 3 1  ON 33
ci_0035                 1.710866e-02 3 1  ON 34
ci_0036                 1.721515e-02 3 1  ON 35
ci_0037                -1.546462e-02 3 1  ON 36
ci_0038                -1.406570e-02 3 1  ON 37
ci_0039                -1.570378e-02 3 1  ON 38
ci_0040                -1.524229e-02 3 1  ON 39
ci_0041                 1.628043e-02 3 1  ON 40
ci_0042                 1.554874e-02 3 1  ON 41
ci_0043                -1.462925e-02 3 1  ON 42
ci_0044                -1.586878e-02 3 1  ON 43
ci_0045                 1.522902e-02 3 1  ON 44
ci_0046                 1.572713e-02 3 1  ON 45
ci_0047                -1.468861e-02 3 1  ON 46
ci_0048                -1.403711e-02 3 1  ON 47
ci_0049                -1.268754e-02 3 1  ON 48
ci_0050                -1.264662e-02 3 1  ON 49
ci_0051                -1.316891e-02 3 1  ON 50
ci_0052                -1.241524e-02 3 1  ON 51
ci_0053                -1.337398e-02 3 1  ON 52
ci_0054                -1.224402e-02 3 1  ON 53
ci_0055                 1.339867e-02 3 1  ON 54
ci_0056                 1.337451e-02 3 1  ON 55
ci_0057                 1.364745e-02 3 1  ON 56
ci_0058                 1.281656e-02 3 1  ON 57
ci_0059                -1.353331e-02 3 1  ON 58
ci_0060                -1.228365e-02 3 1  ON 59
ci_0061                -1.298640e-02 3 1  ON 60
ci_0062                -1.246984e-02 3 1  ON 61
ci_0063                -1.184679e-02 3 1  ON 62
ci_0064                -1.113641e-02 3 1  ON 63
ci_0065                -1.137373e-02 3 1  ON 64
ci_0066                -1.129595e-02 3 1  ON 65
ci_0067                -1.163534e-02 3 1  ON 66
ci_0068                -1.044961e-02 3 1  ON 67
ci_0069                 1.123005e-02 3 1  ON 68
ci_0070                 1.002600e-02 3 1  ON 69
ci_0071                 9.911493e-03 3 1  ON 70
ci_0072                 1.013712e-02 3 1  ON 71
ci_0073                 1.121999e-02 3 1  ON 72
ci_0074                 1.066855e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.7421
    reference variance = 3.013
====================================================
  Execution time = 1.2846e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5289e+00
  Total weights = 1.9457e+06
  Execution time = 2.2024e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553669114395
                                         uncertainty =       0.026556018651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553669114395
                                         uncertainty =       0.026556018651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130450524
  error estimate for blocks of size 2^( 2) =       0.001169526513
  error estimate for blocks of size 2^( 3) =       0.001201514901
  error estimate for blocks of size 2^( 4) =       0.001221663546
  error estimate for blocks of size 2^( 5) =       0.001238968563
  error estimate for blocks of size 2^( 6) =       0.001249931928
  error estimate for blocks of size 2^( 7) =       0.001256057032

      target function =                  N/A
              le_mean =     -16.717833424382
             les_mean =     282.014805521378
             stat err =       0.001241655268
             autocorr =       1.206421175277
              std dev =       1.598724042018
             le_variance =       2.555918562527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553663969053
                                         uncertainty =       0.026555957712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553663969053
                                         uncertainty =       0.026555957712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130449368
  error estimate for blocks of size 2^( 2) =       0.001169525976
  error estimate for blocks of size 2^( 3) =       0.001201513444
  error estimate for blocks of size 2^( 4) =       0.001221662415
  error estimate for blocks of size 2^( 5) =       0.001238967159
  error estimate for blocks of size 2^( 6) =       0.001249928531
  error estimate for blocks of size 2^( 7) =       0.001256054408

      target function =                  N/A
              le_mean =     -16.717833601309
             les_mean =     282.014863922803
             stat err =       0.001241653128
             autocorr =       1.206419486620
              std dev =       1.598722406046
             le_variance =       2.555913331595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553666353292
                                         uncertainty =       0.026555990648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553666353292
                                         uncertainty =       0.026555990648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130449904
  error estimate for blocks of size 2^( 2) =       0.001169526210
  error estimate for blocks of size 2^( 3) =       0.001201514130
  error estimate for blocks of size 2^( 4) =       0.001221662938
  error estimate for blocks of size 2^( 5) =       0.001238967814
  error estimate for blocks of size 2^( 6) =       0.001249930164
  error estimate for blocks of size 2^( 7) =       0.001256055666

      target function =                  N/A
              le_mean =     -16.717833494425
             les_mean =     282.014820250127
             stat err =       0.001241654145
             autocorr =       1.206420318784
              std dev =       1.598723164769
             le_variance =       2.555915757569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553668749664
                                         uncertainty =       0.026556015276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553668749664
                                         uncertainty =       0.026556015276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130450442
  error estimate for blocks of size 2^( 2) =       0.001169526471
  error estimate for blocks of size 2^( 3) =       0.001201514800
  error estimate for blocks of size 2^( 4) =       0.001221663466
  error estimate for blocks of size 2^( 5) =       0.001238968465
  error estimate for blocks of size 2^( 6) =       0.001249931703
  error estimate for blocks of size 2^( 7) =       0.001256056857

      target function =                  N/A
              le_mean =     -16.717833430965
             les_mean =     282.014806309815
             stat err =       0.001241655123
             autocorr =       1.206421068657
              std dev =       1.598723926228
             le_variance =       2.555918192293


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717833424382        initial
     9.5367e+00     9.5367e+01             4.7751e-05       -16.717833601309  <--
     3.8147e+01     3.8147e+02             1.2128e-05       -16.717833494425
     1.5259e+02     1.5259e+03             3.0442e-06       -16.717833430965

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 2.7100e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.067787e-01 3 1  ON 0
ci_0002                 6.798400e-01 3 1  ON 1
ci_0003                -4.817808e-02 3 1  ON 2
ci_0004                -4.641054e-02 3 1  ON 3
ci_0005                -4.607492e-02 3 1  ON 4
ci_0006                -4.355061e-02 3 1  ON 5
ci_0007                -3.119372e-02 3 1  ON 6
ci_0008                -3.146395e-02 3 1  ON 7
ci_0009                -3.239406e-02 3 1  ON 8
ci_0010                -3.068453e-02 3 1  ON 9
ci_0011                -2.691351e-02 3 1  ON 10
ci_0012                -2.574442e-02 3 1  ON 11
ci_0013                 2.739447e-02 3 1  ON 12
ci_0014                 2.705113e-02 3 1  ON 13
ci_0015                 2.755942e-02 3 1  ON 14
ci_0016                 2.647552e-02 3 1  ON 15
ci_0017                 2.483787e-02 3 1  ON 16
ci_0018                 2.341034e-02 3 1  ON 17
ci_0019                 2.062730e-02 3 1  ON 18
ci_0020                 1.928702e-02 3 1  ON 19
ci_0021                 1.845868e-02 3 1  ON 20
ci_0022                 1.852273e-02 3 1  ON 21
ci_0023                -2.004104e-02 3 1  ON 22
ci_0024                -1.836723e-02 3 1  ON 23
ci_0025                -1.869209e-02 3 1  ON 24
ci_0026                -1.776939e-02 3 1  ON 25
ci_0027                -1.778563e-02 3 1  ON 26
ci_0028                -1.739806e-02 3 1  ON 27
ci_0029                -1.496570e-02 3 1  ON 28
ci_0030                -1.635383e-02 3 1  ON 29
ci_0031                 1.528165e-02 3 1  ON 30
ci_0032                 1.449160e-02 3 1  ON 31
ci_0033                 1.670150e-02 3 1  ON 32
ci_0034                 1.586153e-02 3 1  ON 33
ci_0035                 1.714428e-02 3 1  ON 34
ci_0036                 1.720478e-02 3 1  ON 35
ci_0037                -1.546209e-02 3 1  ON 36
ci_0038                -1.408687e-02 3 1  ON 37
ci_0039                -1.571549e-02 3 1  ON 38
ci_0040                -1.526595e-02 3 1  ON 39
ci_0041                 1.628586e-02 3 1  ON 40
ci_0042                 1.553838e-02 3 1  ON 41
ci_0043                -1.461953e-02 3 1  ON 42
ci_0044                -1.585350e-02 3 1  ON 43
ci_0045                 1.523250e-02 3 1  ON 44
ci_0046                 1.570705e-02 3 1  ON 45
ci_0047                -1.467745e-02 3 1  ON 46
ci_0048                -1.401942e-02 3 1  ON 47
ci_0049                -1.265752e-02 3 1  ON 48
ci_0050                -1.265861e-02 3 1  ON 49
ci_0051                -1.317541e-02 3 1  ON 50
ci_0052                -1.242442e-02 3 1  ON 51
ci_0053                -1.336746e-02 3 1  ON 52
ci_0054                -1.225978e-02 3 1  ON 53
ci_0055                 1.338379e-02 3 1  ON 54
ci_0056                 1.335381e-02 3 1  ON 55
ci_0057                 1.363267e-02 3 1  ON 56
ci_0058                 1.284470e-02 3 1  ON 57
ci_0059                -1.350331e-02 3 1  ON 58
ci_0060                -1.231432e-02 3 1  ON 59
ci_0061                -1.297545e-02 3 1  ON 60
ci_0062                -1.250006e-02 3 1  ON 61
ci_0063                -1.185618e-02 3 1  ON 62
ci_0064                -1.114743e-02 3 1  ON 63
ci_0065                -1.137963e-02 3 1  ON 64
ci_0066                -1.127088e-02 3 1  ON 65
ci_0067                -1.160556e-02 3 1  ON 66
ci_0068                -1.044831e-02 3 1  ON 67
ci_0069                 1.123012e-02 3 1  ON 68
ci_0070                 1.004732e-02 3 1  ON 69
ci_0071                 9.917697e-03 3 1  ON 70
ci_0072                 1.012947e-02 3 1  ON 71
ci_0073                 1.121980e-02 3 1  ON 72
ci_0074                 1.065855e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3333e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6686e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.7986
    reference variance = 2.0286
====================================================
  Execution time = 1.3166e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0274e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.4912e+00
  Total weights = 1.945949840e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1884e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.519617199538
                                         uncertainty =       0.025749253719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.519617199538
                                         uncertainty =       0.025749253719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122290301
  error estimate for blocks of size 2^( 2) =       0.001160775118
  error estimate for blocks of size 2^( 3) =       0.001193833085
  error estimate for blocks of size 2^( 4) =       0.001217868462
  error estimate for blocks of size 2^( 5) =       0.001231964606
  error estimate for blocks of size 2^( 6) =       0.001241090343
  error estimate for blocks of size 2^( 7) =       0.001243652088

      target function =                  N/A
              le_mean =     -16.719583363603
             les_mean =     282.035645654537
             stat err =       0.001233643875
             autocorr =       1.208284471423
              std dev =       1.587183558621
             le_variance =       2.519151648758


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671958336360e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719583362686       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719589378861       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719589396546       residual = 8.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+00 is 1.330204e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719583362686       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719584966900       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719584966760       residual = 6.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+00 is 3.477003e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719583362686       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719583770530       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719583770233       residual = 6.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+01 is 8.793654e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.327856 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6360e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.067718e-01 3 1  ON 0
ci_0002                 6.798431e-01 3 1  ON 1
ci_0003                -4.815101e-02 3 1  ON 2
ci_0004                -4.641745e-02 3 1  ON 3
ci_0005                -4.607597e-02 3 1  ON 4
ci_0006                -4.357998e-02 3 1  ON 5
ci_0007                -3.121718e-02 3 1  ON 6
ci_0008                -3.146769e-02 3 1  ON 7
ci_0009                -3.240307e-02 3 1  ON 8
ci_0010                -3.070598e-02 3 1  ON 9
ci_0011                -2.693496e-02 3 1  ON 10
ci_0012                -2.575720e-02 3 1  ON 11
ci_0013                 2.740643e-02 3 1  ON 12
ci_0014                 2.704266e-02 3 1  ON 13
ci_0015                 2.756385e-02 3 1  ON 14
ci_0016                 2.647756e-02 3 1  ON 15
ci_0017                 2.481107e-02 3 1  ON 16
ci_0018                 2.340058e-02 3 1  ON 17
ci_0019                 2.061162e-02 3 1  ON 18
ci_0020                 1.931479e-02 3 1  ON 19
ci_0021                 1.845409e-02 3 1  ON 20
ci_0022                 1.852349e-02 3 1  ON 21
ci_0023                -2.002703e-02 3 1  ON 22
ci_0024                -1.837357e-02 3 1  ON 23
ci_0025                -1.869837e-02 3 1  ON 24
ci_0026                -1.777839e-02 3 1  ON 25
ci_0027                -1.779315e-02 3 1  ON 26
ci_0028                -1.741448e-02 3 1  ON 27
ci_0029                -1.497104e-02 3 1  ON 28
ci_0030                -1.636544e-02 3 1  ON 29
ci_0031                 1.526741e-02 3 1  ON 30
ci_0032                 1.446446e-02 3 1  ON 31
ci_0033                 1.667519e-02 3 1  ON 32
ci_0034                 1.585139e-02 3 1  ON 33
ci_0035                 1.716851e-02 3 1  ON 34
ci_0036                 1.720929e-02 3 1  ON 35
ci_0037                -1.544313e-02 3 1  ON 36
ci_0038                -1.411043e-02 3 1  ON 37
ci_0039                -1.570436e-02 3 1  ON 38
ci_0040                -1.525826e-02 3 1  ON 39
ci_0041                 1.627773e-02 3 1  ON 40
ci_0042                 1.553767e-02 3 1  ON 41
ci_0043                -1.460516e-02 3 1  ON 42
ci_0044                -1.586306e-02 3 1  ON 43
ci_0045                 1.524990e-02 3 1  ON 44
ci_0046                 1.567228e-02 3 1  ON 45
ci_0047                -1.468487e-02 3 1  ON 46
ci_0048                -1.403911e-02 3 1  ON 47
ci_0049                -1.268595e-02 3 1  ON 48
ci_0050                -1.264327e-02 3 1  ON 49
ci_0051                -1.319245e-02 3 1  ON 50
ci_0052                -1.241484e-02 3 1  ON 51
ci_0053                -1.335716e-02 3 1  ON 52
ci_0054                -1.225778e-02 3 1  ON 53
ci_0055                 1.340856e-02 3 1  ON 54
ci_0056                 1.333426e-02 3 1  ON 55
ci_0057                 1.362095e-02 3 1  ON 56
ci_0058                 1.284849e-02 3 1  ON 57
ci_0059                -1.349210e-02 3 1  ON 58
ci_0060                -1.232956e-02 3 1  ON 59
ci_0061                -1.297059e-02 3 1  ON 60
ci_0062                -1.249054e-02 3 1  ON 61
ci_0063                -1.183998e-02 3 1  ON 62
ci_0064                -1.113935e-02 3 1  ON 63
ci_0065                -1.139921e-02 3 1  ON 64
ci_0066                -1.126502e-02 3 1  ON 65
ci_0067                -1.161876e-02 3 1  ON 66
ci_0068                -1.045387e-02 3 1  ON 67
ci_0069                 1.123672e-02 3 1  ON 68
ci_0070                 1.003782e-02 3 1  ON 69
ci_0071                 9.942557e-03 3 1  ON 70
ci_0072                 1.014502e-02 3 1  ON 71
ci_0073                 1.120385e-02 3 1  ON 72
ci_0074                 1.068421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.5351
    reference variance = 1.99204
====================================================
  Execution time = 1.2775e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.6047e+00
  Total weights = 1.9451e+06
  Execution time = 2.2804e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.635797783363
                                         uncertainty =       0.054625304813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.635797783363
                                         uncertainty =       0.054625304813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001147951964
  error estimate for blocks of size 2^( 2) =       0.001185475972
  error estimate for blocks of size 2^( 3) =       0.001218066846
  error estimate for blocks of size 2^( 4) =       0.001242487291
  error estimate for blocks of size 2^( 5) =       0.001256935923
  error estimate for blocks of size 2^( 6) =       0.001265066180
  error estimate for blocks of size 2^( 7) =       0.001262068756

      target function =                  N/A
              le_mean =     -16.717258364532
             les_mean =     282.071346374567
             stat err =       0.001256639537
             autocorr =       1.198323313748
              std dev =       1.623475211213
             le_variance =       2.635671761424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.635936122585
                                         uncertainty =       0.054623152322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.635936122585
                                         uncertainty =       0.054623152322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001147982277
  error estimate for blocks of size 2^( 2) =       0.001185499775
  error estimate for blocks of size 2^( 3) =       0.001218084427
  error estimate for blocks of size 2^( 4) =       0.001242504440
  error estimate for blocks of size 2^( 5) =       0.001256950622
  error estimate for blocks of size 2^( 6) =       0.001265078276
  error estimate for blocks of size 2^( 7) =       0.001262075025

      target function =                  N/A
              le_mean =     -16.717258598051
             les_mean =     282.073811817996
             stat err =       0.001256652091
             autocorr =       1.198283969665
              std dev =       1.623518081321
             le_variance =       2.635810960375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.635871204403
                                         uncertainty =       0.054624150145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.635871204403
                                         uncertainty =       0.054624150145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001147968053
  error estimate for blocks of size 2^( 2) =       0.001185488650
  error estimate for blocks of size 2^( 3) =       0.001218076260
  error estimate for blocks of size 2^( 4) =       0.001242496452
  error estimate for blocks of size 2^( 5) =       0.001256943625
  error estimate for blocks of size 2^( 6) =       0.001265072526
  error estimate for blocks of size 2^( 7) =       0.001262072067

      target function =                  N/A
              le_mean =     -16.717258273853
             les_mean =     282.071503868187
             stat err =       0.001256646168
             autocorr =       1.198302368147
              std dev =       1.623497965476
             le_variance =       2.635745643905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.635807008447
                                         uncertainty =       0.054625158352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.635807008447
                                         uncertainty =       0.054625158352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001147953986
  error estimate for blocks of size 2^( 2) =       0.001185477557
  error estimate for blocks of size 2^( 3) =       0.001218068022
  error estimate for blocks of size 2^( 4) =       0.001242488433
  error estimate for blocks of size 2^( 5) =       0.001256936879
  error estimate for blocks of size 2^( 6) =       0.001265066958
  error estimate for blocks of size 2^( 7) =       0.001262069146

      target function =                  N/A
              le_mean =     -16.717258333494
             les_mean =     282.071336315069
             stat err =       0.001256640354
             autocorr =       1.198320650414
              std dev =       1.623478070462
             le_variance =       2.635681045270


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717258364532        initial
     2.3842e+00     2.3842e+01             1.3302e-04       -16.717258598051  <--
     9.5367e+00     9.5367e+01             3.4770e-05       -16.717258273853
     3.8147e+01     3.8147e+02             8.7937e-06       -16.717258333494

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 2.4294e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.067509e-01 3 1  ON 0
ci_0002                 6.798536e-01 3 1  ON 1
ci_0003                -4.807544e-02 3 1  ON 2
ci_0004                -4.643621e-02 3 1  ON 3
ci_0005                -4.607915e-02 3 1  ON 4
ci_0006                -4.366354e-02 3 1  ON 5
ci_0007                -3.128476e-02 3 1  ON 6
ci_0008                -3.147829e-02 3 1  ON 7
ci_0009                -3.242746e-02 3 1  ON 8
ci_0010                -3.076402e-02 3 1  ON 9
ci_0011                -2.699452e-02 3 1  ON 10
ci_0012                -2.579180e-02 3 1  ON 11
ci_0013                 2.743930e-02 3 1  ON 12
ci_0014                 2.701863e-02 3 1  ON 13
ci_0015                 2.757646e-02 3 1  ON 14
ci_0016                 2.648243e-02 3 1  ON 15
ci_0017                 2.473821e-02 3 1  ON 16
ci_0018                 2.337307e-02 3 1  ON 17
ci_0019                 2.056908e-02 3 1  ON 18
ci_0020                 1.939042e-02 3 1  ON 19
ci_0021                 1.844061e-02 3 1  ON 20
ci_0022                 1.852620e-02 3 1  ON 21
ci_0023                -1.998873e-02 3 1  ON 22
ci_0024                -1.839034e-02 3 1  ON 23
ci_0025                -1.871503e-02 3 1  ON 24
ci_0026                -1.780308e-02 3 1  ON 25
ci_0027                -1.781384e-02 3 1  ON 26
ci_0028                -1.745926e-02 3 1  ON 27
ci_0029                -1.498559e-02 3 1  ON 28
ci_0030                -1.639716e-02 3 1  ON 29
ci_0031                 1.522776e-02 3 1  ON 30
ci_0032                 1.438769e-02 3 1  ON 31
ci_0033                 1.660019e-02 3 1  ON 32
ci_0034                 1.582241e-02 3 1  ON 33
ci_0035                 1.723512e-02 3 1  ON 34
ci_0036                 1.722194e-02 3 1  ON 35
ci_0037                -1.539031e-02 3 1  ON 36
ci_0038                -1.417630e-02 3 1  ON 37
ci_0039                -1.567559e-02 3 1  ON 38
ci_0040                -1.523828e-02 3 1  ON 39
ci_0041                 1.625530e-02 3 1  ON 40
ci_0042                 1.553587e-02 3 1  ON 41
ci_0043                -1.456381e-02 3 1  ON 42
ci_0044                -1.588987e-02 3 1  ON 43
ci_0045                 1.529867e-02 3 1  ON 44
ci_0046                 1.557403e-02 3 1  ON 45
ci_0047                -1.470423e-02 3 1  ON 46
ci_0048                -1.409040e-02 3 1  ON 47
ci_0049                -1.276365e-02 3 1  ON 48
ci_0050                -1.260097e-02 3 1  ON 49
ci_0051                -1.323714e-02 3 1  ON 50
ci_0052                -1.238965e-02 3 1  ON 51
ci_0053                -1.333021e-02 3 1  ON 52
ci_0054                -1.225242e-02 3 1  ON 53
ci_0055                 1.347828e-02 3 1  ON 54
ci_0056                 1.327930e-02 3 1  ON 55
ci_0057                 1.358853e-02 3 1  ON 56
ci_0058                 1.285901e-02 3 1  ON 57
ci_0059                -1.346224e-02 3 1  ON 58
ci_0060                -1.236922e-02 3 1  ON 59
ci_0061                -1.295725e-02 3 1  ON 60
ci_0062                -1.246424e-02 3 1  ON 61
ci_0063                -1.179753e-02 3 1  ON 62
ci_0064                -1.111752e-02 3 1  ON 63
ci_0065                -1.145265e-02 3 1  ON 64
ci_0066                -1.124969e-02 3 1  ON 65
ci_0067                -1.165371e-02 3 1  ON 66
ci_0068                -1.046856e-02 3 1  ON 67
ci_0069                 1.125424e-02 3 1  ON 68
ci_0070                 1.001296e-02 3 1  ON 69
ci_0071                 1.001055e-02 3 1  ON 70
ci_0072                 1.018804e-02 3 1  ON 71
ci_0073                 1.116264e-02 3 1  ON 72
ci_0074                 1.075055e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0661e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6685e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.6994
    reference variance = 2.21557
====================================================
  Execution time = 1.3093e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0249e+04
  VMC Eavg = -1.6721e+01
  VMC Evar = 2.4956e+00
  Total weights = 1.945349165e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2649e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.525314750019
                                         uncertainty =       0.024643432110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.525314750019
                                         uncertainty =       0.024643432110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001123696755
  error estimate for blocks of size 2^( 2) =       0.001162345949
  error estimate for blocks of size 2^( 3) =       0.001195564539
  error estimate for blocks of size 2^( 4) =       0.001218369303
  error estimate for blocks of size 2^( 5) =       0.001229324022
  error estimate for blocks of size 2^( 6) =       0.001232716186
  error estimate for blocks of size 2^( 7) =       0.001236372720

      target function =                  N/A
              le_mean =     -16.720735214427
             les_mean =     282.078572678365
             stat err =       0.001229195558
             autocorr =       1.196585431356
              std dev =       1.589172616463
             le_variance =       2.525469604916


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.672073521443e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720735213507       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720761063224       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720760172230       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.720760226059       residual = 1.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e-01 is 4.872686e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720735213507       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720743551833       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720743399473       residual = 1.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+00 is 1.656096e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720735213507       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720737461201       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720737436602       residual = 2.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+00 is 4.534065e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.329159 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6364e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.068086e-01 3 1  ON 0
ci_0002                 6.798087e-01 3 1  ON 1
ci_0003                -4.819108e-02 3 1  ON 2
ci_0004                -4.638570e-02 3 1  ON 3
ci_0005                -4.607159e-02 3 1  ON 4
ci_0006                -4.371898e-02 3 1  ON 5
ci_0007                -3.137134e-02 3 1  ON 6
ci_0008                -3.146376e-02 3 1  ON 7
ci_0009                -3.232381e-02 3 1  ON 8
ci_0010                -3.073783e-02 3 1  ON 9
ci_0011                -2.699375e-02 3 1  ON 10
ci_0012                -2.578308e-02 3 1  ON 11
ci_0013                 2.743789e-02 3 1  ON 12
ci_0014                 2.688988e-02 3 1  ON 13
ci_0015                 2.749085e-02 3 1  ON 14
ci_0016                 2.642976e-02 3 1  ON 15
ci_0017                 2.467343e-02 3 1  ON 16
ci_0018                 2.332895e-02 3 1  ON 17
ci_0019                 2.058518e-02 3 1  ON 18
ci_0020                 1.939624e-02 3 1  ON 19
ci_0021                 1.840957e-02 3 1  ON 20
ci_0022                 1.842881e-02 3 1  ON 21
ci_0023                -1.986820e-02 3 1  ON 22
ci_0024                -1.835697e-02 3 1  ON 23
ci_0025                -1.869400e-02 3 1  ON 24
ci_0026                -1.785764e-02 3 1  ON 25
ci_0027                -1.775730e-02 3 1  ON 26
ci_0028                -1.737253e-02 3 1  ON 27
ci_0029                -1.500982e-02 3 1  ON 28
ci_0030                -1.629057e-02 3 1  ON 29
ci_0031                 1.522002e-02 3 1  ON 30
ci_0032                 1.443362e-02 3 1  ON 31
ci_0033                 1.658547e-02 3 1  ON 32
ci_0034                 1.574773e-02 3 1  ON 33
ci_0035                 1.721402e-02 3 1  ON 34
ci_0036                 1.725800e-02 3 1  ON 35
ci_0037                -1.544610e-02 3 1  ON 36
ci_0038                -1.427246e-02 3 1  ON 37
ci_0039                -1.566425e-02 3 1  ON 38
ci_0040                -1.527797e-02 3 1  ON 39
ci_0041                 1.626774e-02 3 1  ON 40
ci_0042                 1.553070e-02 3 1  ON 41
ci_0043                -1.464496e-02 3 1  ON 42
ci_0044                -1.578898e-02 3 1  ON 43
ci_0045                 1.528782e-02 3 1  ON 44
ci_0046                 1.552031e-02 3 1  ON 45
ci_0047                -1.477857e-02 3 1  ON 46
ci_0048                -1.417816e-02 3 1  ON 47
ci_0049                -1.278495e-02 3 1  ON 48
ci_0050                -1.267501e-02 3 1  ON 49
ci_0051                -1.326463e-02 3 1  ON 50
ci_0052                -1.241383e-02 3 1  ON 51
ci_0053                -1.322125e-02 3 1  ON 52
ci_0054                -1.226995e-02 3 1  ON 53
ci_0055                 1.343580e-02 3 1  ON 54
ci_0056                 1.331903e-02 3 1  ON 55
ci_0057                 1.347608e-02 3 1  ON 56
ci_0058                 1.274240e-02 3 1  ON 57
ci_0059                -1.341205e-02 3 1  ON 58
ci_0060                -1.243499e-02 3 1  ON 59
ci_0061                -1.292612e-02 3 1  ON 60
ci_0062                -1.249573e-02 3 1  ON 61
ci_0063                -1.196314e-02 3 1  ON 62
ci_0064                -1.117682e-02 3 1  ON 63
ci_0065                -1.148740e-02 3 1  ON 64
ci_0066                -1.117962e-02 3 1  ON 65
ci_0067                -1.161232e-02 3 1  ON 66
ci_0068                -1.051139e-02 3 1  ON 67
ci_0069                 1.115321e-02 3 1  ON 68
ci_0070                 1.017438e-02 3 1  ON 69
ci_0071                 1.004381e-02 3 1  ON 70
ci_0072                 1.030279e-02 3 1  ON 71
ci_0073                 1.116119e-02 3 1  ON 72
ci_0074                 1.074569e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8479
    reference variance = 1.27363
====================================================
  Execution time = 1.2824e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5267e+00
  Total weights = 1.9459e+06
  Execution time = 2.2843e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556098464748
                                         uncertainty =       0.030313911248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556098464748
                                         uncertainty =       0.030313911248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130341492
  error estimate for blocks of size 2^( 2) =       0.001169945628
  error estimate for blocks of size 2^( 3) =       0.001202834454
  error estimate for blocks of size 2^( 4) =       0.001225934589
  error estimate for blocks of size 2^( 5) =       0.001240044330
  error estimate for blocks of size 2^( 6) =       0.001247380290
  error estimate for blocks of size 2^( 7) =       0.001258641294

      target function =                  N/A
              le_mean =     -16.717317978696
             les_mean =     281.996103500387
             stat err =       0.001243000125
             autocorr =       1.209269238860
              std dev =       1.598569844500
             le_variance =       2.555425547746

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0439342
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556163372910
                                         uncertainty =       0.030313832218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556163372910
                                         uncertainty =       0.030313832218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130355751
  error estimate for blocks of size 2^( 2) =       0.001169966271
  error estimate for blocks of size 2^( 3) =       0.001202866994
  error estimate for blocks of size 2^( 4) =       0.001225964410
  error estimate for blocks of size 2^( 5) =       0.001240082460
  error estimate for blocks of size 2^( 6) =       0.001247401968
  error estimate for blocks of size 2^( 7) =       0.001258673930

      target function =                  N/A
              le_mean =     -16.717315189632
             les_mean =     281.995696897489
             stat err =       0.001243030692
             autocorr =       1.209298203595
              std dev =       1.598590009992
             le_variance =       2.555490020045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556127874781
                                         uncertainty =       0.030314129283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556127874781
                                         uncertainty =       0.030314129283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130347932
  error estimate for blocks of size 2^( 2) =       0.001169955926
  error estimate for blocks of size 2^( 3) =       0.001202853135
  error estimate for blocks of size 2^( 4) =       0.001225952154
  error estimate for blocks of size 2^( 5) =       0.001240068264
  error estimate for blocks of size 2^( 6) =       0.001247393456
  error estimate for blocks of size 2^( 7) =       0.001258659774

      target function =                  N/A
              le_mean =     -16.717315198607
             les_mean =     281.995483394887
             stat err =       0.001243018412
             autocorr =       1.209291039809
              std dev =       1.598578952149
             le_variance =       2.555454666253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556099372280
                                         uncertainty =       0.030313955397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556099372280
                                         uncertainty =       0.030313955397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130341684
  error estimate for blocks of size 2^( 2) =       0.001169946376
  error estimate for blocks of size 2^( 3) =       0.001202836428
  error estimate for blocks of size 2^( 4) =       0.001225936627
  error estimate for blocks of size 2^( 5) =       0.001240047287
  error estimate for blocks of size 2^( 6) =       0.001247381767
  error estimate for blocks of size 2^( 7) =       0.001258643204

      target function =                  N/A
              le_mean =     -16.717317131556
             les_mean =     281.996256069101
             stat err =       0.001243002221
             autocorr =       1.209272905835
              std dev =       1.598570116246
             le_variance =       2.555426416555


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717317978696        initial  <--
     5.9605e-01     5.9605e+00             4.8727e-04       -16.717315189632
     2.3842e+00     2.3842e+01             1.6561e-04       -16.717315198607
     9.5367e+00     9.5367e+01             4.5341e-05       -16.717317131556

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.3795
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.067509e-01 3 1  ON 0
ci_0002                 6.798536e-01 3 1  ON 1
ci_0003                -4.807544e-02 3 1  ON 2
ci_0004                -4.643621e-02 3 1  ON 3
ci_0005                -4.607915e-02 3 1  ON 4
ci_0006                -4.366354e-02 3 1  ON 5
ci_0007                -3.128476e-02 3 1  ON 6
ci_0008                -3.147829e-02 3 1  ON 7
ci_0009                -3.242746e-02 3 1  ON 8
ci_0010                -3.076402e-02 3 1  ON 9
ci_0011                -2.699452e-02 3 1  ON 10
ci_0012                -2.579180e-02 3 1  ON 11
ci_0013                 2.743930e-02 3 1  ON 12
ci_0014                 2.701863e-02 3 1  ON 13
ci_0015                 2.757646e-02 3 1  ON 14
ci_0016                 2.648243e-02 3 1  ON 15
ci_0017                 2.473821e-02 3 1  ON 16
ci_0018                 2.337307e-02 3 1  ON 17
ci_0019                 2.056908e-02 3 1  ON 18
ci_0020                 1.939042e-02 3 1  ON 19
ci_0021                 1.844061e-02 3 1  ON 20
ci_0022                 1.852620e-02 3 1  ON 21
ci_0023                -1.998873e-02 3 1  ON 22
ci_0024                -1.839034e-02 3 1  ON 23
ci_0025                -1.871503e-02 3 1  ON 24
ci_0026                -1.780308e-02 3 1  ON 25
ci_0027                -1.781384e-02 3 1  ON 26
ci_0028                -1.745926e-02 3 1  ON 27
ci_0029                -1.498559e-02 3 1  ON 28
ci_0030                -1.639716e-02 3 1  ON 29
ci_0031                 1.522776e-02 3 1  ON 30
ci_0032                 1.438769e-02 3 1  ON 31
ci_0033                 1.660019e-02 3 1  ON 32
ci_0034                 1.582241e-02 3 1  ON 33
ci_0035                 1.723512e-02 3 1  ON 34
ci_0036                 1.722194e-02 3 1  ON 35
ci_0037                -1.539031e-02 3 1  ON 36
ci_0038                -1.417630e-02 3 1  ON 37
ci_0039                -1.567559e-02 3 1  ON 38
ci_0040                -1.523828e-02 3 1  ON 39
ci_0041                 1.625530e-02 3 1  ON 40
ci_0042                 1.553587e-02 3 1  ON 41
ci_0043                -1.456381e-02 3 1  ON 42
ci_0044                -1.588987e-02 3 1  ON 43
ci_0045                 1.529867e-02 3 1  ON 44
ci_0046                 1.557403e-02 3 1  ON 45
ci_0047                -1.470423e-02 3 1  ON 46
ci_0048                -1.409040e-02 3 1  ON 47
ci_0049                -1.276365e-02 3 1  ON 48
ci_0050                -1.260097e-02 3 1  ON 49
ci_0051                -1.323714e-02 3 1  ON 50
ci_0052                -1.238965e-02 3 1  ON 51
ci_0053                -1.333021e-02 3 1  ON 52
ci_0054                -1.225242e-02 3 1  ON 53
ci_0055                 1.347828e-02 3 1  ON 54
ci_0056                 1.327930e-02 3 1  ON 55
ci_0057                 1.358853e-02 3 1  ON 56
ci_0058                 1.285901e-02 3 1  ON 57
ci_0059                -1.346224e-02 3 1  ON 58
ci_0060                -1.236922e-02 3 1  ON 59
ci_0061                -1.295725e-02 3 1  ON 60
ci_0062                -1.246424e-02 3 1  ON 61
ci_0063                -1.179753e-02 3 1  ON 62
ci_0064                -1.111752e-02 3 1  ON 63
ci_0065                -1.145265e-02 3 1  ON 64
ci_0066                -1.124969e-02 3 1  ON 65
ci_0067                -1.165371e-02 3 1  ON 66
ci_0068                -1.046856e-02 3 1  ON 67
ci_0069                 1.125424e-02 3 1  ON 68
ci_0070                 1.001296e-02 3 1  ON 69
ci_0071                 1.001055e-02 3 1  ON 70
ci_0072                 1.018804e-02 3 1  ON 71
ci_0073                 1.116264e-02 3 1  ON 72
ci_0074                 1.075055e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0753e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6689e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1559
    reference variance = 3.48108
====================================================
  Execution time = 1.3145e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0227e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.4989e+00
  Total weights = 1.945447824e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2299e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.526947088830
                                         uncertainty =       0.023740672358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.526947088830
                                         uncertainty =       0.023740672358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001123869726
  error estimate for blocks of size 2^( 2) =       0.001163373583
  error estimate for blocks of size 2^( 3) =       0.001197067860
  error estimate for blocks of size 2^( 4) =       0.001222195590
  error estimate for blocks of size 2^( 5) =       0.001237567924
  error estimate for blocks of size 2^( 6) =       0.001248809893
  error estimate for blocks of size 2^( 7) =       0.001256751578

      target function =                  N/A
              le_mean =     -16.718158277329
             les_mean =     281.995735422915
             stat err =       0.001241331246
             autocorr =       1.219953928050
              std dev =       1.589417238290
             le_variance =       2.526247157374


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671815827733e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718158276423       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718160054479       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718160163296       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718160162259       residual = 3.50e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+00 is 9.439036e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718158276423       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718158733185       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718158760320       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718158760040       residual = 3.47e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+01 is 2.395459e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718158276423       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718158391406       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718158398189       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718158398114       residual = 3.58e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+01 is 6.011369e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.332580 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6386e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.067555e-01 3 1  ON 0
ci_0002                 6.798533e-01 3 1  ON 1
ci_0003                -4.807953e-02 3 1  ON 2
ci_0004                -4.643726e-02 3 1  ON 3
ci_0005                -4.607316e-02 3 1  ON 4
ci_0006                -4.365907e-02 3 1  ON 5
ci_0007                -3.128460e-02 3 1  ON 6
ci_0008                -3.147358e-02 3 1  ON 7
ci_0009                -3.243658e-02 3 1  ON 8
ci_0010                -3.076323e-02 3 1  ON 9
ci_0011                -2.700086e-02 3 1  ON 10
ci_0012                -2.580306e-02 3 1  ON 11
ci_0013                 2.743981e-02 3 1  ON 12
ci_0014                 2.700547e-02 3 1  ON 13
ci_0015                 2.756368e-02 3 1  ON 14
ci_0016                 2.647334e-02 3 1  ON 15
ci_0017                 2.472839e-02 3 1  ON 16
ci_0018                 2.337303e-02 3 1  ON 17
ci_0019                 2.055594e-02 3 1  ON 18
ci_0020                 1.939026e-02 3 1  ON 19
ci_0021                 1.844664e-02 3 1  ON 20
ci_0022                 1.851799e-02 3 1  ON 21
ci_0023                -1.997339e-02 3 1  ON 22
ci_0024                -1.838166e-02 3 1  ON 23
ci_0025                -1.871525e-02 3 1  ON 24
ci_0026                -1.780144e-02 3 1  ON 25
ci_0027                -1.782272e-02 3 1  ON 26
ci_0028                -1.744050e-02 3 1  ON 27
ci_0029                -1.499836e-02 3 1  ON 28
ci_0030                -1.639569e-02 3 1  ON 29
ci_0031                 1.523193e-02 3 1  ON 30
ci_0032                 1.438011e-02 3 1  ON 31
ci_0033                 1.662414e-02 3 1  ON 32
ci_0034                 1.582603e-02 3 1  ON 33
ci_0035                 1.722758e-02 3 1  ON 34
ci_0036                 1.721504e-02 3 1  ON 35
ci_0037                -1.536870e-02 3 1  ON 36
ci_0038                -1.417289e-02 3 1  ON 37
ci_0039                -1.566219e-02 3 1  ON 38
ci_0040                -1.523209e-02 3 1  ON 39
ci_0041                 1.625599e-02 3 1  ON 40
ci_0042                 1.554118e-02 3 1  ON 41
ci_0043                -1.455499e-02 3 1  ON 42
ci_0044                -1.587600e-02 3 1  ON 43
ci_0045                 1.530150e-02 3 1  ON 44
ci_0046                 1.556889e-02 3 1  ON 45
ci_0047                -1.469425e-02 3 1  ON 46
ci_0048                -1.409487e-02 3 1  ON 47
ci_0049                -1.277365e-02 3 1  ON 48
ci_0050                -1.260400e-02 3 1  ON 49
ci_0051                -1.322808e-02 3 1  ON 50
ci_0052                -1.239115e-02 3 1  ON 51
ci_0053                -1.333080e-02 3 1  ON 52
ci_0054                -1.224693e-02 3 1  ON 53
ci_0055                 1.347419e-02 3 1  ON 54
ci_0056                 1.328248e-02 3 1  ON 55
ci_0057                 1.358011e-02 3 1  ON 56
ci_0058                 1.284378e-02 3 1  ON 57
ci_0059                -1.346073e-02 3 1  ON 58
ci_0060                -1.238716e-02 3 1  ON 59
ci_0061                -1.296340e-02 3 1  ON 60
ci_0062                -1.245987e-02 3 1  ON 61
ci_0063                -1.179403e-02 3 1  ON 62
ci_0064                -1.111804e-02 3 1  ON 63
ci_0065                -1.145440e-02 3 1  ON 64
ci_0066                -1.125231e-02 3 1  ON 65
ci_0067                -1.164677e-02 3 1  ON 66
ci_0068                -1.047409e-02 3 1  ON 67
ci_0069                 1.124400e-02 3 1  ON 68
ci_0070                 1.001897e-02 3 1  ON 69
ci_0071                 1.000876e-02 3 1  ON 70
ci_0072                 1.017347e-02 3 1  ON 71
ci_0073                 1.115583e-02 3 1  ON 72
ci_0074                 1.074453e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8298
    reference variance = 3.10926
====================================================
  Execution time = 1.2924e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5783e+00
  Total weights = 1.9453e+06
  Execution time = 2.2788e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.604705792504
                                         uncertainty =       0.035104799631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.604705792504
                                         uncertainty =       0.035104799631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001141059242
  error estimate for blocks of size 2^( 2) =       0.001178647330
  error estimate for blocks of size 2^( 3) =       0.001211263145
  error estimate for blocks of size 2^( 4) =       0.001235395439
  error estimate for blocks of size 2^( 5) =       0.001249067140
  error estimate for blocks of size 2^( 6) =       0.001259175383
  error estimate for blocks of size 2^( 7) =       0.001269520684

      target function =                  N/A
              le_mean =     -16.716864991151
             les_mean =     282.031947531553
             stat err =       0.001253289661
             autocorr =       1.206386665250
              std dev =       1.613727275188
             le_variance =       2.604115718685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.604645968395
                                         uncertainty =       0.035105466154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.604645968395
                                         uncertainty =       0.035105466154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001141046184
  error estimate for blocks of size 2^( 2) =       0.001178638446
  error estimate for blocks of size 2^( 3) =       0.001211258369
  error estimate for blocks of size 2^( 4) =       0.001235392793
  error estimate for blocks of size 2^( 5) =       0.001249064202
  error estimate for blocks of size 2^( 6) =       0.001259173411
  error estimate for blocks of size 2^( 7) =       0.001269517528

      target function =                  N/A
              le_mean =     -16.716865413726
             les_mean =     282.031789044955
             stat err =       0.001253286983
             autocorr =       1.206409121821
              std dev =       1.613708807765
             le_variance =       2.604056116260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.604674451985
                                         uncertainty =       0.035105162206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.604674451985
                                         uncertainty =       0.035105162206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001141052401
  error estimate for blocks of size 2^( 2) =       0.001178642681
  error estimate for blocks of size 2^( 3) =       0.001211260628
  error estimate for blocks of size 2^( 4) =       0.001235394043
  error estimate for blocks of size 2^( 5) =       0.001249065596
  error estimate for blocks of size 2^( 6) =       0.001259174409
  error estimate for blocks of size 2^( 7) =       0.001269519127

      target function =                  N/A
              le_mean =     -16.716865141544
             les_mean =     282.031969650795
             stat err =       0.001253288294
             autocorr =       1.206398497983
              std dev =       1.613717600296
             le_variance =       2.604084493506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.604701800432
                                         uncertainty =       0.035104846036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.604701800432
                                         uncertainty =       0.035104846036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001141058371
  error estimate for blocks of size 2^( 2) =       0.001178646734
  error estimate for blocks of size 2^( 3) =       0.001211262815
  error estimate for blocks of size 2^( 4) =       0.001235395245
  error estimate for blocks of size 2^( 5) =       0.001249066923
  error estimate for blocks of size 2^( 6) =       0.001259175238
  error estimate for blocks of size 2^( 7) =       0.001269520477

      target function =                  N/A
              le_mean =     -16.716865000800
             les_mean =     282.031905652848
             stat err =       0.001253289471
             autocorr =       1.206388140548
              std dev =       1.613726042793
             le_variance =       2.604111741189


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716864991151        initial
     5.9605e+00     5.9605e+01             9.4390e-05       -16.716865413726  <--
     2.3842e+01     2.3842e+02             2.3955e-05       -16.716865141544
     9.5367e+01     9.5367e+02             6.0114e-06       -16.716865000800

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 2.4441e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.067689e-01 3 1  ON 0
ci_0002                 6.798520e-01 3 1  ON 1
ci_0003                -4.809146e-02 3 1  ON 2
ci_0004                -4.644043e-02 3 1  ON 3
ci_0005                -4.605571e-02 3 1  ON 4
ci_0006                -4.364592e-02 3 1  ON 5
ci_0007                -3.128415e-02 3 1  ON 6
ci_0008                -3.145968e-02 3 1  ON 7
ci_0009                -3.246294e-02 3 1  ON 8
ci_0010                -3.076115e-02 3 1  ON 9
ci_0011                -2.701937e-02 3 1  ON 10
ci_0012                -2.583577e-02 3 1  ON 11
ci_0013                 2.744121e-02 3 1  ON 12
ci_0014                 2.696750e-02 3 1  ON 13
ci_0015                 2.752662e-02 3 1  ON 14
ci_0016                 2.644719e-02 3 1  ON 15
ci_0017                 2.470019e-02 3 1  ON 16
ci_0018                 2.337298e-02 3 1  ON 17
ci_0019                 2.051808e-02 3 1  ON 18
ci_0020                 1.938992e-02 3 1  ON 19
ci_0021                 1.846431e-02 3 1  ON 20
ci_0022                 1.849371e-02 3 1  ON 21
ci_0023                -1.992929e-02 3 1  ON 22
ci_0024                -1.835671e-02 3 1  ON 23
ci_0025                -1.871599e-02 3 1  ON 24
ci_0026                -1.779663e-02 3 1  ON 25
ci_0027                -1.784859e-02 3 1  ON 26
ci_0028                -1.738646e-02 3 1  ON 27
ci_0029                -1.503543e-02 3 1  ON 28
ci_0030                -1.639141e-02 3 1  ON 29
ci_0031                 1.524416e-02 3 1  ON 30
ci_0032                 1.435783e-02 3 1  ON 31
ci_0033                 1.669458e-02 3 1  ON 32
ci_0034                 1.583663e-02 3 1  ON 33
ci_0035                 1.720569e-02 3 1  ON 34
ci_0036                 1.719510e-02 3 1  ON 35
ci_0037                -1.530558e-02 3 1  ON 36
ci_0038                -1.416290e-02 3 1  ON 37
ci_0039                -1.562442e-02 3 1  ON 38
ci_0040                -1.521458e-02 3 1  ON 39
ci_0041                 1.625804e-02 3 1  ON 40
ci_0042                 1.555657e-02 3 1  ON 41
ci_0043                -1.452915e-02 3 1  ON 42
ci_0044                -1.583505e-02 3 1  ON 43
ci_0045                 1.530978e-02 3 1  ON 44
ci_0046                 1.555384e-02 3 1  ON 45
ci_0047                -1.466600e-02 3 1  ON 46
ci_0048                -1.410757e-02 3 1  ON 47
ci_0049                -1.280249e-02 3 1  ON 48
ci_0050                -1.261274e-02 3 1  ON 49
ci_0051                -1.320249e-02 3 1  ON 50
ci_0052                -1.239555e-02 3 1  ON 51
ci_0053                -1.333256e-02 3 1  ON 52
ci_0054                -1.223123e-02 3 1  ON 53
ci_0055                 1.346225e-02 3 1  ON 54
ci_0056                 1.329173e-02 3 1  ON 55
ci_0057                 1.355572e-02 3 1  ON 56
ci_0058                 1.279960e-02 3 1  ON 57
ci_0059                -1.345638e-02 3 1  ON 58
ci_0060                -1.243830e-02 3 1  ON 59
ci_0061                -1.298126e-02 3 1  ON 60
ci_0062                -1.244723e-02 3 1  ON 61
ci_0063                -1.178414e-02 3 1  ON 62
ci_0064                -1.111967e-02 3 1  ON 63
ci_0065                -1.145943e-02 3 1  ON 64
ci_0066                -1.125978e-02 3 1  ON 65
ci_0067                -1.162726e-02 3 1  ON 66
ci_0068                -1.048969e-02 3 1  ON 67
ci_0069                 1.121503e-02 3 1  ON 68
ci_0070                 1.003603e-02 3 1  ON 69
ci_0071                 1.000349e-02 3 1  ON 70
ci_0072                 1.013131e-02 3 1  ON 71
ci_0073                 1.113653e-02 3 1  ON 72
ci_0074                 1.072744e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0841e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6704e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8594
    reference variance = 2.02779
====================================================
  Execution time = 1.3114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0233e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5293e+00
  Total weights = 1.945883677e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2952e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554019152002
                                         uncertainty =       0.032291815136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554019152002
                                         uncertainty =       0.032291815136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130170396
  error estimate for blocks of size 2^( 2) =       0.001169045251
  error estimate for blocks of size 2^( 3) =       0.001200830958
  error estimate for blocks of size 2^( 4) =       0.001223324877
  error estimate for blocks of size 2^( 5) =       0.001237315272
  error estimate for blocks of size 2^( 6) =       0.001242670283
  error estimate for blocks of size 2^( 7) =       0.001245632092

      target function =                  N/A
              le_mean =     -16.718676874276
             les_mean =     282.043442415965
             stat err =       0.001237235631
             autocorr =       1.198441897458
              std dev =       1.598327874199
             le_variance =       2.554651993442


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671867687428e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718676873346       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718687713225       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718687592736       residual = 4.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+00 is 2.414830e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718676873346       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718679844173       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718679845267       residual = 6.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+00 is 6.338253e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718676873346       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718677634367       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718677637404       residual = 4.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+01 is 1.604401e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.335501 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6419e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.067941e-01 3 1  ON 0
ci_0002                 6.798385e-01 3 1  ON 1
ci_0003                -4.804678e-02 3 1  ON 2
ci_0004                -4.643423e-02 3 1  ON 3
ci_0005                -4.605102e-02 3 1  ON 4
ci_0006                -4.362425e-02 3 1  ON 5
ci_0007                -3.128467e-02 3 1  ON 6
ci_0008                -3.141880e-02 3 1  ON 7
ci_0009                -3.243301e-02 3 1  ON 8
ci_0010                -3.078077e-02 3 1  ON 9
ci_0011                -2.703355e-02 3 1  ON 10
ci_0012                -2.587221e-02 3 1  ON 11
ci_0013                 2.741474e-02 3 1  ON 12
ci_0014                 2.691296e-02 3 1  ON 13
ci_0015                 2.753514e-02 3 1  ON 14
ci_0016                 2.647786e-02 3 1  ON 15
ci_0017                 2.468090e-02 3 1  ON 16
ci_0018                 2.336345e-02 3 1  ON 17
ci_0019                 2.055000e-02 3 1  ON 18
ci_0020                 1.940785e-02 3 1  ON 19
ci_0021                 1.845445e-02 3 1  ON 20
ci_0022                 1.843033e-02 3 1  ON 21
ci_0023                -1.990332e-02 3 1  ON 22
ci_0024                -1.834726e-02 3 1  ON 23
ci_0025                -1.871039e-02 3 1  ON 24
ci_0026                -1.781298e-02 3 1  ON 25
ci_0027                -1.782803e-02 3 1  ON 26
ci_0028                -1.734704e-02 3 1  ON 27
ci_0029                -1.504343e-02 3 1  ON 28
ci_0030                -1.634864e-02 3 1  ON 29
ci_0031                 1.523084e-02 3 1  ON 30
ci_0032                 1.431281e-02 3 1  ON 31
ci_0033                 1.666942e-02 3 1  ON 32
ci_0034                 1.589488e-02 3 1  ON 33
ci_0035                 1.725629e-02 3 1  ON 34
ci_0036                 1.720134e-02 3 1  ON 35
ci_0037                -1.530271e-02 3 1  ON 36
ci_0038                -1.421848e-02 3 1  ON 37
ci_0039                -1.562171e-02 3 1  ON 38
ci_0040                -1.521755e-02 3 1  ON 39
ci_0041                 1.621755e-02 3 1  ON 40
ci_0042                 1.553556e-02 3 1  ON 41
ci_0043                -1.458337e-02 3 1  ON 42
ci_0044                -1.582337e-02 3 1  ON 43
ci_0045                 1.531496e-02 3 1  ON 44
ci_0046                 1.558062e-02 3 1  ON 45
ci_0047                -1.464247e-02 3 1  ON 46
ci_0048                -1.408985e-02 3 1  ON 47
ci_0049                -1.280910e-02 3 1  ON 48
ci_0050                -1.264363e-02 3 1  ON 49
ci_0051                -1.319645e-02 3 1  ON 50
ci_0052                -1.240609e-02 3 1  ON 51
ci_0053                -1.331247e-02 3 1  ON 52
ci_0054                -1.219626e-02 3 1  ON 53
ci_0055                 1.346559e-02 3 1  ON 54
ci_0056                 1.323986e-02 3 1  ON 55
ci_0057                 1.351136e-02 3 1  ON 56
ci_0058                 1.277770e-02 3 1  ON 57
ci_0059                -1.344439e-02 3 1  ON 58
ci_0060                -1.244080e-02 3 1  ON 59
ci_0061                -1.295473e-02 3 1  ON 60
ci_0062                -1.246055e-02 3 1  ON 61
ci_0063                -1.177362e-02 3 1  ON 62
ci_0064                -1.112446e-02 3 1  ON 63
ci_0065                -1.145362e-02 3 1  ON 64
ci_0066                -1.129003e-02 3 1  ON 65
ci_0067                -1.164344e-02 3 1  ON 66
ci_0068                -1.051523e-02 3 1  ON 67
ci_0069                 1.122129e-02 3 1  ON 68
ci_0070                 1.003463e-02 3 1  ON 69
ci_0071                 9.974803e-03 3 1  ON 70
ci_0072                 1.013927e-02 3 1  ON 71
ci_0073                 1.117353e-02 3 1  ON 72
ci_0074                 1.070816e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8202
    reference variance = 1.2911
====================================================
  Execution time = 1.2856e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.4825e+00
  Total weights = 1.9453e+06
  Execution time = 2.2805e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.509317671205
                                         uncertainty =       0.016024475862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.509317671205
                                         uncertainty =       0.016024475862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119957292
  error estimate for blocks of size 2^( 2) =       0.001160174670
  error estimate for blocks of size 2^( 3) =       0.001193388883
  error estimate for blocks of size 2^( 4) =       0.001217663140
  error estimate for blocks of size 2^( 5) =       0.001234255725
  error estimate for blocks of size 2^( 6) =       0.001248965234
  error estimate for blocks of size 2^( 7) =       0.001249198976

      target function =                  N/A
              le_mean =     -16.717446848277
             les_mean =     281.955493010469
             stat err =       0.001237520769
             autocorr =       1.220961779302
              std dev =       1.583884132658
             le_variance =       2.508688945685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.509374390349
                                         uncertainty =       0.016023940798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.509374390349
                                         uncertainty =       0.016023940798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119969985
  error estimate for blocks of size 2^( 2) =       0.001160191337
  error estimate for blocks of size 2^( 3) =       0.001193410542
  error estimate for blocks of size 2^( 4) =       0.001217689159
  error estimate for blocks of size 2^( 5) =       0.001234284186
  error estimate for blocks of size 2^( 6) =       0.001248999787
  error estimate for blocks of size 2^( 7) =       0.001249242184

      target function =                  N/A
              le_mean =     -16.717449153722
             les_mean =     281.958045077697
             stat err =       0.001237553829
             autocorr =       1.220999338639
              std dev =       1.583902084216
             le_variance =       2.508745812385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.509348936964
                                         uncertainty =       0.016024161256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.509348936964
                                         uncertainty =       0.016024161256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119964289
  error estimate for blocks of size 2^( 2) =       0.001160183942
  error estimate for blocks of size 2^( 3) =       0.001193401141
  error estimate for blocks of size 2^( 4) =       0.001217677904
  error estimate for blocks of size 2^( 5) =       0.001234271113
  error estimate for blocks of size 2^( 6) =       0.001248983319
  error estimate for blocks of size 2^( 7) =       0.001249222770

      target function =                  N/A
              le_mean =     -16.717447809826
             les_mean =     281.955944298904
             stat err =       0.001237538777
             autocorr =       1.220982057163
              std dev =       1.583894028113
             le_variance =       2.508720292291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.509321425166
                                         uncertainty =       0.016024432971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.509321425166
                                         uncertainty =       0.016024432971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119958132
  error estimate for blocks of size 2^( 2) =       0.001160175831
  error estimate for blocks of size 2^( 3) =       0.001193390448
  error estimate for blocks of size 2^( 4) =       0.001217665085
  error estimate for blocks of size 2^( 5) =       0.001234257755
  error estimate for blocks of size 2^( 6) =       0.001248967594
  error estimate for blocks of size 2^( 7) =       0.001249202063

      target function =                  N/A
              le_mean =     -16.717446922387
             les_mean =     281.955504932887
             stat err =       0.001237523124
             autocorr =       1.220964595410
              std dev =       1.583885321016
             le_variance =       2.508692710131


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717446848277        initial
     1.4901e+00     1.4901e+01             2.4148e-04       -16.717449153722  <--
     5.9605e+00     5.9605e+01             6.3383e-05       -16.717447809826
     2.3842e+01     2.3842e+02             1.6044e-05       -16.717446922387

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 2.4377e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.068651e-01 3 1  ON 0
ci_0002                 6.797983e-01 3 1  ON 1
ci_0003                -4.792855e-02 3 1  ON 2
ci_0004                -4.641653e-02 3 1  ON 3
ci_0005                -4.603730e-02 3 1  ON 4
ci_0006                -4.356280e-02 3 1  ON 5
ci_0007                -3.128561e-02 3 1  ON 6
ci_0008                -3.130274e-02 3 1  ON 7
ci_0009                -3.235753e-02 3 1  ON 8
ci_0010                -3.083231e-02 3 1  ON 9
ci_0011                -2.707166e-02 3 1  ON 10
ci_0012                -2.596797e-02 3 1  ON 11
ci_0013                 2.734799e-02 3 1  ON 12
ci_0014                 2.677149e-02 3 1  ON 13
ci_0015                 2.755860e-02 3 1  ON 14
ci_0016                 2.656005e-02 3 1  ON 15
ci_0017                 2.463119e-02 3 1  ON 16
ci_0018                 2.333820e-02 3 1  ON 17
ci_0019                 2.063506e-02 3 1  ON 18
ci_0020                 1.945370e-02 3 1  ON 19
ci_0021                 1.842705e-02 3 1  ON 20
ci_0022                 1.825223e-02 3 1  ON 21
ci_0023                -1.983818e-02 3 1  ON 22
ci_0024                -1.832321e-02 3 1  ON 23
ci_0025                -1.869583e-02 3 1  ON 24
ci_0026                -1.785364e-02 3 1  ON 25
ci_0027                -1.777703e-02 3 1  ON 26
ci_0028                -1.724440e-02 3 1  ON 27
ci_0029                -1.506680e-02 3 1  ON 28
ci_0030                -1.623541e-02 3 1  ON 29
ci_0031                 1.519453e-02 3 1  ON 30
ci_0032                 1.419070e-02 3 1  ON 31
ci_0033                 1.659969e-02 3 1  ON 32
ci_0034                 1.605711e-02 3 1  ON 33
ci_0035                 1.739157e-02 3 1  ON 34
ci_0036                 1.721683e-02 3 1  ON 35
ci_0037                -1.529615e-02 3 1  ON 36
ci_0038                -1.436791e-02 3 1  ON 37
ci_0039                -1.561621e-02 3 1  ON 38
ci_0040                -1.522449e-02 3 1  ON 39
ci_0041                 1.611415e-02 3 1  ON 40
ci_0042                 1.548149e-02 3 1  ON 41
ci_0043                -1.473507e-02 3 1  ON 42
ci_0044                -1.578968e-02 3 1  ON 43
ci_0045                 1.532816e-02 3 1  ON 44
ci_0046                 1.565281e-02 3 1  ON 45
ci_0047                -1.458658e-02 3 1  ON 46
ci_0048                -1.404686e-02 3 1  ON 47
ci_0049                -1.282602e-02 3 1  ON 48
ci_0050                -1.272342e-02 3 1  ON 49
ci_0051                -1.318238e-02 3 1  ON 50
ci_0052                -1.243147e-02 3 1  ON 51
ci_0053                -1.326178e-02 3 1  ON 52
ci_0054                -1.210912e-02 3 1  ON 53
ci_0055                 1.347439e-02 3 1  ON 54
ci_0056                 1.310083e-02 3 1  ON 55
ci_0057                 1.339248e-02 3 1  ON 56
ci_0058                 1.271876e-02 3 1  ON 57
ci_0059                -1.341411e-02 3 1  ON 58
ci_0060                -1.244781e-02 3 1  ON 59
ci_0061                -1.288492e-02 3 1  ON 60
ci_0062                -1.249578e-02 3 1  ON 61
ci_0063                -1.174758e-02 3 1  ON 62
ci_0064                -1.113378e-02 3 1  ON 63
ci_0065                -1.144052e-02 3 1  ON 64
ci_0066                -1.136849e-02 3 1  ON 65
ci_0067                -1.168182e-02 3 1  ON 66
ci_0068                -1.057799e-02 3 1  ON 67
ci_0069                 1.123529e-02 3 1  ON 68
ci_0070                 1.003233e-02 3 1  ON 69
ci_0071                 9.900472e-03 3 1  ON 70
ci_0072                 1.015943e-02 3 1  ON 71
ci_0073                 1.126356e-02 3 1  ON 72
ci_0074                 1.066355e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0810e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6710e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.5583
    reference variance = 3.76504
====================================================
  Execution time = 1.3118e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0244e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5137e+00
  Total weights = 1.945832798e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2053e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.541419156869
                                         uncertainty =       0.025920962825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.541419156869
                                         uncertainty =       0.025920962825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127231084
  error estimate for blocks of size 2^( 2) =       0.001166132338
  error estimate for blocks of size 2^( 3) =       0.001198702167
  error estimate for blocks of size 2^( 4) =       0.001222658963
  error estimate for blocks of size 2^( 5) =       0.001236800002
  error estimate for blocks of size 2^( 6) =       0.001244044977
  error estimate for blocks of size 2^( 7) =       0.001246514102

      target function =                  N/A
              le_mean =     -16.718604678988
             les_mean =     282.025464329681
             stat err =       0.001237504511
             autocorr =       1.205223716793
              std dev =       1.594170992425
             le_variance =       2.541381153090


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671860467899e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718604678051       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718632919740       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718633617663       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718633422174       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718633466461       residual = 4.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e-01 is 6.732308e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718604678051       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718614617652       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718614672172       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+00 is 2.441239e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718604678051       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718607445037       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718607458659       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+00 is 6.816979e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.338732 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6333e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.070232e-01 3 1  ON 0
ci_0002                 6.796487e-01 3 1  ON 1
ci_0003                -4.789443e-02 3 1  ON 2
ci_0004                -4.638920e-02 3 1  ON 3
ci_0005                -4.588143e-02 3 1  ON 4
ci_0006                -4.361723e-02 3 1  ON 5
ci_0007                -3.144142e-02 3 1  ON 6
ci_0008                -3.144829e-02 3 1  ON 7
ci_0009                -3.224908e-02 3 1  ON 8
ci_0010                -3.081239e-02 3 1  ON 9
ci_0011                -2.706419e-02 3 1  ON 10
ci_0012                -2.604933e-02 3 1  ON 11
ci_0013                 2.726196e-02 3 1  ON 12
ci_0014                 2.665668e-02 3 1  ON 13
ci_0015                 2.755988e-02 3 1  ON 14
ci_0016                 2.648531e-02 3 1  ON 15
ci_0017                 2.485222e-02 3 1  ON 16
ci_0018                 2.327288e-02 3 1  ON 17
ci_0019                 2.071921e-02 3 1  ON 18
ci_0020                 1.936556e-02 3 1  ON 19
ci_0021                 1.834485e-02 3 1  ON 20
ci_0022                 1.831801e-02 3 1  ON 21
ci_0023                -1.959406e-02 3 1  ON 22
ci_0024                -1.823868e-02 3 1  ON 23
ci_0025                -1.867749e-02 3 1  ON 24
ci_0026                -1.790716e-02 3 1  ON 25
ci_0027                -1.768083e-02 3 1  ON 26
ci_0028                -1.720322e-02 3 1  ON 27
ci_0029                -1.515710e-02 3 1  ON 28
ci_0030                -1.616215e-02 3 1  ON 29
ci_0031                 1.521452e-02 3 1  ON 30
ci_0032                 1.422313e-02 3 1  ON 31
ci_0033                 1.659093e-02 3 1  ON 32
ci_0034                 1.607249e-02 3 1  ON 33
ci_0035                 1.733697e-02 3 1  ON 34
ci_0036                 1.721217e-02 3 1  ON 35
ci_0037                -1.514746e-02 3 1  ON 36
ci_0038                -1.437549e-02 3 1  ON 37
ci_0039                -1.577796e-02 3 1  ON 38
ci_0040                -1.516405e-02 3 1  ON 39
ci_0041                 1.607663e-02 3 1  ON 40
ci_0042                 1.554634e-02 3 1  ON 41
ci_0043                -1.484635e-02 3 1  ON 42
ci_0044                -1.580607e-02 3 1  ON 43
ci_0045                 1.531663e-02 3 1  ON 44
ci_0046                 1.558097e-02 3 1  ON 45
ci_0047                -1.450728e-02 3 1  ON 46
ci_0048                -1.420549e-02 3 1  ON 47
ci_0049                -1.279251e-02 3 1  ON 48
ci_0050                -1.280593e-02 3 1  ON 49
ci_0051                -1.320070e-02 3 1  ON 50
ci_0052                -1.245671e-02 3 1  ON 51
ci_0053                -1.322352e-02 3 1  ON 52
ci_0054                -1.208107e-02 3 1  ON 53
ci_0055                 1.334323e-02 3 1  ON 54
ci_0056                 1.306182e-02 3 1  ON 55
ci_0057                 1.326989e-02 3 1  ON 56
ci_0058                 1.268175e-02 3 1  ON 57
ci_0059                -1.343300e-02 3 1  ON 58
ci_0060                -1.251417e-02 3 1  ON 59
ci_0061                -1.291033e-02 3 1  ON 60
ci_0062                -1.257791e-02 3 1  ON 61
ci_0063                -1.187288e-02 3 1  ON 62
ci_0064                -1.112642e-02 3 1  ON 63
ci_0065                -1.138709e-02 3 1  ON 64
ci_0066                -1.146081e-02 3 1  ON 65
ci_0067                -1.165168e-02 3 1  ON 66
ci_0068                -1.058866e-02 3 1  ON 67
ci_0069                 1.115749e-02 3 1  ON 68
ci_0070                 1.019696e-02 3 1  ON 69
ci_0071                 9.896565e-03 3 1  ON 70
ci_0072                 9.995302e-03 3 1  ON 71
ci_0073                 1.125479e-02 3 1  ON 72
ci_0074                 1.084709e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.5427
    reference variance = 1.77115
====================================================
  Execution time = 1.2805e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5177e+00
  Total weights = 1.9457e+06
  Execution time = 2.2822e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546475179030
                                         uncertainty =       0.043815055232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546475179030
                                         uncertainty =       0.043815055232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128360393
  error estimate for blocks of size 2^( 2) =       0.001166147718
  error estimate for blocks of size 2^( 3) =       0.001199246905
  error estimate for blocks of size 2^( 4) =       0.001222372707
  error estimate for blocks of size 2^( 5) =       0.001236136209
  error estimate for blocks of size 2^( 6) =       0.001244671186
  error estimate for blocks of size 2^( 7) =       0.001249708206

      target function =                  N/A
              le_mean =     -16.717855040298
             les_mean =     282.020146165794
             stat err =       0.001238222077
             autocorr =       1.204207753370
              std dev =       1.595768103081
             le_variance =       2.546475838811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546522324433
                                         uncertainty =       0.043811940769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546522324433
                                         uncertainty =       0.043811940769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128371087
  error estimate for blocks of size 2^( 2) =       0.001166172426
  error estimate for blocks of size 2^( 3) =       0.001199285456
  error estimate for blocks of size 2^( 4) =       0.001222430059
  error estimate for blocks of size 2^( 5) =       0.001236196299
  error estimate for blocks of size 2^( 6) =       0.001244731960
  error estimate for blocks of size 2^( 7) =       0.001249724458

      target function =                  N/A
              le_mean =     -16.717868830761
             les_mean =     282.006494790330
             stat err =       0.001238270694
             autocorr =       1.204279491809
              std dev =       1.595783226266
             le_variance =       2.546524105231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546517021903
                                         uncertainty =       0.043812691305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546517021903
                                         uncertainty =       0.043812691305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128369829
  error estimate for blocks of size 2^( 2) =       0.001166166955
  error estimate for blocks of size 2^( 3) =       0.001199275877
  error estimate for blocks of size 2^( 4) =       0.001222415269
  error estimate for blocks of size 2^( 5) =       0.001236180024
  error estimate for blocks of size 2^( 6) =       0.001244713797
  error estimate for blocks of size 2^( 7) =       0.001249717038

      target function =                  N/A
              le_mean =     -16.717862661150
             les_mean =     282.004703326941
             stat err =       0.001238256532
             autocorr =       1.204254630739
              std dev =       1.595781447119
             le_variance =       2.546518426969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546921446250
                                         uncertainty =       0.043812941352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546921446250
                                         uncertainty =       0.043812941352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128459117
  error estimate for blocks of size 2^( 2) =       0.001166248392
  error estimate for blocks of size 2^( 3) =       0.001199360959
  error estimate for blocks of size 2^( 4) =       0.001222471674
  error estimate for blocks of size 2^( 5) =       0.001236203704
  error estimate for blocks of size 2^( 6) =       0.001244741535
  error estimate for blocks of size 2^( 7) =       0.001249871994

      target function =                  N/A
              le_mean =     -16.717870355776
             les_mean =     288.514762186989
             stat err =       0.001238322227
             autocorr =       1.204191832968
              std dev =       1.595907721257
             le_variance =       2.546921454767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717855040298        initial
     3.7253e-01     3.7253e+00             6.7323e-04       -16.717868830761
     1.4901e+00     1.4901e+01             2.4412e-04       -16.717862661150
     5.9605e+00     5.9605e+01             6.8170e-05       -16.717870355776  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 2.4343e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.069056e-01 3 1  ON 0
ci_0002                 6.797604e-01 3 1  ON 1
ci_0003                -4.791904e-02 3 1  ON 2
ci_0004                -4.640880e-02 3 1  ON 3
ci_0005                -4.599600e-02 3 1  ON 4
ci_0006                -4.357717e-02 3 1  ON 5
ci_0007                -3.132643e-02 3 1  ON 6
ci_0008                -3.134092e-02 3 1  ON 7
ci_0009                -3.232640e-02 3 1  ON 8
ci_0010                -3.082647e-02 3 1  ON 9
ci_0011                -2.706982e-02 3 1  ON 10
ci_0012                -2.598990e-02 3 1  ON 11
ci_0013                 2.732339e-02 3 1  ON 12
ci_0014                 2.673977e-02 3 1  ON 13
ci_0015                 2.755883e-02 3 1  ON 14
ci_0016                 2.653916e-02 3 1  ON 15
ci_0017                 2.469262e-02 3 1  ON 16
ci_0018                 2.331994e-02 3 1  ON 17
ci_0019                 2.065810e-02 3 1  ON 18
ci_0020                 1.942947e-02 3 1  ON 19
ci_0021                 1.840545e-02 3 1  ON 20
ci_0022                 1.826940e-02 3 1  ON 21
ci_0023                -1.977001e-02 3 1  ON 22
ci_0024                -1.829952e-02 3 1  ON 23
ci_0025                -1.869056e-02 3 1  ON 24
ci_0026                -1.786838e-02 3 1  ON 25
ci_0027                -1.774935e-02 3 1  ON 26
ci_0028                -1.723265e-02 3 1  ON 27
ci_0029                -1.509137e-02 3 1  ON 28
ci_0030                -1.621514e-02 3 1  ON 29
ci_0031                 1.520011e-02 3 1  ON 30
ci_0032                 1.419904e-02 3 1  ON 31
ci_0033                 1.659726e-02 3 1  ON 32
ci_0034                 1.606139e-02 3 1  ON 33
ci_0035                 1.737625e-02 3 1  ON 34
ci_0036                 1.721562e-02 3 1  ON 35
ci_0037                -1.525595e-02 3 1  ON 36
ci_0038                -1.437023e-02 3 1  ON 37
ci_0039                -1.566381e-02 3 1  ON 38
ci_0040                -1.520693e-02 3 1  ON 39
ci_0041                 1.610369e-02 3 1  ON 40
ci_0042                 1.549957e-02 3 1  ON 41
ci_0043                -1.476438e-02 3 1  ON 42
ci_0044                -1.579407e-02 3 1  ON 43
ci_0045                 1.532507e-02 3 1  ON 44
ci_0046                 1.563354e-02 3 1  ON 45
ci_0047                -1.456305e-02 3 1  ON 46
ci_0048                -1.409329e-02 3 1  ON 47
ci_0049                -1.281640e-02 3 1  ON 48
ci_0050                -1.274631e-02 3 1  ON 49
ci_0051                -1.318758e-02 3 1  ON 50
ci_0052                -1.243881e-02 3 1  ON 51
ci_0053                -1.325034e-02 3 1  ON 52
ci_0054                -1.210150e-02 3 1  ON 53
ci_0055                 1.343909e-02 3 1  ON 54
ci_0056                 1.309029e-02 3 1  ON 55
ci_0057                 1.335901e-02 3 1  ON 56
ci_0058                 1.270885e-02 3 1  ON 57
ci_0059                -1.341946e-02 3 1  ON 58
ci_0060                -1.246704e-02 3 1  ON 59
ci_0061                -1.289171e-02 3 1  ON 60
ci_0062                -1.251844e-02 3 1  ON 61
ci_0063                -1.178309e-02 3 1  ON 62
ci_0064                -1.113156e-02 3 1  ON 63
ci_0065                -1.142567e-02 3 1  ON 64
ci_0066                -1.139412e-02 3 1  ON 65
ci_0067                -1.167293e-02 3 1  ON 66
ci_0068                -1.058147e-02 3 1  ON 67
ci_0069                 1.121191e-02 3 1  ON 68
ci_0070                 1.008030e-02 3 1  ON 69
ci_0071                 9.899674e-03 3 1  ON 70
ci_0072                 1.011398e-02 3 1  ON 71
ci_0073                 1.126118e-02 3 1  ON 72
ci_0074                 1.071711e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0690e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6703e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.7034
    reference variance = 1.29273
====================================================
  Execution time = 1.3119e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0256e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5219e+00
  Total weights = 1.945338901e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1964e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547122650606
                                         uncertainty =       0.033031820842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547122650606
                                         uncertainty =       0.033031820842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128638146
  error estimate for blocks of size 2^( 2) =       0.001167308925
  error estimate for blocks of size 2^( 3) =       0.001201238058
  error estimate for blocks of size 2^( 4) =       0.001224292541
  error estimate for blocks of size 2^( 5) =       0.001238596003
  error estimate for blocks of size 2^( 6) =       0.001249305443
  error estimate for blocks of size 2^( 7) =       0.001259810369

      target function =                  N/A
              le_mean =     -16.717837495510
             les_mean =     282.008011807259
             stat err =       0.001243001089
             autocorr =       1.212923943997
              std dev =       1.596160910352
             le_variance =       2.547729651736


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671783749551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717837494569       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717842683578       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717842618786       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717842654222       residual = 2.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+00 is 2.646120e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717837494569       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717838949046       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717838904989       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717838904217       residual = 1.58e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+00 is 7.429434e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717837494569       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717837869550       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717837856342       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+01 is 1.917021e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.342007 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6326e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.069245e-01 3 1  ON 0
ci_0002                 6.797356e-01 3 1  ON 1
ci_0003                -4.793030e-02 3 1  ON 2
ci_0004                -4.636569e-02 3 1  ON 3
ci_0005                -4.598450e-02 3 1  ON 4
ci_0006                -4.358430e-02 3 1  ON 5
ci_0007                -3.134893e-02 3 1  ON 6
ci_0008                -3.135739e-02 3 1  ON 7
ci_0009                -3.234595e-02 3 1  ON 8
ci_0010                -3.082328e-02 3 1  ON 9
ci_0011                -2.706924e-02 3 1  ON 10
ci_0012                -2.602928e-02 3 1  ON 11
ci_0013                 2.733219e-02 3 1  ON 12
ci_0014                 2.677673e-02 3 1  ON 13
ci_0015                 2.758370e-02 3 1  ON 14
ci_0016                 2.657348e-02 3 1  ON 15
ci_0017                 2.470481e-02 3 1  ON 16
ci_0018                 2.330806e-02 3 1  ON 17
ci_0019                 2.068334e-02 3 1  ON 18
ci_0020                 1.935808e-02 3 1  ON 19
ci_0021                 1.837979e-02 3 1  ON 20
ci_0022                 1.826290e-02 3 1  ON 21
ci_0023                -1.975169e-02 3 1  ON 22
ci_0024                -1.833367e-02 3 1  ON 23
ci_0025                -1.870479e-02 3 1  ON 24
ci_0026                -1.779409e-02 3 1  ON 25
ci_0027                -1.771146e-02 3 1  ON 26
ci_0028                -1.724731e-02 3 1  ON 27
ci_0029                -1.512822e-02 3 1  ON 28
ci_0030                -1.622536e-02 3 1  ON 29
ci_0031                 1.519747e-02 3 1  ON 30
ci_0032                 1.418561e-02 3 1  ON 31
ci_0033                 1.662223e-02 3 1  ON 32
ci_0034                 1.608951e-02 3 1  ON 33
ci_0035                 1.737834e-02 3 1  ON 34
ci_0036                 1.725097e-02 3 1  ON 35
ci_0037                -1.528091e-02 3 1  ON 36
ci_0038                -1.440534e-02 3 1  ON 37
ci_0039                -1.569819e-02 3 1  ON 38
ci_0040                -1.519539e-02 3 1  ON 39
ci_0041                 1.610945e-02 3 1  ON 40
ci_0042                 1.551402e-02 3 1  ON 41
ci_0043                -1.478043e-02 3 1  ON 42
ci_0044                -1.577504e-02 3 1  ON 43
ci_0045                 1.533162e-02 3 1  ON 44
ci_0046                 1.561570e-02 3 1  ON 45
ci_0047                -1.459109e-02 3 1  ON 46
ci_0048                -1.409168e-02 3 1  ON 47
ci_0049                -1.277238e-02 3 1  ON 48
ci_0050                -1.270432e-02 3 1  ON 49
ci_0051                -1.319865e-02 3 1  ON 50
ci_0052                -1.244299e-02 3 1  ON 51
ci_0053                -1.324273e-02 3 1  ON 52
ci_0054                -1.211961e-02 3 1  ON 53
ci_0055                 1.340694e-02 3 1  ON 54
ci_0056                 1.304340e-02 3 1  ON 55
ci_0057                 1.334502e-02 3 1  ON 56
ci_0058                 1.268087e-02 3 1  ON 57
ci_0059                -1.338946e-02 3 1  ON 58
ci_0060                -1.246711e-02 3 1  ON 59
ci_0061                -1.290315e-02 3 1  ON 60
ci_0062                -1.249721e-02 3 1  ON 61
ci_0063                -1.181675e-02 3 1  ON 62
ci_0064                -1.116603e-02 3 1  ON 63
ci_0065                -1.141939e-02 3 1  ON 64
ci_0066                -1.143379e-02 3 1  ON 65
ci_0067                -1.166079e-02 3 1  ON 66
ci_0068                -1.058554e-02 3 1  ON 67
ci_0069                 1.118362e-02 3 1  ON 68
ci_0070                 1.010494e-02 3 1  ON 69
ci_0071                 9.932149e-03 3 1  ON 70
ci_0072                 1.013067e-02 3 1  ON 71
ci_0073                 1.124400e-02 3 1  ON 72
ci_0074                 1.073076e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.7211
    reference variance = 1.72355
====================================================
  Execution time = 1.2818e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5619e+00
  Total weights = 1.9455e+06
  Execution time = 2.2785e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.590061563237
                                         uncertainty =       0.041514664664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.590061563237
                                         uncertainty =       0.041514664664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137938431
  error estimate for blocks of size 2^( 2) =       0.001177043109
  error estimate for blocks of size 2^( 3) =       0.001209798497
  error estimate for blocks of size 2^( 4) =       0.001233166733
  error estimate for blocks of size 2^( 5) =       0.001247494318
  error estimate for blocks of size 2^( 6) =       0.001255894518
  error estimate for blocks of size 2^( 7) =       0.001260881104

      target function =                  N/A
              le_mean =     -16.717685119216
             les_mean =     282.043868366923
             stat err =       0.001249359168
             autocorr =       1.205416374371
              std dev =       1.609313710425
             le_variance =       2.589890618560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589766734892
                                         uncertainty =       0.041514201293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589766734892
                                         uncertainty =       0.041514201293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137873614
  error estimate for blocks of size 2^( 2) =       0.001176974735
  error estimate for blocks of size 2^( 3) =       0.001209729198
  error estimate for blocks of size 2^( 4) =       0.001233090814
  error estimate for blocks of size 2^( 5) =       0.001247416220
  error estimate for blocks of size 2^( 6) =       0.001255816841
  error estimate for blocks of size 2^( 7) =       0.001260791749

      target function =                  N/A
              le_mean =     -16.717684852092
             les_mean =     282.080209488014
             stat err =       0.001249278906
             autocorr =       1.205398815973
              std dev =       1.609222043932
             le_variance =       2.589595586675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589892308334
                                         uncertainty =       0.041514376825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589892308334
                                         uncertainty =       0.041514376825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137901224
  error estimate for blocks of size 2^( 2) =       0.001177003732
  error estimate for blocks of size 2^( 3) =       0.001209758803
  error estimate for blocks of size 2^( 4) =       0.001233123392
  error estimate for blocks of size 2^( 5) =       0.001247450371
  error estimate for blocks of size 2^( 6) =       0.001255851011
  error estimate for blocks of size 2^( 7) =       0.001260831868

      target function =                  N/A
              le_mean =     -16.717684831865
             les_mean =     282.045036330314
             stat err =       0.001249314161
             autocorr =       1.205408351119
              std dev =       1.609261091643
             le_variance =       2.589721261075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.590039187359
                                         uncertainty =       0.041514624629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.590039187359
                                         uncertainty =       0.041514624629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137933512
  error estimate for blocks of size 2^( 2) =       0.001177037905
  error estimate for blocks of size 2^( 3) =       0.001209793262
  error estimate for blocks of size 2^( 4) =       0.001233160984
  error estimate for blocks of size 2^( 5) =       0.001247488394
  error estimate for blocks of size 2^( 6) =       0.001255888855
  error estimate for blocks of size 2^( 7) =       0.001260874751

      target function =                  N/A
              le_mean =     -16.717685038588
             les_mean =     282.043187918520
             stat err =       0.001249353246
             autocorr =       1.205415366779
              std dev =       1.609306754583
             le_variance =       2.589868230347


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717685119216        initial  <--
     1.4901e+00     1.4901e+01             2.6461e-04       -16.717684852092
     5.9605e+00     5.9605e+01             7.4294e-05       -16.717684831865
     2.3842e+01     2.3842e+02             1.9170e-05       -16.717685038588

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.3194
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.069056e-01 3 1  ON 0
ci_0002                 6.797604e-01 3 1  ON 1
ci_0003                -4.791904e-02 3 1  ON 2
ci_0004                -4.640880e-02 3 1  ON 3
ci_0005                -4.599600e-02 3 1  ON 4
ci_0006                -4.357717e-02 3 1  ON 5
ci_0007                -3.132643e-02 3 1  ON 6
ci_0008                -3.134092e-02 3 1  ON 7
ci_0009                -3.232640e-02 3 1  ON 8
ci_0010                -3.082647e-02 3 1  ON 9
ci_0011                -2.706982e-02 3 1  ON 10
ci_0012                -2.598990e-02 3 1  ON 11
ci_0013                 2.732339e-02 3 1  ON 12
ci_0014                 2.673977e-02 3 1  ON 13
ci_0015                 2.755883e-02 3 1  ON 14
ci_0016                 2.653916e-02 3 1  ON 15
ci_0017                 2.469262e-02 3 1  ON 16
ci_0018                 2.331994e-02 3 1  ON 17
ci_0019                 2.065810e-02 3 1  ON 18
ci_0020                 1.942947e-02 3 1  ON 19
ci_0021                 1.840545e-02 3 1  ON 20
ci_0022                 1.826940e-02 3 1  ON 21
ci_0023                -1.977001e-02 3 1  ON 22
ci_0024                -1.829952e-02 3 1  ON 23
ci_0025                -1.869056e-02 3 1  ON 24
ci_0026                -1.786838e-02 3 1  ON 25
ci_0027                -1.774935e-02 3 1  ON 26
ci_0028                -1.723265e-02 3 1  ON 27
ci_0029                -1.509137e-02 3 1  ON 28
ci_0030                -1.621514e-02 3 1  ON 29
ci_0031                 1.520011e-02 3 1  ON 30
ci_0032                 1.419904e-02 3 1  ON 31
ci_0033                 1.659726e-02 3 1  ON 32
ci_0034                 1.606139e-02 3 1  ON 33
ci_0035                 1.737625e-02 3 1  ON 34
ci_0036                 1.721562e-02 3 1  ON 35
ci_0037                -1.525595e-02 3 1  ON 36
ci_0038                -1.437023e-02 3 1  ON 37
ci_0039                -1.566381e-02 3 1  ON 38
ci_0040                -1.520693e-02 3 1  ON 39
ci_0041                 1.610369e-02 3 1  ON 40
ci_0042                 1.549957e-02 3 1  ON 41
ci_0043                -1.476438e-02 3 1  ON 42
ci_0044                -1.579407e-02 3 1  ON 43
ci_0045                 1.532507e-02 3 1  ON 44
ci_0046                 1.563354e-02 3 1  ON 45
ci_0047                -1.456305e-02 3 1  ON 46
ci_0048                -1.409329e-02 3 1  ON 47
ci_0049                -1.281640e-02 3 1  ON 48
ci_0050                -1.274631e-02 3 1  ON 49
ci_0051                -1.318758e-02 3 1  ON 50
ci_0052                -1.243881e-02 3 1  ON 51
ci_0053                -1.325034e-02 3 1  ON 52
ci_0054                -1.210150e-02 3 1  ON 53
ci_0055                 1.343909e-02 3 1  ON 54
ci_0056                 1.309029e-02 3 1  ON 55
ci_0057                 1.335901e-02 3 1  ON 56
ci_0058                 1.270885e-02 3 1  ON 57
ci_0059                -1.341946e-02 3 1  ON 58
ci_0060                -1.246704e-02 3 1  ON 59
ci_0061                -1.289171e-02 3 1  ON 60
ci_0062                -1.251844e-02 3 1  ON 61
ci_0063                -1.178309e-02 3 1  ON 62
ci_0064                -1.113156e-02 3 1  ON 63
ci_0065                -1.142567e-02 3 1  ON 64
ci_0066                -1.139412e-02 3 1  ON 65
ci_0067                -1.167293e-02 3 1  ON 66
ci_0068                -1.058147e-02 3 1  ON 67
ci_0069                 1.121191e-02 3 1  ON 68
ci_0070                 1.008030e-02 3 1  ON 69
ci_0071                 9.899674e-03 3 1  ON 70
ci_0072                 1.011398e-02 3 1  ON 71
ci_0073                 1.126118e-02 3 1  ON 72
ci_0074                 1.071711e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0658e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6704e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9088
    reference variance = 2.147
====================================================
  Execution time = 1.3156e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0272e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.4838e+00
  Total weights = 1.945778035e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2443e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.511261228223
                                         uncertainty =       0.019902703680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.511261228223
                                         uncertainty =       0.019902703680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001120671013
  error estimate for blocks of size 2^( 2) =       0.001159634951
  error estimate for blocks of size 2^( 3) =       0.001192047286
  error estimate for blocks of size 2^( 4) =       0.001215499298
  error estimate for blocks of size 2^( 5) =       0.001231347440
  error estimate for blocks of size 2^( 6) =       0.001240364348
  error estimate for blocks of size 2^( 7) =       0.001242216462

      target function =                  N/A
              le_mean =     -16.717231713900
             les_mean =     281.949596954676
             stat err =       0.001232356887
             autocorr =       1.209251724774
              std dev =       1.584893503157
             le_variance =       2.511887416350


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671723171390e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717231712982       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717232388290       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717232402268       residual = 1.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+01 is 3.145547e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717231712982       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717231883826       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717231886800       residual = 9.96e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+01 is 7.996923e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717231712982       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717231755821       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717231756531       residual = 9.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+02 is 2.007722e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.345003 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6411e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.069076e-01 3 1  ON 0
ci_0002                 6.797573e-01 3 1  ON 1
ci_0003                -4.792330e-02 3 1  ON 2
ci_0004                -4.640958e-02 3 1  ON 3
ci_0005                -4.599768e-02 3 1  ON 4
ci_0006                -4.357974e-02 3 1  ON 5
ci_0007                -3.132714e-02 3 1  ON 6
ci_0008                -3.134444e-02 3 1  ON 7
ci_0009                -3.233166e-02 3 1  ON 8
ci_0010                -3.082794e-02 3 1  ON 9
ci_0011                -2.706899e-02 3 1  ON 10
ci_0012                -2.599286e-02 3 1  ON 11
ci_0013                 2.732219e-02 3 1  ON 12
ci_0014                 2.673978e-02 3 1  ON 13
ci_0015                 2.756021e-02 3 1  ON 14
ci_0016                 2.653918e-02 3 1  ON 15
ci_0017                 2.468746e-02 3 1  ON 16
ci_0018                 2.331723e-02 3 1  ON 17
ci_0019                 2.065979e-02 3 1  ON 18
ci_0020                 1.943069e-02 3 1  ON 19
ci_0021                 1.839997e-02 3 1  ON 20
ci_0022                 1.826605e-02 3 1  ON 21
ci_0023                -1.976932e-02 3 1  ON 22
ci_0024                -1.829417e-02 3 1  ON 23
ci_0025                -1.868989e-02 3 1  ON 24
ci_0026                -1.786848e-02 3 1  ON 25
ci_0027                -1.775083e-02 3 1  ON 26
ci_0028                -1.723354e-02 3 1  ON 27
ci_0029                -1.509689e-02 3 1  ON 28
ci_0030                -1.621362e-02 3 1  ON 29
ci_0031                 1.519824e-02 3 1  ON 30
ci_0032                 1.419825e-02 3 1  ON 31
ci_0033                 1.659511e-02 3 1  ON 32
ci_0034                 1.605926e-02 3 1  ON 33
ci_0035                 1.738170e-02 3 1  ON 34
ci_0036                 1.721818e-02 3 1  ON 35
ci_0037                -1.525685e-02 3 1  ON 36
ci_0038                -1.436549e-02 3 1  ON 37
ci_0039                -1.566743e-02 3 1  ON 38
ci_0040                -1.520328e-02 3 1  ON 39
ci_0041                 1.610795e-02 3 1  ON 40
ci_0042                 1.550384e-02 3 1  ON 41
ci_0043                -1.476716e-02 3 1  ON 42
ci_0044                -1.579044e-02 3 1  ON 43
ci_0045                 1.532681e-02 3 1  ON 44
ci_0046                 1.563282e-02 3 1  ON 45
ci_0047                -1.456460e-02 3 1  ON 46
ci_0048                -1.409179e-02 3 1  ON 47
ci_0049                -1.281864e-02 3 1  ON 48
ci_0050                -1.274356e-02 3 1  ON 49
ci_0051                -1.318962e-02 3 1  ON 50
ci_0052                -1.244376e-02 3 1  ON 51
ci_0053                -1.325078e-02 3 1  ON 52
ci_0054                -1.210460e-02 3 1  ON 53
ci_0055                 1.343660e-02 3 1  ON 54
ci_0056                 1.309280e-02 3 1  ON 55
ci_0057                 1.335950e-02 3 1  ON 56
ci_0058                 1.270585e-02 3 1  ON 57
ci_0059                -1.342073e-02 3 1  ON 58
ci_0060                -1.246816e-02 3 1  ON 59
ci_0061                -1.289269e-02 3 1  ON 60
ci_0062                -1.251823e-02 3 1  ON 61
ci_0063                -1.178428e-02 3 1  ON 62
ci_0064                -1.112949e-02 3 1  ON 63
ci_0065                -1.143072e-02 3 1  ON 64
ci_0066                -1.139486e-02 3 1  ON 65
ci_0067                -1.166998e-02 3 1  ON 66
ci_0068                -1.057348e-02 3 1  ON 67
ci_0069                 1.120983e-02 3 1  ON 68
ci_0070                 1.008220e-02 3 1  ON 69
ci_0071                 9.897525e-03 3 1  ON 70
ci_0072                 1.011489e-02 3 1  ON 71
ci_0073                 1.126582e-02 3 1  ON 72
ci_0074                 1.071923e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.3602
    reference variance = 7.38221
====================================================
  Execution time = 1.2849e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5231e+00
  Total weights = 1.9458e+06
  Execution time = 2.2824e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550469797490
                                         uncertainty =       0.030136970611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550469797490
                                         uncertainty =       0.030136970611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129207206
  error estimate for blocks of size 2^( 2) =       0.001167843608
  error estimate for blocks of size 2^( 3) =       0.001200011056
  error estimate for blocks of size 2^( 4) =       0.001223449407
  error estimate for blocks of size 2^( 5) =       0.001238160386
  error estimate for blocks of size 2^( 6) =       0.001249116837
  error estimate for blocks of size 2^( 7) =       0.001253585259

      target function =                  N/A
              le_mean =     -16.716469162244
             les_mean =     281.963478218095
             stat err =       0.001241077972
             autocorr =       1.207955269153
              std dev =       1.596965696936
             le_variance =       2.550299437190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550489992919
                                         uncertainty =       0.030136832183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550489992919
                                         uncertainty =       0.030136832183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129211675
  error estimate for blocks of size 2^( 2) =       0.001167846441
  error estimate for blocks of size 2^( 3) =       0.001200012387
  error estimate for blocks of size 2^( 4) =       0.001223449802
  error estimate for blocks of size 2^( 5) =       0.001238159281
  error estimate for blocks of size 2^( 6) =       0.001249116419
  error estimate for blocks of size 2^( 7) =       0.001253583455

      target function =                  N/A
              le_mean =     -16.716469623346
             les_mean =     281.963518742925
             stat err =       0.001241077239
             autocorr =       1.207944283325
              std dev =       1.596972015949
             le_variance =       2.550319619724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550479981543
                                         uncertainty =       0.030136899682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550479981543
                                         uncertainty =       0.030136899682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129209460
  error estimate for blocks of size 2^( 2) =       0.001167845032
  error estimate for blocks of size 2^( 3) =       0.001200011720
  error estimate for blocks of size 2^( 4) =       0.001223449597
  error estimate for blocks of size 2^( 5) =       0.001238159816
  error estimate for blocks of size 2^( 6) =       0.001249116615
  error estimate for blocks of size 2^( 7) =       0.001253584334

      target function =                  N/A
              le_mean =     -16.716469391867
             les_mean =     281.963493596397
             stat err =       0.001241077590
             autocorr =       1.207949705397
              std dev =       1.596968883470
             le_variance =       2.550309614772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550471069363
                                         uncertainty =       0.030136961677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550471069363
                                         uncertainty =       0.030136961677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129207488
  error estimate for blocks of size 2^( 2) =       0.001167843786
  error estimate for blocks of size 2^( 3) =       0.001200011138
  error estimate for blocks of size 2^( 4) =       0.001223449429
  error estimate for blocks of size 2^( 5) =       0.001238160313
  error estimate for blocks of size 2^( 6) =       0.001249116808
  error estimate for blocks of size 2^( 7) =       0.001253585142

      target function =                  N/A
              le_mean =     -16.716469190540
             les_mean =     281.963479699351
             stat err =       0.001241077923
             autocorr =       1.207954571815
              std dev =       1.596966094898
             le_variance =       2.550300708252


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716469162244        initial
     1.4901e+01     1.4901e+02             3.1455e-05       -16.716469623346  <--
     5.9605e+01     5.9605e+02             7.9969e-06       -16.716469391867
     2.3842e+02     2.3842e+03             2.0077e-06       -16.716469190540

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 2.4388e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.069135e-01 3 1  ON 0
ci_0002                 6.797479e-01 3 1  ON 1
ci_0003                -4.793586e-02 3 1  ON 2
ci_0004                -4.641190e-02 3 1  ON 3
ci_0005                -4.600267e-02 3 1  ON 4
ci_0006                -4.358738e-02 3 1  ON 5
ci_0007                -3.132927e-02 3 1  ON 6
ci_0008                -3.135493e-02 3 1  ON 7
ci_0009                -3.234718e-02 3 1  ON 8
ci_0010                -3.083228e-02 3 1  ON 9
ci_0011                -2.706650e-02 3 1  ON 10
ci_0012                -2.600163e-02 3 1  ON 11
ci_0013                 2.731858e-02 3 1  ON 12
ci_0014                 2.673982e-02 3 1  ON 13
ci_0015                 2.756426e-02 3 1  ON 14
ci_0016                 2.653926e-02 3 1  ON 15
ci_0017                 2.467221e-02 3 1  ON 16
ci_0018                 2.330923e-02 3 1  ON 17
ci_0019                 2.066481e-02 3 1  ON 18
ci_0020                 1.943430e-02 3 1  ON 19
ci_0021                 1.838366e-02 3 1  ON 20
ci_0022                 1.825606e-02 3 1  ON 21
ci_0023                -1.976729e-02 3 1  ON 22
ci_0024                -1.827836e-02 3 1  ON 23
ci_0025                -1.868791e-02 3 1  ON 24
ci_0026                -1.786878e-02 3 1  ON 25
ci_0027                -1.775516e-02 3 1  ON 26
ci_0028                -1.723616e-02 3 1  ON 27
ci_0029                -1.511316e-02 3 1  ON 28
ci_0030                -1.620910e-02 3 1  ON 29
ci_0031                 1.519265e-02 3 1  ON 30
ci_0032                 1.419589e-02 3 1  ON 31
ci_0033                 1.658872e-02 3 1  ON 32
ci_0034                 1.605294e-02 3 1  ON 33
ci_0035                 1.739782e-02 3 1  ON 34
ci_0036                 1.722577e-02 3 1  ON 35
ci_0037                -1.525951e-02 3 1  ON 36
ci_0038                -1.435143e-02 3 1  ON 37
ci_0039                -1.567801e-02 3 1  ON 38
ci_0040                -1.519257e-02 3 1  ON 39
ci_0041                 1.612055e-02 3 1  ON 40
ci_0042                 1.551643e-02 3 1  ON 41
ci_0043                -1.477540e-02 3 1  ON 42
ci_0044                -1.577959e-02 3 1  ON 43
ci_0045                 1.533199e-02 3 1  ON 44
ci_0046                 1.563069e-02 3 1  ON 45
ci_0047                -1.456917e-02 3 1  ON 46
ci_0048                -1.408740e-02 3 1  ON 47
ci_0049                -1.282525e-02 3 1  ON 48
ci_0050                -1.273546e-02 3 1  ON 49
ci_0051                -1.319561e-02 3 1  ON 50
ci_0052                -1.245831e-02 3 1  ON 51
ci_0053                -1.325207e-02 3 1  ON 52
ci_0054                -1.211368e-02 3 1  ON 53
ci_0055                 1.342921e-02 3 1  ON 54
ci_0056                 1.310022e-02 3 1  ON 55
ci_0057                 1.336094e-02 3 1  ON 56
ci_0058                 1.269699e-02 3 1  ON 57
ci_0059                -1.342448e-02 3 1  ON 58
ci_0060                -1.247145e-02 3 1  ON 59
ci_0061                -1.289559e-02 3 1  ON 60
ci_0062                -1.251761e-02 3 1  ON 61
ci_0063                -1.178777e-02 3 1  ON 62
ci_0064                -1.112341e-02 3 1  ON 63
ci_0065                -1.144559e-02 3 1  ON 64
ci_0066                -1.139706e-02 3 1  ON 65
ci_0067                -1.166130e-02 3 1  ON 66
ci_0068                -1.055002e-02 3 1  ON 67
ci_0069                 1.120374e-02 3 1  ON 68
ci_0070                 1.008777e-02 3 1  ON 69
ci_0071                 9.891166e-03 3 1  ON 70
ci_0072                 1.011755e-02 3 1  ON 71
ci_0073                 1.127943e-02 3 1  ON 72
ci_0074                 1.072545e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0811e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6701e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9514
    reference variance = 1.96644
====================================================
  Execution time = 1.5461e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0318e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.4938e+00
  Total weights = 1.945476142e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2186e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.521192044951
                                         uncertainty =       0.020718121226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.521192044951
                                         uncertainty =       0.020718121226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122823278
  error estimate for blocks of size 2^( 2) =       0.001161701971
  error estimate for blocks of size 2^( 3) =       0.001195893596
  error estimate for blocks of size 2^( 4) =       0.001218627214
  error estimate for blocks of size 2^( 5) =       0.001233477918
  error estimate for blocks of size 2^( 6) =       0.001244778955
  error estimate for blocks of size 2^( 7) =       0.001248311496

      target function =                  N/A
              le_mean =     -16.720057737231
             les_mean =     282.054121635310
             stat err =       0.001236298896
             autocorr =       1.212339198237
              std dev =       1.587937314121
             le_variance =       2.521544913579


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.672005773723e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720057736314       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720060558113       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720060612046       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+00 is 2.043702e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720057736314       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720058485158       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720058495035       residual = 1.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+01 is 5.527491e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720057736314       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720057926449       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720057928680       residual = 1.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+01 is 1.410573e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.347837 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8690e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.069240e-01 3 1  ON 0
ci_0002                 6.797330e-01 3 1  ON 1
ci_0003                -4.795621e-02 3 1  ON 2
ci_0004                -4.642632e-02 3 1  ON 3
ci_0005                -4.600695e-02 3 1  ON 4
ci_0006                -4.359800e-02 3 1  ON 5
ci_0007                -3.133270e-02 3 1  ON 6
ci_0008                -3.134463e-02 3 1  ON 7
ci_0009                -3.235188e-02 3 1  ON 8
ci_0010                -3.082514e-02 3 1  ON 9
ci_0011                -2.707881e-02 3 1  ON 10
ci_0012                -2.601423e-02 3 1  ON 11
ci_0013                 2.731822e-02 3 1  ON 12
ci_0014                 2.673763e-02 3 1  ON 13
ci_0015                 2.756413e-02 3 1  ON 14
ci_0016                 2.654420e-02 3 1  ON 15
ci_0017                 2.466387e-02 3 1  ON 16
ci_0018                 2.332236e-02 3 1  ON 17
ci_0019                 2.066289e-02 3 1  ON 18
ci_0020                 1.944206e-02 3 1  ON 19
ci_0021                 1.837712e-02 3 1  ON 20
ci_0022                 1.825246e-02 3 1  ON 21
ci_0023                -1.977586e-02 3 1  ON 22
ci_0024                -1.828231e-02 3 1  ON 23
ci_0025                -1.868296e-02 3 1  ON 24
ci_0026                -1.785160e-02 3 1  ON 25
ci_0027                -1.774675e-02 3 1  ON 26
ci_0028                -1.723767e-02 3 1  ON 27
ci_0029                -1.512913e-02 3 1  ON 28
ci_0030                -1.621704e-02 3 1  ON 29
ci_0031                 1.520115e-02 3 1  ON 30
ci_0032                 1.419630e-02 3 1  ON 31
ci_0033                 1.658492e-02 3 1  ON 32
ci_0034                 1.603797e-02 3 1  ON 33
ci_0035                 1.739384e-02 3 1  ON 34
ci_0036                 1.722510e-02 3 1  ON 35
ci_0037                -1.526144e-02 3 1  ON 36
ci_0038                -1.434213e-02 3 1  ON 37
ci_0039                -1.567574e-02 3 1  ON 38
ci_0040                -1.513730e-02 3 1  ON 39
ci_0041                 1.613224e-02 3 1  ON 40
ci_0042                 1.551034e-02 3 1  ON 41
ci_0043                -1.477971e-02 3 1  ON 42
ci_0044                -1.577675e-02 3 1  ON 43
ci_0045                 1.532724e-02 3 1  ON 44
ci_0046                 1.561531e-02 3 1  ON 45
ci_0047                -1.456276e-02 3 1  ON 46
ci_0048                -1.408728e-02 3 1  ON 47
ci_0049                -1.282683e-02 3 1  ON 48
ci_0050                -1.273885e-02 3 1  ON 49
ci_0051                -1.321115e-02 3 1  ON 50
ci_0052                -1.246659e-02 3 1  ON 51
ci_0053                -1.326752e-02 3 1  ON 52
ci_0054                -1.212523e-02 3 1  ON 53
ci_0055                 1.342006e-02 3 1  ON 54
ci_0056                 1.310780e-02 3 1  ON 55
ci_0057                 1.335501e-02 3 1  ON 56
ci_0058                 1.268451e-02 3 1  ON 57
ci_0059                -1.340520e-02 3 1  ON 58
ci_0060                -1.248839e-02 3 1  ON 59
ci_0061                -1.290426e-02 3 1  ON 60
ci_0062                -1.250536e-02 3 1  ON 61
ci_0063                -1.179878e-02 3 1  ON 62
ci_0064                -1.112113e-02 3 1  ON 63
ci_0065                -1.147036e-02 3 1  ON 64
ci_0066                -1.140576e-02 3 1  ON 65
ci_0067                -1.165989e-02 3 1  ON 66
ci_0068                -1.056281e-02 3 1  ON 67
ci_0069                 1.118298e-02 3 1  ON 68
ci_0070                 1.011810e-02 3 1  ON 69
ci_0071                 9.899704e-03 3 1  ON 70
ci_0072                 1.012279e-02 3 1  ON 71
ci_0073                 1.126743e-02 3 1  ON 72
ci_0074                 1.075094e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.71
    reference variance = 2.11166
====================================================
  Execution time = 1.2784e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4826e+00
  Total weights = 1.9461e+06
  Execution time = 2.2189e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506348811071
                                         uncertainty =       0.021613569682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506348811071
                                         uncertainty =       0.021613569682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119787767
  error estimate for blocks of size 2^( 2) =       0.001158611528
  error estimate for blocks of size 2^( 3) =       0.001191441726
  error estimate for blocks of size 2^( 4) =       0.001213830378
  error estimate for blocks of size 2^( 5) =       0.001228067754
  error estimate for blocks of size 2^( 6) =       0.001234163816
  error estimate for blocks of size 2^( 7) =       0.001242185710

      target function =                  N/A
              le_mean =     -16.718883869275
             les_mean =     282.003690009316
             stat err =       0.001229561915
             autocorr =       1.205672534966
              std dev =       1.583644384247
             le_variance =       2.507929535758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506398500450
                                         uncertainty =       0.021612403567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506398500450
                                         uncertainty =       0.021612403567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119798932
  error estimate for blocks of size 2^( 2) =       0.001158619588
  error estimate for blocks of size 2^( 3) =       0.001191447140
  error estimate for blocks of size 2^( 4) =       0.001213834800
  error estimate for blocks of size 2^( 5) =       0.001228073824
  error estimate for blocks of size 2^( 6) =       0.001234173202
  error estimate for blocks of size 2^( 7) =       0.001242196203

      target function =                  N/A
              le_mean =     -16.718884303483
             les_mean =     282.015445749426
             stat err =       0.001229569507
             autocorr =       1.205663381605
              std dev =       1.583660174654
             le_variance =       2.507979548785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506374755904
                                         uncertainty =       0.021612928801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506374755904
                                         uncertainty =       0.021612928801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119793598
  error estimate for blocks of size 2^( 2) =       0.001158615693
  error estimate for blocks of size 2^( 3) =       0.001191444425
  error estimate for blocks of size 2^( 4) =       0.001213832486
  error estimate for blocks of size 2^( 5) =       0.001228070777
  error estimate for blocks of size 2^( 6) =       0.001234168972
  error estimate for blocks of size 2^( 7) =       0.001242190678

      target function =                  N/A
              le_mean =     -16.718883856407
             les_mean =     282.003720647661
             stat err =       0.001229565728
             autocorr =       1.205667457394
              std dev =       1.583652630612
             le_variance =       2.507955654444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506352009866
                                         uncertainty =       0.021613487302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506352009866
                                         uncertainty =       0.021613487302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119788486
  error estimate for blocks of size 2^( 2) =       0.001158612035
  error estimate for blocks of size 2^( 3) =       0.001191442049
  error estimate for blocks of size 2^( 4) =       0.001213830627
  error estimate for blocks of size 2^( 5) =       0.001228068121
  error estimate for blocks of size 2^( 6) =       0.001234164457
  error estimate for blocks of size 2^( 7) =       0.001242186322

      target function =                  N/A
              le_mean =     -16.718883855562
             les_mean =     282.003681765772
             stat err =       0.001229562382
             autocorr =       1.205671902687
              std dev =       1.583645401195
             le_variance =       2.507932756725


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718883869275        initial
     3.7253e+00     3.7253e+01             2.0437e-04       -16.718884303483  <--
     1.4901e+01     1.4901e+02             5.5275e-05       -16.718883856407
     5.9605e+01     5.9605e+02             1.4106e-05       -16.718883855562

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 2.3996e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.069558e-01 3 1  ON 0
ci_0002                 6.796890e-01 3 1  ON 1
ci_0003                -4.801387e-02 3 1  ON 2
ci_0004                -4.646710e-02 3 1  ON 3
ci_0005                -4.601939e-02 3 1  ON 4
ci_0006                -4.362853e-02 3 1  ON 5
ci_0007                -3.134272e-02 3 1  ON 6
ci_0008                -3.131454e-02 3 1  ON 7
ci_0009                -3.236501e-02 3 1  ON 8
ci_0010                -3.080466e-02 3 1  ON 9
ci_0011                -2.711349e-02 3 1  ON 10
ci_0012                -2.604955e-02 3 1  ON 11
ci_0013                 2.731690e-02 3 1  ON 12
ci_0014                 2.673109e-02 3 1  ON 13
ci_0015                 2.756379e-02 3 1  ON 14
ci_0016                 2.655788e-02 3 1  ON 15
ci_0017                 2.464028e-02 3 1  ON 16
ci_0018                 2.335897e-02 3 1  ON 17
ci_0019                 2.065723e-02 3 1  ON 18
ci_0020                 1.946340e-02 3 1  ON 19
ci_0021                 1.835842e-02 3 1  ON 20
ci_0022                 1.824218e-02 3 1  ON 21
ci_0023                -1.980011e-02 3 1  ON 22
ci_0024                -1.829292e-02 3 1  ON 23
ci_0025                -1.866913e-02 3 1  ON 24
ci_0026                -1.780301e-02 3 1  ON 25
ci_0027                -1.772282e-02 3 1  ON 26
ci_0028                -1.724164e-02 3 1  ON 27
ci_0029                -1.517429e-02 3 1  ON 28
ci_0030                -1.623903e-02 3 1  ON 29
ci_0031                 1.522570e-02 3 1  ON 30
ci_0032                 1.419692e-02 3 1  ON 31
ci_0033                 1.657407e-02 3 1  ON 32
ci_0034                 1.599460e-02 3 1  ON 33
ci_0035                 1.738246e-02 3 1  ON 34
ci_0036                 1.722315e-02 3 1  ON 35
ci_0037                -1.526676e-02 3 1  ON 36
ci_0038                -1.431547e-02 3 1  ON 37
ci_0039                -1.566951e-02 3 1  ON 38
ci_0040                -1.498820e-02 3 1  ON 39
ci_0041                 1.616498e-02 3 1  ON 40
ci_0042                 1.549312e-02 3 1  ON 41
ci_0043                -1.479221e-02 3 1  ON 42
ci_0044                -1.576829e-02 3 1  ON 43
ci_0045                 1.531370e-02 3 1  ON 44
ci_0046                 1.557101e-02 3 1  ON 45
ci_0047                -1.454519e-02 3 1  ON 46
ci_0048                -1.408713e-02 3 1  ON 47
ci_0049                -1.283128e-02 3 1  ON 48
ci_0050                -1.274841e-02 3 1  ON 49
ci_0051                -1.325398e-02 3 1  ON 50
ci_0052                -1.248946e-02 3 1  ON 51
ci_0053                -1.331071e-02 3 1  ON 52
ci_0054                -1.215678e-02 3 1  ON 53
ci_0055                 1.339387e-02 3 1  ON 54
ci_0056                 1.312958e-02 3 1  ON 55
ci_0057                 1.333799e-02 3 1  ON 56
ci_0058                 1.264902e-02 3 1  ON 57
ci_0059                -1.335218e-02 3 1  ON 58
ci_0060                -1.253517e-02 3 1  ON 59
ci_0061                -1.292909e-02 3 1  ON 60
ci_0062                -1.247073e-02 3 1  ON 61
ci_0063                -1.182921e-02 3 1  ON 62
ci_0064                -1.111467e-02 3 1  ON 63
ci_0065                -1.153970e-02 3 1  ON 64
ci_0066                -1.143022e-02 3 1  ON 65
ci_0067                -1.165611e-02 3 1  ON 66
ci_0068                -1.059764e-02 3 1  ON 67
ci_0069                 1.112593e-02 3 1  ON 68
ci_0070                 1.020149e-02 3 1  ON 69
ci_0071                 9.923987e-03 3 1  ON 70
ci_0072                 1.013805e-02 3 1  ON 71
ci_0073                 1.123469e-02 3 1  ON 72
ci_0074                 1.082088e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2699e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6706e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9826
    reference variance = 1.44878
====================================================
  Execution time = 1.3084e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0269e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5318e+00
  Total weights = 1.945810200e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2143e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561664237526
                                         uncertainty =       0.025817520877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561664237526
                                         uncertainty =       0.025817520877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131628989
  error estimate for blocks of size 2^( 2) =       0.001170894577
  error estimate for blocks of size 2^( 3) =       0.001205021483
  error estimate for blocks of size 2^( 4) =       0.001229023029
  error estimate for blocks of size 2^( 5) =       0.001243750270
  error estimate for blocks of size 2^( 6) =       0.001250803558
  error estimate for blocks of size 2^( 7) =       0.001255691410

      target function =                  N/A
              le_mean =     -16.717700543137
             les_mean =     282.013352086551
             stat err =       0.001244817067
             autocorr =       1.210048950608
              std dev =       1.600390669370
             le_variance =       2.561250294606


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671770054314e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717700542230       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717714324112       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717714537702       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e-01 is 4.528489e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717700542230       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717704582801       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717704569043       residual = 4.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+00 is 1.245168e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717700542230       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717701597959       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717701589572       residual = 2.83e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+01 is 3.324858e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.350782 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6309e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.069889e-01 3 1  ON 0
ci_0002                 6.796605e-01 3 1  ON 1
ci_0003                -4.797987e-02 3 1  ON 2
ci_0004                -4.645490e-02 3 1  ON 3
ci_0005                -4.600245e-02 3 1  ON 4
ci_0006                -4.371947e-02 3 1  ON 5
ci_0007                -3.129769e-02 3 1  ON 6
ci_0008                -3.133000e-02 3 1  ON 7
ci_0009                -3.238339e-02 3 1  ON 8
ci_0010                -3.084397e-02 3 1  ON 9
ci_0011                -2.715088e-02 3 1  ON 10
ci_0012                -2.612161e-02 3 1  ON 11
ci_0013                 2.731632e-02 3 1  ON 12
ci_0014                 2.672953e-02 3 1  ON 13
ci_0015                 2.747168e-02 3 1  ON 14
ci_0016                 2.655303e-02 3 1  ON 15
ci_0017                 2.463946e-02 3 1  ON 16
ci_0018                 2.335706e-02 3 1  ON 17
ci_0019                 2.062370e-02 3 1  ON 18
ci_0020                 1.945603e-02 3 1  ON 19
ci_0021                 1.831931e-02 3 1  ON 20
ci_0022                 1.822870e-02 3 1  ON 21
ci_0023                -1.979459e-02 3 1  ON 22
ci_0024                -1.830862e-02 3 1  ON 23
ci_0025                -1.854689e-02 3 1  ON 24
ci_0026                -1.782703e-02 3 1  ON 25
ci_0027                -1.767819e-02 3 1  ON 26
ci_0028                -1.717206e-02 3 1  ON 27
ci_0029                -1.518342e-02 3 1  ON 28
ci_0030                -1.629836e-02 3 1  ON 29
ci_0031                 1.521125e-02 3 1  ON 30
ci_0032                 1.413961e-02 3 1  ON 31
ci_0033                 1.669843e-02 3 1  ON 32
ci_0034                 1.600319e-02 3 1  ON 33
ci_0035                 1.740957e-02 3 1  ON 34
ci_0036                 1.723138e-02 3 1  ON 35
ci_0037                -1.529763e-02 3 1  ON 36
ci_0038                -1.423421e-02 3 1  ON 37
ci_0039                -1.570602e-02 3 1  ON 38
ci_0040                -1.503098e-02 3 1  ON 39
ci_0041                 1.615815e-02 3 1  ON 40
ci_0042                 1.546470e-02 3 1  ON 41
ci_0043                -1.483331e-02 3 1  ON 42
ci_0044                -1.580091e-02 3 1  ON 43
ci_0045                 1.529838e-02 3 1  ON 44
ci_0046                 1.554648e-02 3 1  ON 45
ci_0047                -1.458803e-02 3 1  ON 46
ci_0048                -1.407023e-02 3 1  ON 47
ci_0049                -1.284997e-02 3 1  ON 48
ci_0050                -1.279044e-02 3 1  ON 49
ci_0051                -1.325313e-02 3 1  ON 50
ci_0052                -1.243885e-02 3 1  ON 51
ci_0053                -1.328672e-02 3 1  ON 52
ci_0054                -1.217295e-02 3 1  ON 53
ci_0055                 1.330029e-02 3 1  ON 54
ci_0056                 1.309843e-02 3 1  ON 55
ci_0057                 1.334432e-02 3 1  ON 56
ci_0058                 1.263819e-02 3 1  ON 57
ci_0059                -1.333004e-02 3 1  ON 58
ci_0060                -1.245970e-02 3 1  ON 59
ci_0061                -1.285023e-02 3 1  ON 60
ci_0062                -1.245488e-02 3 1  ON 61
ci_0063                -1.180642e-02 3 1  ON 62
ci_0064                -1.109232e-02 3 1  ON 63
ci_0065                -1.152617e-02 3 1  ON 64
ci_0066                -1.146025e-02 3 1  ON 65
ci_0067                -1.162730e-02 3 1  ON 66
ci_0068                -1.072216e-02 3 1  ON 67
ci_0069                 1.111197e-02 3 1  ON 68
ci_0070                 1.024317e-02 3 1  ON 69
ci_0071                 9.919683e-03 3 1  ON 70
ci_0072                 1.008407e-02 3 1  ON 71
ci_0073                 1.121704e-02 3 1  ON 72
ci_0074                 1.079861e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8802
    reference variance = 1.39357
====================================================
  Execution time = 1.2780e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5615e+00
  Total weights = 1.9457e+06
  Execution time = 2.2252e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589253006232
                                         uncertainty =       0.031907647241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589253006232
                                         uncertainty =       0.031907647241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137764167
  error estimate for blocks of size 2^( 2) =       0.001176009778
  error estimate for blocks of size 2^( 3) =       0.001210485244
  error estimate for blocks of size 2^( 4) =       0.001232457657
  error estimate for blocks of size 2^( 5) =       0.001246705659
  error estimate for blocks of size 2^( 6) =       0.001250121947
  error estimate for blocks of size 2^( 7) =       0.001260375467

      target function =                  N/A
              le_mean =     -16.716150111690
             les_mean =     281.991305464113
             stat err =       0.001247415183
             autocorr =       1.202036201139
              std dev =       1.609067260656
             le_variance =       2.589097449313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589053503269
                                         uncertainty =       0.031903975699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589053503269
                                         uncertainty =       0.031903975699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137720385
  error estimate for blocks of size 2^( 2) =       0.001175970314
  error estimate for blocks of size 2^( 3) =       0.001210456199
  error estimate for blocks of size 2^( 4) =       0.001232431794
  error estimate for blocks of size 2^( 5) =       0.001246684779
  error estimate for blocks of size 2^( 6) =       0.001250095478
  error estimate for blocks of size 2^( 7) =       0.001260357275

      target function =                  N/A
              le_mean =     -16.716153492426
             les_mean =     281.991761487988
             stat err =       0.001247392332
             autocorr =       1.202084675842
              std dev =       1.609005341965
             le_variance =       2.588898190472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589122622424
                                         uncertainty =       0.031905258975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589122622424
                                         uncertainty =       0.031905258975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137735546
  error estimate for blocks of size 2^( 2) =       0.001175983604
  error estimate for blocks of size 2^( 3) =       0.001210465092
  error estimate for blocks of size 2^( 4) =       0.001232439437
  error estimate for blocks of size 2^( 5) =       0.001246690283
  error estimate for blocks of size 2^( 6) =       0.001250103713
  error estimate for blocks of size 2^( 7) =       0.001260361383

      target function =                  N/A
              le_mean =     -16.716151151403
             les_mean =     281.991120243034
             stat err =       0.001247398704
             autocorr =       1.202064919505
              std dev =       1.609026783776
             le_variance =       2.588967190908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589234436340
                                         uncertainty =       0.031907322340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589234436340
                                         uncertainty =       0.031907322340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137760091
  error estimate for blocks of size 2^( 2) =       0.001176006026
  error estimate for blocks of size 2^( 3) =       0.001210482254
  error estimate for blocks of size 2^( 4) =       0.001232454920
  error estimate for blocks of size 2^( 5) =       0.001246703366
  error estimate for blocks of size 2^( 6) =       0.001250119229
  error estimate for blocks of size 2^( 7) =       0.001260373184

      target function =                  N/A
              le_mean =     -16.716150066491
             les_mean =     281.991434360911
             stat err =       0.001247412675
             autocorr =       1.202039982282
              std dev =       1.609061495279
             le_variance =       2.589078895588


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716150111690        initial
     9.3132e-01     9.3132e+00             4.5285e-04       -16.716153492426  <--
     3.7253e+00     3.7253e+01             1.2452e-04       -16.716151151403
     1.4901e+01     1.4901e+02             3.3249e-05       -16.716150066491

*****************************************************************************
Applying the update for shift_i =   9.3132e-01     and shift_s =   9.3132e+00
*****************************************************************************

  Execution time = 2.4035e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.070787e-01 3 1  ON 0
ci_0002                 6.795816e-01 3 1  ON 1
ci_0003                -4.789875e-02 3 1  ON 2
ci_0004                -4.642409e-02 3 1  ON 3
ci_0005                -4.595485e-02 3 1  ON 4
ci_0006                -4.395724e-02 3 1  ON 5
ci_0007                -3.117299e-02 3 1  ON 6
ci_0008                -3.137216e-02 3 1  ON 7
ci_0009                -3.242981e-02 3 1  ON 8
ci_0010                -3.093719e-02 3 1  ON 9
ci_0011                -2.724469e-02 3 1  ON 10
ci_0012                -2.629637e-02 3 1  ON 11
ci_0013                 2.731624e-02 3 1  ON 12
ci_0014                 2.672261e-02 3 1  ON 13
ci_0015                 2.725051e-02 3 1  ON 14
ci_0016                 2.653968e-02 3 1  ON 15
ci_0017                 2.464084e-02 3 1  ON 16
ci_0018                 2.334606e-02 3 1  ON 17
ci_0019                 2.054463e-02 3 1  ON 18
ci_0020                 1.943155e-02 3 1  ON 19
ci_0021                 1.821397e-02 3 1  ON 20
ci_0022                 1.819520e-02 3 1  ON 21
ci_0023                -1.978354e-02 3 1  ON 22
ci_0024                -1.834158e-02 3 1  ON 23
ci_0025                -1.825360e-02 3 1  ON 24
ci_0026                -1.788548e-02 3 1  ON 25
ci_0027                -1.757527e-02 3 1  ON 26
ci_0028                -1.699994e-02 3 1  ON 27
ci_0029                -1.521116e-02 3 1  ON 28
ci_0030                -1.644204e-02 3 1  ON 29
ci_0031                 1.517209e-02 3 1  ON 30
ci_0032                 1.399237e-02 3 1  ON 31
ci_0033                 1.702692e-02 3 1  ON 32
ci_0034                 1.602427e-02 3 1  ON 33
ci_0035                 1.747616e-02 3 1  ON 34
ci_0036                 1.725265e-02 3 1  ON 35
ci_0037                -1.537560e-02 3 1  ON 36
ci_0038                -1.402829e-02 3 1  ON 37
ci_0039                -1.578312e-02 3 1  ON 38
ci_0040                -1.512063e-02 3 1  ON 39
ci_0041                 1.614287e-02 3 1  ON 40
ci_0042                 1.539198e-02 3 1  ON 41
ci_0043                -1.494418e-02 3 1  ON 42
ci_0044                -1.588745e-02 3 1  ON 43
ci_0045                 1.525920e-02 3 1  ON 44
ci_0046                 1.548233e-02 3 1  ON 45
ci_0047                -1.468041e-02 3 1  ON 46
ci_0048                -1.403329e-02 3 1  ON 47
ci_0049                -1.289479e-02 3 1  ON 48
ci_0050                -1.289039e-02 3 1  ON 49
ci_0051                -1.325128e-02 3 1  ON 50
ci_0052                -1.232858e-02 3 1  ON 51
ci_0053                -1.323477e-02 3 1  ON 52
ci_0054                -1.220542e-02 3 1  ON 53
ci_0055                 1.306196e-02 3 1  ON 54
ci_0056                 1.301975e-02 3 1  ON 55
ci_0057                 1.335944e-02 3 1  ON 56
ci_0058                 1.261070e-02 3 1  ON 57
ci_0059                -1.328032e-02 3 1  ON 58
ci_0060                -1.229089e-02 3 1  ON 59
ci_0061                -1.265529e-02 3 1  ON 60
ci_0062                -1.241592e-02 3 1  ON 61
ci_0063                -1.175481e-02 3 1  ON 62
ci_0064                -1.104211e-02 3 1  ON 63
ci_0065                -1.149811e-02 3 1  ON 64
ci_0066                -1.152842e-02 3 1  ON 65
ci_0067                -1.156719e-02 3 1  ON 66
ci_0068                -1.099235e-02 3 1  ON 67
ci_0069                 1.108425e-02 3 1  ON 68
ci_0070                 1.033006e-02 3 1  ON 69
ci_0071                 9.908544e-03 3 1  ON 70
ci_0072                 9.961324e-03 3 1  ON 71
ci_0073                 1.118021e-02 3 1  ON 72
ci_0074                 1.075003e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0356e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6714e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.7205
    reference variance = 1.83234
====================================================
  Execution time = 1.3088e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0270e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5576e+00
  Total weights = 1.945706883e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1771e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.584447064484
                                         uncertainty =       0.039665528438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.584447064484
                                         uncertainty =       0.039665528438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136545598
  error estimate for blocks of size 2^( 2) =       0.001176815013
  error estimate for blocks of size 2^( 3) =       0.001209693128
  error estimate for blocks of size 2^( 4) =       0.001233289828
  error estimate for blocks of size 2^( 5) =       0.001247398448
  error estimate for blocks of size 2^( 6) =       0.001255485711
  error estimate for blocks of size 2^( 7) =       0.001267545140

      target function =                  N/A
              le_mean =     -16.717119795939
             les_mean =     282.019660012170
             stat err =       0.001250929782
             autocorr =       1.211412739465
              std dev =       1.607343915129
             le_variance =       2.583554461503


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671711979594e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717119795017       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717096193566       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717119471917       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717120740661       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.717121270958       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.717121198598       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e-01 is 1.903445e-03

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717119795017       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717109149061       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717117581009       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717117872039       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.717117886490       residual = 9.52e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e-01 is 6.377360e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717119795017       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717116463688       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717118815162       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717118892087       residual = 8.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+00 is 1.754187e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.354843 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6276e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.067775e-01 3 1  ON 0
ci_0002                 6.799053e-01 3 1  ON 1
ci_0003                -4.791817e-02 3 1  ON 2
ci_0004                -4.658908e-02 3 1  ON 3
ci_0005                -4.621849e-02 3 1  ON 4
ci_0006                -4.392322e-02 3 1  ON 5
ci_0007                -3.151221e-02 3 1  ON 6
ci_0008                -3.107772e-02 3 1  ON 7
ci_0009                -3.227016e-02 3 1  ON 8
ci_0010                -3.108692e-02 3 1  ON 9
ci_0011                -2.741115e-02 3 1  ON 10
ci_0012                -2.626402e-02 3 1  ON 11
ci_0013                 2.765262e-02 3 1  ON 12
ci_0014                 2.657510e-02 3 1  ON 13
ci_0015                 2.700147e-02 3 1  ON 14
ci_0016                 2.636725e-02 3 1  ON 15
ci_0017                 2.439442e-02 3 1  ON 16
ci_0018                 2.325502e-02 3 1  ON 17
ci_0019                 2.033233e-02 3 1  ON 18
ci_0020                 1.934502e-02 3 1  ON 19
ci_0021                 1.834487e-02 3 1  ON 20
ci_0022                 1.824608e-02 3 1  ON 21
ci_0023                -1.987951e-02 3 1  ON 22
ci_0024                -1.835749e-02 3 1  ON 23
ci_0025                -1.832569e-02 3 1  ON 24
ci_0026                -1.784468e-02 3 1  ON 25
ci_0027                -1.780723e-02 3 1  ON 26
ci_0028                -1.739555e-02 3 1  ON 27
ci_0029                -1.524905e-02 3 1  ON 28
ci_0030                -1.606382e-02 3 1  ON 29
ci_0031                 1.467389e-02 3 1  ON 30
ci_0032                 1.405915e-02 3 1  ON 31
ci_0033                 1.697758e-02 3 1  ON 32
ci_0034                 1.615133e-02 3 1  ON 33
ci_0035                 1.767517e-02 3 1  ON 34
ci_0036                 1.745186e-02 3 1  ON 35
ci_0037                -1.509624e-02 3 1  ON 36
ci_0038                -1.427018e-02 3 1  ON 37
ci_0039                -1.587291e-02 3 1  ON 38
ci_0040                -1.504125e-02 3 1  ON 39
ci_0041                 1.622167e-02 3 1  ON 40
ci_0042                 1.539450e-02 3 1  ON 41
ci_0043                -1.516275e-02 3 1  ON 42
ci_0044                -1.524971e-02 3 1  ON 43
ci_0045                 1.490531e-02 3 1  ON 44
ci_0046                 1.549757e-02 3 1  ON 45
ci_0047                -1.465621e-02 3 1  ON 46
ci_0048                -1.399967e-02 3 1  ON 47
ci_0049                -1.297794e-02 3 1  ON 48
ci_0050                -1.292694e-02 3 1  ON 49
ci_0051                -1.303538e-02 3 1  ON 50
ci_0052                -1.259853e-02 3 1  ON 51
ci_0053                -1.313547e-02 3 1  ON 52
ci_0054                -1.202256e-02 3 1  ON 53
ci_0055                 1.328012e-02 3 1  ON 54
ci_0056                 1.281613e-02 3 1  ON 55
ci_0057                 1.294221e-02 3 1  ON 56
ci_0058                 1.225736e-02 3 1  ON 57
ci_0059                -1.362403e-02 3 1  ON 58
ci_0060                -1.234288e-02 3 1  ON 59
ci_0061                -1.282104e-02 3 1  ON 60
ci_0062                -1.225215e-02 3 1  ON 61
ci_0063                -1.171940e-02 3 1  ON 62
ci_0064                -1.113340e-02 3 1  ON 63
ci_0065                -1.149650e-02 3 1  ON 64
ci_0066                -1.119638e-02 3 1  ON 65
ci_0067                -1.142143e-02 3 1  ON 66
ci_0068                -1.077283e-02 3 1  ON 67
ci_0069                 1.101388e-02 3 1  ON 68
ci_0070                 1.039377e-02 3 1  ON 69
ci_0071                 9.908330e-03 3 1  ON 70
ci_0072                 1.020784e-02 3 1  ON 71
ci_0073                 1.095008e-02 3 1  ON 72
ci_0074                 1.101479e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.6315
    reference variance = 1.78132
====================================================
  Execution time = 1.2773e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5493e+00
  Total weights = 1.9456e+06
  Execution time = 2.2164e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.576371801320
                                         uncertainty =       0.037023171920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.576371801320
                                         uncertainty =       0.037023171920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135296573
  error estimate for blocks of size 2^( 2) =       0.001174361049
  error estimate for blocks of size 2^( 3) =       0.001206405939
  error estimate for blocks of size 2^( 4) =       0.001227900858
  error estimate for blocks of size 2^( 5) =       0.001243241431
  error estimate for blocks of size 2^( 6) =       0.001247094730
  error estimate for blocks of size 2^( 7) =       0.001246001457

      target function =                  N/A
              le_mean =     -16.716845281659
             les_mean =     282.004035209126
             stat err =       0.001241059619
             autocorr =       1.194996508022
              std dev =       1.605577499441
             le_variance =       2.577879106710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.576587549149
                                         uncertainty =       0.037022357407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.576587549149
                                         uncertainty =       0.037022357407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135344041
  error estimate for blocks of size 2^( 2) =       0.001174429756
  error estimate for blocks of size 2^( 3) =       0.001206484791
  error estimate for blocks of size 2^( 4) =       0.001228005869
  error estimate for blocks of size 2^( 5) =       0.001243343960
  error estimate for blocks of size 2^( 6) =       0.001247234352
  error estimate for blocks of size 2^( 7) =       0.001246081810

      target function =                  N/A
              le_mean =     -16.716835581392
             les_mean =     282.022148772386
             stat err =       0.001241166498
             autocorr =       1.195102401627
              std dev =       1.605644630088
             le_variance =       2.578094678131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.576628426224
                                         uncertainty =       0.037012485124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.576628426224
                                         uncertainty =       0.037012485124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135352902
  error estimate for blocks of size 2^( 2) =       0.001174430624
  error estimate for blocks of size 2^( 3) =       0.001206471953
  error estimate for blocks of size 2^( 4) =       0.001227979297
  error estimate for blocks of size 2^( 5) =       0.001243304737
  error estimate for blocks of size 2^( 6) =       0.001247167478
  error estimate for blocks of size 2^( 7) =       0.001246036129

      target function =                  N/A
              le_mean =     -16.716825801258
             les_mean =     283.043963936658
             stat err =       0.001241121910
             autocorr =       1.194997884657
              std dev =       1.605657161723
             le_variance =       2.578134920993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.576357408426
                                         uncertainty =       0.037023156255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.576357408426
                                         uncertainty =       0.037023156255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135293407
  error estimate for blocks of size 2^( 2) =       0.001174361395
  error estimate for blocks of size 2^( 3) =       0.001206407316
  error estimate for blocks of size 2^( 4) =       0.001227907041
  error estimate for blocks of size 2^( 5) =       0.001243249043
  error estimate for blocks of size 2^( 6) =       0.001247103603
  error estimate for blocks of size 2^( 7) =       0.001246000757

      target function =                  N/A
              le_mean =     -16.716840977458
             les_mean =     282.006696330456
             stat err =       0.001241065111
             autocorr =       1.195013748478
              std dev =       1.605573022428
             le_variance =       2.577864730348


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716845281659        initial  <--
     2.3283e-01     2.3283e+00             1.9034e-03       -16.716835581392
     9.3132e-01     9.3132e+00             6.3774e-04       -16.716825801258
     3.7253e+00     3.7253e+01             1.7542e-04       -16.716840977458

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9798
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.070787e-01 3 1  ON 0
ci_0002                 6.795816e-01 3 1  ON 1
ci_0003                -4.789875e-02 3 1  ON 2
ci_0004                -4.642409e-02 3 1  ON 3
ci_0005                -4.595485e-02 3 1  ON 4
ci_0006                -4.395724e-02 3 1  ON 5
ci_0007                -3.117299e-02 3 1  ON 6
ci_0008                -3.137216e-02 3 1  ON 7
ci_0009                -3.242981e-02 3 1  ON 8
ci_0010                -3.093719e-02 3 1  ON 9
ci_0011                -2.724469e-02 3 1  ON 10
ci_0012                -2.629637e-02 3 1  ON 11
ci_0013                 2.731624e-02 3 1  ON 12
ci_0014                 2.672261e-02 3 1  ON 13
ci_0015                 2.725051e-02 3 1  ON 14
ci_0016                 2.653968e-02 3 1  ON 15
ci_0017                 2.464084e-02 3 1  ON 16
ci_0018                 2.334606e-02 3 1  ON 17
ci_0019                 2.054463e-02 3 1  ON 18
ci_0020                 1.943155e-02 3 1  ON 19
ci_0021                 1.821397e-02 3 1  ON 20
ci_0022                 1.819520e-02 3 1  ON 21
ci_0023                -1.978354e-02 3 1  ON 22
ci_0024                -1.834158e-02 3 1  ON 23
ci_0025                -1.825360e-02 3 1  ON 24
ci_0026                -1.788548e-02 3 1  ON 25
ci_0027                -1.757527e-02 3 1  ON 26
ci_0028                -1.699994e-02 3 1  ON 27
ci_0029                -1.521116e-02 3 1  ON 28
ci_0030                -1.644204e-02 3 1  ON 29
ci_0031                 1.517209e-02 3 1  ON 30
ci_0032                 1.399237e-02 3 1  ON 31
ci_0033                 1.702692e-02 3 1  ON 32
ci_0034                 1.602427e-02 3 1  ON 33
ci_0035                 1.747616e-02 3 1  ON 34
ci_0036                 1.725265e-02 3 1  ON 35
ci_0037                -1.537560e-02 3 1  ON 36
ci_0038                -1.402829e-02 3 1  ON 37
ci_0039                -1.578312e-02 3 1  ON 38
ci_0040                -1.512063e-02 3 1  ON 39
ci_0041                 1.614287e-02 3 1  ON 40
ci_0042                 1.539198e-02 3 1  ON 41
ci_0043                -1.494418e-02 3 1  ON 42
ci_0044                -1.588745e-02 3 1  ON 43
ci_0045                 1.525920e-02 3 1  ON 44
ci_0046                 1.548233e-02 3 1  ON 45
ci_0047                -1.468041e-02 3 1  ON 46
ci_0048                -1.403329e-02 3 1  ON 47
ci_0049                -1.289479e-02 3 1  ON 48
ci_0050                -1.289039e-02 3 1  ON 49
ci_0051                -1.325128e-02 3 1  ON 50
ci_0052                -1.232858e-02 3 1  ON 51
ci_0053                -1.323477e-02 3 1  ON 52
ci_0054                -1.220542e-02 3 1  ON 53
ci_0055                 1.306196e-02 3 1  ON 54
ci_0056                 1.301975e-02 3 1  ON 55
ci_0057                 1.335944e-02 3 1  ON 56
ci_0058                 1.261070e-02 3 1  ON 57
ci_0059                -1.328032e-02 3 1  ON 58
ci_0060                -1.229089e-02 3 1  ON 59
ci_0061                -1.265529e-02 3 1  ON 60
ci_0062                -1.241592e-02 3 1  ON 61
ci_0063                -1.175481e-02 3 1  ON 62
ci_0064                -1.104211e-02 3 1  ON 63
ci_0065                -1.149811e-02 3 1  ON 64
ci_0066                -1.152842e-02 3 1  ON 65
ci_0067                -1.156719e-02 3 1  ON 66
ci_0068                -1.099235e-02 3 1  ON 67
ci_0069                 1.108425e-02 3 1  ON 68
ci_0070                 1.033006e-02 3 1  ON 69
ci_0071                 9.908544e-03 3 1  ON 70
ci_0072                 9.961324e-03 3 1  ON 71
ci_0073                 1.118021e-02 3 1  ON 72
ci_0074                 1.075003e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0271e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6713e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.5659
    reference variance = 2.57841
====================================================
  Execution time = 1.3093e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0267e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5745e+00
  Total weights = 1.945542395e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1973e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.605611954193
                                         uncertainty =       0.042938652268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.605611954193
                                         uncertainty =       0.042938652268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001141273527
  error estimate for blocks of size 2^( 2) =       0.001179204926
  error estimate for blocks of size 2^( 3) =       0.001210508522
  error estimate for blocks of size 2^( 4) =       0.001232391768
  error estimate for blocks of size 2^( 5) =       0.001244511289
  error estimate for blocks of size 2^( 6) =       0.001251226396
  error estimate for blocks of size 2^( 7) =       0.001257516437

      target function =                  N/A
              le_mean =     -16.719510368459
             les_mean =     282.116527862471
             stat err =       0.001246411472
             autocorr =       1.192733420146
              std dev =       1.614030324715
             le_variance =       2.605093889098


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671951036846e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719510367571       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719516824235       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719516885520       residual = 1.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+00 is 1.619825e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719510367571       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719512101504       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719512115090       residual = 1.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+00 is 4.183216e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719510367571       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719510809247       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719510812618       residual = 1.35e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+01 is 1.064913e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.357716 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6302e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.070923e-01 3 1  ON 0
ci_0002                 6.795742e-01 3 1  ON 1
ci_0003                -4.790452e-02 3 1  ON 2
ci_0004                -4.640286e-02 3 1  ON 3
ci_0005                -4.593232e-02 3 1  ON 4
ci_0006                -4.393297e-02 3 1  ON 5
ci_0007                -3.116072e-02 3 1  ON 6
ci_0008                -3.139090e-02 3 1  ON 7
ci_0009                -3.244261e-02 3 1  ON 8
ci_0010                -3.092392e-02 3 1  ON 9
ci_0011                -2.726148e-02 3 1  ON 10
ci_0012                -2.630770e-02 3 1  ON 11
ci_0013                 2.731496e-02 3 1  ON 12
ci_0014                 2.669782e-02 3 1  ON 13
ci_0015                 2.725984e-02 3 1  ON 14
ci_0016                 2.652124e-02 3 1  ON 15
ci_0017                 2.463332e-02 3 1  ON 16
ci_0018                 2.333367e-02 3 1  ON 17
ci_0019                 2.054396e-02 3 1  ON 18
ci_0020                 1.942591e-02 3 1  ON 19
ci_0021                 1.822373e-02 3 1  ON 20
ci_0022                 1.818678e-02 3 1  ON 21
ci_0023                -1.976206e-02 3 1  ON 22
ci_0024                -1.832594e-02 3 1  ON 23
ci_0025                -1.826441e-02 3 1  ON 24
ci_0026                -1.789201e-02 3 1  ON 25
ci_0027                -1.758363e-02 3 1  ON 26
ci_0028                -1.698572e-02 3 1  ON 27
ci_0029                -1.524061e-02 3 1  ON 28
ci_0030                -1.642779e-02 3 1  ON 29
ci_0031                 1.519570e-02 3 1  ON 30
ci_0032                 1.399267e-02 3 1  ON 31
ci_0033                 1.700840e-02 3 1  ON 32
ci_0034                 1.600950e-02 3 1  ON 33
ci_0035                 1.746798e-02 3 1  ON 34
ci_0036                 1.725699e-02 3 1  ON 35
ci_0037                -1.537195e-02 3 1  ON 36
ci_0038                -1.406121e-02 3 1  ON 37
ci_0039                -1.576434e-02 3 1  ON 38
ci_0040                -1.513511e-02 3 1  ON 39
ci_0041                 1.614026e-02 3 1  ON 40
ci_0042                 1.543381e-02 3 1  ON 41
ci_0043                -1.496773e-02 3 1  ON 42
ci_0044                -1.584563e-02 3 1  ON 43
ci_0045                 1.526721e-02 3 1  ON 44
ci_0046                 1.545129e-02 3 1  ON 45
ci_0047                -1.465165e-02 3 1  ON 46
ci_0048                -1.403683e-02 3 1  ON 47
ci_0049                -1.292581e-02 3 1  ON 48
ci_0050                -1.289029e-02 3 1  ON 49
ci_0051                -1.324566e-02 3 1  ON 50
ci_0052                -1.233004e-02 3 1  ON 51
ci_0053                -1.323668e-02 3 1  ON 52
ci_0054                -1.220449e-02 3 1  ON 53
ci_0055                 1.305903e-02 3 1  ON 54
ci_0056                 1.301699e-02 3 1  ON 55
ci_0057                 1.333742e-02 3 1  ON 56
ci_0058                 1.263255e-02 3 1  ON 57
ci_0059                -1.324917e-02 3 1  ON 58
ci_0060                -1.232648e-02 3 1  ON 59
ci_0061                -1.265062e-02 3 1  ON 60
ci_0062                -1.239426e-02 3 1  ON 61
ci_0063                -1.178223e-02 3 1  ON 62
ci_0064                -1.107868e-02 3 1  ON 63
ci_0065                -1.149067e-02 3 1  ON 64
ci_0066                -1.152855e-02 3 1  ON 65
ci_0067                -1.156101e-02 3 1  ON 66
ci_0068                -1.097902e-02 3 1  ON 67
ci_0069                 1.104593e-02 3 1  ON 68
ci_0070                 1.031455e-02 3 1  ON 69
ci_0071                 9.907893e-03 3 1  ON 70
ci_0072                 9.949638e-03 3 1  ON 71
ci_0073                 1.115820e-02 3 1  ON 72
ci_0074                 1.075521e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.7388
    reference variance = 2.01581
====================================================
  Execution time = 1.2860e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5262e+00
  Total weights = 1.9456e+06
  Execution time = 2.2197e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552349007183
                                         uncertainty =       0.024801189410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552349007183
                                         uncertainty =       0.024801189410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129763989
  error estimate for blocks of size 2^( 2) =       0.001167741746
  error estimate for blocks of size 2^( 3) =       0.001200156830
  error estimate for blocks of size 2^( 4) =       0.001223541302
  error estimate for blocks of size 2^( 5) =       0.001238732334
  error estimate for blocks of size 2^( 6) =       0.001246965368
  error estimate for blocks of size 2^( 7) =       0.001248254861

      target function =                  N/A
              le_mean =     -16.718334748877
             les_mean =     282.030497836367
             stat err =       0.001239373466
             autocorr =       1.203452443256
              std dev =       1.597753119172
             le_variance =       2.552815029824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552272498168
                                         uncertainty =       0.024800961335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552272498168
                                         uncertainty =       0.024800961335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129747067
  error estimate for blocks of size 2^( 2) =       0.001167728428
  error estimate for blocks of size 2^( 3) =       0.001200148106
  error estimate for blocks of size 2^( 4) =       0.001223536494
  error estimate for blocks of size 2^( 5) =       0.001238724200
  error estimate for blocks of size 2^( 6) =       0.001246956839
  error estimate for blocks of size 2^( 7) =       0.001248249248

      target function =                  N/A
              le_mean =     -16.718335442333
             les_mean =     282.028870322561
             stat err =       0.001239366695
             autocorr =       1.203475346872
              std dev =       1.597729186767
             le_variance =       2.552738554247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552305049964
                                         uncertainty =       0.024801069139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552305049964
                                         uncertainty =       0.024801069139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129754267
  error estimate for blocks of size 2^( 2) =       0.001167734070
  error estimate for blocks of size 2^( 3) =       0.001200151573
  error estimate for blocks of size 2^( 4) =       0.001223538089
  error estimate for blocks of size 2^( 5) =       0.001238727308
  error estimate for blocks of size 2^( 6) =       0.001246959970
  error estimate for blocks of size 2^( 7) =       0.001248250564

      target function =                  N/A
              le_mean =     -16.718334960338
             les_mean =     282.028822145373
             stat err =       0.001239368983
             autocorr =       1.203464449207
              std dev =       1.597739369481
             le_variance =       2.552771092791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552343138710
                                         uncertainty =       0.024801171819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552343138710
                                         uncertainty =       0.024801171819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129762691
  error estimate for blocks of size 2^( 2) =       0.001167740749
  error estimate for blocks of size 2^( 3) =       0.001200156167
  error estimate for blocks of size 2^( 4) =       0.001223540945
  error estimate for blocks of size 2^( 5) =       0.001238731709
  error estimate for blocks of size 2^( 6) =       0.001246964579
  error estimate for blocks of size 2^( 7) =       0.001248253770

      target function =                  N/A
              le_mean =     -16.718334694656
             les_mean =     282.029253438465
             stat err =       0.001239372751
             autocorr =       1.203453818965
              std dev =       1.597751283568
             le_variance =       2.552809164143


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718334748877        initial
     2.3283e+00     2.3283e+01             1.6198e-04       -16.718335442333  <--
     9.3132e+00     9.3132e+01             4.1832e-05       -16.718334960338
     3.7253e+01     3.7253e+02             1.0649e-05       -16.718334694656

*****************************************************************************
Applying the update for shift_i =   2.3283e+00     and shift_s =   2.3283e+01
*****************************************************************************

  Execution time = 2.4078e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.071322e-01 3 1  ON 0
ci_0002                 6.795508e-01 3 1  ON 1
ci_0003                -4.791984e-02 3 1  ON 2
ci_0004                -4.634387e-02 3 1  ON 3
ci_0005                -4.586839e-02 3 1  ON 4
ci_0006                -4.386424e-02 3 1  ON 5
ci_0007                -3.112528e-02 3 1  ON 6
ci_0008                -3.144471e-02 3 1  ON 7
ci_0009                -3.247730e-02 3 1  ON 8
ci_0010                -3.088892e-02 3 1  ON 9
ci_0011                -2.730788e-02 3 1  ON 10
ci_0012                -2.633995e-02 3 1  ON 11
ci_0013                 2.731112e-02 3 1  ON 12
ci_0014                 2.663056e-02 3 1  ON 13
ci_0015                 2.728483e-02 3 1  ON 14
ci_0016                 2.647168e-02 3 1  ON 15
ci_0017                 2.461279e-02 3 1  ON 16
ci_0018                 2.330076e-02 3 1  ON 17
ci_0019                 2.054198e-02 3 1  ON 18
ci_0020                 1.941161e-02 3 1  ON 19
ci_0021                 1.825222e-02 3 1  ON 20
ci_0022                 1.816209e-02 3 1  ON 21
ci_0023                -1.970405e-02 3 1  ON 22
ci_0024                -1.828450e-02 3 1  ON 23
ci_0025                -1.829437e-02 3 1  ON 24
ci_0026                -1.790973e-02 3 1  ON 25
ci_0027                -1.760659e-02 3 1  ON 26
ci_0028                -1.694808e-02 3 1  ON 27
ci_0029                -1.532178e-02 3 1  ON 28
ci_0030                -1.638926e-02 3 1  ON 29
ci_0031                 1.526197e-02 3 1  ON 30
ci_0032                 1.399370e-02 3 1  ON 31
ci_0033                 1.695599e-02 3 1  ON 32
ci_0034                 1.596693e-02 3 1  ON 33
ci_0035                 1.744517e-02 3 1  ON 34
ci_0036                 1.726898e-02 3 1  ON 35
ci_0037                -1.536183e-02 3 1  ON 36
ci_0038                -1.415271e-02 3 1  ON 37
ci_0039                -1.571633e-02 3 1  ON 38
ci_0040                -1.517246e-02 3 1  ON 39
ci_0041                 1.613334e-02 3 1  ON 40
ci_0042                 1.554824e-02 3 1  ON 41
ci_0043                -1.503546e-02 3 1  ON 42
ci_0044                -1.572547e-02 3 1  ON 43
ci_0045                 1.528976e-02 3 1  ON 44
ci_0046                 1.536409e-02 3 1  ON 45
ci_0047                -1.457738e-02 3 1  ON 46
ci_0048                -1.404608e-02 3 1  ON 47
ci_0049                -1.301069e-02 3 1  ON 48
ci_0050                -1.288993e-02 3 1  ON 49
ci_0051                -1.323077e-02 3 1  ON 50
ci_0052                -1.233406e-02 3 1  ON 51
ci_0053                -1.324230e-02 3 1  ON 52
ci_0054                -1.220224e-02 3 1  ON 53
ci_0055                 1.305073e-02 3 1  ON 54
ci_0056                 1.300869e-02 3 1  ON 55
ci_0057                 1.327659e-02 3 1  ON 56
ci_0058                 1.269325e-02 3 1  ON 57
ci_0059                -1.316712e-02 3 1  ON 58
ci_0060                -1.242084e-02 3 1  ON 59
ci_0061                -1.263814e-02 3 1  ON 60
ci_0062                -1.233471e-02 3 1  ON 61
ci_0063                -1.185484e-02 3 1  ON 62
ci_0064                -1.117628e-02 3 1  ON 63
ci_0065                -1.147048e-02 3 1  ON 64
ci_0066                -1.152794e-02 3 1  ON 65
ci_0067                -1.154549e-02 3 1  ON 66
ci_0068                -1.094407e-02 3 1  ON 67
ci_0069                 1.094674e-02 3 1  ON 68
ci_0070                 1.027401e-02 3 1  ON 69
ci_0071                 9.905640e-03 3 1  ON 70
ci_0072                 9.916824e-03 3 1  ON 71
ci_0073                 1.110152e-02 3 1  ON 72
ci_0074                 1.076826e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0393e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6711e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.7573
    reference variance = 1.50908
====================================================
  Execution time = 1.3073e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0260e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5505e+00
  Total weights = 1.945616552e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2073e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577429974730
                                         uncertainty =       0.029669215049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577429974730
                                         uncertainty =       0.029669215049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135692271
  error estimate for blocks of size 2^( 2) =       0.001173912606
  error estimate for blocks of size 2^( 3) =       0.001206662718
  error estimate for blocks of size 2^( 4) =       0.001229691872
  error estimate for blocks of size 2^( 5) =       0.001245054554
  error estimate for blocks of size 2^( 6) =       0.001250924274
  error estimate for blocks of size 2^( 7) =       0.001256480221

      target function =                  N/A
              le_mean =     -16.719534434233
             les_mean =     282.093363221860
             stat err =       0.001245537730
             autocorr =       1.202797275504
              std dev =       1.606137109309
             le_variance =       2.579676413899


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671953443423e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719534433294       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719565972455       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719570931727       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719570795954       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e-01 is 8.253209e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719534433294       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719544523313       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719545964860       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719545945069       residual = 1.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+00 is 2.618359e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719534433294       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719537145430       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719537525956       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719537521390       residual = 4.31e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+00 is 7.017105e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.359228 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6287e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.071985e-01 3 1  ON 0
ci_0002                 6.795049e-01 3 1  ON 1
ci_0003                -4.794494e-02 3 1  ON 2
ci_0004                -4.636004e-02 3 1  ON 3
ci_0005                -4.580638e-02 3 1  ON 4
ci_0006                -4.388984e-02 3 1  ON 5
ci_0007                -3.106748e-02 3 1  ON 6
ci_0008                -3.136618e-02 3 1  ON 7
ci_0009                -3.242092e-02 3 1  ON 8
ci_0010                -3.081783e-02 3 1  ON 9
ci_0011                -2.751047e-02 3 1  ON 10
ci_0012                -2.644786e-02 3 1  ON 11
ci_0013                 2.716816e-02 3 1  ON 12
ci_0014                 2.672125e-02 3 1  ON 13
ci_0015                 2.731866e-02 3 1  ON 14
ci_0016                 2.642241e-02 3 1  ON 15
ci_0017                 2.435502e-02 3 1  ON 16
ci_0018                 2.334241e-02 3 1  ON 17
ci_0019                 2.053688e-02 3 1  ON 18
ci_0020                 1.946917e-02 3 1  ON 19
ci_0021                 1.834536e-02 3 1  ON 20
ci_0022                 1.812037e-02 3 1  ON 21
ci_0023                -1.955403e-02 3 1  ON 22
ci_0024                -1.809907e-02 3 1  ON 23
ci_0025                -1.830942e-02 3 1  ON 24
ci_0026                -1.780125e-02 3 1  ON 25
ci_0027                -1.753199e-02 3 1  ON 26
ci_0028                -1.695350e-02 3 1  ON 27
ci_0029                -1.540951e-02 3 1  ON 28
ci_0030                -1.631042e-02 3 1  ON 29
ci_0031                 1.535397e-02 3 1  ON 30
ci_0032                 1.398175e-02 3 1  ON 31
ci_0033                 1.697229e-02 3 1  ON 32
ci_0034                 1.594079e-02 3 1  ON 33
ci_0035                 1.754631e-02 3 1  ON 34
ci_0036                 1.714825e-02 3 1  ON 35
ci_0037                -1.530217e-02 3 1  ON 36
ci_0038                -1.412407e-02 3 1  ON 37
ci_0039                -1.573827e-02 3 1  ON 38
ci_0040                -1.512741e-02 3 1  ON 39
ci_0041                 1.601680e-02 3 1  ON 40
ci_0042                 1.559030e-02 3 1  ON 41
ci_0043                -1.502053e-02 3 1  ON 42
ci_0044                -1.579376e-02 3 1  ON 43
ci_0045                 1.530092e-02 3 1  ON 44
ci_0046                 1.549729e-02 3 1  ON 45
ci_0047                -1.456583e-02 3 1  ON 46
ci_0048                -1.409469e-02 3 1  ON 47
ci_0049                -1.284300e-02 3 1  ON 48
ci_0050                -1.315177e-02 3 1  ON 49
ci_0051                -1.329907e-02 3 1  ON 50
ci_0052                -1.247224e-02 3 1  ON 51
ci_0053                -1.310437e-02 3 1  ON 52
ci_0054                -1.221202e-02 3 1  ON 53
ci_0055                 1.287890e-02 3 1  ON 54
ci_0056                 1.292124e-02 3 1  ON 55
ci_0057                 1.324404e-02 3 1  ON 56
ci_0058                 1.260518e-02 3 1  ON 57
ci_0059                -1.310407e-02 3 1  ON 58
ci_0060                -1.252473e-02 3 1  ON 59
ci_0061                -1.264274e-02 3 1  ON 60
ci_0062                -1.252148e-02 3 1  ON 61
ci_0063                -1.188234e-02 3 1  ON 62
ci_0064                -1.119447e-02 3 1  ON 63
ci_0065                -1.143430e-02 3 1  ON 64
ci_0066                -1.161989e-02 3 1  ON 65
ci_0067                -1.138565e-02 3 1  ON 66
ci_0068                -1.088994e-02 3 1  ON 67
ci_0069                 1.086523e-02 3 1  ON 68
ci_0070                 1.021214e-02 3 1  ON 69
ci_0071                 9.929464e-03 3 1  ON 70
ci_0072                 9.801897e-03 3 1  ON 71
ci_0073                 1.124202e-02 3 1  ON 72
ci_0074                 1.068858e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8854
    reference variance = 1.56505
====================================================
  Execution time = 1.2754e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5445e+00
  Total weights = 1.9457e+06
  Execution time = 2.2146e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.572772980101
                                         uncertainty =       0.028938548067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.572772980101
                                         uncertainty =       0.028938548067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134241475
  error estimate for blocks of size 2^( 2) =       0.001172739906
  error estimate for blocks of size 2^( 3) =       0.001205333246
  error estimate for blocks of size 2^( 4) =       0.001229591592
  error estimate for blocks of size 2^( 5) =       0.001243701776
  error estimate for blocks of size 2^( 6) =       0.001249603679
  error estimate for blocks of size 2^( 7) =       0.001261100556

      target function =                  N/A
              le_mean =     -16.719570644584
             les_mean =     282.097379035142
             stat err =       0.001245999401
             autocorr =       1.206770316933
              std dev =       1.604085342026
             le_variance =       2.573089784504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.572523994341
                                         uncertainty =       0.028942049530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.572523994341
                                         uncertainty =       0.028942049530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134187131
  error estimate for blocks of size 2^( 2) =       0.001172699028
  error estimate for blocks of size 2^( 3) =       0.001205309114
  error estimate for blocks of size 2^( 4) =       0.001229587360
  error estimate for blocks of size 2^( 5) =       0.001243697304
  error estimate for blocks of size 2^( 6) =       0.001249625630
  error estimate for blocks of size 2^( 7) =       0.001261119812

      target function =                  N/A
              le_mean =     -16.719583963930
             les_mean =     282.100020168274
             stat err =       0.001246007526
             autocorr =       1.206901704651
              std dev =       1.604008486340
             le_variance =       2.572843224252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.572591725415
                                         uncertainty =       0.028940400341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.572591725415
                                         uncertainty =       0.028940400341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134201882
  error estimate for blocks of size 2^( 2) =       0.001172710675
  error estimate for blocks of size 2^( 3) =       0.001205314601
  error estimate for blocks of size 2^( 4) =       0.001229584816
  error estimate for blocks of size 2^( 5) =       0.001243697961
  error estimate for blocks of size 2^( 6) =       0.001249619139
  error estimate for blocks of size 2^( 7) =       0.001261118227

      target function =                  N/A
              le_mean =     -16.719572517775
             les_mean =     282.089441420549
             stat err =       0.001246005036
             autocorr =       1.206865487384
              std dev =       1.604029347648
             le_variance =       2.572910148116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.572740945169
                                         uncertainty =       0.028938775122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.572740945169
                                         uncertainty =       0.028938775122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134234466
  error estimate for blocks of size 2^( 2) =       0.001172734131
  error estimate for blocks of size 2^( 3) =       0.001205329436
  error estimate for blocks of size 2^( 4) =       0.001229589036
  error estimate for blocks of size 2^( 5) =       0.001243700568
  error estimate for blocks of size 2^( 6) =       0.001249604846
  error estimate for blocks of size 2^( 7) =       0.001261103801

      target function =                  N/A
              le_mean =     -16.719569435462
             les_mean =     282.089879651383
             stat err =       0.001245999563
             autocorr =       1.206785545786
              std dev =       1.604075429203
             le_variance =       2.573057982573


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719570644584        initial
     5.8208e-01     5.8208e+00             8.2532e-04       -16.719583963930  <--
     2.3283e+00     2.3283e+01             2.6184e-04       -16.719572517775
     9.3132e+00     9.3132e+01             7.0171e-05       -16.719569435462

*****************************************************************************
Applying the update for shift_i =   5.8208e-01     and shift_s =   5.8208e+00
*****************************************************************************

  Execution time = 2.3969e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793734e-01 3 1  ON 1
ci_0003                -4.800141e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566004e-02 3 1  ON 4
ci_0006                -4.394250e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116034e-02 3 1  ON 7
ci_0009                -3.231932e-02 3 1  ON 8
ci_0010                -3.067526e-02 3 1  ON 9
ci_0011                -2.797654e-02 3 1  ON 10
ci_0012                -2.668135e-02 3 1  ON 11
ci_0013                 2.685599e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740073e-02 3 1  ON 14
ci_0016                 2.631632e-02 3 1  ON 15
ci_0017                 2.381443e-02 3 1  ON 16
ci_0018                 2.343354e-02 3 1  ON 17
ci_0019                 2.053736e-02 3 1  ON 18
ci_0020                 1.958650e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802443e-02 3 1  ON 21
ci_0023                -1.925812e-02 3 1  ON 22
ci_0024                -1.769701e-02 3 1  ON 23
ci_0025                -1.834623e-02 3 1  ON 24
ci_0026                -1.756792e-02 3 1  ON 25
ci_0027                -1.738456e-02 3 1  ON 26
ci_0028                -1.696876e-02 3 1  ON 27
ci_0029                -1.560819e-02 3 1  ON 28
ci_0030                -1.613002e-02 3 1  ON 29
ci_0031                 1.557331e-02 3 1  ON 30
ci_0032                 1.395889e-02 3 1  ON 31
ci_0033                 1.701292e-02 3 1  ON 32
ci_0034                 1.587540e-02 3 1  ON 33
ci_0035                 1.777439e-02 3 1  ON 34
ci_0036                 1.687199e-02 3 1  ON 35
ci_0037                -1.516249e-02 3 1  ON 36
ci_0038                -1.405445e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504184e-02 3 1  ON 39
ci_0041                 1.576769e-02 3 1  ON 40
ci_0042                 1.567755e-02 3 1  ON 41
ci_0043                -1.498814e-02 3 1  ON 42
ci_0044                -1.596655e-02 3 1  ON 43
ci_0045                 1.532238e-02 3 1  ON 44
ci_0046                 1.581874e-02 3 1  ON 45
ci_0047                -1.454534e-02 3 1  ON 46
ci_0048                -1.418162e-02 3 1  ON 47
ci_0049                -1.248091e-02 3 1  ON 48
ci_0050                -1.371525e-02 3 1  ON 49
ci_0051                -1.342739e-02 3 1  ON 50
ci_0052                -1.273349e-02 3 1  ON 51
ci_0053                -1.284802e-02 3 1  ON 52
ci_0054                -1.222834e-02 3 1  ON 53
ci_0055                 1.247297e-02 3 1  ON 54
ci_0056                 1.271776e-02 3 1  ON 55
ci_0057                 1.316776e-02 3 1  ON 56
ci_0058                 1.240622e-02 3 1  ON 57
ci_0059                -1.297551e-02 3 1  ON 58
ci_0060                -1.272759e-02 3 1  ON 59
ci_0061                -1.265475e-02 3 1  ON 60
ci_0062                -1.293572e-02 3 1  ON 61
ci_0063                -1.193480e-02 3 1  ON 62
ci_0064                -1.123052e-02 3 1  ON 63
ci_0065                -1.136295e-02 3 1  ON 64
ci_0066                -1.180065e-02 3 1  ON 65
ci_0067                -1.109564e-02 3 1  ON 66
ci_0068                -1.078665e-02 3 1  ON 67
ci_0069                 1.072343e-02 3 1  ON 68
ci_0070                 1.009537e-02 3 1  ON 69
ci_0071                 9.961924e-03 3 1  ON 70
ci_0072                 9.555823e-03 3 1  ON 71
ci_0073                 1.150231e-02 3 1  ON 72
ci_0074                 1.054402e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0263e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6714e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.6896
    reference variance = 9.26195
====================================================
  Execution time = 1.3112e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0296e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.6525e+00
  Total weights = 1.945754308e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2001e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.680732703924
                                         uncertainty =       0.111510858544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.680732703924
                                         uncertainty =       0.111510858544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001157763322
  error estimate for blocks of size 2^( 2) =       0.001196041410
  error estimate for blocks of size 2^( 3) =       0.001228211125
  error estimate for blocks of size 2^( 4) =       0.001251212359
  error estimate for blocks of size 2^( 5) =       0.001262558403
  error estimate for blocks of size 2^( 6) =       0.001268383062
  error estimate for blocks of size 2^( 7) =       0.001274823632

      target function =                  N/A
              le_mean =     -16.720302177115
             les_mean =     282.221040024546
             stat err =       0.001264244364
             autocorr =       1.192401403139
              std dev =       1.637350789353
             le_variance =       2.680917607394


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.672030217711e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720302176207       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720343523035       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720345094083       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.720345828678       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.720346171609       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.720346061330       residual = 1.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e-01 is 1.209283e-03

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720302176207       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720321412461       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720321601372       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.720321614814       residual = 1.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e-01 is 5.493272e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720302176207       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720308304270       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720308341841       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+00 is 1.736672e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.360907 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6320e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.076558e-01 3 1  ON 0
ci_0002                 6.791426e-01 3 1  ON 1
ci_0003                -4.791235e-02 3 1  ON 2
ci_0004                -4.598266e-02 3 1  ON 3
ci_0005                -4.583073e-02 3 1  ON 4
ci_0006                -4.363276e-02 3 1  ON 5
ci_0007                -3.101680e-02 3 1  ON 6
ci_0008                -3.137363e-02 3 1  ON 7
ci_0009                -3.206846e-02 3 1  ON 8
ci_0010                -3.067090e-02 3 1  ON 9
ci_0011                -2.760862e-02 3 1  ON 10
ci_0012                -2.666094e-02 3 1  ON 11
ci_0013                 2.701761e-02 3 1  ON 12
ci_0014                 2.682568e-02 3 1  ON 13
ci_0015                 2.744066e-02 3 1  ON 14
ci_0016                 2.666296e-02 3 1  ON 15
ci_0017                 2.375614e-02 3 1  ON 16
ci_0018                 2.350006e-02 3 1  ON 17
ci_0019                 2.029965e-02 3 1  ON 18
ci_0020                 1.903718e-02 3 1  ON 19
ci_0021                 1.866198e-02 3 1  ON 20
ci_0022                 1.789221e-02 3 1  ON 21
ci_0023                -1.906548e-02 3 1  ON 22
ci_0024                -1.799961e-02 3 1  ON 23
ci_0025                -1.836138e-02 3 1  ON 24
ci_0026                -1.736223e-02 3 1  ON 25
ci_0027                -1.763585e-02 3 1  ON 26
ci_0028                -1.692521e-02 3 1  ON 27
ci_0029                -1.582574e-02 3 1  ON 28
ci_0030                -1.621646e-02 3 1  ON 29
ci_0031                 1.526851e-02 3 1  ON 30
ci_0032                 1.396510e-02 3 1  ON 31
ci_0033                 1.693650e-02 3 1  ON 32
ci_0034                 1.578446e-02 3 1  ON 33
ci_0035                 1.760497e-02 3 1  ON 34
ci_0036                 1.705489e-02 3 1  ON 35
ci_0037                -1.529347e-02 3 1  ON 36
ci_0038                -1.442113e-02 3 1  ON 37
ci_0039                -1.593611e-02 3 1  ON 38
ci_0040                -1.516201e-02 3 1  ON 39
ci_0041                 1.565181e-02 3 1  ON 40
ci_0042                 1.550637e-02 3 1  ON 41
ci_0043                -1.478018e-02 3 1  ON 42
ci_0044                -1.580407e-02 3 1  ON 43
ci_0045                 1.506488e-02 3 1  ON 44
ci_0046                 1.584944e-02 3 1  ON 45
ci_0047                -1.446213e-02 3 1  ON 46
ci_0048                -1.411899e-02 3 1  ON 47
ci_0049                -1.244427e-02 3 1  ON 48
ci_0050                -1.339584e-02 3 1  ON 49
ci_0051                -1.324178e-02 3 1  ON 50
ci_0052                -1.263606e-02 3 1  ON 51
ci_0053                -1.321693e-02 3 1  ON 52
ci_0054                -1.230763e-02 3 1  ON 53
ci_0055                 1.249854e-02 3 1  ON 54
ci_0056                 1.244065e-02 3 1  ON 55
ci_0057                 1.312902e-02 3 1  ON 56
ci_0058                 1.248517e-02 3 1  ON 57
ci_0059                -1.284259e-02 3 1  ON 58
ci_0060                -1.295461e-02 3 1  ON 59
ci_0061                -1.294194e-02 3 1  ON 60
ci_0062                -1.302915e-02 3 1  ON 61
ci_0063                -1.203176e-02 3 1  ON 62
ci_0064                -1.116696e-02 3 1  ON 63
ci_0065                -1.161268e-02 3 1  ON 64
ci_0066                -1.133993e-02 3 1  ON 65
ci_0067                -1.114419e-02 3 1  ON 66
ci_0068                -1.042995e-02 3 1  ON 67
ci_0069                 1.083824e-02 3 1  ON 68
ci_0070                 1.001022e-02 3 1  ON 69
ci_0071                 1.014476e-02 3 1  ON 70
ci_0072                 9.945455e-03 3 1  ON 71
ci_0073                 1.161111e-02 3 1  ON 72
ci_0074                 1.060015e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.4294
    reference variance = 3.5696
====================================================
  Execution time = 1.2789e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.7737e+00
  Total weights = 1.9456e+06
  Execution time = 2.2204e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.802863157454
                                         uncertainty =       0.241130180417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.802863157454
                                         uncertainty =       0.241130180417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001183823726
  error estimate for blocks of size 2^( 2) =       0.001219967188
  error estimate for blocks of size 2^( 3) =       0.001249663836
  error estimate for blocks of size 2^( 4) =       0.001271868826
  error estimate for blocks of size 2^( 5) =       0.001285453429
  error estimate for blocks of size 2^( 6) =       0.001292192904
  error estimate for blocks of size 2^( 7) =       0.001300115837

      target function =                  N/A
              le_mean =     -16.717972956957
             les_mean =     282.295821812607
             stat err =       0.001287407749
             autocorr =       1.182655235123
              std dev =       1.674206354799
             le_variance =       2.802966918448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.802533058044
                                         uncertainty =       0.241120809914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.802533058044
                                         uncertainty =       0.241120809914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001183754058
  error estimate for blocks of size 2^( 2) =       0.001219915413
  error estimate for blocks of size 2^( 3) =       0.001249621950
  error estimate for blocks of size 2^( 4) =       0.001271834976
  error estimate for blocks of size 2^( 5) =       0.001285467850
  error estimate for blocks of size 2^( 6) =       0.001292193878
  error estimate for blocks of size 2^( 7) =       0.001300064685

      target function =                  N/A
              le_mean =     -16.717962706404
             les_mean =     282.296349753975
             stat err =       0.001287390347
             autocorr =       1.182762470015
              std dev =       1.674107828248
             le_variance =       2.802637020600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.802507365870
                                         uncertainty =       0.241120940954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.802507365870
                                         uncertainty =       0.241120940954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001183748683
  error estimate for blocks of size 2^( 2) =       0.001219911785
  error estimate for blocks of size 2^( 3) =       0.001249619848
  error estimate for blocks of size 2^( 4) =       0.001271834266
  error estimate for blocks of size 2^( 5) =       0.001285463423
  error estimate for blocks of size 2^( 6) =       0.001292188775
  error estimate for blocks of size 2^( 7) =       0.001300056853

      target function =                  N/A
              le_mean =     -16.717959041434
             les_mean =     282.269490915539
             stat err =       0.001287385830
             autocorr =       1.182764909621
              std dev =       1.674100226795
             le_variance =       2.802611569354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.802742256397
                                         uncertainty =       0.241128092792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.802742256397
                                         uncertainty =       0.241128092792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001183798221
  error estimate for blocks of size 2^( 2) =       0.001219944924
  error estimate for blocks of size 2^( 3) =       0.001249641946
  error estimate for blocks of size 2^( 4) =       0.001271850832
  error estimate for blocks of size 2^( 5) =       0.001285442798
  error estimate for blocks of size 2^( 6) =       0.001292183765
  error estimate for blocks of size 2^( 7) =       0.001300087237

      target function =                  N/A
              le_mean =     -16.717963921491
             les_mean =     282.264831290219
             stat err =       0.001287391158
             autocorr =       1.182675711579
              std dev =       1.674170285620
             le_variance =       2.802846145252


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717972956957        initial  <--
     1.4552e-01     1.4552e+00             1.2093e-03       -16.717962706404
     5.8208e-01     5.8208e+00             5.4933e-04       -16.717959041434
     2.3283e+00     2.3283e+01             1.7367e-04       -16.717963921491

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0148
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793734e-01 3 1  ON 1
ci_0003                -4.800141e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566004e-02 3 1  ON 4
ci_0006                -4.394250e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116034e-02 3 1  ON 7
ci_0009                -3.231932e-02 3 1  ON 8
ci_0010                -3.067526e-02 3 1  ON 9
ci_0011                -2.797654e-02 3 1  ON 10
ci_0012                -2.668135e-02 3 1  ON 11
ci_0013                 2.685599e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740073e-02 3 1  ON 14
ci_0016                 2.631632e-02 3 1  ON 15
ci_0017                 2.381443e-02 3 1  ON 16
ci_0018                 2.343354e-02 3 1  ON 17
ci_0019                 2.053736e-02 3 1  ON 18
ci_0020                 1.958650e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802443e-02 3 1  ON 21
ci_0023                -1.925812e-02 3 1  ON 22
ci_0024                -1.769701e-02 3 1  ON 23
ci_0025                -1.834623e-02 3 1  ON 24
ci_0026                -1.756792e-02 3 1  ON 25
ci_0027                -1.738456e-02 3 1  ON 26
ci_0028                -1.696876e-02 3 1  ON 27
ci_0029                -1.560819e-02 3 1  ON 28
ci_0030                -1.613002e-02 3 1  ON 29
ci_0031                 1.557331e-02 3 1  ON 30
ci_0032                 1.395889e-02 3 1  ON 31
ci_0033                 1.701292e-02 3 1  ON 32
ci_0034                 1.587540e-02 3 1  ON 33
ci_0035                 1.777439e-02 3 1  ON 34
ci_0036                 1.687199e-02 3 1  ON 35
ci_0037                -1.516249e-02 3 1  ON 36
ci_0038                -1.405445e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504184e-02 3 1  ON 39
ci_0041                 1.576769e-02 3 1  ON 40
ci_0042                 1.567755e-02 3 1  ON 41
ci_0043                -1.498814e-02 3 1  ON 42
ci_0044                -1.596655e-02 3 1  ON 43
ci_0045                 1.532238e-02 3 1  ON 44
ci_0046                 1.581874e-02 3 1  ON 45
ci_0047                -1.454534e-02 3 1  ON 46
ci_0048                -1.418162e-02 3 1  ON 47
ci_0049                -1.248091e-02 3 1  ON 48
ci_0050                -1.371525e-02 3 1  ON 49
ci_0051                -1.342739e-02 3 1  ON 50
ci_0052                -1.273349e-02 3 1  ON 51
ci_0053                -1.284802e-02 3 1  ON 52
ci_0054                -1.222834e-02 3 1  ON 53
ci_0055                 1.247297e-02 3 1  ON 54
ci_0056                 1.271776e-02 3 1  ON 55
ci_0057                 1.316776e-02 3 1  ON 56
ci_0058                 1.240622e-02 3 1  ON 57
ci_0059                -1.297551e-02 3 1  ON 58
ci_0060                -1.272759e-02 3 1  ON 59
ci_0061                -1.265475e-02 3 1  ON 60
ci_0062                -1.293572e-02 3 1  ON 61
ci_0063                -1.193480e-02 3 1  ON 62
ci_0064                -1.123052e-02 3 1  ON 63
ci_0065                -1.136295e-02 3 1  ON 64
ci_0066                -1.180065e-02 3 1  ON 65
ci_0067                -1.109564e-02 3 1  ON 66
ci_0068                -1.078665e-02 3 1  ON 67
ci_0069                 1.072343e-02 3 1  ON 68
ci_0070                 1.009537e-02 3 1  ON 69
ci_0071                 9.961924e-03 3 1  ON 70
ci_0072                 9.555823e-03 3 1  ON 71
ci_0073                 1.150231e-02 3 1  ON 72
ci_0074                 1.054402e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0340e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6709e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.6438
    reference variance = 2.82682
====================================================
  Execution time = 1.3056e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0284e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5653e+00
  Total weights = 1.945517315e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2103e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.596244813471
                                         uncertainty =       0.033010845868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.596244813471
                                         uncertainty =       0.033010845868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139237432
  error estimate for blocks of size 2^( 2) =       0.001178088011
  error estimate for blocks of size 2^( 3) =       0.001212354823
  error estimate for blocks of size 2^( 4) =       0.001235662601
  error estimate for blocks of size 2^( 5) =       0.001249801029
  error estimate for blocks of size 2^( 6) =       0.001258956859
  error estimate for blocks of size 2^( 7) =       0.001259980739

      target function =                  N/A
              le_mean =     -16.716623794838
             les_mean =     282.010780582197
             stat err =       0.001251100307
             autocorr =       1.206023496687
              std dev =       1.611150804437
             le_variance =       2.595806914639


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671662379484e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716623793889       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716635643081       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716635609762       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+00 is 2.673962e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716623793889       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716627072489       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716627071429       residual = 6.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+00 is 7.430524e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716623793889       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716624636018       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716624636784       residual = 5.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+01 is 1.911628e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.362056 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6273e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.074111e-01 3 1  ON 0
ci_0002                 6.793262e-01 3 1  ON 1
ci_0003                -4.803913e-02 3 1  ON 2
ci_0004                -4.640277e-02 3 1  ON 3
ci_0005                -4.563445e-02 3 1  ON 4
ci_0006                -4.392727e-02 3 1  ON 5
ci_0007                -3.096433e-02 3 1  ON 6
ci_0008                -3.115430e-02 3 1  ON 7
ci_0009                -3.234020e-02 3 1  ON 8
ci_0010                -3.069005e-02 3 1  ON 9
ci_0011                -2.797259e-02 3 1  ON 10
ci_0012                -2.660705e-02 3 1  ON 11
ci_0013                 2.691061e-02 3 1  ON 12
ci_0014                 2.689900e-02 3 1  ON 13
ci_0015                 2.741879e-02 3 1  ON 14
ci_0016                 2.632298e-02 3 1  ON 15
ci_0017                 2.383594e-02 3 1  ON 16
ci_0018                 2.348142e-02 3 1  ON 17
ci_0019                 2.049829e-02 3 1  ON 18
ci_0020                 1.955926e-02 3 1  ON 19
ci_0021                 1.857910e-02 3 1  ON 20
ci_0022                 1.805010e-02 3 1  ON 21
ci_0023                -1.923534e-02 3 1  ON 22
ci_0024                -1.767080e-02 3 1  ON 23
ci_0025                -1.835063e-02 3 1  ON 24
ci_0026                -1.760294e-02 3 1  ON 25
ci_0027                -1.737483e-02 3 1  ON 26
ci_0028                -1.694803e-02 3 1  ON 27
ci_0029                -1.561676e-02 3 1  ON 28
ci_0030                -1.609774e-02 3 1  ON 29
ci_0031                 1.555352e-02 3 1  ON 30
ci_0032                 1.398736e-02 3 1  ON 31
ci_0033                 1.701828e-02 3 1  ON 32
ci_0034                 1.586990e-02 3 1  ON 33
ci_0035                 1.780444e-02 3 1  ON 34
ci_0036                 1.689537e-02 3 1  ON 35
ci_0037                -1.515397e-02 3 1  ON 36
ci_0038                -1.410001e-02 3 1  ON 37
ci_0039                -1.577465e-02 3 1  ON 38
ci_0040                -1.505384e-02 3 1  ON 39
ci_0041                 1.578906e-02 3 1  ON 40
ci_0042                 1.561614e-02 3 1  ON 41
ci_0043                -1.499081e-02 3 1  ON 42
ci_0044                -1.592062e-02 3 1  ON 43
ci_0045                 1.534993e-02 3 1  ON 44
ci_0046                 1.577862e-02 3 1  ON 45
ci_0047                -1.455046e-02 3 1  ON 46
ci_0048                -1.416582e-02 3 1  ON 47
ci_0049                -1.252475e-02 3 1  ON 48
ci_0050                -1.368203e-02 3 1  ON 49
ci_0051                -1.343366e-02 3 1  ON 50
ci_0052                -1.273556e-02 3 1  ON 51
ci_0053                -1.287552e-02 3 1  ON 52
ci_0054                -1.224309e-02 3 1  ON 53
ci_0055                 1.247706e-02 3 1  ON 54
ci_0056                 1.275078e-02 3 1  ON 55
ci_0057                 1.316866e-02 3 1  ON 56
ci_0058                 1.241268e-02 3 1  ON 57
ci_0059                -1.297543e-02 3 1  ON 58
ci_0060                -1.272665e-02 3 1  ON 59
ci_0061                -1.266743e-02 3 1  ON 60
ci_0062                -1.290868e-02 3 1  ON 61
ci_0063                -1.187579e-02 3 1  ON 62
ci_0064                -1.121647e-02 3 1  ON 63
ci_0065                -1.131550e-02 3 1  ON 64
ci_0066                -1.177582e-02 3 1  ON 65
ci_0067                -1.113570e-02 3 1  ON 66
ci_0068                -1.080357e-02 3 1  ON 67
ci_0069                 1.072899e-02 3 1  ON 68
ci_0070                 1.013704e-02 3 1  ON 69
ci_0071                 9.971412e-03 3 1  ON 70
ci_0072                 9.587450e-03 3 1  ON 71
ci_0073                 1.155220e-02 3 1  ON 72
ci_0074                 1.053594e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.5258
    reference variance = 3.5227
====================================================
  Execution time = 1.2800e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5099e+00
  Total weights = 1.9459e+06
  Execution time = 2.2116e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537702340186
                                         uncertainty =       0.027272521174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537702340186
                                         uncertainty =       0.027272521174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126350143
  error estimate for blocks of size 2^( 2) =       0.001164327456
  error estimate for blocks of size 2^( 3) =       0.001198781778
  error estimate for blocks of size 2^( 4) =       0.001222243857
  error estimate for blocks of size 2^( 5) =       0.001233757465
  error estimate for blocks of size 2^( 6) =       0.001244742327
  error estimate for blocks of size 2^( 7) =       0.001250343207

      target function =                  N/A
              le_mean =     -16.717358714792
             les_mean =     281.979795702069
             stat err =       0.001237771714
             autocorr =       1.207631048530
              std dev =       1.592925135075
             le_variance =       2.537410485955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538189731596
                                         uncertainty =       0.027271383452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538189731596
                                         uncertainty =       0.027271383452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126458217
  error estimate for blocks of size 2^( 2) =       0.001164427482
  error estimate for blocks of size 2^( 3) =       0.001198873014
  error estimate for blocks of size 2^( 4) =       0.001222337529
  error estimate for blocks of size 2^( 5) =       0.001233851872
  error estimate for blocks of size 2^( 6) =       0.001244840993
  error estimate for blocks of size 2^( 7) =       0.001250422899

      target function =                  N/A
              le_mean =     -16.717356050321
             les_mean =     281.980696568210
             stat err =       0.001237863323
             autocorr =       1.207578065139
              std dev =       1.593077976842
             le_variance =       2.537897440300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537976813673
                                         uncertainty =       0.027271961666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537976813673
                                         uncertainty =       0.027271961666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126411007
  error estimate for blocks of size 2^( 2) =       0.001164383823
  error estimate for blocks of size 2^( 3) =       0.001198833275
  error estimate for blocks of size 2^( 4) =       0.001222296665
  error estimate for blocks of size 2^( 5) =       0.001233810688
  error estimate for blocks of size 2^( 6) =       0.001244797841
  error estimate for blocks of size 2^( 7) =       0.001250388054

      target function =                  N/A
              le_mean =     -16.717356787630
             les_mean =     281.980175753094
             stat err =       0.001237823312
             autocorr =       1.207601221204
              std dev =       1.593011210925
             le_variance =       2.537684718132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537737434796
                                         uncertainty =       0.027272453970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537737434796
                                         uncertainty =       0.027272453970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126357926
  error estimate for blocks of size 2^( 2) =       0.001164334660
  error estimate for blocks of size 2^( 3) =       0.001198788362
  error estimate for blocks of size 2^( 4) =       0.001222250603
  error estimate for blocks of size 2^( 5) =       0.001233764268
  error estimate for blocks of size 2^( 6) =       0.001244749421
  error estimate for blocks of size 2^( 7) =       0.001250348917

      target function =                  N/A
              le_mean =     -16.717358410960
             les_mean =     281.979813913430
             stat err =       0.001237778302
             autocorr =       1.207627215405
              std dev =       1.592936141227
             le_variance =       2.537445550026


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717358714792        initial  <--
     1.4552e+00     1.4552e+01             2.6740e-04       -16.717356050321
     5.8208e+00     5.8208e+01             7.4305e-05       -16.717356787630
     2.3283e+01     2.3283e+02             1.9116e-05       -16.717358410960

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9708
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793734e-01 3 1  ON 1
ci_0003                -4.800141e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566004e-02 3 1  ON 4
ci_0006                -4.394250e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116034e-02 3 1  ON 7
ci_0009                -3.231932e-02 3 1  ON 8
ci_0010                -3.067526e-02 3 1  ON 9
ci_0011                -2.797654e-02 3 1  ON 10
ci_0012                -2.668135e-02 3 1  ON 11
ci_0013                 2.685599e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740073e-02 3 1  ON 14
ci_0016                 2.631632e-02 3 1  ON 15
ci_0017                 2.381443e-02 3 1  ON 16
ci_0018                 2.343354e-02 3 1  ON 17
ci_0019                 2.053736e-02 3 1  ON 18
ci_0020                 1.958650e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802443e-02 3 1  ON 21
ci_0023                -1.925812e-02 3 1  ON 22
ci_0024                -1.769701e-02 3 1  ON 23
ci_0025                -1.834623e-02 3 1  ON 24
ci_0026                -1.756792e-02 3 1  ON 25
ci_0027                -1.738456e-02 3 1  ON 26
ci_0028                -1.696876e-02 3 1  ON 27
ci_0029                -1.560819e-02 3 1  ON 28
ci_0030                -1.613002e-02 3 1  ON 29
ci_0031                 1.557331e-02 3 1  ON 30
ci_0032                 1.395889e-02 3 1  ON 31
ci_0033                 1.701292e-02 3 1  ON 32
ci_0034                 1.587540e-02 3 1  ON 33
ci_0035                 1.777439e-02 3 1  ON 34
ci_0036                 1.687199e-02 3 1  ON 35
ci_0037                -1.516249e-02 3 1  ON 36
ci_0038                -1.405445e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504184e-02 3 1  ON 39
ci_0041                 1.576769e-02 3 1  ON 40
ci_0042                 1.567755e-02 3 1  ON 41
ci_0043                -1.498814e-02 3 1  ON 42
ci_0044                -1.596655e-02 3 1  ON 43
ci_0045                 1.532238e-02 3 1  ON 44
ci_0046                 1.581874e-02 3 1  ON 45
ci_0047                -1.454534e-02 3 1  ON 46
ci_0048                -1.418162e-02 3 1  ON 47
ci_0049                -1.248091e-02 3 1  ON 48
ci_0050                -1.371525e-02 3 1  ON 49
ci_0051                -1.342739e-02 3 1  ON 50
ci_0052                -1.273349e-02 3 1  ON 51
ci_0053                -1.284802e-02 3 1  ON 52
ci_0054                -1.222834e-02 3 1  ON 53
ci_0055                 1.247297e-02 3 1  ON 54
ci_0056                 1.271776e-02 3 1  ON 55
ci_0057                 1.316776e-02 3 1  ON 56
ci_0058                 1.240622e-02 3 1  ON 57
ci_0059                -1.297551e-02 3 1  ON 58
ci_0060                -1.272759e-02 3 1  ON 59
ci_0061                -1.265475e-02 3 1  ON 60
ci_0062                -1.293572e-02 3 1  ON 61
ci_0063                -1.193480e-02 3 1  ON 62
ci_0064                -1.123052e-02 3 1  ON 63
ci_0065                -1.136295e-02 3 1  ON 64
ci_0066                -1.180065e-02 3 1  ON 65
ci_0067                -1.109564e-02 3 1  ON 66
ci_0068                -1.078665e-02 3 1  ON 67
ci_0069                 1.072343e-02 3 1  ON 68
ci_0070                 1.009537e-02 3 1  ON 69
ci_0071                 9.961924e-03 3 1  ON 70
ci_0072                 9.555823e-03 3 1  ON 71
ci_0073                 1.150231e-02 3 1  ON 72
ci_0074                 1.054402e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0250e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6705e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.6703
    reference variance = 1.66723
====================================================
  Execution time = 1.3121e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0257e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.6018e+00
  Total weights = 1.945891336e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1869e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.626760365530
                                         uncertainty =       0.053795742741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.626760365530
                                         uncertainty =       0.053795742741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001145908860
  error estimate for blocks of size 2^( 2) =       0.001184012413
  error estimate for blocks of size 2^( 3) =       0.001216218735
  error estimate for blocks of size 2^( 4) =       0.001236981491
  error estimate for blocks of size 2^( 5) =       0.001251308162
  error estimate for blocks of size 2^( 6) =       0.001257080344
  error estimate for blocks of size 2^( 7) =       0.001259748124

      target function =                  N/A
              le_mean =     -16.719658693977
             les_mean =     282.148833740771
             stat err =       0.001251279530
             autocorr =       1.192363093651
              std dev =       1.620585779727
             le_variance =       2.626298269453


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671965869398e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719658693062       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719659580958       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719659669496       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719659666560       residual = 1.59e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+01 is 3.513604e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719658693062       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719658918112       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719658939882       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719658939124       residual = 1.41e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+01 is 8.948342e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719658693062       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719658749520       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719658754939       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719658754748       residual = 1.37e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+02 is 2.247599e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.363553 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6315e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.073731e-01 3 1  ON 0
ci_0002                 6.793695e-01 3 1  ON 1
ci_0003                -4.800278e-02 3 1  ON 2
ci_0004                -4.639083e-02 3 1  ON 3
ci_0005                -4.566576e-02 3 1  ON 4
ci_0006                -4.394108e-02 3 1  ON 5
ci_0007                -3.091288e-02 3 1  ON 6
ci_0008                -3.116151e-02 3 1  ON 7
ci_0009                -3.231664e-02 3 1  ON 8
ci_0010                -3.068119e-02 3 1  ON 9
ci_0011                -2.797508e-02 3 1  ON 10
ci_0012                -2.667871e-02 3 1  ON 11
ci_0013                 2.685898e-02 3 1  ON 12
ci_0014                 2.693295e-02 3 1  ON 13
ci_0015                 2.740211e-02 3 1  ON 14
ci_0016                 2.631689e-02 3 1  ON 15
ci_0017                 2.382180e-02 3 1  ON 16
ci_0018                 2.343301e-02 3 1  ON 17
ci_0019                 2.053978e-02 3 1  ON 18
ci_0020                 1.958566e-02 3 1  ON 19
ci_0021                 1.859158e-02 3 1  ON 20
ci_0022                 1.802276e-02 3 1  ON 21
ci_0023                -1.925661e-02 3 1  ON 22
ci_0024                -1.769950e-02 3 1  ON 23
ci_0025                -1.834318e-02 3 1  ON 24
ci_0026                -1.756406e-02 3 1  ON 25
ci_0027                -1.738562e-02 3 1  ON 26
ci_0028                -1.697126e-02 3 1  ON 27
ci_0029                -1.561009e-02 3 1  ON 28
ci_0030                -1.613383e-02 3 1  ON 29
ci_0031                 1.556621e-02 3 1  ON 30
ci_0032                 1.395716e-02 3 1  ON 31
ci_0033                 1.701275e-02 3 1  ON 32
ci_0034                 1.587896e-02 3 1  ON 33
ci_0035                 1.776982e-02 3 1  ON 34
ci_0036                 1.687285e-02 3 1  ON 35
ci_0037                -1.515930e-02 3 1  ON 36
ci_0038                -1.406035e-02 3 1  ON 37
ci_0039                -1.578095e-02 3 1  ON 38
ci_0040                -1.504121e-02 3 1  ON 39
ci_0041                 1.577151e-02 3 1  ON 40
ci_0042                 1.567331e-02 3 1  ON 41
ci_0043                -1.499282e-02 3 1  ON 42
ci_0044                -1.596327e-02 3 1  ON 43
ci_0045                 1.532308e-02 3 1  ON 44
ci_0046                 1.581895e-02 3 1  ON 45
ci_0047                -1.455161e-02 3 1  ON 46
ci_0048                -1.418164e-02 3 1  ON 47
ci_0049                -1.248286e-02 3 1  ON 48
ci_0050                -1.371542e-02 3 1  ON 49
ci_0051                -1.342583e-02 3 1  ON 50
ci_0052                -1.272454e-02 3 1  ON 51
ci_0053                -1.285000e-02 3 1  ON 52
ci_0054                -1.222905e-02 3 1  ON 53
ci_0055                 1.246938e-02 3 1  ON 54
ci_0056                 1.272078e-02 3 1  ON 55
ci_0057                 1.316828e-02 3 1  ON 56
ci_0058                 1.240533e-02 3 1  ON 57
ci_0059                -1.297600e-02 3 1  ON 58
ci_0060                -1.272645e-02 3 1  ON 59
ci_0061                -1.265144e-02 3 1  ON 60
ci_0062                -1.293196e-02 3 1  ON 61
ci_0063                -1.193246e-02 3 1  ON 62
ci_0064                -1.122897e-02 3 1  ON 63
ci_0065                -1.137101e-02 3 1  ON 64
ci_0066                -1.179844e-02 3 1  ON 65
ci_0067                -1.109826e-02 3 1  ON 66
ci_0068                -1.079039e-02 3 1  ON 67
ci_0069                 1.072439e-02 3 1  ON 68
ci_0070                 1.008729e-02 3 1  ON 69
ci_0071                 9.958287e-03 3 1  ON 70
ci_0072                 9.559194e-03 3 1  ON 71
ci_0073                 1.150195e-02 3 1  ON 72
ci_0074                 1.054050e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8823
    reference variance = 2.64645
====================================================
  Execution time = 1.5357e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5215e+00
  Total weights = 1.9458e+06
  Execution time = 2.2032e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549273119765
                                         uncertainty =       0.042946016478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549273119765
                                         uncertainty =       0.042946016478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129206543
  error estimate for blocks of size 2^( 2) =       0.001168413224
  error estimate for blocks of size 2^( 3) =       0.001201661877
  error estimate for blocks of size 2^( 4) =       0.001224757713
  error estimate for blocks of size 2^( 5) =       0.001241602230
  error estimate for blocks of size 2^( 6) =       0.001253651180
  error estimate for blocks of size 2^( 7) =       0.001254758119

      target function =                  N/A
              le_mean =     -16.717809281407
             les_mean =     282.006670173006
             stat err =       0.001243692311
             autocorr =       1.213051185895
              std dev =       1.596964758290
             le_variance =       2.550296439219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549235554764
                                         uncertainty =       0.042945986978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549235554764
                                         uncertainty =       0.042945986978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129198193
  error estimate for blocks of size 2^( 2) =       0.001168403760
  error estimate for blocks of size 2^( 3) =       0.001201652016
  error estimate for blocks of size 2^( 4) =       0.001224746828
  error estimate for blocks of size 2^( 5) =       0.001241591801
  error estimate for blocks of size 2^( 6) =       0.001253641416
  error estimate for blocks of size 2^( 7) =       0.001254745867

      target function =                  N/A
              le_mean =     -16.717808940315
             les_mean =     282.006629469944
             stat err =       0.001243681478
             autocorr =       1.213047993774
              std dev =       1.596952950030
             le_variance =       2.550258724610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549253921174
                                         uncertainty =       0.042946002892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549253921174
                                         uncertainty =       0.042946002892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129202276
  error estimate for blocks of size 2^( 2) =       0.001168408391
  error estimate for blocks of size 2^( 3) =       0.001201656842
  error estimate for blocks of size 2^( 4) =       0.001224752161
  error estimate for blocks of size 2^( 5) =       0.001241596911
  error estimate for blocks of size 2^( 6) =       0.001253646198
  error estimate for blocks of size 2^( 7) =       0.001254751872

      target function =                  N/A
              le_mean =     -16.717809098313
             les_mean =     282.006645630825
             stat err =       0.001243686786
             autocorr =       1.213049576037
              std dev =       1.596958723696
             le_variance =       2.550277165190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549270699740
                                         uncertainty =       0.042946014862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549270699740
                                         uncertainty =       0.042946014862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129206005
  error estimate for blocks of size 2^( 2) =       0.001168412615
  error estimate for blocks of size 2^( 3) =       0.001201661243
  error estimate for blocks of size 2^( 4) =       0.001224757014
  error estimate for blocks of size 2^( 5) =       0.001241601560
  error estimate for blocks of size 2^( 6) =       0.001253650552
  error estimate for blocks of size 2^( 7) =       0.001254757333

      target function =                  N/A
              le_mean =     -16.717809257293
             les_mean =     282.006666614778
             stat err =       0.001243691615
             autocorr =       1.213050984268
              std dev =       1.596963997635
             le_variance =       2.550294009741


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717809281407        initial  <--
     1.4552e+01     1.4552e+02             3.5136e-05       -16.717808940315
     5.8208e+01     5.8208e+02             8.9483e-06       -16.717809098313
     2.3283e+02     2.3283e+03             2.2476e-06       -16.717809257293

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.4999
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793734e-01 3 1  ON 1
ci_0003                -4.800141e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566004e-02 3 1  ON 4
ci_0006                -4.394250e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116034e-02 3 1  ON 7
ci_0009                -3.231932e-02 3 1  ON 8
ci_0010                -3.067526e-02 3 1  ON 9
ci_0011                -2.797654e-02 3 1  ON 10
ci_0012                -2.668135e-02 3 1  ON 11
ci_0013                 2.685599e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740073e-02 3 1  ON 14
ci_0016                 2.631632e-02 3 1  ON 15
ci_0017                 2.381443e-02 3 1  ON 16
ci_0018                 2.343354e-02 3 1  ON 17
ci_0019                 2.053736e-02 3 1  ON 18
ci_0020                 1.958650e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802443e-02 3 1  ON 21
ci_0023                -1.925812e-02 3 1  ON 22
ci_0024                -1.769701e-02 3 1  ON 23
ci_0025                -1.834623e-02 3 1  ON 24
ci_0026                -1.756792e-02 3 1  ON 25
ci_0027                -1.738456e-02 3 1  ON 26
ci_0028                -1.696876e-02 3 1  ON 27
ci_0029                -1.560819e-02 3 1  ON 28
ci_0030                -1.613002e-02 3 1  ON 29
ci_0031                 1.557331e-02 3 1  ON 30
ci_0032                 1.395889e-02 3 1  ON 31
ci_0033                 1.701292e-02 3 1  ON 32
ci_0034                 1.587540e-02 3 1  ON 33
ci_0035                 1.777439e-02 3 1  ON 34
ci_0036                 1.687199e-02 3 1  ON 35
ci_0037                -1.516249e-02 3 1  ON 36
ci_0038                -1.405445e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504184e-02 3 1  ON 39
ci_0041                 1.576769e-02 3 1  ON 40
ci_0042                 1.567755e-02 3 1  ON 41
ci_0043                -1.498814e-02 3 1  ON 42
ci_0044                -1.596655e-02 3 1  ON 43
ci_0045                 1.532238e-02 3 1  ON 44
ci_0046                 1.581874e-02 3 1  ON 45
ci_0047                -1.454534e-02 3 1  ON 46
ci_0048                -1.418162e-02 3 1  ON 47
ci_0049                -1.248091e-02 3 1  ON 48
ci_0050                -1.371525e-02 3 1  ON 49
ci_0051                -1.342739e-02 3 1  ON 50
ci_0052                -1.273349e-02 3 1  ON 51
ci_0053                -1.284802e-02 3 1  ON 52
ci_0054                -1.222834e-02 3 1  ON 53
ci_0055                 1.247297e-02 3 1  ON 54
ci_0056                 1.271776e-02 3 1  ON 55
ci_0057                 1.316776e-02 3 1  ON 56
ci_0058                 1.240622e-02 3 1  ON 57
ci_0059                -1.297551e-02 3 1  ON 58
ci_0060                -1.272759e-02 3 1  ON 59
ci_0061                -1.265475e-02 3 1  ON 60
ci_0062                -1.293572e-02 3 1  ON 61
ci_0063                -1.193480e-02 3 1  ON 62
ci_0064                -1.123052e-02 3 1  ON 63
ci_0065                -1.136295e-02 3 1  ON 64
ci_0066                -1.180065e-02 3 1  ON 65
ci_0067                -1.109564e-02 3 1  ON 66
ci_0068                -1.078665e-02 3 1  ON 67
ci_0069                 1.072343e-02 3 1  ON 68
ci_0070                 1.009537e-02 3 1  ON 69
ci_0071                 9.961924e-03 3 1  ON 70
ci_0072                 9.555823e-03 3 1  ON 71
ci_0073                 1.150231e-02 3 1  ON 72
ci_0074                 1.054402e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2821e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6708e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.7177
    reference variance = 3.00475
====================================================
  Execution time = 1.3062e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0300e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5555e+00
  Total weights = 1.945658919e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2057e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.583417315904
                                         uncertainty =       0.053749329680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.583417315904
                                         uncertainty =       0.053749329680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136612890
  error estimate for blocks of size 2^( 2) =       0.001174502761
  error estimate for blocks of size 2^( 3) =       0.001207312538
  error estimate for blocks of size 2^( 4) =       0.001229301240
  error estimate for blocks of size 2^( 5) =       0.001243780870
  error estimate for blocks of size 2^( 6) =       0.001255107886
  error estimate for blocks of size 2^( 7) =       0.001260872487

      target function =                  N/A
              le_mean =     -16.718614396106
             les_mean =     282.067538561270
             stat err =       0.001247265621
             autocorr =       1.204183715803
              std dev =       1.607439082127
             le_variance =       2.583860402749


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671861439611e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718614395152       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718614501255       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718614512477       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718614513569       residual = 4.53e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+02 is 5.855700e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718614395152       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718614421709       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718614424520       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718614424794       residual = 4.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+02 is 1.465778e-06

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718614395152       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718614401793       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718614402496       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718614402565       residual = 4.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+03 is 3.665604e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.365082 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6275e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.073707e-01 3 1  ON 0
ci_0002                 6.793734e-01 3 1  ON 1
ci_0003                -4.800174e-02 3 1  ON 2
ci_0004                -4.638637e-02 3 1  ON 3
ci_0005                -4.565978e-02 3 1  ON 4
ci_0006                -4.394223e-02 3 1  ON 5
ci_0007                -3.091385e-02 3 1  ON 6
ci_0008                -3.116047e-02 3 1  ON 7
ci_0009                -3.231923e-02 3 1  ON 8
ci_0010                -3.067589e-02 3 1  ON 9
ci_0011                -2.797589e-02 3 1  ON 10
ci_0012                -2.668078e-02 3 1  ON 11
ci_0013                 2.685614e-02 3 1  ON 12
ci_0014                 2.692469e-02 3 1  ON 13
ci_0015                 2.740042e-02 3 1  ON 14
ci_0016                 2.631604e-02 3 1  ON 15
ci_0017                 2.381525e-02 3 1  ON 16
ci_0018                 2.343325e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958592e-02 3 1  ON 19
ci_0021                 1.858896e-02 3 1  ON 20
ci_0022                 1.802473e-02 3 1  ON 21
ci_0023                -1.925791e-02 3 1  ON 22
ci_0024                -1.769691e-02 3 1  ON 23
ci_0025                -1.834673e-02 3 1  ON 24
ci_0026                -1.756812e-02 3 1  ON 25
ci_0027                -1.738481e-02 3 1  ON 26
ci_0028                -1.696853e-02 3 1  ON 27
ci_0029                -1.560865e-02 3 1  ON 28
ci_0030                -1.612972e-02 3 1  ON 29
ci_0031                 1.557264e-02 3 1  ON 30
ci_0032                 1.395881e-02 3 1  ON 31
ci_0033                 1.701267e-02 3 1  ON 32
ci_0034                 1.587559e-02 3 1  ON 33
ci_0035                 1.777466e-02 3 1  ON 34
ci_0036                 1.687201e-02 3 1  ON 35
ci_0037                -1.516242e-02 3 1  ON 36
ci_0038                -1.405460e-02 3 1  ON 37
ci_0039                -1.577817e-02 3 1  ON 38
ci_0040                -1.504170e-02 3 1  ON 39
ci_0041                 1.576752e-02 3 1  ON 40
ci_0042                 1.567609e-02 3 1  ON 41
ci_0043                -1.498859e-02 3 1  ON 42
ci_0044                -1.596617e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581844e-02 3 1  ON 45
ci_0047                -1.454570e-02 3 1  ON 46
ci_0048                -1.418123e-02 3 1  ON 47
ci_0049                -1.248130e-02 3 1  ON 48
ci_0050                -1.371476e-02 3 1  ON 49
ci_0051                -1.342734e-02 3 1  ON 50
ci_0052                -1.273308e-02 3 1  ON 51
ci_0053                -1.284832e-02 3 1  ON 52
ci_0054                -1.222815e-02 3 1  ON 53
ci_0055                 1.247227e-02 3 1  ON 54
ci_0056                 1.271709e-02 3 1  ON 55
ci_0057                 1.316767e-02 3 1  ON 56
ci_0058                 1.240645e-02 3 1  ON 57
ci_0059                -1.297566e-02 3 1  ON 58
ci_0060                -1.272762e-02 3 1  ON 59
ci_0061                -1.265509e-02 3 1  ON 60
ci_0062                -1.293536e-02 3 1  ON 61
ci_0063                -1.193444e-02 3 1  ON 62
ci_0064                -1.123002e-02 3 1  ON 63
ci_0065                -1.136321e-02 3 1  ON 64
ci_0066                -1.179980e-02 3 1  ON 65
ci_0067                -1.109550e-02 3 1  ON 66
ci_0068                -1.078661e-02 3 1  ON 67
ci_0069                 1.072388e-02 3 1  ON 68
ci_0070                 1.009557e-02 3 1  ON 69
ci_0071                 9.961891e-03 3 1  ON 70
ci_0072                 9.555961e-03 3 1  ON 71
ci_0073                 1.150200e-02 3 1  ON 72
ci_0074                 1.054436e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.6671
    reference variance = 1.83211
====================================================
  Execution time = 1.2805e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6721e+01
  VMC Evar = 2.5067e+00
  Total weights = 1.9458e+06
  Execution time = 2.1913e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533028780356
                                         uncertainty =       0.023917735982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533028780356
                                         uncertainty =       0.023917735982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125307536
  error estimate for blocks of size 2^( 2) =       0.001163268908
  error estimate for blocks of size 2^( 3) =       0.001197223075
  error estimate for blocks of size 2^( 4) =       0.001219329394
  error estimate for blocks of size 2^( 5) =       0.001229983579
  error estimate for blocks of size 2^( 6) =       0.001241041861
  error estimate for blocks of size 2^( 7) =       0.001250727350

      target function =                  N/A
              le_mean =     -16.721079567731
             les_mean =     282.101236403158
             stat err =       0.001235270546
             autocorr =       1.204985213202
              std dev =       1.591450642114
             le_variance =       2.532715146286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533028989360
                                         uncertainty =       0.023917760323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533028989360
                                         uncertainty =       0.023917760323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125307593
  error estimate for blocks of size 2^( 2) =       0.001163269120
  error estimate for blocks of size 2^( 3) =       0.001197223377
  error estimate for blocks of size 2^( 4) =       0.001219329864
  error estimate for blocks of size 2^( 5) =       0.001229984079
  error estimate for blocks of size 2^( 6) =       0.001241042485
  error estimate for blocks of size 2^( 7) =       0.001250727821

      target function =                  N/A
              le_mean =     -16.721079561464
             les_mean =     282.101231593598
             stat err =       0.001235271062
             autocorr =       1.204986098729
              std dev =       1.591450722504
             le_variance =       2.532715402159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533028884293
                                         uncertainty =       0.023917748150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533028884293
                                         uncertainty =       0.023917748150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125307564
  error estimate for blocks of size 2^( 2) =       0.001163269014
  error estimate for blocks of size 2^( 3) =       0.001197223226
  error estimate for blocks of size 2^( 4) =       0.001219329630
  error estimate for blocks of size 2^( 5) =       0.001229983829
  error estimate for blocks of size 2^( 6) =       0.001241042173
  error estimate for blocks of size 2^( 7) =       0.001250727586

      target function =                  N/A
              le_mean =     -16.721079564537
             les_mean =     282.101233117970
             stat err =       0.001235270804
             autocorr =       1.204985656616
              std dev =       1.591450682141
             le_variance =       2.532715273686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533028793260
                                         uncertainty =       0.023917737502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533028793260
                                         uncertainty =       0.023917737502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125307540
  error estimate for blocks of size 2^( 2) =       0.001163268921
  error estimate for blocks of size 2^( 3) =       0.001197223094
  error estimate for blocks of size 2^( 4) =       0.001219329424
  error estimate for blocks of size 2^( 5) =       0.001229983610
  error estimate for blocks of size 2^( 6) =       0.001241041900
  error estimate for blocks of size 2^( 7) =       0.001250727380

      target function =                  N/A
              le_mean =     -16.721079567327
             les_mean =     282.101235823646
             stat err =       0.001235270578
             autocorr =       1.204985268655
              std dev =       1.591450647090
             le_variance =       2.532715162124


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.721079567731        initial  <--
     1.4552e+02     1.4552e+03             5.8557e-06       -16.721079561464
     5.8208e+02     5.8208e+03             1.4658e-06       -16.721079564537
     2.3283e+03     2.3283e+04             3.6656e-07       -16.721079567327

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8969
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793734e-01 3 1  ON 1
ci_0003                -4.800141e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566004e-02 3 1  ON 4
ci_0006                -4.394250e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116034e-02 3 1  ON 7
ci_0009                -3.231932e-02 3 1  ON 8
ci_0010                -3.067526e-02 3 1  ON 9
ci_0011                -2.797654e-02 3 1  ON 10
ci_0012                -2.668135e-02 3 1  ON 11
ci_0013                 2.685599e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740073e-02 3 1  ON 14
ci_0016                 2.631632e-02 3 1  ON 15
ci_0017                 2.381443e-02 3 1  ON 16
ci_0018                 2.343354e-02 3 1  ON 17
ci_0019                 2.053736e-02 3 1  ON 18
ci_0020                 1.958650e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802443e-02 3 1  ON 21
ci_0023                -1.925812e-02 3 1  ON 22
ci_0024                -1.769701e-02 3 1  ON 23
ci_0025                -1.834623e-02 3 1  ON 24
ci_0026                -1.756792e-02 3 1  ON 25
ci_0027                -1.738456e-02 3 1  ON 26
ci_0028                -1.696876e-02 3 1  ON 27
ci_0029                -1.560819e-02 3 1  ON 28
ci_0030                -1.613002e-02 3 1  ON 29
ci_0031                 1.557331e-02 3 1  ON 30
ci_0032                 1.395889e-02 3 1  ON 31
ci_0033                 1.701292e-02 3 1  ON 32
ci_0034                 1.587540e-02 3 1  ON 33
ci_0035                 1.777439e-02 3 1  ON 34
ci_0036                 1.687199e-02 3 1  ON 35
ci_0037                -1.516249e-02 3 1  ON 36
ci_0038                -1.405445e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504184e-02 3 1  ON 39
ci_0041                 1.576769e-02 3 1  ON 40
ci_0042                 1.567755e-02 3 1  ON 41
ci_0043                -1.498814e-02 3 1  ON 42
ci_0044                -1.596655e-02 3 1  ON 43
ci_0045                 1.532238e-02 3 1  ON 44
ci_0046                 1.581874e-02 3 1  ON 45
ci_0047                -1.454534e-02 3 1  ON 46
ci_0048                -1.418162e-02 3 1  ON 47
ci_0049                -1.248091e-02 3 1  ON 48
ci_0050                -1.371525e-02 3 1  ON 49
ci_0051                -1.342739e-02 3 1  ON 50
ci_0052                -1.273349e-02 3 1  ON 51
ci_0053                -1.284802e-02 3 1  ON 52
ci_0054                -1.222834e-02 3 1  ON 53
ci_0055                 1.247297e-02 3 1  ON 54
ci_0056                 1.271776e-02 3 1  ON 55
ci_0057                 1.316776e-02 3 1  ON 56
ci_0058                 1.240622e-02 3 1  ON 57
ci_0059                -1.297551e-02 3 1  ON 58
ci_0060                -1.272759e-02 3 1  ON 59
ci_0061                -1.265475e-02 3 1  ON 60
ci_0062                -1.293572e-02 3 1  ON 61
ci_0063                -1.193480e-02 3 1  ON 62
ci_0064                -1.123052e-02 3 1  ON 63
ci_0065                -1.136295e-02 3 1  ON 64
ci_0066                -1.180065e-02 3 1  ON 65
ci_0067                -1.109564e-02 3 1  ON 66
ci_0068                -1.078665e-02 3 1  ON 67
ci_0069                 1.072343e-02 3 1  ON 68
ci_0070                 1.009537e-02 3 1  ON 69
ci_0071                 9.961924e-03 3 1  ON 70
ci_0072                 9.555823e-03 3 1  ON 71
ci_0073                 1.150231e-02 3 1  ON 72
ci_0074                 1.054402e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0178e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6707e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.612
    reference variance = 2.3087
====================================================
  Execution time = 1.3051e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0280e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.4969e+00
  Total weights = 1.945597127e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1485e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.526345988736
                                         uncertainty =       0.020866200794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.526345988736
                                         uncertainty =       0.020866200794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001123767101
  error estimate for blocks of size 2^( 2) =       0.001161986900
  error estimate for blocks of size 2^( 3) =       0.001194684767
  error estimate for blocks of size 2^( 4) =       0.001219171279
  error estimate for blocks of size 2^( 5) =       0.001233212534
  error estimate for blocks of size 2^( 6) =       0.001238986859
  error estimate for blocks of size 2^( 7) =       0.001244544285

      target function =                  N/A
              le_mean =     -16.717410843095
             les_mean =     281.968676894909
             stat err =       0.001233978739
             autocorr =       1.205765148483
              std dev =       1.589272103183
             le_variance =       2.525785817956


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671741084310e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717410842200       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717410862694       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717410862801       residual = 5.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+03 is 3.908617e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717410842200       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717410847324       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717410847351       residual = 5.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+03 is 9.772969e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717410842200       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717410843481       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717410843488       residual = 5.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+04 is 2.443331e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.366238 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6206e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793734e-01 3 1  ON 1
ci_0003                -4.800145e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566008e-02 3 1  ON 4
ci_0006                -4.394250e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116037e-02 3 1  ON 7
ci_0009                -3.231942e-02 3 1  ON 8
ci_0010                -3.067530e-02 3 1  ON 9
ci_0011                -2.797652e-02 3 1  ON 10
ci_0012                -2.668133e-02 3 1  ON 11
ci_0013                 2.685603e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740078e-02 3 1  ON 14
ci_0016                 2.631639e-02 3 1  ON 15
ci_0017                 2.381445e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053738e-02 3 1  ON 18
ci_0020                 1.958647e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802447e-02 3 1  ON 21
ci_0023                -1.925819e-02 3 1  ON 22
ci_0024                -1.769705e-02 3 1  ON 23
ci_0025                -1.834624e-02 3 1  ON 24
ci_0026                -1.756793e-02 3 1  ON 25
ci_0027                -1.738463e-02 3 1  ON 26
ci_0028                -1.696875e-02 3 1  ON 27
ci_0029                -1.560823e-02 3 1  ON 28
ci_0030                -1.613003e-02 3 1  ON 29
ci_0031                 1.557329e-02 3 1  ON 30
ci_0032                 1.395891e-02 3 1  ON 31
ci_0033                 1.701294e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777441e-02 3 1  ON 34
ci_0036                 1.687199e-02 3 1  ON 35
ci_0037                -1.516253e-02 3 1  ON 36
ci_0038                -1.405448e-02 3 1  ON 37
ci_0039                -1.577825e-02 3 1  ON 38
ci_0040                -1.504184e-02 3 1  ON 39
ci_0041                 1.576775e-02 3 1  ON 40
ci_0042                 1.567757e-02 3 1  ON 41
ci_0043                -1.498814e-02 3 1  ON 42
ci_0044                -1.596651e-02 3 1  ON 43
ci_0045                 1.532236e-02 3 1  ON 44
ci_0046                 1.581871e-02 3 1  ON 45
ci_0047                -1.454535e-02 3 1  ON 46
ci_0048                -1.418163e-02 3 1  ON 47
ci_0049                -1.248096e-02 3 1  ON 48
ci_0050                -1.371527e-02 3 1  ON 49
ci_0051                -1.342738e-02 3 1  ON 50
ci_0052                -1.273346e-02 3 1  ON 51
ci_0053                -1.284802e-02 3 1  ON 52
ci_0054                -1.222838e-02 3 1  ON 53
ci_0055                 1.247294e-02 3 1  ON 54
ci_0056                 1.271782e-02 3 1  ON 55
ci_0057                 1.316770e-02 3 1  ON 56
ci_0058                 1.240614e-02 3 1  ON 57
ci_0059                -1.297552e-02 3 1  ON 58
ci_0060                -1.272757e-02 3 1  ON 59
ci_0061                -1.265479e-02 3 1  ON 60
ci_0062                -1.293573e-02 3 1  ON 61
ci_0063                -1.193478e-02 3 1  ON 62
ci_0064                -1.123053e-02 3 1  ON 63
ci_0065                -1.136299e-02 3 1  ON 64
ci_0066                -1.180064e-02 3 1  ON 65
ci_0067                -1.109568e-02 3 1  ON 66
ci_0068                -1.078661e-02 3 1  ON 67
ci_0069                 1.072351e-02 3 1  ON 68
ci_0070                 1.009535e-02 3 1  ON 69
ci_0071                 9.961893e-03 3 1  ON 70
ci_0072                 9.555850e-03 3 1  ON 71
ci_0073                 1.150226e-02 3 1  ON 72
ci_0074                 1.054406e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.5923
    reference variance = 2.94197
====================================================
  Execution time = 1.2805e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5172e+00
  Total weights = 1.9452e+06
  Execution time = 2.1932e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.548394974134
                                         uncertainty =       0.031855342098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.548394974134
                                         uncertainty =       0.031855342098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128793429
  error estimate for blocks of size 2^( 2) =       0.001167496769
  error estimate for blocks of size 2^( 3) =       0.001199861768
  error estimate for blocks of size 2^( 4) =       0.001223424642
  error estimate for blocks of size 2^( 5) =       0.001237167081
  error estimate for blocks of size 2^( 6) =       0.001248723648
  error estimate for blocks of size 2^( 7) =       0.001255217712

      target function =                  N/A
              le_mean =     -16.717799167022
             les_mean =     282.002008232514
             stat err =       0.001241133271
             autocorr =       1.208948749463
              std dev =       1.596380517999
             le_variance =       2.548430758247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.548394901094
                                         uncertainty =       0.031855347411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.548394901094
                                         uncertainty =       0.031855347411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128793413
  error estimate for blocks of size 2^( 2) =       0.001167496726
  error estimate for blocks of size 2^( 3) =       0.001199861698
  error estimate for blocks of size 2^( 4) =       0.001223424551
  error estimate for blocks of size 2^( 5) =       0.001237166979
  error estimate for blocks of size 2^( 6) =       0.001248723533
  error estimate for blocks of size 2^( 7) =       0.001255217601

      target function =                  N/A
              le_mean =     -16.717799167644
             les_mean =     282.002007953725
             stat err =       0.001241133166
             autocorr =       1.208948580096
              std dev =       1.596380494982
             le_variance =       2.548430684759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.548394937602
                                         uncertainty =       0.031855344755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.548394937602
                                         uncertainty =       0.031855344755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128793421
  error estimate for blocks of size 2^( 2) =       0.001167496748
  error estimate for blocks of size 2^( 3) =       0.001199861733
  error estimate for blocks of size 2^( 4) =       0.001223424596
  error estimate for blocks of size 2^( 5) =       0.001237167030
  error estimate for blocks of size 2^( 6) =       0.001248723591
  error estimate for blocks of size 2^( 7) =       0.001255217657

      target function =                  N/A
              le_mean =     -16.717799167332
             les_mean =     282.002008092085
             stat err =       0.001241133218
             autocorr =       1.208948664766
              std dev =       1.596380506487
             le_variance =       2.548430721491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.548394969567
                                         uncertainty =       0.031855342430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.548394969567
                                         uncertainty =       0.031855342430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128793428
  error estimate for blocks of size 2^( 2) =       0.001167496766
  error estimate for blocks of size 2^( 3) =       0.001199861764
  error estimate for blocks of size 2^( 4) =       0.001223424637
  error estimate for blocks of size 2^( 5) =       0.001237167075
  error estimate for blocks of size 2^( 6) =       0.001248723641
  error estimate for blocks of size 2^( 7) =       0.001255217705

      target function =                  N/A
              le_mean =     -16.717799167061
             les_mean =     282.002008214848
             stat err =       0.001241133264
             autocorr =       1.208948738876
              std dev =       1.596380516560
             le_variance =       2.548430753651


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717799167022        initial
     1.4552e+03     1.4552e+04             3.9086e-07       -16.717799167644  <--
     5.8208e+03     5.8208e+04             9.7730e-08       -16.717799167332
     2.3283e+04     2.3283e+05             2.4433e-08       -16.717799167061

*****************************************************************************
Applying the update for shift_i =   1.4552e+03     and shift_s =   1.4552e+04
*****************************************************************************

  Execution time = 2.3908e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800156e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394250e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116046e-02 3 1  ON 7
ci_0009                -3.231971e-02 3 1  ON 8
ci_0010                -3.067539e-02 3 1  ON 9
ci_0011                -2.797645e-02 3 1  ON 10
ci_0012                -2.668125e-02 3 1  ON 11
ci_0013                 2.685616e-02 3 1  ON 12
ci_0014                 2.692506e-02 3 1  ON 13
ci_0015                 2.740092e-02 3 1  ON 14
ci_0016                 2.631661e-02 3 1  ON 15
ci_0017                 2.381452e-02 3 1  ON 16
ci_0018                 2.343352e-02 3 1  ON 17
ci_0019                 2.053743e-02 3 1  ON 18
ci_0020                 1.958638e-02 3 1  ON 19
ci_0021                 1.858920e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925839e-02 3 1  ON 22
ci_0024                -1.769717e-02 3 1  ON 23
ci_0025                -1.834630e-02 3 1  ON 24
ci_0026                -1.756797e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560833e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587537e-02 3 1  ON 33
ci_0035                 1.777446e-02 3 1  ON 34
ci_0036                 1.687199e-02 3 1  ON 35
ci_0037                -1.516266e-02 3 1  ON 36
ci_0038                -1.405459e-02 3 1  ON 37
ci_0039                -1.577828e-02 3 1  ON 38
ci_0040                -1.504183e-02 3 1  ON 39
ci_0041                 1.576791e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498815e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581861e-02 3 1  ON 45
ci_0047                -1.454539e-02 3 1  ON 46
ci_0048                -1.418166e-02 3 1  ON 47
ci_0049                -1.248111e-02 3 1  ON 48
ci_0050                -1.371533e-02 3 1  ON 49
ci_0051                -1.342734e-02 3 1  ON 50
ci_0052                -1.273338e-02 3 1  ON 51
ci_0053                -1.284802e-02 3 1  ON 52
ci_0054                -1.222850e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316754e-02 3 1  ON 56
ci_0058                 1.240589e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272750e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293577e-02 3 1  ON 61
ci_0063                -1.193473e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136309e-02 3 1  ON 64
ci_0066                -1.180062e-02 3 1  ON 65
ci_0067                -1.109581e-02 3 1  ON 66
ci_0068                -1.078648e-02 3 1  ON 67
ci_0069                 1.072374e-02 3 1  ON 68
ci_0070                 1.009529e-02 3 1  ON 69
ci_0071                 9.961801e-03 3 1  ON 70
ci_0072                 9.555933e-03 3 1  ON 71
ci_0073                 1.150213e-02 3 1  ON 72
ci_0074                 1.054419e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0119e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6704e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.759
    reference variance = 1.84618
====================================================
  Execution time = 1.3079e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0295e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.6083e+00
  Total weights = 1.945622828e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2115e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619591443945
                                         uncertainty =       0.059407282685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619591443945
                                         uncertainty =       0.059407282685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144350717
  error estimate for blocks of size 2^( 2) =       0.001182488222
  error estimate for blocks of size 2^( 3) =       0.001214951587
  error estimate for blocks of size 2^( 4) =       0.001238669959
  error estimate for blocks of size 2^( 5) =       0.001251088408
  error estimate for blocks of size 2^( 6) =       0.001257442352
  error estimate for blocks of size 2^( 7) =       0.001263770731

      target function =                  N/A
              le_mean =     -16.717774828583
             les_mean =     282.092265983080
             stat err =       0.001252742862
             autocorr =       1.198410435890
              std dev =       1.618382196912
             le_variance =       2.619160935281


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671777482858e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717774827679       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717774889026       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717774889605       residual = 8.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+02 is 1.859155e-06

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717774827679       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717774843025       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717774843169       residual = 8.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+03 is 4.650019e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717774827679       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717774831516       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717774831552       residual = 8.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+03 is 1.162638e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.367410 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6297e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800182e-02 3 1  ON 2
ci_0004                -4.638664e-02 3 1  ON 3
ci_0005                -4.566028e-02 3 1  ON 4
ci_0006                -4.394249e-02 3 1  ON 5
ci_0007                -3.091335e-02 3 1  ON 6
ci_0008                -3.116039e-02 3 1  ON 7
ci_0009                -3.232000e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797641e-02 3 1  ON 10
ci_0012                -2.668131e-02 3 1  ON 11
ci_0013                 2.685630e-02 3 1  ON 12
ci_0014                 2.692491e-02 3 1  ON 13
ci_0015                 2.740106e-02 3 1  ON 14
ci_0016                 2.631646e-02 3 1  ON 15
ci_0017                 2.381460e-02 3 1  ON 16
ci_0018                 2.343359e-02 3 1  ON 17
ci_0019                 2.053737e-02 3 1  ON 18
ci_0020                 1.958632e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802468e-02 3 1  ON 21
ci_0023                -1.925851e-02 3 1  ON 22
ci_0024                -1.769735e-02 3 1  ON 23
ci_0025                -1.834618e-02 3 1  ON 24
ci_0026                -1.756784e-02 3 1  ON 25
ci_0027                -1.738503e-02 3 1  ON 26
ci_0028                -1.696867e-02 3 1  ON 27
ci_0029                -1.560844e-02 3 1  ON 28
ci_0030                -1.612986e-02 3 1  ON 29
ci_0031                 1.557332e-02 3 1  ON 30
ci_0032                 1.395905e-02 3 1  ON 31
ci_0033                 1.701304e-02 3 1  ON 32
ci_0034                 1.587531e-02 3 1  ON 33
ci_0035                 1.777400e-02 3 1  ON 34
ci_0036                 1.687204e-02 3 1  ON 35
ci_0037                -1.516273e-02 3 1  ON 36
ci_0038                -1.405463e-02 3 1  ON 37
ci_0039                -1.577822e-02 3 1  ON 38
ci_0040                -1.504205e-02 3 1  ON 39
ci_0041                 1.576792e-02 3 1  ON 40
ci_0042                 1.567755e-02 3 1  ON 41
ci_0043                -1.498823e-02 3 1  ON 42
ci_0044                -1.596632e-02 3 1  ON 43
ci_0045                 1.532236e-02 3 1  ON 44
ci_0046                 1.581849e-02 3 1  ON 45
ci_0047                -1.454524e-02 3 1  ON 46
ci_0048                -1.418150e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371510e-02 3 1  ON 49
ci_0051                -1.342713e-02 3 1  ON 50
ci_0052                -1.273303e-02 3 1  ON 51
ci_0053                -1.284823e-02 3 1  ON 52
ci_0054                -1.222877e-02 3 1  ON 53
ci_0055                 1.247295e-02 3 1  ON 54
ci_0056                 1.271776e-02 3 1  ON 55
ci_0057                 1.316737e-02 3 1  ON 56
ci_0058                 1.240603e-02 3 1  ON 57
ci_0059                -1.297554e-02 3 1  ON 58
ci_0060                -1.272722e-02 3 1  ON 59
ci_0061                -1.265457e-02 3 1  ON 60
ci_0062                -1.293564e-02 3 1  ON 61
ci_0063                -1.193485e-02 3 1  ON 62
ci_0064                -1.123042e-02 3 1  ON 63
ci_0065                -1.136306e-02 3 1  ON 64
ci_0066                -1.180051e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078667e-02 3 1  ON 67
ci_0069                 1.072376e-02 3 1  ON 68
ci_0070                 1.009553e-02 3 1  ON 69
ci_0071                 9.961654e-03 3 1  ON 70
ci_0072                 9.555932e-03 3 1  ON 71
ci_0073                 1.150201e-02 3 1  ON 72
ci_0074                 1.054415e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.5114
    reference variance = 2.8966
====================================================
  Execution time = 1.2728e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5241e+00
  Total weights = 1.9455e+06
  Execution time = 2.1944e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553930712094
                                         uncertainty =       0.030036057384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553930712094
                                         uncertainty =       0.030036057384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130033833
  error estimate for blocks of size 2^( 2) =       0.001167747447
  error estimate for blocks of size 2^( 3) =       0.001200823843
  error estimate for blocks of size 2^( 4) =       0.001223150138
  error estimate for blocks of size 2^( 5) =       0.001236863054
  error estimate for blocks of size 2^( 6) =       0.001241779312
  error estimate for blocks of size 2^( 7) =       0.001250969155

      target function =                  N/A
              le_mean =     -16.717685227801
             les_mean =     282.005067731205
             stat err =       0.001238190415
             autocorr =       1.200582428754
              std dev =       1.598134741571
             le_variance =       2.554034652217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553927923873
                                         uncertainty =       0.030036042190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553927923873
                                         uncertainty =       0.030036042190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130033216
  error estimate for blocks of size 2^( 2) =       0.001167746866
  error estimate for blocks of size 2^( 3) =       0.001200823317
  error estimate for blocks of size 2^( 4) =       0.001223149627
  error estimate for blocks of size 2^( 5) =       0.001236862584
  error estimate for blocks of size 2^( 6) =       0.001241778775
  error estimate for blocks of size 2^( 7) =       0.001250968662

      target function =                  N/A
              le_mean =     -16.717685201182
             les_mean =     282.005060653071
             stat err =       0.001238189912
             autocorr =       1.200582763233
              std dev =       1.598133870024
             le_variance =       2.554031866519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553929317068
                                         uncertainty =       0.030036049783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553929317068
                                         uncertainty =       0.030036049783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130033524
  error estimate for blocks of size 2^( 2) =       0.001167747156
  error estimate for blocks of size 2^( 3) =       0.001200823580
  error estimate for blocks of size 2^( 4) =       0.001223149883
  error estimate for blocks of size 2^( 5) =       0.001236862819
  error estimate for blocks of size 2^( 6) =       0.001241779043
  error estimate for blocks of size 2^( 7) =       0.001250968908

      target function =                  N/A
              le_mean =     -16.717685214465
             les_mean =     282.005064158139
             stat err =       0.001238190163
             autocorr =       1.200582596072
              std dev =       1.598134305512
             le_variance =       2.554033258454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553930537675
                                         uncertainty =       0.030036056433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.553930537675
                                         uncertainty =       0.030036056433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130033794
  error estimate for blocks of size 2^( 2) =       0.001167747411
  error estimate for blocks of size 2^( 3) =       0.001200823810
  error estimate for blocks of size 2^( 4) =       0.001223150106
  error estimate for blocks of size 2^( 5) =       0.001236863025
  error estimate for blocks of size 2^( 6) =       0.001241779278
  error estimate for blocks of size 2^( 7) =       0.001250969124

      target function =                  N/A
              le_mean =     -16.717685226132
             les_mean =     282.005067280998
             stat err =       0.001238190383
             autocorr =       1.200582449669
              std dev =       1.598134687051
             le_variance =       2.554034477956


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717685227801        initial  <--
     3.6380e+02     3.6380e+03             1.8592e-06       -16.717685201182
     1.4552e+03     1.4552e+04             4.6500e-07       -16.717685214465
     5.8208e+03     5.8208e+04             1.1626e-07       -16.717685226132

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8399
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800156e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394250e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116046e-02 3 1  ON 7
ci_0009                -3.231971e-02 3 1  ON 8
ci_0010                -3.067539e-02 3 1  ON 9
ci_0011                -2.797645e-02 3 1  ON 10
ci_0012                -2.668125e-02 3 1  ON 11
ci_0013                 2.685616e-02 3 1  ON 12
ci_0014                 2.692506e-02 3 1  ON 13
ci_0015                 2.740092e-02 3 1  ON 14
ci_0016                 2.631661e-02 3 1  ON 15
ci_0017                 2.381452e-02 3 1  ON 16
ci_0018                 2.343352e-02 3 1  ON 17
ci_0019                 2.053743e-02 3 1  ON 18
ci_0020                 1.958638e-02 3 1  ON 19
ci_0021                 1.858920e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925839e-02 3 1  ON 22
ci_0024                -1.769717e-02 3 1  ON 23
ci_0025                -1.834630e-02 3 1  ON 24
ci_0026                -1.756797e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560833e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587537e-02 3 1  ON 33
ci_0035                 1.777446e-02 3 1  ON 34
ci_0036                 1.687199e-02 3 1  ON 35
ci_0037                -1.516266e-02 3 1  ON 36
ci_0038                -1.405459e-02 3 1  ON 37
ci_0039                -1.577828e-02 3 1  ON 38
ci_0040                -1.504183e-02 3 1  ON 39
ci_0041                 1.576791e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498815e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581861e-02 3 1  ON 45
ci_0047                -1.454539e-02 3 1  ON 46
ci_0048                -1.418166e-02 3 1  ON 47
ci_0049                -1.248111e-02 3 1  ON 48
ci_0050                -1.371533e-02 3 1  ON 49
ci_0051                -1.342734e-02 3 1  ON 50
ci_0052                -1.273338e-02 3 1  ON 51
ci_0053                -1.284802e-02 3 1  ON 52
ci_0054                -1.222850e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316754e-02 3 1  ON 56
ci_0058                 1.240589e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272750e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293577e-02 3 1  ON 61
ci_0063                -1.193473e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136309e-02 3 1  ON 64
ci_0066                -1.180062e-02 3 1  ON 65
ci_0067                -1.109581e-02 3 1  ON 66
ci_0068                -1.078648e-02 3 1  ON 67
ci_0069                 1.072374e-02 3 1  ON 68
ci_0070                 1.009529e-02 3 1  ON 69
ci_0071                 9.961801e-03 3 1  ON 70
ci_0072                 9.555933e-03 3 1  ON 71
ci_0073                 1.150213e-02 3 1  ON 72
ci_0074                 1.054419e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0147e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6702e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.7901
    reference variance = 2.0138
====================================================
  Execution time = 1.3030e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0269e+04
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5652e+00
  Total weights = 1.945928348e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1819e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.593266704995
                                         uncertainty =       0.035440641711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.593266704995
                                         uncertainty =       0.035440641711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138516683
  error estimate for blocks of size 2^( 2) =       0.001176485936
  error estimate for blocks of size 2^( 3) =       0.001209197247
  error estimate for blocks of size 2^( 4) =       0.001232366786
  error estimate for blocks of size 2^( 5) =       0.001247330149
  error estimate for blocks of size 2^( 6) =       0.001250671169
  error estimate for blocks of size 2^( 7) =       0.001255838108

      target function =                  N/A
              le_mean =     -16.715566782144
             les_mean =     281.975410390564
             stat err =       0.001246551553
             autocorr =       1.198786077166
              std dev =       1.610131495877
             le_variance =       2.592523434014


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671556678214e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715566781216       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715566784701       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715566784848       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+03 is 1.133885e-07

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715566781216       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715566782087       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715566782124       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+04 is 2.834855e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715566781216       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715566781434       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715566781443       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+04 is 7.087226e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.368574 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6219e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800156e-02 3 1  ON 2
ci_0004                -4.638677e-02 3 1  ON 3
ci_0005                -4.566019e-02 3 1  ON 4
ci_0006                -4.394251e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116044e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067538e-02 3 1  ON 9
ci_0011                -2.797645e-02 3 1  ON 10
ci_0012                -2.668125e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692505e-02 3 1  ON 13
ci_0015                 2.740091e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381454e-02 3 1  ON 16
ci_0018                 2.343352e-02 3 1  ON 17
ci_0019                 2.053744e-02 3 1  ON 18
ci_0020                 1.958637e-02 3 1  ON 19
ci_0021                 1.858918e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925842e-02 3 1  ON 22
ci_0024                -1.769718e-02 3 1  ON 23
ci_0025                -1.834628e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738488e-02 3 1  ON 26
ci_0028                -1.696870e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613009e-02 3 1  ON 29
ci_0031                 1.557326e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587538e-02 3 1  ON 33
ci_0035                 1.777444e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405458e-02 3 1  ON 37
ci_0039                -1.577827e-02 3 1  ON 38
ci_0040                -1.504183e-02 3 1  ON 39
ci_0041                 1.576790e-02 3 1  ON 40
ci_0042                 1.567764e-02 3 1  ON 41
ci_0043                -1.498816e-02 3 1  ON 42
ci_0044                -1.596638e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454539e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248111e-02 3 1  ON 48
ci_0050                -1.371534e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222849e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271802e-02 3 1  ON 55
ci_0057                 1.316752e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297555e-02 3 1  ON 58
ci_0060                -1.272751e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293575e-02 3 1  ON 61
ci_0063                -1.193474e-02 3 1  ON 62
ci_0064                -1.123057e-02 3 1  ON 63
ci_0065                -1.136309e-02 3 1  ON 64
ci_0066                -1.180063e-02 3 1  ON 65
ci_0067                -1.109580e-02 3 1  ON 66
ci_0068                -1.078648e-02 3 1  ON 67
ci_0069                 1.072375e-02 3 1  ON 68
ci_0070                 1.009531e-02 3 1  ON 69
ci_0071                 9.961795e-03 3 1  ON 70
ci_0072                 9.555933e-03 3 1  ON 71
ci_0073                 1.150211e-02 3 1  ON 72
ci_0074                 1.054418e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9862
    reference variance = 1.19423
====================================================
  Execution time = 1.2767e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4804e+00
  Total weights = 1.9455e+06
  Execution time = 2.1932e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508499703553
                                         uncertainty =       0.024265333453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508499703553
                                         uncertainty =       0.024265333453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119782938
  error estimate for blocks of size 2^( 2) =       0.001158509834
  error estimate for blocks of size 2^( 3) =       0.001191330299
  error estimate for blocks of size 2^( 4) =       0.001215711030
  error estimate for blocks of size 2^( 5) =       0.001232078762
  error estimate for blocks of size 2^( 6) =       0.001243476345
  error estimate for blocks of size 2^( 7) =       0.001250138036

      target function =                  N/A
              le_mean =     -16.719464167276
             les_mean =     282.020920521063
             stat err =       0.001235351043
             autocorr =       1.217063059354
              std dev =       1.583637555675
             le_variance =       2.507907907744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508499626622
                                         uncertainty =       0.024265331637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508499626622
                                         uncertainty =       0.024265331637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119782921
  error estimate for blocks of size 2^( 2) =       0.001158509818
  error estimate for blocks of size 2^( 3) =       0.001191330283
  error estimate for blocks of size 2^( 4) =       0.001215711014
  error estimate for blocks of size 2^( 5) =       0.001232078752
  error estimate for blocks of size 2^( 6) =       0.001243476332
  error estimate for blocks of size 2^( 7) =       0.001250138022

      target function =                  N/A
              le_mean =     -16.719464166921
             les_mean =     282.020920525939
             stat err =       0.001235351030
             autocorr =       1.217063069943
              std dev =       1.583637531449
             le_variance =       2.507907831012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508499665084
                                         uncertainty =       0.024265332545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508499665084
                                         uncertainty =       0.024265332545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119782930
  error estimate for blocks of size 2^( 2) =       0.001158509826
  error estimate for blocks of size 2^( 3) =       0.001191330291
  error estimate for blocks of size 2^( 4) =       0.001215711022
  error estimate for blocks of size 2^( 5) =       0.001232078757
  error estimate for blocks of size 2^( 6) =       0.001243476338
  error estimate for blocks of size 2^( 7) =       0.001250138029

      target function =                  N/A
              le_mean =     -16.719464167098
             les_mean =     282.020920523434
             stat err =       0.001235351037
             autocorr =       1.217063064650
              std dev =       1.583637543561
             le_variance =       2.507907869375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508499698744
                                         uncertainty =       0.024265333340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508499698744
                                         uncertainty =       0.024265333340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119782937
  error estimate for blocks of size 2^( 2) =       0.001158509833
  error estimate for blocks of size 2^( 3) =       0.001191330298
  error estimate for blocks of size 2^( 4) =       0.001215711029
  error estimate for blocks of size 2^( 5) =       0.001232078762
  error estimate for blocks of size 2^( 6) =       0.001243476344
  error estimate for blocks of size 2^( 7) =       0.001250138036

      target function =                  N/A
              le_mean =     -16.719464167254
             les_mean =     282.020920521352
             stat err =       0.001235351043
             autocorr =       1.217063060017
              std dev =       1.583637554161
             le_variance =       2.507907902948


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719464167276        initial  <--
     3.6380e+03     3.6380e+04             1.1339e-07       -16.719464166921
     1.4552e+04     1.4552e+05             2.8349e-08       -16.719464167098
     5.8208e+04     5.8208e+05             7.0872e-09       -16.719464167254

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8671
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800156e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394250e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116046e-02 3 1  ON 7
ci_0009                -3.231971e-02 3 1  ON 8
ci_0010                -3.067539e-02 3 1  ON 9
ci_0011                -2.797645e-02 3 1  ON 10
ci_0012                -2.668125e-02 3 1  ON 11
ci_0013                 2.685616e-02 3 1  ON 12
ci_0014                 2.692506e-02 3 1  ON 13
ci_0015                 2.740092e-02 3 1  ON 14
ci_0016                 2.631661e-02 3 1  ON 15
ci_0017                 2.381452e-02 3 1  ON 16
ci_0018                 2.343352e-02 3 1  ON 17
ci_0019                 2.053743e-02 3 1  ON 18
ci_0020                 1.958638e-02 3 1  ON 19
ci_0021                 1.858920e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925839e-02 3 1  ON 22
ci_0024                -1.769717e-02 3 1  ON 23
ci_0025                -1.834630e-02 3 1  ON 24
ci_0026                -1.756797e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560833e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587537e-02 3 1  ON 33
ci_0035                 1.777446e-02 3 1  ON 34
ci_0036                 1.687199e-02 3 1  ON 35
ci_0037                -1.516266e-02 3 1  ON 36
ci_0038                -1.405459e-02 3 1  ON 37
ci_0039                -1.577828e-02 3 1  ON 38
ci_0040                -1.504183e-02 3 1  ON 39
ci_0041                 1.576791e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498815e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581861e-02 3 1  ON 45
ci_0047                -1.454539e-02 3 1  ON 46
ci_0048                -1.418166e-02 3 1  ON 47
ci_0049                -1.248111e-02 3 1  ON 48
ci_0050                -1.371533e-02 3 1  ON 49
ci_0051                -1.342734e-02 3 1  ON 50
ci_0052                -1.273338e-02 3 1  ON 51
ci_0053                -1.284802e-02 3 1  ON 52
ci_0054                -1.222850e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316754e-02 3 1  ON 56
ci_0058                 1.240589e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272750e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293577e-02 3 1  ON 61
ci_0063                -1.193473e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136309e-02 3 1  ON 64
ci_0066                -1.180062e-02 3 1  ON 65
ci_0067                -1.109581e-02 3 1  ON 66
ci_0068                -1.078648e-02 3 1  ON 67
ci_0069                 1.072374e-02 3 1  ON 68
ci_0070                 1.009529e-02 3 1  ON 69
ci_0071                 9.961801e-03 3 1  ON 70
ci_0072                 9.555933e-03 3 1  ON 71
ci_0073                 1.150213e-02 3 1  ON 72
ci_0074                 1.054419e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0092e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6707e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.5968
    reference variance = 3.89087
====================================================
  Execution time = 1.3040e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0270e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.6951e+00
  Total weights = 1.945629816e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1720e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.722698647259
                                         uncertainty =       0.083513804972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.722698647259
                                         uncertainty =       0.083513804972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001166689635
  error estimate for blocks of size 2^( 2) =       0.001203979382
  error estimate for blocks of size 2^( 3) =       0.001236128801
  error estimate for blocks of size 2^( 4) =       0.001257885927
  error estimate for blocks of size 2^( 5) =       0.001272117156
  error estimate for blocks of size 2^( 6) =       0.001282100698
  error estimate for blocks of size 2^( 7) =       0.001291336205

      target function =                  N/A
              le_mean =     -16.717134793460
             les_mean =     282.157722629480
             stat err =       0.001275859996
             autocorr =       1.195901367145
              std dev =       1.649974703652
             le_variance =       2.722416522691


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671713479346e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717134792575       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717134792667       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717134792663       residual = 1.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+04 is 1.079209e-08

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717134792575       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717134792598       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717134792597       residual = 1.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+05 is 2.698039e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717134792575       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717134792581       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717134792580       residual = 1.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+05 is 6.745106e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.369716 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6218e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800156e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394250e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116045e-02 3 1  ON 7
ci_0009                -3.231971e-02 3 1  ON 8
ci_0010                -3.067539e-02 3 1  ON 9
ci_0011                -2.797645e-02 3 1  ON 10
ci_0012                -2.668125e-02 3 1  ON 11
ci_0013                 2.685615e-02 3 1  ON 12
ci_0014                 2.692506e-02 3 1  ON 13
ci_0015                 2.740092e-02 3 1  ON 14
ci_0016                 2.631661e-02 3 1  ON 15
ci_0017                 2.381452e-02 3 1  ON 16
ci_0018                 2.343352e-02 3 1  ON 17
ci_0019                 2.053743e-02 3 1  ON 18
ci_0020                 1.958638e-02 3 1  ON 19
ci_0021                 1.858920e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925839e-02 3 1  ON 22
ci_0024                -1.769718e-02 3 1  ON 23
ci_0025                -1.834630e-02 3 1  ON 24
ci_0026                -1.756797e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560833e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587537e-02 3 1  ON 33
ci_0035                 1.777446e-02 3 1  ON 34
ci_0036                 1.687199e-02 3 1  ON 35
ci_0037                -1.516266e-02 3 1  ON 36
ci_0038                -1.405459e-02 3 1  ON 37
ci_0039                -1.577828e-02 3 1  ON 38
ci_0040                -1.504183e-02 3 1  ON 39
ci_0041                 1.576791e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498815e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581861e-02 3 1  ON 45
ci_0047                -1.454539e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248111e-02 3 1  ON 48
ci_0050                -1.371533e-02 3 1  ON 49
ci_0051                -1.342734e-02 3 1  ON 50
ci_0052                -1.273338e-02 3 1  ON 51
ci_0053                -1.284803e-02 3 1  ON 52
ci_0054                -1.222850e-02 3 1  ON 53
ci_0055                 1.247285e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316754e-02 3 1  ON 56
ci_0058                 1.240589e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272750e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293577e-02 3 1  ON 61
ci_0063                -1.193473e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136309e-02 3 1  ON 64
ci_0066                -1.180062e-02 3 1  ON 65
ci_0067                -1.109581e-02 3 1  ON 66
ci_0068                -1.078648e-02 3 1  ON 67
ci_0069                 1.072374e-02 3 1  ON 68
ci_0070                 1.009529e-02 3 1  ON 69
ci_0071                 9.961800e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150213e-02 3 1  ON 72
ci_0074                 1.054419e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8541
    reference variance = 2.84855
====================================================
  Execution time = 1.2770e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6715e+01
  VMC Evar = 2.5881e+00
  Total weights = 1.9454e+06
  Execution time = 2.1924e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.614378491620
                                         uncertainty =       0.037253919286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.614378491620
                                         uncertainty =       0.037253919286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001143274583
  error estimate for blocks of size 2^( 2) =       0.001181136438
  error estimate for blocks of size 2^( 3) =       0.001213452530
  error estimate for blocks of size 2^( 4) =       0.001237250300
  error estimate for blocks of size 2^( 5) =       0.001250965129
  error estimate for blocks of size 2^( 6) =       0.001257865641
  error estimate for blocks of size 2^( 7) =       0.001264972530

      target function =                  N/A
              le_mean =     -16.714905790182
             les_mean =     281.976181206475
             stat err =       0.001252763400
             autocorr =       1.200706929683
              std dev =       1.616860289341
             le_variance =       2.614237195249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.614378494188
                                         uncertainty =       0.037253919356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.614378494188
                                         uncertainty =       0.037253919356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001143274583
  error estimate for blocks of size 2^( 2) =       0.001181136439
  error estimate for blocks of size 2^( 3) =       0.001213452531
  error estimate for blocks of size 2^( 4) =       0.001237250301
  error estimate for blocks of size 2^( 5) =       0.001250965130
  error estimate for blocks of size 2^( 6) =       0.001257865642
  error estimate for blocks of size 2^( 7) =       0.001264972531

      target function =                  N/A
              le_mean =     -16.714905790204
             les_mean =     281.976181219786
             stat err =       0.001252763401
             autocorr =       1.200706930551
              std dev =       1.616860290010
             le_variance =       2.614237197412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.614378492904
                                         uncertainty =       0.037253919321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.614378492904
                                         uncertainty =       0.037253919321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001143274583
  error estimate for blocks of size 2^( 2) =       0.001181136438
  error estimate for blocks of size 2^( 3) =       0.001213452530
  error estimate for blocks of size 2^( 4) =       0.001237250300
  error estimate for blocks of size 2^( 5) =       0.001250965130
  error estimate for blocks of size 2^( 6) =       0.001257865642
  error estimate for blocks of size 2^( 7) =       0.001264972531

      target function =                  N/A
              le_mean =     -16.714905790193
             les_mean =     281.976181213129
             stat err =       0.001252763401
             autocorr =       1.200706930117
              std dev =       1.616860289676
             le_variance =       2.614237196330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.614378491781
                                         uncertainty =       0.037253919290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.614378491781
                                         uncertainty =       0.037253919290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001143274583
  error estimate for blocks of size 2^( 2) =       0.001181136438
  error estimate for blocks of size 2^( 3) =       0.001213452530
  error estimate for blocks of size 2^( 4) =       0.001237250300
  error estimate for blocks of size 2^( 5) =       0.001250965129
  error estimate for blocks of size 2^( 6) =       0.001257865641
  error estimate for blocks of size 2^( 7) =       0.001264972530

      target function =                  N/A
              le_mean =     -16.714905790183
             les_mean =     281.976181207307
             stat err =       0.001252763400
             autocorr =       1.200706929738
              std dev =       1.616860289383
             le_variance =       2.614237195384


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.714905790182        initial
     3.6380e+04     3.6380e+05             1.0792e-08       -16.714905790204  <--
     1.4552e+05     1.4552e+06             2.6980e-09       -16.714905790193
     5.8208e+05     5.8208e+06             6.7451e-10       -16.714905790183

*****************************************************************************
Applying the update for shift_i =   3.6380e+04     and shift_s =   3.6380e+05
*****************************************************************************

  Execution time = 2.3877e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800157e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394249e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116045e-02 3 1  ON 7
ci_0009                -3.231972e-02 3 1  ON 8
ci_0010                -3.067539e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668125e-02 3 1  ON 11
ci_0013                 2.685615e-02 3 1  ON 12
ci_0014                 2.692506e-02 3 1  ON 13
ci_0015                 2.740091e-02 3 1  ON 14
ci_0016                 2.631661e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343352e-02 3 1  ON 17
ci_0019                 2.053744e-02 3 1  ON 18
ci_0020                 1.958637e-02 3 1  ON 19
ci_0021                 1.858920e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925839e-02 3 1  ON 22
ci_0024                -1.769718e-02 3 1  ON 23
ci_0025                -1.834630e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587537e-02 3 1  ON 33
ci_0035                 1.777446e-02 3 1  ON 34
ci_0036                 1.687199e-02 3 1  ON 35
ci_0037                -1.516266e-02 3 1  ON 36
ci_0038                -1.405459e-02 3 1  ON 37
ci_0039                -1.577828e-02 3 1  ON 38
ci_0040                -1.504183e-02 3 1  ON 39
ci_0041                 1.576791e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498816e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581861e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248111e-02 3 1  ON 48
ci_0050                -1.371533e-02 3 1  ON 49
ci_0051                -1.342734e-02 3 1  ON 50
ci_0052                -1.273338e-02 3 1  ON 51
ci_0053                -1.284803e-02 3 1  ON 52
ci_0054                -1.222850e-02 3 1  ON 53
ci_0055                 1.247285e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316753e-02 3 1  ON 56
ci_0058                 1.240589e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272750e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293577e-02 3 1  ON 61
ci_0063                -1.193473e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136310e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109582e-02 3 1  ON 66
ci_0068                -1.078648e-02 3 1  ON 67
ci_0069                 1.072375e-02 3 1  ON 68
ci_0070                 1.009529e-02 3 1  ON 69
ci_0071                 9.961798e-03 3 1  ON 70
ci_0072                 9.555938e-03 3 1  ON 71
ci_0073                 1.150213e-02 3 1  ON 72
ci_0074                 1.054418e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0102e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6708e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9325
    reference variance = 1.80135
====================================================
  Execution time = 1.3104e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0228e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.6689e+00
  Total weights = 1.945916203e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1963e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.700929043830
                                         uncertainty =       0.095735474008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.700929043830
                                         uncertainty =       0.095735474008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001162166496
  error estimate for blocks of size 2^( 2) =       0.001199807683
  error estimate for blocks of size 2^( 3) =       0.001232626000
  error estimate for blocks of size 2^( 4) =       0.001253140315
  error estimate for blocks of size 2^( 5) =       0.001269653481
  error estimate for blocks of size 2^( 6) =       0.001273364927
  error estimate for blocks of size 2^( 7) =       0.001279081871

      target function =                  N/A
              le_mean =     -16.717954733388
             les_mean =     282.158899665019
             stat err =       0.001268810149
             autocorr =       1.191946013767
              std dev =       1.643577916464
             le_variance =       2.701348367487


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671795473339e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717954732491       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717954733904       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717954733905       residual = 1.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+03 is 5.303248e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717954732491       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717954732844       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717954732844       residual = 1.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+04 is 1.325840e-08

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717954732491       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717954732579       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717954732579       residual = 1.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+05 is 3.314619e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.370903 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6307e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800156e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394249e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116046e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067539e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668125e-02 3 1  ON 11
ci_0013                 2.685616e-02 3 1  ON 12
ci_0014                 2.692506e-02 3 1  ON 13
ci_0015                 2.740091e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343351e-02 3 1  ON 17
ci_0019                 2.053744e-02 3 1  ON 18
ci_0020                 1.958637e-02 3 1  ON 19
ci_0021                 1.858920e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925839e-02 3 1  ON 22
ci_0024                -1.769718e-02 3 1  ON 23
ci_0025                -1.834631e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613007e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395895e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587538e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687199e-02 3 1  ON 35
ci_0037                -1.516265e-02 3 1  ON 36
ci_0038                -1.405459e-02 3 1  ON 37
ci_0039                -1.577828e-02 3 1  ON 38
ci_0040                -1.504183e-02 3 1  ON 39
ci_0041                 1.576792e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498816e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454539e-02 3 1  ON 46
ci_0048                -1.418164e-02 3 1  ON 47
ci_0049                -1.248111e-02 3 1  ON 48
ci_0050                -1.371533e-02 3 1  ON 49
ci_0051                -1.342734e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284802e-02 3 1  ON 52
ci_0054                -1.222851e-02 3 1  ON 53
ci_0055                 1.247285e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316753e-02 3 1  ON 56
ci_0058                 1.240589e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272751e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193473e-02 3 1  ON 62
ci_0064                -1.123059e-02 3 1  ON 63
ci_0065                -1.136310e-02 3 1  ON 64
ci_0066                -1.180062e-02 3 1  ON 65
ci_0067                -1.109582e-02 3 1  ON 66
ci_0068                -1.078649e-02 3 1  ON 67
ci_0069                 1.072375e-02 3 1  ON 68
ci_0070                 1.009529e-02 3 1  ON 69
ci_0071                 9.961798e-03 3 1  ON 70
ci_0072                 9.555945e-03 3 1  ON 71
ci_0073                 1.150213e-02 3 1  ON 72
ci_0074                 1.054418e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.53
    reference variance = 3.69874
====================================================
  Execution time = 1.2747e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5381e+00
  Total weights = 1.9456e+06
  Execution time = 2.1976e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561289279390
                                         uncertainty =       0.024883545296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561289279390
                                         uncertainty =       0.024883545296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131567482
  error estimate for blocks of size 2^( 2) =       0.001170836660
  error estimate for blocks of size 2^( 3) =       0.001203324483
  error estimate for blocks of size 2^( 4) =       0.001226426394
  error estimate for blocks of size 2^( 5) =       0.001240890448
  error estimate for blocks of size 2^( 6) =       0.001245602263
  error estimate for blocks of size 2^( 7) =       0.001250581601

      target function =                  N/A
              le_mean =     -16.715907148126
             les_mean =     281.959615902881
             stat err =       0.001240875176
             autocorr =       1.202528217545
              std dev =       1.600303684088
             le_variance =       2.560971881306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561289288624
                                         uncertainty =       0.024883545032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561289288624
                                         uncertainty =       0.024883545032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131567484
  error estimate for blocks of size 2^( 2) =       0.001170836661
  error estimate for blocks of size 2^( 3) =       0.001203324484
  error estimate for blocks of size 2^( 4) =       0.001226426394
  error estimate for blocks of size 2^( 5) =       0.001240890450
  error estimate for blocks of size 2^( 6) =       0.001245602264
  error estimate for blocks of size 2^( 7) =       0.001250581604

      target function =                  N/A
              le_mean =     -16.715907147573
             les_mean =     281.959615839581
             stat err =       0.001240875178
             autocorr =       1.202528216137
              std dev =       1.600303686990
             le_variance =       2.560971890593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561289284007
                                         uncertainty =       0.024883545164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561289284007
                                         uncertainty =       0.024883545164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131567483
  error estimate for blocks of size 2^( 2) =       0.001170836661
  error estimate for blocks of size 2^( 3) =       0.001203324483
  error estimate for blocks of size 2^( 4) =       0.001226426394
  error estimate for blocks of size 2^( 5) =       0.001240890449
  error estimate for blocks of size 2^( 6) =       0.001245602263
  error estimate for blocks of size 2^( 7) =       0.001250581602

      target function =                  N/A
              le_mean =     -16.715907147850
             les_mean =     281.959615871213
             stat err =       0.001240875177
             autocorr =       1.202528216841
              std dev =       1.600303685539
             le_variance =       2.560971885949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561289279967
                                         uncertainty =       0.024883545280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561289279967
                                         uncertainty =       0.024883545280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131567482
  error estimate for blocks of size 2^( 2) =       0.001170836660
  error estimate for blocks of size 2^( 3) =       0.001203324483
  error estimate for blocks of size 2^( 4) =       0.001226426394
  error estimate for blocks of size 2^( 5) =       0.001240890448
  error estimate for blocks of size 2^( 6) =       0.001245602263
  error estimate for blocks of size 2^( 7) =       0.001250581601

      target function =                  N/A
              le_mean =     -16.715907148092
             les_mean =     281.959615898920
             stat err =       0.001240875176
             autocorr =       1.202528217456
              std dev =       1.600303684269
             le_variance =       2.560971881886


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.715907148126        initial  <--
     9.0949e+03     9.0949e+04             5.3032e-08       -16.715907147573
     3.6380e+04     3.6380e+05             1.3258e-08       -16.715907147850
     1.4552e+05     1.4552e+06             3.3146e-09       -16.715907148092

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8657
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800157e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394249e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116045e-02 3 1  ON 7
ci_0009                -3.231972e-02 3 1  ON 8
ci_0010                -3.067539e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668125e-02 3 1  ON 11
ci_0013                 2.685615e-02 3 1  ON 12
ci_0014                 2.692506e-02 3 1  ON 13
ci_0015                 2.740091e-02 3 1  ON 14
ci_0016                 2.631661e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343352e-02 3 1  ON 17
ci_0019                 2.053744e-02 3 1  ON 18
ci_0020                 1.958637e-02 3 1  ON 19
ci_0021                 1.858920e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925839e-02 3 1  ON 22
ci_0024                -1.769718e-02 3 1  ON 23
ci_0025                -1.834630e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587537e-02 3 1  ON 33
ci_0035                 1.777446e-02 3 1  ON 34
ci_0036                 1.687199e-02 3 1  ON 35
ci_0037                -1.516266e-02 3 1  ON 36
ci_0038                -1.405459e-02 3 1  ON 37
ci_0039                -1.577828e-02 3 1  ON 38
ci_0040                -1.504183e-02 3 1  ON 39
ci_0041                 1.576791e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498816e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581861e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248111e-02 3 1  ON 48
ci_0050                -1.371533e-02 3 1  ON 49
ci_0051                -1.342734e-02 3 1  ON 50
ci_0052                -1.273338e-02 3 1  ON 51
ci_0053                -1.284803e-02 3 1  ON 52
ci_0054                -1.222850e-02 3 1  ON 53
ci_0055                 1.247285e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316753e-02 3 1  ON 56
ci_0058                 1.240589e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272750e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293577e-02 3 1  ON 61
ci_0063                -1.193473e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136310e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109582e-02 3 1  ON 66
ci_0068                -1.078648e-02 3 1  ON 67
ci_0069                 1.072375e-02 3 1  ON 68
ci_0070                 1.009529e-02 3 1  ON 69
ci_0071                 9.961798e-03 3 1  ON 70
ci_0072                 9.555938e-03 3 1  ON 71
ci_0073                 1.150213e-02 3 1  ON 72
ci_0074                 1.054418e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0179e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6708e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8898
    reference variance = 2.11461
====================================================
  Execution time = 1.3010e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0258e+04
  VMC Eavg = -1.6721e+01
  VMC Evar = 2.4647e+00
  Total weights = 1.945605248e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1594e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.492023899193
                                         uncertainty =       0.022276819744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.492023899193
                                         uncertainty =       0.022276819744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001116267482
  error estimate for blocks of size 2^( 2) =       0.001154025182
  error estimate for blocks of size 2^( 3) =       0.001186725452
  error estimate for blocks of size 2^( 4) =       0.001209638218
  error estimate for blocks of size 2^( 5) =       0.001223545939
  error estimate for blocks of size 2^( 6) =       0.001233025988
  error estimate for blocks of size 2^( 7) =       0.001234475600

      target function =                  N/A
              le_mean =     -16.720519028820
             les_mean =     282.040413645581
             stat err =       0.001225171436
             autocorr =       1.204639719677
              std dev =       1.578665870999
             le_variance =       2.492185932257


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.672051902882e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720519027892       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720519028082       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720519028084       residual = 3.83e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+04 is 4.423393e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720519027892       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720519027940       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720519027940       residual = 3.83e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+05 is 1.105851e-09

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720519027892       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720519027904       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720519027904       residual = 3.83e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+06 is 2.764630e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.372055 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6176e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800157e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394249e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116045e-02 3 1  ON 7
ci_0009                -3.231972e-02 3 1  ON 8
ci_0010                -3.067539e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668125e-02 3 1  ON 11
ci_0013                 2.685615e-02 3 1  ON 12
ci_0014                 2.692506e-02 3 1  ON 13
ci_0015                 2.740091e-02 3 1  ON 14
ci_0016                 2.631661e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343352e-02 3 1  ON 17
ci_0019                 2.053744e-02 3 1  ON 18
ci_0020                 1.958637e-02 3 1  ON 19
ci_0021                 1.858920e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925839e-02 3 1  ON 22
ci_0024                -1.769718e-02 3 1  ON 23
ci_0025                -1.834630e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587537e-02 3 1  ON 33
ci_0035                 1.777446e-02 3 1  ON 34
ci_0036                 1.687199e-02 3 1  ON 35
ci_0037                -1.516266e-02 3 1  ON 36
ci_0038                -1.405459e-02 3 1  ON 37
ci_0039                -1.577828e-02 3 1  ON 38
ci_0040                -1.504183e-02 3 1  ON 39
ci_0041                 1.576791e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498816e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581861e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248111e-02 3 1  ON 48
ci_0050                -1.371533e-02 3 1  ON 49
ci_0051                -1.342734e-02 3 1  ON 50
ci_0052                -1.273338e-02 3 1  ON 51
ci_0053                -1.284803e-02 3 1  ON 52
ci_0054                -1.222850e-02 3 1  ON 53
ci_0055                 1.247285e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316754e-02 3 1  ON 56
ci_0058                 1.240589e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272750e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293577e-02 3 1  ON 61
ci_0063                -1.193473e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136310e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109582e-02 3 1  ON 66
ci_0068                -1.078648e-02 3 1  ON 67
ci_0069                 1.072375e-02 3 1  ON 68
ci_0070                 1.009529e-02 3 1  ON 69
ci_0071                 9.961798e-03 3 1  ON 70
ci_0072                 9.555937e-03 3 1  ON 71
ci_0073                 1.150213e-02 3 1  ON 72
ci_0074                 1.054418e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.4078
    reference variance = 9.58714
====================================================
  Execution time = 1.2769e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5726e+00
  Total weights = 1.9457e+06
  Execution time = 2.1897e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.601935274835
                                         uncertainty =       0.054022079008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.601935274835
                                         uncertainty =       0.054022079008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140345385
  error estimate for blocks of size 2^( 2) =       0.001178194755
  error estimate for blocks of size 2^( 3) =       0.001212013647
  error estimate for blocks of size 2^( 4) =       0.001234816684
  error estimate for blocks of size 2^( 5) =       0.001248457839
  error estimate for blocks of size 2^( 6) =       0.001256081041
  error estimate for blocks of size 2^( 7) =       0.001262594596

      target function =                  N/A
              le_mean =     -16.716609328921
             les_mean =     282.017641238372
             stat err =       0.001250487540
             autocorr =       1.202502308977
              std dev =       1.612717711655
             le_variance =       2.600858417486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.601935273800
                                         uncertainty =       0.054022078972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.601935273800
                                         uncertainty =       0.054022078972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140345384
  error estimate for blocks of size 2^( 2) =       0.001178194755
  error estimate for blocks of size 2^( 3) =       0.001212013647
  error estimate for blocks of size 2^( 4) =       0.001234816684
  error estimate for blocks of size 2^( 5) =       0.001248457839
  error estimate for blocks of size 2^( 6) =       0.001256081041
  error estimate for blocks of size 2^( 7) =       0.001262594596

      target function =                  N/A
              le_mean =     -16.716609328946
             les_mean =     282.017641236583
             stat err =       0.001250487540
             autocorr =       1.202502309240
              std dev =       1.612717711329
             le_variance =       2.600858416434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.601935274317
                                         uncertainty =       0.054022078990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.601935274317
                                         uncertainty =       0.054022078990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140345385
  error estimate for blocks of size 2^( 2) =       0.001178194755
  error estimate for blocks of size 2^( 3) =       0.001212013647
  error estimate for blocks of size 2^( 4) =       0.001234816684
  error estimate for blocks of size 2^( 5) =       0.001248457839
  error estimate for blocks of size 2^( 6) =       0.001256081041
  error estimate for blocks of size 2^( 7) =       0.001262594596

      target function =                  N/A
              le_mean =     -16.716609328934
             les_mean =     282.017641237474
             stat err =       0.001250487540
             autocorr =       1.202502309108
              std dev =       1.612717711492
             le_variance =       2.600858416960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.601935274770
                                         uncertainty =       0.054022079005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.601935274770
                                         uncertainty =       0.054022079005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140345385
  error estimate for blocks of size 2^( 2) =       0.001178194755
  error estimate for blocks of size 2^( 3) =       0.001212013647
  error estimate for blocks of size 2^( 4) =       0.001234816684
  error estimate for blocks of size 2^( 5) =       0.001248457839
  error estimate for blocks of size 2^( 6) =       0.001256081041
  error estimate for blocks of size 2^( 7) =       0.001262594596

      target function =                  N/A
              le_mean =     -16.716609328922
             les_mean =     282.017641238260
             stat err =       0.001250487540
             autocorr =       1.202502308994
              std dev =       1.612717711635
             le_variance =       2.600858417421


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716609328921        initial
     9.0949e+04     9.0949e+05             4.4234e-09       -16.716609328946  <--
     3.6380e+05     3.6380e+06             1.1059e-09       -16.716609328934
     1.4552e+06     1.4552e+07             2.7646e-10       -16.716609328922

*****************************************************************************
Applying the update for shift_i =   9.0949e+04     and shift_s =   9.0949e+05
*****************************************************************************

  Execution time = 2.3858e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800157e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394249e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116045e-02 3 1  ON 7
ci_0009                -3.231972e-02 3 1  ON 8
ci_0010                -3.067539e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668125e-02 3 1  ON 11
ci_0013                 2.685615e-02 3 1  ON 12
ci_0014                 2.692506e-02 3 1  ON 13
ci_0015                 2.740092e-02 3 1  ON 14
ci_0016                 2.631661e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343352e-02 3 1  ON 17
ci_0019                 2.053744e-02 3 1  ON 18
ci_0020                 1.958637e-02 3 1  ON 19
ci_0021                 1.858920e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925838e-02 3 1  ON 22
ci_0024                -1.769718e-02 3 1  ON 23
ci_0025                -1.834630e-02 3 1  ON 24
ci_0026                -1.756797e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613007e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587537e-02 3 1  ON 33
ci_0035                 1.777446e-02 3 1  ON 34
ci_0036                 1.687199e-02 3 1  ON 35
ci_0037                -1.516266e-02 3 1  ON 36
ci_0038                -1.405459e-02 3 1  ON 37
ci_0039                -1.577828e-02 3 1  ON 38
ci_0040                -1.504183e-02 3 1  ON 39
ci_0041                 1.576791e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498816e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418164e-02 3 1  ON 47
ci_0049                -1.248111e-02 3 1  ON 48
ci_0050                -1.371533e-02 3 1  ON 49
ci_0051                -1.342734e-02 3 1  ON 50
ci_0052                -1.273338e-02 3 1  ON 51
ci_0053                -1.284803e-02 3 1  ON 52
ci_0054                -1.222850e-02 3 1  ON 53
ci_0055                 1.247285e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316754e-02 3 1  ON 56
ci_0058                 1.240589e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272750e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293577e-02 3 1  ON 61
ci_0063                -1.193473e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136310e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109582e-02 3 1  ON 66
ci_0068                -1.078648e-02 3 1  ON 67
ci_0069                 1.072375e-02 3 1  ON 68
ci_0070                 1.009529e-02 3 1  ON 69
ci_0071                 9.961797e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150213e-02 3 1  ON 72
ci_0074                 1.054418e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0041e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6707e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.7719
    reference variance = 1.43332
====================================================
  Execution time = 1.5445e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0191e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5142e+00
  Total weights = 1.945590219e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1968e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535805435850
                                         uncertainty =       0.022521537147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535805435850
                                         uncertainty =       0.022521537147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125966577
  error estimate for blocks of size 2^( 2) =       0.001164673784
  error estimate for blocks of size 2^( 3) =       0.001197216014
  error estimate for blocks of size 2^( 4) =       0.001218424818
  error estimate for blocks of size 2^( 5) =       0.001230540223
  error estimate for blocks of size 2^( 6) =       0.001238410843
  error estimate for blocks of size 2^( 7) =       0.001244822139

      target function =                  N/A
              le_mean =     -16.718989758817
             les_mean =     282.038790444474
             stat err =       0.001233049506
             autocorr =       1.199250831797
              std dev =       1.592382681496
             le_variance =       2.535682604330


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671898975882e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718989757872       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718989758116       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718989758133       residual = 6.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+04 is 2.479163e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718989757872       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718989757933       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718989757937       residual = 6.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+04 is 6.197961e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718989757872       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718989757887       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718989757888       residual = 6.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+05 is 1.549494e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.373239 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8649e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800157e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394249e-02 3 1  ON 5
ci_0007                -3.091333e-02 3 1  ON 6
ci_0008                -3.116045e-02 3 1  ON 7
ci_0009                -3.231972e-02 3 1  ON 8
ci_0010                -3.067539e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668125e-02 3 1  ON 11
ci_0013                 2.685615e-02 3 1  ON 12
ci_0014                 2.692506e-02 3 1  ON 13
ci_0015                 2.740092e-02 3 1  ON 14
ci_0016                 2.631661e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343352e-02 3 1  ON 17
ci_0019                 2.053743e-02 3 1  ON 18
ci_0020                 1.958637e-02 3 1  ON 19
ci_0021                 1.858920e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925838e-02 3 1  ON 22
ci_0024                -1.769718e-02 3 1  ON 23
ci_0025                -1.834630e-02 3 1  ON 24
ci_0026                -1.756797e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613007e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587537e-02 3 1  ON 33
ci_0035                 1.777446e-02 3 1  ON 34
ci_0036                 1.687200e-02 3 1  ON 35
ci_0037                -1.516266e-02 3 1  ON 36
ci_0038                -1.405459e-02 3 1  ON 37
ci_0039                -1.577828e-02 3 1  ON 38
ci_0040                -1.504183e-02 3 1  ON 39
ci_0041                 1.576791e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498816e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581861e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248111e-02 3 1  ON 48
ci_0050                -1.371533e-02 3 1  ON 49
ci_0051                -1.342733e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284803e-02 3 1  ON 52
ci_0054                -1.222850e-02 3 1  ON 53
ci_0055                 1.247285e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316754e-02 3 1  ON 56
ci_0058                 1.240589e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272750e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293577e-02 3 1  ON 61
ci_0063                -1.193472e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136311e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109582e-02 3 1  ON 66
ci_0068                -1.078648e-02 3 1  ON 67
ci_0069                 1.072374e-02 3 1  ON 68
ci_0070                 1.009529e-02 3 1  ON 69
ci_0071                 9.961797e-03 3 1  ON 70
ci_0072                 9.555937e-03 3 1  ON 71
ci_0073                 1.150213e-02 3 1  ON 72
ci_0074                 1.054418e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.7746
    reference variance = 2.02271
====================================================
  Execution time = 1.2736e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6721e+01
  VMC Evar = 2.5194e+00
  Total weights = 1.9457e+06
  Execution time = 2.2264e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547500905517
                                         uncertainty =       0.034945446086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547500905517
                                         uncertainty =       0.034945446086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128401648
  error estimate for blocks of size 2^( 2) =       0.001167676120
  error estimate for blocks of size 2^( 3) =       0.001201079029
  error estimate for blocks of size 2^( 4) =       0.001222455255
  error estimate for blocks of size 2^( 5) =       0.001237152500
  error estimate for blocks of size 2^( 6) =       0.001241512651
  error estimate for blocks of size 2^( 7) =       0.001250665563

      target function =                  N/A
              le_mean =     -16.721038252382
             les_mean =     282.112519396469
             stat err =       0.001237946492
             autocorr =       1.203583771759
              std dev =       1.595826447407
             le_variance =       2.546662050242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547500909502
                                         uncertainty =       0.034945445504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547500909502
                                         uncertainty =       0.034945445504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128401649
  error estimate for blocks of size 2^( 2) =       0.001167676120
  error estimate for blocks of size 2^( 3) =       0.001201079030
  error estimate for blocks of size 2^( 4) =       0.001222455255
  error estimate for blocks of size 2^( 5) =       0.001237152500
  error estimate for blocks of size 2^( 6) =       0.001241512651
  error estimate for blocks of size 2^( 7) =       0.001250665563

      target function =                  N/A
              le_mean =     -16.721038252413
             les_mean =     282.112519453415
             stat err =       0.001237946492
             autocorr =       1.203583769726
              std dev =       1.595826448654
             le_variance =       2.546662054222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547500907509
                                         uncertainty =       0.034945445795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547500907509
                                         uncertainty =       0.034945445795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128401649
  error estimate for blocks of size 2^( 2) =       0.001167676120
  error estimate for blocks of size 2^( 3) =       0.001201079030
  error estimate for blocks of size 2^( 4) =       0.001222455255
  error estimate for blocks of size 2^( 5) =       0.001237152500
  error estimate for blocks of size 2^( 6) =       0.001241512651
  error estimate for blocks of size 2^( 7) =       0.001250665563

      target function =                  N/A
              le_mean =     -16.721038252398
             les_mean =     282.112519424933
             stat err =       0.001237946492
             autocorr =       1.203583770743
              std dev =       1.595826448030
             le_variance =       2.546662052232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547500905766
                                         uncertainty =       0.034945446050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547500905766
                                         uncertainty =       0.034945446050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128401648
  error estimate for blocks of size 2^( 2) =       0.001167676120
  error estimate for blocks of size 2^( 3) =       0.001201079029
  error estimate for blocks of size 2^( 4) =       0.001222455255
  error estimate for blocks of size 2^( 5) =       0.001237152500
  error estimate for blocks of size 2^( 6) =       0.001241512651
  error estimate for blocks of size 2^( 7) =       0.001250665563

      target function =                  N/A
              le_mean =     -16.721038252384
             les_mean =     282.112519400026
             stat err =       0.001237946492
             autocorr =       1.203583771632
              std dev =       1.595826447484
             le_variance =       2.546662050491


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.721038252382        initial
     2.2737e+04     2.2737e+05             2.4792e-08       -16.721038252413  <--
     9.0949e+04     9.0949e+05             6.1980e-09       -16.721038252398
     3.6380e+05     3.6380e+06             1.5495e-09       -16.721038252384

*****************************************************************************
Applying the update for shift_i =   2.2737e+04     and shift_s =   2.2737e+05
*****************************************************************************

  Execution time = 2.3951e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800158e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566019e-02 3 1  ON 4
ci_0006                -4.394248e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116045e-02 3 1  ON 7
ci_0009                -3.231971e-02 3 1  ON 8
ci_0010                -3.067539e-02 3 1  ON 9
ci_0011                -2.797645e-02 3 1  ON 10
ci_0012                -2.668125e-02 3 1  ON 11
ci_0013                 2.685616e-02 3 1  ON 12
ci_0014                 2.692505e-02 3 1  ON 13
ci_0015                 2.740092e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381452e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053743e-02 3 1  ON 18
ci_0020                 1.958637e-02 3 1  ON 19
ci_0021                 1.858920e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925838e-02 3 1  ON 22
ci_0024                -1.769719e-02 3 1  ON 23
ci_0025                -1.834631e-02 3 1  ON 24
ci_0026                -1.756797e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696873e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613007e-02 3 1  ON 29
ci_0031                 1.557324e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587538e-02 3 1  ON 33
ci_0035                 1.777446e-02 3 1  ON 34
ci_0036                 1.687201e-02 3 1  ON 35
ci_0037                -1.516266e-02 3 1  ON 36
ci_0038                -1.405460e-02 3 1  ON 37
ci_0039                -1.577828e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576791e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498817e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581861e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248110e-02 3 1  ON 48
ci_0050                -1.371532e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284801e-02 3 1  ON 52
ci_0054                -1.222851e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316754e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297557e-02 3 1  ON 58
ci_0060                -1.272751e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293577e-02 3 1  ON 61
ci_0063                -1.193472e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136312e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109582e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072374e-02 3 1  ON 68
ci_0070                 1.009530e-02 3 1  ON 69
ci_0071                 9.961797e-03 3 1  ON 70
ci_0072                 9.555945e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054419e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2606e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6708e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.8301
    reference variance = 1.06507
====================================================
  Execution time = 1.3085e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0238e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5019e+00
  Total weights = 1.945491871e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1930e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531732738923
                                         uncertainty =       0.022380525277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531732738923
                                         uncertainty =       0.022380525277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125005730
  error estimate for blocks of size 2^( 2) =       0.001162958801
  error estimate for blocks of size 2^( 3) =       0.001195858978
  error estimate for blocks of size 2^( 4) =       0.001219099278
  error estimate for blocks of size 2^( 5) =       0.001230590367
  error estimate for blocks of size 2^( 6) =       0.001236913256
  error estimate for blocks of size 2^( 7) =       0.001235417494

      target function =                  N/A
              le_mean =     -16.718376255371
             les_mean =     282.006025503914
             stat err =       0.001230505099
             autocorr =       1.196347555656
              std dev =       1.591023816464
             le_variance =       2.531356784555


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671837625537e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718376254448       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718376256355       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718376256330       residual = 1.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+03 is 5.894872e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718376254448       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718376254925       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718376254918       residual = 1.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+04 is 1.473782e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718376254448       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718376254567       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718376254565       residual = 1.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+04 is 3.684495e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.374370 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6284e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800159e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116045e-02 3 1  ON 7
ci_0009                -3.231972e-02 3 1  ON 8
ci_0010                -3.067538e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668124e-02 3 1  ON 11
ci_0013                 2.685616e-02 3 1  ON 12
ci_0014                 2.692505e-02 3 1  ON 13
ci_0015                 2.740093e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381454e-02 3 1  ON 16
ci_0018                 2.343354e-02 3 1  ON 17
ci_0019                 2.053743e-02 3 1  ON 18
ci_0020                 1.958636e-02 3 1  ON 19
ci_0021                 1.858921e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925838e-02 3 1  ON 22
ci_0024                -1.769719e-02 3 1  ON 23
ci_0025                -1.834631e-02 3 1  ON 24
ci_0026                -1.756799e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560835e-02 3 1  ON 28
ci_0030                -1.613006e-02 3 1  ON 29
ci_0031                 1.557324e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587538e-02 3 1  ON 33
ci_0035                 1.777446e-02 3 1  ON 34
ci_0036                 1.687200e-02 3 1  ON 35
ci_0037                -1.516266e-02 3 1  ON 36
ci_0038                -1.405459e-02 3 1  ON 37
ci_0039                -1.577828e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576792e-02 3 1  ON 40
ci_0042                 1.567762e-02 3 1  ON 41
ci_0043                -1.498817e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581861e-02 3 1  ON 45
ci_0047                -1.454539e-02 3 1  ON 46
ci_0048                -1.418164e-02 3 1  ON 47
ci_0049                -1.248111e-02 3 1  ON 48
ci_0050                -1.371531e-02 3 1  ON 49
ci_0051                -1.342733e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284803e-02 3 1  ON 52
ci_0054                -1.222850e-02 3 1  ON 53
ci_0055                 1.247285e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316754e-02 3 1  ON 56
ci_0058                 1.240590e-02 3 1  ON 57
ci_0059                -1.297558e-02 3 1  ON 58
ci_0060                -1.272751e-02 3 1  ON 59
ci_0061                -1.265489e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193472e-02 3 1  ON 62
ci_0064                -1.123059e-02 3 1  ON 63
ci_0065                -1.136312e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109582e-02 3 1  ON 66
ci_0068                -1.078645e-02 3 1  ON 67
ci_0069                 1.072375e-02 3 1  ON 68
ci_0070                 1.009531e-02 3 1  ON 69
ci_0071                 9.961795e-03 3 1  ON 70
ci_0072                 9.555947e-03 3 1  ON 71
ci_0073                 1.150213e-02 3 1  ON 72
ci_0074                 1.054419e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.8835
    reference variance = 3.346
====================================================
  Execution time = 1.2757e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5082e+00
  Total weights = 1.9457e+06
  Execution time = 2.2286e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535220027207
                                         uncertainty =       0.025628885467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535220027207
                                         uncertainty =       0.025628885467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125830862
  error estimate for blocks of size 2^( 2) =       0.001165467140
  error estimate for blocks of size 2^( 3) =       0.001198039023
  error estimate for blocks of size 2^( 4) =       0.001220130984
  error estimate for blocks of size 2^( 5) =       0.001229305341
  error estimate for blocks of size 2^( 6) =       0.001240716226
  error estimate for blocks of size 2^( 7) =       0.001244670435

      target function =                  N/A
              le_mean =     -16.718231396918
             les_mean =     282.007484106039
             stat err =       0.001233705746
             autocorr =       1.200817133985
              std dev =       1.592190748291
             le_variance =       2.535071378944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535220055769
                                         uncertainty =       0.025628885940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535220055769
                                         uncertainty =       0.025628885940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125830868
  error estimate for blocks of size 2^( 2) =       0.001165467143
  error estimate for blocks of size 2^( 3) =       0.001198039024
  error estimate for blocks of size 2^( 4) =       0.001220130985
  error estimate for blocks of size 2^( 5) =       0.001229305340
  error estimate for blocks of size 2^( 6) =       0.001240716228
  error estimate for blocks of size 2^( 7) =       0.001244670438

      target function =                  N/A
              le_mean =     -16.718231396290
             les_mean =     282.007484138796
             stat err =       0.001233705748
             autocorr =       1.200817122578
              std dev =       1.592190757281
             le_variance =       2.535071407571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535220041488
                                         uncertainty =       0.025628885704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535220041488
                                         uncertainty =       0.025628885704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125830865
  error estimate for blocks of size 2^( 2) =       0.001165467141
  error estimate for blocks of size 2^( 3) =       0.001198039024
  error estimate for blocks of size 2^( 4) =       0.001220130984
  error estimate for blocks of size 2^( 5) =       0.001229305341
  error estimate for blocks of size 2^( 6) =       0.001240716227
  error estimate for blocks of size 2^( 7) =       0.001244670436

      target function =                  N/A
              le_mean =     -16.718231396604
             les_mean =     282.007484122405
             stat err =       0.001233705747
             autocorr =       1.200817128281
              std dev =       1.592190752786
             le_variance =       2.535071393258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535220028992
                                         uncertainty =       0.025628885497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535220028992
                                         uncertainty =       0.025628885497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125830862
  error estimate for blocks of size 2^( 2) =       0.001165467140
  error estimate for blocks of size 2^( 3) =       0.001198039023
  error estimate for blocks of size 2^( 4) =       0.001220130984
  error estimate for blocks of size 2^( 5) =       0.001229305341
  error estimate for blocks of size 2^( 6) =       0.001240716226
  error estimate for blocks of size 2^( 7) =       0.001244670435

      target function =                  N/A
              le_mean =     -16.718231396879
             les_mean =     282.007484108083
             stat err =       0.001233705747
             autocorr =       1.200817133272
              std dev =       1.592190748853
             le_variance =       2.535071380734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718231396918        initial  <--
     5.6843e+03     5.6843e+04             5.8949e-08       -16.718231396290
     2.2737e+04     2.2737e+05             1.4738e-08       -16.718231396604
     9.0949e+04     9.0949e+05             3.6845e-09       -16.718231396879

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9702
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800158e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566019e-02 3 1  ON 4
ci_0006                -4.394248e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116045e-02 3 1  ON 7
ci_0009                -3.231971e-02 3 1  ON 8
ci_0010                -3.067539e-02 3 1  ON 9
ci_0011                -2.797645e-02 3 1  ON 10
ci_0012                -2.668125e-02 3 1  ON 11
ci_0013                 2.685616e-02 3 1  ON 12
ci_0014                 2.692505e-02 3 1  ON 13
ci_0015                 2.740092e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381452e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053743e-02 3 1  ON 18
ci_0020                 1.958637e-02 3 1  ON 19
ci_0021                 1.858920e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925838e-02 3 1  ON 22
ci_0024                -1.769719e-02 3 1  ON 23
ci_0025                -1.834631e-02 3 1  ON 24
ci_0026                -1.756797e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696873e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613007e-02 3 1  ON 29
ci_0031                 1.557324e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587538e-02 3 1  ON 33
ci_0035                 1.777446e-02 3 1  ON 34
ci_0036                 1.687201e-02 3 1  ON 35
ci_0037                -1.516266e-02 3 1  ON 36
ci_0038                -1.405460e-02 3 1  ON 37
ci_0039                -1.577828e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576791e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498817e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581861e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248110e-02 3 1  ON 48
ci_0050                -1.371532e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284801e-02 3 1  ON 52
ci_0054                -1.222851e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316754e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297557e-02 3 1  ON 58
ci_0060                -1.272751e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293577e-02 3 1  ON 61
ci_0063                -1.193472e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136312e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109582e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072374e-02 3 1  ON 68
ci_0070                 1.009530e-02 3 1  ON 69
ci_0071                 9.961797e-03 3 1  ON 70
ci_0072                 9.555945e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054419e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0260e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6712e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.6624
    reference variance = 1.21572
====================================================
  Execution time = 1.3064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0287e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5412e+00
  Total weights = 1.945728875e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1829e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568558664635
                                         uncertainty =       0.042054341341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568558664635
                                         uncertainty =       0.042054341341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133474496
  error estimate for blocks of size 2^( 2) =       0.001172308664
  error estimate for blocks of size 2^( 3) =       0.001205135947
  error estimate for blocks of size 2^( 4) =       0.001227483880
  error estimate for blocks of size 2^( 5) =       0.001242019619
  error estimate for blocks of size 2^( 6) =       0.001254059528
  error estimate for blocks of size 2^( 7) =       0.001255966185

      target function =                  N/A
              le_mean =     -16.718100946142
             les_mean =     282.036148347026
             stat err =       0.001244882303
             autocorr =       1.206238208427
              std dev =       1.603000652748
             le_variance =       2.569611092711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671810094614e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718100945216       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718100945530       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718100945527       residual = 1.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+04 is 7.784348e-09

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718100945216       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718100945294       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718100945294       residual = 1.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+05 is 1.946093e-09

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718100945216       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718100945236       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718100945235       residual = 1.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+05 is 4.865236e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.375564 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6254e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800158e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566019e-02 3 1  ON 4
ci_0006                -4.394248e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116045e-02 3 1  ON 7
ci_0009                -3.231971e-02 3 1  ON 8
ci_0010                -3.067539e-02 3 1  ON 9
ci_0011                -2.797645e-02 3 1  ON 10
ci_0012                -2.668125e-02 3 1  ON 11
ci_0013                 2.685616e-02 3 1  ON 12
ci_0014                 2.692505e-02 3 1  ON 13
ci_0015                 2.740092e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381452e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053743e-02 3 1  ON 18
ci_0020                 1.958637e-02 3 1  ON 19
ci_0021                 1.858920e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925838e-02 3 1  ON 22
ci_0024                -1.769719e-02 3 1  ON 23
ci_0025                -1.834631e-02 3 1  ON 24
ci_0026                -1.756797e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696873e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613007e-02 3 1  ON 29
ci_0031                 1.557324e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587538e-02 3 1  ON 33
ci_0035                 1.777446e-02 3 1  ON 34
ci_0036                 1.687201e-02 3 1  ON 35
ci_0037                -1.516266e-02 3 1  ON 36
ci_0038                -1.405460e-02 3 1  ON 37
ci_0039                -1.577828e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576792e-02 3 1  ON 40
ci_0042                 1.567762e-02 3 1  ON 41
ci_0043                -1.498817e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581861e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248110e-02 3 1  ON 48
ci_0050                -1.371532e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284801e-02 3 1  ON 52
ci_0054                -1.222851e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316754e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297557e-02 3 1  ON 58
ci_0060                -1.272751e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293577e-02 3 1  ON 61
ci_0063                -1.193472e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136312e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109582e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072374e-02 3 1  ON 68
ci_0070                 1.009530e-02 3 1  ON 69
ci_0071                 9.961797e-03 3 1  ON 70
ci_0072                 9.555946e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054419e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.6734
    reference variance = 1.43369
====================================================
  Execution time = 1.2802e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5715e+00
  Total weights = 1.9456e+06
  Execution time = 2.2314e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.602922101304
                                         uncertainty =       0.035837800951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.602922101304
                                         uncertainty =       0.035837800951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140851055
  error estimate for blocks of size 2^( 2) =       0.001178860627
  error estimate for blocks of size 2^( 3) =       0.001209928269
  error estimate for blocks of size 2^( 4) =       0.001231847520
  error estimate for blocks of size 2^( 5) =       0.001244381900
  error estimate for blocks of size 2^( 6) =       0.001253209454
  error estimate for blocks of size 2^( 7) =       0.001251662375

      target function =                  N/A
              le_mean =     -16.717700920926
             les_mean =     282.053041378392
             stat err =       0.001245275312
             autocorr =       1.191441874399
              std dev =       1.613432848802
             le_variance =       2.603165557594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.602922106744
                                         uncertainty =       0.035837800963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.602922106744
                                         uncertainty =       0.035837800963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140851056
  error estimate for blocks of size 2^( 2) =       0.001178860628
  error estimate for blocks of size 2^( 3) =       0.001209928270
  error estimate for blocks of size 2^( 4) =       0.001231847521
  error estimate for blocks of size 2^( 5) =       0.001244381901
  error estimate for blocks of size 2^( 6) =       0.001253209454
  error estimate for blocks of size 2^( 7) =       0.001251662375

      target function =                  N/A
              le_mean =     -16.717700920940
             les_mean =     282.053041803442
             stat err =       0.001245275313
             autocorr =       1.191441872994
              std dev =       1.613432850523
             le_variance =       2.603165563147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.602922104024
                                         uncertainty =       0.035837800957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.602922104024
                                         uncertainty =       0.035837800957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140851056
  error estimate for blocks of size 2^( 2) =       0.001178860627
  error estimate for blocks of size 2^( 3) =       0.001209928270
  error estimate for blocks of size 2^( 4) =       0.001231847520
  error estimate for blocks of size 2^( 5) =       0.001244381901
  error estimate for blocks of size 2^( 6) =       0.001253209454
  error estimate for blocks of size 2^( 7) =       0.001251662375

      target function =                  N/A
              le_mean =     -16.717700920933
             les_mean =     282.053041587789
             stat err =       0.001245275312
             autocorr =       1.191441873697
              std dev =       1.613432849663
             le_variance =       2.603165560371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.602922101644
                                         uncertainty =       0.035837800951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.602922101644
                                         uncertainty =       0.035837800951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140851055
  error estimate for blocks of size 2^( 2) =       0.001178860627
  error estimate for blocks of size 2^( 3) =       0.001209928269
  error estimate for blocks of size 2^( 4) =       0.001231847520
  error estimate for blocks of size 2^( 5) =       0.001244381900
  error estimate for blocks of size 2^( 6) =       0.001253209454
  error estimate for blocks of size 2^( 7) =       0.001251662375

      target function =                  N/A
              le_mean =     -16.717700920927
             les_mean =     282.053041404233
             stat err =       0.001245275312
             autocorr =       1.191441874312
              std dev =       1.613432848910
             le_variance =       2.603165557941


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717700920926        initial
     5.6843e+04     5.6843e+05             7.7843e-09       -16.717700920940  <--
     2.2737e+05     2.2737e+06             1.9461e-09       -16.717700920933
     9.0949e+05     9.0949e+06             4.8652e-10       -16.717700920927

*****************************************************************************
Applying the update for shift_i =   5.6843e+04     and shift_s =   5.6843e+05
*****************************************************************************

  Execution time = 2.4024e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800158e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394248e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116045e-02 3 1  ON 7
ci_0009                -3.231971e-02 3 1  ON 8
ci_0010                -3.067540e-02 3 1  ON 9
ci_0011                -2.797645e-02 3 1  ON 10
ci_0012                -2.668125e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692505e-02 3 1  ON 13
ci_0015                 2.740091e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381452e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958636e-02 3 1  ON 19
ci_0021                 1.858920e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925838e-02 3 1  ON 22
ci_0024                -1.769719e-02 3 1  ON 23
ci_0025                -1.834631e-02 3 1  ON 24
ci_0026                -1.756797e-02 3 1  ON 25
ci_0027                -1.738488e-02 3 1  ON 26
ci_0028                -1.696873e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613007e-02 3 1  ON 29
ci_0031                 1.557324e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587538e-02 3 1  ON 33
ci_0035                 1.777446e-02 3 1  ON 34
ci_0036                 1.687201e-02 3 1  ON 35
ci_0037                -1.516266e-02 3 1  ON 36
ci_0038                -1.405460e-02 3 1  ON 37
ci_0039                -1.577827e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576792e-02 3 1  ON 40
ci_0042                 1.567762e-02 3 1  ON 41
ci_0043                -1.498817e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581861e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248110e-02 3 1  ON 48
ci_0050                -1.371532e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284802e-02 3 1  ON 52
ci_0054                -1.222851e-02 3 1  ON 53
ci_0055                 1.247285e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316754e-02 3 1  ON 56
ci_0058                 1.240589e-02 3 1  ON 57
ci_0059                -1.297557e-02 3 1  ON 58
ci_0060                -1.272751e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193471e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109582e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072375e-02 3 1  ON 68
ci_0070                 1.009531e-02 3 1  ON 69
ci_0071                 9.961796e-03 3 1  ON 70
ci_0072                 9.555947e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054419e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0284e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6711e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.6435
    reference variance = 2.85508
====================================================
  Execution time = 1.3043e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0250e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5337e+00
  Total weights = 1.945530250e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1759e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560320652270
                                         uncertainty =       0.025364670057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560320652270
                                         uncertainty =       0.025364670057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131449087
  error estimate for blocks of size 2^( 2) =       0.001170080595
  error estimate for blocks of size 2^( 3) =       0.001203895626
  error estimate for blocks of size 2^( 4) =       0.001228974859
  error estimate for blocks of size 2^( 5) =       0.001241835392
  error estimate for blocks of size 2^( 6) =       0.001253359130
  error estimate for blocks of size 2^( 7) =       0.001260768397

      target function =                  N/A
              le_mean =     -16.718158655480
             les_mean =     282.030537055558
             stat err =       0.001246234444
             autocorr =       1.213191805474
              std dev =       1.600136245651
             le_variance =       2.560436004645


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671815865548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+04, overlap shift 1.4211e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718158654566       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718158656166       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718158656162       residual = 1.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+04 is 3.243241e-08

solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718158654566       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718158654966       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718158654965       residual = 1.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+04 is 8.108264e-09

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718158654566       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718158654666       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718158654666       residual = 1.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+05 is 2.027076e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.376755 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6227e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800159e-02 3 1  ON 2
ci_0004                -4.638676e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394248e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116046e-02 3 1  ON 7
ci_0009                -3.231972e-02 3 1  ON 8
ci_0010                -3.067540e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668124e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692505e-02 3 1  ON 13
ci_0015                 2.740091e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381452e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958636e-02 3 1  ON 19
ci_0021                 1.858920e-02 3 1  ON 20
ci_0022                 1.802460e-02 3 1  ON 21
ci_0023                -1.925839e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834631e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696873e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613007e-02 3 1  ON 29
ci_0031                 1.557324e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587538e-02 3 1  ON 33
ci_0035                 1.777446e-02 3 1  ON 34
ci_0036                 1.687201e-02 3 1  ON 35
ci_0037                -1.516266e-02 3 1  ON 36
ci_0038                -1.405460e-02 3 1  ON 37
ci_0039                -1.577827e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576792e-02 3 1  ON 40
ci_0042                 1.567762e-02 3 1  ON 41
ci_0043                -1.498817e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248111e-02 3 1  ON 48
ci_0050                -1.371531e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284802e-02 3 1  ON 52
ci_0054                -1.222851e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316754e-02 3 1  ON 56
ci_0058                 1.240589e-02 3 1  ON 57
ci_0059                -1.297557e-02 3 1  ON 58
ci_0060                -1.272751e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193471e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109582e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072375e-02 3 1  ON 68
ci_0070                 1.009531e-02 3 1  ON 69
ci_0071                 9.961794e-03 3 1  ON 70
ci_0072                 9.555943e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054420e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.6595
    reference variance = 2.19799
====================================================
  Execution time = 1.2780e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.4787e+00
  Total weights = 1.9460e+06
  Execution time = 2.2335e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506066363064
                                         uncertainty =       0.023307768519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506066363064
                                         uncertainty =       0.023307768519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119392288
  error estimate for blocks of size 2^( 2) =       0.001158239993
  error estimate for blocks of size 2^( 3) =       0.001192009379
  error estimate for blocks of size 2^( 4) =       0.001216207059
  error estimate for blocks of size 2^( 5) =       0.001229982197
  error estimate for blocks of size 2^( 6) =       0.001237228606
  error estimate for blocks of size 2^( 7) =       0.001240352092

      target function =                  N/A
              le_mean =     -16.718320721027
             les_mean =     281.980977332949
             stat err =       0.001230942488
             autocorr =       1.209235542501
              std dev =       1.583085084260
             le_variance =       2.506158384006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506066396715
                                         uncertainty =       0.023307768227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506066396715
                                         uncertainty =       0.023307768227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119392296
  error estimate for blocks of size 2^( 2) =       0.001158240000
  error estimate for blocks of size 2^( 3) =       0.001192009385
  error estimate for blocks of size 2^( 4) =       0.001216207064
  error estimate for blocks of size 2^( 5) =       0.001229982202
  error estimate for blocks of size 2^( 6) =       0.001237228610
  error estimate for blocks of size 2^( 7) =       0.001240352097

      target function =                  N/A
              le_mean =     -16.718320721097
             les_mean =     281.980976708759
             stat err =       0.001230942493
             autocorr =       1.209235536100
              std dev =       1.583085094881
             le_variance =       2.506158417634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506066379890
                                         uncertainty =       0.023307768373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506066379890
                                         uncertainty =       0.023307768373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119392292
  error estimate for blocks of size 2^( 2) =       0.001158239996
  error estimate for blocks of size 2^( 3) =       0.001192009382
  error estimate for blocks of size 2^( 4) =       0.001216207061
  error estimate for blocks of size 2^( 5) =       0.001229982199
  error estimate for blocks of size 2^( 6) =       0.001237228608
  error estimate for blocks of size 2^( 7) =       0.001240352094

      target function =                  N/A
              le_mean =     -16.718320721062
             les_mean =     281.980977000374
             stat err =       0.001230942491
             autocorr =       1.209235539299
              std dev =       1.583085089570
             le_variance =       2.506158400820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506066365167
                                         uncertainty =       0.023307768501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506066365167
                                         uncertainty =       0.023307768501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119392289
  error estimate for blocks of size 2^( 2) =       0.001158239994
  error estimate for blocks of size 2^( 3) =       0.001192009380
  error estimate for blocks of size 2^( 4) =       0.001216207059
  error estimate for blocks of size 2^( 5) =       0.001229982197
  error estimate for blocks of size 2^( 6) =       0.001237228606
  error estimate for blocks of size 2^( 7) =       0.001240352092

      target function =                  N/A
              le_mean =     -16.718320721031
             les_mean =     281.980977288910
             stat err =       0.001230942489
             autocorr =       1.209235542101
              std dev =       1.583085084924
             le_variance =       2.506158386107


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718320721027        initial
     1.4211e+04     1.4211e+05             3.2432e-08       -16.718320721097  <--
     5.6843e+04     5.6843e+05             8.1083e-09       -16.718320721062
     2.2737e+05     2.2737e+06             2.0271e-09       -16.718320721031

*****************************************************************************
Applying the update for shift_i =   1.4211e+04     and shift_s =   1.4211e+05
*****************************************************************************

  Execution time = 2.4017e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405461e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0250e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6710e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.8719
    reference variance = 1.3498
====================================================
  Execution time = 1.3078e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0246e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5925e+00
  Total weights = 1.946122369e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1706e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621441357275
                                         uncertainty =       0.036959656614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621441357275
                                         uncertainty =       0.036959656614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001145110391
  error estimate for blocks of size 2^( 2) =       0.001184277497
  error estimate for blocks of size 2^( 3) =       0.001218892952
  error estimate for blocks of size 2^( 4) =       0.001243431480
  error estimate for blocks of size 2^( 5) =       0.001256903382
  error estimate for blocks of size 2^( 6) =       0.001263635463
  error estimate for blocks of size 2^( 7) =       0.001270866403

      target function =                  N/A
              le_mean =     -16.717141826505
             les_mean =     282.055286104275
             stat err =       0.001258709182
             autocorr =       1.208248011949
              std dev =       1.619456556225
             le_variance =       2.622639537499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671714182650e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+03, overlap shift 3.5527e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717141825654       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717141828510       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717141828362       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717141828355       residual = 1.22e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+03 is 1.395404e-07

solving harmonic davidson linear method for identity shift 1.4211e+04, overlap shift 1.4211e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717141825654       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717141826368       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717141826331       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717141826329       residual = 1.22e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+04 is 3.488681e-08

solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717141825654       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717141825833       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717141825824       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717141825786       residual = 1.22e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+04 is 8.721808e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.378213 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6255e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800161e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394246e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116050e-02 3 1  ON 7
ci_0009                -3.231972e-02 3 1  ON 8
ci_0010                -3.067543e-02 3 1  ON 9
ci_0011                -2.797642e-02 3 1  ON 10
ci_0012                -2.668119e-02 3 1  ON 11
ci_0013                 2.685620e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631661e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343356e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958634e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925839e-02 3 1  ON 22
ci_0024                -1.769721e-02 3 1  ON 23
ci_0025                -1.834633e-02 3 1  ON 24
ci_0026                -1.756797e-02 3 1  ON 25
ci_0027                -1.738489e-02 3 1  ON 26
ci_0028                -1.696873e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613009e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395893e-02 3 1  ON 31
ci_0033                 1.701299e-02 3 1  ON 32
ci_0034                 1.587540e-02 3 1  ON 33
ci_0035                 1.777446e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516269e-02 3 1  ON 36
ci_0038                -1.405461e-02 3 1  ON 37
ci_0039                -1.577825e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567762e-02 3 1  ON 41
ci_0043                -1.498817e-02 3 1  ON 42
ci_0044                -1.596636e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454540e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248116e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342731e-02 3 1  ON 50
ci_0052                -1.273341e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247283e-02 3 1  ON 54
ci_0056                 1.271803e-02 3 1  ON 55
ci_0057                 1.316754e-02 3 1  ON 56
ci_0058                 1.240587e-02 3 1  ON 57
ci_0059                -1.297557e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265489e-02 3 1  ON 60
ci_0062                -1.293577e-02 3 1  ON 61
ci_0063                -1.193471e-02 3 1  ON 62
ci_0064                -1.123060e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180060e-02 3 1  ON 65
ci_0067                -1.109582e-02 3 1  ON 66
ci_0068                -1.078648e-02 3 1  ON 67
ci_0069                 1.072375e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961803e-03 3 1  ON 70
ci_0072                 9.555944e-03 3 1  ON 71
ci_0073                 1.150212e-02 3 1  ON 72
ci_0074                 1.054422e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.7769
    reference variance = 1.96701
====================================================
  Execution time = 1.2734e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5252e+00
  Total weights = 1.9456e+06
  Execution time = 2.2321e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554560406481
                                         uncertainty =       0.031893627309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554560406481
                                         uncertainty =       0.031893627309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130018858
  error estimate for blocks of size 2^( 2) =       0.001169548707
  error estimate for blocks of size 2^( 3) =       0.001202360332
  error estimate for blocks of size 2^( 4) =       0.001226406013
  error estimate for blocks of size 2^( 5) =       0.001240094894
  error estimate for blocks of size 2^( 6) =       0.001248044329
  error estimate for blocks of size 2^( 7) =       0.001258172587

      target function =                  N/A
              le_mean =     -16.719198426012
             les_mean =     282.056768455118
             stat err =       0.001243179456
             autocorr =       1.210309010351
              std dev =       1.598113564521
             le_variance =       2.553966965106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554560396411
                                         uncertainty =       0.031893629547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554560396411
                                         uncertainty =       0.031893629547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130018856
  error estimate for blocks of size 2^( 2) =       0.001169548698
  error estimate for blocks of size 2^( 3) =       0.001202360317
  error estimate for blocks of size 2^( 4) =       0.001226405997
  error estimate for blocks of size 2^( 5) =       0.001240094876
  error estimate for blocks of size 2^( 6) =       0.001248044317
  error estimate for blocks of size 2^( 7) =       0.001258172572

      target function =                  N/A
              le_mean =     -16.719198424949
             les_mean =     282.056768501113
             stat err =       0.001243179440
             autocorr =       1.210308985437
              std dev =       1.598113561333
             le_variance =       2.553966954917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554560401444
                                         uncertainty =       0.031893628428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554560401444
                                         uncertainty =       0.031893628428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130018857
  error estimate for blocks of size 2^( 2) =       0.001169548703
  error estimate for blocks of size 2^( 3) =       0.001202360325
  error estimate for blocks of size 2^( 4) =       0.001226406005
  error estimate for blocks of size 2^( 5) =       0.001240094885
  error estimate for blocks of size 2^( 6) =       0.001248044323
  error estimate for blocks of size 2^( 7) =       0.001258172580

      target function =                  N/A
              le_mean =     -16.719198425481
             les_mean =     282.056768478079
             stat err =       0.001243179448
             autocorr =       1.210308997894
              std dev =       1.598113562927
             le_variance =       2.553966960010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554560405851
                                         uncertainty =       0.031893627449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554560405851
                                         uncertainty =       0.031893627449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130018858
  error estimate for blocks of size 2^( 2) =       0.001169548707
  error estimate for blocks of size 2^( 3) =       0.001202360331
  error estimate for blocks of size 2^( 4) =       0.001226406012
  error estimate for blocks of size 2^( 5) =       0.001240094893
  error estimate for blocks of size 2^( 6) =       0.001248044328
  error estimate for blocks of size 2^( 7) =       0.001258172586

      target function =                  N/A
              le_mean =     -16.719198425946
             les_mean =     282.056768457984
             stat err =       0.001243179455
             autocorr =       1.210309008795
              std dev =       1.598113564322
             le_variance =       2.553966964469


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719198426012        initial  <--
     3.5527e+03     3.5527e+04             1.3954e-07       -16.719198424949
     1.4211e+04     1.4211e+05             3.4887e-08       -16.719198425481
     5.6843e+04     5.6843e+05             8.7218e-09       -16.719198425946

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9645
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405461e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0227e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6712e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.8386
    reference variance = 1.34125
====================================================
  Execution time = 1.3025e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0289e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4883e+00
  Total weights = 1.945809495e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1613e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.518587384425
                                         uncertainty =       0.027010567381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.518587384425
                                         uncertainty =       0.027010567381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121974271
  error estimate for blocks of size 2^( 2) =       0.001160255779
  error estimate for blocks of size 2^( 3) =       0.001193260044
  error estimate for blocks of size 2^( 4) =       0.001217195987
  error estimate for blocks of size 2^( 5) =       0.001231731459
  error estimate for blocks of size 2^( 6) =       0.001237491125
  error estimate for blocks of size 2^( 7) =       0.001239847264

      target function =                  N/A
              le_mean =     -16.719270232311
             les_mean =     282.022333777665
             stat err =       0.001231566459
             autocorr =       1.204896962928
              std dev =       1.586736617207
             le_variance =       2.517733092386


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671927023231e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+04, overlap shift 3.5527e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719270231416       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719270231824       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719270231825       residual = 2.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+04 is 1.262401e-08

solving harmonic davidson linear method for identity shift 1.4211e+05, overlap shift 1.4211e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719270231416       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719270231518       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719270231518       residual = 2.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+05 is 3.156014e-09

solving harmonic davidson linear method for identity shift 5.6843e+05, overlap shift 5.6843e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719270231416       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719270231441       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719270231441       residual = 2.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+05 is 7.890043e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.379373 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6193e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800161e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566017e-02 3 1  ON 4
ci_0006                -4.394248e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958634e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769721e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701301e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576792e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240589e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109582e-02 3 1  ON 66
ci_0068                -1.078646e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961789e-03 3 1  ON 70
ci_0072                 9.555933e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.5904
    reference variance = 8.38301
====================================================
  Execution time = 1.2803e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5456e+00
  Total weights = 1.9456e+06
  Execution time = 2.2199e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574543224138
                                         uncertainty =       0.028884380479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574543224138
                                         uncertainty =       0.028884380479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134936914
  error estimate for blocks of size 2^( 2) =       0.001172782803
  error estimate for blocks of size 2^( 3) =       0.001204144180
  error estimate for blocks of size 2^( 4) =       0.001226339718
  error estimate for blocks of size 2^( 5) =       0.001242295014
  error estimate for blocks of size 2^( 6) =       0.001251476231
  error estimate for blocks of size 2^( 7) =       0.001258241443

      target function =                  N/A
              le_mean =     -16.717617755733
             les_mean =     282.024340995245
             stat err =       0.001244588101
             autocorr =       1.202563022942
              std dev =       1.605068856941
             le_variance =       2.576246035521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574543219719
                                         uncertainty =       0.028884380431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574543219719
                                         uncertainty =       0.028884380431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134936913
  error estimate for blocks of size 2^( 2) =       0.001172782802
  error estimate for blocks of size 2^( 3) =       0.001204144179
  error estimate for blocks of size 2^( 4) =       0.001226339716
  error estimate for blocks of size 2^( 5) =       0.001242295013
  error estimate for blocks of size 2^( 6) =       0.001251476230
  error estimate for blocks of size 2^( 7) =       0.001258241442

      target function =                  N/A
              le_mean =     -16.717617755709
             les_mean =     282.024340989746
             stat err =       0.001244588100
             autocorr =       1.202563022852
              std dev =       1.605068855562
             le_variance =       2.576246031094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574543221928
                                         uncertainty =       0.028884380455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574543221928
                                         uncertainty =       0.028884380455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134936914
  error estimate for blocks of size 2^( 2) =       0.001172782802
  error estimate for blocks of size 2^( 3) =       0.001204144180
  error estimate for blocks of size 2^( 4) =       0.001226339717
  error estimate for blocks of size 2^( 5) =       0.001242295014
  error estimate for blocks of size 2^( 6) =       0.001251476230
  error estimate for blocks of size 2^( 7) =       0.001258241442

      target function =                  N/A
              le_mean =     -16.717617755721
             les_mean =     282.024340992494
             stat err =       0.001244588101
             autocorr =       1.202563022896
              std dev =       1.605068856251
             le_variance =       2.576246033307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574543223862
                                         uncertainty =       0.028884380476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574543223862
                                         uncertainty =       0.028884380476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134936914
  error estimate for blocks of size 2^( 2) =       0.001172782803
  error estimate for blocks of size 2^( 3) =       0.001204144180
  error estimate for blocks of size 2^( 4) =       0.001226339718
  error estimate for blocks of size 2^( 5) =       0.001242295014
  error estimate for blocks of size 2^( 6) =       0.001251476231
  error estimate for blocks of size 2^( 7) =       0.001258241443

      target function =                  N/A
              le_mean =     -16.717617755731
             les_mean =     282.024340994901
             stat err =       0.001244588101
             autocorr =       1.202563022936
              std dev =       1.605068856854
             le_variance =       2.576246035244


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717617755733        initial  <--
     3.5527e+04     3.5527e+05             1.2624e-08       -16.717617755709
     1.4211e+05     1.4211e+06             3.1560e-09       -16.717617755721
     5.6843e+05     5.6843e+06             7.8900e-10       -16.717617755731

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9735
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405461e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0172e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6712e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.5836
    reference variance = 2.55161
====================================================
  Execution time = 1.3025e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0265e+04
  VMC Eavg = -1.6715e+01
  VMC Evar = 2.6443e+00
  Total weights = 1.945880039e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2037e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.675542755636
                                         uncertainty =       0.082274209739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.675542755636
                                         uncertainty =       0.082274209739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001156577192
  error estimate for blocks of size 2^( 2) =       0.001194895801
  error estimate for blocks of size 2^( 3) =       0.001227428404
  error estimate for blocks of size 2^( 4) =       0.001249564866
  error estimate for blocks of size 2^( 5) =       0.001263860987
  error estimate for blocks of size 2^( 6) =       0.001270663914
  error estimate for blocks of size 2^( 7) =       0.001278847151

      target function =                  N/A
              le_mean =     -16.714657269642
             les_mean =     282.024099367394
             stat err =       0.001265734230
             autocorr =       1.197666225097
              std dev =       1.635673321679
             le_variance =       2.675427215253


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671465726964e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.714657268687       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.714657268720       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.714657268720       residual = 1.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+05 is 1.009921e-09

solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.714657268687       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.714657268695       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.714657268695       residual = 1.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+06 is 2.524803e-10

solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.714657268687       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.714657268689       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.714657268689       residual = 1.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+06 is 6.312008e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.380571 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6235e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240589e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.7283
    reference variance = 2.08152
====================================================
  Execution time = 1.2733e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5675e+00
  Total weights = 1.9458e+06
  Execution time = 2.2269e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595104764848
                                         uncertainty =       0.059345350790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595104764848
                                         uncertainty =       0.059345350790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139204374
  error estimate for blocks of size 2^( 2) =       0.001177385240
  error estimate for blocks of size 2^( 3) =       0.001210073573
  error estimate for blocks of size 2^( 4) =       0.001234260486
  error estimate for blocks of size 2^( 5) =       0.001248684144
  error estimate for blocks of size 2^( 6) =       0.001254965807
  error estimate for blocks of size 2^( 7) =       0.001254769385

      target function =                  N/A
              le_mean =     -16.717084381335
             les_mean =     282.028370028973
             stat err =       0.001248169955
             autocorr =       1.200450235727
              std dev =       1.611104053318
             le_variance =       2.595656270617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595104766285
                                         uncertainty =       0.059345350800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595104766285
                                         uncertainty =       0.059345350800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139204374
  error estimate for blocks of size 2^( 2) =       0.001177385241
  error estimate for blocks of size 2^( 3) =       0.001210073573
  error estimate for blocks of size 2^( 4) =       0.001234260486
  error estimate for blocks of size 2^( 5) =       0.001248684144
  error estimate for blocks of size 2^( 6) =       0.001254965807
  error estimate for blocks of size 2^( 7) =       0.001254769385

      target function =                  N/A
              le_mean =     -16.717084381308
             les_mean =     282.028370030010
             stat err =       0.001248169955
             autocorr =       1.200450235106
              std dev =       1.611104053764
             le_variance =       2.595656272056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595104765567
                                         uncertainty =       0.059345350795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595104765567
                                         uncertainty =       0.059345350795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139204374
  error estimate for blocks of size 2^( 2) =       0.001177385240
  error estimate for blocks of size 2^( 3) =       0.001210073573
  error estimate for blocks of size 2^( 4) =       0.001234260486
  error estimate for blocks of size 2^( 5) =       0.001248684144
  error estimate for blocks of size 2^( 6) =       0.001254965807
  error estimate for blocks of size 2^( 7) =       0.001254769385

      target function =                  N/A
              le_mean =     -16.717084381322
             les_mean =     282.028370029491
             stat err =       0.001248169955
             autocorr =       1.200450235416
              std dev =       1.611104053541
             le_variance =       2.595656271336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595104764938
                                         uncertainty =       0.059345350790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595104764938
                                         uncertainty =       0.059345350790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139204374
  error estimate for blocks of size 2^( 2) =       0.001177385240
  error estimate for blocks of size 2^( 3) =       0.001210073573
  error estimate for blocks of size 2^( 4) =       0.001234260486
  error estimate for blocks of size 2^( 5) =       0.001248684144
  error estimate for blocks of size 2^( 6) =       0.001254965807
  error estimate for blocks of size 2^( 7) =       0.001254769385

      target function =                  N/A
              le_mean =     -16.717084381334
             les_mean =     282.028370029038
             stat err =       0.001248169955
             autocorr =       1.200450235688
              std dev =       1.611104053346
             le_variance =       2.595656270706


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717084381335        initial  <--
     3.5527e+05     3.5527e+06             1.0099e-09       -16.717084381308
     1.4211e+06     1.4211e+07             2.5248e-10       -16.717084381322
     5.6843e+06     5.6843e+07             6.3120e-11       -16.717084381334

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9288
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405461e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0170e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6711e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.6443
    reference variance = 3.13372
====================================================
  Execution time = 1.3090e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0308e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.6118e+00
  Total weights = 1.945810298e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1603e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.639551356153
                                         uncertainty =       0.078535710948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.639551356153
                                         uncertainty =       0.078535710948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001148523464
  error estimate for blocks of size 2^( 2) =       0.001187031917
  error estimate for blocks of size 2^( 3) =       0.001220069353
  error estimate for blocks of size 2^( 4) =       0.001240776181
  error estimate for blocks of size 2^( 5) =       0.001255769573
  error estimate for blocks of size 2^( 6) =       0.001264826619
  error estimate for blocks of size 2^( 7) =       0.001274105894

      target function =                  N/A
              le_mean =     -16.717950547891
             les_mean =     282.101704913565
             stat err =       0.001258869567
             autocorr =       1.201383671744
              std dev =       1.624283447266
             le_variance =       2.638296717062


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671795054789e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717950547014       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717950547020       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717950547020       residual = 6.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+06 is 1.627392e-10

solving harmonic davidson linear method for identity shift 1.4211e+07, overlap shift 1.4211e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717950547014       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717950547016       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717950547016       residual = 6.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+07 is 4.068479e-11

solving harmonic davidson linear method for identity shift 5.6843e+07, overlap shift 5.6843e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717950547014       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717950547015       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717950547015       residual = 6.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+07 is 1.017120e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.381739 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6257e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405461e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.6397
    reference variance = 2.09355
====================================================
  Execution time = 1.5051e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5307e+00
  Total weights = 1.9456e+06
  Execution time = 2.2376e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.557486176721
                                         uncertainty =       0.034008304826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.557486176721
                                         uncertainty =       0.034008304826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130744058
  error estimate for blocks of size 2^( 2) =       0.001169252643
  error estimate for blocks of size 2^( 3) =       0.001203173749
  error estimate for blocks of size 2^( 4) =       0.001224705673
  error estimate for blocks of size 2^( 5) =       0.001236714908
  error estimate for blocks of size 2^( 6) =       0.001246534145
  error estimate for blocks of size 2^( 7) =       0.001244954709

      target function =                  N/A
              le_mean =     -16.718872550063
             les_mean =     282.051397913982
             stat err =       0.001238227359
             autocorr =       1.199146275218
              std dev =       1.599139167518
             le_variance =       2.557246077091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.557486176705
                                         uncertainty =       0.034008304825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.557486176705
                                         uncertainty =       0.034008304825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130744058
  error estimate for blocks of size 2^( 2) =       0.001169252643
  error estimate for blocks of size 2^( 3) =       0.001203173749
  error estimate for blocks of size 2^( 4) =       0.001224705673
  error estimate for blocks of size 2^( 5) =       0.001236714908
  error estimate for blocks of size 2^( 6) =       0.001246534145
  error estimate for blocks of size 2^( 7) =       0.001244954709

      target function =                  N/A
              le_mean =     -16.718872550065
             les_mean =     282.051397914158
             stat err =       0.001238227359
             autocorr =       1.199146275204
              std dev =       1.599139167513
             le_variance =       2.557246077076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.557486176713
                                         uncertainty =       0.034008304825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.557486176713
                                         uncertainty =       0.034008304825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130744058
  error estimate for blocks of size 2^( 2) =       0.001169252643
  error estimate for blocks of size 2^( 3) =       0.001203173749
  error estimate for blocks of size 2^( 4) =       0.001224705673
  error estimate for blocks of size 2^( 5) =       0.001236714908
  error estimate for blocks of size 2^( 6) =       0.001246534145
  error estimate for blocks of size 2^( 7) =       0.001244954709

      target function =                  N/A
              le_mean =     -16.718872550064
             les_mean =     282.051397914070
             stat err =       0.001238227359
             autocorr =       1.199146275211
              std dev =       1.599139167516
             le_variance =       2.557246077083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.557486176720
                                         uncertainty =       0.034008304826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.557486176720
                                         uncertainty =       0.034008304826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130744058
  error estimate for blocks of size 2^( 2) =       0.001169252643
  error estimate for blocks of size 2^( 3) =       0.001203173749
  error estimate for blocks of size 2^( 4) =       0.001224705673
  error estimate for blocks of size 2^( 5) =       0.001236714908
  error estimate for blocks of size 2^( 6) =       0.001246534145
  error estimate for blocks of size 2^( 7) =       0.001244954709

      target function =                  N/A
              le_mean =     -16.718872550063
             les_mean =     282.051397913993
             stat err =       0.001238227359
             autocorr =       1.199146275217
              std dev =       1.599139167518
             le_variance =       2.557246077090


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718872550063        initial
     3.5527e+06     3.5527e+07             1.6274e-10       -16.718872550065  <--
     1.4211e+07     1.4211e+08             4.0685e-11       -16.718872550064
     5.6843e+07     5.6843e+08             1.0171e-11       -16.718872550063

*****************************************************************************
Applying the update for shift_i =   3.5527e+06     and shift_s =   3.5527e+07
*****************************************************************************

  Execution time = 2.6255e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405461e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2518e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6710e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.677
    reference variance = 2.75517
====================================================
  Execution time = 1.3036e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0252e+04
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5163e+00
  Total weights = 1.945727860e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1566e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544346568026
                                         uncertainty =       0.022037224268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544346568026
                                         uncertainty =       0.022037224268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127878847
  error estimate for blocks of size 2^( 2) =       0.001165779869
  error estimate for blocks of size 2^( 3) =       0.001199203225
  error estimate for blocks of size 2^( 4) =       0.001223852065
  error estimate for blocks of size 2^( 5) =       0.001238223569
  error estimate for blocks of size 2^( 6) =       0.001248827056
  error estimate for blocks of size 2^( 7) =       0.001261649941

      target function =                  N/A
              le_mean =     -16.715955326662
             les_mean =     281.939478321988
             stat err =       0.001243138158
             autocorr =       1.214825476682
              std dev =       1.595087082696
             le_variance =       2.544302801383


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671595532666e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+05, overlap shift 8.8818e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715955325739       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715955325747       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715955325747       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+05 is 6.218966e-10

solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715955325739       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715955325741       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715955325741       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+06 is 1.554742e-10

solving harmonic davidson linear method for identity shift 1.4211e+07, overlap shift 1.4211e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715955325739       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715955325739       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715955325739       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+07 is 3.886855e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.382933 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6199e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405461e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532232e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.6478
    reference variance = 4.06349
====================================================
  Execution time = 1.3468e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.7123e+00
  Total weights = 1.9460e+06
  Execution time = 2.2403e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.745708390181
                                         uncertainty =       0.153563533415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.745708390181
                                         uncertainty =       0.153563533415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001171751807
  error estimate for blocks of size 2^( 2) =       0.001210031852
  error estimate for blocks of size 2^( 3) =       0.001240876773
  error estimate for blocks of size 2^( 4) =       0.001263323335
  error estimate for blocks of size 2^( 5) =       0.001277356396
  error estimate for blocks of size 2^( 6) =       0.001280270352
  error estimate for blocks of size 2^( 7) =       0.001284188571

      target function =                  N/A
              le_mean =     -16.717351256649
             les_mean =     282.182098726672
             stat err =       0.001276284664
             autocorr =       1.186380057040
              std dev =       1.657133810016
             le_variance =       2.746092464297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.745708389967
                                         uncertainty =       0.153563533394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.745708389967
                                         uncertainty =       0.153563533394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001171751806
  error estimate for blocks of size 2^( 2) =       0.001210031852
  error estimate for blocks of size 2^( 3) =       0.001240876773
  error estimate for blocks of size 2^( 4) =       0.001263323335
  error estimate for blocks of size 2^( 5) =       0.001277356396
  error estimate for blocks of size 2^( 6) =       0.001280270351
  error estimate for blocks of size 2^( 7) =       0.001284188571

      target function =                  N/A
              le_mean =     -16.717351256658
             les_mean =     282.182098727511
             stat err =       0.001276284663
             autocorr =       1.186380056921
              std dev =       1.657133809951
             le_variance =       2.746092464083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.745708390074
                                         uncertainty =       0.153563533405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.745708390074
                                         uncertainty =       0.153563533405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001171751806
  error estimate for blocks of size 2^( 2) =       0.001210031852
  error estimate for blocks of size 2^( 3) =       0.001240876773
  error estimate for blocks of size 2^( 4) =       0.001263323335
  error estimate for blocks of size 2^( 5) =       0.001277356396
  error estimate for blocks of size 2^( 6) =       0.001280270352
  error estimate for blocks of size 2^( 7) =       0.001284188571

      target function =                  N/A
              le_mean =     -16.717351256653
             les_mean =     282.182098727091
             stat err =       0.001276284663
             autocorr =       1.186380056980
              std dev =       1.657133809983
             le_variance =       2.746092464190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.745708390167
                                         uncertainty =       0.153563533414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.745708390167
                                         uncertainty =       0.153563533414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001171751807
  error estimate for blocks of size 2^( 2) =       0.001210031852
  error estimate for blocks of size 2^( 3) =       0.001240876773
  error estimate for blocks of size 2^( 4) =       0.001263323335
  error estimate for blocks of size 2^( 5) =       0.001277356396
  error estimate for blocks of size 2^( 6) =       0.001280270352
  error estimate for blocks of size 2^( 7) =       0.001284188571

      target function =                  N/A
              le_mean =     -16.717351256649
             les_mean =     282.182098726724
             stat err =       0.001276284664
             autocorr =       1.186380057032
              std dev =       1.657133810012
             le_variance =       2.746092464284


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717351256649        initial
     8.8818e+05     8.8818e+06             6.2190e-10       -16.717351256658  <--
     3.5527e+06     3.5527e+07             1.5547e-10       -16.717351256653
     1.4211e+07     1.4211e+08             3.8869e-11       -16.717351256649

*****************************************************************************
Applying the update for shift_i =   8.8818e+05     and shift_s =   8.8818e+06
*****************************************************************************

  Execution time = 2.4706e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0911e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6709e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.6356
    reference variance = 2.14658
====================================================
  Execution time = 1.3054e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0245e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5588e+00
  Total weights = 1.945424753e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1620e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.590598355888
                                         uncertainty =       0.044885248186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.590598355888
                                         uncertainty =       0.044885248186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137962231
  error estimate for blocks of size 2^( 2) =       0.001176737047
  error estimate for blocks of size 2^( 3) =       0.001209506987
  error estimate for blocks of size 2^( 4) =       0.001233427109
  error estimate for blocks of size 2^( 5) =       0.001245371436
  error estimate for blocks of size 2^( 6) =       0.001258169856
  error estimate for blocks of size 2^( 7) =       0.001266861964

      target function =                  N/A
              le_mean =     -16.719295211460
             les_mean =     282.093614906649
             stat err =       0.001250957591
             autocorr =       1.208452202271
              std dev =       1.609347370184
             le_variance =       2.589998957917


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671929521146e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+05, overlap shift 2.2204e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719295210543       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719295210627       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719295210628       residual = 4.71e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+05 is 2.130427e-09

solving harmonic davidson linear method for identity shift 8.8818e+05, overlap shift 8.8818e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719295210543       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719295210564       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719295210564       residual = 4.71e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+05 is 5.326071e-10

solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719295210543       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719295210548       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719295210548       residual = 4.71e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+06 is 1.331518e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.384115 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6222e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961789e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.747
    reference variance = 2.48351
====================================================
  Execution time = 1.2751e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5421e+00
  Total weights = 1.9459e+06
  Execution time = 2.2309e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568914559509
                                         uncertainty =       0.036483734277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568914559509
                                         uncertainty =       0.036483734277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133280910
  error estimate for blocks of size 2^( 2) =       0.001171192710
  error estimate for blocks of size 2^( 3) =       0.001204337555
  error estimate for blocks of size 2^( 4) =       0.001228301416
  error estimate for blocks of size 2^( 5) =       0.001242091035
  error estimate for blocks of size 2^( 6) =       0.001248858909
  error estimate for blocks of size 2^( 7) =       0.001257411201

      target function =                  N/A
              le_mean =     -16.718257766353
             les_mean =     282.042243386587
             stat err =       0.001244165640
             autocorr =       1.205261434816
              std dev =       1.602726875845
             le_variance =       2.568733438555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568914559226
                                         uncertainty =       0.036483734272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568914559226
                                         uncertainty =       0.036483734272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133280910
  error estimate for blocks of size 2^( 2) =       0.001171192710
  error estimate for blocks of size 2^( 3) =       0.001204337555
  error estimate for blocks of size 2^( 4) =       0.001228301416
  error estimate for blocks of size 2^( 5) =       0.001242091034
  error estimate for blocks of size 2^( 6) =       0.001248858909
  error estimate for blocks of size 2^( 7) =       0.001257411201

      target function =                  N/A
              le_mean =     -16.718257766341
             les_mean =     282.042243401141
             stat err =       0.001244165640
             autocorr =       1.205261434588
              std dev =       1.602726875757
             le_variance =       2.568733438274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568914559367
                                         uncertainty =       0.036483734275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568914559367
                                         uncertainty =       0.036483734275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133280910
  error estimate for blocks of size 2^( 2) =       0.001171192710
  error estimate for blocks of size 2^( 3) =       0.001204337555
  error estimate for blocks of size 2^( 4) =       0.001228301416
  error estimate for blocks of size 2^( 5) =       0.001242091035
  error estimate for blocks of size 2^( 6) =       0.001248858909
  error estimate for blocks of size 2^( 7) =       0.001257411201

      target function =                  N/A
              le_mean =     -16.718257766347
             les_mean =     282.042243393864
             stat err =       0.001244165640
             autocorr =       1.205261434702
              std dev =       1.602726875801
             le_variance =       2.568733438415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568914559491
                                         uncertainty =       0.036483734277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568914559491
                                         uncertainty =       0.036483734277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133280910
  error estimate for blocks of size 2^( 2) =       0.001171192710
  error estimate for blocks of size 2^( 3) =       0.001204337555
  error estimate for blocks of size 2^( 4) =       0.001228301416
  error estimate for blocks of size 2^( 5) =       0.001242091035
  error estimate for blocks of size 2^( 6) =       0.001248858909
  error estimate for blocks of size 2^( 7) =       0.001257411201

      target function =                  N/A
              le_mean =     -16.718257766352
             les_mean =     282.042243387496
             stat err =       0.001244165640
             autocorr =       1.205261434802
              std dev =       1.602726875839
             le_variance =       2.568733438537


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718257766353        initial  <--
     2.2204e+05     2.2204e+06             2.1304e-09       -16.718257766341
     8.8818e+05     8.8818e+06             5.3261e-10       -16.718257766347
     3.5527e+06     3.5527e+07             1.3315e-10       -16.718257766352

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9335
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0165e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6708e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.6742
    reference variance = 1.80945
====================================================
  Execution time = 1.3017e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0277e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5579e+00
  Total weights = 1.945586456e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2133e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.587766557921
                                         uncertainty =       0.050975430597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.587766557921
                                         uncertainty =       0.050975430597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137544024
  error estimate for blocks of size 2^( 2) =       0.001175758554
  error estimate for blocks of size 2^( 3) =       0.001208366361
  error estimate for blocks of size 2^( 4) =       0.001232344806
  error estimate for blocks of size 2^( 5) =       0.001246099283
  error estimate for blocks of size 2^( 6) =       0.001251821861
  error estimate for blocks of size 2^( 7) =       0.001257258206

      target function =                  N/A
              le_mean =     -16.717365006881
             les_mean =     282.028227275583
             stat err =       0.001246881039
             autocorr =       1.201471893357
              std dev =       1.608755925434
             le_variance =       2.588095627619


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671736500688e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+06, overlap shift 2.2204e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717365005938       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717365005946       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717365005946       residual = 2.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+06 is 1.721133e-10

solving harmonic davidson linear method for identity shift 8.8818e+06, overlap shift 8.8818e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717365005938       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717365005940       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717365005940       residual = 2.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+06 is 4.302833e-11

solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717365005938       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717365005939       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717365005939       residual = 2.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+07 is 1.075708e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.385244 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6237e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.7956
    reference variance = 2.02437
====================================================
  Execution time = 1.2867e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5052e+00
  Total weights = 1.9459e+06
  Execution time = 2.2336e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533820469454
                                         uncertainty =       0.028918935261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533820469454
                                         uncertainty =       0.028918935261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125433783
  error estimate for blocks of size 2^( 2) =       0.001163997737
  error estimate for blocks of size 2^( 3) =       0.001196509662
  error estimate for blocks of size 2^( 4) =       0.001221348233
  error estimate for blocks of size 2^( 5) =       0.001238121858
  error estimate for blocks of size 2^( 6) =       0.001244242184
  error estimate for blocks of size 2^( 7) =       0.001248425778

      target function =                  N/A
              le_mean =     -16.718169865548
             les_mean =     282.002405682180
             stat err =       0.001238034513
             autocorr =       1.210112114328
              std dev =       1.591629185115
             le_variance =       2.533283462909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533820469389
                                         uncertainty =       0.028918935272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533820469389
                                         uncertainty =       0.028918935272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125433783
  error estimate for blocks of size 2^( 2) =       0.001163997737
  error estimate for blocks of size 2^( 3) =       0.001196509662
  error estimate for blocks of size 2^( 4) =       0.001221348233
  error estimate for blocks of size 2^( 5) =       0.001238121858
  error estimate for blocks of size 2^( 6) =       0.001244242184
  error estimate for blocks of size 2^( 7) =       0.001248425778

      target function =                  N/A
              le_mean =     -16.718169865545
             les_mean =     282.002405681711
             stat err =       0.001238034513
             autocorr =       1.210112114323
              std dev =       1.591629185095
             le_variance =       2.533283462845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533820469422
                                         uncertainty =       0.028918935266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533820469422
                                         uncertainty =       0.028918935266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125433783
  error estimate for blocks of size 2^( 2) =       0.001163997737
  error estimate for blocks of size 2^( 3) =       0.001196509662
  error estimate for blocks of size 2^( 4) =       0.001221348233
  error estimate for blocks of size 2^( 5) =       0.001238121858
  error estimate for blocks of size 2^( 6) =       0.001244242184
  error estimate for blocks of size 2^( 7) =       0.001248425778

      target function =                  N/A
              le_mean =     -16.718169865547
             les_mean =     282.002405681946
             stat err =       0.001238034513
             autocorr =       1.210112114325
              std dev =       1.591629185105
             le_variance =       2.533283462877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533820469450
                                         uncertainty =       0.028918935262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533820469450
                                         uncertainty =       0.028918935262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125433783
  error estimate for blocks of size 2^( 2) =       0.001163997737
  error estimate for blocks of size 2^( 3) =       0.001196509662
  error estimate for blocks of size 2^( 4) =       0.001221348233
  error estimate for blocks of size 2^( 5) =       0.001238121858
  error estimate for blocks of size 2^( 6) =       0.001244242184
  error estimate for blocks of size 2^( 7) =       0.001248425778

      target function =                  N/A
              le_mean =     -16.718169865548
             les_mean =     282.002405682151
             stat err =       0.001238034513
             autocorr =       1.210112114328
              std dev =       1.591629185114
             le_variance =       2.533283462906


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718169865548        initial  <--
     2.2204e+06     2.2204e+07             1.7211e-10       -16.718169865545
     8.8818e+06     8.8818e+07             4.3028e-11       -16.718169865547
     3.5527e+07     3.5527e+08             1.0757e-11       -16.718169865548

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0284
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0271e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6709e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.8846
    reference variance = 1.56284
====================================================
  Execution time = 1.3062e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0283e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5408e+00
  Total weights = 1.945924322e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1966e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569499342084
                                         uncertainty =       0.028070069084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569499342084
                                         uncertainty =       0.028070069084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133335308
  error estimate for blocks of size 2^( 2) =       0.001171763808
  error estimate for blocks of size 2^( 3) =       0.001203519142
  error estimate for blocks of size 2^( 4) =       0.001228210150
  error estimate for blocks of size 2^( 5) =       0.001242846781
  error estimate for blocks of size 2^( 6) =       0.001249437577
  error estimate for blocks of size 2^( 7) =       0.001254487151

      target function =                  N/A
              le_mean =     -16.717384176997
             les_mean =     282.011709186786
             stat err =       0.001243745415
             autocorr =       1.204331781119
              std dev =       1.602803808059
             le_variance =       2.568980047127


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671738417700e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+07, overlap shift 2.2204e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717384176092       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717384176093       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717384176093       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717384176093       residual = 5.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+07 is 3.573806e-11

solving harmonic davidson linear method for identity shift 8.8818e+07, overlap shift 8.8818e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717384176092       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717384176092       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717384176092       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717384176092       residual = 5.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+07 is 8.934518e-12

solving harmonic davidson linear method for identity shift 3.5527e+08, overlap shift 3.5527e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717384176092       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717384176092       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717384176092       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717384176092       residual = 5.36e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+08 is 2.233500e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.386741 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6265e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.8008
    reference variance = 1.90393
====================================================
  Execution time = 1.2780e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5364e+00
  Total weights = 1.9454e+06
  Execution time = 2.2344e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564759883825
                                         uncertainty =       0.040036230920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564759883825
                                         uncertainty =       0.040036230920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132629179
  error estimate for blocks of size 2^( 2) =       0.001171736870
  error estimate for blocks of size 2^( 3) =       0.001205143999
  error estimate for blocks of size 2^( 4) =       0.001226409453
  error estimate for blocks of size 2^( 5) =       0.001237036753
  error estimate for blocks of size 2^( 6) =       0.001245625195
  error estimate for blocks of size 2^( 7) =       0.001256077294

      target function =                  N/A
              le_mean =     -16.719290862110
             les_mean =     282.071108142644
             stat err =       0.001241287174
             autocorr =       1.201072004197
              std dev =       1.601805174352
             le_variance =       2.565779816580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564759883830
                                         uncertainty =       0.040036230919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564759883830
                                         uncertainty =       0.040036230919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132629179
  error estimate for blocks of size 2^( 2) =       0.001171736870
  error estimate for blocks of size 2^( 3) =       0.001205143999
  error estimate for blocks of size 2^( 4) =       0.001226409453
  error estimate for blocks of size 2^( 5) =       0.001237036753
  error estimate for blocks of size 2^( 6) =       0.001245625195
  error estimate for blocks of size 2^( 7) =       0.001256077294

      target function =                  N/A
              le_mean =     -16.719290862110
             les_mean =     282.071108142628
             stat err =       0.001241287174
             autocorr =       1.201072004197
              std dev =       1.601805174353
             le_variance =       2.565779816585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564759883828
                                         uncertainty =       0.040036230919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564759883828
                                         uncertainty =       0.040036230919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132629179
  error estimate for blocks of size 2^( 2) =       0.001171736870
  error estimate for blocks of size 2^( 3) =       0.001205143999
  error estimate for blocks of size 2^( 4) =       0.001226409453
  error estimate for blocks of size 2^( 5) =       0.001237036753
  error estimate for blocks of size 2^( 6) =       0.001245625195
  error estimate for blocks of size 2^( 7) =       0.001256077294

      target function =                  N/A
              le_mean =     -16.719290862110
             les_mean =     282.071108142636
             stat err =       0.001241287174
             autocorr =       1.201072004197
              std dev =       1.601805174353
             le_variance =       2.565779816583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564759883825
                                         uncertainty =       0.040036230920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564759883825
                                         uncertainty =       0.040036230920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132629179
  error estimate for blocks of size 2^( 2) =       0.001171736870
  error estimate for blocks of size 2^( 3) =       0.001205143999
  error estimate for blocks of size 2^( 4) =       0.001226409453
  error estimate for blocks of size 2^( 5) =       0.001237036753
  error estimate for blocks of size 2^( 6) =       0.001245625195
  error estimate for blocks of size 2^( 7) =       0.001256077294

      target function =                  N/A
              le_mean =     -16.719290862110
             les_mean =     282.071108142643
             stat err =       0.001241287174
             autocorr =       1.201072004197
              std dev =       1.601805174352
             le_variance =       2.565779816580


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719290862110        initial  <--
     2.2204e+07     2.2204e+08             3.5738e-11       -16.719290862110
     8.8818e+07     8.8818e+08             8.9345e-12       -16.719290862110
     3.5527e+08     3.5527e+09             2.2335e-12       -16.719290862110

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9672
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0238e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6711e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.8765
    reference variance = 1.64364
====================================================
  Execution time = 1.3040e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0257e+04
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5691e+00
  Total weights = 1.945626625e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1577e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.581886004097
                                         uncertainty =       0.032926628985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.581886004097
                                         uncertainty =       0.032926628985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136307347
  error estimate for blocks of size 2^( 2) =       0.001174116064
  error estimate for blocks of size 2^( 3) =       0.001207089300
  error estimate for blocks of size 2^( 4) =       0.001230715049
  error estimate for blocks of size 2^( 5) =       0.001247453354
  error estimate for blocks of size 2^( 6) =       0.001256780760
  error estimate for blocks of size 2^( 7) =       0.001261010891

      target function =                  N/A
              le_mean =     -16.716227084811
             les_mean =     282.001384643634
             stat err =       0.001248990013
             autocorr =       1.208165144355
              std dev =       1.607006972784
             le_variance =       2.582471410575


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671622708481e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+08, overlap shift 2.2204e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716227083883       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716227083883       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716227083883       residual = 2.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+08 is 2.275374e-12

solving harmonic davidson linear method for identity shift 8.8818e+08, overlap shift 8.8818e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716227083883       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716227083883       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716227083883       residual = 2.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+08 is 5.688008e-13

solving harmonic davidson linear method for identity shift 3.5527e+09, overlap shift 3.5527e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716227083883       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716227083883       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716227083883       residual = 2.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+09 is 1.422109e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.387913 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6204e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.1814
    reference variance = 4.91226
====================================================
  Execution time = 1.2731e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5573e+00
  Total weights = 1.9457e+06
  Execution time = 2.2332e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.586797512803
                                         uncertainty =       0.029226940005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.586797512803
                                         uncertainty =       0.029226940005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137101022
  error estimate for blocks of size 2^( 2) =       0.001175600932
  error estimate for blocks of size 2^( 3) =       0.001208646544
  error estimate for blocks of size 2^( 4) =       0.001232513670
  error estimate for blocks of size 2^( 5) =       0.001246479585
  error estimate for blocks of size 2^( 6) =       0.001258173271
  error estimate for blocks of size 2^( 7) =       0.001262699587

      target function =                  N/A
              le_mean =     -16.718713476830
             les_mean =     282.072712867691
             stat err =       0.001249966528
             autocorr =       1.208366473836
              std dev =       1.608129416812
             le_variance =       2.586080221216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.586797512802
                                         uncertainty =       0.029226940005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.586797512802
                                         uncertainty =       0.029226940005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137101022
  error estimate for blocks of size 2^( 2) =       0.001175600932
  error estimate for blocks of size 2^( 3) =       0.001208646544
  error estimate for blocks of size 2^( 4) =       0.001232513670
  error estimate for blocks of size 2^( 5) =       0.001246479585
  error estimate for blocks of size 2^( 6) =       0.001258173271
  error estimate for blocks of size 2^( 7) =       0.001262699587

      target function =                  N/A
              le_mean =     -16.718713476830
             les_mean =     282.072712867691
             stat err =       0.001249966528
             autocorr =       1.208366473835
              std dev =       1.608129416811
             le_variance =       2.586080221214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.586797512803
                                         uncertainty =       0.029226940005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.586797512803
                                         uncertainty =       0.029226940005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137101022
  error estimate for blocks of size 2^( 2) =       0.001175600932
  error estimate for blocks of size 2^( 3) =       0.001208646544
  error estimate for blocks of size 2^( 4) =       0.001232513670
  error estimate for blocks of size 2^( 5) =       0.001246479585
  error estimate for blocks of size 2^( 6) =       0.001258173271
  error estimate for blocks of size 2^( 7) =       0.001262699587

      target function =                  N/A
              le_mean =     -16.718713476830
             les_mean =     282.072712867691
             stat err =       0.001249966528
             autocorr =       1.208366473836
              std dev =       1.608129416812
             le_variance =       2.586080221215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.586797512803
                                         uncertainty =       0.029226940005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.586797512803
                                         uncertainty =       0.029226940005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137101022
  error estimate for blocks of size 2^( 2) =       0.001175600932
  error estimate for blocks of size 2^( 3) =       0.001208646544
  error estimate for blocks of size 2^( 4) =       0.001232513670
  error estimate for blocks of size 2^( 5) =       0.001246479585
  error estimate for blocks of size 2^( 6) =       0.001258173271
  error estimate for blocks of size 2^( 7) =       0.001262699587

      target function =                  N/A
              le_mean =     -16.718713476830
             les_mean =     282.072712867691
             stat err =       0.001249966528
             autocorr =       1.208366473835
              std dev =       1.608129416812
             le_variance =       2.586080221215


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718713476830        initial
     2.2204e+08     2.2204e+09             2.2754e-12       -16.718713476830  <--
     8.8818e+08     8.8818e+09             5.6880e-13       -16.718713476830
     3.5527e+09     3.5527e+10             1.4221e-13       -16.718713476830

*****************************************************************************
Applying the update for shift_i =   2.2204e+08     and shift_s =   2.2204e+09
*****************************************************************************

  Execution time = 2.3922e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0132e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6708e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.8787
    reference variance = 1.56355
====================================================
  Execution time = 1.3012e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0259e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5155e+00
  Total weights = 1.945432564e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1712e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.543051902655
                                         uncertainty =       0.026682752585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.543051902655
                                         uncertainty =       0.026682752585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127587555
  error estimate for blocks of size 2^( 2) =       0.001166677713
  error estimate for blocks of size 2^( 3) =       0.001199689458
  error estimate for blocks of size 2^( 4) =       0.001221876366
  error estimate for blocks of size 2^( 5) =       0.001235259811
  error estimate for blocks of size 2^( 6) =       0.001243910906
  error estimate for blocks of size 2^( 7) =       0.001248511948

      target function =                  N/A
              le_mean =     -16.717254223302
             les_mean =     281.982083651524
             stat err =       0.001237389758
             autocorr =       1.204238439237
              std dev =       1.594675127696
             le_variance =       2.542988762891


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671725422330e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+07, overlap shift 5.5511e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717254222387       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717254222388       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717254222388       residual = 2.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+07 is 8.550199e-12

solving harmonic davidson linear method for identity shift 2.2204e+08, overlap shift 2.2204e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717254222387       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717254222387       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717254222387       residual = 2.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+08 is 2.137550e-12

solving harmonic davidson linear method for identity shift 8.8818e+08, overlap shift 8.8818e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717254222387       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717254222387       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717254222387       residual = 2.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+08 is 5.343874e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.389052 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6190e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.6166
    reference variance = 3.2688
====================================================
  Execution time = 1.2770e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5230e+00
  Total weights = 1.9455e+06
  Execution time = 2.2294e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550064581979
                                         uncertainty =       0.024669736130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550064581979
                                         uncertainty =       0.024669736130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129141341
  error estimate for blocks of size 2^( 2) =       0.001168263799
  error estimate for blocks of size 2^( 3) =       0.001202889426
  error estimate for blocks of size 2^( 4) =       0.001224670921
  error estimate for blocks of size 2^( 5) =       0.001239480356
  error estimate for blocks of size 2^( 6) =       0.001248711530
  error estimate for blocks of size 2^( 7) =       0.001256539773

      target function =                  N/A
              le_mean =     -16.719221962569
             les_mean =     282.055405370962
             stat err =       0.001242350645
             autocorr =       1.210575173194
              std dev =       1.596872547342
             le_variance =       2.550001932453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550064581978
                                         uncertainty =       0.024669736129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550064581978
                                         uncertainty =       0.024669736129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129141341
  error estimate for blocks of size 2^( 2) =       0.001168263799
  error estimate for blocks of size 2^( 3) =       0.001202889426
  error estimate for blocks of size 2^( 4) =       0.001224670921
  error estimate for blocks of size 2^( 5) =       0.001239480356
  error estimate for blocks of size 2^( 6) =       0.001248711530
  error estimate for blocks of size 2^( 7) =       0.001256539773

      target function =                  N/A
              le_mean =     -16.719221962569
             les_mean =     282.055405371014
             stat err =       0.001242350645
             autocorr =       1.210575173194
              std dev =       1.596872547341
             le_variance =       2.550001932452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550064581978
                                         uncertainty =       0.024669736130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550064581978
                                         uncertainty =       0.024669736130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129141341
  error estimate for blocks of size 2^( 2) =       0.001168263799
  error estimate for blocks of size 2^( 3) =       0.001202889426
  error estimate for blocks of size 2^( 4) =       0.001224670921
  error estimate for blocks of size 2^( 5) =       0.001239480356
  error estimate for blocks of size 2^( 6) =       0.001248711530
  error estimate for blocks of size 2^( 7) =       0.001256539773

      target function =                  N/A
              le_mean =     -16.719221962569
             les_mean =     282.055405370988
             stat err =       0.001242350645
             autocorr =       1.210575173193
              std dev =       1.596872547342
             le_variance =       2.550001932453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550064581979
                                         uncertainty =       0.024669736130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550064581979
                                         uncertainty =       0.024669736130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129141341
  error estimate for blocks of size 2^( 2) =       0.001168263799
  error estimate for blocks of size 2^( 3) =       0.001202889426
  error estimate for blocks of size 2^( 4) =       0.001224670921
  error estimate for blocks of size 2^( 5) =       0.001239480356
  error estimate for blocks of size 2^( 6) =       0.001248711530
  error estimate for blocks of size 2^( 7) =       0.001256539773

      target function =                  N/A
              le_mean =     -16.719221962569
             les_mean =     282.055405370965
             stat err =       0.001242350645
             autocorr =       1.210575173194
              std dev =       1.596872547342
             le_variance =       2.550001932454


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719221962569        initial  <--
     5.5511e+07     5.5511e+08             8.5502e-12       -16.719221962569
     2.2204e+08     2.2204e+09             2.1375e-12       -16.719221962569
     8.8818e+08     8.8818e+09             5.3439e-13       -16.719221962569

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9360
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0132e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6709e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.535
    reference variance = 4.0126
====================================================
  Execution time = 1.3038e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0322e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5709e+00
  Total weights = 1.945947435e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2053e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.599747676287
                                         uncertainty =       0.073845764005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.599747676287
                                         uncertainty =       0.073845764005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140027744
  error estimate for blocks of size 2^( 2) =       0.001178035925
  error estimate for blocks of size 2^( 3) =       0.001210616226
  error estimate for blocks of size 2^( 4) =       0.001235072039
  error estimate for blocks of size 2^( 5) =       0.001249552329
  error estimate for blocks of size 2^( 6) =       0.001261259601
  error estimate for blocks of size 2^( 7) =       0.001266079040

      target function =                  N/A
              le_mean =     -16.717340502356
             les_mean =     282.040387764765
             stat err =       0.001252990752
             autocorr =       1.207994313588
              std dev =       1.612268493166
             le_variance =       2.599409694054


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671734050236e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+08, overlap shift 5.5511e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717340501419       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717340501419       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717340501419       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717340501419       residual = 7.11e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+08 is 9.474945e-13

solving harmonic davidson linear method for identity shift 2.2204e+09, overlap shift 2.2204e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717340501419       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717340501419       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717340501419       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717340501419       residual = 7.11e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+09 is 2.368743e-13

solving harmonic davidson linear method for identity shift 8.8818e+09, overlap shift 8.8818e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717340501419       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717340501419       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717340501419       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717340501419       residual = 9.15e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+09 is 5.921621e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.390542 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6250e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.7051
    reference variance = 2.71525
====================================================
  Execution time = 1.2781e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.4815e+00
  Total weights = 1.9456e+06
  Execution time = 2.2358e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508947375805
                                         uncertainty =       0.021043011336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508947375805
                                         uncertainty =       0.021043011336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119995947
  error estimate for blocks of size 2^( 2) =       0.001158577391
  error estimate for blocks of size 2^( 3) =       0.001190812564
  error estimate for blocks of size 2^( 4) =       0.001213962827
  error estimate for blocks of size 2^( 5) =       0.001226387757
  error estimate for blocks of size 2^( 6) =       0.001236833043
  error estimate for blocks of size 2^( 7) =       0.001247423419

      target function =                  N/A
              le_mean =     -16.719804484705
             les_mean =     282.033406734370
             stat err =       0.001231151761
             autocorr =       1.208343136339
              std dev =       1.583938800075
             le_variance =       2.508862122383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508947375804
                                         uncertainty =       0.021043011336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508947375804
                                         uncertainty =       0.021043011336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119995947
  error estimate for blocks of size 2^( 2) =       0.001158577391
  error estimate for blocks of size 2^( 3) =       0.001190812564
  error estimate for blocks of size 2^( 4) =       0.001213962827
  error estimate for blocks of size 2^( 5) =       0.001226387757
  error estimate for blocks of size 2^( 6) =       0.001236833043
  error estimate for blocks of size 2^( 7) =       0.001247423419

      target function =                  N/A
              le_mean =     -16.719804484705
             les_mean =     282.033406734370
             stat err =       0.001231151761
             autocorr =       1.208343136339
              std dev =       1.583938800075
             le_variance =       2.508862122383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508947375804
                                         uncertainty =       0.021043011336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508947375804
                                         uncertainty =       0.021043011336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119995947
  error estimate for blocks of size 2^( 2) =       0.001158577391
  error estimate for blocks of size 2^( 3) =       0.001190812564
  error estimate for blocks of size 2^( 4) =       0.001213962827
  error estimate for blocks of size 2^( 5) =       0.001226387757
  error estimate for blocks of size 2^( 6) =       0.001236833043
  error estimate for blocks of size 2^( 7) =       0.001247423419

      target function =                  N/A
              le_mean =     -16.719804484705
             les_mean =     282.033406734370
             stat err =       0.001231151761
             autocorr =       1.208343136338
              std dev =       1.583938800075
             le_variance =       2.508862122383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508947375805
                                         uncertainty =       0.021043011336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.508947375805
                                         uncertainty =       0.021043011336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119995947
  error estimate for blocks of size 2^( 2) =       0.001158577391
  error estimate for blocks of size 2^( 3) =       0.001190812564
  error estimate for blocks of size 2^( 4) =       0.001213962827
  error estimate for blocks of size 2^( 5) =       0.001226387757
  error estimate for blocks of size 2^( 6) =       0.001236833043
  error estimate for blocks of size 2^( 7) =       0.001247423419

      target function =                  N/A
              le_mean =     -16.719804484705
             les_mean =     282.033406734370
             stat err =       0.001231151761
             autocorr =       1.208343136339
              std dev =       1.583938800075
             le_variance =       2.508862122383


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719804484705        initial
     5.5511e+08     5.5511e+09             9.4749e-13       -16.719804484705  <--
     2.2204e+09     2.2204e+10             2.3687e-13       -16.719804484705
     8.8818e+09     8.8818e+10             5.9216e-14       -16.719804484705

*****************************************************************************
Applying the update for shift_i =   5.5511e+08     and shift_s =   5.5511e+09
*****************************************************************************

  Execution time = 2.7121e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3378e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6707e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.6755
    reference variance = 1.45879
====================================================
  Execution time = 1.3048e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0323e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5101e+00
  Total weights = 1.945781536e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1935e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538902508689
                                         uncertainty =       0.039966427576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538902508689
                                         uncertainty =       0.039966427576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126744042
  error estimate for blocks of size 2^( 2) =       0.001166345972
  error estimate for blocks of size 2^( 3) =       0.001198625576
  error estimate for blocks of size 2^( 4) =       0.001223247090
  error estimate for blocks of size 2^( 5) =       0.001240493439
  error estimate for blocks of size 2^( 6) =       0.001248086421
  error estimate for blocks of size 2^( 7) =       0.001255060977

      target function =                  N/A
              le_mean =     -16.718981948356
             les_mean =     282.034414428140
             stat err =       0.001241721982
             autocorr =       1.214501898276
              std dev =       1.593482201032
             le_variance =       2.539185525006


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671898194836e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+08, overlap shift 1.3878e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718981947454       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718981947454       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718981947454       residual = 1.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3878e+08 is 3.077556e-12

solving harmonic davidson linear method for identity shift 5.5511e+08, overlap shift 5.5511e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718981947454       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718981947454       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718981947454       residual = 1.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+08 is 7.693885e-13

solving harmonic davidson linear method for identity shift 2.2204e+09, overlap shift 2.2204e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718981947454       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718981947454       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718981947454       residual = 1.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+09 is 1.923471e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.391748 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6249e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.6985
    reference variance = 1.34664
====================================================
  Execution time = 1.2758e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5118e+00
  Total weights = 1.9460e+06
  Execution time = 2.2023e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540047845994
                                         uncertainty =       0.025030333746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540047845994
                                         uncertainty =       0.025030333746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126910410
  error estimate for blocks of size 2^( 2) =       0.001165513074
  error estimate for blocks of size 2^( 3) =       0.001198631374
  error estimate for blocks of size 2^( 4) =       0.001222269484
  error estimate for blocks of size 2^( 5) =       0.001235311196
  error estimate for blocks of size 2^( 6) =       0.001240041757
  error estimate for blocks of size 2^( 7) =       0.001249977420

      target function =                  N/A
              le_mean =     -16.718498241144
             les_mean =     282.020006884453
             stat err =       0.001236899964
             autocorr =       1.204731794598
              std dev =       1.593717484940
             le_variance =       2.539935421805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540047845992
                                         uncertainty =       0.025030333746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540047845992
                                         uncertainty =       0.025030333746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126910410
  error estimate for blocks of size 2^( 2) =       0.001165513074
  error estimate for blocks of size 2^( 3) =       0.001198631374
  error estimate for blocks of size 2^( 4) =       0.001222269484
  error estimate for blocks of size 2^( 5) =       0.001235311196
  error estimate for blocks of size 2^( 6) =       0.001240041757
  error estimate for blocks of size 2^( 7) =       0.001249977420

      target function =                  N/A
              le_mean =     -16.718498241144
             les_mean =     282.020006884453
             stat err =       0.001236899964
             autocorr =       1.204731794599
              std dev =       1.593717484940
             le_variance =       2.539935421802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540047845993
                                         uncertainty =       0.025030333746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540047845993
                                         uncertainty =       0.025030333746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126910410
  error estimate for blocks of size 2^( 2) =       0.001165513074
  error estimate for blocks of size 2^( 3) =       0.001198631374
  error estimate for blocks of size 2^( 4) =       0.001222269484
  error estimate for blocks of size 2^( 5) =       0.001235311196
  error estimate for blocks of size 2^( 6) =       0.001240041757
  error estimate for blocks of size 2^( 7) =       0.001249977420

      target function =                  N/A
              le_mean =     -16.718498241144
             les_mean =     282.020006884453
             stat err =       0.001236899964
             autocorr =       1.204731794598
              std dev =       1.593717484940
             le_variance =       2.539935421803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540047845994
                                         uncertainty =       0.025030333746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540047845994
                                         uncertainty =       0.025030333746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126910410
  error estimate for blocks of size 2^( 2) =       0.001165513074
  error estimate for blocks of size 2^( 3) =       0.001198631374
  error estimate for blocks of size 2^( 4) =       0.001222269484
  error estimate for blocks of size 2^( 5) =       0.001235311196
  error estimate for blocks of size 2^( 6) =       0.001240041757
  error estimate for blocks of size 2^( 7) =       0.001249977420

      target function =                  N/A
              le_mean =     -16.718498241144
             les_mean =     282.020006884453
             stat err =       0.001236899964
             autocorr =       1.204731794598
              std dev =       1.593717484940
             le_variance =       2.539935421804


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718498241144        initial
     1.3878e+08     1.3878e+09             3.0776e-12       -16.718498241144  <--
     5.5511e+08     5.5511e+09             7.6939e-13       -16.718498241144
     2.2204e+09     2.2204e+10             1.9235e-13       -16.718498241144

*****************************************************************************
Applying the update for shift_i =   1.3878e+08     and shift_s =   1.3878e+09
*****************************************************************************

  Execution time = 2.3911e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0165e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6707e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.908
    reference variance = 1.48629
====================================================
  Execution time = 1.3018e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0230e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.6349e+00
  Total weights = 1.945249589e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2091e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.665771363255
                                         uncertainty =       0.129447032008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.665771363255
                                         uncertainty =       0.129447032008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001154291952
  error estimate for blocks of size 2^( 2) =       0.001191679879
  error estimate for blocks of size 2^( 3) =       0.001222531525
  error estimate for blocks of size 2^( 4) =       0.001244916524
  error estimate for blocks of size 2^( 5) =       0.001260782971
  error estimate for blocks of size 2^( 6) =       0.001271584738
  error estimate for blocks of size 2^( 7) =       0.001273178642

      target function =                  N/A
              le_mean =     -16.718177507257
             les_mean =     282.132376742044
             stat err =       0.001262615719
             autocorr =       1.196495441309
              std dev =       1.632441451594
             le_variance =       2.664865092882


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671817750726e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+07, overlap shift 3.4694e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718177506352       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718177506353       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718177506353       residual = 1.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.4694e+07 is 1.134341e-11

solving harmonic davidson linear method for identity shift 1.3878e+08, overlap shift 1.3878e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718177506352       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718177506353       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718177506353       residual = 1.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3878e+08 is 2.835852e-12

solving harmonic davidson linear method for identity shift 5.5511e+08, overlap shift 5.5511e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718177506352       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718177506352       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718177506352       residual = 1.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+08 is 7.089630e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.392873 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6233e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.8474
    reference variance = 1.51439
====================================================
  Execution time = 1.2764e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5915e+00
  Total weights = 1.9455e+06
  Execution time = 2.2098e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.617485163232
                                         uncertainty =       0.110914918794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.617485163232
                                         uncertainty =       0.110914918794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144069232
  error estimate for blocks of size 2^( 2) =       0.001181031190
  error estimate for blocks of size 2^( 3) =       0.001212834972
  error estimate for blocks of size 2^( 4) =       0.001234644796
  error estimate for blocks of size 2^( 5) =       0.001248611004
  error estimate for blocks of size 2^( 6) =       0.001257164272
  error estimate for blocks of size 2^( 7) =       0.001258451072

      target function =                  N/A
              le_mean =     -16.718663926095
             les_mean =     282.105243700794
             stat err =       0.001249717786
             autocorr =       1.193216607152
              std dev =       1.617984111896
             le_variance =       2.617872586348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.617485163233
                                         uncertainty =       0.110914918794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.617485163233
                                         uncertainty =       0.110914918794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144069232
  error estimate for blocks of size 2^( 2) =       0.001181031190
  error estimate for blocks of size 2^( 3) =       0.001212834972
  error estimate for blocks of size 2^( 4) =       0.001234644796
  error estimate for blocks of size 2^( 5) =       0.001248611004
  error estimate for blocks of size 2^( 6) =       0.001257164272
  error estimate for blocks of size 2^( 7) =       0.001258451072

      target function =                  N/A
              le_mean =     -16.718663926095
             les_mean =     282.105243700750
             stat err =       0.001249717786
             autocorr =       1.193216607150
              std dev =       1.617984111896
             le_variance =       2.617872586349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.617485163232
                                         uncertainty =       0.110914918794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.617485163232
                                         uncertainty =       0.110914918794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144069232
  error estimate for blocks of size 2^( 2) =       0.001181031190
  error estimate for blocks of size 2^( 3) =       0.001212834972
  error estimate for blocks of size 2^( 4) =       0.001234644796
  error estimate for blocks of size 2^( 5) =       0.001248611004
  error estimate for blocks of size 2^( 6) =       0.001257164272
  error estimate for blocks of size 2^( 7) =       0.001258451072

      target function =                  N/A
              le_mean =     -16.718663926095
             les_mean =     282.105243700772
             stat err =       0.001249717786
             autocorr =       1.193216607150
              std dev =       1.617984111896
             le_variance =       2.617872586349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.617485163232
                                         uncertainty =       0.110914918794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.617485163232
                                         uncertainty =       0.110914918794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144069232
  error estimate for blocks of size 2^( 2) =       0.001181031190
  error estimate for blocks of size 2^( 3) =       0.001212834972
  error estimate for blocks of size 2^( 4) =       0.001234644796
  error estimate for blocks of size 2^( 5) =       0.001248611004
  error estimate for blocks of size 2^( 6) =       0.001257164272
  error estimate for blocks of size 2^( 7) =       0.001258451072

      target function =                  N/A
              le_mean =     -16.718663926095
             les_mean =     282.105243700791
             stat err =       0.001249717786
             autocorr =       1.193216607151
              std dev =       1.617984111896
             le_variance =       2.617872586348


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718663926095        initial
     3.4694e+07     3.4694e+08             1.1343e-11       -16.718663926095  <--
     1.3878e+08     1.3878e+09             2.8359e-12       -16.718663926095
     5.5511e+08     5.5511e+09             7.0896e-13       -16.718663926095

*****************************************************************************
Applying the update for shift_i =   3.4694e+07     and shift_s =   3.4694e+08
*****************************************************************************

  Execution time = 2.3931e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0170e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6710e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.6711
    reference variance = 2.34927
====================================================
  Execution time = 1.3045e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0288e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5193e+00
  Total weights = 1.945438730e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2052e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550476083631
                                         uncertainty =       0.021491580730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550476083631
                                         uncertainty =       0.021491580730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129231253
  error estimate for blocks of size 2^( 2) =       0.001167445148
  error estimate for blocks of size 2^( 3) =       0.001201051060
  error estimate for blocks of size 2^( 4) =       0.001223057341
  error estimate for blocks of size 2^( 5) =       0.001235407986
  error estimate for blocks of size 2^( 6) =       0.001241143678
  error estimate for blocks of size 2^( 7) =       0.001245675645

      target function =                  N/A
              le_mean =     -16.717975207395
             les_mean =     282.009954553964
             stat err =       0.001236321163
             autocorr =       1.198662248339
              std dev =       1.596999705097
             le_variance =       2.550408058079


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671797520739e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+06, overlap shift 8.6736e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717975206493       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717975206495       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717975206495       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.6736e+06 is 6.221932e-11

solving harmonic davidson linear method for identity shift 3.4694e+07, overlap shift 3.4694e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717975206493       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717975206493       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717975206493       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.4694e+07 is 1.555483e-11

solving harmonic davidson linear method for identity shift 1.3878e+08, overlap shift 1.3878e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717975206493       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717975206493       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717975206493       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3878e+08 is 3.888709e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.394053 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6257e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.7377
    reference variance = 1.76937
====================================================
  Execution time = 1.2742e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4898e+00
  Total weights = 1.9459e+06
  Execution time = 2.1983e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515566800716
                                         uncertainty =       0.019661473880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515566800716
                                         uncertainty =       0.019661473880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121551543
  error estimate for blocks of size 2^( 2) =       0.001159789970
  error estimate for blocks of size 2^( 3) =       0.001191773004
  error estimate for blocks of size 2^( 4) =       0.001215993468
  error estimate for blocks of size 2^( 5) =       0.001230436995
  error estimate for blocks of size 2^( 6) =       0.001240010167
  error estimate for blocks of size 2^( 7) =       0.001238753958

      target function =                  N/A
              le_mean =     -16.718949267277
             les_mean =     282.013025051643
             stat err =       0.001231298647
             autocorr =       1.205281053892
              std dev =       1.586138781215
             le_variance =       2.515836233274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515566800731
                                         uncertainty =       0.019661473879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515566800731
                                         uncertainty =       0.019661473879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121551543
  error estimate for blocks of size 2^( 2) =       0.001159789970
  error estimate for blocks of size 2^( 3) =       0.001191773004
  error estimate for blocks of size 2^( 4) =       0.001215993468
  error estimate for blocks of size 2^( 5) =       0.001230436995
  error estimate for blocks of size 2^( 6) =       0.001240010167
  error estimate for blocks of size 2^( 7) =       0.001238753957

      target function =                  N/A
              le_mean =     -16.718949267277
             les_mean =     282.013025051907
             stat err =       0.001231298647
             autocorr =       1.205281053869
              std dev =       1.586138781220
             le_variance =       2.515836233289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515566800724
                                         uncertainty =       0.019661473879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515566800724
                                         uncertainty =       0.019661473879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121551543
  error estimate for blocks of size 2^( 2) =       0.001159789970
  error estimate for blocks of size 2^( 3) =       0.001191773004
  error estimate for blocks of size 2^( 4) =       0.001215993468
  error estimate for blocks of size 2^( 5) =       0.001230436995
  error estimate for blocks of size 2^( 6) =       0.001240010167
  error estimate for blocks of size 2^( 7) =       0.001238753958

      target function =                  N/A
              le_mean =     -16.718949267277
             les_mean =     282.013025051775
             stat err =       0.001231298647
             autocorr =       1.205281053881
              std dev =       1.586138781217
             le_variance =       2.515836233282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515566800717
                                         uncertainty =       0.019661473880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515566800717
                                         uncertainty =       0.019661473880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121551543
  error estimate for blocks of size 2^( 2) =       0.001159789970
  error estimate for blocks of size 2^( 3) =       0.001191773004
  error estimate for blocks of size 2^( 4) =       0.001215993468
  error estimate for blocks of size 2^( 5) =       0.001230436995
  error estimate for blocks of size 2^( 6) =       0.001240010167
  error estimate for blocks of size 2^( 7) =       0.001238753958

      target function =                  N/A
              le_mean =     -16.718949267277
             les_mean =     282.013025051659
             stat err =       0.001231298647
             autocorr =       1.205281053891
              std dev =       1.586138781215
             le_variance =       2.515836233275


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718949267277        initial  <--
     8.6736e+06     8.6736e+07             6.2219e-11       -16.718949267277
     3.4694e+07     3.4694e+08             1.5555e-11       -16.718949267277
     1.3878e+08     1.3878e+09             3.8887e-12       -16.718949267277

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8584
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0122e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6710e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.7325
    reference variance = 2.38199
====================================================
  Execution time = 1.3049e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0241e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5441e+00
  Total weights = 1.945606747e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1451e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569797080562
                                         uncertainty =       0.022134037064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.569797080562
                                         uncertainty =       0.022134037064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133386771
  error estimate for blocks of size 2^( 2) =       0.001171880613
  error estimate for blocks of size 2^( 3) =       0.001204619639
  error estimate for blocks of size 2^( 4) =       0.001226995303
  error estimate for blocks of size 2^( 5) =       0.001239268555
  error estimate for blocks of size 2^( 6) =       0.001245167116
  error estimate for blocks of size 2^( 7) =       0.001251512190

      target function =                  N/A
              le_mean =     -16.717374431115
             les_mean =     282.014692014766
             stat err =       0.001240735791
             autocorr =       1.198401495256
              std dev =       1.602876588625
             le_variance =       2.569213358363


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671737443112e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+07, overlap shift 8.6736e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717374430178       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717374430178       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717374430178       residual = 1.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.6736e+07 is 6.628036e-12

solving harmonic davidson linear method for identity shift 3.4694e+08, overlap shift 3.4694e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717374430178       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717374430178       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717374430178       residual = 1.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.4694e+08 is 1.657009e-12

solving harmonic davidson linear method for identity shift 1.3878e+09, overlap shift 1.3878e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717374430178       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717374430178       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717374430178       residual = 1.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3878e+09 is 4.142523e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.395208 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6201e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.7189
    reference variance = 1.71702
====================================================
  Execution time = 1.2776e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5332e+00
  Total weights = 1.9454e+06
  Execution time = 2.2137e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560236329942
                                         uncertainty =       0.024078120797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560236329942
                                         uncertainty =       0.024078120797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131285976
  error estimate for blocks of size 2^( 2) =       0.001168970419
  error estimate for blocks of size 2^( 3) =       0.001201893266
  error estimate for blocks of size 2^( 4) =       0.001224781516
  error estimate for blocks of size 2^( 5) =       0.001237145717
  error estimate for blocks of size 2^( 6) =       0.001242115617
  error estimate for blocks of size 2^( 7) =       0.001252221133

      target function =                  N/A
              le_mean =     -16.717880615501
             les_mean =     282.020693561903
             stat err =       0.001239065996
             autocorr =       1.199621028451
              std dev =       1.599905568568
             le_variance =       2.559697828336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560236329940
                                         uncertainty =       0.024078120797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560236329940
                                         uncertainty =       0.024078120797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131285976
  error estimate for blocks of size 2^( 2) =       0.001168970419
  error estimate for blocks of size 2^( 3) =       0.001201893266
  error estimate for blocks of size 2^( 4) =       0.001224781516
  error estimate for blocks of size 2^( 5) =       0.001237145717
  error estimate for blocks of size 2^( 6) =       0.001242115617
  error estimate for blocks of size 2^( 7) =       0.001252221133

      target function =                  N/A
              le_mean =     -16.717880615501
             les_mean =     282.020693561909
             stat err =       0.001239065996
             autocorr =       1.199621028452
              std dev =       1.599905568568
             le_variance =       2.559697828333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560236329941
                                         uncertainty =       0.024078120797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560236329941
                                         uncertainty =       0.024078120797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131285976
  error estimate for blocks of size 2^( 2) =       0.001168970419
  error estimate for blocks of size 2^( 3) =       0.001201893266
  error estimate for blocks of size 2^( 4) =       0.001224781516
  error estimate for blocks of size 2^( 5) =       0.001237145717
  error estimate for blocks of size 2^( 6) =       0.001242115617
  error estimate for blocks of size 2^( 7) =       0.001252221133

      target function =                  N/A
              le_mean =     -16.717880615501
             les_mean =     282.020693561906
             stat err =       0.001239065996
             autocorr =       1.199621028451
              std dev =       1.599905568568
             le_variance =       2.559697828334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560236329942
                                         uncertainty =       0.024078120797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560236329942
                                         uncertainty =       0.024078120797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131285976
  error estimate for blocks of size 2^( 2) =       0.001168970419
  error estimate for blocks of size 2^( 3) =       0.001201893266
  error estimate for blocks of size 2^( 4) =       0.001224781516
  error estimate for blocks of size 2^( 5) =       0.001237145717
  error estimate for blocks of size 2^( 6) =       0.001242115617
  error estimate for blocks of size 2^( 7) =       0.001252221133

      target function =                  N/A
              le_mean =     -16.717880615501
             les_mean =     282.020693561903
             stat err =       0.001239065996
             autocorr =       1.199621028451
              std dev =       1.599905568568
             le_variance =       2.559697828335


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717880615501        initial  <--
     8.6736e+07     8.6736e+08             6.6280e-12       -16.717880615501
     3.4694e+08     3.4694e+09             1.6570e-12       -16.717880615501
     1.3878e+09     1.3878e+10             4.1425e-13       -16.717880615501

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9533
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0160e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6710e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.5729
    reference variance = 2.80584
====================================================
  Execution time = 1.2999e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0265e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5388e+00
  Total weights = 1.945879494e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2004e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564739635012
                                         uncertainty =       0.030102467027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564739635012
                                         uncertainty =       0.030102467027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132326335
  error estimate for blocks of size 2^( 2) =       0.001170584378
  error estimate for blocks of size 2^( 3) =       0.001203920773
  error estimate for blocks of size 2^( 4) =       0.001226384208
  error estimate for blocks of size 2^( 5) =       0.001240520450
  error estimate for blocks of size 2^( 6) =       0.001246541497
  error estimate for blocks of size 2^( 7) =       0.001243352962

      target function =                  N/A
              le_mean =     -16.717845204244
             les_mean =     282.025112939016
             stat err =       0.001239199779
             autocorr =       1.197676252246
              std dev =       1.601376881952
             le_variance =       2.564407918051


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671784520424e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+08, overlap shift 8.6736e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717845203339       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717845203339       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717845203339       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.6736e+08 is 5.617360e-13

solving harmonic davidson linear method for identity shift 3.4694e+09, overlap shift 3.4694e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717845203339       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717845203339       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717845203339       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.4694e+09 is 1.404119e-13

solving harmonic davidson linear method for identity shift 1.3878e+10, overlap shift 1.3878e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717845203339       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717845203339       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717845203339       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3878e+10 is 3.510826e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.396383 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6206e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.6537
    reference variance = 2.43153
====================================================
  Execution time = 1.2746e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5985e+00
  Total weights = 1.9456e+06
  Execution time = 2.2045e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.629317901843
                                         uncertainty =       0.056151316835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.629317901843
                                         uncertainty =       0.056151316835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001146476160
  error estimate for blocks of size 2^( 2) =       0.001183415576
  error estimate for blocks of size 2^( 3) =       0.001215819085
  error estimate for blocks of size 2^( 4) =       0.001238287647
  error estimate for blocks of size 2^( 5) =       0.001254013101
  error estimate for blocks of size 2^( 6) =       0.001265026134
  error estimate for blocks of size 2^( 7) =       0.001270017099

      target function =                  N/A
              le_mean =     -16.716668504577
             les_mean =     282.045550679070
             stat err =       0.001256835995
             autocorr =       1.201786063505
              std dev =       1.621388076478
             le_variance =       2.628899294545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.629317901842
                                         uncertainty =       0.056151316835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.629317901842
                                         uncertainty =       0.056151316835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001146476160
  error estimate for blocks of size 2^( 2) =       0.001183415576
  error estimate for blocks of size 2^( 3) =       0.001215819085
  error estimate for blocks of size 2^( 4) =       0.001238287647
  error estimate for blocks of size 2^( 5) =       0.001254013101
  error estimate for blocks of size 2^( 6) =       0.001265026134
  error estimate for blocks of size 2^( 7) =       0.001270017099

      target function =                  N/A
              le_mean =     -16.716668504577
             les_mean =     282.045550679069
             stat err =       0.001256835995
             autocorr =       1.201786063504
              std dev =       1.621388076478
             le_variance =       2.628899294544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.629317901843
                                         uncertainty =       0.056151316835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.629317901843
                                         uncertainty =       0.056151316835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001146476160
  error estimate for blocks of size 2^( 2) =       0.001183415576
  error estimate for blocks of size 2^( 3) =       0.001215819085
  error estimate for blocks of size 2^( 4) =       0.001238287647
  error estimate for blocks of size 2^( 5) =       0.001254013101
  error estimate for blocks of size 2^( 6) =       0.001265026134
  error estimate for blocks of size 2^( 7) =       0.001270017099

      target function =                  N/A
              le_mean =     -16.716668504577
             les_mean =     282.045550679070
             stat err =       0.001256835995
             autocorr =       1.201786063504
              std dev =       1.621388076478
             le_variance =       2.628899294544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.629317901843
                                         uncertainty =       0.056151316835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.629317901843
                                         uncertainty =       0.056151316835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001146476160
  error estimate for blocks of size 2^( 2) =       0.001183415576
  error estimate for blocks of size 2^( 3) =       0.001215819085
  error estimate for blocks of size 2^( 4) =       0.001238287647
  error estimate for blocks of size 2^( 5) =       0.001254013101
  error estimate for blocks of size 2^( 6) =       0.001265026134
  error estimate for blocks of size 2^( 7) =       0.001270017099

      target function =                  N/A
              le_mean =     -16.716668504577
             les_mean =     282.045550679070
             stat err =       0.001256835995
             autocorr =       1.201786063504
              std dev =       1.621388076478
             le_variance =       2.628899294545


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716668504577        initial  <--
     8.6736e+08     8.6736e+09             5.6174e-13       -16.716668504577
     3.4694e+09     3.4694e+10             1.4041e-13       -16.716668504577
     1.3878e+10     1.3878e+11             3.5108e-14       -16.716668504577

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8873
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.073706e-01 3 1  ON 0
ci_0002                 6.793733e-01 3 1  ON 1
ci_0003                -4.800160e-02 3 1  ON 2
ci_0004                -4.638675e-02 3 1  ON 3
ci_0005                -4.566018e-02 3 1  ON 4
ci_0006                -4.394247e-02 3 1  ON 5
ci_0007                -3.091334e-02 3 1  ON 6
ci_0008                -3.116048e-02 3 1  ON 7
ci_0009                -3.231973e-02 3 1  ON 8
ci_0010                -3.067541e-02 3 1  ON 9
ci_0011                -2.797644e-02 3 1  ON 10
ci_0012                -2.668122e-02 3 1  ON 11
ci_0013                 2.685617e-02 3 1  ON 12
ci_0014                 2.692504e-02 3 1  ON 13
ci_0015                 2.740090e-02 3 1  ON 14
ci_0016                 2.631660e-02 3 1  ON 15
ci_0017                 2.381453e-02 3 1  ON 16
ci_0018                 2.343353e-02 3 1  ON 17
ci_0019                 2.053742e-02 3 1  ON 18
ci_0020                 1.958635e-02 3 1  ON 19
ci_0021                 1.858919e-02 3 1  ON 20
ci_0022                 1.802461e-02 3 1  ON 21
ci_0023                -1.925840e-02 3 1  ON 22
ci_0024                -1.769720e-02 3 1  ON 23
ci_0025                -1.834632e-02 3 1  ON 24
ci_0026                -1.756798e-02 3 1  ON 25
ci_0027                -1.738487e-02 3 1  ON 26
ci_0028                -1.696872e-02 3 1  ON 27
ci_0029                -1.560834e-02 3 1  ON 28
ci_0030                -1.613008e-02 3 1  ON 29
ci_0031                 1.557325e-02 3 1  ON 30
ci_0032                 1.395894e-02 3 1  ON 31
ci_0033                 1.701300e-02 3 1  ON 32
ci_0034                 1.587539e-02 3 1  ON 33
ci_0035                 1.777445e-02 3 1  ON 34
ci_0036                 1.687202e-02 3 1  ON 35
ci_0037                -1.516267e-02 3 1  ON 36
ci_0038                -1.405462e-02 3 1  ON 37
ci_0039                -1.577824e-02 3 1  ON 38
ci_0040                -1.504182e-02 3 1  ON 39
ci_0041                 1.576793e-02 3 1  ON 40
ci_0042                 1.567763e-02 3 1  ON 41
ci_0043                -1.498818e-02 3 1  ON 42
ci_0044                -1.596640e-02 3 1  ON 43
ci_0045                 1.532233e-02 3 1  ON 44
ci_0046                 1.581860e-02 3 1  ON 45
ci_0047                -1.454538e-02 3 1  ON 46
ci_0048                -1.418165e-02 3 1  ON 47
ci_0049                -1.248112e-02 3 1  ON 48
ci_0050                -1.371530e-02 3 1  ON 49
ci_0051                -1.342732e-02 3 1  ON 50
ci_0052                -1.273339e-02 3 1  ON 51
ci_0053                -1.284804e-02 3 1  ON 52
ci_0054                -1.222852e-02 3 1  ON 53
ci_0055                 1.247284e-02 3 1  ON 54
ci_0056                 1.271801e-02 3 1  ON 55
ci_0057                 1.316755e-02 3 1  ON 56
ci_0058                 1.240588e-02 3 1  ON 57
ci_0059                -1.297556e-02 3 1  ON 58
ci_0060                -1.272752e-02 3 1  ON 59
ci_0061                -1.265488e-02 3 1  ON 60
ci_0062                -1.293576e-02 3 1  ON 61
ci_0063                -1.193470e-02 3 1  ON 62
ci_0064                -1.123058e-02 3 1  ON 63
ci_0065                -1.136313e-02 3 1  ON 64
ci_0066                -1.180061e-02 3 1  ON 65
ci_0067                -1.109583e-02 3 1  ON 66
ci_0068                -1.078647e-02 3 1  ON 67
ci_0069                 1.072377e-02 3 1  ON 68
ci_0070                 1.009532e-02 3 1  ON 69
ci_0071                 9.961790e-03 3 1  ON 70
ci_0072                 9.555934e-03 3 1  ON 71
ci_0073                 1.150214e-02 3 1  ON 72
ci_0074                 1.054421e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0099e+01 secs
  Total Execution time = 2.4435e+03 secs

=========================================================
  A new xml input file : H2O.s059.cont.xml
